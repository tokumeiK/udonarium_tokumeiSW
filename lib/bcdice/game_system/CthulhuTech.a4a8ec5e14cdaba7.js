(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2555],{9818:(ie,$e,Z)=>{Z(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(t){var z,B,j,e,P,F,N,A,C=t.module,D=t.ensure_kwargs,c=t.truthy,a=t.thrower,w=t.def,T=[],x=t.nil,M=t.$$$;return z=T,B=A=[C(T[0],"BCDice")].concat(z),N=[F=C(A[0],"ArithmeticEvaluator")].concat(B),e=[j=t.get_singleton_class(F)].concat(N),P=t.$r(e),w(j,"$eval",function(L,R){try{a("eval_return");var p,H=x;return null==(p=(R=D(R)).$$smap.round_type)&&(p=M(P("RoundType"),"FLOOR")),c(L)&&c(H=P("Arithmetic").$eval(L,p))?H:0}catch(k){if(k===t.t_eval_return)return k.$v;throw k}},-2)},Opal.queue(function(t){var L,H,ee,te,re,g,r,y,v,h,b,f,q,J,O,Y,C=t.module,D=t.klass,c=t.const_set,a=t.def,w=t.rb_ge,T=t.rb_divide,x=t.rb_plus,M=t.rb_minus,o=t.truthy,z=t.send,K=t.rb_lt,A=t.rb_gt,S=t.send2,B=t.find_super,F=t.eqeq,N=t.thrower,G=[],e=t.nil,P=t.$$$;return t.top.$require("bcdice/arithmetic_evaluator"),L=G,H=Y=[C(G[0],"BCDice")].concat(L),J=[C(Y[0],"GameSystem")].concat(H),O=t.$r(J),ee=J[0],te=O("Base"),re=J,f=[b=D(ee,te,"CthulhuTech")].concat(re),q=t.$r(f),b.$$prototype.randomizer=e,b.$register_prefix("\\d+D10"),c(f[0],"ID","CthulhuTech"),c(f[0],"NAME","\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af"),c(f[0],"SORT_KEY","\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f"),c(f[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\uff08test\uff09\uff1anD10+m>=d\n\u3000n\u500b\u306e\u30c0\u30a4\u30b9\u3092\u4f7f\u7528\u3057\u3066\u3001\u4fee\u6b63\u5024m\u3001\u96e3\u6613\u5ea6d\u3067\u884c\u70ba\u5224\u5b9a\uff08test\uff09\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u4fee\u6b63\u5024m\u306f\u7701\u7565\u53ef\u80fd\u3001\u8907\u6570\u6307\u5b9a\u53ef\u80fd\uff08\u4f8b\uff1a+2-4\uff09\u3067\u3059\u3002\n\u3000\u6210\u529f\u3001\u5931\u6557\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u4f8b\uff092D10>=12\u30004D10+2>=28\u30005D10+2-4>=32\n\n\u30fb\u5bfe\u6297\u5224\u5b9a\uff08contest\uff09\uff1anD10+m>d\n\u3000\u884c\u70ba\u5224\u5b9a\u3068\u540c\u69d8\u3067\u3059\u304c\u3001\u9632\u5fa1\u5074\u6709\u5229\u306e\u305f\u3081\u300c>=\u300d\u3067\u306f\u306a\u304f\u300c>\u300d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u3000\u30c0\u30e1\u30fc\u30b8\u30c0\u30a4\u30b9\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n"),g=f,y=[r=D(f[0],null,"Test")].concat(g),v=t.$r(y),(h=r.$$prototype).num=h.modifier=h.difficulty=e,c(y[0],"COMPARE_OP",">="),a(r,"$initialize",function(i,n,s){var $=this;return $.num=i,$.modifier=n,$.difficulty=s}),a(r,"$execute",function(i){var u,E,_,U,V,W,n=this,s=e,$=e,I=e;return s=i.$roll_barabara(n.num,10),$=w(s.$count(1),T(x(s.$length(),1),2).$to_i()),u=s.$sort(),E=n.$calculate_roll_result(u),_=x(E,n.modifier),I=M(_,n.difficulty),U=o(V=$["$!"]())?I.$send(P(n.$class(),"COMPARE_OP"),0):V,W=w(I,10),["("+n.$expression()+")",n.$test_value_expression(u,E),_,n.$result_str(U,$,W,I)].$join(" \uff1e ")}),r.$private(),a(r,"$expression",function(){var n,i=this;return n=v("Format").$modifier(i.modifier),i.num+"D10"+n+P(i.$class(),"COMPARE_OP")+i.difficulty}),a(r,"$test_value_expression",function(i,n){return n+"["+i.$join(",")+"]"+v("Format").$modifier(this.modifier)}),a(r,"$result_str",function(i,n,s,$){return o(n)?"\u30d5\u30a1\u30f3\u30d6\u30eb":o(s)?"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb":o(i)?"\u6210\u529f":"\u5931\u6557"}),a(r,"$calculate_roll_result",function(i){return[i.$last(),z(z(i,"group_by",[],"itself".$to_proc()).$values(),"map",[],"sum".$to_proc()).$max(),this.$sum_of_largest_straight(i)].$max()}),a(r,"$sum_of_largest_straight",function(i){var n=e,s=e,$=e,u=e;return o(K(i.$length(),3))?0:(n=0,s=0,$=0,u=-1,z(i.$uniq(),"each",[],function(_){return null==_&&(_=e),o(A(M(_,u),1))?(s=1,$=_,u=_,e):(s=x(s,1),$=x($,_),u=_,o(w(s,3))&&o(A($,n))?n=$:e)}),n)}),function(d,m,g){var r=D(d,m,"Contest"),y=[r].concat(g);c(y[0],"COMPARE_OP",">"),a(r,"$result_str",function v(h,l,i,n){var u,s=v.$$p||e;return v.$$p=null,u=S(this,B(this,"result_str",v,!1,!0),"result_str",[h,l,i,n],s),o(h)?u+"\uff08\u30c0\u30e1\u30fc\u30b8\uff1a"+T(n,5).$ceil()+"D10\uff09":u})}(f[0],q("Test"),f),a(b,"$initialize",function d(m){var r=this;return d.$$p=null,S(r,B(r,"initialize",d,!1,!0),"initialize",[m],null),r.sort_add_dice=!0}),a(b,"$eval_game_system_specific_command",function(m){var r=e;return r=this.$parse(m),o(r)?r.$execute(this.randomizer):e}),b.$private(),c(f[0],"TEST_RE",/^(\d+)D10((?:[-+]\d+)+)?(>=?)(\d+)$/.$freeze()),a(b,"$parse",function(m){try{N("eval_return");var r=e,y=e,v=e,h=e,l=e;return r=q("TEST_RE").$match(m),o(r)?(y=r["$[]"](1).$to_i(),v=o(r["$[]"](2))?q("ArithmeticEvaluator").$eval(r["$[]"](2)):0,h=F(r["$[]"](3),">")?q("Contest"):q("Test"),l=r["$[]"](4).$to_i(),h.$new(y,v,l)):e}catch(i){if(i===t.t_eval_return)return i.$v;throw i}})})}}]);