(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3535],{4933:(V,X,Y)=>{Y(9993),Opal.modules["bcdice/normalize"]=function(t){var E,v,R,g=t.module,l=t.eqeqeq,d=t.def,w=t.eqeq,x=[],c=t.nil;return E=x,R=[g(x[0],"BCDice")].concat(E),(v=g(R[0],"Normalize")).$module_function(),d(v,"$comparison_operator",function(h){var b;return l(/<=|=</,b=h)?"<=":l(/>=|=>/,b)?">=":l(/<>|!=|=!/,b)?"!=":l(/</,b)?"<":l(/>/,b)?">":l(/=/,b)?"==":c}),d(v,"$target_number",function(h){return w(h,"?")?h:h.$to_i()})},Opal.modules["bcdice/format"]=function(t){var R,h,b,P,C,v,g=t.module,l=t.eqeqeq,d=t.def,w=t.truthy,x=t.eqeq,c=t.rb_gt,s=[],E=t.nil;return R=s,h=v=[g(s[0],"BCDice")].concat(R),P=[b=g(v[0],"Format")].concat(h),C=t.$r(P),b.$module_function(),d(b,"$comparison_operator",function(p){var j;return l("==",j=p)?"=":l("!=",j)?"<>":l(C("Symbol"),j)?p.$to_s():E}),d(b,"$modifier",function(p){return w(p["$nil?"]())?E:x(p,0)?"":w(c(p,0))?"+"+p:p.$to_s()})},Opal.modules["bcdice/game_system/NightWizard"]=function(t){var j,M,J,Q,U,e,y,N,z,A,T,L,S,g=t.module,l=t.klass,d=t.const_set,w=t.send2,x=t.find_super,c=t.def,s=t.truthy,E=t.to_ary,m=t.rb_plus,R=t.regexp,q=t.send,v=t.thrower,k=t.eqeq,h=t.neqeq,b=t.rb_minus,P=t.top,C=[],r=t.nil;return P.$require("bcdice/normalize"),P.$require("bcdice/format"),j=C,M=S=[g(C[0],"BCDice")].concat(j),T=[g(S[0],"GameSystem")].concat(M),L=t.$r(T),J=T[0],Q=L("Base"),U=T,N=[y=l(J,Q,"NightWizard")].concat(U),z=t.$r(N),(A=y.$$prototype).nw_command=A.randomizer=A.total=A.interim_expr=A.status=A.fumble_numbers=A.critical_numbers=r,d(N[0],"ID","NightWizard"),d(N[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),d(N[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),d(N[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),y.$register_prefix("([-+]?\\d+)?NW","2R6"),c(y,"$initialize",function f(o){var n=this;return f.$$p=null,w(n,x(n,"initialize",f,!1,!0),"initialize",[o],null),n.nw_command="NW"}),c(y,"$eval_game_system_specific_command",function(o){var e,n,u,$=this,i=r,_=r,a=r,D=r,W=r;return i=s(u=$.$parse_nw(o))?u:$.$parse_2r6(o),s(i)?(n=$.$roll_nw(i),_=null==(e=E(n))[0]?r:e[0],a=null==e[1]?r:e[1],D=null==e[2]?r:e[2],W=s(i.$cmp_op())?s(_.$send(i.$cmp_op(),i.$target_number()))?"\u6210\u529f":"\u5931\u6557":r,["("+i+")",a,D,_.$to_s(),W].$compact().$join(" \uff1e ")):r}),y.$private(),(e=l(N[0],null,"Parsed")).$attr_accessor("critical_numbers"),e.$attr_accessor("fumble_numbers"),e.$attr_accessor("prana"),e.$attr_accessor("active_modify_number"),e.$attr_accessor("cmp_op"),e.$attr_accessor("target_number"),function(f,o,e){var n=l(f,o,"ParsedNW"),$=[n].concat(e),i=t.$r($),u=n.$$prototype;u.base=u.modify_number=u.active_modify_number=u.prana=u.command=u.critical_numbers=u.fumble_numbers=u.cmp_op=u.target_number=r,n.$attr_accessor("base"),n.$attr_accessor("modify_number"),c(n,"$initialize",function _(a){var W=this;return _.$$p=null,w(W,x(W,"initialize",_,!1,!0),"initialize",[],null),W.command=a}),c(n,"$passive_modify_number",function(){return m(this.base,this.modify_number)}),c(n,"$to_s",function(){var D,W,F,I,K,a=this;return D=s(a.base["$zero?"]())?r:a.base,W=i("Format").$modifier(a.modify_number),F=i("Format").$modifier(a.active_modify_number),I=s(K=a.prana)?"$"+a.prana:K,""+D+a.command+W+"@"+a.critical_numbers.$join(",")+"#"+a.fumble_numbers.$join(",")+I+F+a.cmp_op+a.target_number})}(N[0],z("Parsed"),N),function(f,o){var e=l(f,o,"Parsed2R6"),n=e.$$prototype;n.passive_modify_number=n.active_modify_number=n.critical_numbers=n.fumble_numbers=n.cmp_op=n.target_number=r,e.$attr_accessor("passive_modify_number"),c(e,"$to_s",function(){var i=this;return"2R6M["+i.passive_modify_number+","+i.active_modify_number+"]C["+i.critical_numbers.$join(",")+"]F["+i.fumble_numbers.$join(",")+"]"+i.cmp_op+i.target_number})}(N[0],z("Parsed")),c(y,"$parse_nw",function(o){try{v("eval_return");var n,$,u=r,_=r;return u=R(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(o),s(u)?((_=z("ParsedNW").$new(this.nw_command))["$base="](u["$[]"](1).$to_i()),_["$modify_number="](z("ArithmeticEvaluator").$eval(u["$[]"](2))),_["$critical_numbers="](s(u["$[]"](3))?q(u["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]),_["$fumble_numbers="](s(u["$[]"](4))?q(u["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]),_["$prana="]((n=u["$[]"](5))===r||null==n?r:n.$to_i()),_["$active_modify_number="](z("ArithmeticEvaluator").$eval(u["$[]"](6))),_["$cmp_op="](z("Normalize").$comparison_operator(u["$[]"](7))),_["$target_number="](($=u["$[]"](8))===r||null==$?r:$.$to_i()),_):r}catch(a){if(a===t.t_eval_return)return a.$v;throw a}}),c(y,"$parse_2r6",function(o){try{v("eval_return");var n,$=r,i=r;return $=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(o),s($)?((i=z("Parsed2R6").$new())["$passive_modify_number="](z("ArithmeticEvaluator").$eval($["$[]"](1))),i["$active_modify_number="](z("ArithmeticEvaluator").$eval($["$[]"](2))),i["$critical_numbers="](s($["$[]"](3))?q($["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]),i["$fumble_numbers="](s($["$[]"](4))?q($["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]),i["$cmp_op="](z("Normalize").$comparison_operator($["$[]"](5))),i["$target_number="]((n=$["$[]"](6))===r||null==n?r:n.$to_i()),i):r}catch(u){if(u===t.t_eval_return)return u.$v;throw u}}),c(y,"$roll_nw",function(o){var e=this,n=r,$=r,i=r,u=r,_=r;for(e.critical_numbers=o.$critical_numbers(),e.fumble_numbers=o.$fumble_numbers(),e.total=0,e.interim_expr="",e.status=r,n=e.$roll_once_first();k(n,"critical");)n=e.$roll_once();return h(n,"fumble")&&s(o.$prana())&&(i=($=e.randomizer.$roll_barabara(o.$prana(),6)).$sum(),u=$.$join(","),e.total=m(e.total,i),e.interim_expr=m(e.interim_expr,"+"+i+"["+u+"]")),_=k(n,"fumble")?e.$fumble_base_number(o):m(o.$passive_modify_number(),o.$active_modify_number()),e.total=m(e.total,_),e.interim_expr=m(_.$to_s(),e.interim_expr),[e.total,e.interim_expr,e.status]}),c(y,"$roll_once",function(o){var $,i,e=this,n=r;return null==o&&(o=!1),$=(n=e.randomizer.$roll_barabara(2,6)).$sum(),i=n.$join(","),s(o)&&s(e.fumble_numbers["$include?"]($))?(e.total=b(e.total,10),e.interim_expr=m(e.interim_expr,"-10["+i+"]"),e.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):s(e.critical_numbers["$include?"]($))?(e.total=m(e.total,10),e.interim_expr=m(e.interim_expr,"+10["+i+"]"),e.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(e.total=m(e.total,$),e.interim_expr=m(e.interim_expr,"+"+$+"["+i+"]"),r)},-1),c(y,"$roll_once_first",function(){return this.$roll_once(!0)}),c(y,"$fumble_base_number",function(o){return o.$passive_modify_number()})},Opal.queue(function(t){var R,h,j,B,S,P,C,v,g=t.module,l=t.klass,d=t.const_set,w=t.rb_plus,x=t.def,s=[];return t.top.$require("bcdice/game_system/NightWizard"),R=s,h=v=[g(s[0],"BCDice")].concat(R),P=[g(v[0],"GameSystem")].concat(h),C=t.$r(P),j=P,d((S=[B=l(P[0],C("NightWizard"),"NightWizard3rd")].concat(j))[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"),d(S[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683"),d(S[0],"ID","NightWizard3rd"),B.$register_prefix("([-+]?\\d+)?NW","2R6"),x(B,"$fumble_base_number",function(M){return w(M.$passive_modify_number(),M.$active_modify_number())})})}}]);