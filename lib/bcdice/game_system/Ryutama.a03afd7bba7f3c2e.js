(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[585],{8123:($e,ie,I)=>{I(9993),Opal.queue(function(i){var U,Z,ne,a,h,m,E,y,ee,C,k=i.module,K=i.klass,v=i.const_set,L=i.send2,N=i.find_super,g=i.def,u=i.truthy,P=i.to_ary,f=i.eqeq,c=i.rb_plus,Y=i.thrower,w=i.neqeq,z=i.rb_divide,d=i.rb_ge,j=i.rb_gt,J=i.rb_lt,B=[],n=i.nil;return U=B,Z=C=[k(B[0],"BCDice")].concat(U),y=[k(C[0],"GameSystem")].concat(Z),ee=i.$r(y),ne=y,h=[a=K(y[0],ee("Base"),"Ryutama")].concat(ne),m=i.$r(h),(E=a.$$prototype).validDiceTypes=E.randomizer=n,v(h[0],"ID","Ryutama"),v(h[0],"NAME","\u308a\u3085\u3046\u305f\u307e"),v(h[0],"SORT_KEY","\u308a\u3086\u3046\u305f\u307e"),v(h[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u3000Rx,y>=t\uff08x,y\uff1a\u4f7f\u7528\u3059\u308b\u80fd\u529b\u5024\u3001t\uff1a\u76ee\u6a19\u5024\uff09\n\u30001\u30be\u30ed\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3082\u542b\u3081\u3066\u5224\u5b9a\u7d50\u679c\u3092\u8868\u793a\u3057\u307e\u3059\n\u3000\u80fd\u529b\u5024\uff11\u3064\u3067\u306e\u5224\u5b9a\u306f Rx>=t \u3067\u884c\u3048\u307e\u3059\n\u4f8b\uff09R8,6>=13\n"),a.$register_prefix("R"),g(a,"$initialize",function o(e){var t=this;return o.$$p=null,L(t,N(t,"initialize",o,!1,!0),"initialize",[e],null),t.validDiceTypes=[20,12,10,8,6,4,2]}),g(a,"$eval_game_system_specific_command",function(e){try{Y("eval_return");var t,$,_=this,s=n,l=n,V=n,D=n,M=n,p=n,x=n,b=n,T=n,R=n,S=n,A=n,F=n;return _.$debug("eval_game_system_specific_command begin"),u(e["$=~"](/^R(\d+)(,(\d+))?([+\-\d]+)?(>=(\d+))?/))?(_.$debug("matched"),s=m("Regexp").$last_match(1).$to_i(),l=m("Regexp").$last_match(3).$to_i(),V=m("Regexp").$last_match(4),D=m("Regexp").$last_match(6),$=_.$getDiceType(s,l),l=null==(t=P($))[1]?n:t[1],f(s=null==t[0]?n:t[0],0)?"":(V=u(M=V)?M:"",p=m("ArithmeticEvaluator").$eval(V),D=_.$getDiffculty(D),x=_.$getRollValue(s),b=_.$getRollValue(l),T=c(c(x,b),p),R=_.$getResultText(x,b,s,l,D,T),u(R["$empty?"]())||(R=" \uff1e "+R),S=x+"("+s+")",A=f(b,0)?"":"+"+b+"("+l+")",F=_.$getModifyString(p),"("+_.$getBaseText(s,l,p,D)+") \uff1e "+S+A+F+" \uff1e "+T+R)):(_.$debug("unmatched!"),"")}catch(q){if(q===i.t_eval_return)return q.$v;throw q}}),g(a,"$getDiceType",function(e,r){var t=this,$=n;return t.$debug("getDiceType begin"),w(r,0)?u(t.$isValidDiceOne(e))?[e,r]:[0,0]:u(t.$isValidDice(e,r))?[e,r]:(e=z($=e,10).$to_i(),r=$["$%"](10),u(t.$isValidDice(e,r))?[e,r]:(e=z($,100).$to_i(),r=$["$%"](100),u(t.$isValidDice(e,r))?[e,r]:u(t.$isValidDiceOne($))?[$,0]:[0,0]))}),g(a,"$isValidDice",function(e,r){var $;return u($=this.$isValidDiceOne(e))?this.$isValidDiceOne(r):$}),g(a,"$isValidDiceOne",function(e){return this.validDiceTypes["$include?"](e)}),g(a,"$getDiffculty",function(e){return u(e["$nil?"]())||(e=e.$to_i()),e}),g(a,"$getRollValue",function(e){return f(e,0)?0:this.randomizer.$roll_once(e)}),g(a,"$getResultText",function(e,r,t,$,_,s){return u(this.$isFamble(e,r))?"\uff11\u30be\u30ed\u3010\uff11\u30be\u30ed\u30dd\u30a4\u30f3\u30c8\uff0b\uff11\u3011":u(this.$isCritical(e,r,t,$))?"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u6210\u529f":u(_["$nil?"]())?"":u(d(s,_))?"\u6210\u529f":"\u5931\u6557"}),g(a,"$isFamble",function(e,r){var t;return u(t=e["$=="](1))?r["$=="](1):t}),g(a,"$isCritical",function(e,r,t,$){return!f(r,0)&&!!(f(e,6)&&f(r,6)||f(e,t)&&f(r,$))}),g(a,"$getBaseText",function(e,r,t,$){var s=n;return s="R"+e,w(r,0)&&(s=c(s,","+r)),s=c(s,this.$getModifyString(t)),u($["$nil?"]())||(s=c(s,">="+$)),s}),g(a,"$getModifyString",function(e){return u(j(e,0))?c("+",e.$to_s()):u(J(e,0))?e.$to_s():""})})}}]);