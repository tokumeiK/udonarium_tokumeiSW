(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[6604],{3042:(X,Z,S)=>{S(9993),Opal.queue(function(a){var W,j,J,T,x,d,k,P,y,A=a.module,q=a.klass,m=a.const_set,M=a.send,l=a.def,b=a.truthy,B=a.to_ary,R=a.rb_gt,u=a.rb_plus,D=a.neqeq,K=a.thrower,w=a.eqeq,C=a.rb_lt,E=a.rb_minus,N=a.rb_le,G=a.rb_divide,I=[],r=a.nil;return W=I,j=y=[A(I[0],"BCDice")].concat(W),k=[A(y[0],"GameSystem")].concat(j),P=a.$r(k),J=k,x=[T=q(k[0],P("Base"),"Torg")].concat(J),d=a.$r(x),T.$$prototype.randomizer=r,m(x[0],"ID","Torg"),m(x[0],"NAME","\u30c8\u30fc\u30b0"),m(x[0],"SORT_KEY","\u3068\u304a\u304f"),m(x[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u3000(TGm)\n\u3000TORG\u5c02\u7528\u306e\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n\u3000"TG(\u6280\u80fd\u57fa\u672c\u5024)"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u5404\u7a2e\u8868\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u4e00\u822c\u7d50\u679c\u8868 \u6210\u529f\u5ea6\u51fa\u529b\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u5a01\u5727/\u5a01\u5687 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cITx or INTIMIDATEx or TESTx\u300d\n\u3000\u30fb\u6311\u767a/\u30c8\u30ea\u30c3\u30af \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cTTx or TAUNTx or TRICKx or CTx\u300d\n\u3000\u30fb\u9593\u5408\u3044 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cMTx or MANEUVERx\u300d\n\u3000\u30fb\u30aa\u30fc\u30ba\uff08\u4e00\u822c\u4eba\uff09\u30c0\u30e1\u30fc\u30b8\u3000\u300cODTx or ORDSx or ODAMAGEx\u300d\n\u3000\u30fb\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u30fc\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),T.$register_prefix("TG","1R20","RT","Result","IT","Intimidate","Test","TT","Taunt","Trick","CT","MT","Maneuver","ODT","ords","odamage","DT","damage","BT","bonus","total"),l(T,"$replace_text",function(t){return t=(t=(t=(t=(t=(t=(t=t.$gsub(/Result/i,"RT")).$gsub(/(Intimidate|Test)/i,"IT")).$gsub(/(Taunt|Trick|CT)/i,"TT")).$gsub(/Maneuver/i,"MT")).$gsub(/(ords|odamage)/i,"ODT")).$gsub(/damage/i,"DT")).$gsub(/(bonus|total)/i,"BT"),(t=M(t,"gsub",[/TG(\d+)/i],function(){return"1R20+"+d("Regexp").$last_match(1)})).$gsub(/TG/i,"1R20")}),l(T,"$torg_check",function(t){try{K("eval_return");var e,$,n=this,_=r,o=r,s=r,c=r,g=r,h=r;return b(/(^|\s)S?(1R20([+-]\d+)*)(\s|$)/i["$=~"](t))?(t=d("Regexp").$last_match(2),_=d("Regexp").$last_match(3),n.$debug(_),b(_)&&(_=d("ArithmeticEvaluator").$eval(_)),n.$debug(_),_=_.$to_i(),$=n.$torg_dice(),s=null==(e=B($))[1]?r:e[1],c=null==e[2]?r:e[2],g=n.$get_torg_bonus(o=null==e[0]?r:e[0]),h=b(_)?b(R(_,0))?g+"["+c+"]+"+_:g+"["+c+"]"+_:g+"["+c+"]",h=u(h,u(" \uff1e ",u(g,_).$to_s())),D(o,s)&&(h=u(h,u(u("(\u6280\u80fd\u7121",u(n.$get_torg_bonus(s),_).$to_s()),")"))),h="("+t+") \uff1e "+h):r}catch(v){if(v===a.t_eval_return)return v.$v;throw v}}),l(T,"$torg_dice",function(){var i=r,e=r,$=r,n=r,_=r,o=r;for(i=!0,e=!0,$=0,n=0,_="";b(i);)o=this.randomizer.$roll_once(20),$=u($,o),b(e)&&(n=u(n,o)),b(_["$empty?"]())||(_=u(_,",")),_=u(_,o.$to_s()),w(o,20)?e=!1:D(o,10)&&(i=!1,e=!1);return[$,n,_]}),l(T,"$eval_game_system_specific_command",function(t){try{K("eval_return");var e,$,o,h,v,n=this,_=r,s=r,c=r,g=r;if(_=t.$upcase(),_=n.$replace_text(_),b(o=n.$torg_check(_)))return o;if(s="1",c="",g=0,!b(/([RITMDB]T)(\d+([+-]\d+)*)/i["$=~"](_)))return r;switch(h=d("Regexp").$last_match(1),v=d("Regexp").$last_match(2),h){case"RT":g=d("ArithmeticEvaluator").$eval(v),s=n.$get_torg_success_level(g),c="\u4e00\u822c\u7d50\u679c";break;case"IT":g=d("ArithmeticEvaluator").$eval(v),s=n.$get_torg_interaction_result_intimidate_test(g),c="\u5a01\u5727/\u5a01\u5687";break;case"TT":g=d("ArithmeticEvaluator").$eval(v),s=n.$get_torg_interaction_result_taunt_trick(g),c="\u6311\u767a/\u30c8\u30ea\u30c3\u30af";break;case"MT":g=d("ArithmeticEvaluator").$eval(v),s=n.$get_torg_interaction_result_maneuver(g),c="\u9593\u5408\u3044";break;case"DT":g=d("ArithmeticEvaluator").$eval(v),b(_["$=~"](/ODT/i))?(s=n.$get_torg_damage_ords(g),c="\u30aa\u30fc\u30ba\u30c0\u30e1\u30fc\u30b8"):(s=n.$get_torg_damage_posibility(g),c="\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8");break;case"BT":$=n.$get_torg_bonus_text(v),s=null==(e=B($))[0]?r:e[0],g=null==e[1]?r:e[1],c="\u30dc\u30fc\u30ca\u30b9"}return D(c,"")&&(s=c+"\u8868["+g+"] \uff1e "+s),s}catch(O){if(O===a.t_eval_return)return O.$v;throw O}}),l(T,"$get_torg_success_level",function(t){return this.$get_torg_table_result(t,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])}),l(T,"$get_torg_interaction_result_intimidate_test",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])}),l(T,"$get_torg_interaction_result_taunt_trick",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])}),l(T,"$get_torg_interaction_result_maneuver",function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u75b2\u52b4"],[10,"\u840e\u7e2e\uff0f\u75b2\u52b4"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])}),l(T,"$get_torg_table_result",function(t,i){var e=r;return e="1",function(){try{var $=K("break");M(i,"each",[],function(_){var o;return null==_&&(_=r),o=_["$[]"](0),b(R(o,t))&&$.$throw(),e=_["$[]"](1)})}catch(n){if(n===$)return n.$v;throw n}}(),e}),l(T,"$get_torg_damage_ords",function(t){return this.$get_torg_damage(t,4,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15",[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"O3"],[5,"K3"],[6,"\u8ee2\u5012 K\uff0fO4"],[7,"\u8ee2\u5012 K\uff0fO5"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO9"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO10"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO11"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO12"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO13"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO14"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15"]])}),l(T,"$get_torg_damage_posibility",function(t){return this.$get_torg_damage(t,3,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5",[[0,"1"],[1,"1"],[2,"O1"],[3,"K2"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 O2"],[7,"\u8ee2\u5012 K2"],[8,"\u8ee2\u5012 K2"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K5"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])}),l(T,"$get_torg_damage",function(t,i,e,$){var _=r,o=r;return b(C(t,0))?"1":(_=E($.$length(),1),b(N(t,_))?this.$get_torg_table_result(t,$):(o=G(E(t,_),2).$to_i(),u(u("",u(o,i).$to_s()),e)))}),l(T,"$get_torg_bonus_text",function(t){try{K("eval_return");var _,e=this,$=r,n=r,o=r,s=r;return n=($=t.$split(/\+/)).$shift().$to_i(),_=d("ArithmeticEvaluator").$eval($.$join("+")),o=e.$get_torg_bonus(n),e.$debug("TORG BT resultValue",o),e.$debug("TORG BT mod",_),w(_,0)?s=o.$to_s():(s=e.$getTorgBonusOutputTextWhenModDefined(n,o,_),n=n+"+"+_),[s,n]}catch(c){if(c===a.t_eval_return)return c.$v;throw c}}),l(T,"$getTorgBonusOutputTextWhenModDefined",function(t,i,e){var $=this;return $.$debug("getTorgBonusOutputTextWhenModDefined value, mod",t,e),b(R(e,0))?i+"["+t+"]+"+e+" \uff1e "+u(i,e):($.$debug("resultValue",i),$.$debug("mod",e),i+"["+t+"]"+e+" \uff1e "+u(i,e))}),l(T,"$get_torg_bonus",function(t){var $=r,n=r;return $=this.$get_torg_table_result(t,[[1,-12],[2,-10],[3,-8],[5,-5],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),b(R(t,20))&&(n=u(G(E(t,21),5).$to_i(),1),$=u($,n)),$})})}}]);