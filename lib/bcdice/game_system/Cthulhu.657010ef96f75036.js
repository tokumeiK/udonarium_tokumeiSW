(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3364],{2605:(O,ee,Q)=>{Q(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(n){var y,K,z,Y,S,E,P,g,w=n.module,T=n.ensure_kwargs,R=n.truthy,F=n.thrower,H=n.def,h=[],b=n.nil,$=n.$$$;return y=h,K=g=[w(h[0],"BCDice")].concat(y),P=[E=w(g[0],"ArithmeticEvaluator")].concat(K),Y=[z=n.get_singleton_class(E)].concat(P),S=n.$r(Y),H(z,"$eval",function(L,q){try{F("eval_return");var d,M=b;return null==(d=(q=T(q)).$$smap.round_type)&&(d=$(S("RoundType"),"FLOOR")),R(L)&&R(M=S("Arithmetic").$eval(L,d))?M:0}catch(A){if(A===n.t_eval_return)return A.$v;throw A}},-2)},Opal.queue(function(n){var q,A,Z,r,t,a,u,m,p,k,D,j,V,d,w=n.module,T=n.klass,R=n.const_set,F=n.send2,H=n.find_super,h=n.def,b=n.eqeqeq,$=n.truthy,B=n.rb_le,y=n.rb_gt,G=n.rb_plus,g=n.send,I=n.thrower,K=n.rb_divide,E=n.rb_times,P=n.rb_lt,z=n.rb_ge,N=n.rb_minus,S=[],i=n.nil;return n.top.$require("bcdice/arithmetic_evaluator"),q=S,A=d=[w(S[0],"BCDice")].concat(q),j=[w(d[0],"GameSystem")].concat(A),V=n.$r(j),Z=j,p=[m=T(j[0],V("Base"),"Cthulhu")].concat(Z),k=n.$r(p),(D=m.$$prototype).randomizer=D.locale=D.special_percentage=D.critical_percentage=D.fumble_percentage=i,R(p[0],"ID","Cthulhu"),R(p[0],"NAME","\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"),R(p[0],"SORT_KEY","\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG"),R(p[0],"HELP_MESSAGE","c=\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024 \uff0f f=\u30d5\u30a1\u30f3\u30d6\u30eb\u5024 \uff0f s=\u30b9\u30da\u30b7\u30e3\u30eb\n\n1d100<=n    c\u30fbf\u30fbs\u3059\u3079\u3066\u30aa\u30d5\uff08\u5358\u7d14\u306a\u6570\u5024\u6bd4\u8f03\u5224\u5b9a\u306e\u307f\u884c\u3044\u307e\u3059\uff09\n\n\u30fbcfs\u5224\u5b9a\u4ed8\u304d\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\n\nCC\t 1d100\u30ed\u30fc\u30eb\u3092\u884c\u3046 c=1\u3001f=100\nCCB  \u540c\u4e0a\u3001c=5\u3001f=96\n\n\u4f8b\uff1aCC<=80  \uff08\u6280\u80fd\u502480\u3067\u884c\u70ba\u5224\u5b9a\u30021%\u30eb\u30fc\u30eb\u3067cf\u9069\u7528\uff09\n\u4f8b\uff1aCCB<=55 \uff08\u6280\u80fd\u502455\u3067\u884c\u70ba\u5224\u5b9a\u30025%\u30eb\u30fc\u30eb\u3067cf\u9069\u7528\uff09\n\n\u30fb\u7d44\u307f\u5408\u308f\u305b\u30ed\u30fc\u30eb\u306b\u3064\u3044\u3066\n\nCBR(x,y)\tc=1\u3001f=100\nCBRB(x,y)\tc=5\u3001f=96\n\n\u30fb\u62b5\u6297\u8868\u30ed\u30fc\u30eb\u306b\u3064\u3044\u3066\nRES(x-y)\tc=1\u3001f=100\nRESB(x-y)\tc=5\u3001f=96\n\n\u203b\u6545\u969c\u30ca\u30f3\u30d0\u30fc\u5224\u5b9a\n\n\u30fbCC(x) c=1\u3001f=100\nx=\u6545\u969c\u30ca\u30f3\u30d0\u30fc\u3002\u51fa\u76eex\u4ee5\u4e0a\u304c\u51fa\u305f\u4e0a\u3067\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u304c\u540c\u6642\u306b\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u5171\u306b\u51fa\u529b\u3059\u308b\uff08\u30c6\u30ad\u30b9\u30c8\u300c\u30d5\u30a1\u30f3\u30d6\u30eb\uff06\u6545\u969c\u300d\uff09\n\u30d5\u30a1\u30f3\u30d6\u30eb\u3067\u306a\u3044\u5834\u5408\u3001\u6210\u529f\u30fb\u5931\u6557\u306b\u95a2\u308f\u3089\u305a\u30c6\u30ad\u30b9\u30c8\u300c\u6545\u969c\u300d\u306e\u307f\u3092\u51fa\u529b\u3059\u308b\uff08\u6210\u529f\u30fb\u5931\u6557\u3092\u51fa\u529b\u305b\u305a\u3001\u4e0a\u66f8\u304d\u3057\u305f\u3082\u306e\u3092\u51fa\u529b\u3059\u308b\u5f62\uff09\n\n\u30fbCCB(x) c=5\u3001f=96\n\u540c\u4e0a\n\n"),m.$register_prefix("CCB?","RESB?","CBRB?"),h(m,"$initialize",function v(s){var t=this;return v.$$p=null,F(t,H(t,"initialize",v,!1,!0),"initialize",[s],null),t.special_percentage=20,t.critical_percentage=1,t.fumble_percentage=1}),h(m,"$eval_game_system_specific_command",function(s){var t,r=this;return b(/CCB/i,t=s)?(r.critical_percentage=5,r.fumble_percentage=5,r.$getCheckResult(s)):b(/CC/i,t)?(r.critical_percentage=1,r.fumble_percentage=1,r.$getCheckResult(s)):b(/RESB/i,t)?(r.critical_percentage=5,r.fumble_percentage=5,r.$getRegistResult(s)):b(/CBRB/i,t)?(r.critical_percentage=5,r.fumble_percentage=5,r.$getCombineRoll(s)):b(/RES/i,t)?(r.critical_percentage=1,r.fumble_percentage=1,r.$getRegistResult(s)):b(/CBR/i,t)?(r.critical_percentage=1,r.fumble_percentage=1,r.$getCombineRoll(s)):i}),m.$private(),h(m,"$getCheckResult",function(s){try{I("eval_return");var t=this,a=i,u=i,c=i,e=i,l=i,f=i;return a=/^CCB?(\d+)?(?:<=([+-\/*\d]+))?$/i.$match(s),$(a)?(u=a["$[]"](1).$to_i(),c=k("ArithmeticEvaluator").$eval(a["$[]"](2)),$(B(c,0))?(e=t.randomizer.$roll_once(100),k("Result").$new("(1D100) \uff1e "+e)):(l="(1D100<="+c+")",$(y(u,0))&&(l=G(l," "+t.$translate("Cthulhu.broken_number")+"["+u+"]")),e=t.randomizer.$roll_once(100),f=t.$compare(e,c,u),g(f.$to_result(),"tap",[],function(o){var C;return null==o&&(o=i),C=[l+" \uff1e "+e+" \uff1e "+f.$text()],g(o,"text=",C),C[C.length-1]}))):i}catch(_){if(_===n.t_eval_return)return _.$v;throw _}}),r=p,a=[t=T(p[0],null,"CompareResult")].concat(r),u=n.$r(a),t.$include(u("Translate")),t.$attr_accessor("success","failure","critical","fumble","special","broken"),h(t,"$initialize",function(e){var l=this;return l.locale=e,l.success=!1,l.failure=!1,l.critical=!1,l.fumble=!1,l.special=!1,l.broke=!1}),h(t,"$text",function(){var e=this;return $(e.$critical())&&$(e.$special())?e.$translate("Cthulhu.critical_special"):$(e.$critical())?e.$translate("Cthulhu.critical"):$(e.$special())?e.$translate("Cthulhu.special"):$(e.$success())?e.$translate("success"):$(e.$broken())&&$(e.$fumble())?e.$translate("Cthulhu.fumble")+"/"+e.$translate("Cthulhu.broken"):$(e.$broken())?e.$translate("Cthulhu.broken"):$(e.$fumble())?e.$translate("Cthulhu.fumble"):$(e.$failure())?e.$translate("failure"):i}),h(t,"$to_result",function(){return g(u("Result").$new(),"tap",[],function l(f){var _,o=null==l.$$s?this:l.$$s;return null==f&&(f=i),f["$success="](o.$success()),f["$failure="](o.$failure()),f["$critical="](o.$critical()),_=[o.$fumble()],g(f,"fumble=",_),_[_.length-1]},{$$s:this})}),h(m,"$compare",function(s,r,t){var c,a=this,u=i;return null==t&&(t=0),u=k("CompareResult").$new(a.locale),c=K(E(r,a.special_percentage),100).$to_i().$clamp(1,100),$(B(s,r))&&$(P(s,100))?(u["$success="](!0),u["$special="](B(s,c)),u["$critical="](B(s,a.critical_percentage))):(u["$failure="](!0),u["$fumble="](z(s,N(101,a.fumble_percentage)))),$(y(t,0))&&$(z(s,t))&&(u["$broken="](!0),u["$failure="](!0),u["$success="](!1),u["$special="](!1),u["$critical="](!1)),u},-3),h(m,"$getRegistResult",function(s){var r=this,t=i,a=i,u=i,c=i,e=i;return t=/^RESB?(-?\d+)$/i.$match(s),$(t)?(a=t["$[]"](1).$to_i(),u=G(E(a,5),50),$(P(u,5))?k("Result").$failure("(1d100<="+u+") \uff1e "+r.$translate("Cthulhu.automatic_failure")):$(y(u,95))?k("Result").$success("(1d100<="+u+") \uff1e "+r.$translate("Cthulhu.automatic_success")):(c=r.randomizer.$roll_once(100),e=r.$compare(c,u),g(e.$to_result(),"tap",[],function(f){var _;return null==f&&(f=i),_=["(1d100<="+u+") \uff1e "+c+" \uff1e "+e.$text()],g(f,"text=",_),_[_.length-1]}))):i}),h(m,"$getCombineRoll",function(s){var r=this,t=i,a=i,u=i,c=i,e=i,l=i,f=i;return t=/^CBR(B)?\((\d+),(\d+)\)$/i.$match(s),$(t)?(a=t["$[]"](2).$to_i(),u=t["$[]"](3).$to_i(),c=r.randomizer.$roll_once(100),e=r.$compare(c,a),l=r.$compare(c,u),f=$(e.$success())&&$(l.$success())?r.$translate("success"):$(e.$success())||$(l.$success())?r.$translate("Cthulhu.partial_success"):r.$translate("failure"),g(k("Result").$new(),"tap",[],function(o){var C,x=i;return null==o&&(o=i),o["$text="]("(1d100<="+a+","+u+") \uff1e "+c+"["+e.$text()+","+l.$text()+"] \uff1e "+f),o["$critical="]($(x=e.$critical())?x:l.$critical()),o["$fumble="]($(x=e.$fumble())?x:l.$fumble()),C=[$(x=e.$success())?x:l.$success()],g(o,"condition=",C),C[C.length-1]})):i})})}}]);