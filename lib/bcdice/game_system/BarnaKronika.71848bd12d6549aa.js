(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7073],{5396:(D,O,W)=>{W(9993),Opal.queue(function(a){var I,F,Z,_,v,k,M,Q,N,S=a.module,E=a.klass,x=a.const_set,H=a.send2,w=a.find_super,h=a.def,B=a.send,f=a.truthy,y=a.to_ary,l=a.rb_plus,p=a.rb_gt,q=a.eqeq,R=a.neqeq,G=a.rb_minus,K=a.rb_times,T=a.rb_lt,L=[],t=a.nil;return I=L,F=N=[S(L[0],"BCDice")].concat(I),M=[S(N[0],"GameSystem")].concat(F),Q=a.$r(M),Z=M,v=[_=E(M[0],Q("Base"),"BarnaKronika")].concat(Z),k=a.$r(v),_.$$prototype.isBattleMode=t,x(v[0],"ID","BarnaKronika"),x(v[0],"NAME","\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab"),x(v[0],"SORT_KEY","\u306f\u308b\u306a\u304f\u308d\u306b\u304b"),x(v[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000nBK\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30bb\u30c3\u30c8\u6570\u304c1\u4ee5\u4e0a\u306e\u6642\u306f\u30bb\u30c3\u30c8\u6570\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n\u30fb\u653b\u6483\u5224\u5b9a\u3000nBA\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u3001\u653b\u6483\u5024\u3068\u547d\u4e2d\u90e8\u4f4d\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u3000nBKCt\u3000nBACt\n\u3000\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u308d\u306b\u300cCt\u300d\u3092\u4ed8\u3051\u308b\u3068\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u3067\u3059\u3002\n\u3000\u30c0\u30a4\u30b9\u6570n,\u30b3\u30fc\u30eb\u6570t\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30bb\u30c3\u30c8\u6570\u304c1\u4ee5\u4e0a\u306e\u6642\u306f\u30bb\u30c3\u30c8\u6570\u3082\u8868\u793a\u3057\u3001\u653b\u6483\u5224\u5b9a\u306e\u5834\u5408\u306f\u547d\u4e2d\u90e8\u4f4d\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n"),_.$register_prefix("\\d+BK","\\d+BA","\\d+BKC","\\d+BAC","\\d+R6"),h(_,"$initialize",function m(n){var r=this;return m.$$p=null,H(r,w(r,"initialize",m,!1,!0),"initialize",[n],null),r.sort_add_dice=!0,r.sort_barabara_dice=!0}),h(_,"$replace_text",function(n){return n=B(n,"gsub",[/(\d+)BKC(\d)/],function(){return k("Regexp").$last_match(1)+"R6[0,"+k("Regexp").$last_match(2)+"]"}),n=B(n,"gsub",[/(\d+)BAC(\d)/],function(){return k("Regexp").$last_match(1)+"R6[1,"+k("Regexp").$last_match(2)+"]"}),n=B(n,"gsub",[/(\d+)BK/],function(){return k("Regexp").$last_match(1)+"R6[0,0]"}),B(n,"gsub",[/(\d+)BA/],function(){return k("Regexp").$last_match(1)+"R6[1,0]"})}),h(_,"$eval_game_system_specific_command",function(n){var e,r,i=this,s=t,$=t,d=t,b=t,o=t,c=t,u=t,g=t;return n=i.$replace_text(n),f(/(^|\s)S?((\d+)[rR]6(\[([,\d]+)\])?)(\s|$)/i["$=~"](n))?(n=k("Regexp").$last_match(2),s=k("Regexp").$last_match(5),$=k("Regexp").$last_match(3),$=f(d=$)?d:1,i.isBattleMode=!1,b=0,f(s)&&(r=B(s.$split(","),"map",[],"to_i".$to_proc()),b=null==(e=y(r))[1]?t:e[1],i.isBattleMode=(null==e[0]?t:e[0])["$=="](1)),i.$debug("@isBattleMode",i.isBattleMode),r=i.$roll_barna_kronika($,b),o=null==(e=y(r))[1]?t:e[1],c=null==e[2]?t:e[2],u=null==e[3]?t:e[3],g="("+n+") \uff1e ["+(null==e[0]?t:e[0])+"] \uff1e ",f(i.isBattleMode)?g=l(g,u):(i.$debug("suc",o),g=f(p(o,1))?l(g,"\u6210\u529f\u6570"+o):l(g,"\u5931\u6557"),i.$debug("set",c),f(p(c,0))&&(g=l(g,",\u30bb\u30c3\u30c8"+c))),g):t}),h(_,"$roll_barna_kronika",function(n,e){var r=this,i=t,s=t,$=t,d=t,b=t,A=t;return n=n.$to_i(),i="",s=0,$=0,d="",b=[0,0,0,0,0,0],B(n,"times",[],function C(o){var u,c=null==C.$$s?this:C.$$s;return null==c.randomizer&&(c.randomizer=t),null==o&&(o=t),u=c.randomizer.$roll_index(6),b["$[]="](u,l(b["$[]"](u),1)),f(p(b["$[]"](u),s))?s=b["$[]"](u):t},{$$s:r}),B(6,"times",[],function C(o){var u,c=null==C.$$s?this:C.$$s;return null==o&&(o=t),u=b["$[]"](o),q(u,0)?t:(B(u,"times",[],function(z){return null==z&&(z=t),i=l(i,l(o,1)+",")}),f(c.$isCriticalCall(o,e))?(c.$debug("isCriticalCall"),d=l(d,c.$getAttackStringWhenCriticalCall(o,u))):f(c.$isNomalAttack(e,u))&&(c.$debug("isNomalAttack"),d=l(d,c.$getAttackStringWhenNomal(o,u))),f(p(u,1))?$=l($,1):t)},{$$s:r}),R(e,0)&&(A=b["$[]"](G(e,1)),s=K(A,2),$=R(A,0)?1:0),f(r.isBattleMode)&&f(T(s,2))&&(d="\u5931\u6557"),i=i.$sub(/,$/,""),d=d.$sub(/,$/,""),[i,s,$,d]}),h(_,"$isCriticalCall",function(n,e){return!(!f(this.isBattleMode)||q(e,0))&&e["$=="](l(n,1))}),h(_,"$isNomalAttack",function(n,e){return!(!f(this.isBattleMode)||R(n,0))&&p(e,1)}),h(_,"$getAttackStringWhenCriticalCall",function(n,e){var i,s;return i=this.$getAttackHitLocation(l(n,1)),s=K(e,2),l(i,":\u653b\u6483\u5024"+s+",")}),h(_,"$getAttackStringWhenNomal",function(n,e){var i;return i=this.$getAttackHitLocation(l(n,1)),l(i,":\u653b\u6483\u5024"+e+",")}),h(_,"$getAttackHitLocation",function(n){return this.$get_table_by_number(n,[[1,"\u982d\u90e8"],[2,"\u53f3\u8155"],[3,"\u5de6\u8155"],[4,"\u53f3\u811a"],[5,"\u5de6\u811a"],[6,"\u80f4\u4f53"]])})})}}]);