(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[9931],{9543:(re,ne,H)=>{H(9993),Opal.queue(function(d){var J,W,ee,f,P,S,U,Z,j,M=d.module,I=d.klass,q=d.const_set,a=d.truthy,y=d.def,L=d.send,D=d.to_ary,w=d.rb_gt,s=d.rb_plus,E=d.neqeq,x=d.thrower,B=d.eqeq,G=d.rb_le,k=d.rb_lt,z=d.rb_minus,K=d.rb_divide,N=[],e=d.nil;return J=N,W=j=[M(N[0],"BCDice")].concat(J),U=[M(j[0],"GameSystem")].concat(W),Z=d.$r(U),ee=U,P=[f=I(U[0],Z("Base"),"TorgEternity")].concat(ee),S=d.$r(P),f.$$prototype.randomizer=e,q(P[0],"ID","TorgEternity"),q(P[0],"NAME","\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3"),q(P[0],"SORT_KEY","\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044"),q(P[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\n\u3000\u30fbTG\n\u3000\u3000"TG[m]"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000\u3000m\u306f\u6280\u80fd\u57fa\u672c\u5024\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000(TORG\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u3058\u6319\u52d5\u3092\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u306e\u8aad\u307f\u66ff\u3048\u306e\u307f\u3001Eternity\u7248\u3068\u306a\u308a\u307e\u3059)\n\u3000\u30fbTE\n\u3000\u3000"TE"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u3000\u30fbUP\n\u3000\u3000"UP[m]"\u3067\u9ad8\u63da\u72b6\u614b\u306e\u30ed\u30fc\u30eb(\u901a\u5e38\u306e1d20\u306b\u52a0\u3048\u30011d20\u3092\u8ffd\u52a0\u3067\u632f\u308a\u8db3\u3057)\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002m\u306f\u6280\u80fd\u57fa\u672c\u5024\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000\u3000\u5404\u30ed\u30fc\u30eb\u3067\u306e\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u4e00\u6295\u76ee\u3067\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u3001\u4e8c\u6295\u76ee\u306f\u884c\u308f\u308c\u307e\u305b\u3093\u3002\n\u3000\u30fbPOS\n\u3000\u3000"POSm"\u3067\u3001\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u4f7f\u7528\u306b\u3088\u308b1d20\u306e\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000m\u306f\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u3092\u4f7f\u7528\u3059\u308b\u524d\u306e\u30ed\u30fc\u30eb\u7d50\u679c\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000\u3000\u51fa\u76ee\u304c10\u672a\u6e80\u306e\u5834\u5408\u306f\u300110\u3078\u306e\u8aad\u307f\u66ff\u3048\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\u3000\u3000\u307e\u305f\u3001\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb\n\u3000"xBD[+y]"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000x\u306f\u30c0\u30e1\u30fc\u30b8\u30c0\u30a4\u30b9\u6570\u3002y\u306f\u30c0\u30e1\u30fc\u30b8\u57fa\u672c\u5024 or \u5f0f\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000x\u306f1\u4ee5\u4e0a\u304c\u5fc5\u8981\u3067\u3059\u30020\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u30de\u30a4\u30ca\u30b9\u5024\u306f\u30b3\u30de\u30f3\u30c9\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u632f\u308a\u8db3\u3057\u51e6\u7406\u306f\u81ea\u52d5\u3067\u884c\u308f\u308c\u307e\u3059\u3002(\u632f\u308a\u8db3\u3057\u767a\u751f\u6642\u306e\u76ee\u306f\u3001\u300c5\u221e\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059)\n\u30fb\u5404\u7a2e\u8868\n\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u6210\u529f\u30ec\u30d9\u30eb\u8868\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),f.$register_prefix("TE","UP","POS","\\d+BD","TG","RT","Result","DT","damage","BT","bonus","total","1R20"),y(f,"$eval_game_system_specific_command",function(_){var t,r,i,$,l,c,o,n=this;return a(t=a(r=a(i=a($=a(l=a(c=a(o=n.$torg_check(_))?o:n.$getRolld20DiceCommandResult(_))?c:n.$getUpRollDiceCommandResult(_))?l:n.$getPossibilityRollDiceCommandResult(_))?$:n.$getBonusDamageDiceCommandResult(_))?i:n.$getSuccessLevelDiceCommandResult(_))?r:n.$getDamageResultDiceCommandResult(_))?t:n.$getRollBonusDiceCommandResult(_)}),f.$private(),y(f,"$replace_text",function(_){return(_=L(_,"gsub",[/TG(\d+)/i],function(){return"1R20+"+S("Regexp").$last_match(1)})).$gsub(/TG/i,"1R20")}),y(f,"$torg_check",function(_){try{x("eval_return");var t,r,i=this,$=e,l=e,c=e,o=e,u=e,g=e,m=e;return _=i.$replace_text(_),$=/^1R20(([+-]\d+)*)$/i.$match(_),a($)?(l=$["$[]"](1),i.$debug(l),a(l)&&(l=S("ArithmeticEvaluator").$eval(l)),i.$debug(l),l=l.$to_i(),r=i.$torg_eternity_dice(!1,!1),o=null==(t=D(r))[1]?e:t[1],u=null==t[2]?e:t[2],g=i.$get_torg_eternity_bonus(c=null==t[0]?e:t[0]),m=a(l)?a(w(l,0))?g+"["+u+"]+"+l:g+"["+u+"]"+l:g+"["+u+"]",m=s(m,s(" \uff1e ",s(g,l).$to_s())),E(c,o)&&(m=s(m,s(s("(\u6280\u80fd\u7121",s(i.$get_torg_eternity_bonus(o),l).$to_s()),")"))),m="("+_+") \uff1e "+m):e}catch(h){if(h===d.t_eval_return)return h.$v;throw h}}),y(f,"$getRolld20DiceCommandResult",function(_){var n,t,r=this,i=e,$=e,l=e,o=e,u=e;return r.$debug("Torg Eternity Dice Roll Command ? ",_),B(_,"TE")?(t=r.$torg_eternity_dice(!1,!0),i=null==(n=D(t))[0]?e:n[0],$=null==n[1]?e:n[1],l=null==n[2]?e:n[2],B(null==n[3]?e:n[3],1)?o="d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+l+"] \uff1e Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01":(u=r.$format("%+d",r.$get_torg_eternity_bonus(i)),o=E(i,$)?"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+l+"] \uff1e "+u+"["+i+"]\uff08\u6280\u80fd\u6709\uff09 / "+r.$format("%+d",r.$get_torg_eternity_bonus($))+"["+$+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+l+"] \uff1e "+u+"["+i+"]"),o):e}),y(f,"$getUpRollDiceCommandResult",function(_){var n,t,r=this,i=e,$=e,l=e,c=e,o=e,u=e,h=e,T=e,b=e,R=e,C=e,A=e;return r.$debug("Torg Eternity Dice Roll ( UP ) Command ? ",_),i=/^UP(\d*)$/i.$match(_),a(i)?($=[],l=i["$[]"](1).$to_i(),t=r.$torg_eternity_dice(!1,!0),c=null==(n=D(t))[0]?e:n[0],o=null==n[1]?e:n[1],u=null==n[2]?e:n[2],B(null==n[3]?e:n[3],1)?$=["d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09","1d20["+u+"]","Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01"].$compact():(t=r.$torg_eternity_dice(!1,!1),h=null==(n=D(t))[1]?e:n[1],T=null==n[2]?e:n[2],b=s(c,null==n[0]?e:n[0]),R=s(o,h),C=r.$format("%+d",r.$get_torg_eternity_bonus(b)),A=r.$format("%+d",r.$get_torg_eternity_bonus(R)),$=a(G(l,0))?E(b,R)?["d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09","1d20["+u+"] + 1d20["+T+"]",C+"["+b+"]\uff08\u6280\u80fd\u6709\uff09 / "+A+"["+R+"]\uff08\u6280\u80fd\u7121\uff09"].$compact():["d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09","1d20["+u+"] + 1d20["+T+"]",C+"["+b+"]"].$compact():E(b,R)?["d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09","1d20["+u+"] + 1d20["+T+"] + "+l,C+"["+b+"]+"+l+"\uff08\u6280\u80fd\u6709\uff09 / "+A+"["+R+"]+"+l+"\uff08\u6280\u80fd\u7121\uff09",s(s(s(r.$format("%+d",s(C.$to_i(),l)),"\uff08\u6280\u80fd\u6709\uff09 / "),r.$format("%+d",s(A.$to_i(),l))),"\uff08\u6280\u80fd\u7121\uff09")].$compact():["d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09","1d20["+u+"] + 1d20["+T+"] + "+l,C+"["+b+"]+"+l,r.$format("%+d",s(C.$to_i(),l))].$compact()),$.$join(" \uff1e ")):e}),y(f,"$getPossibilityRollDiceCommandResult",function(_){try{x("eval_return");var t,r,i=this,$=e,l=e,o=e,u=e,g=e,m=e,h=e;return i.$debug("Torg Eternity Possibility Roll Command ? ",_),$=/^POS((\d+)(\+\d+)?)$/i.$match(_),a($)?(l=S("ArithmeticEvaluator").$eval($["$[]"](1)),r=i.$torg_eternity_dice(!0,!1),o=null==(t=D(r))[1]?e:t[1],u=null==t[2]?e:t[2],g=s(null==t[0]?e:t[0],l),m=s(o,l),h=i.$format("%+d",i.$get_torg_eternity_bonus(g)),E(g,m)?"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+l+"+1d20["+u+"] \uff1e "+h+"["+g+"]\uff08\u6280\u80fd\u6709\uff09 / "+i.$format("%+d",i.$get_torg_eternity_bonus(m))+"["+m+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+l+"+1d20["+u+"] \uff1e "+h+"["+g+"]"):e}catch(R){if(R===d.t_eval_return)return R.$v;throw R}}),y(f,"$getBonusDamageDiceCommandResult",function(_){var n,t,r=this,i=e,$=e,l=e,c=e,o=e,u=e;return r.$debug("TorgEternity Bonus Damage Roll Command ? ",_),i=/^(\d+)(BD)(([+-]\d+)*)$/i.$match(_),a(i)?($=i["$[]"](1).$to_i(),t=r.$get_torg_eternity_modifier(i["$[]"](3)),l=null==(n=D(t))[0]?e:n[0],c=null==n[1]?e:n[1],a(G($,0))?o="\u30a8\u30e9\u30fc\u3067\u3059\u3002xBD (x\u22671) \u3068\u3057\u3066\u4e0b\u3055\u3044":(t=r.$get_torg_eternity_damage_bonus_dice($),o="\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb("+$+"BD"+c+") \uff1e "+(u=null==(n=D(t))[0]?e:n[0])+"["+(null==n[1]?e:n[1])+"]"+c+" \uff1e "+s(u,l)+"\u30c0\u30e1\u30fc\u30b8"),o):e}),y(f,"$getSuccessLevelDiceCommandResult",function(_){try{x("eval_return");var t=this,r=e,i=e,$=e;return t.$debug("TorgEternity Success Level Table Command ? ",_),r=/^(RT|Result)(-*\d+([+-]\d+)*)$/i.$match(_),a(r)?(i=S("ArithmeticEvaluator").$eval(r["$[]"](2)),t.$debug(i),$=a(k(i,0))?"Failure.":t.$get_torg_eternity_success_level(i),t.$debug($="\u6210\u529f\u30ec\u30d9\u30eb\u8868["+i+"] \uff1e "+$),$):e}catch(l){if(l===d.t_eval_return)return l.$v;throw l}}),y(f,"$getDamageResultDiceCommandResult",function(_){try{x("eval_return");var t=this,r=e,i=e,$=e;return t.$debug("TorgEternity Damage Result Table Command ? ",_),r=/^(DT|Damage)(-*\d+([+-]\d+)*)$/i.$match(_),a(r)?(i=S("ArithmeticEvaluator").$eval(r["$[]"](2)),t.$debug(i),$=t.$get_torg_eternity_damage_result(i),t.$debug($="\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868["+i+"] \uff1e "+$),$):e}catch(l){if(l===d.t_eval_return)return l.$v;throw l}}),y(f,"$getRollBonusDiceCommandResult",function(_){var n,t,r=this,i=e,$=e,l=e,c=e,o=e,u=e,g=e;return r.$debug("TorgEternity Roll Bonus Table Command ? ",_),i=/^(BT|Bonus|Total)(\d+)(([+-]\d+)*)$/i.$match(_),a(i)?($=i["$[]"](2).$to_i(),l=r.$get_torg_eternity_bonus($),r.$debug(l),t=r.$get_torg_eternity_modifier(i["$[]"](3)),c=null==(n=D(t))[0]?e:n[0],o=null==n[1]?e:n[1],a(G($,1))?u="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+$+"] \uff1e Mishap!!":a(o["$empty?"]())?u="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+$+"] \uff1e "+l:(g=s(l.$to_i(),c),r.$debug(g),u="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+$+"]"+o+" \uff1e "+l+"["+$+"]"+o+" \uff1e "+g),r.$debug(u),u):e}),y(f,"$get_torg_eternity_table_result",function(_,n){var t=e;return t=e,function(){try{var r=x("break");L(n,"each",[],function($){var l;return null==$&&($=e),l=$["$[]"](0),a(w(l,_))&&r.$throw(),t=$["$[]"](1)})}catch(i){if(i===r)return i.$v;throw i}}(),t}),y(f,"$get_torg_eternity_modifier",function(_){try{x("eval_return");var t=this,r=e,i=e;return t.$debug("modifier check : "+_),B(_,"")?(r=0,i=""):(r=S("ArithmeticEvaluator").$eval(_),i=t.$format("%+d",r)),t.$debug(r),t.$debug(i),[r,i]}catch($){if($===d.t_eval_return)return $.$v;throw $}}),y(f,"$torg_eternity_dice",function(_,n){var r=e,i=e,$=e,l=e,c=e,o=e,u=e,g=e;for(r=!0,i=!0,$=0,l=0,c=0,o="";a(r);)a(o["$empty?"]())||(o=s(o,",")),u=this.randomizer.$roll_once(20),a(_)?(a(k(u,10))?(g=u+"\u219210",u=10,r=!1):g=u.$to_s(),o=s(o,g)):o=s(o,u.$to_s()),$=s($,u),a(i)&&(l=s(l,u)),B(u,20)?i=!1:E(u,10)&&(r=!1,i=!1,a(n["$&"](u["$=="](1)))&&(c=1)),_=!1,n=!1;return[$,l,o,c]}),y(f,"$get_torg_eternity_damage_bonus_dice",function(_){var n=this,t=e,r=e,i=e,$=e;if(n.$debug("bonus dice roll : "+_),t=0,r="",a(w(_,0)))for(t=0,r="";a(w(_,0));)a(r["$empty?"]())||(r+=","),$=(i=n.randomizer.$roll_once(6)).$to_s(),B(i,6)&&(i=5,$="5\u221e",_=s(_,1)),t=s(t,i),r=""+r+$,n.$debug(t),n.$debug(r),_=z(_,1);else r="0";return n.$debug(t),n.$debug(r),[t,r]}),y(f,"$get_torg_eternity_success_level",function(_){return this.$get_torg_eternity_table_result(_,[[0,"Success - Standard."],[5,"Success - Good!"],[10,"Success - Outstanding!!"]])}),y(f,"$get_torg_eternity_damage_result",function(_){return this.$get_torg_eternity_table_result(_,[[-50,"\u30ce\u30fc\u30c0\u30e1\u30fc\u30b8"],[-5,"1\u30b7\u30e7\u30c3\u30af"],[0,"2\u30b7\u30e7\u30c3\u30af"],[5,"1\u30ec\u30d9\u30eb\u8ca0\u50b7 + 2\u30b7\u30e7\u30c3\u30af"],[10,"2\u30ec\u30d9\u30eb\u8ca0\u50b7 + 4\u30b7\u30e7\u30c3\u30af"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7 + 6\u30b7\u30e7\u30c3\u30af"],[20,"4\u30ec\u30d9\u30eb\u8ca0\u50b7 + 8\u30b7\u30e7\u30c3\u30af"],[25,"5\u30ec\u30d9\u30eb\u8ca0\u50b7 + 10\u30b7\u30e7\u30c3\u30af"],[30,"6\u30ec\u30d9\u30eb\u8ca0\u50b7 + 12\u30b7\u30e7\u30c3\u30af"],[35,"7\u30ec\u30d9\u30eb\u8ca0\u50b7 + 14\u30b7\u30e7\u30c3\u30af"],[40,"8\u30ec\u30d9\u30eb\u8ca0\u50b7 + 16\u30b7\u30e7\u30c3\u30af"],[45,"9\u30ec\u30d9\u30eb\u8ca0\u50b7 + 18\u30b7\u30e7\u30c3\u30af"],[50,"10\u30ec\u30d9\u30eb\u8ca0\u50b7 + 20\u30b7\u30e7\u30c3\u30af"]])}),y(f,"$get_torg_eternity_bonus",function(_){var r=e,i=e;return r=this.$get_torg_eternity_table_result(_,[[1,-10],[2,-8],[3,-6],[5,-4],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),a(w(_,20))&&(i=s(K(z(_,21),5).$to_i(),1),r=s(r,i)),r})})}}]);