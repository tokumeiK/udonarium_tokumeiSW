(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2399],{5563:(be,ge,ve)=>{ve(9993),Opal.modules["i18n/backend/fallbacks"]=function(e){var X,$,r,l,a,_,W=e.module,P=e.class_variable_set,o=e.truthy,C=e.class_variable_get,D=e.def,k=e.send,F=e.send2,S=e.find_super,L=e.hash2,A=e.find_block_super,R=e.neqeq,j=e.thrower,K=e.return_val,N=[],B=e.nil,x=e.$$$;return X=N,_=[a=W(N[0],"I18n")].concat(X),P(_[0],"@@fallbacks",B),$=e.get_singleton_class(a),r=[$].concat(_),l=e.$r(r),D($,"$fallbacks",function(){var E=B;return P(r[1],"@@fallbacks",o(null!=r[1].$$cvars["@@fallbacks"]?"class variable":B)&&o(E=C(r[1],"@@fallbacks",!1))?E:x(x(l("I18n"),"Locale"),"Fallbacks").$new()),o(E=l("Thread").$current()["$[]"]("i18n_fallbacks"))?E:C(r[1],"@@fallbacks",!1)}),D($,"$fallbacks=",function(M){var E;return P(r[1],"@@fallbacks",o(M["$is_a?"](l("Array")))?x(x(l("I18n"),"Locale"),"Fallbacks").$new(M):M),E=["i18n_fallbacks",C(r[1],"@@fallbacks",!1)],k(l("Thread").$current(),"[]=",E),E[E.length-1]}),function($,w){var M,E,h,d,l=[W($,"Backend")].concat(w);return M=l,h=[E=W(l[0],"Fallbacks")].concat(M),d=e.$r(h),D(E,"$translate",function y(v,T,c){try{var g=j("return"),f=y.$$p||B,z=this,p=B,m=B;return y.$$p=null,null==c&&(c=d("EMPTY_HASH")),o(c.$fetch("fallback",!0))?o(c["$[]"]("fallback_in_progress"))?F(z,S(z,"translate",y,!1,!0),"translate",[v,T,c],f):(o(c["$[]"]("default"))&&(p=z["$extract_non_symbol_default!"](c)),m=c.$merge(L(["fallback_in_progress"],{fallback_in_progress:!0})),k(d("I18n").$fallbacks()["$[]"](v),"each",[],function s(u){var n=null==s.$$s?this:s.$$s;null==u&&(u=B);try{return k(n,"catch",["exception"],function i(){var t=null==i.$$s?this:i.$$s,G=B;if(G=F(t,A(t,"translate",i.$$def||s.$$def||y,!1,!1),"translate",[u,T,m],null),o(G["$nil?"]()))return B;R(v.$to_s(),u.$to_s())&&t.$on_fallback(v,u,T,c),g.$throw(G)},{$$s:n,$$ret:g})}catch(i){if(!e.rescue(i,[x(d("I18n"),"InvalidLocale")]))throw i;try{return B}finally{e.pop_exception()}}},{$$s:z}),o(c["$key?"]("default"))&&o(c["$[]"]("default")["$nil?"]())?B:o(p)?F(z,S(z,"translate",y,!1,!0),"translate",[v,B,c.$merge(L(["default"],{default:p}))],null):z.$throw("exception",x(d("I18n"),"MissingTranslation").$new(v,T,c))):F(z,S(z,"translate",y,!1,!0),"translate",[v,T,c],f)}catch(s){if(s===g)return s.$v;throw s}},-3),D(E,"$extract_non_symbol_default!",function(v){var c,T=B;return T=[v["$[]"]("default")].$flatten(),c=k(T,"detect",[],function(f){return null==f&&(f=B),f["$is_a?"](d("Symbol"))["$!"]()}),o(c)&&v["$[]="]("default",T["$[]"](0,T.$index(c))),c}),D(E,"$exists?",function y(v,T,c){try{var g=j("return"),f=y.$$p||B,z=this;return y.$$p=null,null==c&&(c=d("EMPTY_HASH")),o(c.$fetch("fallback",!0))?(k(d("I18n").$fallbacks()["$[]"](v),"each",[],function p(m){var s=null==p.$$s?this:p.$$s;null==m&&(m=B);try{if(!o(F(s,A(s,"exists?",p.$$def||y,!1,!1),"exists?",[m,T],null)))return B;g.$throw(!0)}catch(u){if(!e.rescue(u,[x(d("I18n"),"InvalidLocale")]))throw u;try{return B}finally{e.pop_exception()}}},{$$s:z,$$ret:g}),!1):F(z,S(z,"exists?",y,!1,!0),"exists?",[v,T,c],f)}catch(p){if(p===g)return p.$v;throw p}},-3),E.$private(),D(E,"$on_fallback",K(B))}(_[0],_)},Opal.modules["bcdice/randomizer"]=function(e){var a,b,M,E,h,d,$,w,P=e.klass,o=e.const_set,C=e.def,D=e.truthy,k=e.rb_gt,F=e.rb_plus,S=e.rb_le,L=e.send,A=e.rb_minus,R=e.eqeq,j=e.rb_times,K=e.eqeqeq,N=e.rb_ge,B=[],x=e.nil,Q=e.$$$;return a=B,$=[(0,e.module)(B[0],"BCDice")].concat(a),w=e.$r($),b=$,E=[M=P($[0],null,"Randomizer")].concat(b),h=e.$r(E),(d=M.$$prototype).rand_results=d.detailed_rand_results=x,o(E[0],"UPPER_LIMIT_DICE_TIMES",200),o(E[0],"UPPER_LIMIT_DICE_SIDES",1e4),o(E[0],"UPPER_LIMIT_RANDS",1e4),C(M,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),M.$attr_reader("rand_results"),M.$attr_reader("detailed_rand_results"),o(E[0],"DetailedRandResult",h("Struct").$new("kind","sides","value")),C(M,"$roll_barabara",function(v,T){var c=this;return D(k(F(c.rand_results.$size(),v),h("UPPER_LIMIT_RANDS")))&&c.$raise(h("TooManyRandsError")),D(S(v,0))||D(k(v,h("UPPER_LIMIT_DICE_TIMES")))?[]:L(h("Array"),"new",[v],function g(){return(null==g.$$s?this:g.$$s).$roll_once(T)},{$$s:c})}),C(M,"$roll_sum",function(v,T){return this.$roll_barabara(v,T).$sum()}),C(M,"$roll_once",function(v){var c=x;return D(S(v,0))||D(k(v,h("UPPER_LIMIT_DICE_SIDES")))?0:(c=this.$rand_inner(v),this.$push_to_detail("normal",v,c),c)}),C(M,"$roll_index",function(v){return A(this.$roll_once(v),1)}),C(M,"$roll_tens_d10",function(){var c,T=x;return T=this.$rand_inner(10),R(T,10)&&(T=0),c=j(T,10),this.$push_to_detail("tens_d10",10,c),c}),C(M,"$roll_d9",function(){var T;return T=A(this.$rand_inner(10),1),this.$push_to_detail("d9",10,T),T}),C(M,"$roll_d66",function(v){var g,c=x;return c=L(h("Array"),"new",[2],function f(){return(null==f.$$s?this:f.$$s).$roll_once(6)},{$$s:this}),K(Q(h("D66SortType"),"ASC"),g=v)?c["$sort!"]():K(Q(h("D66SortType"),"DESC"),g)&&c["$sort!"]()["$reverse!"](),F(j(c["$[]"](0),10),c["$[]"](1))}),M.$private(),C(M,"$rand_inner",function(v){var c,T=this;return D(N(T.rand_results.$size(),h("UPPER_LIMIT_RANDS")))&&T.$raise(h("TooManyRandsError")),c=T.$random(v),T.rand_results["$<<"]([c,v]),c}),C(M,"$random",function(v){return F(h("Kernel").$rand(v),1)}),C(M,"$push_to_detail",function(v,T,c){var f;return f=h("DetailedRandResult").$new(v,T,c),this.detailed_rand_results.$push(f)}),P($[0],w("StandardError"),"TooManyRandsError"),x},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var L,K,X,a,_,$,w,B,R,W=e.module,P=e.klass,o=e.def,C=e.truthy,D=e.return_val,k=[],F=e.nil;return L=k,K=R=[W(k[0],"BCDice")].concat(L),X=B=[W(R[0],"DiceTable")].concat(K),_=[a=P(B[0],null,"RollResult")].concat(X),$=e.$r(_),(w=a.$$prototype).table_name=w.value=w.body=F,o(a,"$initialize",function(l,b,M){var E=this;return E.table_name=l,E.value=b,E.body=M}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),o(a,"$to_s",function(){var l=this;return l.table_name+"("+l.value+") \uff1e "+l.body}),o(a,"$last_body",function(){var l=this;return C(l.body["$is_a?"]($("RollResult")))?l.body.$last_body():l.body}),o(a,"$empty?",D(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var L,K,X,a,_,$,w,B,R,W=e.module,P=e.klass,o=e.truthy,C=e.def,D=e.rb_minus,k=[],F=e.nil;return L=k,K=R=[W(k[0],"BCDice")].concat(L),X=B=[W(R[0],"DiceTable")].concat(K),_=[a=P(B[0],null,"ChainTable")].concat(X),$=e.$r(_),(w=a.$$prototype).times=w.sides=w.items=w.name=F,C(a,"$initialize",function(l,b,M){var E=this,h=F;return E.name=l,E.items=M.$freeze(),h=/(\d+)D(\d+)/i.$match(b),o(h)||E.$raise($("ArgumentError"),"Unexpected table type: "+b),E.times=h["$[]"](1).$to_i(),E.sides=h["$[]"](2).$to_i()}),C(a,"$roll",function(l){var M,E,b=this,h=F;return M=l.$roll_sum(b.times,b.sides),E=D(M,b.times),h=b.items["$[]"](E),o(h["$respond_to?"]("roll"))&&(h=h.$roll(l)),$("RollResult").$new(b.name,M,h)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var j,x,$,w,r,l,b,X,N,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.def,k=e.rb_plus,F=e.rb_times,S=e.rb_minus,L=[],A=e.nil;return j=L,x=N=[W(L[0],"BCDice")].concat(j),$=X=[W(N[0],"DiceTable")].concat(x),r=[w=P(X[0],null,"D66GridTable")].concat($),l=e.$r(r),(b=w.$$prototype).name=b.items=A,C(w,"$from_i18n",function(E,h){var y=A;return y=l("I18n").$t(E,o(["locale","raise"],{locale:h,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))}),D(w,"$initialize",function(E,h){return this.name=E,this.items=h.$freeze()}),D(w,"$roll",function(E){var d,y,v,T,c;return d=E.$roll_once(6),y=E.$roll_once(6),v=k(F(d,10),y),T=S(d,1),c=S(y,1),l("RollResult").$new(this.name,v,this.items["$[]"](T)["$[]"](c))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var A,N,_,$,w,r,x,Q,j,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.def,F=[],S=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=F,N=j=[W(F[0],"BCDice")].concat(A),x=[W(j[0],"DiceTable")].concat(N),Q=e.$r(x),_=x,w=[$=P(x[0],Q("D66GridTable"),"D66HalfGridTable")].concat(_),r=e.$r(w),C($,"$from_i18n",function(b,M){var h=S;return h=r("I18n").$t(b,o(["locale","raise"],{locale:M,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("items_1_2_3"),h["$[]"]("items_4_5_6"))}),D($,"$initialize",function(b,M,E){return this.name=b,this.items=[M,M,M,E,E,E].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var A,N,_,$,w,r,x,Q,j,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.def,F=[],S=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=F,N=j=[W(F[0],"BCDice")].concat(A),x=[W(j[0],"DiceTable")].concat(N),Q=e.$r(x),_=x,w=[$=P(x[0],Q("D66GridTable"),"D66OneThirdTable")].concat(_),r=e.$r(w),C($,"$from_i18n",function(b,M){var h=S;return h=r("I18n").$t(b,o(["locale","raise"],{locale:M,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("items_1_2"),h["$[]"]("items_3_4"),h["$[]"]("items_5_6"))}),D($,"$initialize",function(b,M,E,h){return this.name=b,this.items=[M,M,E,E,h,h].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var N,X,r,l,b,M,E,_,x,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.def,k=e.eqeqeq,F=e.rb_plus,S=e.rb_times,L=e.truthy,A=[],R=e.nil,j=e.$$$;return N=A,X=x=[W(A[0],"BCDice")].concat(N),r=_=[W(x[0],"DiceTable")].concat(X),b=[l=P(_[0],null,"D66Table")].concat(r),M=e.$r(b),(E=l.$$prototype).sort_type=E.items=E.name=R,C(l,"$from_i18n",function(d,y){var c,T=R;return T=M("I18n").$t(d,o(["locale"],{locale:y})),c=M("D66SortType").$const_get(T["$[]"]("d66_sort_type")),this.$new(T["$[]"]("name"),c,T["$[]"]("items"))}),D(l,"$initialize",function(d,y,v){var T=this;return T.name=d,T.sort_type=y,T.items=v.$freeze()}),D(l,"$roll",function(d){var y=this,v=R,T=R,c=R,g=R;return v=d.$roll_barabara(2,6),k(j(M("D66SortType"),"ASC"),T=y.sort_type)?v["$sort!"]():k(j(M("D66SortType"),"DESC"),T)&&v["$sort!"]()["$reverse!"](),c=F(S(v["$[]"](0),10),v["$[]"](1)),g=L(T=y.items["$[]"](c))?T:y.items["$[]"](c.$to_s()),L(g["$respond_to?"]("roll"))&&(g=g.$roll(d)),M("RollResult").$new(y.name,c,g)}),D(l,"$choice",function(d){return M("RollResult").$new(this.name,d,this.items["$[]"](d))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var B,a,$,w,Q,W=e.module,P=e.klass,o=e.hash2,C=e.send,D=e.to_ary,k=e.rb_plus,F=e.rb_times,S=e.send2,L=e.find_super,A=e.def,j=[],K=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),B=j,a=Q=[W(j[0],"BCDice")].concat(B),$=[W(Q[0],"DiceTable")].concat(a),w=e.$r($),A(P($[0],w("D66Table"),"D66LeftRangeTable"),"$initialize",function M(E,h,d){var T;return M.$$p=null,T=o([],{}),C(d,"each",[],function(g){var f,m;return null==g&&(g=K),f=D(g),m=null==f[1]?K:f[1],C(null==f[0]?K:f[0],"each",[],function(u){return null==u&&(u=K),C(m,"each_with_index",[],function(i,t){var G,Y;return null==i&&(i=K),null==t&&(t=K),Y=k(F(u,10),k(t,1)),C(T,"[]=",G=[Y,i]),G[G.length-1]})})}),S(this,L(this,"initialize",M,!1,!0),"initialize",[E,h,T],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var K,Q,w,r,l,b,M,a,B,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.def,k=e.truthy,F=e.rb_minus,S=e.rb_plus,L=e.rb_times,A=[],R=e.nil;return K=A,Q=B=[W(A[0],"BCDice")].concat(K),w=a=[W(B[0],"DiceTable")].concat(Q),l=[r=P(a[0],null,"D66ParityTable")].concat(w),b=e.$r(l),(M=r.$$prototype).odd=M.even=M.name=R,C(r,"$from_i18n",function(h,d){var v=R;return v=b("I18n").$t(h,o(["locale","raise"],{locale:d,raise:!0})),this.$new(v["$[]"]("name"),v["$[]"]("odd"),v["$[]"]("even"))}),D(r,"$initialize",function(h,d,y){var v=this;return v.name=h,v.odd=d.$freeze(),v.even=y.$freeze()}),D(r,"$roll",function(h){var v,c,g,d=this,y=R;return y=h.$roll_once(6),v=h.$roll_once(6),c=(k(y["$odd?"]())?d.odd:d.even)["$[]"](F(v,1)),g=S(L(y,10),v),b("RollResult").$new(d.name,g,c)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var A,N,a,_,$,w,r,x,j,W=e.module,P=e.klass,o=e.def,C=e.rb_plus,D=e.rb_times,k=e.send,F=[],S=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),a=x=[W(j[0],"DiceTable")].concat(N),$=[_=P(x[0],null,"D66RangeTable")].concat(a),w=e.$r($),(r=_.$$prototype).items=r.name=S,o(_,"$initialize",function(b,M){return this.name=b,this.items=M.$freeze()}),o(_,"$roll",function(b){var E,h,d,y=S;return E=b.$roll_once(6),h=b.$roll_once(6),d=C(D(E,10),h),y=k(this.items,"find",[],function(T){return null==T&&(T=S),T["$[]"](0)["$include?"](d)}),w("RollResult").$new(this.name,d,y["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var K,Q,w,r,l,b,M,a,B,W=e.module,P=e.klass,o=e.const_set,C=e.send,D=e.truthy,k=e.def,F=e.eqeqeq,S=e.rb_times,L=e.rb_plus,A=[],R=e.nil;return K=A,Q=B=[W(A[0],"BCDice")].concat(K),w=a=[W(B[0],"DiceTable")].concat(Q),l=[r=P(a[0],null,"RangeTable")].concat(w),b=e.$r(l),(M=r.$$prototype).name=M.items=M.num_of_dice=M.num_of_sides=M.formatter=R,o(l[0],"RollResult",C(b("Struct"),"new",["sum","values","content","formatted"],function E(){return(null==E.$$s?this:E.$$s).$alias_method("to_s","formatted")},{$$s:r})),o(l[0],"Item",b("Struct").$new("range","content")),o(l[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),o(l[0],"DEFAULT_FORMATTER",C(r,"lambda",[],function(h,d){return null==h&&(h=R),null==d&&(d=R),h.$name()+"("+d.$sum()+") \uff1e "+d.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),k(r,"$initialize",function E(h,d,y){var c,v=E.$$p||R,T=this,g=R;return E.$$p=null,T.name=h.$freeze(),T.formatter=D(c=v)?c:b("DEFAULT_FORMATTER"),g=b("DICE_ROLL_METHOD_RE").$match(d),D(g)||T.$raise(b("ArgumentError"),T.name+": invalid dice roll method: "+d),T.num_of_dice=g["$[]"](1).$to_i(),T.num_of_sides=g["$[]"](2).$to_i(),T.$store(y)}),k(r,"$fetch",function(h){var y,d=this;return y=C(d.items,"find",[],function(T){return null==T&&(T=R),T.$range()["$include?"](h)}),D(y)||d.$raise(b("RangeError"),d.name+": value is out of range: "+h),y}),k(r,"$roll",function(h){var v,d=this,y=R,T=R;return v=(y=h.$roll_barabara(d.num_of_dice,d.num_of_sides)).$sum(),(T=b("RollResult").$new(v,y,d.$fetch(v).$content()))["$formatted="](d.formatter["$[]"](d,T)),T}),r.$private(),k(r,"$store",function(h){var y,v,d=this;return y=C(h,"map",[],function T(c,g){return null==c&&(c=R),null==g&&(g=R),[(null==T.$$s?this:T.$$s).$coerce_to_int_range(c),g]},{$$s:d}),v=C(y,"sort_by",[],function(c,g){return null==c&&(c=R),null==g&&(g=R),c.$min()}),d.$assert_min_sum_is_covered(v),d.$assert_max_sum_is_covered(v),d.$assert_no_gap_or_overlap_in_ranges(v),d.items=C(v,"map",[],function(c,g){return null==c&&(c=R),null==g&&(g=R),b("Item").$new(c,g.$freeze()).$freeze()}).$freeze(),d}),k(r,"$coerce_to_int_range",function(h){var y;return F(b("Integer"),y=h)?b("Range").$new(h,h):F(b("Range"),y)&&D(h.$begin()["$is_a?"](b("Integer")))&&D(h.$end()["$is_a?"](b("Integer")))?h:this.$raise(b("TypeError"),this.name+": "+h+" ("+h.$class()+") must be an Integer or a Range with Integers ")}),k(r,"$assert_min_sum_is_covered",function(h){var y,d=this,v=R;return y=d.num_of_dice,v=h.$first()["$[]"](0),D(v["$include?"](y))||d.$raise(b("RangeError"),d.name+": min value ("+y+") is not covered: "+v),d}),k(r,"$assert_max_sum_is_covered",function(h){var y,d=this,v=R;return y=S(d.num_of_dice,d.num_of_sides),v=h.$last()["$[]"](0),D(v["$include?"](y))||d.$raise(b("RangeError"),d.name+": max value ("+y+") is not covered: "+v),d}),k(r,"$assert_no_gap_or_overlap_in_ranges",function(h){return C(h,"each_cons",[2],function y(v,T){var z,p,c=null==y.$$s?this:y.$$s,g=R,f=R;return null==c.name&&(c.name=R),null==v&&(v=R),null==T&&(T=R),g=v["$[]"](0),f=T["$[]"](0),z=g.$max(),p=L(z,1),D(f["$include?"](z))&&c.$raise(b("RangeError"),c.name+": Range overlap: "+g+" and "+f),D(f["$include?"](p))?R:c.$raise(b("RangeError"),c.name+": Range gap: "+g+" and "+f)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var R,B,_,b,M,E,h,w,Q,K,W=e.module,P=e.klass,o=e.send,C=e.def,D=e.rb_minus,k=e.return_ivar,F=[],S=e.nil,L=e.$$$;return R=F,B=K=[W(F[0],"BCDice")].concat(R),_=Q=[W(K[0],"DiceTable")].concat(B),b=w=[P(Q[0],null,"SaiFicSkillTable")].concat(_),E=[M=P(w[0],null,"Category")].concat(b),h=e.$r(E),C(M,"$initialize",function(y,v,T,c){var g=this;return g.name=y,g.skills=o(v.$map(),"with_index",[2],function(z,p){return null==z&&(z=S),null==p&&(p=S),L(h("SaiFicSkillTable"),"Skill").$new(y,z,T,p,c)}),g.dice=T}),C(M,"$roll",function(y){return this.$skills()["$[]"](D(y.$roll_sum(2,6),2))}),C(M,"$to_s",k("name")),M.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var S,j,Q,w,r,a,N,A,W=e.module,P=e.klass,o=e.def,C=e.hash2,D=[],k=e.nil;return S=D,j=A=[W(D[0],"BCDice")].concat(S),Q=N=[W(A[0],"DiceTable")].concat(j),a=[P(N[0],null,"SaiFicSkillTable")].concat(Q),(r=(w=P(a[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=k,o(w,"$initialize",function(b,M,E,h,d){var y=this;return y.category_name=b,y.name=M,y.category_dice=E,y.row_dice=h,y.s_format=d}),o(w,"$to_s",function(){var b=this;return b.$format(b.s_format,C(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),w.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,r,h,d,y,v,T,b,$,W=e.module,P=e.klass,o=e.ensure_kwargs,C=e.hash2,D=e.send,F=e.defs,S=e.const_set,L=e.to_ary,A=e.def,R=e.truthy,j=e.rb_minus,K=e.rb_plus,N=e.top,B=[],x=e.nil,Q=e.$$$;return N.$require("bcdice/dice_table/sai_fic_skill_table/category"),N.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=B,r=$=[W(B[0],"BCDice")].concat(a),h=b=[W($[0],"DiceTable")].concat(r),y=[d=P(b[0],null,"SaiFicSkillTable")].concat(h),v=e.$r(y),(T=d.$$prototype).rtt=T.rtt_format=T.rct=T.rct_format=T.rttn=T.rttn_format=T.categories=x,F(d,"$from_i18n",function(g,f,z){var p,m,s,t,i=x;return null==(p=(z=o(z)).$$smap.rtt)&&(p=x),null==(m=z.$$smap.rct)&&(m=x),null==(s=z.$$smap.rttn)&&(s=x),t=(i=v("I18n").$t("RTT",C(["locale","raise","default"],{locale:f,raise:!1,default:C([],{})})).$merge(v("I18n").$t(g,C(["locale","raise"],{locale:f,raise:!0}))))["$[]"]("items"),i=D(i,"select",[],function(Y,U){return null==Y&&(Y=x),null==U&&(U=x),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Y)}),this.$new(t,e.to_hash(i).$merge(C(["rtt","rct","rttn"],{rtt:p,rct:m,rttn:s})))},-3),S(y[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),S(y[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),S(y[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),S(y[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),A(d,"$initialize",function(g,f){var z,p,m,s,u,n,i,t=this;return null==(z=(f=o(f)).$$smap.rtt)&&(z=x),null==(p=f.$$smap.rct)&&(p=x),null==(m=f.$$smap.rttn)&&(m=x),null==(s=f.$$smap.rtt_format)&&(s=v("DEFAULT_RTT")),null==(u=f.$$smap.rct_format)&&(u=v("DEFAULT_RCT")),null==(n=f.$$smap.rttn_format)&&(n=v("DEFAULT_RTTN")),null==(i=f.$$smap.s_format)&&(i=v("DEFAULT_S")),t.categories=D(g.$map(),"with_index",[1],function(Y,U){var O,ie,ae;return null==Y&&(Y=x),null==U&&(U=x),ie=null==(O=L(Y))[0]?x:O[0],ae=null==O[1]?x:O[1],Q(v("SaiFicSkillTable"),"Category").$new(ie,ae,U,i)},{$$has_top_level_mlhs_arg:!0}),t.rtt=z,t.rct=p,t.rttn=m.$to_a(),t.rtt_format=s,t.rct_format=u,t.rttn_format=n},-2),S(y[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),d.$attr_reader("categories"),A(d,"$roll_command",function(g,f){var p,z=this,m=x,s=x;return R(["RTT",z.rtt]["$include?"](p=f))?z.$format_skill(z.rtt_format,z.$roll_skill(g)):R(["RCT",z.rct]["$include?"](p))?(m=z.$roll_category(g),z.$format(z.rct_format,C(["category_dice","category_name"],{category_dice:m.$dice(),category_name:m.$name()}))):R(s=v("RTTN").$index(p))||R(s=z.rttn.$index(p))?z.$format_skill(z.rttn_format,z.categories["$[]"](s).$roll(g)):x}),A(d,"$roll_category",function(g){return this.categories["$[]"](j(g.$roll_once(6),1))}),A(d,"$roll_skill",function(g){return this.$roll_category(g).$roll(g)}),A(d,"$prefixes",function(){var g=this;return K(["RTT[1-6]?","RCT",g.rtt,g.rct],g.rttn).$compact()}),d.$private(),A(d,"$format_skill",function(g,f){return this.$format(g,C(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:f.$category_dice(),row_dice:f.$row_dice(),category_name:f.$category_name(),skill_name:f.$name(),text:f.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var R,B,_,$,w,r,l,Q,K,W=e.module,P=e.klass,o=e.hash2,C=e.defs,D=e.truthy,k=e.def,F=e.rb_minus,S=[],L=e.nil;return R=S,B=K=[W(S[0],"BCDice")].concat(R),_=Q=[W(K[0],"DiceTable")].concat(B),w=[$=P(Q[0],null,"Table")].concat(_),r=e.$r(w),(l=$.$$prototype).times=l.sides=l.name=l.items=L,C($,"$from_i18n",function(M,E){var d=L;return d=r("I18n").$t(M,o(["locale"],{locale:E})),this.$new(d["$[]"]("name"),d["$[]"]("type"),d["$[]"]("items"))}),k($,"$initialize",function(M,E,h){var d=this,y=L;return d.name=M,d.items=h.$freeze(),y=/(\d+)D(\d+)/i.$match(E),D(y)||d.$raise(r("ArgumentError"),"Unexpected table type: "+E),d.times=y["$[]"](1).$to_i(),d.sides=y["$[]"](2).$to_i()}),k($,"$roll",function(M){var h,E=this;return h=M.$roll_sum(E.times,E.sides),E.$choice(h)}),k($,"$choice",function(M){var h,E=this;return h=F(M,E.times),r("RollResult").$new(E.name,M,E.items["$[]"](h))})},Opal.modules["bcdice/dice_table"]=function(e){var W=e.top;return W.$require("bcdice/dice_table/roll_result"),W.$require("bcdice/dice_table/chain_table"),W.$require("bcdice/dice_table/d66_grid_table"),W.$require("bcdice/dice_table/d66_half_grid_table"),W.$require("bcdice/dice_table/d66_one_third_table"),W.$require("bcdice/dice_table/d66_left_range_table"),W.$require("bcdice/dice_table/d66_parity_table"),W.$require("bcdice/dice_table/d66_range_table"),W.$require("bcdice/dice_table/d66_table"),W.$require("bcdice/dice_table/range_table"),W.$require("bcdice/dice_table/sai_fic_skill_table"),W.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var k,A,j,S,W=e.module,P=e.const_set,o=[];return k=o,A=S=[W(o[0],"BCDice")].concat(k),j=[W(S[0],"D66SortType")].concat(A),P(j[0],"NO_SORT","no_sort"),P(j[0],"ASC","asc"),P(j[0],"DESC","desc"),function(L,A){var j=[W(L,"RoundType")].concat(A);return P(j[0],"CEIL","ceil"),P(j[0],"FLOOR","floor"),P(j[0],"ROUND","round")}(S[0],S)},Opal.modules["bcdice/translate"]=function(e){var A,N,B,x,Q,j,W=e.module,P=e.ensure_kwargs,o=e.kwrestargs,D=e.hash2,k=e.def,F=[],S=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),x=[B=W(j[0],"Translate")].concat(N),Q=e.$r(x),k(B,"$translate",function(a,_){var $,w=this;return null==w.locale&&(w.locale=S),_=P(_),$=o(_,{}),Q("I18n").$translate(a,D(["locale","raise"],{locale:w.locale,raise:!0}).$merge(e.to_hash($)))},-2)},Opal.modules["bcdice/result"]=function(e){var B,X,x,A,j,P=e.klass,o=e.send,C=e.def,D=e.return_val,k=e.return_ivar,F=[],S=e.nil;return A=F,B=j=[(0,e.module)(F[0],"BCDice")].concat(A),[x=P(j[0],null,"Result")].concat(B),C(X=e.get_singleton_class(x),"$success",function($){return o(this.$new(),"tap",[],function(l){var b;return null==l&&(l=S),l["$text="]($),o(l,"success=",b=[!0]),b[b.length-1]})}),C(X,"$failure",function($){return o(this.$new(),"tap",[],function(l){var b;return null==l&&(l=S),l["$text="]($),o(l,"failure=",b=[!0]),b[b.length-1]})}),C(X,"$critical",function($){return o(this.$new(),"tap",[],function(l){var b;return null==l&&(l=S),l["$text="]($),l["$critical="](!0),o(l,"success=",b=[!0]),b[b.length-1]})}),C(X,"$fumble",function($){return o(this.$new(),"tap",[],function(l){var b;return null==l&&(l=S),l["$text="]($),l["$fumble="](!0),o(l,"failure=",b=[!0]),b[b.length-1]})}),C(X,"$nothing",D("nothing")),C(x,"$initialize",function(a){var _=this;return null==a&&(a=S),_.text=a,_.rands=S,_.detailed_rands=S,_.secret=!1,_.success=!1,_.failure=!1,_.critical=!1,_.fumble=!1},-1),x.$attr_accessor("text","rands","detailed_rands"),x.$attr_writer("secret","success","failure","critical","fumble"),C(x,"$secret?",k("secret")),C(x,"$success?",k("success")),C(x,"$failure?",k("failure")),C(x,"$critical?",k("critical")),C(x,"$fumble?",k("fumble")),C(x,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var M,h,d,W=e.module,P=e.klass,o=e.truthy,C=e.const_set,D=e.defs,k=e.gvars,F=e.rb_lt,S=e.def,L=e.to_ary,A=e.send,R=e.neqeq,j=e.rb_plus,K=e.eqeq,N=e.rb_ge,B=e.rb_gt,x=e.rb_minus,Q=e.rb_le,X=e.rb_times,a=e.assign_ivar_val,$=[],w=e.$r($),r=e.nil,l=e.$$$;return M=$,h=[W($[0],"Racc")].concat(M),d=e.$r(h),P(h[0],d("StandardError"),"ParseError"),o(l("::","ParseError","skip_raise")?"constant":r)||C($[0],"ParseError",l(w("Racc"),"ParseError")),function(b,M){var c,g,f,z,p,d=[W(b,"Racc")].concat(M),y=e.$r(d);return o(y("Racc_No_Extensions","skip_raise")?"constant":r)||C(d[0],"Racc_No_Extensions",!1),c=d,f=[g=P(d[0],null,"Parser")].concat(c),z=e.$r(f),(p=g.$$prototype).yydebug=p.racc_debug_out=p.racc_error_status=p.racc_t=p.racc_vstack=p.racc_val=p.racc_state=p.racc_tstack=r,C(f[0],"Racc_Runtime_Version","1.4.6"),C(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),C(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),C(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),C(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),C(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),C(f[0],"Racc_Runtime_Core_Version",z("Racc_Runtime_Core_Version_R")),C(f[0],"Racc_Runtime_Core_Revision",z("Racc_Runtime_Core_Revision_R")),C(f[0],"Racc_Runtime_Type","ruby"),D(z("Parser"),"$racc_runtime_type",function(){return z("Racc_Runtime_Type")}),S(g,"$_racc_setup",function(){var s,u,n=this,i=r,t=r;return null==k.stderr&&(k.stderr=r),o(l(n.$class(),"Racc_debug_parser"))||(n.yydebug=!1),o(null!=(s=n.yydebug)&&s!==r?"instance-variable":r)||(n.yydebug=!1),o(n.yydebug)&&(o(null!=(u=n.racc_debug_out)&&u!==r?"instance-variable":r)||(n.racc_debug_out=k.stderr),n.racc_debug_out=o(i=n.racc_debug_out)?i:k.stderr),t=l(n.$class(),"Racc_arg"),o(F(t.$size(),14))&&t["$[]="](13,!0),t}),S(g,"$_racc_init_sysvars",function(){var s=this;return s.racc_state=[0],s.racc_tstack=[],s.racc_vstack=[],s.racc_t=r,s.racc_val=r,s.racc_read_next=!0,s.racc_user_yyerror=!1,s.racc_error_status=0}),S(g,"$do_parse",function(){return this.$__send__(z("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),S(g,"$next_token",function(){return this.$raise(z("NotImplementedError"),this.$class()+"#next_token is not defined")}),S(g,"$_racc_do_parse_rb",function(s,u){var n,t=this,G=r,Y=r,U=r,O=r,ie=r,ae=r,se=r,$e=r;return n=L(s),G=null==n[0]?r:n[0],Y=null==n[1]?r:n[1],U=null==n[2]?r:n[2],O=null==n[3]?r:n[3],ie=null==n[10]?r:n[10],t.$_racc_init_sysvars(),ae=se=$e=r,A(t,"catch",["racc_end_parse"],function V(){var q,Z,H=null==V.$$s?this:V.$$s,I=r;for(null==H.racc_state&&(H.racc_state=r),null==H.racc_read_next&&(H.racc_read_next=r),null==H.racc_t&&(H.racc_t=r),null==H.yydebug&&(H.yydebug=r),null==H.racc_val&&(H.racc_val=r);o(!0);)for(o($e=O["$[]"](H.racc_state["$[]"](-1)))?(o(H.racc_read_next)&&R(H.racc_t,0)&&(Z=H.$next_token(),q=L(Z),ae=null==q[0]?r:q[0],H.racc_val=null==q[1]?r:q[1],H.racc_t=o(ae)?o(I=ie["$[]"](ae))?I:1:0,o(H.yydebug)&&H.$racc_read_token(H.racc_t,ae,H.racc_val),H.racc_read_next=!1),$e=j($e,H.racc_t),o(N($e,0))&&o(se=G["$[]"]($e))&&K(Y["$[]"]($e),H.racc_state["$[]"](-1))||(se=U["$[]"](H.racc_state["$[]"](-1)))):se=U["$[]"](H.racc_state["$[]"](-1));o(se=H.$_racc_evalact(se,s)););},{$$s:t})}),S(g,"$yyparse",function(s,u){return this.$__send__(z("Racc_YY_Parse_Method"),s,u,this.$_racc_setup(),!0)}),S(g,"$_racc_yyparse_rb",function(s,u,n,i){var t,Y=this,U=r,O=r,J=r,ie=r,se=r,$e=r,V=r;return t=L(n),U=null==t[0]?r:t[0],O=null==t[1]?r:t[1],J=null==t[2]?r:t[2],ie=null==t[3]?r:t[3],se=null==t[10]?r:t[10],Y.$_racc_init_sysvars(),$e=r,V=r,A(Y,"catch",["racc_end_parse"],function q(){var Z=null==q.$$s?this:q.$$s;for(null==Z.racc_state&&(Z.racc_state=r);!o(V=ie["$[]"](Z.racc_state["$[]"](-1)));)for(;o($e=Z.$_racc_evalact(J["$[]"](Z.racc_state["$[]"](-1)),n)););return A(s,"__send__",[u],function H(I,te){var re=null==H.$$s?this:H.$$s,ne=r,ee=r;for(null==re.racc_t&&(re.racc_t=r),null==re.racc_state&&(re.racc_state=r),null==re.racc_read_next&&(re.racc_read_next=r),null==I&&(I=r),null==te&&(te=r),re.racc_t=o(I)?o(ne=se["$[]"](I))?ne:1:0,re.racc_val=te,re.racc_read_next=!1,V=j(V,re.racc_t),o(N(V,0))&&o($e=U["$[]"](V))&&K(O["$[]"](V),re.racc_state["$[]"](-1))||($e=J["$[]"](re.racc_state["$[]"](-1)));o($e=re.$_racc_evalact($e,n)););for(;o(o(ne=o(ee=(V=ie["$[]"](re.racc_state["$[]"](-1)))["$!"]())?ee:re.racc_read_next["$!"]())?ne:re.racc_t["$=="](0));)for(o(V)&&o(V=j(V,re.racc_t))&&o(N(V,0))&&o($e=U["$[]"](V))&&K(O["$[]"](V),re.racc_state["$[]"](-1))||($e=J["$[]"](re.racc_state["$[]"](-1)));o($e=re.$_racc_evalact($e,n)););},{$$s:Z})},{$$s:Y})}),S(g,"$_racc_evalact",function(s,u){var n,J,t=this,G=r,Y=r,O=r,ie=r,ae=r,se=r;if(G=null==(n=L(u))[0]?r:n[0],Y=null==n[1]?r:n[1],O=null==n[3]?r:n[3],J=null==n[11]?r:n[11],ie=null==n[12]?r:n[12],o(B(s,0))&&o(F(s,J)))o(B(t.racc_error_status,0))&&(K(t.racc_t,1)||(t.racc_error_status=x(t.racc_error_status,1))),t.racc_vstack.$push(t.racc_val),t.racc_state.$push(s),t.racc_read_next=!0,o(t.yydebug)&&(t.racc_tstack.$push(t.racc_t),t.$racc_shift(t.racc_t,t.racc_tstack,t.racc_vstack));else if(o(F(s,0))&&o(B(s,ie["$-@"]()))){if(ae=A(t,"catch",["racc_jump"],function $e(){var V=null==$e.$$s?this:$e.$$s;return null==V.racc_state&&(V.racc_state=r),V.racc_state.$push(V.$_racc_do_reduce(u,s)),!1},{$$s:t}),o(ae))switch(ae){case 1:return t.racc_user_yyerror=!0,ie["$-@"]();case 2:return J;default:t.$raise("[Racc Bug] unknown jump code")}}else if(K(s,J))o(t.yydebug)&&t.$racc_accept(),t.$throw("racc_end_parse",t.racc_vstack["$[]"](0));else{if(K(s,ie["$-@"]())){switch(t.racc_error_status){case 0:o(u["$[]"](21))||t.$on_error(t.racc_t,t.racc_val,t.racc_vstack);break;case 3:K(t.racc_t,0)&&t.$throw("racc_end_parse",r),t.racc_read_next=!0}for(t.racc_user_yyerror=!1,t.racc_error_status=3;o(!0)&&!(o(se=O["$[]"](t.racc_state["$[]"](-1)))&&(se=j(se,1),o(N(se,0))&&o(s=G["$[]"](se))&&K(Y["$[]"](se),t.racc_state["$[]"](-1))));)o(Q(t.racc_state.$size(),1))&&t.$throw("racc_end_parse",r),t.racc_state.$pop(),t.racc_vstack.$pop(),o(t.yydebug)&&(t.racc_tstack.$pop(),t.$racc_e_pop(t.racc_state,t.racc_tstack,t.racc_vstack));return s}t.$raise("[Racc Bug] unknown action "+s.$inspect())}return o(t.yydebug)&&t.$racc_next_state(t.racc_state["$[]"](-1),t.racc_state),r}),S(g,"$_racc_do_reduce",function(s,u){var n,ie,se,I,te,re,ue,t=this,Y=r,U=r,O=r,J=r,ae=r,$e=r,V=r,q=r,Z=r,H=r,ne=r,ee=r,ce=r;return Y=null==(n=L(s))[4]?r:n[4],U=null==n[5]?r:n[5],O=null==n[6]?r:n[6],J=null==n[7]?r:n[7],ie=null==n[8]?r:n[8],ae=null==n[9]?r:n[9],se=null==n[13]?r:n[13],$e=t.racc_state,V=t.racc_vstack,q=t.racc_tstack,Z=X(u,-3),H=ae["$[]"](Z),I=ae["$[]"](j(Z,1)),te=ae["$[]"](j(Z,2)),re=[],o(t.yydebug)&&(ne=q["$[]"](H["$-@"](),H)),ee=V["$[]"](H["$-@"](),H),o(t.yydebug)&&q["$[]="](H["$-@"](),H,re),V["$[]="](H["$-@"](),H,re),$e["$[]="](H["$-@"](),H,re),o(se)?V.$push(t.$__send__(te,ee,V,ee["$[]"](0))):V.$push(t.$__send__(te,ee,V)),q.$push(I),o(t.yydebug)&&t.$racc_reduce(ne,I,q,V),ue=x(I,ie),o(Z=J["$[]"](ue))&&(Z=j(Z,$e["$[]"](-1)),o(N(Z,0))&&o(ce=Y["$[]"](Z))&&K(U["$[]"](Z),ue))?ce:O["$[]"](ue)}),S(g,"$on_error",function(s,u,n){var t,i=this;return i.$raise(z("ParseError"),i.$sprintf("\nparse error on value %s (%s)",u.$inspect(),o(t=i.$token_to_str(s))?t:"?"))}),S(g,"$yyerror",function(){return this.$throw("racc_jump",1)}),S(g,"$yyaccept",function(){return this.$throw("racc_jump",2)}),S(g,"$yyerrok",a("racc_error_status",0)),S(g,"$racc_read_token",function(s,u,n){var i=this;return i.racc_debug_out.$print("read    "),i.racc_debug_out.$print(u.$inspect(),"(",i.$racc_token2str(s),") "),i.racc_debug_out.$puts(n.$inspect()),i.racc_debug_out.$puts()}),S(g,"$racc_shift",function(s,u,n){var i=this;return i.racc_debug_out.$puts("shift   "+i.$racc_token2str(s)),i.$racc_print_stacks(u,n),i.racc_debug_out.$puts()}),S(g,"$racc_reduce",function(s,u,n,i){var t=this,G=r;return(G=t.racc_debug_out).$print("reduce "),o(s["$empty?"]())?G.$print(" <none>"):A(s,"each",[],function Y(U){return null==U&&(U=r),G.$print(" ",(null==Y.$$s?this:Y.$$s).$racc_token2str(U))},{$$s:t}),G.$puts(" --\x3e "+t.$racc_token2str(u)),t.$racc_print_stacks(n,i),t.racc_debug_out.$puts()}),S(g,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),S(g,"$racc_e_pop",function(s,u,n){var i=this;return i.racc_debug_out.$puts("error recovering mode: pop token"),i.$racc_print_states(s),i.$racc_print_stacks(u,n),i.racc_debug_out.$puts()}),S(g,"$racc_next_state",function(s,u){var n=this;return n.racc_debug_out.$puts("goto    "+s),n.$racc_print_states(u),n.racc_debug_out.$puts()}),S(g,"$racc_print_stacks",function(s,u){var i=r;return(i=this.racc_debug_out).$print("        ["),A(s,"each_index",[],function t(G){return null==G&&(G=r),i.$print(" (",(null==t.$$s?this:t.$$s).$racc_token2str(s["$[]"](G))," ",u["$[]"](G).$inspect(),")")},{$$s:this}),i.$puts(" ]")}),S(g,"$racc_print_states",function(s){var n=r;return(n=this.racc_debug_out).$print("        ["),A(s,"each",[],function(t){return null==t&&(t=r),n.$print(" ",t)}),n.$puts(" ]")}),S(g,"$racc_token2str",function(s){var n;return o(n=l(this.$class(),"Racc_token_to_s_table")["$[]"](s))?n:this.$raise("[Racc Bug] can't convert token "+s+" to string")}),S(g,"$token_to_str",function(s){return l(this.$class(),"Racc_token_to_s_table")["$[]"](s)})}($[0],$)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,r,E,c,g,d,y,b,$,W=e.module,P=e.klass,o=e.def,C=e.thrower,D=e.return_ivar,k=e.send2,F=e.find_super,S=e.eqeq,L=e.const_set,A=e.eqeqeq,R=e.rb_divide,j=e.truthy,K=e.assign_ivar,N=e.alias,B=[],x=e.nil,Q=e.$$$;return a=B,r=$=[W(B[0],"BCDice")].concat(a),E=b=[W($[0],"Arithmetic")].concat(r),d=[W(b[0],"Node")].concat(E),y=e.$r(d),(g=(c=P(d[0],null,"BinaryOp")).$$prototype).lhs=g.rhs=g.op=x,o(c,"$initialize",function(z,p,m){var s=this;return s.lhs=z,s.op=p,s.rhs=m}),o(c,"$eval",function(z){try{C("eval_return");var u,m=this,s=x;return s=m.lhs.$eval(z),u=m.rhs.$eval(z),s.$send(m.op,u)}catch(n){if(n===e.t_eval_return)return n.$v;throw n}}),o(c,"$output",function(){var z=this;return""+z.lhs.$output()+z.op+z.rhs.$output()}),o(c,"$s_exp",function(){var z=this;return"("+z.$op_for_s_exp()+" "+z.lhs.$s_exp()+" "+z.rhs.$s_exp()+")"}),o(c,"$op_for_s_exp",D("op")),function(v,T,c){var g=P(v,T,"DivideBase"),f=[g].concat(c),z=e.$r(f),p=g.$$prototype;p.lhs=p.rhs=p.op=x,o(g,"$initialize",function m(s,u){return m.$$p=null,k(this,F(this,"initialize",m,!1,!0),"initialize",[s,"/",u],null)}),o(g,"$eval",function(s){try{C("eval_return");var i,t,n=this;return i=n.lhs.$eval(s),t=n.rhs.$eval(s),S(t,0)&&n.$raise(z("ZeroDivisionError")),n.$divide_and_round(i,t,s)}catch(G){if(G===e.t_eval_return)return G.$v;throw G}}),o(g,"$output",function m(){var s=m.$$p||x,u=this;return m.$$p=null,""+k(u,F(u,"output",m,!1,!0),"output",[],s)+u.$rounding_method()}),g.$private(),o(g,"$rounding_method",function(){return Q(this.$class(),"ROUNDING_METHOD")}),o(g,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),o(g,"$divide_and_round",function(s,u,n){return this.$raise(z("NotImplementedError"))})}(d[0],y("BinaryOp"),d),function(v,T,c){var g=P(v,T,"DivideWithGameSystemDefault"),f=[g].concat(c),z=e.$r(f);L(f[0],"ROUNDING_METHOD",""),g.$private(),o(g,"$divide_and_round",function(m,s,u){var n,i=x;return A(Q(z("RoundType"),"CEIL"),n=u)?R(m.$to_f(),s).$ceil():A(Q(z("RoundType"),"ROUND"),n)?(i=R(m.$to_f(),s),j(i["$negative?"]())?i.$abs().$round()["$-@"]():i.$round()):R(m,s).$floor()})}(d[0],y("DivideBase"),d),function(v,T,c){var g=P(v,T,"DivideWithCeil"),f=[g].concat(c);L(f[0],"ROUNDING_METHOD","C"),g.$private(),o(g,"$divide_and_round",function(p,m,s){return R(p.$to_f(),m).$ceil()})}(d[0],y("DivideBase"),d),function(v,T,c){var g=P(v,T,"DivideWithRound"),f=[g].concat(c);L(f[0],"ROUNDING_METHOD","R"),g.$private(),o(g,"$divide_and_round",function(p,m,s){var u=x;return u=R(p.$to_f(),m),j(u["$negative?"]())?u.$abs().$round()["$-@"]():u.$round()})}(d[0],y("DivideBase"),d),function(v,T,c){var g=P(v,T,"DivideWithFloor"),f=[g].concat(c);L(f[0],"ROUNDING_METHOD","F"),g.$private(),o(g,"$divide_and_round",function(p,m,s){return R(p,m).$floor()})}(d[0],y("DivideBase"),d),function(v,T){var c=P(v,null,"Negative");c.$$prototype.body=x,o(c,"$initialize",K("body")),o(c,"$eval",function(z){try{return C("eval_return"),this.body.$eval(z)["$-@"]()}catch(s){if(s===e.t_eval_return)return s.$v;throw s}}),o(c,"$output",function(){return"-"+this.body.$output()}),o(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(d[0]),function(v,T){var c=P(v,null,"Parenthesis");c.$$prototype.expr=x,o(c,"$initialize",K("expr")),o(c,"$eval",function(z){try{return C("eval_return"),this.expr.$eval(z)}catch(s){if(s===e.t_eval_return)return s.$v;throw s}}),o(c,"$output",function(){return"("+this.expr.$output()+")"}),o(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(d[0]),function(v,T){var c=P(v,null,"Number");return c.$$prototype.value=x,o(c,"$initialize",K("value")),o(c,"$eval",D("value")),o(c,"$output",function(){return this.value.$to_s()}),N(c,"s_exp","output")}(d[0])},Opal.modules.strscan=function(e){var K,N,B,x,Q,P=e.def,o=e.truthy,C=e.eqeqeq,D=e.Opal,k=e.return_ivar,F=e.send,S=e.alias,L=[],A=e.nil;return K=L,B=[N=(0,e.klass)(L[0],null,"StringScanner")].concat(K),x=e.$r(B),(Q=N.$$prototype).pos=Q.string=Q.working=Q.matched=Q.prev_pos=Q.match=A,N.$attr_reader("pos","matched"),P(N,"$initialize",function(a){var _=this;return _.string=a,_.pos=0,_.matched=A,_.working=a,_.match=[]}),N.$attr_reader("string"),P(N,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),P(N,"$scan",function(a){var _=this,$=(a=_.$anchor(a)).exec(_.working);return null==$?_.matched=A:(_.prev_pos=_.pos,_.pos+=$[0].length,_.working=_.working.substring($[0].length),_.matched=$[0],_.match=$,$[0])}),P(N,"$scan_until",function(a){var _=this;a=_.$anchor(a);for(var $=_.working,w=0;$.length!=w;++w){var r=a.exec($.substr(w));if(null!==r){var l=w+r[0].length,b=$.substr(0,l);return _.matched=r[0],_.match=r,_.prev_pos=_.pos+w,_.pos+=l,_.working=$.substr(l),b}}return _.matched=A}),P(N,"$[]",function(a){var $;if(o(this.match["$empty?"]()))return A;C(x("Symbol"),$=a)?a=a.$to_s():C(x("String"),$)||(a=D["$coerce_to!"](a,x("Integer"),"to_int"));var w=this.match;return a<0&&(a+=w.length),a<0||a>=w.length||null==w[a]?A:w[a]}),P(N,"$check",function(a){var _=this,$=(a=_.$anchor(a)).exec(_.working);return _.matched=null==$?A:$[0]}),P(N,"$check_until",function(a){var _=this,$=_.prev_pos,w=_.pos,r=_.working,l=_.$scan_until(a);return _.prev_pos=$,_.pos=w,_.working=r,l}),P(N,"$peek",function(a){return this.working.substring(0,a)}),P(N,"$eos?",function(){return 0===this.working.length}),P(N,"$exist?",function(a){var $=a.exec(this.working);return null==$?A:0==$.index?0:$.index+1}),P(N,"$skip",function(a){var _=this,$=(a=_.$anchor(a)).exec(_.working);if(null==$)return _.match=[],_.matched=A;var w=$[0],r=w.length;return _.matched=w,_.match=$,_.prev_pos=_.pos,_.pos+=r,_.working=_.working.substring(r),r}),P(N,"$skip_until",function(a){var $=this.$scan_until(a);return $===A?A:(this.matched=$.substr(-1),$.length)}),P(N,"$get_byte",function(){var a=this,_=A;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,_=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=A,_}),P(N,"$match?",function(a){var _=this,$=(a=_.$anchor(a)).exec(_.working);return null==$?A:(_.prev_pos=_.pos,$[0].length)}),P(N,"$pos=",function(a){var _=this;return a<0&&(a+=_.string.$length()),_.pos=a,_.working=_.string.slice(a)}),P(N,"$matched_size",function(){return this.matched===A?A:this.matched.length}),P(N,"$post_match",function(){var a=this;return a.matched===A?A:a.string.substr(a.pos)}),P(N,"$pre_match",function(){var a=this;return a.matched===A?A:a.string.substr(0,a.prev_pos)}),P(N,"$reset",function(){var a=this;return a.working=a.string,a.matched=A,a.pos=0}),P(N,"$rest",k("working")),P(N,"$rest?",function(){return 0!==this.working.length}),P(N,"$rest_size",function(){return this.$rest().$size()}),P(N,"$terminate",function(){var a,_=this;return _.match=A,a=[_.string.$length()],F(_,"pos=",a),a[a.length-1]}),P(N,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=A,a.match=A,a}),S(N,"bol?","beginning_of_line?"),S(N,"getch","get_byte"),N.$private(),P(N,"$anchor",function(a){var _=a.toString().match(/\/([^\/]+)$/);return _=_?_[1]:void 0,new RegExp("^(?:"+a.source+")",_)})},Opal.modules["bcdice/normalize"]=function(e){var S,j,A,W=e.module,P=e.eqeqeq,o=e.def,C=e.eqeq,D=[],k=e.nil;return S=D,A=[W(D[0],"BCDice")].concat(S),(j=W(A[0],"Normalize")).$module_function(),o(j,"$comparison_operator",function(N){var B;return P(/<=|=</,B=N)?"<=":P(/>=|=>/,B)?">=":P(/<>|!=|=!/,B)?"!=":P(/</,B)?"<":P(/>/,B)?">":P(/=/,B)?"==":k}),o(j,"$target_number",function(N){return C(N,"?")?N:N.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var K,Q,w,r,l,b,M,a,B,W=e.module,P=e.klass,o=e.const_set,C=e.hash2,D=e.truthy,k=e.send,F=e.def,S=e.thrower,L=e.top,A=[],R=e.nil;return L.$require("strscan"),L.$require("bcdice/normalize"),K=A,Q=B=[W(A[0],"BCDice")].concat(K),w=a=[W(B[0],"Command")].concat(Q),l=[r=P(a[0],null,"Lexer")].concat(w),b=e.$r(l),(M=r.$$prototype).scanner=M.notations=R,o(l[0],"SYMBOLS",C(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),F(r,"$initialize",function(h,d){var y,v,c;return h=D(c=(y=(v=h)===R||null==v?R:v.$split(" ",2))===R||null==y?R:y.$first())?c:"",this.scanner=b("StringScanner").$new(h),this.notations=k(d,"map",[],function(f){return null==f&&(f=R),D(f["$is_a?"](b("String")))?b("Regexp").$new(f):f})}),F(r,"$next_token",function(){try{var h=S("return"),d=this,y=R,v=R,c=R,g=R;return D(d.scanner["$eos?"]())?[!1,"$"]:(k(d.notations,"each",[],function f(z){var m,p=null==f.$$s?this:f.$$s;if(null==p.scanner&&(p.scanner=R),null==z&&(z=R),m=p.scanner.$scan(z),!D(m))return R;h.$throw(["NOTATION",m])},{$$s:d,$$ret:h}),D(y=d.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:D(v=d.scanner.$scan(/[<>!=]+/))?(v=b("Normalize").$comparison_operator(v),[D(v)?"CMP_OP":"ILLEGAL",v]):(c=d.scanner.$getch().$upcase(),[D(g=b("SYMBOLS")["$[]"](c))?g:c.$to_sym(),c]))}catch(f){if(f===h)return f.$v;throw f}}),F(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var L,K,X,a,_,$,w,B,R,W=e.module,P=e.klass,o=e.def,C=e.return_ivar,D=e.truthy,k=[],F=e.nil;return L=k,K=R=[W(k[0],"BCDice")].concat(L),X=B=[W(R[0],"Command")].concat(K),_=[a=P(B[0],null,"Parsed")].concat(X),$=e.$r(_),(w=a.$$prototype).critical=w.fumble=w.dollar=w.modify_number=w.question_target=w.target_number=w.prefix_number=w.command=w.suffix_number=w.cmp_op=F,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),o(a,"$initialize",function(){var l=this;return l.prefix_number=F,l.suffix_number=F,l.critical=F,l.fumble=F,l.dollar=F,l.cmp_op=F,l.target_number=F,l.question_target=!1}),o(a,"$question_target?",C("question_target")),o(a,"$to_s",function(l){var b=this,M=F,E=F,h=F,d=F,y=F;switch(null==l&&(l="after_command"),M=D(b.critical)?"@"+b.critical:F,E=D(b.fumble)?"#"+b.fumble:F,h=D(b.dollar)?"$"+b.dollar:F,d=$("Format").$modifier(b.modify_number),y=D(b.question_target)?"?":b.target_number,l){case"after_command":return[b.prefix_number,b.command,b.suffix_number,M,E,h,d,b.cmp_op,y].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,d,M,E,h,b.cmp_op,y].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,d,b.cmp_op,y,M,E,h].$join();default:return F}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var l,h,g,m,s,u,n,i,t,G,Y,U,ie,f,z,p,$e,y,v,M,W=e.klass,P=e.module,o=e.slice,C=e.extract_kwargs,D=e.ensure_kwargs,k=e.get_kwarg,F=e.send2,S=e.find_super,L=e.def,A=e.send,R=e.eqeq,j=e.thrower,K=e.hash,N=e.const_set,B=e.truthy,x=e.to_ary,Q=e.hash2,X=e.top,a=[],_=e.$r(a),$=e.nil,w=e.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),W(w(_("BCDice"),"Command"),w(_("Racc"),"Parser"),"Parser"),l=a,h=M=[P(a[0],"BCDice")].concat(l),y=[P(M[0],"Command")].concat(h),v=e.$r(y),g=y,z=[f=W(y[0],w(v("Racc"),"Parser"),"Parser")].concat(g),p=e.$r(z),($e=f.$$prototype).notations=$e.lexer=$e.modifier=$e.suffix_number=$e.prefix_number=$e.need_suffix_number=$e.need_prefix_number=$e.critical=$e.fumble=$e.dollar=$e.allowed_cmp_op=$e.question_target=$,L(f,"$initialize",function V(q,Z){var H,I,te,re,ee=this;return V.$$p=null,H=o(arguments),I=C(H),I=D(I),te=H,re=k(I,"round_type"),F(ee,S(ee,"initialize",V,!1,!0),"initialize",[],null),ee.notations=te,ee.round_type=re,ee.prefix_number=!1,ee.suffix_number=!1,ee.need_prefix_number=!1,ee.need_suffix_number=!1,ee.modifier=!0,ee.critical=!1,ee.fumble=!1,ee.dollar=!1,ee.allowed_cmp_op=[$,">=",">","<=","<","==","!="],ee.question_target=!1},-2),L(f,"$disable_modifier",function(){return this.modifier=!1,this}),L(f,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),L(f,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),L(f,"$has_prefix_number",function(){var q=this;return q.prefix_number=!0,q.need_prefix_number=!0,q}),L(f,"$has_suffix_number",function(){var q=this;return q.suffix_number=!0,q.need_suffix_number=!0,q}),L(f,"$enable_critical",function(){return this.critical=!0,this}),L(f,"$enable_fumble",function(){return this.fumble=!0,this}),L(f,"$enable_dollar",function(){return this.dollar=!0,this}),L(f,"$restrict_cmp_op_to",function(q){var Z,I=this;return Z=o(arguments),I.allowed_cmp_op=Z,I},-1),L(f,"$enable_question_target",function(){return this.question_target=!0,this}),L(f,"$parse",function(q){var Z=this;try{return Z.lexer=p("Lexer").$new(q,Z.notations),Z.$do_parse()}catch(H){if(!e.rescue(H,[p("ParseError"),p("ZeroDivisionError")]))throw H;try{return $}finally{e.pop_exception()}}}),f.$private(),L(f,"$parsed",function(q,Z,H,I){try{return j("eval_return"),A(p("Parsed").$new(),"tap",[],function ne(ee){var ue,ce,oe,fe,de,_e,me,le=null==ne.$$s?this:ne.$$s;return null==le.round_type&&(le.round_type=$),null==ee&&(ee=$),ee["$command="](q["$[]"]("command")),ee["$prefix_number="]((ue=q["$[]"]("prefix"))===$||null==ue?$:ue.$eval(le.round_type)),ee["$suffix_number="]((ce=q["$[]"]("suffix"))===$||null==ce?$:ce.$eval(le.round_type)),ee["$critical="]((oe=Z["$[]"]("critical"))===$||null==oe?$:oe.$eval(le.round_type)),ee["$fumble="]((fe=Z["$[]"]("fumble"))===$||null==fe?$:fe.$eval(le.round_type)),ee["$dollar="]((de=Z["$[]"]("dollar"))===$||null==de?$:de.$eval(le.round_type)),ee["$modify_number="](H.$eval(le.round_type)),ee["$cmp_op="](I["$[]"]("cmp_op")),R(I["$[]"]("target"),"?")?(ee["$question_target="](!0),A(ee,"target_number=",_e=[0]),_e[_e.length-1]):(ee["$question_target="](!1),_e=[(me=I["$[]"]("target"),me===$||null==me?$:me.$eval(le.round_type))],A(ee,"target_number=",_e),_e[_e.length-1])},{$$s:this})}catch(ne){if(ne===e.t_eval_return)return ne.$v;throw ne}}),L(f,"$next_token",function(){return this.lexer.$next_token()}),m=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),s=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),u=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),n=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),i=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),t=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),G=[$,6,13,3,9,-1,27,-15,-10,-1,-38],Y=[$,$,$,$,$,$,19,16,15,$,$],U=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ie=K(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),N(z[0],"Racc_arg",[m,s,n,u,i,t,Y,G,19,U,ie,58,35,!0]),N(z[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),N(z[0],"Racc_debug_parser",!1),L(f,"$_reduce_1",function(q,Z,H){var I;return B(this.modifier)||this.$raise(p("ParseError")),I=x(q),this.$parsed(null==I[0]?$:I[0],null==I[1]?$:I[1],null==I[2]?$:I[2],null==I[3]?$:I[3])}),L(f,"$_reduce_2",function(q,Z,H){var I;return B(this.modifier)||this.$raise(p("ParseError")),I=x(q),this.$parsed(null==I[0]?$:I[0],null==I[2]?$:I[2],null==I[1]?$:I[1],null==I[3]?$:I[3])}),L(f,"$_reduce_3",function(q,Z,H){var I,ue;return ue=null==(I=x(q))[2]?$:I[2],this.$parsed(null==I[0]?$:I[0],null==I[1]?$:I[1],w(w(p("Arithmetic"),"Node"),"Number").$new(0),ue)}),L(f,"$_reduce_4",function(q,Z,H){var I=this;return B(I.prefix_number)&&B(I.suffix_number)||I.$raise(p("ParseError")),Q(["command","prefix","suffix"],{command:q["$[]"](1),prefix:q["$[]"](0),suffix:q["$[]"](2)})}),L(f,"$_reduce_5",function(q,Z,H){var I=this;return B(I.prefix_number)||I.$raise(p("ParseError")),B(I.need_suffix_number)&&I.$raise(p("ParseError")),Q(["command","prefix"],{command:q["$[]"](1),prefix:q["$[]"](0)})}),L(f,"$_reduce_6",function(q,Z,H){var I=this;return B(I.suffix_number)||I.$raise(p("ParseError")),B(I.need_prefix_number)&&I.$raise(p("ParseError")),Q(["command","suffix"],{command:q["$[]"](0),suffix:q["$[]"](1)})}),L(f,"$_reduce_7",function(q,Z,H){var I=this;return(B(I.need_prefix_number)||B(I.need_suffix_number))&&I.$raise(p("ParseError")),Q(["command"],{command:q["$[]"](0)})}),L(f,"$_reduce_8",function(q,Z,H){return Q([],{})}),L(f,"$_reduce_9",function(q,Z,H){var I,ue,ne=$;return ne=null==(I=x(q))[0]?$:I[0],ue=null==I[2]?$:I[2],B(this.critical)&&B(ne["$[]"]("critical")["$nil?"]())||this.$raise(p("ParseError")),ne["$[]="]("critical",ue),ne}),L(f,"$_reduce_10",function(q,Z,H){var I,ue,ne=$;return ne=null==(I=x(q))[0]?$:I[0],ue=null==I[2]?$:I[2],B(this.fumble)&&B(ne["$[]"]("fumble")["$nil?"]())||this.$raise(p("ParseError")),ne["$[]="]("fumble",ue),ne}),L(f,"$_reduce_11",function(q,Z,H){var I,ue,ne=$;return ne=null==(I=x(q))[0]?$:I[0],ue=null==I[2]?$:I[2],B(this.dollar)&&B(ne["$[]"]("dollar")["$nil?"]())||this.$raise(p("ParseError")),ne["$[]="]("dollar",ue),ne}),L(f,"$_reduce_12",function(q,Z,H){return q["$[]"](1)}),L(f,"$_reduce_13",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"Negative").$new(q["$[]"](1))}),L(f,"$_reduce_14",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"+",q["$[]"](2))}),L(f,"$_reduce_15",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"-",q["$[]"](2))}),L(f,"$_reduce_16",function(q,Z,H){return B(this.allowed_cmp_op["$include?"]($))||this.$raise(p("ParseError")),Q([],{})}),L(f,"$_reduce_17",function(q,Z,H){var I,ne,ee;return ee=null==(I=x(q))[1]?$:I[1],B(this.allowed_cmp_op["$include?"](ne=null==I[0]?$:I[0]))||this.$raise(p("ParseError")),Q(["cmp_op","target"],{cmp_op:ne,target:ee})}),L(f,"$_reduce_18",function(q,Z,H){var te,I=this;return te=q["$[]"](0),B(I.question_target)||I.$raise(p("ParseError")),B(I.allowed_cmp_op["$include?"](te))||I.$raise(p("ParseError")),Q(["cmp_op","target"],{cmp_op:te,target:"?"})}),L(f,"$_reduce_19",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"+",q["$[]"](2))}),L(f,"$_reduce_20",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"-",q["$[]"](2))}),L(f,"$_reduce_22",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"*",q["$[]"](2))}),L(f,"$_reduce_23",function(q,Z,H){return q["$[]"](3).$new(q["$[]"](0),q["$[]"](2))}),L(f,"$_reduce_25",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),L(f,"$_reduce_26",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"DivideWithCeil")}),L(f,"$_reduce_27",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"DivideWithCeil")}),L(f,"$_reduce_28",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"DivideWithRound")}),L(f,"$_reduce_29",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"DivideWithFloor")}),L(f,"$_reduce_30",function(q,Z,H){return q["$[]"](1)}),L(f,"$_reduce_31",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"Negative").$new(q["$[]"](1))}),L(f,"$_reduce_33",function(q,Z,H){return q["$[]"](1)}),L(f,"$_reduce_34",function(q,Z,H){return w(w(p("Arithmetic"),"Node"),"Number").$new(q["$[]"](0))}),L(f,"$_reduce_none",function(q,Z,H){return q["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var A,N,X,a,_,$,x,j,W=e.module,P=e.send,o=e.eqeqeq,C=e.truthy,D=e.def,k=e.return_val,F=[],S=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),X=x=[W(j[0],"Deprecated")].concat(N),_=[a=W(x[0],"Checker")].concat(X),$=e.$r(_),a.$private(),D(a,"$check_result_legacy",function(r,l,b,M){var y,E=this,h=S,d=S,v=S,T=S;return h=P(l,"map",[],"sides".$to_proc()),y=(d=P(l,"map",[],"value".$to_proc())).$sum(),v=o([100],T=h)?E.$check_1D100(r,y,b,M):o([20],T)?E.$check_1D20(r,y,b,M):o([6,6],T)?E.$check_2D6(r,y,d,b,M):S,(C(v["$nil?"]())||C(v["$empty?"]()))&&(v=o([10],T=h.$uniq())?E.$check_nD10(r,y,d,b,M):o([6],T)?E.$check_nD6(r,y,d,b,M):S,C(v["$nil?"]())||C(v["$empty?"]()))?S:$("Result").$new(v.$delete_prefix(" \uff1e "))}),D(a,"$check_1D100",k(S)),D(a,"$check_1D20",k(S)),D(a,"$check_nD10",k(S)),D(a,"$check_2D6",k(S)),D(a,"$check_nD6",k(S))},Opal.modules["bcdice/base"]=function(e){var _,E,T,p,s,u,c,g,f,z,d,W=e.module,P=e.klass,o=e.slice,C=e.rb_plus,D=e.truthy,k=e.def,F=e.regexp,S=e.send,L=e.thrower,A=e.return_ivar,R=e.assign_ivar_val,j=e.eqeqeq,K=e.eqeq,N=e.return_val,B=e.range,x=e.rb_minus,Q=e.rb_divide,X=e.rb_times,a=e.rb_ge,$=e.top,w=[],r=e.$r(w),l=e.nil,b=e.$$$;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),E=w,T=d=[W(w[0],"BCDice")].concat(E),g=[c=P(d[0],null,"Base")].concat(T),f=e.$r(g),(z=c.$$prototype).raw_input=z.randomizer=z.enabled_upcase_input=z.debug=l,s=[p=e.get_singleton_class(c)].concat(g),u=e.$r(s),p.$attr_reader("prefixes"),k(p,"$register_prefix",function(i){var G,Y=this,U=l;return null==Y.prefixes&&(Y.prefixes=l),G=o(arguments),Y.prefixes=C(D(U=Y.prefixes)?U:[],G.$flatten())},-1),k(p,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),k(p,"$prefixes_pattern",function(){var i=this,t=l;return null==i.prefixes_pattern&&(i.prefixes_pattern=l),null==i.prefixes&&(i.prefixes=l),i.prefixes_pattern=D(t=i.prefixes_pattern)?t:l,D(i.prefixes_pattern)?i.prefixes_pattern:(i.prefixes=D(t=i.prefixes)?t:[],i.prefixes.$freeze(),i.prefixes_pattern=(D(i.prefixes["$empty?"]())?/(?!)/:F(["^(S)?(",i.prefixes.$join("|"),")"],"i")).$freeze())}),k(p,"$command_pattern",function(){var i=this,t=l,G=l;return null==i.command_pattern&&(i.command_pattern=l),null==i.prefixes&&(i.prefixes=l),i.command_pattern=D(t=i.command_pattern)?t:l,D(i.command_pattern)?i.command_pattern:(i.prefixes=D(t=i.prefixes)?t:[],i.prefixes.$freeze(),G=C(S(b(u("CommonCommand"),"COMMANDS"),"map",[],function(U){return null==U&&(U=l),b(U,"PREFIX_PATTERN").$source()}),i.prefixes),i.command_pattern=F(["^S?(",G.$join("|"),")"],"i").$freeze())}),k(p,"$eval",function(i){try{return L("eval_return"),this.$new(i).$eval()}catch(Y){if(Y===e.t_eval_return)return Y.$v;throw Y}}),c.$include(f("Translate")),c.$include(b(f("Deprecated"),"Checker")),k(c,"$initialize",function(m){var s=this;return s.raw_input=m,s.sort_add_dice=!1,s.sort_barabara_dice=!1,s.d66_sort_type=b(f("D66SortType"),"NO_SORT"),s.enabled_d9=!1,s.round_type=b(f("RoundType"),"FLOOR"),s.sides_implicit_d=6,s.upper_dice_reroll_threshold=l,s.reroll_dice_reroll_threshold=l,s.default_cmp_op=l,s.default_target_number=l,s.enabled_upcase_input=!0,s.locale="ja_jp",s.randomizer=b(f("BCDice"),"Randomizer").$new(),s.debug=!1}),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),k(c,"$sort_add_dice?",A("sort_add_dice")),k(c,"$sort_barabara_dice?",A("sort_barabara_dice")),k(c,"$enabled_d9?",A("enabled_d9")),k(c,"$enable_debug",R("debug",!0)),k(c,"$eval",function(){var s,n,m=this,u=l;return s=b(f("BCDice"),"Preprocessor").$process(m.raw_input,m),u=D(n=m.$dice_command(s))?n:m.$eval_common_command(m.raw_input),D(u)?(u["$rands="](m.randomizer.$rand_results()),u["$detailed_rands="](m.randomizer.$detailed_rand_results()),u):l}),k(c,"$change_text",function(m){return m}),k(c,"$check_result",function(m,s,u,n){var i=this,t=l,G=l,Y=l,U=l,O=l;return t=i.$check_result_legacy(m,s,u,n),D(t)?t:(G=S(s,"map",[],"sides".$to_proc()),U=(Y=S(s,"map",[],"value".$to_proc())).$sum(),t=j([100],O=G)?i.$result_1d100(m,U,u,n):j([20],O)?i.$result_1d20(m,U,u,n):j([6,6],O)?i.$result_2d6(m,U,Y,u,n):l,K(t,f("Result").$nothing())?l:D(t)?t:(t=j([10],O=G.$uniq())?i.$result_nd10(m,U,Y,u,n):j([6],O)?i.$result_nd6(m,U,Y,u,n):l,K(t,f("Result").$nothing())?l:D(t)?t:i.$result_ndx(m,u,n)))}),k(c,"$grich_text",N(l)),c.$private(),k(c,"$eval_common_command",function(m){try{L("eval_return");var u=L("return");return m=this.$change_text(m),S(b(f("CommonCommand"),"COMMANDS"),"each",[],function i(t){var Y,G=null==i.$$s?this:i.$$s;if(null==G.randomizer&&(G.randomizer=l),null==t&&(t=l),Y=t.$eval(m,G,G.randomizer),!D(Y))return l;u.$throw(Y)},{$$s:this,$$ret:u}),l}catch(i){if(i===e.t_eval_return||i===u)return i.$v;throw i}}),k(c,"$dice_command",function(m){var s=this,u=l,n=l,i=l,t=l;return D(s.enabled_upcase_input)&&(m=m.$upcase()),u=s.$class().$prefixes_pattern().$match(m),D(u)?(n=u["$[]"](1)["$nil?"]()["$!"](),D(n)&&(m=m["$[]"](B(1,-1,!1))),i=s.$eval_game_system_specific_command(m),D(i["$is_a?"](f("Result")))?(i["$secret="](D(t=i["$secret?"]())?t:n),i):D(i["$nil?"]())||D(i["$empty?"]())||K(i,"1")?l:S(f("Result").$new(),"tap",[],function(Y){var U;return null==Y&&(Y=l),Y["$text="](i.$to_s()),S(Y,"secret=",U=[n]),U[U.length-1]})):l}),k(c,"$eval_game_system_specific_command",N(l)),k(c,"$result_ndx",function(m,s,u){return D(u["$is_a?"](f("String")))?l:D(m.$send(s,u))?f("Result").$success(this.$translate("success")):f("Result").$failure(this.$translate("failure"))}),k(c,"$result_1d100",N(l)),k(c,"$result_1d20",N(l)),k(c,"$result_nd10",N(l)),k(c,"$result_2d6",N(l)),k(c,"$result_nd6",N(l)),k(c,"$get_table_by_2d6",function(m){return this.$get_table_by_nD6(m,2)}),k(c,"$get_table_by_1d6",function(m){return this.$get_table_by_nD6(m,1)}),k(c,"$get_table_by_nD6",function(m,s){return this.$get_table_by_nDx(m,s,6)}),k(c,"$get_table_by_nDx",function(m,s,u){var i,t=l;return i=this.randomizer.$roll_sum(s,u),t=this.$get_table_value(m["$[]"](x(i,s))),D(t["$nil?"]())?["1",0]:[t,i]}),k(c,"$get_table_by_1d3",function(m){var n,i,s=this,t=l;return s.$debug("get_table_by_1d3"),n=s.randomizer.$roll_sum(1,6),s.$debug("num",n),i=Q(x(n,1),2).$to_i(),s.$debug("index",i),t=m["$[]"](i),D(t["$nil?"]())?["1",0]:[t,n]}),k(c,"$get_table_by_d66_swap",function(m){var u;return u=this.randomizer.$roll_d66(b(f("D66SortType"),"ASC")),[this.$get_table_by_number(u,m),u]}),k(c,"$get_table_by_d66",function(m){var u,n,i,G,t=l;return u=this.randomizer.$roll_once(6),n=this.randomizer.$roll_once(6),i=C(X(x(u,1),6),x(n,1)),t=m["$[]"](i),G=""+u+n,D(t["$nil?"]())?["1",G]:[t,G]}),k(c,"$get_table_by_number",function(m,s,u){try{var n=L("return");return null==u&&(u="1"),S(s,"each",[],function t(G){var U,Y=null==t.$$s?this:t.$$s;if(null==G&&(G=l),U=G["$[]"](0),!D(a(U,m)))return l;n.$throw(Y.$get_table_value(G["$[]"](1)))},{$$s:this,$$ret:n}),this.$get_table_value(u)}catch(t){if(t===n)return t.$v;throw t}},-3),k(c,"$get_table_value",function(m){return D(m["$is_a?"](f("Proc")))?m.$call():m}),k(c,"$roll_tables",function(m,s){var n=l;return n=s["$[]"](m),D(n)?n.$roll(this.randomizer).$to_s():l}),k(c,"$debug",function(m,s){var n,i=this,t=l,G=l;return n=o(arguments,1),D(i.debug)?(t=D(m["$is_a?"](f("String")))?m:m.$inspect(),D(n["$empty?"]())?i.$warn(t):(G=S(n,"map",[],function(U){return null==U&&(U=l),D(U["$is_a?"](f("String")))?'"'+U+'"':U.$inspect()}),i.$warn(t+": "+G.$join(", ")))):l},-2),b(b(r("I18n"),"Backend"),"Simple").$include(b(b(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),_=[["ja_jp"]],S(r("I18n").$fallbacks(),"defaults=",_),_[_.length-1]},Opal.queue(function(e){var w,M,y,v,T,s,u,n,i,t,c,g,f,h,d,l,W=e.module,P=e.klass,o=e.const_set,C=e.send2,D=e.find_super,k=e.def,F=e.eqeq,S=e.truthy,L=e.rb_le,A=e.rb_ge,R=e.rb_plus,j=e.rb_minus,K=e.hash2,N=e.defs,B=e.send,x=e.to_ary,X=[],a=e.nil,_=e.$$$;return e.top.$require("bcdice/base"),w=X,M=l=[W(X[0],"BCDice")].concat(w),h=[W(l[0],"GameSystem")].concat(M),d=e.$r(h),y=h[0],v=d("Base"),T=h,g=[c=P(y,v,"MagicaLogia")].concat(T),f=e.$r(g),c.$$prototype.randomizer=a,o(g[0],"ID","MagicaLogia"),o(g[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),o(g[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),o(g[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),k(c,"$initialize",function p(m){var u=this;return p.$$p=null,C(u,D(u,"initialize",p,!1,!0),"initialize",[m],null),u.sort_add_dice=!0,u.sort_barabara_dice=!0,u.d66_sort_type=_(f("D66SortType"),"ASC")}),k(c,"$result_2d6",function(m,s,u,n,i){var t=this,G=a;return F(i,"?")||!F(n,">=")?a:((G=S(L(s,2))?f("Result").$fumble(t.$translate("fumble")):S(A(s,12))?f("Result").$critical(t.$translate("MagicaLogia.special")):S(A(m,i))?f("Result").$success(t.$translate("success")):f("Result").$failure(t.$translate("failure")))["$text="](R(G.$text(),t.$gain_magic_element(u["$[]"](0),u["$[]"](1)))),G)}),k(c,"$eval_game_system_specific_command",function(m){var u,s=this;return S(u=_(s.$class(),"SKILL_TABLE").$roll_command(s.randomizer,m))?u:s.$roll_tables(m,_(s.$class(),"TABLES"))}),c.$private(),k(c,"$gain_magic_element",function(m,s){var u=this,n=a;return F(m,s)?(n=u.$translate("MagicaLogia.elements.items")["$[]"](j(m,1)),R(" \uff1e ",u.$format(u.$translate("MagicaLogia.elements.format"),K(["text"],{text:n})))):""}),s=g,n=[u=P(g[0],null,"SkillExpandTable")].concat(s),i=e.$r(n),(t=u.$$prototype).times=t.sides=t.items=t.name=t.skill_table=a,N(u,"$from_i18n",function(Y,U,O){var ie=a;return ie=i("I18n").$t(Y,K(["locale","raise"],{locale:U,raise:!1})),this.$new(ie["$[]"]("name"),ie["$[]"]("type"),ie["$[]"]("items"),O)}),k(u,"$initialize",function(Y,U,O,J){var ie=this,ae=a;return ie.name=Y,ie.items=O.$freeze(),ie.skill_table=J,ae=/(\d+)D(\d+)/i.$match(U),S(ae)||ie.$raise(i("ArgumentError"),"Unexpected table type: "+U),ie.times=ae["$[]"](1).$to_i(),ie.sides=ae["$[]"](2).$to_i()}),k(u,"$roll",function(Y){var O,J,U=this;return O=Y.$roll_sum(U.times,U.sides),J=U.$expand(U.items["$[]"](j(O,U.times)),Y),_(i("DiceTable"),"RollResult").$new(U.name,O,J)}),u.$private(),k(u,"$expand",function(Y,U){return B(Y,"gsub",[/%{([a-z]+)}/],function J(){var se,ie=null==J.$$s?this:J.$$s;return se=i("Regexp").$last_match()["$[]"](1).$to_sym(),ie.$roll_skill(se,U)},{$$s:this})}),o(n[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),k(u,"$roll_skill",function(Y,U){var O=this,J=a;return F(Y,"skill")?O.skill_table.$roll_skill(U):F(Y,"element")?O.skill_table.$roll_category(U):(J=i("CATEGORIES").$index(Y),S(J)||O.$raise(i("ArgumentError")),O.skill_table.$categories()["$[]"](J).$roll(U).$name())}),function(p,m,s){var u=P(p,null,"FallenAfterTable"),n=[u].concat(s),i=e.$r(n),t=u.$$prototype;t.lower=t.higher=t.name=a,N(u,"$from_i18n",function(Y,U){var J=a;return J=i("I18n").$t(Y,K(["locale","raise"],{locale:U,raise:!0})),this.$new(J["$[]"]("name"),J["$[]"]("items_lower"),J["$[]"]("items_higher"))}),k(u,"$initialize",function(Y,U,O){var J=this;return J.name=Y,J.lower=U,J.higher=O}),k(u,"$roll",function(Y){var U,O,ie,ae,J=this,se=a;return O=Y.$roll_barabara(2,6),ae=null==(U=x(O))[1]?a:U[1],se=S(L(ie=null==U[0]?a:U[0],3))?J.lower:J.higher,J.name+"("+ie+","+ae+") \uff1e "+se["$[]"](j(ae,1))})}(g[0],0,g),function(p,m){var s=[p].concat(m),u=e.$r(s);p.$private(),k(p,"$translate_skill_table",function(i){return _(u("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",i,K(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))}),k(p,"$translate_tables",function(i,t){var G,Y,U,O,J,ie;return G=u("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",i,t),Y=_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",i),U=_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",i),O=_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",i),J=_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",i),ie=u("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",i,t),K(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",i,t),ST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",i,t),FT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",i),WT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",i,t),FCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",i),AT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",i,t),BGT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",i),DAT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",i),FAT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",i),WIT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",i),TCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",i),PCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",i),MCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",i),ICT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",i),SCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",i),XCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",i),WCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",i),CCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",i),MIT:G,MOT:Y,MAT:U,MUT:O,MFT:J,MLT:ie,BST:_(u("DiceTable"),"ChainTable").$new(u("I18n").$translate("MagicaLogia.tables.BST.name",K(["raise","locale"],{raise:!0,locale:i})),"1D6",[G,Y,U,O,J,ie]),PT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",i),XEST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",i,t),IWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",i,t),MCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",i,t),WDST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",i,t),LWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",i,t),STB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",i,t),MGCT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",i),MBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",i,t),MAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",i,t),TCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",i,t),PWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",i,t),PAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",i,t),GBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",i,t),SLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",i,t),WLAT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",i),WMT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",i,t),FFT:_(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",i),OLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",i,t),TPTB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",i,t),FLT:u("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",i)})})}(e.get_singleton_class(c),g),o(g[0],"SKILL_TABLE",c.$translate_skill_table("ja_jp")),o(g[0],"TABLES",c.$translate_tables("ja_jp",f("SKILL_TABLE"))),c.$register_prefix(f("SKILL_TABLE").$prefixes()),c.$register_prefix(f("TABLES").$keys())})}}]);