(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7553],{4236:(oe,se,Z)=>{Z(9993),Opal.modules["bcdice/game_system/DetatokoSaga"]=function(l){var P,ee,le,$,x,b,N,ae,Y,B=l.module,C=l.klass,_=l.const_set,L=l.send2,M=l.find_super,d=l.def,g=l.truthy,c=l.hash2,o=l.rb_plus,w=l.to_ary,A=l.rb_minus,R=l.eqeq,V=l.neqeq,p=l.rb_ge,I=l.rb_gt,J=l.eqeqeq,W=l.thrower,K=l.rb_divide,F=l.rb_times,G=l.send,j=l.defs,y=[],e=l.nil,D=l.$$$;return P=y,ee=Y=[B(y[0],"BCDice")].concat(P),N=[B(Y[0],"GameSystem")].concat(ee),ae=l.$r(N),le=N,x=[$=C(N[0],ae("Base"),"DetatokoSaga")].concat(le),b=l.$r(x),$.$$prototype.randomizer=e,_(x[0],"ID","DetatokoSaga"),_(x[0],"NAME","\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac"),_(x[0],"SORT_KEY","\u3066\u305f\u3068\u3053\u3055\u3042\u304b"),_(x[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000xDS or xDSy or xDS>=t or xDSy>=t or xDS+z>=t or xDSy+z>=t\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10)\u3001t\uff1d\u76ee\u6a19\u5024(\u7701\u7565\u6642\uff18))\n\u3000\u4f8b\uff093DS\u30002DS5\u30000DS\u30003DS>=10\u30003DS7>=12 2DS3+1 3DS2+1>=10\n\u30fb\u5224\u5b9a\u5024\u3000xJD or xJDy or xJDy+z or xJDy-z or xJDy/z\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10))\n\u3000\u4f8b\uff093JD\u30002JD5\u30003JD7+1\u30004JD/3\n\u30fb\u4f53\u529b\u70d9\u5370\u8868\u3000SST (StrengthStigmaTable)\n\u30fb\u6c17\u529b\u70d9\u5370\u8868\u3000WST (WillStigmaTable)\n\u30fb\u4f53\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000SBET (StrengthBadEndTable)\n\u30fb\u6c17\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000WBET (WillBadEndTable)\n"),$.$register_prefix("\\d+DS","\\d+JD"),d($,"$initialize",function f(a){var t=this;return f.$$p=null,L(t,M(t,"initialize",f,!1,!0),"initialize",[a],null),t.sort_add_dice=!0,t.d66_sort_type=D(b("D66SortType"),"ASC")}),d($,"$eval_game_system_specific_command",function(a){var r=this,t=e,n=e;return r.$debug("eval_game_system_specific_command begin string",a),t=r.$checkRoll(a),g(t)||(t=r.$checkJudgeValue(a),g(t))?t:(r.$debug("\u5404\u7a2e\u8868\u3068\u3057\u3066\u51e6\u7406"),r.$roll_tables(g(n=b("ALIAS")["$[]"](a))?n:a,D(r.$class(),"TABLES")))}),d($,"$checkRoll",function(a){var r,t,n,v,E,k,u,h,U,X,z,i=this,s=e,S=e,m=e,T=e;if(i.$debug("checkRoll begin string",a),s=/^(\d+)DS(\d+)?(([+-\/])(\d+))?(?:>=(\d+))?$/i.$match(a),!g(s))return e;if(v=s["$[]"](1).$to_i(),E=s["$[]"](2).$to_i(),k=s["$[]"](4),u=s["$[]"](5).$to_i(),h=g(z=(r=s["$[]"](6))===e||null==r?e:r.$to_i())?z:8,S=i.$translate("DetatokoSaga.DS.input_options",c(["skill","flag","target"],{skill:v,flag:E,target:h})),m=i.$getModifyText(k,u),g(m["$empty?"]())||(S=o(S,i.$translate("DetatokoSaga.DS.modifier",c(["modifier"],{modifier:m})))),n=i.$getRollResult(v),t=w(n),S=o(S," \uff1e "+(T=null==t[0]?e:t[0])+"["+(null==t[1]?e:t[1])+"]"+m),U=i.$getTotalResultValue(T,u,k),S=o(S," \uff1e "+U),!g(m["$empty?"]()))switch(k){case"+":T=o(T,u);break;case"-":T=A(T,u)}return X=i.$getSuccess(T,h),S=o(S," \uff1e "+X),o(S,i.$getCheckFlagResult(T,E))}),d($,"$getRollResult",function(a){var i,t=e,n=e;return t=o(a,1),R(a,0)&&(t=3),i=(n=this.randomizer.$roll_barabara(t,6)).$join(","),n=n.$sort(),V(a,0)&&(n=n.$reverse()),[o(n["$[]"](0),n["$[]"](1)),i]}),d($,"$getSuccess",function(a,r){return g(p(a,r))?this.$translate("DetatokoSaga.DS.success"):this.$translate("DetatokoSaga.DS.failure")}),d($,"$getCheckFlagResult",function(a,r){var n=e;return g(I(a,r))?"":(n=this.$getDownWill(r),this.$translate("DetatokoSaga.less_than_flag",c(["will"],{will:n})))}),d($,"$getDownWill",function(a){return g(p(a,10))?"6":"1D6->"+this.randomizer.$roll_once(6)}),d($,"$checkJudgeValue",function(a){var r,t,n=this,i=e,s=e,v=e,E=e,k=e,u=e,h=e,z=e,m=e;return n.$debug("checkJudgeValue begin string",a),i=/^(\d+)JD(\d+)?(([+-\/])(\d+))?$/i.$match(a),g(i)?(s=i["$[]"](1).$to_i(),v=i["$[]"](2).$to_i(),E=i["$[]"](4),k=i["$[]"](5).$to_i(),u=n.$translate("DetatokoSaga.JD.input_options",c(["skill","flag"],{skill:s,flag:v})),h=n.$getModifyText(E,k),g(h["$empty?"]())||(u=o(u,n.$translate("DetatokoSaga.JD.modifier",c(["modifier"],{modifier:h})))),t=n.$getRollResult(s),r=w(t),u=o(u," \uff1e "+(z=null==r[0]?e:r[0])+"["+(null==r[1]?e:r[1])+"]"+h),m=n.$getTotalResultValue(z,k,E),u=o(u," \uff1e "+m),u=o(u,n.$getCheckFlagResult(z,v))):e}),d($,"$getModifyText",function(a,r){try{var t=W("return"),i=e;return R(r,0)?"":""+(J("+",i=a)?"\uff0b":J("-",i)?"\uff0d":J("/",i)?"\xf7":void t.$throw(""))+r}catch(s){if(s===t)return s.$v;throw s}}),d($,"$getTotalResultValue",function(a,r,t){var n=this;switch(t){case"+":return o(a+"+"+r+" \uff1e ",n.$translate("DetatokoSaga.total_value",c(["total"],{total:o(a,r)})));case"-":return o(a+"-"+r+" \uff1e ",n.$translate("DetatokoSaga.total_value",c(["total"],{total:A(a,r)})));case"/":return n.$getTotalResultValueWhenSlash(a,r);default:return n.$translate("DetatokoSaga.total_value",c(["total"],{total:a}))}}),d($,"$getTotalResultValueWhenSlash",function(a,r){var n=e;return R(r,0)?this.$translate("DetatokoSaga.division_by_zero_error"):(n=K(F(1,a),r).$ceil(),o(a+"\xf7"+r+" \uff1e ",this.$translate("DetatokoSaga.total_value",c(["total"],{total:n}))))}),_(x[0],"ALIAS",G(c(["StrengthStigmaTable","WillStigmaTable","StrengthBadEndTable","WillBadEndTable"],{StrengthStigmaTable:"SST",WillStigmaTable:"WST",StrengthBadEndTable:"SBET",WillBadEndTable:"WBET"}),"transform_keys",[],"upcase".$to_proc()).$freeze()),j($,"$translate_tables",function(a){return c(["SST","WST","SBET","WBET"],{SST:D(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SST",a),WST:D(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WST",a),SBET:D(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SBET",a),WBET:D(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WBET",a)})}),_(x[0],"TABLES",$.$translate_tables("ja_jp").$freeze()),$.$register_prefix(b("TABLES").$keys(),b("ALIAS").$keys())},Opal.queue(function(l){var A,I,j,y,e,W,K,V,B=l.module,C=l.klass,_=l.const_set,L=l.send2,M=l.find_super,d=l.def,c=[];return l.top.$require("bcdice/game_system/DetatokoSaga"),A=c,I=V=[B(c[0],"BCDice")].concat(A),W=[B(V[0],"GameSystem")].concat(I),K=l.$r(W),j=W,_((e=[y=C(W[0],K("DetatokoSaga"),"DetatokoSaga_Korean")].concat(j))[0],"ID","DetatokoSaga:Korean"),_(e[0],"NAME","\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00"),_(e[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00"),_(e[0],"HELP_MESSAGE","\u30fb\ud1b5\uc0c1\ud310\uc815\u3000xDS or xDSy or xDS>=t or xDSy>=t or xDS+z>=t or xDSy+z>=t\n\u3000(x\uff1d\uc2a4\ud0ac\ub808\ubca8, y\uff1d\ud604\uc7ac \ud50c\ub798\uadf8(\uc0dd\ub7b5=0), z\uff1d\uc218\uc815\uce58(\uc0dd\ub7b5=\uff10), t\uff1d\ubaa9\ud45c\uce58(\uc0dd\ub7b5=\uff18))\n\u3000\uc608\uff093DS\u30002DS5\u30000DS\u30003DS>=10\u30003DS7>=12 2DS3+1 3DS2+1>=10\n\u30fb\ud310\uc815\uce58\u3000xJD or xJDy or xJDy+z or xJDy-z or xJDy/z\n\u3000(x\uff1d\uc2a4\ud0ac\ub808\ubca8, y\uff1d\ud604\uc7ac \ud50c\ub798\uadf8(\uc0dd\ub7b5=0), z\uff1d\uc218\uc815\uce58(\uc0dd\ub7b5=\uff10))\n\u3000\uc608\uff093JD\u30002JD5\u30003JD7+1\u30004JD/3\n\u30fb\uccb4\ub825 \ub099\uc778\ud45c\u3000SST (StrengthStigmaTable)\n\u30fb\uae30\ub825 \ub099\uc778\ud45c\u3000WST (WillStigmaTable)\n\u30fb\uccb4\ub825 \ubc30\ub4dc\uc5d4\ub529\ud45c\u3000SBET (StrengthBadEndTable)\n\u30fb\uae30\ub825 \ubc30\ub4dc\uc5d4\ub529\ud45c\u3000WBET (WillBadEndTable)\n"),y.$register_prefix_from_super_class(),d(y,"$initialize",function D(H){var q=this;return D.$$p=null,L(q,M(q,"initialize",D,!1,!0),"initialize",[H],null),q.locale="ko_kr"}),_(e[0],"TABLES",y.$translate_tables("ko_kr"))})}}]);