(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8196],{206:(ye,pe,ge)=>{ge(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var M,j,$,l,p,F,z,Z,Y=e.module,G=e.ensure_kwargs,c=e.truthy,L=e.thrower,P=e.def,o=[],H=e.nil,h=e.$$$;return M=o,j=Z=[Y(o[0],"BCDice")].concat(M),z=[F=Y(Z[0],"ArithmeticEvaluator")].concat(j),l=[$=e.get_singleton_class(F)].concat(z),p=e.$r(l),P($,"$eval",function(C,r){try{L("eval_return");var g,K=H;return null==(g=(r=G(r)).$$smap.round_type)&&(g=h(p("RoundType"),"FLOOR")),c(C)&&c(K=p("Arithmetic").$eval(C,g))?K:0}catch(E){if(E===e.t_eval_return)return E.$v;throw E}},-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){var B,_,r,n,l,p,Y=e.module,G=e.class_variable_set,c=e.truthy,L=e.class_variable_get,P=e.def,o=e.send,H=e.send2,h=e.find_super,A=e.hash2,M=e.find_block_super,D=e.neqeq,Z=e.thrower,W=e.return_val,j=[],F=e.nil,z=e.$$$;return B=j,p=[l=Y(j[0],"I18n")].concat(B),G(p[0],"@@fallbacks",F),_=e.get_singleton_class(l),r=[_].concat(p),n=e.$r(r),P(_,"$fallbacks",function(){var E=F;return G(r[1],"@@fallbacks",c(null!=r[1].$$cvars["@@fallbacks"]?"class variable":F)&&c(E=L(r[1],"@@fallbacks",!1))?E:z(z(n("I18n"),"Locale"),"Fallbacks").$new()),c(E=n("Thread").$current()["$[]"]("i18n_fallbacks"))?E:L(r[1],"@@fallbacks",!1)}),P(_,"$fallbacks=",function(K){var E;return G(r[1],"@@fallbacks",c(K["$is_a?"](n("Array")))?z(z(n("I18n"),"Locale"),"Fallbacks").$new(K):K),E=["i18n_fallbacks",L(r[1],"@@fallbacks",!1)],o(n("Thread").$current(),"[]=",E),E[E.length-1]}),function(_,C){var K,E,w,k,n=[Y(_,"Backend")].concat(C);return K=n,w=[E=Y(n[0],"Fallbacks")].concat(K),k=e.$r(w),P(E,"$translate",function N(b,y,a){try{var d=Z("return"),f=N.$$p||F,q=this,u=F,v=F;return N.$$p=null,null==a&&(a=k("EMPTY_HASH")),c(a.$fetch("fallback",!0))?c(a["$[]"]("fallback_in_progress"))?H(q,h(q,"translate",N,!1,!0),"translate",[b,y,a],f):(c(a["$[]"]("default"))&&(u=q["$extract_non_symbol_default!"](a)),v=a.$merge(A(["fallback_in_progress"],{fallback_in_progress:!0})),o(k("I18n").$fallbacks()["$[]"](b),"each",[],function t(T){var i=null==t.$$s?this:t.$$s;null==T&&(T=F);try{return o(i,"catch",["exception"],function m(){var s=null==m.$$s?this:m.$$s,X=F;if(X=H(s,M(s,"translate",m.$$def||t.$$def||N,!1,!1),"translate",[T,y,v],null),c(X["$nil?"]()))return F;D(b.$to_s(),T.$to_s())&&s.$on_fallback(b,T,y,a),d.$throw(X)},{$$s:i,$$ret:d})}catch(m){if(!e.rescue(m,[z(k("I18n"),"InvalidLocale")]))throw m;try{return F}finally{e.pop_exception()}}},{$$s:q}),c(a["$key?"]("default"))&&c(a["$[]"]("default")["$nil?"]())?F:c(u)?H(q,h(q,"translate",N,!1,!0),"translate",[b,F,a.$merge(A(["default"],{default:u}))],null):q.$throw("exception",z(k("I18n"),"MissingTranslation").$new(b,y,a))):H(q,h(q,"translate",N,!1,!0),"translate",[b,y,a],f)}catch(t){if(t===d)return t.$v;throw t}},-3),P(E,"$extract_non_symbol_default!",function(b){var a,y=F;return y=[b["$[]"]("default")].$flatten(),a=o(y,"detect",[],function(f){return null==f&&(f=F),f["$is_a?"](k("Symbol"))["$!"]()}),c(a)&&b["$[]="]("default",y["$[]"](0,y.$index(a))),a}),P(E,"$exists?",function N(b,y,a){try{var d=Z("return"),f=N.$$p||F,q=this;return N.$$p=null,null==a&&(a=k("EMPTY_HASH")),c(a.$fetch("fallback",!0))?(o(k("I18n").$fallbacks()["$[]"](b),"each",[],function u(v){var t=null==u.$$s?this:u.$$s;null==v&&(v=F);try{if(!c(H(t,M(t,"exists?",u.$$def||N,!1,!1),"exists?",[v,y],null)))return F;d.$throw(!0)}catch(T){if(!e.rescue(T,[z(k("I18n"),"InvalidLocale")]))throw T;try{return F}finally{e.pop_exception()}}},{$$s:q,$$ret:d}),!1):H(q,h(q,"exists?",N,!1,!0),"exists?",[b,y,a],f)}catch(u){if(u===d)return u.$v;throw u}},-3),E.$private(),P(E,"$on_fallback",W(F))}(p[0],p)},Opal.modules["bcdice/randomizer"]=function(e){var l,g,K,E,w,k,_,C,G=e.klass,c=e.const_set,L=e.def,P=e.truthy,o=e.rb_gt,H=e.rb_plus,h=e.rb_le,A=e.send,M=e.rb_minus,D=e.eqeq,Z=e.rb_times,W=e.eqeqeq,j=e.rb_ge,F=[],z=e.nil,$=e.$$$;return l=F,_=[(0,e.module)(F[0],"BCDice")].concat(l),C=e.$r(_),g=_,E=[K=G(_[0],null,"Randomizer")].concat(g),w=e.$r(E),(k=K.$$prototype).rand_results=k.detailed_rand_results=z,c(E[0],"UPPER_LIMIT_DICE_TIMES",200),c(E[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(E[0],"UPPER_LIMIT_RANDS",1e4),L(K,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),K.$attr_reader("rand_results"),K.$attr_reader("detailed_rand_results"),c(E[0],"DetailedRandResult",w("Struct").$new("kind","sides","value")),L(K,"$roll_barabara",function(b,y){var a=this;return P(o(H(a.rand_results.$size(),b),w("UPPER_LIMIT_RANDS")))&&a.$raise(w("TooManyRandsError")),P(h(b,0))||P(o(b,w("UPPER_LIMIT_DICE_TIMES")))?[]:A(w("Array"),"new",[b],function d(){return(null==d.$$s?this:d.$$s).$roll_once(y)},{$$s:a})}),L(K,"$roll_sum",function(b,y){return this.$roll_barabara(b,y).$sum()}),L(K,"$roll_once",function(b){var a=z;return P(h(b,0))||P(o(b,w("UPPER_LIMIT_DICE_SIDES")))?0:(a=this.$rand_inner(b),this.$push_to_detail("normal",b,a),a)}),L(K,"$roll_index",function(b){return M(this.$roll_once(b),1)}),L(K,"$roll_tens_d10",function(){var a,y=z;return y=this.$rand_inner(10),D(y,10)&&(y=0),a=Z(y,10),this.$push_to_detail("tens_d10",10,a),a}),L(K,"$roll_d9",function(){var y;return y=M(this.$rand_inner(10),1),this.$push_to_detail("d9",10,y),y}),L(K,"$roll_d66",function(b){var d,a=z;return a=A(w("Array"),"new",[2],function f(){return(null==f.$$s?this:f.$$s).$roll_once(6)},{$$s:this}),W($(w("D66SortType"),"ASC"),d=b)?a["$sort!"]():W($(w("D66SortType"),"DESC"),d)&&a["$sort!"]()["$reverse!"](),H(Z(a["$[]"](0),10),a["$[]"](1))}),K.$private(),L(K,"$rand_inner",function(b){var a,y=this;return P(j(y.rand_results.$size(),w("UPPER_LIMIT_RANDS")))&&y.$raise(w("TooManyRandsError")),a=y.$random(b),y.rand_results["$<<"]([a,b]),a}),L(K,"$random",function(b){return H(w("Kernel").$rand(b),1)}),L(K,"$push_to_detail",function(b,y,a){var f;return f=w("DetailedRandResult").$new(b,y,a),this.detailed_rand_results.$push(f)}),G(_[0],C("StandardError"),"TooManyRandsError"),z},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var A,W,B,l,p,_,C,F,D,Y=e.module,G=e.klass,c=e.def,L=e.truthy,P=e.return_val,o=[],H=e.nil;return A=o,W=D=[Y(o[0],"BCDice")].concat(A),B=F=[Y(D[0],"DiceTable")].concat(W),p=[l=G(F[0],null,"RollResult")].concat(B),_=e.$r(p),(C=l.$$prototype).table_name=C.value=C.body=H,c(l,"$initialize",function(n,g,K){var E=this;return E.table_name=n,E.value=g,E.body=K}),l.$attr_reader("table_name"),l.$attr_reader("value"),l.$attr_reader("body"),c(l,"$to_s",function(){var n=this;return n.table_name+"("+n.value+") \uff1e "+n.body}),c(l,"$last_body",function(){var n=this;return L(n.body["$is_a?"](_("RollResult")))?n.body.$last_body():n.body}),c(l,"$empty?",P(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var A,W,B,l,p,_,C,F,D,Y=e.module,G=e.klass,c=e.truthy,L=e.def,P=e.rb_minus,o=[],H=e.nil;return A=o,W=D=[Y(o[0],"BCDice")].concat(A),B=F=[Y(D[0],"DiceTable")].concat(W),p=[l=G(F[0],null,"ChainTable")].concat(B),_=e.$r(p),(C=l.$$prototype).times=C.sides=C.items=C.name=H,L(l,"$initialize",function(n,g,K){var E=this,w=H;return E.name=n,E.items=K.$freeze(),w=/(\d+)D(\d+)/i.$match(g),c(w)||E.$raise(_("ArgumentError"),"Unexpected table type: "+g),E.times=w["$[]"](1).$to_i(),E.sides=w["$[]"](2).$to_i()}),L(l,"$roll",function(n){var K,E,g=this,w=H;return K=n.$roll_sum(g.times,g.sides),E=P(K,g.times),w=g.items["$[]"](E),c(w["$respond_to?"]("roll"))&&(w=w.$roll(n)),_("RollResult").$new(g.name,K,w)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var Z,z,_,C,r,n,g,B,j,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.def,o=e.rb_plus,H=e.rb_times,h=e.rb_minus,A=[],M=e.nil;return Z=A,z=j=[Y(A[0],"BCDice")].concat(Z),_=B=[Y(j[0],"DiceTable")].concat(z),r=[C=G(B[0],null,"D66GridTable")].concat(_),n=e.$r(r),(g=C.$$prototype).name=g.items=M,L(C,"$from_i18n",function(E,w){var N=M;return N=n("I18n").$t(E,c(["locale","raise"],{locale:w,raise:!0})),this.$new(N["$[]"]("name"),N["$[]"]("items"))}),P(C,"$initialize",function(E,w){return this.name=E,this.items=w.$freeze()}),P(C,"$roll",function(E){var k,N,b,y,a;return k=E.$roll_once(6),N=E.$roll_once(6),b=o(H(k,10),N),y=h(k,1),a=h(N,1),n("RollResult").$new(this.name,b,this.items["$[]"](y)["$[]"](a))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var M,j,p,_,C,r,z,$,Z,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.def,H=[],h=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),M=H,j=Z=[Y(H[0],"BCDice")].concat(M),z=[Y(Z[0],"DiceTable")].concat(j),$=e.$r(z),p=z,C=[_=G(z[0],$("D66GridTable"),"D66HalfGridTable")].concat(p),r=e.$r(C),L(_,"$from_i18n",function(g,K){var w=h;return w=r("I18n").$t(g,c(["locale","raise"],{locale:K,raise:!0})),this.$new(w["$[]"]("name"),w["$[]"]("items_1_2_3"),w["$[]"]("items_4_5_6"))}),P(_,"$initialize",function(g,K,E){return this.name=g,this.items=[K,K,K,E,E,E].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var M,j,p,_,C,r,z,$,Z,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.def,H=[],h=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),M=H,j=Z=[Y(H[0],"BCDice")].concat(M),z=[Y(Z[0],"DiceTable")].concat(j),$=e.$r(z),p=z,C=[_=G(z[0],$("D66GridTable"),"D66OneThirdTable")].concat(p),r=e.$r(C),L(_,"$from_i18n",function(g,K){var w=h;return w=r("I18n").$t(g,c(["locale","raise"],{locale:K,raise:!0})),this.$new(w["$[]"]("name"),w["$[]"]("items_1_2"),w["$[]"]("items_3_4"),w["$[]"]("items_5_6"))}),P(_,"$initialize",function(g,K,E,w){return this.name=g,this.items=[K,K,E,E,w,w].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var j,B,r,n,g,K,E,p,z,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.def,o=e.eqeqeq,H=e.rb_plus,h=e.rb_times,A=e.truthy,M=[],D=e.nil,Z=e.$$$;return j=M,B=z=[Y(M[0],"BCDice")].concat(j),r=p=[Y(z[0],"DiceTable")].concat(B),g=[n=G(p[0],null,"D66Table")].concat(r),K=e.$r(g),(E=n.$$prototype).sort_type=E.items=E.name=D,L(n,"$from_i18n",function(k,N){var a,y=D;return y=K("I18n").$t(k,c(["locale"],{locale:N})),a=K("D66SortType").$const_get(y["$[]"]("d66_sort_type")),this.$new(y["$[]"]("name"),a,y["$[]"]("items"))}),P(n,"$initialize",function(k,N,b){var y=this;return y.name=k,y.sort_type=N,y.items=b.$freeze()}),P(n,"$roll",function(k){var N=this,b=D,y=D,a=D,d=D;return b=k.$roll_barabara(2,6),o(Z(K("D66SortType"),"ASC"),y=N.sort_type)?b["$sort!"]():o(Z(K("D66SortType"),"DESC"),y)&&b["$sort!"]()["$reverse!"](),a=H(h(b["$[]"](0),10),b["$[]"](1)),d=A(y=N.items["$[]"](a))?y:N.items["$[]"](a.$to_s()),A(d["$respond_to?"]("roll"))&&(d=d.$roll(k)),K("RollResult").$new(N.name,a,d)}),P(n,"$choice",function(k){return K("RollResult").$new(this.name,k,this.items["$[]"](k))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var F,l,_,C,$,Y=e.module,G=e.klass,c=e.hash2,L=e.send,P=e.to_ary,o=e.rb_plus,H=e.rb_times,h=e.send2,A=e.find_super,M=e.def,Z=[],W=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),F=Z,l=$=[Y(Z[0],"BCDice")].concat(F),_=[Y($[0],"DiceTable")].concat(l),C=e.$r(_),M(G(_[0],C("D66Table"),"D66LeftRangeTable"),"$initialize",function K(E,w,k){var y;return K.$$p=null,y=c([],{}),L(k,"each",[],function(d){var f,v;return null==d&&(d=W),f=P(d),v=null==f[1]?W:f[1],L(null==f[0]?W:f[0],"each",[],function(T){return null==T&&(T=W),L(v,"each_with_index",[],function(m,s){var X,te;return null==m&&(m=W),null==s&&(s=W),te=o(H(T,10),o(s,1)),L(y,"[]=",X=[te,m]),X[X.length-1]})})}),h(this,A(this,"initialize",K,!1,!0),"initialize",[E,w,y],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var W,$,C,r,n,g,K,l,F,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.def,o=e.truthy,H=e.rb_minus,h=e.rb_plus,A=e.rb_times,M=[],D=e.nil;return W=M,$=F=[Y(M[0],"BCDice")].concat(W),C=l=[Y(F[0],"DiceTable")].concat($),n=[r=G(l[0],null,"D66ParityTable")].concat(C),g=e.$r(n),(K=r.$$prototype).odd=K.even=K.name=D,L(r,"$from_i18n",function(w,k){var b=D;return b=g("I18n").$t(w,c(["locale","raise"],{locale:k,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("odd"),b["$[]"]("even"))}),P(r,"$initialize",function(w,k,N){var b=this;return b.name=w,b.odd=k.$freeze(),b.even=N.$freeze()}),P(r,"$roll",function(w){var b,a,d,k=this,N=D;return N=w.$roll_once(6),b=w.$roll_once(6),a=(o(N["$odd?"]())?k.odd:k.even)["$[]"](H(b,1)),d=h(A(N,10),b),g("RollResult").$new(k.name,d,a)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var M,j,l,p,_,C,r,z,Z,Y=e.module,G=e.klass,c=e.def,L=e.rb_plus,P=e.rb_times,o=e.send,H=[],h=e.nil;return M=H,j=Z=[Y(H[0],"BCDice")].concat(M),l=z=[Y(Z[0],"DiceTable")].concat(j),_=[p=G(z[0],null,"D66RangeTable")].concat(l),C=e.$r(_),(r=p.$$prototype).items=r.name=h,c(p,"$initialize",function(g,K){return this.name=g,this.items=K.$freeze()}),c(p,"$roll",function(g){var E,w,k,N=h;return E=g.$roll_once(6),w=g.$roll_once(6),k=L(P(E,10),w),N=o(this.items,"find",[],function(y){return null==y&&(y=h),y["$[]"](0)["$include?"](k)}),C("RollResult").$new(this.name,k,N["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var W,$,C,r,n,g,K,l,F,Y=e.module,G=e.klass,c=e.const_set,L=e.send,P=e.truthy,o=e.def,H=e.eqeqeq,h=e.rb_times,A=e.rb_plus,M=[],D=e.nil;return W=M,$=F=[Y(M[0],"BCDice")].concat(W),C=l=[Y(F[0],"DiceTable")].concat($),n=[r=G(l[0],null,"RangeTable")].concat(C),g=e.$r(n),(K=r.$$prototype).name=K.items=K.num_of_dice=K.num_of_sides=K.formatter=D,c(n[0],"RollResult",L(g("Struct"),"new",["sum","values","content","formatted"],function E(){return(null==E.$$s?this:E.$$s).$alias_method("to_s","formatted")},{$$s:r})),c(n[0],"Item",g("Struct").$new("range","content")),c(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(n[0],"DEFAULT_FORMATTER",L(r,"lambda",[],function(w,k){return null==w&&(w=D),null==k&&(k=D),w.$name()+"("+k.$sum()+") \uff1e "+k.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),o(r,"$initialize",function E(w,k,N){var a,b=E.$$p||D,y=this,d=D;return E.$$p=null,y.name=w.$freeze(),y.formatter=P(a=b)?a:g("DEFAULT_FORMATTER"),d=g("DICE_ROLL_METHOD_RE").$match(k),P(d)||y.$raise(g("ArgumentError"),y.name+": invalid dice roll method: "+k),y.num_of_dice=d["$[]"](1).$to_i(),y.num_of_sides=d["$[]"](2).$to_i(),y.$store(N)}),o(r,"$fetch",function(w){var N,k=this;return N=L(k.items,"find",[],function(y){return null==y&&(y=D),y.$range()["$include?"](w)}),P(N)||k.$raise(g("RangeError"),k.name+": value is out of range: "+w),N}),o(r,"$roll",function(w){var b,k=this,N=D,y=D;return b=(N=w.$roll_barabara(k.num_of_dice,k.num_of_sides)).$sum(),(y=g("RollResult").$new(b,N,k.$fetch(b).$content()))["$formatted="](k.formatter["$[]"](k,y)),y}),r.$private(),o(r,"$store",function(w){var N,b,k=this;return N=L(w,"map",[],function y(a,d){return null==a&&(a=D),null==d&&(d=D),[(null==y.$$s?this:y.$$s).$coerce_to_int_range(a),d]},{$$s:k}),b=L(N,"sort_by",[],function(a,d){return null==a&&(a=D),null==d&&(d=D),a.$min()}),k.$assert_min_sum_is_covered(b),k.$assert_max_sum_is_covered(b),k.$assert_no_gap_or_overlap_in_ranges(b),k.items=L(b,"map",[],function(a,d){return null==a&&(a=D),null==d&&(d=D),g("Item").$new(a,d.$freeze()).$freeze()}).$freeze(),k}),o(r,"$coerce_to_int_range",function(w){var N;return H(g("Integer"),N=w)?g("Range").$new(w,w):H(g("Range"),N)&&P(w.$begin()["$is_a?"](g("Integer")))&&P(w.$end()["$is_a?"](g("Integer")))?w:this.$raise(g("TypeError"),this.name+": "+w+" ("+w.$class()+") must be an Integer or a Range with Integers ")}),o(r,"$assert_min_sum_is_covered",function(w){var N,k=this,b=D;return N=k.num_of_dice,b=w.$first()["$[]"](0),P(b["$include?"](N))||k.$raise(g("RangeError"),k.name+": min value ("+N+") is not covered: "+b),k}),o(r,"$assert_max_sum_is_covered",function(w){var N,k=this,b=D;return N=h(k.num_of_dice,k.num_of_sides),b=w.$last()["$[]"](0),P(b["$include?"](N))||k.$raise(g("RangeError"),k.name+": max value ("+N+") is not covered: "+b),k}),o(r,"$assert_no_gap_or_overlap_in_ranges",function(w){return L(w,"each_cons",[2],function N(b,y){var q,u,a=null==N.$$s?this:N.$$s,d=D,f=D;return null==a.name&&(a.name=D),null==b&&(b=D),null==y&&(y=D),d=b["$[]"](0),f=y["$[]"](0),q=d.$max(),u=A(q,1),P(f["$include?"](q))&&a.$raise(g("RangeError"),a.name+": Range overlap: "+d+" and "+f),P(f["$include?"](u))?D:a.$raise(g("RangeError"),a.name+": Range gap: "+d+" and "+f)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var D,F,p,g,K,E,w,C,$,W,Y=e.module,G=e.klass,c=e.send,L=e.def,P=e.rb_minus,o=e.return_ivar,H=[],h=e.nil,A=e.$$$;return D=H,F=W=[Y(H[0],"BCDice")].concat(D),p=$=[Y(W[0],"DiceTable")].concat(F),g=C=[G($[0],null,"SaiFicSkillTable")].concat(p),E=[K=G(C[0],null,"Category")].concat(g),w=e.$r(E),L(K,"$initialize",function(N,b,y,a){var d=this;return d.name=N,d.skills=c(b.$map(),"with_index",[2],function(q,u){return null==q&&(q=h),null==u&&(u=h),A(w("SaiFicSkillTable"),"Skill").$new(N,q,y,u,a)}),d.dice=y}),L(K,"$roll",function(N){return this.$skills()["$[]"](P(N.$roll_sum(2,6),2))}),L(K,"$to_s",o("name")),K.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var h,Z,$,C,r,l,j,M,Y=e.module,G=e.klass,c=e.def,L=e.hash2,P=[],o=e.nil;return h=P,Z=M=[Y(P[0],"BCDice")].concat(h),$=j=[Y(M[0],"DiceTable")].concat(Z),l=[G(j[0],null,"SaiFicSkillTable")].concat($),(r=(C=G(l[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=o,c(C,"$initialize",function(g,K,E,w,k){var N=this;return N.category_name=g,N.name=K,N.category_dice=E,N.row_dice=w,N.s_format=k}),c(C,"$to_s",function(){var g=this;return g.$format(g.s_format,L(["category_dice","row_dice","category_name","skill_name"],{category_dice:g.category_dice,row_dice:g.row_dice,category_name:g.category_name,skill_name:g.name}))}),C.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var l,r,w,k,N,b,y,g,_,Y=e.module,G=e.klass,c=e.ensure_kwargs,L=e.hash2,P=e.send,H=e.defs,h=e.const_set,A=e.to_ary,M=e.def,D=e.truthy,Z=e.rb_minus,W=e.rb_plus,j=e.top,F=[],z=e.nil,$=e.$$$;return j.$require("bcdice/dice_table/sai_fic_skill_table/category"),j.$require("bcdice/dice_table/sai_fic_skill_table/skill"),l=F,r=_=[Y(F[0],"BCDice")].concat(l),w=g=[Y(_[0],"DiceTable")].concat(r),N=[k=G(g[0],null,"SaiFicSkillTable")].concat(w),b=e.$r(N),(y=k.$$prototype).rtt=y.rtt_format=y.rct=y.rct_format=y.rttn=y.rttn_format=y.categories=z,H(k,"$from_i18n",function(d,f,q){var u,v,t,s,m=z;return null==(u=(q=c(q)).$$smap.rtt)&&(u=z),null==(v=q.$$smap.rct)&&(v=z),null==(t=q.$$smap.rttn)&&(t=z),s=(m=b("I18n").$t("RTT",L(["locale","raise","default"],{locale:f,raise:!1,default:L([],{})})).$merge(b("I18n").$t(d,L(["locale","raise"],{locale:f,raise:!0}))))["$[]"]("items"),m=P(m,"select",[],function(te,O){return null==te&&(te=z),null==O&&(O=z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](te)}),this.$new(s,e.to_hash(m).$merge(L(["rtt","rct","rttn"],{rtt:u,rct:v,rttn:t})))},-3),h(N[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),h(N[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),h(N[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),h(N[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),M(k,"$initialize",function(d,f){var q,u,v,t,T,i,m,s=this;return null==(q=(f=c(f)).$$smap.rtt)&&(q=z),null==(u=f.$$smap.rct)&&(u=z),null==(v=f.$$smap.rttn)&&(v=z),null==(t=f.$$smap.rtt_format)&&(t=b("DEFAULT_RTT")),null==(T=f.$$smap.rct_format)&&(T=b("DEFAULT_RCT")),null==(i=f.$$smap.rttn_format)&&(i=b("DEFAULT_RTTN")),null==(m=f.$$smap.s_format)&&(m=b("DEFAULT_S")),s.categories=P(d.$map(),"with_index",[1],function(te,O){var ue,ce,se;return null==te&&(te=z),null==O&&(O=z),ce=null==(ue=A(te))[0]?z:ue[0],se=null==ue[1]?z:ue[1],$(b("SaiFicSkillTable"),"Category").$new(ce,se,O,m)},{$$has_top_level_mlhs_arg:!0}),s.rtt=q,s.rct=u,s.rttn=v.$to_a(),s.rtt_format=t,s.rct_format=T,s.rttn_format=i},-2),h(N[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),k.$attr_reader("categories"),M(k,"$roll_command",function(d,f){var u,q=this,v=z,t=z;return D(["RTT",q.rtt]["$include?"](u=f))?q.$format_skill(q.rtt_format,q.$roll_skill(d)):D(["RCT",q.rct]["$include?"](u))?(v=q.$roll_category(d),q.$format(q.rct_format,L(["category_dice","category_name"],{category_dice:v.$dice(),category_name:v.$name()}))):D(t=b("RTTN").$index(u))||D(t=q.rttn.$index(u))?q.$format_skill(q.rttn_format,q.categories["$[]"](t).$roll(d)):z}),M(k,"$roll_category",function(d){return this.categories["$[]"](Z(d.$roll_once(6),1))}),M(k,"$roll_skill",function(d){return this.$roll_category(d).$roll(d)}),M(k,"$prefixes",function(){var d=this;return W(["RTT[1-6]?","RCT",d.rtt,d.rct],d.rttn).$compact()}),k.$private(),M(k,"$format_skill",function(d,f){return this.$format(d,L(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:f.$category_dice(),row_dice:f.$row_dice(),category_name:f.$category_name(),skill_name:f.$name(),text:f.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var D,F,p,_,C,r,n,$,W,Y=e.module,G=e.klass,c=e.hash2,L=e.defs,P=e.truthy,o=e.def,H=e.rb_minus,h=[],A=e.nil;return D=h,F=W=[Y(h[0],"BCDice")].concat(D),p=$=[Y(W[0],"DiceTable")].concat(F),C=[_=G($[0],null,"Table")].concat(p),r=e.$r(C),(n=_.$$prototype).times=n.sides=n.name=n.items=A,L(_,"$from_i18n",function(K,E){var k=A;return k=r("I18n").$t(K,c(["locale"],{locale:E})),this.$new(k["$[]"]("name"),k["$[]"]("type"),k["$[]"]("items"))}),o(_,"$initialize",function(K,E,w){var k=this,N=A;return k.name=K,k.items=w.$freeze(),N=/(\d+)D(\d+)/i.$match(E),P(N)||k.$raise(r("ArgumentError"),"Unexpected table type: "+E),k.times=N["$[]"](1).$to_i(),k.sides=N["$[]"](2).$to_i()}),o(_,"$roll",function(K){var w,E=this;return w=K.$roll_sum(E.times,E.sides),E.$choice(w)}),o(_,"$choice",function(K){var w,E=this;return w=H(K,E.times),r("RollResult").$new(E.name,K,E.items["$[]"](w))})},Opal.modules["bcdice/dice_table"]=function(e){var Y=e.top;return Y.$require("bcdice/dice_table/roll_result"),Y.$require("bcdice/dice_table/chain_table"),Y.$require("bcdice/dice_table/d66_grid_table"),Y.$require("bcdice/dice_table/d66_half_grid_table"),Y.$require("bcdice/dice_table/d66_one_third_table"),Y.$require("bcdice/dice_table/d66_left_range_table"),Y.$require("bcdice/dice_table/d66_parity_table"),Y.$require("bcdice/dice_table/d66_range_table"),Y.$require("bcdice/dice_table/d66_table"),Y.$require("bcdice/dice_table/range_table"),Y.$require("bcdice/dice_table/sai_fic_skill_table"),Y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var o,M,Z,h,Y=e.module,G=e.const_set,c=[];return o=c,M=h=[Y(c[0],"BCDice")].concat(o),Z=[Y(h[0],"D66SortType")].concat(M),G(Z[0],"NO_SORT","no_sort"),G(Z[0],"ASC","asc"),G(Z[0],"DESC","desc"),function(A,M){var Z=[Y(A,"RoundType")].concat(M);return G(Z[0],"CEIL","ceil"),G(Z[0],"FLOOR","floor"),G(Z[0],"ROUND","round")}(h[0],h)},Opal.modules["bcdice/translate"]=function(e){var M,j,F,z,$,Z,Y=e.module,G=e.ensure_kwargs,c=e.kwrestargs,P=e.hash2,o=e.def,H=[],h=e.nil;return M=H,j=Z=[Y(H[0],"BCDice")].concat(M),z=[F=Y(Z[0],"Translate")].concat(j),$=e.$r(z),o(F,"$translate",function(l,p){var _,C=this;return null==C.locale&&(C.locale=h),p=G(p),_=c(p,{}),$("I18n").$translate(l,P(["locale","raise"],{locale:C.locale,raise:!0}).$merge(e.to_hash(_)))},-2)},Opal.modules["bcdice/result"]=function(e){var F,B,z,M,Z,G=e.klass,c=e.send,L=e.def,P=e.return_val,o=e.return_ivar,H=[],h=e.nil;return M=H,F=Z=[(0,e.module)(H[0],"BCDice")].concat(M),[z=G(Z[0],null,"Result")].concat(F),L(B=e.get_singleton_class(z),"$success",function(_){return c(this.$new(),"tap",[],function(n){var g;return null==n&&(n=h),n["$text="](_),c(n,"success=",g=[!0]),g[g.length-1]})}),L(B,"$failure",function(_){return c(this.$new(),"tap",[],function(n){var g;return null==n&&(n=h),n["$text="](_),c(n,"failure=",g=[!0]),g[g.length-1]})}),L(B,"$critical",function(_){return c(this.$new(),"tap",[],function(n){var g;return null==n&&(n=h),n["$text="](_),n["$critical="](!0),c(n,"success=",g=[!0]),g[g.length-1]})}),L(B,"$fumble",function(_){return c(this.$new(),"tap",[],function(n){var g;return null==n&&(n=h),n["$text="](_),n["$fumble="](!0),c(n,"failure=",g=[!0]),g[g.length-1]})}),L(B,"$nothing",P("nothing")),L(z,"$initialize",function(l){var p=this;return null==l&&(l=h),p.text=l,p.rands=h,p.detailed_rands=h,p.secret=!1,p.success=!1,p.failure=!1,p.critical=!1,p.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),L(z,"$secret?",o("secret")),L(z,"$success?",o("success")),L(z,"$failure?",o("failure")),L(z,"$critical?",o("critical")),L(z,"$fumble?",o("fumble")),L(z,"$condition=",function(l){return this.success=l,this.failure=l["$!"]()})},Opal.modules["racc/parser"]=function(e){var K,w,k,Y=e.module,G=e.klass,c=e.truthy,L=e.const_set,P=e.defs,o=e.gvars,H=e.rb_lt,h=e.def,A=e.to_ary,M=e.send,D=e.neqeq,Z=e.rb_plus,W=e.eqeq,j=e.rb_ge,F=e.rb_gt,z=e.rb_minus,$=e.rb_le,B=e.rb_times,l=e.assign_ivar_val,_=[],C=e.$r(_),r=e.nil,n=e.$$$;return K=_,w=[Y(_[0],"Racc")].concat(K),k=e.$r(w),G(w[0],k("StandardError"),"ParseError"),c(n("::","ParseError","skip_raise")?"constant":r)||L(_[0],"ParseError",n(C("Racc"),"ParseError")),function(g,K){var a,d,f,q,u,k=[Y(g,"Racc")].concat(K),N=e.$r(k);return c(N("Racc_No_Extensions","skip_raise")?"constant":r)||L(k[0],"Racc_No_Extensions",!1),a=k,f=[d=G(k[0],null,"Parser")].concat(a),q=e.$r(f),(u=d.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=r,L(f[0],"Racc_Runtime_Version","1.4.6"),L(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),L(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),L(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),L(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),L(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),L(f[0],"Racc_Runtime_Core_Version",q("Racc_Runtime_Core_Version_R")),L(f[0],"Racc_Runtime_Core_Revision",q("Racc_Runtime_Core_Revision_R")),L(f[0],"Racc_Runtime_Type","ruby"),P(q("Parser"),"$racc_runtime_type",function(){return q("Racc_Runtime_Type")}),h(d,"$_racc_setup",function(){var t,T,i=this,m=r,s=r;return null==o.stderr&&(o.stderr=r),c(n(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),c(null!=(t=i.yydebug)&&t!==r?"instance-variable":r)||(i.yydebug=!1),c(i.yydebug)&&(c(null!=(T=i.racc_debug_out)&&T!==r?"instance-variable":r)||(i.racc_debug_out=o.stderr),i.racc_debug_out=c(m=i.racc_debug_out)?m:o.stderr),s=n(i.$class(),"Racc_arg"),c(H(s.$size(),14))&&s["$[]="](13,!0),s}),h(d,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),h(d,"$do_parse",function(){return this.$__send__(q("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),h(d,"$next_token",function(){return this.$raise(q("NotImplementedError"),this.$class()+"#next_token is not defined")}),h(d,"$_racc_do_parse_rb",function(t,T){var i,s=this,X=r,te=r,O=r,ue=r,ce=r,se=r,_e=r,ae=r;return i=A(t),X=null==i[0]?r:i[0],te=null==i[1]?r:i[1],O=null==i[2]?r:i[2],ue=null==i[3]?r:i[3],ce=null==i[10]?r:i[10],s.$_racc_init_sysvars(),se=_e=ae=r,M(s,"catch",["racc_end_parse"],function ee(){var I,V,x=null==ee.$$s?this:ee.$$s,S=r;for(null==x.racc_state&&(x.racc_state=r),null==x.racc_read_next&&(x.racc_read_next=r),null==x.racc_t&&(x.racc_t=r),null==x.yydebug&&(x.yydebug=r),null==x.racc_val&&(x.racc_val=r);c(!0);)for(c(ae=ue["$[]"](x.racc_state["$[]"](-1)))?(c(x.racc_read_next)&&D(x.racc_t,0)&&(V=x.$next_token(),I=A(V),se=null==I[0]?r:I[0],x.racc_val=null==I[1]?r:I[1],x.racc_t=c(se)?c(S=ce["$[]"](se))?S:1:0,c(x.yydebug)&&x.$racc_read_token(x.racc_t,se,x.racc_val),x.racc_read_next=!1),ae=Z(ae,x.racc_t),c(j(ae,0))&&c(_e=X["$[]"](ae))&&W(te["$[]"](ae),x.racc_state["$[]"](-1))||(_e=O["$[]"](x.racc_state["$[]"](-1)))):_e=O["$[]"](x.racc_state["$[]"](-1));c(_e=x.$_racc_evalact(_e,t)););},{$$s:s})}),h(d,"$yyparse",function(t,T){return this.$__send__(q("Racc_YY_Parse_Method"),t,T,this.$_racc_setup(),!0)}),h(d,"$_racc_yyparse_rb",function(t,T,i,m){var s,O=r,ue=r,$e=r,ce=r,_e=r,ae=r,ee=r;return s=A(i),O=null==s[0]?r:s[0],ue=null==s[1]?r:s[1],$e=null==s[2]?r:s[2],ce=null==s[3]?r:s[3],_e=null==s[10]?r:s[10],this.$_racc_init_sysvars(),ae=r,ee=r,M(this,"catch",["racc_end_parse"],function I(){var V=null==I.$$s?this:I.$$s;for(null==V.racc_state&&(V.racc_state=r);!c(ee=ce["$[]"](V.racc_state["$[]"](-1)));)for(;c(ae=V.$_racc_evalact($e["$[]"](V.racc_state["$[]"](-1)),i)););return M(t,"__send__",[T],function x(S,re){var R=null==x.$$s?this:x.$$s,U=r,J=r;for(null==R.racc_t&&(R.racc_t=r),null==R.racc_state&&(R.racc_state=r),null==R.racc_read_next&&(R.racc_read_next=r),null==S&&(S=r),null==re&&(re=r),R.racc_t=c(S)?c(U=_e["$[]"](S))?U:1:0,R.racc_val=re,R.racc_read_next=!1,ee=Z(ee,R.racc_t),c(j(ee,0))&&c(ae=O["$[]"](ee))&&W(ue["$[]"](ee),R.racc_state["$[]"](-1))||(ae=$e["$[]"](R.racc_state["$[]"](-1)));c(ae=R.$_racc_evalact(ae,i)););for(;c(c(U=c(J=(ee=ce["$[]"](R.racc_state["$[]"](-1)))["$!"]())?J:R.racc_read_next["$!"]())?U:R.racc_t["$=="](0));)for(c(ee)&&c(ee=Z(ee,R.racc_t))&&c(j(ee,0))&&c(ae=O["$[]"](ee))&&W(ue["$[]"](ee),R.racc_state["$[]"](-1))||(ae=$e["$[]"](R.racc_state["$[]"](-1)));c(ae=R.$_racc_evalact(ae,i)););},{$$s:V})},{$$s:this})}),h(d,"$_racc_evalact",function(t,T){var i,$e,s=this,X=r,te=r,ue=r,ce=r,se=r,_e=r;if(X=null==(i=A(T))[0]?r:i[0],te=null==i[1]?r:i[1],ue=null==i[3]?r:i[3],$e=null==i[11]?r:i[11],ce=null==i[12]?r:i[12],c(F(t,0))&&c(H(t,$e)))c(F(s.racc_error_status,0))&&(W(s.racc_t,1)||(s.racc_error_status=z(s.racc_error_status,1))),s.racc_vstack.$push(s.racc_val),s.racc_state.$push(t),s.racc_read_next=!0,c(s.yydebug)&&(s.racc_tstack.$push(s.racc_t),s.$racc_shift(s.racc_t,s.racc_tstack,s.racc_vstack));else if(c(H(t,0))&&c(F(t,ce["$-@"]()))){if(se=M(s,"catch",["racc_jump"],function ae(){var ee=null==ae.$$s?this:ae.$$s;return null==ee.racc_state&&(ee.racc_state=r),ee.racc_state.$push(ee.$_racc_do_reduce(T,t)),!1},{$$s:s}),c(se))switch(se){case 1:return s.racc_user_yyerror=!0,ce["$-@"]();case 2:return $e;default:s.$raise("[Racc Bug] unknown jump code")}}else if(W(t,$e))c(s.yydebug)&&s.$racc_accept(),s.$throw("racc_end_parse",s.racc_vstack["$[]"](0));else{if(W(t,ce["$-@"]())){switch(s.racc_error_status){case 0:c(T["$[]"](21))||s.$on_error(s.racc_t,s.racc_val,s.racc_vstack);break;case 3:W(s.racc_t,0)&&s.$throw("racc_end_parse",r),s.racc_read_next=!0}for(s.racc_user_yyerror=!1,s.racc_error_status=3;c(!0)&&!(c(_e=ue["$[]"](s.racc_state["$[]"](-1)))&&(_e=Z(_e,1),c(j(_e,0))&&c(t=X["$[]"](_e))&&W(te["$[]"](_e),s.racc_state["$[]"](-1))));)c($(s.racc_state.$size(),1))&&s.$throw("racc_end_parse",r),s.racc_state.$pop(),s.racc_vstack.$pop(),c(s.yydebug)&&(s.racc_tstack.$pop(),s.$racc_e_pop(s.racc_state,s.racc_tstack,s.racc_vstack));return t}s.$raise("[Racc Bug] unknown action "+t.$inspect())}return c(s.yydebug)&&s.$racc_next_state(s.racc_state["$[]"](-1),s.racc_state),r}),h(d,"$_racc_do_reduce",function(t,T){var i,ce,_e,S,re,R,Q,s=this,te=r,O=r,ue=r,$e=r,se=r,ae=r,ee=r,I=r,V=r,x=r,U=r,J=r,ne=r;return te=null==(i=A(t))[4]?r:i[4],O=null==i[5]?r:i[5],ue=null==i[6]?r:i[6],$e=null==i[7]?r:i[7],ce=null==i[8]?r:i[8],se=null==i[9]?r:i[9],_e=null==i[13]?r:i[13],ae=s.racc_state,ee=s.racc_vstack,I=s.racc_tstack,V=B(T,-3),x=se["$[]"](V),S=se["$[]"](Z(V,1)),re=se["$[]"](Z(V,2)),R=[],c(s.yydebug)&&(U=I["$[]"](x["$-@"](),x)),J=ee["$[]"](x["$-@"](),x),c(s.yydebug)&&I["$[]="](x["$-@"](),x,R),ee["$[]="](x["$-@"](),x,R),ae["$[]="](x["$-@"](),x,R),c(_e)?ee.$push(s.$__send__(re,J,ee,J["$[]"](0))):ee.$push(s.$__send__(re,J,ee)),I.$push(S),c(s.yydebug)&&s.$racc_reduce(U,S,I,ee),Q=z(S,ce),c(V=$e["$[]"](Q))&&(V=Z(V,ae["$[]"](-1)),c(j(V,0))&&c(ne=te["$[]"](V))&&W(O["$[]"](V),Q))?ne:ue["$[]"](Q)}),h(d,"$on_error",function(t,T,i){var s,m=this;return m.$raise(q("ParseError"),m.$sprintf("\nparse error on value %s (%s)",T.$inspect(),c(s=m.$token_to_str(t))?s:"?"))}),h(d,"$yyerror",function(){return this.$throw("racc_jump",1)}),h(d,"$yyaccept",function(){return this.$throw("racc_jump",2)}),h(d,"$yyerrok",l("racc_error_status",0)),h(d,"$racc_read_token",function(t,T,i){var m=this;return m.racc_debug_out.$print("read    "),m.racc_debug_out.$print(T.$inspect(),"(",m.$racc_token2str(t),") "),m.racc_debug_out.$puts(i.$inspect()),m.racc_debug_out.$puts()}),h(d,"$racc_shift",function(t,T,i){var m=this;return m.racc_debug_out.$puts("shift   "+m.$racc_token2str(t)),m.$racc_print_stacks(T,i),m.racc_debug_out.$puts()}),h(d,"$racc_reduce",function(t,T,i,m){var s=this,X=r;return(X=s.racc_debug_out).$print("reduce "),c(t["$empty?"]())?X.$print(" <none>"):M(t,"each",[],function te(O){return null==O&&(O=r),X.$print(" ",(null==te.$$s?this:te.$$s).$racc_token2str(O))},{$$s:s}),X.$puts(" --\x3e "+s.$racc_token2str(T)),s.$racc_print_stacks(i,m),s.racc_debug_out.$puts()}),h(d,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),h(d,"$racc_e_pop",function(t,T,i){var m=this;return m.racc_debug_out.$puts("error recovering mode: pop token"),m.$racc_print_states(t),m.$racc_print_stacks(T,i),m.racc_debug_out.$puts()}),h(d,"$racc_next_state",function(t,T){var i=this;return i.racc_debug_out.$puts("goto    "+t),i.$racc_print_states(T),i.racc_debug_out.$puts()}),h(d,"$racc_print_stacks",function(t,T){var m=r;return(m=this.racc_debug_out).$print("        ["),M(t,"each_index",[],function s(X){return null==X&&(X=r),m.$print(" (",(null==s.$$s?this:s.$$s).$racc_token2str(t["$[]"](X))," ",T["$[]"](X).$inspect(),")")},{$$s:this}),m.$puts(" ]")}),h(d,"$racc_print_states",function(t){var i=r;return(i=this.racc_debug_out).$print("        ["),M(t,"each",[],function(s){return null==s&&(s=r),i.$print(" ",s)}),i.$puts(" ]")}),h(d,"$racc_token2str",function(t){var i;return c(i=n(this.$class(),"Racc_token_to_s_table")["$[]"](t))?i:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),h(d,"$token_to_str",function(t){return n(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(_[0],_)},Opal.modules["bcdice/arithmetic/node"]=function(e){var l,r,E,a,d,k,N,g,_,Y=e.module,G=e.klass,c=e.def,L=e.thrower,P=e.return_ivar,o=e.send2,H=e.find_super,h=e.eqeq,A=e.const_set,M=e.eqeqeq,D=e.rb_divide,Z=e.truthy,W=e.assign_ivar,j=e.alias,F=[],z=e.nil,$=e.$$$;return l=F,r=_=[Y(F[0],"BCDice")].concat(l),E=g=[Y(_[0],"Arithmetic")].concat(r),k=[Y(g[0],"Node")].concat(E),N=e.$r(k),(d=(a=G(k[0],null,"BinaryOp")).$$prototype).lhs=d.rhs=d.op=z,c(a,"$initialize",function(q,u,v){var t=this;return t.lhs=q,t.op=u,t.rhs=v}),c(a,"$eval",function(q){try{L("eval_return");var T,v=this,t=z;return t=v.lhs.$eval(q),T=v.rhs.$eval(q),t.$send(v.op,T)}catch(i){if(i===e.t_eval_return)return i.$v;throw i}}),c(a,"$output",function(){var q=this;return""+q.lhs.$output()+q.op+q.rhs.$output()}),c(a,"$s_exp",function(){var q=this;return"("+q.$op_for_s_exp()+" "+q.lhs.$s_exp()+" "+q.rhs.$s_exp()+")"}),c(a,"$op_for_s_exp",P("op")),function(b,y,a){var d=G(b,y,"DivideBase"),f=[d].concat(a),q=e.$r(f),u=d.$$prototype;u.lhs=u.rhs=u.op=z,c(d,"$initialize",function v(t,T){return v.$$p=null,o(this,H(this,"initialize",v,!1,!0),"initialize",[t,"/",T],null)}),c(d,"$eval",function(t){try{L("eval_return");var m,s,i=this;return m=i.lhs.$eval(t),s=i.rhs.$eval(t),h(s,0)&&i.$raise(q("ZeroDivisionError")),i.$divide_and_round(m,s,t)}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),c(d,"$output",function v(){var t=v.$$p||z,T=this;return v.$$p=null,""+o(T,H(T,"output",v,!1,!0),"output",[],t)+T.$rounding_method()}),d.$private(),c(d,"$rounding_method",function(){return $(this.$class(),"ROUNDING_METHOD")}),c(d,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(d,"$divide_and_round",function(t,T,i){return this.$raise(q("NotImplementedError"))})}(k[0],N("BinaryOp"),k),function(b,y,a){var d=G(b,y,"DivideWithGameSystemDefault"),f=[d].concat(a),q=e.$r(f);A(f[0],"ROUNDING_METHOD",""),d.$private(),c(d,"$divide_and_round",function(v,t,T){var i,m=z;return M($(q("RoundType"),"CEIL"),i=T)?D(v.$to_f(),t).$ceil():M($(q("RoundType"),"ROUND"),i)?(m=D(v.$to_f(),t),Z(m["$negative?"]())?m.$abs().$round()["$-@"]():m.$round()):D(v,t).$floor()})}(k[0],N("DivideBase"),k),function(b,y,a){var d=G(b,y,"DivideWithCeil"),f=[d].concat(a);A(f[0],"ROUNDING_METHOD","C"),d.$private(),c(d,"$divide_and_round",function(u,v,t){return D(u.$to_f(),v).$ceil()})}(k[0],N("DivideBase"),k),function(b,y,a){var d=G(b,y,"DivideWithRound"),f=[d].concat(a);A(f[0],"ROUNDING_METHOD","R"),d.$private(),c(d,"$divide_and_round",function(u,v,t){var T=z;return T=D(u.$to_f(),v),Z(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()})}(k[0],N("DivideBase"),k),function(b,y,a){var d=G(b,y,"DivideWithFloor"),f=[d].concat(a);A(f[0],"ROUNDING_METHOD","F"),d.$private(),c(d,"$divide_and_round",function(u,v,t){return D(u,v).$floor()})}(k[0],N("DivideBase"),k),function(b,y){var a=G(b,null,"Negative");a.$$prototype.body=z,c(a,"$initialize",W("body")),c(a,"$eval",function(q){try{return L("eval_return"),this.body.$eval(q)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(a,"$output",function(){return"-"+this.body.$output()}),c(a,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(k[0]),function(b,y){var a=G(b,null,"Parenthesis");a.$$prototype.expr=z,c(a,"$initialize",W("expr")),c(a,"$eval",function(q){try{return L("eval_return"),this.expr.$eval(q)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(a,"$output",function(){return"("+this.expr.$output()+")"}),c(a,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(k[0]),function(b,y){var a=G(b,null,"Number");return a.$$prototype.value=z,c(a,"$initialize",W("value")),c(a,"$eval",P("value")),c(a,"$output",function(){return this.value.$to_s()}),j(a,"s_exp","output")}(k[0])},Opal.modules.strscan=function(e){var W,j,F,z,$,G=e.def,c=e.truthy,L=e.eqeqeq,P=e.Opal,o=e.return_ivar,H=e.send,h=e.alias,A=[],M=e.nil;return W=A,F=[j=(0,e.klass)(A[0],null,"StringScanner")].concat(W),z=e.$r(F),($=j.$$prototype).pos=$.string=$.working=$.matched=$.prev_pos=$.match=M,j.$attr_reader("pos","matched"),G(j,"$initialize",function(l){var p=this;return p.string=l,p.pos=0,p.matched=M,p.working=l,p.match=[]}),j.$attr_reader("string"),G(j,"$beginning_of_line?",function(){var l=this;return 0===l.pos||"\n"===l.string.charAt(l.pos-1)}),G(j,"$scan",function(l){var p=this,_=(l=p.$anchor(l)).exec(p.working);return null==_?p.matched=M:(p.prev_pos=p.pos,p.pos+=_[0].length,p.working=p.working.substring(_[0].length),p.matched=_[0],p.match=_,_[0])}),G(j,"$scan_until",function(l){var p=this;l=p.$anchor(l);for(var _=p.working,C=0;_.length!=C;++C){var r=l.exec(_.substr(C));if(null!==r){var n=C+r[0].length,g=_.substr(0,n);return p.matched=r[0],p.match=r,p.prev_pos=p.pos+C,p.pos+=n,p.working=_.substr(n),g}}return p.matched=M}),G(j,"$[]",function(l){var _;if(c(this.match["$empty?"]()))return M;L(z("Symbol"),_=l)?l=l.$to_s():L(z("String"),_)||(l=P["$coerce_to!"](l,z("Integer"),"to_int"));var C=this.match;return l<0&&(l+=C.length),l<0||l>=C.length||null==C[l]?M:C[l]}),G(j,"$check",function(l){var p=this,_=(l=p.$anchor(l)).exec(p.working);return p.matched=null==_?M:_[0]}),G(j,"$check_until",function(l){var p=this,_=p.prev_pos,C=p.pos,r=p.working,n=p.$scan_until(l);return p.prev_pos=_,p.pos=C,p.working=r,n}),G(j,"$peek",function(l){return this.working.substring(0,l)}),G(j,"$eos?",function(){return 0===this.working.length}),G(j,"$exist?",function(l){var _=l.exec(this.working);return null==_?M:0==_.index?0:_.index+1}),G(j,"$skip",function(l){var p=this,_=(l=p.$anchor(l)).exec(p.working);if(null==_)return p.match=[],p.matched=M;var C=_[0],r=C.length;return p.matched=C,p.match=_,p.prev_pos=p.pos,p.pos+=r,p.working=p.working.substring(r),r}),G(j,"$skip_until",function(l){var _=this.$scan_until(l);return _===M?M:(this.matched=_.substr(-1),_.length)}),G(j,"$get_byte",function(){var l=this,p=M;return l.pos<l.string.length?(l.prev_pos=l.pos,l.pos+=1,p=l.matched=l.working.substring(0,1),l.working=l.working.substring(1)):l.matched=M,p}),G(j,"$match?",function(l){var p=this,_=(l=p.$anchor(l)).exec(p.working);return null==_?M:(p.prev_pos=p.pos,_[0].length)}),G(j,"$pos=",function(l){var p=this;return l<0&&(l+=p.string.$length()),p.pos=l,p.working=p.string.slice(l)}),G(j,"$matched_size",function(){return this.matched===M?M:this.matched.length}),G(j,"$post_match",function(){var l=this;return l.matched===M?M:l.string.substr(l.pos)}),G(j,"$pre_match",function(){var l=this;return l.matched===M?M:l.string.substr(0,l.prev_pos)}),G(j,"$reset",function(){var l=this;return l.working=l.string,l.matched=M,l.pos=0}),G(j,"$rest",o("working")),G(j,"$rest?",function(){return 0!==this.working.length}),G(j,"$rest_size",function(){return this.$rest().$size()}),G(j,"$terminate",function(){var l,p=this;return p.match=M,l=[p.string.$length()],H(p,"pos=",l),l[l.length-1]}),G(j,"$unscan",function(){var l=this;return l.pos=l.prev_pos,l.prev_pos=M,l.match=M,l}),h(j,"bol?","beginning_of_line?"),h(j,"getch","get_byte"),j.$private(),G(j,"$anchor",function(l){var p=l.toString().match(/\/([^\/]+)$/);return p=p?p[1]:void 0,new RegExp("^(?:"+l.source+")",p)})},Opal.modules["bcdice/normalize"]=function(e){var h,Z,M,Y=e.module,G=e.eqeqeq,c=e.def,L=e.eqeq,P=[],o=e.nil;return h=P,M=[Y(P[0],"BCDice")].concat(h),(Z=Y(M[0],"Normalize")).$module_function(),c(Z,"$comparison_operator",function(j){var F;return G(/<=|=</,F=j)?"<=":G(/>=|=>/,F)?">=":G(/<>|!=|=!/,F)?"!=":G(/</,F)?"<":G(/>/,F)?">":G(/=/,F)?"==":o}),c(Z,"$target_number",function(j){return L(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var W,$,C,r,n,g,K,l,F,Y=e.module,G=e.klass,c=e.const_set,L=e.hash2,P=e.truthy,o=e.send,H=e.def,h=e.thrower,A=e.top,M=[],D=e.nil;return A.$require("strscan"),A.$require("bcdice/normalize"),W=M,$=F=[Y(M[0],"BCDice")].concat(W),C=l=[Y(F[0],"Command")].concat($),n=[r=G(l[0],null,"Lexer")].concat(C),g=e.$r(n),(K=r.$$prototype).scanner=K.notations=D,c(n[0],"SYMBOLS",L(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),H(r,"$initialize",function(w,k){var N,b,a;return w=P(a=(N=(b=w)===D||null==b?D:b.$split(" ",2))===D||null==N?D:N.$first())?a:"",this.scanner=g("StringScanner").$new(w),this.notations=o(k,"map",[],function(f){return null==f&&(f=D),P(f["$is_a?"](g("String")))?g("Regexp").$new(f):f})}),H(r,"$next_token",function(){try{var w=h("return"),k=this,N=D,b=D,a=D,d=D;return P(k.scanner["$eos?"]())?[!1,"$"]:(o(k.notations,"each",[],function f(q){var v,u=null==f.$$s?this:f.$$s;if(null==u.scanner&&(u.scanner=D),null==q&&(q=D),v=u.scanner.$scan(q),!P(v))return D;w.$throw(["NOTATION",v])},{$$s:k,$$ret:w}),P(N=k.scanner.$scan(/\d+/))?["NUMBER",N.$to_i()]:P(b=k.scanner.$scan(/[<>!=]+/))?(b=g("Normalize").$comparison_operator(b),[P(b)?"CMP_OP":"ILLEGAL",b]):(a=k.scanner.$getch().$upcase(),[P(d=g("SYMBOLS")["$[]"](a))?d:a.$to_sym(),a]))}catch(f){if(f===w)return f.$v;throw f}}),H(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var A,W,B,l,p,_,C,F,D,Y=e.module,G=e.klass,c=e.def,L=e.return_ivar,P=e.truthy,o=[],H=e.nil;return A=o,W=D=[Y(o[0],"BCDice")].concat(A),B=F=[Y(D[0],"Command")].concat(W),p=[l=G(F[0],null,"Parsed")].concat(B),_=e.$r(p),(C=l.$$prototype).critical=C.fumble=C.dollar=C.modify_number=C.question_target=C.target_number=C.prefix_number=C.command=C.suffix_number=C.cmp_op=H,l.$attr_accessor("command"),l.$attr_accessor("prefix_number"),l.$attr_accessor("suffix_number"),l.$attr_accessor("critical"),l.$attr_accessor("fumble"),l.$attr_accessor("dollar"),l.$attr_accessor("modify_number"),l.$attr_accessor("cmp_op"),l.$attr_accessor("target_number"),l.$attr_writer("question_target"),c(l,"$initialize",function(){var n=this;return n.prefix_number=H,n.suffix_number=H,n.critical=H,n.fumble=H,n.dollar=H,n.cmp_op=H,n.target_number=H,n.question_target=!1}),c(l,"$question_target?",L("question_target")),c(l,"$to_s",function(n){var g=this,K=H,E=H,w=H,k=H,N=H;switch(null==n&&(n="after_command"),K=P(g.critical)?"@"+g.critical:H,E=P(g.fumble)?"#"+g.fumble:H,w=P(g.dollar)?"$"+g.dollar:H,k=_("Format").$modifier(g.modify_number),N=P(g.question_target)?"?":g.target_number,n){case"after_command":return[g.prefix_number,g.command,g.suffix_number,K,E,w,k,g.cmp_op,N].$join();case"after_modify_number":return[g.prefix_number,g.command,g.suffix_number,k,K,E,w,g.cmp_op,N].$join();case"after_target_number":return[g.prefix_number,g.command,g.suffix_number,k,g.cmp_op,N,K,E,w].$join();default:return H}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var n,w,d,v,t,T,i,m,s,X,te,O,ce,f,q,u,ae,N,b,K,Y=e.klass,G=e.module,c=e.slice,L=e.extract_kwargs,P=e.ensure_kwargs,o=e.get_kwarg,H=e.send2,h=e.find_super,A=e.def,M=e.send,D=e.eqeq,Z=e.thrower,W=e.hash,j=e.const_set,F=e.truthy,z=e.to_ary,$=e.hash2,B=e.top,l=[],p=e.$r(l),_=e.nil,C=e.$$$;return B.$require("racc/parser.rb"),B.$require("bcdice/arithmetic/node"),B.$require("bcdice/command/lexer"),B.$require("bcdice/command/parsed"),Y(C(p("BCDice"),"Command"),C(p("Racc"),"Parser"),"Parser"),n=l,w=K=[G(l[0],"BCDice")].concat(n),N=[G(K[0],"Command")].concat(w),b=e.$r(N),d=N,q=[f=Y(N[0],C(b("Racc"),"Parser"),"Parser")].concat(d),u=e.$r(q),(ae=f.$$prototype).notations=ae.lexer=ae.modifier=ae.suffix_number=ae.prefix_number=ae.need_suffix_number=ae.need_prefix_number=ae.critical=ae.fumble=ae.dollar=ae.allowed_cmp_op=ae.question_target=_,A(f,"$initialize",function ee(I,V){var x,S,re,R,J=this;return ee.$$p=null,x=c(arguments),S=L(x),S=P(S),re=x,R=o(S,"round_type"),H(J,h(J,"initialize",ee,!1,!0),"initialize",[],null),J.notations=re,J.round_type=R,J.prefix_number=!1,J.suffix_number=!1,J.need_prefix_number=!1,J.need_suffix_number=!1,J.modifier=!0,J.critical=!1,J.fumble=!1,J.dollar=!1,J.allowed_cmp_op=[_,">=",">","<=","<","==","!="],J.question_target=!1},-2),A(f,"$disable_modifier",function(){return this.modifier=!1,this}),A(f,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),A(f,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),A(f,"$has_prefix_number",function(){var I=this;return I.prefix_number=!0,I.need_prefix_number=!0,I}),A(f,"$has_suffix_number",function(){var I=this;return I.suffix_number=!0,I.need_suffix_number=!0,I}),A(f,"$enable_critical",function(){return this.critical=!0,this}),A(f,"$enable_fumble",function(){return this.fumble=!0,this}),A(f,"$enable_dollar",function(){return this.dollar=!0,this}),A(f,"$restrict_cmp_op_to",function(I){var V,S=this;return V=c(arguments),S.allowed_cmp_op=V,S},-1),A(f,"$enable_question_target",function(){return this.question_target=!0,this}),A(f,"$parse",function(I){var V=this;try{return V.lexer=u("Lexer").$new(I,V.notations),V.$do_parse()}catch(x){if(!e.rescue(x,[u("ParseError"),u("ZeroDivisionError")]))throw x;try{return _}finally{e.pop_exception()}}}),f.$private(),A(f,"$parsed",function(I,V,x,S){try{return Z("eval_return"),M(u("Parsed").$new(),"tap",[],function U(J){var Q,ne,ie,le,fe,oe,de,me=null==U.$$s?this:U.$$s;return null==me.round_type&&(me.round_type=_),null==J&&(J=_),J["$command="](I["$[]"]("command")),J["$prefix_number="]((Q=I["$[]"]("prefix"))===_||null==Q?_:Q.$eval(me.round_type)),J["$suffix_number="]((ne=I["$[]"]("suffix"))===_||null==ne?_:ne.$eval(me.round_type)),J["$critical="]((ie=V["$[]"]("critical"))===_||null==ie?_:ie.$eval(me.round_type)),J["$fumble="]((le=V["$[]"]("fumble"))===_||null==le?_:le.$eval(me.round_type)),J["$dollar="]((fe=V["$[]"]("dollar"))===_||null==fe?_:fe.$eval(me.round_type)),J["$modify_number="](x.$eval(me.round_type)),J["$cmp_op="](S["$[]"]("cmp_op")),D(S["$[]"]("target"),"?")?(J["$question_target="](!0),M(J,"target_number=",oe=[0]),oe[oe.length-1]):(J["$question_target="](!1),oe=[(de=S["$[]"]("target"),de===_||null==de?_:de.$eval(me.round_type))],M(J,"target_number=",oe),oe[oe.length-1])},{$$s:this})}catch(U){if(U===e.t_eval_return)return U.$v;throw U}}),A(f,"$next_token",function(){return this.lexer.$next_token()}),v=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),t=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),T=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),i=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),m=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),s=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),X=[_,6,13,3,9,-1,27,-15,-10,-1,-38],te=[_,_,_,_,_,_,19,16,15,_,_],O=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ce=W(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),j(q[0],"Racc_arg",[v,t,i,T,m,s,te,X,19,O,ce,58,35,!0]),j(q[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),j(q[0],"Racc_debug_parser",!1),A(f,"$_reduce_1",function(I,V,x){var S,R=this;return F(R.modifier)||R.$raise(u("ParseError")),S=z(I),R.$parsed(null==S[0]?_:S[0],null==S[1]?_:S[1],null==S[2]?_:S[2],null==S[3]?_:S[3])}),A(f,"$_reduce_2",function(I,V,x){var S,R=this;return F(R.modifier)||R.$raise(u("ParseError")),S=z(I),R.$parsed(null==S[0]?_:S[0],null==S[2]?_:S[2],null==S[1]?_:S[1],null==S[3]?_:S[3])}),A(f,"$_reduce_3",function(I,V,x){var S,Q;return Q=null==(S=z(I))[2]?_:S[2],this.$parsed(null==S[0]?_:S[0],null==S[1]?_:S[1],C(C(u("Arithmetic"),"Node"),"Number").$new(0),Q)}),A(f,"$_reduce_4",function(I,V,x){var S=this;return F(S.prefix_number)&&F(S.suffix_number)||S.$raise(u("ParseError")),$(["command","prefix","suffix"],{command:I["$[]"](1),prefix:I["$[]"](0),suffix:I["$[]"](2)})}),A(f,"$_reduce_5",function(I,V,x){var S=this;return F(S.prefix_number)||S.$raise(u("ParseError")),F(S.need_suffix_number)&&S.$raise(u("ParseError")),$(["command","prefix"],{command:I["$[]"](1),prefix:I["$[]"](0)})}),A(f,"$_reduce_6",function(I,V,x){var S=this;return F(S.suffix_number)||S.$raise(u("ParseError")),F(S.need_prefix_number)&&S.$raise(u("ParseError")),$(["command","suffix"],{command:I["$[]"](0),suffix:I["$[]"](1)})}),A(f,"$_reduce_7",function(I,V,x){var S=this;return(F(S.need_prefix_number)||F(S.need_suffix_number))&&S.$raise(u("ParseError")),$(["command"],{command:I["$[]"](0)})}),A(f,"$_reduce_8",function(I,V,x){return $([],{})}),A(f,"$_reduce_9",function(I,V,x){var S,Q,U=_;return U=null==(S=z(I))[0]?_:S[0],Q=null==S[2]?_:S[2],F(this.critical)&&F(U["$[]"]("critical")["$nil?"]())||this.$raise(u("ParseError")),U["$[]="]("critical",Q),U}),A(f,"$_reduce_10",function(I,V,x){var S,Q,U=_;return U=null==(S=z(I))[0]?_:S[0],Q=null==S[2]?_:S[2],F(this.fumble)&&F(U["$[]"]("fumble")["$nil?"]())||this.$raise(u("ParseError")),U["$[]="]("fumble",Q),U}),A(f,"$_reduce_11",function(I,V,x){var S,Q,U=_;return U=null==(S=z(I))[0]?_:S[0],Q=null==S[2]?_:S[2],F(this.dollar)&&F(U["$[]"]("dollar")["$nil?"]())||this.$raise(u("ParseError")),U["$[]="]("dollar",Q),U}),A(f,"$_reduce_12",function(I,V,x){return I["$[]"](1)}),A(f,"$_reduce_13",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"Negative").$new(I["$[]"](1))}),A(f,"$_reduce_14",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"+",I["$[]"](2))}),A(f,"$_reduce_15",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"-",I["$[]"](2))}),A(f,"$_reduce_16",function(I,V,x){return F(this.allowed_cmp_op["$include?"](_))||this.$raise(u("ParseError")),$([],{})}),A(f,"$_reduce_17",function(I,V,x){var S,U,J;return J=null==(S=z(I))[1]?_:S[1],F(this.allowed_cmp_op["$include?"](U=null==S[0]?_:S[0]))||this.$raise(u("ParseError")),$(["cmp_op","target"],{cmp_op:U,target:J})}),A(f,"$_reduce_18",function(I,V,x){var re,S=this;return re=I["$[]"](0),F(S.question_target)||S.$raise(u("ParseError")),F(S.allowed_cmp_op["$include?"](re))||S.$raise(u("ParseError")),$(["cmp_op","target"],{cmp_op:re,target:"?"})}),A(f,"$_reduce_19",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"+",I["$[]"](2))}),A(f,"$_reduce_20",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"-",I["$[]"](2))}),A(f,"$_reduce_22",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"*",I["$[]"](2))}),A(f,"$_reduce_23",function(I,V,x){return I["$[]"](3).$new(I["$[]"](0),I["$[]"](2))}),A(f,"$_reduce_25",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),A(f,"$_reduce_26",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(f,"$_reduce_27",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(f,"$_reduce_28",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"DivideWithRound")}),A(f,"$_reduce_29",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"DivideWithFloor")}),A(f,"$_reduce_30",function(I,V,x){return I["$[]"](1)}),A(f,"$_reduce_31",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"Negative").$new(I["$[]"](1))}),A(f,"$_reduce_33",function(I,V,x){return I["$[]"](1)}),A(f,"$_reduce_34",function(I,V,x){return C(C(u("Arithmetic"),"Node"),"Number").$new(I["$[]"](0))}),A(f,"$_reduce_none",function(I,V,x){return I["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var M,j,B,l,p,_,z,Z,Y=e.module,G=e.send,c=e.eqeqeq,L=e.truthy,P=e.def,o=e.return_val,H=[],h=e.nil;return M=H,j=Z=[Y(H[0],"BCDice")].concat(M),B=z=[Y(Z[0],"Deprecated")].concat(j),p=[l=Y(z[0],"Checker")].concat(B),_=e.$r(p),l.$private(),P(l,"$check_result_legacy",function(r,n,g,K){var N,E=this,w=h,k=h,b=h,y=h;return w=G(n,"map",[],"sides".$to_proc()),N=(k=G(n,"map",[],"value".$to_proc())).$sum(),b=c([100],y=w)?E.$check_1D100(r,N,g,K):c([20],y)?E.$check_1D20(r,N,g,K):c([6,6],y)?E.$check_2D6(r,N,k,g,K):h,(L(b["$nil?"]())||L(b["$empty?"]()))&&(b=c([10],y=w.$uniq())?E.$check_nD10(r,N,k,g,K):c([6],y)?E.$check_nD6(r,N,k,g,K):h,L(b["$nil?"]())||L(b["$empty?"]()))?h:_("Result").$new(b.$delete_prefix(" \uff1e "))}),P(l,"$check_1D100",o(h)),P(l,"$check_1D20",o(h)),P(l,"$check_nD10",o(h)),P(l,"$check_2D6",o(h)),P(l,"$check_nD6",o(h))},Opal.modules["bcdice/base"]=function(e){var p,E,y,u,t,T,a,d,f,q,k,Y=e.module,G=e.klass,c=e.slice,L=e.rb_plus,P=e.truthy,o=e.def,H=e.regexp,h=e.send,A=e.thrower,M=e.return_ivar,D=e.assign_ivar_val,Z=e.eqeqeq,W=e.eqeq,j=e.return_val,F=e.range,z=e.rb_minus,$=e.rb_divide,B=e.rb_times,l=e.rb_ge,_=e.top,C=[],r=e.$r(C),n=e.nil,g=e.$$$;return _.$require("i18n"),_.$require("i18n/backend/fallbacks"),_.$require("bcdice/randomizer"),_.$require("bcdice/dice_table"),_.$require("bcdice/enum"),_.$require("bcdice/translate"),_.$require("bcdice/result"),_.$require("bcdice/command/parser"),_.$require("bcdice/deprecated/checker"),E=C,y=k=[Y(C[0],"BCDice")].concat(E),d=[a=G(k[0],null,"Base")].concat(y),f=e.$r(d),(q=a.$$prototype).raw_input=q.randomizer=q.enabled_upcase_input=q.debug=n,t=[u=e.get_singleton_class(a)].concat(d),T=e.$r(t),u.$attr_reader("prefixes"),o(u,"$register_prefix",function(m){var X,te=this,O=n;return null==te.prefixes&&(te.prefixes=n),X=c(arguments),te.prefixes=L(P(O=te.prefixes)?O:[],X.$flatten())},-1),o(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),o(u,"$prefixes_pattern",function(){var m=this,s=n;return null==m.prefixes_pattern&&(m.prefixes_pattern=n),null==m.prefixes&&(m.prefixes=n),m.prefixes_pattern=P(s=m.prefixes_pattern)?s:n,P(m.prefixes_pattern)?m.prefixes_pattern:(m.prefixes=P(s=m.prefixes)?s:[],m.prefixes.$freeze(),m.prefixes_pattern=(P(m.prefixes["$empty?"]())?/(?!)/:H(["^(S)?(",m.prefixes.$join("|"),")"],"i")).$freeze())}),o(u,"$command_pattern",function(){var m=this,s=n,X=n;return null==m.command_pattern&&(m.command_pattern=n),null==m.prefixes&&(m.prefixes=n),m.command_pattern=P(s=m.command_pattern)?s:n,P(m.command_pattern)?m.command_pattern:(m.prefixes=P(s=m.prefixes)?s:[],m.prefixes.$freeze(),X=L(h(g(T("CommonCommand"),"COMMANDS"),"map",[],function(O){return null==O&&(O=n),g(O,"PREFIX_PATTERN").$source()}),m.prefixes),m.command_pattern=H(["^S?(",X.$join("|"),")"],"i").$freeze())}),o(u,"$eval",function(m){try{return A("eval_return"),this.$new(m).$eval()}catch(te){if(te===e.t_eval_return)return te.$v;throw te}}),a.$include(f("Translate")),a.$include(g(f("Deprecated"),"Checker")),o(a,"$initialize",function(v){var t=this;return t.raw_input=v,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=g(f("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=g(f("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=n,t.reroll_dice_reroll_threshold=n,t.default_cmp_op=n,t.default_target_number=n,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=g(f("BCDice"),"Randomizer").$new(),t.debug=!1}),a.$attr_accessor("randomizer"),a.$attr_reader("d66_sort_type"),a.$attr_reader("round_type"),a.$attr_reader("sides_implicit_d"),a.$attr_reader("upper_dice_reroll_threshold"),a.$attr_reader("reroll_dice_reroll_threshold"),a.$attr_reader("default_cmp_op"),a.$attr_reader("default_target_number"),o(a,"$sort_add_dice?",M("sort_add_dice")),o(a,"$sort_barabara_dice?",M("sort_barabara_dice")),o(a,"$enabled_d9?",M("enabled_d9")),o(a,"$enable_debug",D("debug",!0)),o(a,"$eval",function(){var t,i,v=this,T=n;return t=g(f("BCDice"),"Preprocessor").$process(v.raw_input,v),T=P(i=v.$dice_command(t))?i:v.$eval_common_command(v.raw_input),P(T)?(T["$rands="](v.randomizer.$rand_results()),T["$detailed_rands="](v.randomizer.$detailed_rand_results()),T):n}),o(a,"$change_text",function(v){return v}),o(a,"$check_result",function(v,t,T,i){var m=this,s=n,X=n,te=n,O=n,ue=n;return s=m.$check_result_legacy(v,t,T,i),P(s)?s:(X=h(t,"map",[],"sides".$to_proc()),O=(te=h(t,"map",[],"value".$to_proc())).$sum(),s=Z([100],ue=X)?m.$result_1d100(v,O,T,i):Z([20],ue)?m.$result_1d20(v,O,T,i):Z([6,6],ue)?m.$result_2d6(v,O,te,T,i):n,W(s,f("Result").$nothing())?n:P(s)?s:(s=Z([10],ue=X.$uniq())?m.$result_nd10(v,O,te,T,i):Z([6],ue)?m.$result_nd6(v,O,te,T,i):n,W(s,f("Result").$nothing())?n:P(s)?s:m.$result_ndx(v,T,i)))}),o(a,"$grich_text",j(n)),a.$private(),o(a,"$eval_common_command",function(v){try{A("eval_return");var T=A("return");return v=this.$change_text(v),h(g(f("CommonCommand"),"COMMANDS"),"each",[],function m(s){var te,X=null==m.$$s?this:m.$$s;if(null==X.randomizer&&(X.randomizer=n),null==s&&(s=n),te=s.$eval(v,X,X.randomizer),!P(te))return n;T.$throw(te)},{$$s:this,$$ret:T}),n}catch(m){if(m===e.t_eval_return||m===T)return m.$v;throw m}}),o(a,"$dice_command",function(v){var t=this,T=n,i=n,m=n,s=n;return P(t.enabled_upcase_input)&&(v=v.$upcase()),T=t.$class().$prefixes_pattern().$match(v),P(T)?(i=T["$[]"](1)["$nil?"]()["$!"](),P(i)&&(v=v["$[]"](F(1,-1,!1))),m=t.$eval_game_system_specific_command(v),P(m["$is_a?"](f("Result")))?(m["$secret="](P(s=m["$secret?"]())?s:i),m):P(m["$nil?"]())||P(m["$empty?"]())||W(m,"1")?n:h(f("Result").$new(),"tap",[],function(te){var O;return null==te&&(te=n),te["$text="](m.$to_s()),h(te,"secret=",O=[i]),O[O.length-1]})):n}),o(a,"$eval_game_system_specific_command",j(n)),o(a,"$result_ndx",function(v,t,T){return P(T["$is_a?"](f("String")))?n:P(v.$send(t,T))?f("Result").$success(this.$translate("success")):f("Result").$failure(this.$translate("failure"))}),o(a,"$result_1d100",j(n)),o(a,"$result_1d20",j(n)),o(a,"$result_nd10",j(n)),o(a,"$result_2d6",j(n)),o(a,"$result_nd6",j(n)),o(a,"$get_table_by_2d6",function(v){return this.$get_table_by_nD6(v,2)}),o(a,"$get_table_by_1d6",function(v){return this.$get_table_by_nD6(v,1)}),o(a,"$get_table_by_nD6",function(v,t){return this.$get_table_by_nDx(v,t,6)}),o(a,"$get_table_by_nDx",function(v,t,T){var m,s=n;return m=this.randomizer.$roll_sum(t,T),s=this.$get_table_value(v["$[]"](z(m,t))),P(s["$nil?"]())?["1",0]:[s,m]}),o(a,"$get_table_by_1d3",function(v){var i,m,t=this,s=n;return t.$debug("get_table_by_1d3"),i=t.randomizer.$roll_sum(1,6),t.$debug("num",i),m=$(z(i,1),2).$to_i(),t.$debug("index",m),s=v["$[]"](m),P(s["$nil?"]())?["1",0]:[s,i]}),o(a,"$get_table_by_d66_swap",function(v){var T;return T=this.randomizer.$roll_d66(g(f("D66SortType"),"ASC")),[this.$get_table_by_number(T,v),T]}),o(a,"$get_table_by_d66",function(v){var T,i,m,X,s=n;return T=this.randomizer.$roll_once(6),i=this.randomizer.$roll_once(6),m=L(B(z(T,1),6),z(i,1)),s=v["$[]"](m),X=""+T+i,P(s["$nil?"]())?["1",X]:[s,X]}),o(a,"$get_table_by_number",function(v,t,T){try{var i=A("return");return null==T&&(T="1"),h(t,"each",[],function s(X){var O,te=null==s.$$s?this:s.$$s;if(null==X&&(X=n),O=X["$[]"](0),!P(l(O,v)))return n;i.$throw(te.$get_table_value(X["$[]"](1)))},{$$s:this,$$ret:i}),this.$get_table_value(T)}catch(s){if(s===i)return s.$v;throw s}},-3),o(a,"$get_table_value",function(v){return P(v["$is_a?"](f("Proc")))?v.$call():v}),o(a,"$roll_tables",function(v,t){var i=n;return i=t["$[]"](v),P(i)?i.$roll(this.randomizer).$to_s():n}),o(a,"$debug",function(v,t){var i,m=this,s=n,X=n;return i=c(arguments,1),P(m.debug)?(s=P(v["$is_a?"](f("String")))?v:v.$inspect(),P(i["$empty?"]())?m.$warn(s):(X=h(i,"map",[],function(O){return null==O&&(O=n),P(O["$is_a?"](f("String")))?'"'+O+'"':O.$inspect()}),m.$warn(s+": "+X.$join(", ")))):n},-2),g(g(r("I18n"),"Backend"),"Simple").$include(g(g(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),p=[["ja_jp"]],h(r("I18n").$fallbacks(),"defaults=",p),p[p.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var D,F,_,K,E,w,k,r,$,B,W,Y=e.module,G=e.klass,c=e.const_set,L=e.hash2,P=e.truthy,o=e.def,h=[],A=e.nil;return e.top.$require("strscan"),D=h,F=W=[Y(h[0],"BCDice")].concat(D),$=[Y(W[0],"GameSystem")].concat(F),B=e.$r($),_=$,K=r=[G($[0],B("Base"),"SwordWorld")].concat(_),w=[E=G(r[0],null,"RatingLexer")].concat(K),k=e.$r(w),E.$$prototype.scanner=A,c(w[0],"SYMBOLS",L(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),o(E,"$initialize",function(y){var a,d,q;return y=P(q=(a=(d=y)===A||null==d?A:d.$split(" ",2))===A||null==a?A:a.$first())?q:"",this.scanner=k("StringScanner").$new(y)}),o(E,"$next_token",function(){var y=this,a=A,d=A,q=A;return P(y.scanner["$eos?"]())?[!1,"$"]:P(a=y.scanner.$scan(/\d+/))?["NUMBER",a.$to_i()]:(d=y.scanner.$getch().$upcase(),[P(q=k("SYMBOLS")["$[]"](d))?q:d.$to_sym(),d])}),o(E,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var Z,z,C,E,w,k,N,b,n,B,l,j,Y=e.module,G=e.klass,c=e.def,L=e.truthy,P=e.rb_le,o=e.rb_plus,H=e.rb_lt,h=e.neqeq,A=[],M=e.nil;return Z=A,z=j=[Y(A[0],"BCDice")].concat(Z),B=[Y(j[0],"GameSystem")].concat(z),l=e.$r(B),C=B,E=n=[G(B[0],l("Base"),"SwordWorld")].concat(C),k=[w=G(n[0],null,"RatingParsed")].concat(E),N=e.$r(k),(b=w.$$prototype).modifier_after_half=b.semi_fixed_val=b.kept_modify=b.rate=b.greatest_fortune=b.modifier=M,w.$attr_accessor("rate"),w.$attr_accessor("critical"),w.$attr_accessor("kept_modify"),w.$attr_accessor("first_to"),w.$attr_accessor("first_modify"),w.$attr_accessor("rateup"),w.$attr_accessor("greatest_fortune"),w.$attr_accessor("semi_fixed_val"),w.$attr_accessor("tmp_fixed_val"),w.$attr_accessor("modifier"),w.$attr_accessor("modifier_after_half"),c(w,"$initialize",function(a,d){var f=this;return f.rate=a,f.modifier=d,f.critical=13,f.kept_modify=0,f.first_to=0,f.first_modify=0,f.greatest_fortune=!1,f.rateup=0,f.semi_fixed_val=0,f.tmp_fixed_val=0,f.modifier_after_half=M}),c(w,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),c(w,"$min_critical",function(){var a=this;return L(P(a.semi_fixed_val,1))?3:o(o(a.semi_fixed_val,a.kept_modify),2).$clamp(3,13)}),c(w,"$infinite_roll?",function(){return H(this.$critical(),this.$min_critical())}),c(w,"$to_s",function(){var a=this,d=M;return d="KeyNo."+a.rate,L(H(a.$critical(),13))&&(d=o(d,"c["+a.$critical()+"]")),h(a.$first_modify(),0)&&(d=o(d,"m["+N("Format").$modifier(a.$first_modify())+"]")),h(a.$first_to(),0)&&(d=o(d,"m["+a.$first_to()+"]")),h(a.$rateup(),0)&&(d=o(d,"r["+a.$rateup()+"]")),L(a.greatest_fortune)&&(d=o(d,"gf")),h(a.$semi_fixed_val(),0)&&(d=o(d,"sf["+a.$semi_fixed_val()+"]")),h(a.$tmp_fixed_val(),0)&&(d=o(d,"tf["+a.$tmp_fixed_val()+"]")),h(a.$kept_modify(),0)&&(d=o(d,"a["+N("Format").$modifier(a.$kept_modify())+"]")),h(a.modifier,0)&&(d=o(d,N("Format").$modifier(a.modifier))),d})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var h,Z,B,r,p,j,F,M,Y=e.module,G=e.klass,c=e.truthy,L=e.def,P=[];return h=P,Z=M=[Y(P[0],"BCDice")].concat(h),j=[Y(M[0],"GameSystem")].concat(Z),F=e.$r(j),B=j,p=[G(j[0],F("Base"),"SwordWorld")].concat(B),(r=G(p[0],null,"RatingOptions")).$attr_accessor("critical"),r.$attr_accessor("kept_modify"),r.$attr_accessor("first_to"),r.$attr_accessor("first_modify"),r.$attr_accessor("rateup"),r.$attr_accessor("greatest_fortune"),r.$attr_accessor("semi_fixed_val"),r.$attr_accessor("tmp_fixed_val"),r.$attr_accessor("modifier"),r.$attr_accessor("modifier_after_half"),L(r,"$settable_first_roll_adjust_option?",function(){var K;return c(K=this.$first_modify()["$nil?"]())?this.$first_to()["$nil?"]():K}),L(r,"$settable_non_2d_roll_option?",function(){var K,E,g=this;return c(K=c(E=g.$greatest_fortune()["$nil?"]())?g.$semi_fixed_val()["$nil?"]():E)?g.$tmp_fixed_val()["$nil?"]():K})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var p,n,N,q,T,i,m,s,X,te,O,ue,$e,_e,u,v,t,I,y,a,K,E,C,Y=e.module,G=e.klass,c=e.ensure_kwargs,L=e.send2,P=e.find_super,o=e.def,H=e.send,h=e.truthy,A=e.not,M=e.thrower,D=e.hash,Z=e.const_set,W=e.to_ary,j=e.eqeq,F=e.top,z=[],$=e.nil,B=e.$$$;return F.$require("racc/parser.rb"),F.$require("bcdice/arithmetic/node"),F.$require("bcdice/enum"),F.$require("bcdice/game_system/sword_world/rating_lexer"),F.$require("bcdice/game_system/sword_world/rating_parsed"),F.$require("bcdice/game_system/sword_world/rating_options"),p=z,n=C=[Y(z[0],"BCDice")].concat(p),K=[Y(C[0],"GameSystem")].concat(n),E=e.$r(K),N=K,y=[G(K[0],E("Base"),"SwordWorld")].concat(N),a=e.$r(y),q=y,v=[u=G(y[0],B(a("Racc"),"Parser"),"RatingParser")].concat(q),t=e.$r(v),(I=u.$$prototype).lexer=I.round_type=I.version=$,o(u,"$initialize",function V(x){var S,re,U=this;return V.$$p=null,null==(S=(x=c(x)).$$smap.version)&&(S="v1_0"),null==(re=x.$$smap.round_type)&&(re=B(t("RoundType"),"CEIL")),L(U,P(U,"initialize",V,!1,!0),"initialize",[],null),U.version=S,U.round_type=re},-1),o(u,"$set_debug",function(){return this.yydebug=!0,this}),o(u,"$parse",function(x){try{return this.lexer=t("RatingLexer").$new(x),this.$do_parse()}catch(re){if(!e.rescue(re,[t("ParseError"),t("ZeroDivisionError")]))throw re;try{return $}finally{e.pop_exception()}}}),u.$private(),o(u,"$parsed",function(x,S,re){try{return M("eval_return"),H(t("RatingParsed").$new(x,S),"tap",[],function J(Q){var ne,ie,le,fe,oe,de,me,be,he=null==J.$$s?this:J.$$s,ve=$;return null==he.round_type&&(he.round_type=$),null==Q&&(Q=$),Q["$kept_modify="](h(ve=(ne=re.$kept_modify())===$||null==ne?$:ne.$eval(he.round_type))?ve:0),Q["$first_to="](h(ve=re.$first_to())?ve:0),Q["$first_modify="](h(ve=re.$first_modify())?ve:0),Q["$rateup="](h(ve=(ie=re.$rateup())===$||null==ie?$:ie.$eval(he.round_type))?ve:0),A(re.$greatest_fortune()["$nil?"]())&&Q["$greatest_fortune="](re.$greatest_fortune()),Q["$semi_fixed_val="](h(ve=(le=re.$semi_fixed_val())===$||null==le?$:le.$clamp(1,6))?ve:0),Q["$tmp_fixed_val="](h(ve=(fe=re.$tmp_fixed_val())===$||null==fe?$:fe.$clamp(1,6))?ve:0),Q["$modifier_after_half="]((oe=re.$modifier_after_half())===$||null==oe?$:oe.$eval(he.round_type)),de=[h((be=re.$critical(),me=be===$||null==be?$:be.$eval(he.round_type),ve=me===$||null==me?$:me.$clamp(0,13)))?ve:h(Q.$half())?13:10],H(Q,"critical=",de),de[de.length-1]},{$$s:this})}catch(J){if(J===e.t_eval_return)return J.$v;throw J}}),o(u,"$next_token",function(){return this.lexer.$next_token()}),T=e.large_array_unpack("15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54"),i=e.large_array_unpack("6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39"),m=e.large_array_unpack("22,3,,17,28,56,-4,,,,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,,81,,,,116,117,,,,118,119,,30,,32,50,61,,,,-2,63,,,,,86,88,99,101,,,,81,92"),s=e.large_array_unpack("-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23"),X=e.large_array_unpack("25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,,50,,,,,,,,,,,,,,,,,,,,,,,,,,60,61,62,63"),te=e.large_array_unpack("5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,,6,,,,,,,,,,,,,,,,,,,,,,,,,,5,5,6,6"),O=[$,5,11,0,$,-11,-11,-23,$],ue=[$,$,$,$,10,42,$,$,28],$e=e.large_array_unpack("0,0,racc_error,2,22,_reduce_1,3,22,_reduce_2,2,23,_reduce_3,0,24,_reduce_4,2,24,_reduce_5,4,24,_reduce_6,3,24,_reduce_7,3,24,_reduce_8,4,24,_reduce_9,4,24,_reduce_10,2,24,_reduce_11,3,24,_reduce_12,3,24,_reduce_13,3,24,_reduce_14,4,24,_reduce_15,4,24,_reduce_16,3,24,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,3,25,_reduce_20,3,25,_reduce_21,3,28,_reduce_22,3,28,_reduce_23,1,28,_reduce_none,3,27,_reduce_25,3,27,_reduce_26,1,27,_reduce_none,2,26,_reduce_28,2,26,_reduce_29,1,26,_reduce_none,3,29,_reduce_31,1,29,_reduce_32"),_e=D(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),Z(v[0],"Racc_arg",[T,i,s,m,X,te,ue,O,21,$e,_e,64,33,!0]),Z(v[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),Z(v[0],"Racc_debug_parser",!1),o(u,"$_reduce_1",function(x,S,re){try{M("eval_return");var U,ne,fe,ie=$,le=$;return ne=null==(U=W(x))[0]?$:U[0],le=h(fe=(ie=null==U[1]?$:U[1]).$modifier())?fe:B(B(t("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,le.$eval(this.round_type),ie)}catch(oe){if(oe===e.t_eval_return)return oe.$v;throw oe}}),o(u,"$_reduce_2",function(x,S,re){try{M("eval_return");var U,ie,fe,le=$,oe=$;return ie=null==(U=W(x))[1]?$:U[1],h((le=null==U[2]?$:U[2]).$modifier_after_half())||le["$modifier_after_half="](B(B(t("Arithmetic"),"Node"),"Number").$new(0)),oe=h(fe=le.$modifier())?fe:B(B(t("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ie,oe.$eval(this.round_type),le)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),o(u,"$_reduce_3",function(x,S,re){return x["$[]"](1).$to_i()}),o(u,"$_reduce_4",function(x,S,re){return t("RatingOptions").$new()}),o(u,"$_reduce_5",function(x,S,re){var R,ne,Q=$;return ne=null==(R=W(x))[1]?$:R[1],h((Q=null==R[0]?$:R[0]).$modifier()["$nil?"]())||this.$raise(t("ParseError")),Q["$modifier="](ne),Q}),o(u,"$_reduce_6",function(x,S,re){var R,ie,Q=$;return ie=null==(R=W(x))[2]?$:R[2],h((Q=null==R[0]?$:R[0]).$critical()["$nil?"]())||this.$raise(t("ParseError")),Q["$critical="](ie),Q}),o(u,"$_reduce_7",function(x,S,re){var R,ie,Q=$;return ie=null==(R=W(x))[2]?$:R[2],h((Q=null==R[0]?$:R[0]).$critical()["$nil?"]())||this.$raise(t("ParseError")),Q["$critical="](ie),Q}),o(u,"$_reduce_8",function(x,S,re){var R,Q=$,ie=$;return ie=null==(R=W(x))[2]?$:R[2],h((Q=null==R[0]?$:R[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),Q["$first_to="](ie.$to_i()),Q}),o(u,"$_reduce_9",function(x,S,re){var R,Q=$,ie=$;return ie=null==(R=W(x))[3]?$:R[3],h((Q=null==R[0]?$:R[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),Q["$first_modify="](ie.$to_i()),Q}),o(u,"$_reduce_10",function(x,S,re){var R,Q=$,ie=$;return ie=null==(R=W(x))[3]?$:R[3],h((Q=null==R[0]?$:R[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),Q["$first_modify="](ie.$to_i()["$-@"]()),Q}),o(u,"$_reduce_11",function(x,S,re){var R,Q=$;return R=W(x),h((Q=null==R[0]?$:R[0]).$modifier_after_half()["$nil?"]())||this.$raise(t("ParseError")),Q["$modifier_after_half="](B(B(t("Arithmetic"),"Node"),"Number").$new(0)),Q}),o(u,"$_reduce_12",function(x,S,re){var R,ie,Q=$;return ie=null==(R=W(x))[2]?$:R[2],h((Q=null==R[0]?$:R[0]).$modifier_after_half()["$nil?"]())||this.$raise(t("ParseError")),Q["$modifier_after_half="](ie),Q}),o(u,"$_reduce_13",function(x,S,re){var R,ie,Q=$;return Q=null==(R=W(x))[0]?$:R[0],ie=null==R[2]?$:R[2],h(["v2_5","v2_0"]["$include?"](this.version))&&h(Q.$rateup()["$nil?"]())||this.$raise(t("ParseError")),Q["$rateup="](ie),Q}),o(u,"$_reduce_14",function(x,S,re){var R,Q=$;return Q=null==(R=W(x))[0]?$:R[0],h(["v2_5","v2_0"]["$include?"](this.version))&&h(Q["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),Q["$greatest_fortune="](!0),Q}),o(u,"$_reduce_15",function(x,S,re){var R,Q=$,ie=$;return Q=null==(R=W(x))[0]?$:R[0],ie=null==R[3]?$:R[3],h(["v2_5","v2_0"]["$include?"](this.version))&&h(Q["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),Q["$semi_fixed_val="](ie.$to_i()),Q}),o(u,"$_reduce_16",function(x,S,re){var R,Q=$,ie=$;return Q=null==(R=W(x))[0]?$:R[0],ie=null==R[3]?$:R[3],h(["v2_5","v2_0"]["$include?"](this.version))&&h(Q["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),Q["$tmp_fixed_val="](ie.$to_i()),Q}),o(u,"$_reduce_17",function(x,S,re){var R,ie,Q=$;return Q=null==(R=W(x))[0]?$:R[0],ie=null==R[2]?$:R[2],j(this.version,"v2_5")&&h(Q.$kept_modify()["$nil?"]())||this.$raise(t("ParseError")),Q["$kept_modify="](ie),Q}),o(u,"$_reduce_18",function(x,S,re){return x["$[]"](1)}),o(u,"$_reduce_19",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))}),o(u,"$_reduce_20",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))}),o(u,"$_reduce_21",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))}),o(u,"$_reduce_22",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))}),o(u,"$_reduce_23",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))}),o(u,"$_reduce_25",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"*",x["$[]"](2))}),o(u,"$_reduce_26",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(x["$[]"](0),x["$[]"](2))}),o(u,"$_reduce_28",function(x,S,re){return x["$[]"](1)}),o(u,"$_reduce_29",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))}),o(u,"$_reduce_31",function(x,S,re){return x["$[]"](1)}),o(u,"$_reduce_32",function(x,S,re){return B(B(t("Arithmetic"),"Node"),"Number").$new(x["$[]"](0))}),o(u,"$_reduce_none",function(x,S,re){return x["$[]"](0)})},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var K,N,q,u,v,t,T,y,a,w,Y=e.module,G=e.klass,c=e.const_set,L=e.send2,P=e.find_super,o=e.def,H=e.truthy,h=e.rb_ge,A=e.rb_le,M=e.eqeq,D=e.neqeq,Z=e.rb_minus,W=e.rb_gt,j=e.hash2,F=e.send,z=e.to_ary,$=e.rb_plus,B=e.rb_lt,l=e.rb_times,p=e.thrower,_=e.rb_divide,C=e.top,r=[],n=e.nil;return C.$require("bcdice/base"),C.$require("bcdice/game_system/sword_world/rating_parser"),K=r,N=w=[Y(r[0],"BCDice")].concat(K),y=[Y(w[0],"GameSystem")].concat(N),a=e.$r(y),q=y,v=[u=G(y[0],a("Base"),"SwordWorld")].concat(q),t=e.$r(v),(T=u.$$prototype).rating_table=T.randomizer=n,c(v[0],"ID","SwordWorld"),c(v[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),c(v[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),c(v[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),u.$register_prefix("H?K"),o(u,"$initialize",function i(m){var X=this;return i.$$p=null,L(X,P(X,"initialize",i,!1,!0),"initialize",[m],null),X.rating_table=0}),o(u,"$result_2d6",function(m,s,X,te,O){return H(h(s,12))?t("Result").$critical(this.$translate("SwordWorld.critical")):H(A(s,2))?t("Result").$fumble(this.$translate("SwordWorld.fumble")):D(te,">=")||M(O,"?")?n:H(h(m,O))?t("Result").$success(this.$translate("success")):t("Result").$failure(this.$translate("failure"))}),o(u,"$eval_game_system_specific_command",function(m){return this.$rating(m)}),u.$private(),o(u,"$rating_parser",function(){return t("RatingParser").$new()}),o(u,"$rating",function(m){var s,X,te=this,O=n,ue=n,$e=n,ce=n,se=n,_e=n,ae=n,ee=n,I=n,V=n,x=n,S=n,re=n,R=n,J=n,Q=n;return te.$debug("rating string",m),O=te.$rating_parser().$parse(m),H(O)?(ue=te.$getSW2_0_RatingTable(),$e=Z(ue.$length(),1),te.$debug("keyMax",$e),H(W(O.$rate(),$e))?t("Result").$new(te.$translate("SwordWorld.keynumber_exceeds",j(["keyMax"],{keyMax:$e}))):H(O["$infinite_roll?"]())?t("Result").$new(te.$translate("SwordWorld.infinite_critical",j(["min_critical"],{min_critical:O.$min_critical()}))):(ce=te.$getNewRates(ue),se=O+" \uff1e ",_e=[],ae=[],ee=[],I=0,V=0,x=0,S=0,re=O.$first_to(),R=O.$first_modify(),function(){try{var ne=p("break");F(te,"loop",[],function ie(){var le,fe,be,he,oe=null==ie.$$s?this:ie.$$s,de=n,me=n;if(fe=oe.$rollDice(O,S),me=null==(le=z(fe))[1]?n:le[1],I=de=null==le[0]?n:le[0],D(re,0)?(I=de=re,re=0):D(R,0)&&(I=$(I,R),R=0),H(A(de,2))&&(_e["$<<"](de.$to_s()),ae["$<<"](me.$to_s()),ee["$<<"]("**"),S=$(S,1),ne.$throw()),D(O.$kept_modify(),0)&&D(I,2)&&(I=$(I,O.$kept_modify())),H(B(I,2))&&(I=2),H(W(I,12))&&(I=12),be=[$(O.$rate(),l(S,O.$rateup())),$e].$min(),oe.$debug("currentKey",be),he=ce["$[]"](I)["$[]"](be),oe.$debug("rateValue",he),x=$(x,he),V=$(V,I),_e["$<<"](I.$to_s()),ae["$<<"](me.$to_s()),ee["$<<"](H(W(I,2))?he:"**"),S=$(S,1),H(h(I,O.$critical())))return n;ne.$throw()},{$$s:te})}catch(ie){if(ie===ne)return ie.$v;throw ie}}(),X=te.$getResultText(x,O,ae,_e,ee,V,S),s=z(X),J=null==s[1]?n:s[1],Q=null==s[2]?n:s[2],se=$(se,null==s[0]?n:s[0]),F(t("Result").$new(),"tap",[],function(ie){var le;return null==ie&&(ie=n),ie["$text="](se),ie["$critical="](J),F(ie,"fumble=",le=[Q]),le[le.length-1]}))):(te.$debug("not matched"),"1")}),o(u,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),o(u,"$getNewRates",function(m){var s,X,O=n,ue=n,$e=n,ce=n,se=n,_e=n,ae=n,ee=n,I=n,V=n,x=n;return O=[],ue=[],$e=[],ce=[],se=[],_e=[],ae=[],ee=[],I=[],V=[],x=[],F(m,"each",[],function(R){var U=n;return null==R&&(R=n),U=R.$split(/,/),x.$push(0),O.$push(U["$[]"](1).$to_i()),ue.$push(U["$[]"](2).$to_i()),$e.$push(U["$[]"](3).$to_i()),ce.$push(U["$[]"](4).$to_i()),se.$push(U["$[]"](5).$to_i()),_e.$push(U["$[]"](6).$to_i()),ae.$push(U["$[]"](7).$to_i()),ee.$push(U["$[]"](8).$to_i()),I.$push(U["$[]"](9).$to_i()),V.$push(U["$[]"](10).$to_i())}),M(this.rating_table,1)&&V["$[]="](31,(s=[32,(X=[33,10],F(V,"[]=",X),X[X.length-1])],F(V,"[]=",s),s[s.length-1])),[x,x,x,O,ue,$e,ce,se,_e,ae,ee,I,V]}),o(u,"$rollDice",function(m,s){var te=n;return[(te=this.randomizer.$roll_barabara(2,6)).$sum(),te.$join(",")]}),o(u,"$getResultText",function(m,s,X,te,O,ue,$e){var se=n,_e=n,ae=n,ee=n,I=n;return(se=[]).$push("2D:["+X.$join(" ")+"]="+te.$join(",")),H(A(ue,2))?(se.$push(O.$join(",")),se.$push(this.$translate("SwordWorld.fumble")),[se.$join(" \uff1e "),!1,!0]):(H(W(O.$size(),1))||D(s.$modifier(),0)?(_e=$(O.$join(","),t("Format").$modifier(s.$modifier())),H(s.$half())&&(_e="("+_e+")/2",D(s.$modifier_after_half(),0)&&(_e=$(_e,t("Format").$modifier(s.$modifier_after_half())))),se.$push(_e)):H(s.$half())&&(_e=O.$first()+"/2",D(s.$modifier_after_half(),0)&&(_e=$(_e,t("Format").$modifier(s.$modifier_after_half()))),se.$push(_e)),H(W($e,1))&&(ae=this.$translate("SwordWorld.round_text",j(["reroll_count"],{reroll_count:Z($e,1)})),se.$push(ae)),ee=$(m,s.$modifier()),H(s.$half())&&(ee=_(ee,2).$ceil(),D(s.$modifier_after_half(),0)&&(ee=$(ee,s.$modifier_after_half()))),I=ee.$to_s(),se.$push(I),[se.$join(" \uff1e "),W($e,1),!1])})},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){var F,l,g,N,b,y,a,d,E,_,C,$,Y=e.module,G=e.klass,c=e.def,L=e.truthy,P=e.rb_lt,o=e.hash2,H=e.not,h=e.rb_ge,A=e.rb_plus,M=e.send,D=e.top,Z=[],W=e.nil;return D.$require("bcdice/result"),D.$require("bcdice/translate"),F=Z,l=$=[Y(Z[0],"BCDice")].concat(F),_=[Y($[0],"GameSystem")].concat(l),C=e.$r(_),g=_,N=E=[G(_[0],C("SwordWorld"),"SwordWorld2_0")].concat(g),y=[b=G(E[0],null,"TranscendentTest")].concat(N),a=e.$r(y),(d=b.$$prototype).modifier=d.critical_value=d.expression=d.modifier_str=d.target=d.cmp_op=W,b.$include(a("Translate")),c(b,"$initialize",function(q,u,v,t,T){var i=this;return i.critical_value=q,i.modifier=u,i.cmp_op=v,i.target=t,i.locale=T,i.modifier_str=a("Format").$modifier(i.modifier),i.expression=i.$node_expression()}),c(b,"$execute",function(q){var T,i,m,u=this,v=W,t=W,s=W,X=W,te=W,O=W;if(L(P(u.critical_value,3)))return u.$translate("SwordWorld2_0.transcendent_critical_too_small",o(["expression"],{expression:u.expression}));if(t=[v=q.$roll_barabara(2,6)],T=v["$=="]([1,1]),i=v["$=="]([6,6]),H(T)&&H(i))for(;L(h(u.$sum_of_dice(t.$last()),u.critical_value));)t.$push(q.$roll_barabara(2,6));return m=u.$sum_of_dice(t),s=A(m,u.modifier),X=u.$result_status(s,t.$length(),T,i),te=o(["success","failure","super_success","critical","fumble"],{success:u.$translate("success"),failure:u.$translate("failure"),super_success:u.$translate("SwordWorld2_0.super_success"),critical:u.$translate("SwordWorld.critical"),fumble:u.$translate("SwordWorld.fumble")}).$freeze()["$[]"](X),O=["("+u.expression+")",""+u.$dice_str(t,m)+u.modifier_str,s,te].$compact(),M(a("Result").$new(),"tap",[],function($e){var ce;return null==$e&&($e=W),$e["$text="](O.$join(" \uff1e ")),$e["$fumble="](X["$=="]("fumble")),$e["$critical="](X["$=="]("critical")),$e["$success="](["success","super_success","critical"]["$include?"](X)),ce=[["failure","fumble"]["$include?"](X)],M($e,"failure=",ce),ce[ce.length-1]})}),b.$private(),c(b,"$node_expression",function(){var u,q=this;return u="2D6@"+q.critical_value+q.modifier_str,L(q.target)?""+u+q.cmp_op+q.target:u}),c(b,"$sum_of_dice",function(q){return q.$flatten().$sum()}),c(b,"$dice_str",function(q,u){return""+u+M(q,"map",[],function(T){return null==T&&(T=W),"["+T.$join(",")+"]"}).$join()}),c(b,"$result_status",function(q,u,v,t){var T=this;return L(T.target)?L(v)?"fumble":L(t)?"critical":L(q.$send(T.cmp_op,T.target))?L(h(u,2))&&L(h(q,41))?"super_success":"success":"failure":"no_target"})},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){var _,g,b,y,a,d,f,E,w,r,Y=e.module,G=e.klass,c=e.const_set,L=e.send2,P=e.find_super,o=e.def,H=e.eqeqeq,h=e.truthy,A=e.hash2,M=e.rb_gt,D=e.rb_plus,Z=e.eqeq,W=e.rb_times,j=e.send,F=e.neqeq,z=e.top,$=[],B=e.nil,l=e.$$$;return z.$require("bcdice/arithmetic_evaluator"),z.$require("bcdice/game_system/SwordWorld"),z.$require("bcdice/game_system/sword_world/transcendent_test"),_=$,g=r=[Y($[0],"BCDice")].concat(_),E=[Y(r[0],"GameSystem")].concat(g),w=e.$r(E),b=E,a=[y=G(E[0],w("SwordWorld"),"SwordWorld2_0")].concat(b),d=e.$r(a),(f=y.$$prototype).locale=f.randomizer=B,c(a[0],"ID","SwordWorld2.0"),c(a[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),c(a[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),c(a[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),y.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),o(y,"$initialize",function q(u){var t=this;return q.$$p=null,L(t,P(t,"initialize",q,!1,!0),"initialize",[u],null),t.rating_table=2}),o(y,"$eval_game_system_specific_command",function q(u){var T,t=this,m=B;return q.$$p=null,H(/^Gr(\d+)?/i,T=u)?h(u["$=~"](/^Gr(\d+)/i))?t.$growth(d("Regexp").$last_match(1).$to_i()):t.$growth():H(/^2D6?@\d+/i,T)?(m=l(d("Command"),"Parser").$new(/2D6?/i,A(["round_type"],{round_type:l(l(d("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(B,">=",">").$parse(u),h(m)?d("TranscendentTest").$new(m.$critical(),m.$modify_number(),m.$cmp_op(),m.$target_number(),t.locale).$execute(t.randomizer):B):H("FT",T)?t.$get_fumble_table():H("TT",T)?t.$get_tangle_table():L(t,P(t,"eval_game_system_specific_command",q,!1,!0),"eval_game_system_specific_command",[u],null)}),o(y,"$rating_parser",function(){return d("RatingParser").$new(A(["version"],{version:"v2_0"}))}),o(y,"$rollDice",function q(u,v){var T=this,i=B;return q.$$p=null,h(M(u.$semi_fixed_val(),0))?(i=T.randomizer.$roll_once(6),[D(i,u.$semi_fixed_val()),i+","+u.$semi_fixed_val()]):Z(v,0)&&h(M(u.$tmp_fixed_val(),0))?(i=T.randomizer.$roll_once(6),[D(i,u.$tmp_fixed_val()),i+","+u.$tmp_fixed_val()]):h(u.$greatest_fortune())?(i=T.randomizer.$roll_once(6),[W(i,2),i+","+i]):L(T,P(T,"rollDice",q,!1,!0),"rollDice",[u,v],null)}),o(y,"$growth",function(u){return null==u&&(u=1),j(e.Range.$new(1,u,!1),"map",[],function t(){return(null==t.$$s?this:t.$$s).$growth_step()},{$$s:this}).$join(" | ")},-1),o(y,"$growth_step",function(){var u=this,v=B,t=B,T=B;return t=(v=l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",u.locale)).$roll(u.randomizer),T=v.$roll(u.randomizer),F(t.$value(),T.$value())?"["+t.$value()+","+T.$value()+"]->("+t.$body()+" or "+T.$body()+")":"["+t.$value()+","+T.$value()+"]->("+t.$body()+")"}),o(y,"$get_fumble_table",function(){return l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",this.locale).$roll(this.randomizer)}),o(y,"$get_tangle_table",function(){return l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",this.locale).$roll(this.randomizer)})},Opal.queue(function(e){var D,F,_,C,r,$,B,W,Y=e.module,G=e.klass,c=e.const_set,L=e.send2,P=e.find_super,o=e.def,h=[];return e.top.$require("bcdice/game_system/SwordWorld2_0"),D=h,F=W=[Y(h[0],"BCDice")].concat(D),$=[Y(W[0],"GameSystem")].concat(F),B=e.$r($),_=$,c((r=[C=G($[0],B("SwordWorld2_0"),"SwordWorld2_0_SimplifiedChinese")].concat(_))[0],"ID","SwordWorld2.0:SimplifiedChinese"),c(r[0],"NAME","\u5251\u4e16\u754c2.0"),c(r[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0"),c(r[0],"HELP_MESSAGE","\u81ea\u52a8\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u8d25\u3001\u81ea\u52a8\u5931\u8d25\u4f1a\u81ea\u52a8\u5224\u5b9a\u3002\n\n  \u30fb\u5a01\u529b\u8868\u3000(Kx)\n  \u3000\u6307\u4ee4\u4e3a\u201cK\u5a01\u529b\u503c+\u52a0\u503c\u201d\u7684\u683c\u5f0f\u3002\n  \u3000\u52a0\u503c\u7684\u90e8\u5206\u4e0d\u80fd\u662f\u50cf\u201cK20+K30\u201d\u8fd9\u6837\u7684\u5a01\u529b\u7684\u5199\u6cd5\u3002\n  \u3000\u53e6\u5916\uff0c\u52a0\u503c\u53ef\u4ee5\u6709\u591a\u4e2a\u3002\n  \u3000\u5a01\u529b\u8868\u548c\u9ab0\u70b9\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u5176\u4ed6\u73a9\u5bb6\u9690\u85cf\u3002\n  \u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n  \u30fb\u66b4\u51fb\u503c\u7684\u8bbe\u5b9a\n  \u3000\u66b4\u51fb\u503c\u901a\u8fc7\u201c[\u66b4\u51fb\u503c]\u201d\u6307\u5b9a\u3002\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u65f6\u9ed8\u8ba4\u4e3a10\u3002\n  \u3000\u5982\u679c\u4e0d\u9700\u8981\u53d1\u751f\u66b4\u51fb\uff0c\u8bf7\u8bbe\u5b9a\u4e3a13\u3002\uff08\u4f8b\u5982\u9632\u5fa1\u65f6\uff09\n  \u3000\u53e6\u5916\u4e5f\u53ef\u5199\u6210\u7ed3\u5c3e\u7684\u201c@\u66b4\u51fb\u503c\u201d\u7684\u5f62\u5f0f\u3002\n  \u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n  \u30fb\u5a01\u529b\u8868\u7684\u51cf\u534a (HKx, KxH+N)\n  \u3000\u5728\u5a01\u529b\u8868\u5f00\u5934\u6216\u672b\u5c3e\u52a0\u4e0a\u201cH\u201d\uff0c\u9ab0\u5a01\u529b\u8868\u7684\u6700\u7ec8\u7ed3\u679c\u5c31\u4f1a\u51cf\u534a\u3002\n  \u3000H\u5199\u5728\u5a01\u529b\u8868\u672b\u5c3e\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u540e\u9762\u76f4\u63a5\u8ddf\u7740\u4fee\u6b63\uff0c\u4f1a\u5728\u51cf\u534a\u540e\u8fdb\u884c\u52a0\u51cf\u8fd0\u7b97\u3002\n  \u3000\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u591a\u4e2a\u4fee\u6b63\u9700\u8981\u7528\u62ec\u53f7\u62ec\u8d77\u6765\uff08\u5426\u5219\u4f1a\u89e3\u6790\u5931\u8d25\uff09\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u5219\u89c6\u4e3a\u6ca1\u6709\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n  \u30fb\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63\uff08\u547d\u8fd0\u53d8\u8f6c\u6216\u91cd\u51fb\u5149\u8f89\u7528\uff09\n  \u3000\u5728\u6307\u4ee4\u672b\u5c3e\u6dfb\u52a0\u201c$\u4fee\u6b63\u503c\u201d\u6765\u6539\u53d8\u9ab0\u5b50\u51fa\u76ee\u3002\n  \u3000\u53ef\u4ee5\u4f7f\u7528$+1\u7684\u683c\u5f0f\u5728\u9ab0\u5b50\u51fa\u76ee\u4e0a+\u4fee\u6b63\uff0c\u6216\u4f7f\u7528$9\u7684\u683c\u5f0f\u628a\u9ab0\u5b50\u51fa\u76ee\u66ff\u6362\u4e3a\u56fa\u5b9a\u503c\u3002\n  \u3000\u66b4\u51fb\u65f6\u53ea\u6709\u7b2c\u4e00\u6b21\u51fa\u76ee\u5e94\u7528\u8fd9\u4e2a\u4fee\u6b63\u3002\n  \u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n  \u30fb\u5a01\u529b\u4e0a\u5347\uff08\u65a9\u9996\u5200\u7528\uff09 r10\n  \u3000r\u540e\u8ddf\u4e0a\u5347\u503c\uff0c\u66b4\u51fb\u540e\u5a01\u529b\u4e0a\u5347r\u540e\u6240\u586b\u5199\u7684\u4e0a\u5347\u503c\u70b9\n  \u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n  \u30fb\u6781\u9650\u547d\u8fd0\u5728\u672b\u5c3e\u52a0\u4e0a gf\n  \u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u4ecd\u7ee7\u7eed sf4\n  \u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u53d8\u56de\u4f7f\u75282d\u5bf9\u5e94 tf3\n  \u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n  \u30fb\u8d85\u8d8a\u5224\u5b9a\u75282d6\u53ef\u5199\u6210 2d6@10 \u7684\u683c\u5f0f\u52a0\u4e0a\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n  \u30fb\u6210\u957f\u3000(Gr)\n  \u3000\u5728Gr\u540e\u9762\u52a0\u4e0a\u6570\u5b57\u53ef\u4ee5\u8fdb\u884c\u591a\u6b21\u6210\u957f\u3002\n  \u3000\u4f8b\uff09Gr3\n\n  \u30fb\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3000(FT)\n  \u3000\u62bd\u53d6\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3002\n\n  \u30fb\u7f20\u7ed5\u6548\u679c\u8868\u3000(TT)\n  \u3000\u62bd\u53d6\u7f20\u7ed5\u6548\u679c\u8868\u3002\n"),C.$register_prefix_from_super_class(),o(C,"$initialize",function n(g){var E=this;return n.$$p=null,L(E,P(E,"initialize",n,!1,!0),"initialize",[g],null),E.locale="zh_hans"})})}}]);