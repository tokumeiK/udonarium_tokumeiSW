(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5811],{7740:(V,X,T)=>{T(9993),Opal.modules["bcdice/normalize"]=function(i){var W,h,A,z=i.module,m=i.eqeqeq,p=i.def,N=i.eqeq,E=[],l=i.nil;return W=E,A=[z(E[0],"BCDice")].concat(W),(h=z(A[0],"Normalize")).$module_function(),p(h,"$comparison_operator",function(q){var b;return m(/<=|=</,b=q)?"<=":m(/>=|=>/,b)?">=":m(/<>|!=|=!/,b)?"!=":m(/</,b)?"<":m(/>/,b)?">":m(/=/,b)?"==":l}),p(h,"$target_number",function(q){return N(q,"?")?q:q.$to_i()})},Opal.modules["bcdice/format"]=function(i){var A,q,b,S,B,h,z=i.module,m=i.eqeqeq,p=i.def,N=i.truthy,E=i.eqeq,l=i.rb_gt,a=[],W=i.nil;return A=a,q=h=[z(a[0],"BCDice")].concat(A),S=[b=z(h[0],"Format")].concat(q),B=i.$r(S),b.$module_function(),p(b,"$comparison_operator",function(v){var C;return m("==",C=v)?"=":m("!=",C)?"<>":m(B("Symbol"),C)?v.$to_s():W}),p(b,"$modifier",function(v){return N(v["$nil?"]())?W:E(v,0)?"":N(l(v,0))?"+"+v:v.$to_s()})},Opal.queue(function(i){var C,K,J,Q,U,e,d,g,y,k,D,Y,F,z=i.module,m=i.klass,p=i.const_set,N=i.send2,E=i.find_super,l=i.def,a=i.truthy,W=i.to_ary,f=i.rb_plus,A=i.regexp,x=i.send,h=i.thrower,P=i.eqeq,q=i.neqeq,b=i.rb_minus,S=i.top,B=[],r=i.nil;return S.$require("bcdice/normalize"),S.$require("bcdice/format"),C=B,K=F=[z(B[0],"BCDice")].concat(C),D=[z(F[0],"GameSystem")].concat(K),Y=i.$r(D),J=D[0],Q=Y("Base"),U=D,g=[d=m(J,Q,"NightWizard")].concat(U),y=i.$r(g),(k=d.$$prototype).nw_command=k.randomizer=k.total=k.interim_expr=k.status=k.fumble_numbers=k.critical_numbers=r,p(g[0],"ID","NightWizard"),p(g[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),p(g[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),p(g[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),d.$register_prefix("([-+]?\\d+)?NW","2R6"),l(d,"$initialize",function c(u){var t=this;return c.$$p=null,N(t,E(t,"initialize",c,!1,!0),"initialize",[u],null),t.nw_command="NW"}),l(d,"$eval_game_system_specific_command",function(u){var e,t,o,$=this,n=r,_=r,s=r,j=r,w=r;return n=a(o=$.$parse_nw(u))?o:$.$parse_2r6(u),a(n)?(t=$.$roll_nw(n),_=null==(e=W(t))[0]?r:e[0],s=null==e[1]?r:e[1],j=null==e[2]?r:e[2],w=a(n.$cmp_op())?a(_.$send(n.$cmp_op(),n.$target_number()))?"\u6210\u529f":"\u5931\u6557":r,["("+n+")",s,j,_.$to_s(),w].$compact().$join(" \uff1e ")):r}),d.$private(),(e=m(g[0],null,"Parsed")).$attr_accessor("critical_numbers"),e.$attr_accessor("fumble_numbers"),e.$attr_accessor("prana"),e.$attr_accessor("active_modify_number"),e.$attr_accessor("cmp_op"),e.$attr_accessor("target_number"),function(c,u,e){var t=m(c,u,"ParsedNW"),$=[t].concat(e),n=i.$r($),o=t.$$prototype;o.base=o.modify_number=o.active_modify_number=o.prana=o.command=o.critical_numbers=o.fumble_numbers=o.cmp_op=o.target_number=r,t.$attr_accessor("base"),t.$attr_accessor("modify_number"),l(t,"$initialize",function _(s){var w=this;return _.$$p=null,N(w,E(w,"initialize",_,!1,!0),"initialize",[],null),w.command=s}),l(t,"$passive_modify_number",function(){return f(this.base,this.modify_number)}),l(t,"$to_s",function(){var j,w,R,M,G,s=this;return j=a(s.base["$zero?"]())?r:s.base,w=n("Format").$modifier(s.modify_number),R=n("Format").$modifier(s.active_modify_number),M=a(G=s.prana)?"$"+s.prana:G,""+j+s.command+w+"@"+s.critical_numbers.$join(",")+"#"+s.fumble_numbers.$join(",")+M+R+s.cmp_op+s.target_number})}(g[0],y("Parsed"),g),function(c,u){var e=m(c,u,"Parsed2R6"),t=e.$$prototype;t.passive_modify_number=t.active_modify_number=t.critical_numbers=t.fumble_numbers=t.cmp_op=t.target_number=r,e.$attr_accessor("passive_modify_number"),l(e,"$to_s",function(){var n=this;return"2R6M["+n.passive_modify_number+","+n.active_modify_number+"]C["+n.critical_numbers.$join(",")+"]F["+n.fumble_numbers.$join(",")+"]"+n.cmp_op+n.target_number})}(g[0],y("Parsed")),l(d,"$parse_nw",function(u){try{h("eval_return");var t,$,o=r,_=r;return o=A(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(u),a(o)?((_=y("ParsedNW").$new(this.nw_command))["$base="](o["$[]"](1).$to_i()),_["$modify_number="](y("ArithmeticEvaluator").$eval(o["$[]"](2))),_["$critical_numbers="](a(o["$[]"](3))?x(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]),_["$fumble_numbers="](a(o["$[]"](4))?x(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]),_["$prana="]((t=o["$[]"](5))===r||null==t?r:t.$to_i()),_["$active_modify_number="](y("ArithmeticEvaluator").$eval(o["$[]"](6))),_["$cmp_op="](y("Normalize").$comparison_operator(o["$[]"](7))),_["$target_number="](($=o["$[]"](8))===r||null==$?r:$.$to_i()),_):r}catch(s){if(s===i.t_eval_return)return s.$v;throw s}}),l(d,"$parse_2r6",function(u){try{h("eval_return");var t,$=r,n=r;return $=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(u),a($)?((n=y("Parsed2R6").$new())["$passive_modify_number="](y("ArithmeticEvaluator").$eval($["$[]"](1))),n["$active_modify_number="](y("ArithmeticEvaluator").$eval($["$[]"](2))),n["$critical_numbers="](a($["$[]"](3))?x($["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]),n["$fumble_numbers="](a($["$[]"](4))?x($["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]),n["$cmp_op="](y("Normalize").$comparison_operator($["$[]"](5))),n["$target_number="]((t=$["$[]"](6))===r||null==t?r:t.$to_i()),n):r}catch(o){if(o===i.t_eval_return)return o.$v;throw o}}),l(d,"$roll_nw",function(u){var e=this,t=r,$=r,n=r,o=r,_=r;for(e.critical_numbers=u.$critical_numbers(),e.fumble_numbers=u.$fumble_numbers(),e.total=0,e.interim_expr="",e.status=r,t=e.$roll_once_first();P(t,"critical");)t=e.$roll_once();return q(t,"fumble")&&a(u.$prana())&&(n=($=e.randomizer.$roll_barabara(u.$prana(),6)).$sum(),o=$.$join(","),e.total=f(e.total,n),e.interim_expr=f(e.interim_expr,"+"+n+"["+o+"]")),_=P(t,"fumble")?e.$fumble_base_number(u):f(u.$passive_modify_number(),u.$active_modify_number()),e.total=f(e.total,_),e.interim_expr=f(_.$to_s(),e.interim_expr),[e.total,e.interim_expr,e.status]}),l(d,"$roll_once",function(u){var $,n,e=this,t=r;return null==u&&(u=!1),$=(t=e.randomizer.$roll_barabara(2,6)).$sum(),n=t.$join(","),a(u)&&a(e.fumble_numbers["$include?"]($))?(e.total=b(e.total,10),e.interim_expr=f(e.interim_expr,"-10["+n+"]"),e.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):a(e.critical_numbers["$include?"]($))?(e.total=f(e.total,10),e.interim_expr=f(e.interim_expr,"+10["+n+"]"),e.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(e.total=f(e.total,$),e.interim_expr=f(e.interim_expr,"+"+$+"["+n+"]"),r)},-1),l(d,"$roll_once_first",function(){return this.$roll_once(!0)}),l(d,"$fumble_base_number",function(u){return u.$passive_modify_number()})})}}]);