(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5150],{8327:(W,Z,B)=>{B(9993),Opal.queue(function(f){var G,H,Q,a,S,m,z,O,w,k=f.module,E=f.klass,R=f.const_set,I=f.send2,M=f.find_super,p=f.def,o=f.truthy,y=f.rb_le,c=f.rb_plus,V=f.rb_divide,q=f.hash,l=f.hash2,C=f.neqeq,N=f.send,T=f.to_ary,A=[],e=f.nil,X=f.$$$;return G=A,H=w=[k(A[0],"BCDice")].concat(G),z=[k(w[0],"GameSystem")].concat(H),O=f.$r(z),Q=z,S=[a=E(z[0],O("Base"),"Skynauts")].concat(Q),m=f.$r(S),a.$$prototype.randomizer=e,R(S[0],"ID","Skynauts"),R(S[0],"NAME","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09"),R(S[0],"SORT_KEY","\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064"),R(S[0],"HELP_MESSAGE","\u25c6\u5224\u5b9a\u3000(SNn)\u3001(2D6<=n)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000\u4f8b\uff09SN5\u3000SN5\u3000SN(3+2)\n\u25c6\u822a\u884c\u30c1\u30a7\u30c3\u30af\u3000(NV+n)\u3000n:\u4fee\u6b63\u5024\uff08\u7701\u7565\u6642:0\uff09\n\u3000\u4f8b\uff09NV\u3000NV+1\n\u25c6\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(Dx/y@m)\u3000x:\u30c0\u30e1\u30fc\u30b8\u5de6\u5074\u306e\u5024\u3001y:\u30c0\u30e1\u30fc\u30b8\u53f3\u5074\u306e\u5024\n\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u98db\u7a7a\u8247\u30b7\u30fc\u30c8\u5916\u306e\u5ea7\u6a19\u306f()\u304c\u4ed8\u304d\u307e\u3059\u3002\n\u3000\u4f8b\uff09 D/4\u3000D19/2\u3000D/3@8\u3000D[\u5927\u63fa\u308c]/2\n\u25c6\u7832\u6483\u5224\u5b9a+\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(BOMn/Dx/y@m)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000x:\u30c0\u30e1\u30fc\u30b8\u5de6\u5074\u306e\u5024\u3001y:\u30c0\u30e1\u30fc\u30b8\u53f3\u5074\u306e\u5024\n\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u4f8b\uff09 BOM/D/4\u3000BOM9/D19/2@4\n\u25c6\u300a\u56de\u907f\u904b\u52d5\u300b\u3000(AVOn@mXX)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000m:\u56de\u907f\u65b9\u5411\u3002\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\u3001XX\uff1a\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u7d50\u679c\n\u3000\u4f8b\uff09\n\u3000AVO9@8[\u7e261,\u6a2a4],[\u7e262,\u6a2a6],[\u7e263,\u6a2a8]\u3000AVO@2[\u7e266,\u6a2a4],[\u7e262,\u6a2a6]\n"),a.$register_prefix("D","2D6<=","SN","NV","AVO","BOM"),p(a,"$initialize",function d(n){var $=this;return d.$$p=null,I($,M($,"initialize",d,!1,!0),"initialize",[n],null),$.round_type=X(m("RoundType"),"FLOOR")}),p(a,"$eval_game_system_specific_command",function(n){var $,t,_,r,i=this;return i.$debug("\n=======================================\n"),i.$debug("eval_game_system_specific_command command",n),o($=o(t=o(_=o(r=i.$get_judge_result(n))?r:i.$navigation_result(n))?_:i.$get_fire_result(n))?t:i.$get_bomb_result(n))?$:i.$get_avoid_result(n)}),a.$private(),p(a,"$get_judge_result",function(n){var t,i=this,$=e,_=e,r=e,s=e,u=e;return o($=o(t=/^2D6<=(\d)$/i.$match(n))?t:/^SN(\d*)$/i.$match(n))?(i.$debug("====get_judge_result===="),_=o($["$[]"](1)["$empty?"]())?7:$["$[]"](1).$to_i(),i.$debug("\u76ee\u6a19\u5024",_),u="(2D6<="+_+") \uff1e "+(s=(r=i.randomizer.$roll_barabara(2,6)).$sum())+"["+r.$join(",")+"] \uff1e "+s,o(y(s,2))?m("Result").$fumble(c(u," \uff1e \u30d5\u30a1\u30f3\u30d6\u30eb")):o(y(s,_))?m("Result").$success(c(u," \uff1e \u6210\u529f")):m("Result").$failure(c(u," \uff1e \u5931\u6557"))):e}),p(a,"$navigation_result",function(n){var i=this,$=e,t=e,_=e,r=e,s=e;return o($=/^NV(\+(\d+))?$/.$match(n))?(i.$debug("====navigation_result===="),t=$["$[]"](2).$to_i(),i.$debug("\u79fb\u52d5\u4fee\u6b63",t),_=i.randomizer.$roll_once(6),r=o(y(V(_,2).$to_i(),0))?1:V(_,2).$to_i(),s=c(r,t),i.$debug("\u79fb\u52d5\u30a8\u30ea\u30a2\u6570",s),m("Result").$new("\u822a\u884c\u30c1\u30a7\u30c3\u30af(\u6700\u4f4e1)\u3000(1D6/2+"+t+") \uff1e "+_+" /2+"+t+" \uff1e "+r+"+"+t+" \uff1e "+s+"\u30a8\u30ea\u30a2\u9032\u3080")):e}),R(S[0],"DIRECTION_INFOS",q(1,l(["name","position_diff"],{name:"\u5de6\u4e0b",position_diff:l(["x","y"],{x:-1,y:1})}),2,l(["name","position_diff"],{name:"\u4e0b",position_diff:l(["x","y"],{x:0,y:1})}),3,l(["name","position_diff"],{name:"\u53f3\u4e0b",position_diff:l(["x","y"],{x:1,y:1})}),4,l(["name","position_diff"],{name:"\u5de6",position_diff:l(["x","y"],{x:-1,y:0})}),6,l(["name","position_diff"],{name:"\u53f3",position_diff:l(["x","y"],{x:1,y:0})}),7,l(["name","position_diff"],{name:"\u5de6\u4e0a",position_diff:l(["x","y"],{x:-1,y:-1})}),8,l(["name","position_diff"],{name:"\u4e0a",position_diff:l(["x","y"],{x:0,y:-1})}),9,l(["name","position_diff"],{name:"\u53f3\u4e0a",position_diff:l(["x","y"],{x:1,y:-1})})).$freeze()),p(a,"$get_direction_info",function(n,i,$){var t=e;return null==$&&($=e),t=m("DIRECTION_INFOS")["$[]"](n.$to_i()),o(t["$nil?"]())?$:t["$[]"](i)},-3),p(a,"$get_fire_result",function(n){var i=this,$=e,t=e,_=e,r=e,s=e,u=e;return o($=/^D([12346789]*)(\[.+\])*\/(\d{1,2})(@([2468]))?$/.$match(n))?(i.$debug("====get_fire_result===="),t=$["$[]"](3).$to_i(),_=$["$[]"](1).$to_s(),r=$["$[]"](5).$to_i(),i.$debug("fire_count",t),i.$debug("fire_range",_),i.$debug("ballistics",r),s=i.$get_fire_point(_,t),u=[n,i.$get_fire_point_text(s,t).$text()],C(r,0)&&(u["$<<"]("\u300a\u5f3e\u9053\u5b66\u300b:"+i.$get_direction_info(r,"name","")+"\n"),u["$<<"](i.$get_fire_point_text(s,t,r).$text())),m("Result").$new(u.$join(" \uff1e "))):e}),p(a,"$get_fire_point",function(n,i){var $=this,t=e;return $.$debug("====get_fire_point===="),t=[],N(i,"times",[],function _(r){var u,g,s=null==_.$$s?this:_.$$s,v=e;return null==s.randomizer&&(s.randomizer=e),null==r&&(r=e),s.$debug("\n\u7832\u6483\u56de\u6570",c(r,1)),t["$<<"]([]),u=s.randomizer.$roll_once(6),g=s.randomizer.$roll_sum(2,6),v=[g,u],t["$[]"](-1)["$<<"](v),s.$debug("\u7740\u5f3e\u70b9",t),N(n,"chars",[],function b(h){var x=null==b.$$s?this:b.$$s,D=e;return null==h&&(h=e),x.$debug("\u7bc4\u56f2",h),D=x.$get_direction_info(h,"position_diff",l([],{})),v=[c(g,D["$[]"]("x").$to_i()),c(u,D["$[]"]("y").$to_i())],t["$[]"](-1)["$<<"](v),x.$debug("\u7740\u5f3e\u70b9:\u7bc4\u56f2",t)},{$$s:s})},{$$s:$}),$.$debug("\n\u6700\u7d42\u7740\u5f3e\u70b9",t),t}),p(a,"$get_fire_point_text",function(n,i,$){var _=e;return null==$&&($=0),this.$debug("====get_fire_point_text===="),_=[],N(n,"each",[],function r(s){var g=e;return null==s&&(s=e),g="",N(s,"each",[],function v(b,h){var x,D,j=null==v.$$s?this:v.$$s;return null==b&&(b=e),null==h&&(h=e),D=j.$get_move_point(b,h,$),x=T(D),g=c(g,o(j["$in_map_position?"](b=null==x[0]?e:x[0],h=null==x[1]?e:x[1]))?"[\u7e26"+h+",\u6a2a"+b+"]":"([\u7e26"+h+",\u6a2a"+b+"])"),j.$debug("\u7740\u5f3e\u70b9\u30c6\u30ad\u30b9\u30c8",g)},{$$s:null==r.$$s?this:r.$$s}),_["$<<"](g)},{$$s:this}),m("Result").$new(_.$join(","))},-3),p(a,"$in_map_position?",function(n,i){var $,t=e;return o($=o(t=y(1,i))?y(i,6):t)?o(t=y(2,n))?y(n,12):t:$}),p(a,"$get_move_point",function(n,i,$){var t=this,_=e;return t.$debug("====get_move_point===="),t.$debug("\u65b9\u5411",$),t.$debug("\u5ea7\u6a19\u79fb\u52d5\u524d(x,y)",n,i),_=t.$get_direction_info($,"position_diff",l([],{})),n=c(n,_["$[]"]("x").$to_i()),i=c(i,_["$[]"]("y").$to_i()),t.$debug("\n\u5ea7\u6a19\u79fb\u52d5\u5f8c(x,y)",n,i),[n,i]}),p(a,"$get_bomb_result",function(n){var i=this,$=e,t=e,_=e,r=e,s=e;return o($=/^BOM(\d*)?\/D([12346789]*)(\[.+\])*\/(\d+)(@([2468]))?$/i.$match(n))?(i.$debug("====get_bomb_result====",n),t=$["$[]"](1).$to_s(),_=$["$[]"](6).$to_i(),i.$debug("\u5f3e\u9053\u5b66\u65b9\u5411",_),r=i.$get_judge_result(c("SN",t)),o(r["$failure?"]())?(r["$text="](n+" \uff1e "+r.$text()),r):(s=n.$slice(/D([12346789]*)(\[.+\])*\/(\d+)(@([2468]))?/),r["$text="](n+" \uff1e "+r.$text()+"\n \uff1e "+i.$get_fire_result(s).$text()),r)):e}),p(a,"$get_avoid_result",function(n){var i=this,$=e,t=e,_=e,r=e,s=e,u=e,g=e;return o($=/^AVO(\d*)?(@([2468]))(\(?\[\u7e26\d+,\u6a2a\d+\]\)?,?)+$/.$match(n))?(i.$debug("====get_avoid_result====",n),t=$["$[]"](3).$to_i(),i.$debug("\u56de\u907f\u65b9\u5411",t),_=n.$slice(/^AVO(\d*)?(@([2468]))/),r=i.$get_judge_result(c("SN",m("Regexp").$last_match(1).$to_s())),o(r["$failure?"]())?(r["$text="](_+" \uff1e \u300a\u56de\u907f\u904b\u52d5\u300b"+r.$text()),r):(s=n.$slice(/(\(?\[\u7e26\d+,\u6a2a\d+\]\)?,?)+/),g=(u=i.$scan_fire_point(s)).$size(),m("Result").$success([_,"\u300a\u56de\u907f\u904b\u52d5\u300b"+r.$text()+"\n",s,c(c("\u300a\u56de\u907f\u904b\u52d5\u300b:",i.$get_direction_info(t,"name","")),"\n"),i.$get_fire_point_text(u,g,t).$text()].$compact().$join(" \uff1e ")))):e}),p(a,"$scan_fire_point",function(n){var $=e;return this.$debug("====scan_fire_point====",n),n=n.$gsub(/\(|\)/,""),$=[],N(n.$split(/\],/),"each",[],function t(_){var r=null==t.$$s?this:t.$$s;return null==_&&(_=e),r.$debug("point_text",_),$["$<<"]([]),N(_.$split(/\]/),"each",[],function s(u){var g=null==s.$$s?this:s.$$s,v=e,b=e;return null==u&&(u=e),g.$debug("point",u),$["$[]"](-1)["$<<"]([]),o(u["$=~"](/[^\d]*(\d+),[^\d]*(\d+)/))?(v=m("Regexp").$last_match(1).$to_i(),b=m("Regexp").$last_match(2).$to_i(),$["$[]"](-1)["$[]="](-1,[b,v]),g.$debug("\u7740\u5f3e\u70b9",$)):e},{$$s:r})},{$$s:this}),$})})}}]);