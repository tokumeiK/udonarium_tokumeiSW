(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7381],{517:(oe,le,_e)=>{_e(9993),Opal.modules["racc/parser"]=function(n){var F,J,B,K=n.module,E=n.klass,i=n.truthy,w=n.const_set,V=n.defs,S=n.gvars,M=n.rb_lt,U=n.def,z=n.to_ary,A=n.send,Q=n.neqeq,j=n.rb_plus,g=n.eqeq,v=n.rb_ge,X=n.rb_gt,m=n.rb_minus,O=n.rb_le,p=n.rb_times,c=n.assign_ivar_val,b=[],Y=n.$r(b),r=n.nil,Z=n.$$$;return F=b,J=[K(b[0],"Racc")].concat(F),B=n.$r(J),E(J[0],B("StandardError"),"ParseError"),i(Z("::","ParseError","skip_raise")?"constant":r)||w(b[0],"ParseError",Z(Y("Racc"),"ParseError")),function(ne,F){var h,u,N,d,f,B=[K(ne,"Racc")].concat(F),te=n.$r(B);return i(te("Racc_No_Extensions","skip_raise")?"constant":r)||w(B[0],"Racc_No_Extensions",!1),h=B,N=[u=E(B[0],null,"Parser")].concat(h),d=n.$r(N),(f=u.$$prototype).yydebug=f.racc_debug_out=f.racc_error_status=f.racc_t=f.racc_vstack=f.racc_val=f.racc_state=f.racc_tstack=r,w(N[0],"Racc_Runtime_Version","1.4.6"),w(N[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),w(N[0],"Racc_Runtime_Core_Version_R","1.4.6"),w(N[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),w(N[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),w(N[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),w(N[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),w(N[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),w(N[0],"Racc_Runtime_Type","ruby"),V(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")}),U(u,"$_racc_setup",function(){var t,_,e=this,o=r,$=r;return null==S.stderr&&(S.stderr=r),i(Z(e.$class(),"Racc_debug_parser"))||(e.yydebug=!1),i(null!=(t=e.yydebug)&&t!==r?"instance-variable":r)||(e.yydebug=!1),i(e.yydebug)&&(i(null!=(_=e.racc_debug_out)&&_!==r?"instance-variable":r)||(e.racc_debug_out=S.stderr),e.racc_debug_out=i(o=e.racc_debug_out)?o:S.stderr),$=Z(e.$class(),"Racc_arg"),i(M($.$size(),14))&&$["$[]="](13,!0),$}),U(u,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),U(u,"$do_parse",function(){return this.$__send__(d("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),U(u,"$next_token",function(){return this.$raise(d("NotImplementedError"),this.$class()+"#next_token is not defined")}),U(u,"$_racc_do_parse_rb",function(t,_){var e,$=this,R=r,q=r,y=r,H=r,k=r,l=r,C=r,D=r;return e=z(t),R=null==e[0]?r:e[0],q=null==e[1]?r:e[1],y=null==e[2]?r:e[2],H=null==e[3]?r:e[3],k=null==e[10]?r:e[10],$.$_racc_init_sysvars(),l=C=D=r,A($,"catch",["racc_end_parse"],function L(){var re,ee,T=null==L.$$s?this:L.$$s,ce=r;for(null==T.racc_state&&(T.racc_state=r),null==T.racc_read_next&&(T.racc_read_next=r),null==T.racc_t&&(T.racc_t=r),null==T.yydebug&&(T.yydebug=r),null==T.racc_val&&(T.racc_val=r);i(!0);)for(i(D=H["$[]"](T.racc_state["$[]"](-1)))?(i(T.racc_read_next)&&Q(T.racc_t,0)&&(ee=T.$next_token(),re=z(ee),l=null==re[0]?r:re[0],T.racc_val=null==re[1]?r:re[1],T.racc_t=i(l)?i(ce=k["$[]"](l))?ce:1:0,i(T.yydebug)&&T.$racc_read_token(T.racc_t,l,T.racc_val),T.racc_read_next=!1),D=j(D,T.racc_t),i(v(D,0))&&i(C=R["$[]"](D))&&g(q["$[]"](D),T.racc_state["$[]"](-1))||(C=y["$[]"](T.racc_state["$[]"](-1)))):C=y["$[]"](T.racc_state["$[]"](-1));i(C=T.$_racc_evalact(C,t)););},{$$s:$})}),U(u,"$yyparse",function(t,_){return this.$__send__(d("Racc_YY_Parse_Method"),t,_,this.$_racc_setup(),!0)}),U(u,"$_racc_yyparse_rb",function(t,_,e,o){var $,q=this,y=r,H=r,P=r,k=r,C=r,D=r,L=r;return $=z(e),y=null==$[0]?r:$[0],H=null==$[1]?r:$[1],P=null==$[2]?r:$[2],k=null==$[3]?r:$[3],C=null==$[10]?r:$[10],q.$_racc_init_sysvars(),D=r,L=r,A(q,"catch",["racc_end_parse"],function re(){var ee=null==re.$$s?this:re.$$s;for(null==ee.racc_state&&(ee.racc_state=r);!i(L=k["$[]"](ee.racc_state["$[]"](-1)));)for(;i(D=ee.$_racc_evalact(P["$[]"](ee.racc_state["$[]"](-1)),e)););return A(t,"__send__",[_],function T(ce,ae){var W=null==T.$$s?this:T.$$s,ue=r,ie=r;for(null==W.racc_t&&(W.racc_t=r),null==W.racc_state&&(W.racc_state=r),null==W.racc_read_next&&(W.racc_read_next=r),null==ce&&(ce=r),null==ae&&(ae=r),W.racc_t=i(ce)?i(ue=C["$[]"](ce))?ue:1:0,W.racc_val=ae,W.racc_read_next=!1,L=j(L,W.racc_t),i(v(L,0))&&i(D=y["$[]"](L))&&g(H["$[]"](L),W.racc_state["$[]"](-1))||(D=P["$[]"](W.racc_state["$[]"](-1)));i(D=W.$_racc_evalact(D,e)););for(;i(i(ue=i(ie=(L=k["$[]"](W.racc_state["$[]"](-1)))["$!"]())?ie:W.racc_read_next["$!"]())?ue:W.racc_t["$=="](0));)for(i(L)&&i(L=j(L,W.racc_t))&&i(v(L,0))&&i(D=y["$[]"](L))&&g(H["$[]"](L),W.racc_state["$[]"](-1))||(D=P["$[]"](W.racc_state["$[]"](-1)));i(D=W.$_racc_evalact(D,e)););},{$$s:ee})},{$$s:q})}),U(u,"$_racc_evalact",function(t,_){var e,P,$=this,R=r,q=r,H=r,k=r,l=r,C=r;if(R=null==(e=z(_))[0]?r:e[0],q=null==e[1]?r:e[1],H=null==e[3]?r:e[3],P=null==e[11]?r:e[11],k=null==e[12]?r:e[12],i(X(t,0))&&i(M(t,P)))i(X($.racc_error_status,0))&&(g($.racc_t,1)||($.racc_error_status=m($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(t),$.racc_read_next=!0,i($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(i(M(t,0))&&i(X(t,k["$-@"]()))){if(l=A($,"catch",["racc_jump"],function D(){var L=null==D.$$s?this:D.$$s;return null==L.racc_state&&(L.racc_state=r),L.racc_state.$push(L.$_racc_do_reduce(_,t)),!1},{$$s:$}),i(l))switch(l){case 1:return $.racc_user_yyerror=!0,k["$-@"]();case 2:return P;default:$.$raise("[Racc Bug] unknown jump code")}}else if(g(t,P))i($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(g(t,k["$-@"]())){switch($.racc_error_status){case 0:i(_["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:g($.racc_t,0)&&$.$throw("racc_end_parse",r),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;i(!0)&&!(i(C=H["$[]"]($.racc_state["$[]"](-1)))&&(C=j(C,1),i(v(C,0))&&i(t=R["$[]"](C))&&g(q["$[]"](C),$.racc_state["$[]"](-1))));)i(O($.racc_state.$size(),1))&&$.$throw("racc_end_parse",r),$.racc_state.$pop(),$.racc_vstack.$pop(),i($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return t}$.$raise("[Racc Bug] unknown action "+t.$inspect())}return i($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),r}),U(u,"$_racc_do_reduce",function(t,_){var e,k,C,ce,ae,W,$e,$=this,q=r,y=r,H=r,P=r,l=r,D=r,L=r,re=r,ee=r,T=r,ue=r,ie=r,se=r;return q=null==(e=z(t))[4]?r:e[4],y=null==e[5]?r:e[5],H=null==e[6]?r:e[6],P=null==e[7]?r:e[7],k=null==e[8]?r:e[8],l=null==e[9]?r:e[9],C=null==e[13]?r:e[13],D=$.racc_state,L=$.racc_vstack,re=$.racc_tstack,ee=p(_,-3),T=l["$[]"](ee),ce=l["$[]"](j(ee,1)),ae=l["$[]"](j(ee,2)),W=[],i($.yydebug)&&(ue=re["$[]"](T["$-@"](),T)),ie=L["$[]"](T["$-@"](),T),i($.yydebug)&&re["$[]="](T["$-@"](),T,W),L["$[]="](T["$-@"](),T,W),D["$[]="](T["$-@"](),T,W),i(C)?L.$push($.$__send__(ae,ie,L,ie["$[]"](0))):L.$push($.$__send__(ae,ie,L)),re.$push(ce),i($.yydebug)&&$.$racc_reduce(ue,ce,re,L),$e=m(ce,k),i(ee=P["$[]"]($e))&&(ee=j(ee,D["$[]"](-1)),i(v(ee,0))&&i(se=q["$[]"](ee))&&g(y["$[]"](ee),$e))?se:H["$[]"]($e)}),U(u,"$on_error",function(t,_,e){var $,o=this;return o.$raise(d("ParseError"),o.$sprintf("\nparse error on value %s (%s)",_.$inspect(),i($=o.$token_to_str(t))?$:"?"))}),U(u,"$yyerror",function(){return this.$throw("racc_jump",1)}),U(u,"$yyaccept",function(){return this.$throw("racc_jump",2)}),U(u,"$yyerrok",c("racc_error_status",0)),U(u,"$racc_read_token",function(t,_,e){var o=this;return o.racc_debug_out.$print("read    "),o.racc_debug_out.$print(_.$inspect(),"(",o.$racc_token2str(t),") "),o.racc_debug_out.$puts(e.$inspect()),o.racc_debug_out.$puts()}),U(u,"$racc_shift",function(t,_,e){var o=this;return o.racc_debug_out.$puts("shift   "+o.$racc_token2str(t)),o.$racc_print_stacks(_,e),o.racc_debug_out.$puts()}),U(u,"$racc_reduce",function(t,_,e,o){var $=this,R=r;return(R=$.racc_debug_out).$print("reduce "),i(t["$empty?"]())?R.$print(" <none>"):A(t,"each",[],function q(y){return null==y&&(y=r),R.$print(" ",(null==q.$$s?this:q.$$s).$racc_token2str(y))},{$$s:$}),R.$puts(" --\x3e "+$.$racc_token2str(_)),$.$racc_print_stacks(e,o),$.racc_debug_out.$puts()}),U(u,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),U(u,"$racc_e_pop",function(t,_,e){var o=this;return o.racc_debug_out.$puts("error recovering mode: pop token"),o.$racc_print_states(t),o.$racc_print_stacks(_,e),o.racc_debug_out.$puts()}),U(u,"$racc_next_state",function(t,_){var e=this;return e.racc_debug_out.$puts("goto    "+t),e.$racc_print_states(_),e.racc_debug_out.$puts()}),U(u,"$racc_print_stacks",function(t,_){var o=r;return(o=this.racc_debug_out).$print("        ["),A(t,"each_index",[],function $(R){return null==R&&(R=r),o.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(t["$[]"](R))," ",_["$[]"](R).$inspect(),")")},{$$s:this}),o.$puts(" ]")}),U(u,"$racc_print_states",function(t){var e=r;return(e=this.racc_debug_out).$print("        ["),A(t,"each",[],function($){return null==$&&($=r),e.$print(" ",$)}),e.$puts(" ]")}),U(u,"$racc_token2str",function(t){var e;return i(e=Z(this.$class(),"Racc_token_to_s_table")["$[]"](t))?e:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),U(u,"$token_to_str",function(t){return Z(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(b[0],b)},Opal.modules.strscan=function(n){var g,v,X,m,O,E=n.def,i=n.truthy,w=n.eqeqeq,V=n.Opal,S=n.return_ivar,M=n.send,U=n.alias,z=[],A=n.nil;return g=z,X=[v=(0,n.klass)(z[0],null,"StringScanner")].concat(g),m=n.$r(X),(O=v.$$prototype).pos=O.string=O.working=O.matched=O.prev_pos=O.match=A,v.$attr_reader("pos","matched"),E(v,"$initialize",function(c){var s=this;return s.string=c,s.pos=0,s.matched=A,s.working=c,s.match=[]}),v.$attr_reader("string"),E(v,"$beginning_of_line?",function(){var c=this;return 0===c.pos||"\n"===c.string.charAt(c.pos-1)}),E(v,"$scan",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return null==b?s.matched=A:(s.prev_pos=s.pos,s.pos+=b[0].length,s.working=s.working.substring(b[0].length),s.matched=b[0],s.match=b,b[0])}),E(v,"$scan_until",function(c){var s=this;c=s.$anchor(c);for(var b=s.working,Y=0;b.length!=Y;++Y){var r=c.exec(b.substr(Y));if(null!==r){var Z=Y+r[0].length,ne=b.substr(0,Z);return s.matched=r[0],s.match=r,s.prev_pos=s.pos+Y,s.pos+=Z,s.working=b.substr(Z),ne}}return s.matched=A}),E(v,"$[]",function(c){var b;if(i(this.match["$empty?"]()))return A;w(m("Symbol"),b=c)?c=c.$to_s():w(m("String"),b)||(c=V["$coerce_to!"](c,m("Integer"),"to_int"));var Y=this.match;return c<0&&(c+=Y.length),c<0||c>=Y.length||null==Y[c]?A:Y[c]}),E(v,"$check",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return s.matched=null==b?A:b[0]}),E(v,"$check_until",function(c){var s=this,b=s.prev_pos,Y=s.pos,r=s.working,Z=s.$scan_until(c);return s.prev_pos=b,s.pos=Y,s.working=r,Z}),E(v,"$peek",function(c){return this.working.substring(0,c)}),E(v,"$eos?",function(){return 0===this.working.length}),E(v,"$exist?",function(c){var b=c.exec(this.working);return null==b?A:0==b.index?0:b.index+1}),E(v,"$skip",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);if(null==b)return s.match=[],s.matched=A;var Y=b[0],r=Y.length;return s.matched=Y,s.match=b,s.prev_pos=s.pos,s.pos+=r,s.working=s.working.substring(r),r}),E(v,"$skip_until",function(c){var b=this.$scan_until(c);return b===A?A:(this.matched=b.substr(-1),b.length)}),E(v,"$get_byte",function(){var c=this,s=A;return c.pos<c.string.length?(c.prev_pos=c.pos,c.pos+=1,s=c.matched=c.working.substring(0,1),c.working=c.working.substring(1)):c.matched=A,s}),E(v,"$match?",function(c){var s=this,b=(c=s.$anchor(c)).exec(s.working);return null==b?A:(s.prev_pos=s.pos,b[0].length)}),E(v,"$pos=",function(c){var s=this;return c<0&&(c+=s.string.$length()),s.pos=c,s.working=s.string.slice(c)}),E(v,"$matched_size",function(){return this.matched===A?A:this.matched.length}),E(v,"$post_match",function(){var c=this;return c.matched===A?A:c.string.substr(c.pos)}),E(v,"$pre_match",function(){var c=this;return c.matched===A?A:c.string.substr(0,c.prev_pos)}),E(v,"$reset",function(){var c=this;return c.working=c.string,c.matched=A,c.pos=0}),E(v,"$rest",S("working")),E(v,"$rest?",function(){return 0!==this.working.length}),E(v,"$rest_size",function(){return this.$rest().$size()}),E(v,"$terminate",function(){var c,s=this;return s.match=A,c=[s.string.$length()],M(s,"pos=",c),c[c.length-1]}),E(v,"$unscan",function(){var c=this;return c.pos=c.prev_pos,c.prev_pos=A,c.match=A,c}),U(v,"bol?","beginning_of_line?"),U(v,"getch","get_byte"),v.$private(),E(v,"$anchor",function(c){var s=c.toString().match(/\/([^\/]+)$/);return s=s?s[1]:void 0,new RegExp("^(?:"+c.source+")",s)})},Opal.modules["bcdice/normalize"]=function(n){var U,j,A,K=n.module,E=n.eqeqeq,i=n.def,w=n.eqeq,V=[],S=n.nil;return U=V,A=[K(V[0],"BCDice")].concat(U),(j=K(A[0],"Normalize")).$module_function(),i(j,"$comparison_operator",function(v){var X;return E(/<=|=</,X=v)?"<=":E(/>=|=>/,X)?">=":E(/<>|!=|=!/,X)?"!=":E(/</,X)?"<":E(/>/,X)?">":E(/=/,X)?"==":S}),i(j,"$target_number",function(v){return w(v,"?")?v:v.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(n){var Q,X,s,b,Y,r,O,g,K=n.module,E=n.klass,i=n.const_set,w=n.hash2,V=n.truthy,S=n.def,M=n.top,U=[],z=n.nil;return M.$require("strscan"),M.$require("bcdice/normalize"),Q=U,X=g=[K(U[0],"BCDice")].concat(Q),s=O=[K(g[0],"CommonCommand")].concat(X),Y=[b=E(O[0],null,"Lexer")].concat(s),r=n.$r(Y),b.$$prototype.scanner=z,i(Y[0],"SYMBOLS",w(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),S(b,"$initialize",function(F){var J;return F=V(J=F.$split(" ",2).$first())?J:"",this.scanner=r("StringScanner").$new(F)}),S(b,"$next_token",function(){var F=this,G=z,J=z,B=z,x=z;return V(F.scanner["$eos?"]())?[!1,"$"]:V(G=F.scanner.$scan(/\d+/))?["NUMBER",G.$to_i()]:V(J=F.scanner.$scan(/[<>!=]+/))?["CMP_OP",r("Normalize").$comparison_operator(J)]:(B=F.scanner.$getch().$upcase(),[V(x=r("SYMBOLS")["$[]"](B))?x:B.$to_sym(),B])}),S(b,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(n){var p,Y,F,te,N,d,f,a,t,I,J,Z,s,K=n.module,E=n.klass,i=n.ensure_kwargs,w=n.get_kwarg,V=n.def,S=n.truthy,M=n.send,U=n.thrower,z=n.rb_lt,A=n.rb_plus,Q=n.rb_gt,j=n.eqeq,g=n.rb_le,v=n.rb_ge,X=[],m=n.nil;return p=X,Y=s=[K(X[0],"BCDice")].concat(p),F=Z=[K(s[0],"CommonCommand")].concat(Y),te=J=[K(Z[0],"RerollDice")].concat(F),N=I=[K(J[0],"Node")].concat(te),f=[d=E(I[0],null,"Command")].concat(N),a=n.$r(f),(t=d.$$prototype).cmp_op=t.reroll_cmp_op=t.target_number_node=t.reroll_threshold_node=t.notations=t.source=m,V(d,"$initialize",function(e){var o,$,R,q,y,H,P,k=this;return e=i(e),o=w(e,"secret"),$=w(e,"notations"),R=w(e,"source"),null==(q=e.$$smap.cmp_op)&&(q=m),null==(y=e.$$smap.target_number)&&(y=m),null==(H=e.$$smap.reroll_cmp_op)&&(H=m),null==(P=e.$$smap.reroll_threshold)&&(P=m),k.secret=o,k.notations=$,k.cmp_op=q,k.target_number_node=y,k.reroll_cmp_op=H,k.reroll_threshold_node=P,k.source=R}),V(d,"$eval",function(e,o){try{U("eval_return");var R,q,H,P,l,D,L,ee,y=this,k=m,C=m,re=m,T=m,ce=m,ae=m,W=m,ue=m;return H=e.$round_type(),P=S(k=y.cmp_op)?k:e.$default_cmp_op(),l=S(k=S(C=y.reroll_cmp_op)?C:P)?k:">=",D=S(k=(R=y.target_number_node)===m||null==R?m:R.$eval(H))?k:e.$default_target_number(),L=S(k=S(C=(q=y.reroll_threshold_node)===m||null==q?m:q.$eval(H))?C:e.$reroll_dice_reroll_threshold())?k:D,re=a("RerollCondition").$new(l,L),ee=M(y.notations,"map",[],function($e){return null==$e&&($e=m),$e.$to_dice(H)}),S(M(ee,"all?",[],function($e){return null==$e&&($e=m),re["$valid?"]($e.$sides())}))?(ce=(T=y.$roll(ee,o,re,e["$sort_barabara_dice?"]())).$flatten(),ae=T.$take(y.notations.$size()).$flatten().$count(1),W=S(P)?M(ce,"count",[],function($e){return null==$e&&($e=m),$e.$send(P,D)}):0,ue=[y.$expr(H,re,P,D),M(T,"map",[],function($e){return null==$e&&($e=m),$e.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+W,e.$grich_text(ae,ce.$size(),W)].$compact(),y.$result_with_text(ue.$join(" \uff1e "))):y.$result_with_text(y.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(ie){if(ie===n.t_eval_return)return ie.$v;throw ie}}),d.$private(),V(d,"$roll",function(e,o,$,R){var q=m,y=m,H=m,P=m,k=m,l=m;for(q=[],y=0;S(S(H=e["$empty?"]()["$!"]())?z(y,a("REROLL_LIMIT")):H);)P=e.$shift(),y=A(y,1),k=P.$roll(o),S(R)&&k["$sort!"](),q.$push(k),l=M(k,"count",[],function(D){return null==D&&(D=m),$["$reroll?"](D)}),S(Q(l,0))&&e.$push(a("Dice").$new(l,P.$sides()));return q}),V(d,"$expr",function(e,o,$,R){var y,H,P;return y=M(this.notations,"map",[],function(l){return null==l&&(l=m),l.$to_dice(e)}).$join("+"),H=j(o.$cmp_op(),$)?"":a("Format").$comparison_operator(o.$cmp_op()),P=a("Format").$comparison_operator($),"("+y+"["+H+o.$threshold()+"]"+P+R+")"}),V(d,"$result_with_text",function(e){return M(a("Result").$new(),"tap",[],function $(R){var q,y=null==$.$$s?this:$.$$s;return null==y.secret&&(y.secret=m),null==R&&(R=m),R["$secret="](y.secret),M(R,"text=",q=[e]),q[q.length-1]},{$$s:this})}),function(h,u){var N=E(h,null,"RerollCondition"),d=N.$$prototype;d.threshold=d.cmp_op=m,N.$attr_reader("cmp_op"),N.$attr_reader("threshold"),V(N,"$initialize",function(a,t){return this.cmp_op=a,this.threshold=t}),V(N,"$valid?",function(a){var t=this;if(!S(t.threshold))return!1;switch(t.cmp_op){case"<=":return z(t.threshold,a);case"<":return g(t.threshold,a);case">=":return Q(t.threshold,1);case">":return v(t.threshold,1);case"!=":return n.Range.$new(1,a,!1)["$include?"](t.threshold);default:return!0}}),V(N,"$reroll?",function(a){return a.$send(this.cmp_op,this.threshold)})}(I[0]),function(h,u,N){var d=E(h,null,"Notation"),f=[d].concat(N),a=n.$r(f),t=d.$$prototype;t.times=t.sides=m,V(d,"$initialize",function(e,o){return this.times=e,this.sides=o}),V(d,"$to_dice",function(e){try{var R,q;return U("eval_return"),R=this.times.$eval(e),q=this.sides.$eval(e),a("Dice").$new(R,q)}catch(y){if(y===n.t_eval_return)return y.$v;throw y}})}(I[0],0,I),function(h,u){var N=E(h,null,"Dice");return N.$attr_reader("times","sides"),V(N,"$initialize",function(f,a){return this.times=f,this.sides=a}),V(N,"$roll",function(f){return f.$roll_barabara(this.$times(),this.$sides())}),V(N,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(I[0])},Opal.modules["bcdice/arithmetic/node"]=function(n){var c,r,G,h,u,B,te,ne,b,K=n.module,E=n.klass,i=n.def,w=n.thrower,V=n.return_ivar,S=n.send2,M=n.find_super,U=n.eqeq,z=n.const_set,A=n.eqeqeq,Q=n.rb_divide,j=n.truthy,g=n.assign_ivar,v=n.alias,X=[],m=n.nil,O=n.$$$;return c=X,r=b=[K(X[0],"BCDice")].concat(c),G=ne=[K(b[0],"Arithmetic")].concat(r),B=[K(ne[0],"Node")].concat(G),te=n.$r(B),(u=(h=E(B[0],null,"BinaryOp")).$$prototype).lhs=u.rhs=u.op=m,i(h,"$initialize",function(d,f,a){var t=this;return t.lhs=d,t.op=f,t.rhs=a}),i(h,"$eval",function(d){try{w("eval_return");var _,a=this,t=m;return t=a.lhs.$eval(d),_=a.rhs.$eval(d),t.$send(a.op,_)}catch(e){if(e===n.t_eval_return)return e.$v;throw e}}),i(h,"$output",function(){var d=this;return""+d.lhs.$output()+d.op+d.rhs.$output()}),i(h,"$s_exp",function(){var d=this;return"("+d.$op_for_s_exp()+" "+d.lhs.$s_exp()+" "+d.rhs.$s_exp()+")"}),i(h,"$op_for_s_exp",V("op")),function(x,I,h){var u=E(x,I,"DivideBase"),N=[u].concat(h),d=n.$r(N),f=u.$$prototype;f.lhs=f.rhs=f.op=m,i(u,"$initialize",function a(t,_){return a.$$p=null,S(this,M(this,"initialize",a,!1,!0),"initialize",[t,"/",_],null)}),i(u,"$eval",function(t){try{w("eval_return");var o,$,e=this;return o=e.lhs.$eval(t),$=e.rhs.$eval(t),U($,0)&&e.$raise(d("ZeroDivisionError")),e.$divide_and_round(o,$,t)}catch(R){if(R===n.t_eval_return)return R.$v;throw R}}),i(u,"$output",function a(){var t=a.$$p||m,_=this;return a.$$p=null,""+S(_,M(_,"output",a,!1,!0),"output",[],t)+_.$rounding_method()}),u.$private(),i(u,"$rounding_method",function(){return O(this.$class(),"ROUNDING_METHOD")}),i(u,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),i(u,"$divide_and_round",function(t,_,e){return this.$raise(d("NotImplementedError"))})}(B[0],te("BinaryOp"),B),function(x,I,h){var u=E(x,I,"DivideWithGameSystemDefault"),N=[u].concat(h),d=n.$r(N);z(N[0],"ROUNDING_METHOD",""),u.$private(),i(u,"$divide_and_round",function(a,t,_){var e,o=m;return A(O(d("RoundType"),"CEIL"),e=_)?Q(a.$to_f(),t).$ceil():A(O(d("RoundType"),"ROUND"),e)?(o=Q(a.$to_f(),t),j(o["$negative?"]())?o.$abs().$round()["$-@"]():o.$round()):Q(a,t).$floor()})}(B[0],te("DivideBase"),B),function(x,I,h){var u=E(x,I,"DivideWithCeil"),N=[u].concat(h);z(N[0],"ROUNDING_METHOD","C"),u.$private(),i(u,"$divide_and_round",function(f,a,t){return Q(f.$to_f(),a).$ceil()})}(B[0],te("DivideBase"),B),function(x,I,h){var u=E(x,I,"DivideWithRound"),N=[u].concat(h);z(N[0],"ROUNDING_METHOD","R"),u.$private(),i(u,"$divide_and_round",function(f,a,t){var _=m;return _=Q(f.$to_f(),a),j(_["$negative?"]())?_.$abs().$round()["$-@"]():_.$round()})}(B[0],te("DivideBase"),B),function(x,I,h){var u=E(x,I,"DivideWithFloor"),N=[u].concat(h);z(N[0],"ROUNDING_METHOD","F"),u.$private(),i(u,"$divide_and_round",function(f,a,t){return Q(f,a).$floor()})}(B[0],te("DivideBase"),B),function(x,I){var h=E(x,null,"Negative");h.$$prototype.body=m,i(h,"$initialize",g("body")),i(h,"$eval",function(d){try{return w("eval_return"),this.body.$eval(d)["$-@"]()}catch(t){if(t===n.t_eval_return)return t.$v;throw t}}),i(h,"$output",function(){return"-"+this.body.$output()}),i(h,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(B[0]),function(x,I){var h=E(x,null,"Parenthesis");h.$$prototype.expr=m,i(h,"$initialize",g("expr")),i(h,"$eval",function(d){try{return w("eval_return"),this.expr.$eval(d)}catch(t){if(t===n.t_eval_return)return t.$v;throw t}}),i(h,"$output",function(){return"("+this.expr.$output()+")"}),i(h,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(B[0]),function(x,I){var h=E(x,null,"Number");return h.$$prototype.value=m,i(h,"$initialize",g("value")),i(h,"$eval",V("value")),i(h,"$output",function(){return this.value.$to_s()}),v(h,"s_exp","output")}(B[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(n){var m,s,Z,te,u,N,d,f,a,t,_,e,o,q,x,I,h,F,G,Y,p,K=n.module,E=n.klass,i=n.defs,w=n.def,V=n.hash,S=n.const_set,M=n.hash2,U=n.return_val,z=n.to_ary,A=n.truthy,Q=n.top,j=[],g=n.nil,v=n.$$$;return Q.$require("racc/parser.rb"),Q.$require("bcdice/common_command/lexer"),Q.$require("bcdice/common_command/reroll_dice/node"),Q.$require("bcdice/arithmetic/node"),m=j,s=p=[K(j[0],"BCDice")].concat(m),Z=Y=[K(p[0],"CommonCommand")].concat(s),F=[K(Y[0],"BarabaraDice")].concat(Z),G=n.$r(F),te=F,I=[x=E(F[0],v(G("Racc"),"Parser"),"Parser")].concat(te),h=n.$r(I),x.$$prototype.lexer=g,i(x,"$parse",function(l){return this.$new().$parse(l)}),w(x,"$parse",function(l){try{return this.lexer=h("Lexer").$new(l),this.$do_parse()}catch(D){if(!n.rescue(D,[h("ParseError")]))throw D;try{return g}finally{n.pop_exception()}}}),x.$private(),w(x,"$next_token",function(){return this.lexer.$next_token()}),u=n.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),N=n.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),d=n.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),f=n.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),a=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],t=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],_=[g,1,4,8,11,-5,0,-2,-16,-13,-17],e=[g,g,g,g,g,g,g,20,16,17,g],o=n.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),q=V(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),S(I[0],"Racc_arg",[u,N,f,d,a,t,e,_,23,o,q,40,25,!0]),S(I[0],"Racc_token_to_s_table",n.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),S(I[0],"Racc_debug_parser",!1),w(x,"$_reduce_1",function(l,C,D){return v(h("Node"),"Command").$new(M(["secret","notations","cmp_op","target_number"],{secret:l["$[]"](0),notations:l["$[]"](1),cmp_op:l["$[]"](2)["$[]"]("cmp_op"),target_number:l["$[]"](2)["$[]"]("target")}))}),w(x,"$_reduce_2",U(!1)),w(x,"$_reduce_3",U(!0)),w(x,"$_reduce_4",function(l,C,D){return M([],{})}),w(x,"$_reduce_5",function(l,C,D){var L,T,ce;return ce=null==(L=z(l))[1]?g:L[1],A(T=null==L[0]?g:L[0])||this.$raise(h("ParseError")),M(["cmp_op","target"],{cmp_op:T,target:ce})}),w(x,"$_reduce_6",function(l,C,D){var L=g;return(L=l["$[]"](0)).$push(l["$[]"](2)),L}),w(x,"$_reduce_7",function(l,C,D){return[l["$[]"](0)]}),w(x,"$_reduce_8",function(l,C,D){var L,re;return L=l["$[]"](0),re=l["$[]"](2),v(h("Node"),"Notation").$new(L,re)}),w(x,"$_reduce_9",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"+",l["$[]"](2))}),w(x,"$_reduce_10",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"-",l["$[]"](2))}),w(x,"$_reduce_12",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"*",l["$[]"](2))}),w(x,"$_reduce_13",function(l,C,D){return l["$[]"](3).$new(l["$[]"](0),l["$[]"](2))}),w(x,"$_reduce_15",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(x,"$_reduce_16",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"DivideWithCeil")}),w(x,"$_reduce_17",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"DivideWithCeil")}),w(x,"$_reduce_18",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"DivideWithRound")}),w(x,"$_reduce_19",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"DivideWithFloor")}),w(x,"$_reduce_20",function(l,C,D){return l["$[]"](1)}),w(x,"$_reduce_21",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"Negative").$new(l["$[]"](1))}),w(x,"$_reduce_23",function(l,C,D){return l["$[]"](1)}),w(x,"$_reduce_24",function(l,C,D){return v(v(h("Arithmetic"),"Node"),"Number").$new(l["$[]"](0))}),w(x,"$_reduce_none",function(l,C,D){return l["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(n){var z,g,O,s,Y,r,p,c,X,Q,K=n.module,E=n.const_set,i=n.thrower,w=n.def,S=[],M=n.nil;return n.top.$require("bcdice/common_command/barabara_dice/parser"),z=S,g=Q=[K(S[0],"BCDice")].concat(z),O=X=[K(Q[0],"CommonCommand")].concat(g),E((c=[p=K(X[0],"BarabaraDice")].concat(O))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),Y=[s=n.get_singleton_class(p)].concat(c),r=n.$r(Y),w(s,"$eval",function(ne,F,G){try{var B;return i("eval_return"),(B=r("Parser").$parse(ne))===M||null==B?M:B.$eval(F,G)}catch(x){if(x===n.t_eval_return)return x.$v;throw x}})},Opal.modules["bcdice/dice_table/table"]=function(n){var Q,X,s,b,Y,r,Z,O,g,K=n.module,E=n.klass,i=n.hash2,w=n.defs,V=n.truthy,S=n.def,M=n.rb_minus,U=[],z=n.nil;return Q=U,X=g=[K(U[0],"BCDice")].concat(Q),s=O=[K(g[0],"DiceTable")].concat(X),Y=[b=E(O[0],null,"Table")].concat(s),r=n.$r(Y),(Z=b.$$prototype).times=Z.sides=Z.name=Z.items=z,w(b,"$from_i18n",function(F,G){var B=z;return B=r("I18n").$t(F,i(["locale"],{locale:G})),this.$new(B["$[]"]("name"),B["$[]"]("type"),B["$[]"]("items"))}),S(b,"$initialize",function(F,G,J){var B=this,te=z;return B.name=F,B.items=J.$freeze(),te=/(\d+)D(\d+)/i.$match(G),V(te)||B.$raise(r("ArgumentError"),"Unexpected table type: "+G),B.times=te["$[]"](1).$to_i(),B.sides=te["$[]"](2).$to_i()}),S(b,"$roll",function(F){var J,G=this;return J=F.$roll_sum(G.times,G.sides),G.$choice(J)}),S(b,"$choice",function(F){var J,G=this;return J=M(F,G.times),r("RollResult").$new(G.name,F,G.items["$[]"](J))})},Opal.queue(function(n){var b,ne,x,I,h,u,G,J,r,K=n.module,E=n.klass,i=n.const_set,w=n.send2,V=n.find_super,S=n.def,M=n.regexp,U=n.hash2,z=n.truthy,A=n.eqeqeq,Q=n.rb_gt,j=n.thrower,g=n.rb_ge,v=n.send,X=n.rb_plus,m=n.top,O=[],p=n.nil,c=n.$$$;return m.$require("bcdice/common_command/barabara_dice"),m.$require("bcdice/dice_table/table"),b=O,ne=r=[K(O[0],"BCDice")].concat(b),G=[K(r[0],"GameSystem")].concat(ne),J=n.$r(G),x=G,h=[I=E(G[0],J("Base"),"NinjaSlayer")].concat(x),u=n.$r(h),I.$$prototype.randomizer=p,i(h[0],"ID","NinjaSlayer"),i(h[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"),i(h[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG"),i(h[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000NJ\n\u3000NJx[y] or NJx@y or NJx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:NJ4@H \u96e3\u6613\u5ea6HARD\u3001\u5224\u5b9a\u30c0\u30a4\u30b94\u3067\u5224\u5b9a\n\u30fb\u56de\u907f\u5224\u5b9a\u3000EV\n\u3000EVx[y]/z or EVx@y/z or EVx/z or EVx[y] or EVx@y or EVx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 z=\u653b\u6483\u5074\u306e\u6210\u529f\u6570(\u7701\u7565\u53ef) \u96e3\u6613\u5ea6\u3092\u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u653b\u6483\u5074\u306e\u6210\u529f\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:EV5/3 \u96e3\u6613\u5ea6NORMAL(\u7701\u7565\u6642)\u3001\u5224\u5b9a\u30c0\u30a4\u30b95\u3001\u653b\u6483\u5074\u306e\u6210\u529f\u65703\u3067\u5224\u5b9a\n\u30fb\u8fd1\u63a5\u653b\u6483\u3000AT\n\u3000ATx[y] or ATx@y or ATx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4) \u30b5\u30c4\u30d0\u30c4\uff01\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:AT6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u8fd1\u63a5\u653b\u6483\u306e\u5224\u5b9a\n\u30fb\u30b5\u30c4\u30d0\u30c4\u5224\u5b9a\u3000SB\n\u30fb\u96fb\u5b50\u6226\u3000EL\n\u3000ELx[y] or ELx@y or ELx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:EL6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u96fb\u5b50\u6226\u306e\u5224\u5b9a\n\n\u30fb\u96e3\u6613\u5ea6\n\u3000KIDS=K,EASY=E,NORMAL=N,HARD=H,ULTRA HARD=UH \u6570\u5b57\u306b\u3082\u5bfe\u5fdc\n"),S(I,"$initialize",function d(f){var t=this;return d.$$p=null,w(t,V(t,"initialize",d,!1,!0),"initialize",[f],null),t.default_cmp_op=">=",t.default_target_number=4}),i(h[0],"DIFFICULTY_VALUE_RE","UH|[2-6KENH]".$freeze()),i(h[0],"DIFFICULTY_RE",("(\\[("+u("DIFFICULTY_VALUE_RE")+")\\]|@("+u("DIFFICULTY_VALUE_RE")+"))").$freeze()),i(h[0],"NJ_RE",M(["^(S)?NJ(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(h[0],"EV_RE",M(["^EV(\\d+)",u("DIFFICULTY_RE"),"?(?:/(\\d+))?$"],"i").$freeze()),i(h[0],"AT_RE",M(["^AT(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(h[0],"EL_RE",M(["^EL(\\d+)",u("DIFFICULTY_RE"),"?$"],"i").$freeze()),i(h[0],"EV",u("Struct").$new("num","difficulty","targetValue")),i(h[0],"AT",u("Struct").$new("num","difficulty")),i(h[0],"EL",u("Struct").$new("num","difficulty")),i(h[0],"DIFFICULTY_SYMBOL_TO_INTEGER",U(["K","E","N","H","UH"],{K:2,E:3,N:4,H:5,UH:6}).$freeze()),S(I,"$change_text",function(f){var t=p,_=p,e=p;return t=u("NJ_RE").$match(f),z(t)?(_=this.$bRollCommand(t["$[]"](2),this.$integerValueOfDifficulty(z(e=t["$[]"](4))?e:t["$[]"](5))),""+t["$[]"](1)+_):f}),S(I,"$eval_game_system_specific_command",function(f){var a=this,t=p,_=p,e=p;return a.$debug("eval_game_system_specific_command begin string",f),z(t=u("TABLES")["$[]"](f))?t.$roll(a.$randomizer()):A(u("EV"),_=e=a.$parse(f))?a.$executeEV(e):A(u("AT"),_)?a.$executeAT(e):A(u("EL"),_)?a.$executeEL(e):p}),I.$private(),S(I,"$parse",function(f){var t,a=this;return A(u("EV_RE"),t=f)?a.$parseEV(u("Regexp").$last_match()):A(u("AT_RE"),t)?a.$parseAT(u("Regexp").$last_match()):A(u("EL_RE"),t)?a.$parseEL(u("Regexp").$last_match()):p}),S(I,"$parseEV",function(f){var a,_,e,o,$;return _=f["$[]"](1).$to_i(),e=this.$integerValueOfDifficulty(z(o=f["$[]"](3))?o:f["$[]"](4)),$=(a=f["$[]"](5))===p||null==a?p:a.$to_i(),u("EV").$new(_,e,$)}),S(I,"$parseAT",function(f){var t,_,e;return t=f["$[]"](1).$to_i(),_=this.$integerValueOfDifficulty(z(e=f["$[]"](3))?e:f["$[]"](4)),u("AT").$new(t,_)}),S(I,"$parseEL",function(f){var t,_,e;return t=f["$[]"](1).$to_i(),_=this.$integerValueOfDifficulty(z(e=f["$[]"](3))?e:f["$[]"](4)),u("EL").$new(t,_)}),S(I,"$executeEV",function(f){try{j("eval_return");var _,t=this,e=p,o=p;return _=t.$bRollCommand(f.$num(),f.$difficulty()),o=[(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$text()],z(f.$targetValue())&&z(Q(e.$success_num(),f.$targetValue()))&&o.$push("\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6!!"),o.$join(" \uff1e ")}catch($){if($===n.t_eval_return)return $.$v;throw $}}),S(I,"$executeAT",function(f){try{j("eval_return");var _,o,t=this,e=p,$=p;return _=t.$bRollCommand(f.$num(),f.$difficulty()),o=(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$last_dice_list().$count(6),$=[e.$text()],z(g(o,2))&&$.$push("\u30b5\u30c4\u30d0\u30c4!!"),$.$join(" \uff1e ")}catch(R){if(R===n.t_eval_return)return R.$v;throw R}}),S(I,"$executeEL",function(f){try{j("eval_return");var _,$,R,t=this,e=p,o=p;return _=t.$bRollCommand(f.$num(),f.$difficulty()),$=(o=(e=c(c(u("BCDice"),"CommonCommand"),"BarabaraDice").$eval(_,t,t.randomizer)).$last_dice_list()).$count(6),R=v(o,"count",[],function(y){return null==y&&(y=p),g(y,f.$difficulty())}),z(g($,1))?[e.$text()+" + "+$,X(R,$)].$join(" \uff1e "):e.$text()}catch(q){if(q===n.t_eval_return)return q.$v;throw q}}),S(I,"$integerValueOfDifficulty",function(f){return z(f)?z(/^[2-6]$/.$match(f))?f.$to_i():u("DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(f.$upcase()):4}),S(I,"$bRollCommand",function(f,a){return f+"B6>="+a}),i(h[0],"SATSUBATSU_TABLE",["\u300c\u6b7b\u306d\u30fc\u30c3\uff01\u300d\u8179\u90e8\u306b\u5f37\u70c8\u306a\u4e00\u6483\uff01\u3000\u6575\u306f\u304f\u306e\u5b57\u306b\u6298\u308c\u66f2\u304c\u308a\u3001\u30ef\u30a4\u30e4\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u3081\u3044\u3066\u5439\u3063\u98db\u3093\u3060\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u6575\u306f\u5f8c\u65b9\u306e\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u5411\u304b\u3063\u3066\u3001\u4f55\u30de\u30b9\u3067\u3082\u307e\u3063\u3059\u3050\u5f3e\u304d\u98db\u3070\u3055\u308c\u308b\uff08\u4ed6\u306e\u30ad\u30e3\u30e9\u306e\u3044\u308b\u30de\u30b9\u306f\u901a\u904e\u3059\u308b\uff09\u3002\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u63a5\u89e6\u3057\u305f\u6642\u70b9\u3067\u3001\u6575\u306f\u3055\u3089\u306b1\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002\u6575\u306f\u3053\u306e\u6fc0\u7a81\u30c0\u30e1\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u6539\u3081\u3066\u300e\u56de\u907f\u5224\u5b9a\u300f\u3092\u884c\u3063\u3066\u3082\u826f\u3044\u3002","\u300c\u30a4\u30e4\u30fc\u30c3\uff01\u300d\u982d\u90e8\u3078\u306e\u75db\u70c8\u306a\u30ab\u30e9\u30c6\uff01\u3000\u773c\u7403\u7834\u58ca\u3082\u3057\u304f\u306f\u6fc0\u3057\u3044\u8133\u9707\u76ea\u304c\u6575\u3092\u8972\u3046\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u3068\u3010\u30ef\u30b6\u30de\u30a8\u3011\u304c\u305d\u308c\u305e\u308c1\u305a\u3064\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u82e6\u3057\u307f\u629c\u3044\u3066\u6b7b\u306c\u304c\u3044\u3044\u300d\u6025\u6240\u3092\u60c5\u3051\u5bb9\u8d66\u306a\u304f\u7834\u58ca\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u8010\u3048\u96e3\u3044\u82e6\u75db\u306b\u3088\u308a\u3001\u6575\u306f\u3010\u7cbe\u795e\u529b\u3011\u304c-2\u3055\u308c\u3001\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u304c1\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u9003\u3052\u3089\u308c\u308b\u3082\u306e\u306a\u3089\u9003\u3052\u3066\u307f\u3088\u300d\u6575\u306e\u811a\u3092\u7c89\u7815\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u811a\u529b\u3011\u304cD3\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u3053\u308c\u3067\u624b\u3082\u8db3\u3082\u51fa\u307e\u3044\uff01\u300d\u6575\u306e\u4e21\u8155\u3092\u5207\u308a\u98db\u3070\u3057\u305f\uff01\u3000\u9bae\u8840\u304c\u30b9\u30d7\u30ea\u30f3\u30af\u30e9\u30fc\u3081\u3044\u3066\u5674\u304d\u51fa\u3059\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30ef\u30b6\u30de\u30a8\u3011\u3068\u3010\u30ab\u30e9\u30c6\u3011\u304c\u305d\u308c\u305e\u308c2\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u30a4\u30a4\u30a4\u30e4\u30a2\u30a2\u30a2\u30a2\u30fc\u30fc\u30fc\u30fc\u30c3\uff01\u300d\u30e4\u30ea\u3081\u3044\u305f\u30c1\u30e7\u30c3\u30d7\u304c\u6575\u306e\u80f8\u3092\u8cab\u901a\uff01\u3000\u3055\u3089\u306b\u5fc3\u81d3\u3092\u63b4\u307f\u53d6\u308a\u3001\u63e1\u308a\u3064\u3076\u3057\u305f\uff01\u3000\u30ca\u30e0\u30a2\u30df\u30c0\u30d6\u30c4\uff01\uff1a\u6575\u306f\u6b8b\u308a\u3010\u4f53\u529b\u3011\u306b\u95a2\u4fc2\u306a\u304f\u5373\u6b7b\u3059\u308b\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD6\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD6\u4e0a\u6607\u3059\u308b\u3002"].$freeze()),i(h[0],"TABLES",U(["SB"],{SB:c(u("DiceTable"),"Table").$new("\u30b5\u30c4\u30d0\u30c4\u8868","1D6",u("SATSUBATSU_TABLE"))}).$freeze()),I.$register_prefix("NJ","EV","AT","EL",u("TABLES").$keys())})}}]);