(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8436],{1316:(re,ne,te)=>{te(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(s){var G,n,F,r,w,V,a,N,k=s.module,B=s.ensure_kwargs,z=s.truthy,X=s.thrower,A=s.def,c=[],p=s.nil,S=s.$$$;return G=c,n=N=[k(c[0],"BCDice")].concat(G),a=[V=k(N[0],"ArithmeticEvaluator")].concat(n),r=[F=s.get_singleton_class(V)].concat(a),w=s.$r(r),A(F,"$eval",function(K,I){try{X("eval_return");var g,j=p;return null==(g=(I=B(I)).$$smap.round_type)&&(g=S(w("RoundType"),"FLOOR")),z(K)&&z(j=w("Arithmetic").$eval(K,g))?j:0}catch(x){if(x===s.t_eval_return)return x.$v;throw x}},-2)},Opal.modules["bcdice/dice_table/range_table"]=function(s){var J,F,K,I,M,g,j,r,V,k=s.module,B=s.klass,z=s.const_set,X=s.send,A=s.truthy,c=s.def,p=s.eqeqeq,S=s.rb_times,H=s.rb_plus,G=[],l=s.nil;return J=G,F=V=[k(G[0],"BCDice")].concat(J),K=r=[k(V[0],"DiceTable")].concat(F),M=[I=B(r[0],null,"RangeTable")].concat(K),g=s.$r(M),(j=I.$$prototype).name=j.items=j.num_of_dice=j.num_of_sides=j.formatter=l,z(M[0],"RollResult",X(g("Struct"),"new",["sum","values","content","formatted"],function x(){return(null==x.$$s?this:x.$$s).$alias_method("to_s","formatted")},{$$s:I})),z(M[0],"Item",g("Struct").$new("range","content")),z(M[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),z(M[0],"DEFAULT_FORMATTER",X(I,"lambda",[],function(u,i){return null==u&&(u=l),null==i&&(i=l),u.$name()+"("+i.$sum()+") \uff1e "+i.$content()})),I.$attr_reader("name"),I.$attr_reader("num_of_dice"),I.$attr_reader("num_of_sides"),c(I,"$initialize",function x(u,i,f){var o,d=x.$$p||l,v=this,_=l;return x.$$p=null,v.name=u.$freeze(),v.formatter=A(o=d)?o:g("DEFAULT_FORMATTER"),_=g("DICE_ROLL_METHOD_RE").$match(i),A(_)||v.$raise(g("ArgumentError"),v.name+": invalid dice roll method: "+i),v.num_of_dice=_["$[]"](1).$to_i(),v.num_of_sides=_["$[]"](2).$to_i(),v.$store(f)}),c(I,"$fetch",function(u){var f,i=this;return f=X(i.items,"find",[],function(v){return null==v&&(v=l),v.$range()["$include?"](u)}),A(f)||i.$raise(g("RangeError"),i.name+": value is out of range: "+u),f}),c(I,"$roll",function(u){var d,i=this,f=l,v=l;return d=(f=u.$roll_barabara(i.num_of_dice,i.num_of_sides)).$sum(),(v=g("RollResult").$new(d,f,i.$fetch(d).$content()))["$formatted="](i.formatter["$[]"](i,v)),v}),I.$private(),c(I,"$store",function(u){var f,d,i=this;return f=X(u,"map",[],function v(o,_){return null==o&&(o=l),null==_&&(_=l),[(null==v.$$s?this:v.$$s).$coerce_to_int_range(o),_]},{$$s:i}),d=X(f,"sort_by",[],function(o,_){return null==o&&(o=l),null==_&&(_=l),o.$min()}),i.$assert_min_sum_is_covered(d),i.$assert_max_sum_is_covered(d),i.$assert_no_gap_or_overlap_in_ranges(d),i.items=X(d,"map",[],function(o,_){return null==o&&(o=l),null==_&&(_=l),g("Item").$new(o,_.$freeze()).$freeze()}).$freeze(),i}),c(I,"$coerce_to_int_range",function(u){var f;return p(g("Integer"),f=u)?g("Range").$new(u,u):p(g("Range"),f)&&A(u.$begin()["$is_a?"](g("Integer")))&&A(u.$end()["$is_a?"](g("Integer")))?u:this.$raise(g("TypeError"),this.name+": "+u+" ("+u.$class()+") must be an Integer or a Range with Integers ")}),c(I,"$assert_min_sum_is_covered",function(u){var f,i=this,d=l;return f=i.num_of_dice,d=u.$first()["$[]"](0),A(d["$include?"](f))||i.$raise(g("RangeError"),i.name+": min value ("+f+") is not covered: "+d),i}),c(I,"$assert_max_sum_is_covered",function(u){var f,i=this,d=l;return f=S(i.num_of_dice,i.num_of_sides),d=u.$last()["$[]"](0),A(d["$include?"](f))||i.$raise(g("RangeError"),i.name+": max value ("+f+") is not covered: "+d),i}),c(I,"$assert_no_gap_or_overlap_in_ranges",function(u){return X(u,"each_cons",[2],function f(d,v){var Q,R,o=null==f.$$s?this:f.$$s,_=l,q=l;return null==o.name&&(o.name=l),null==d&&(d=l),null==v&&(v=l),_=d["$[]"](0),q=v["$[]"](0),Q=_.$max(),R=H(Q,1),A(q["$include?"](Q))&&o.$raise(g("RangeError"),o.name+": Range overlap: "+_+" and "+q),A(q["$include?"](R))?l:o.$raise(g("RangeError"),o.name+": Range gap: "+_+" and "+q)},{$$s:this}),this})},Opal.queue(function(s){var K,j,f,d,v,$,e,C,t,m,o,_,q,u,i,M,k=s.module,B=s.klass,z=s.const_set,X=s.send2,A=s.find_super,c=s.def,p=s.truthy,S=s.rb_lt,H=s.rb_gt,G=s.rb_plus,l=s.send,N=s.rb_ge,J=s.eqeq,n=s.hash2,V=s.to_ary,a=s.range,F=s.top,U=[],r=s.nil,w=s.$$$;return F.$require("bcdice/arithmetic_evaluator"),F.$require("bcdice/dice_table/range_table"),K=U,j=M=[k(U[0],"BCDice")].concat(K),u=[k(M[0],"GameSystem")].concat(j),i=s.$r(u),f=u[0],d=i("Base"),v=u,_=[o=B(f,d,"DoubleCross")].concat(v),q=s.$r(_),o.$$prototype.randomizer=r,z(_[0],"ID","DoubleCross"),z(_[0],"NAME","\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd"),z(_[0],"SORT_KEY","\u305f\u3075\u308b\u304f\u308d\u30592"),z(_[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\uff08xDX+y@c or xDXc+y\uff09\n\u3000"(\u500b\u6570)DX(\u4fee\u6b63)@(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)" \u3082\u3057\u304f\u306f "(\u500b\u6570)DX(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)(\u4fee\u6b63)" \u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u4fee\u6b63\u5024\u3082\u4ed8\u3051\u3089\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff0910dx\u3000\u300010dx+5@8\uff08OD tool\u5f0f)\u3000\u30005DX7+7-3\uff08\u75be\u98a8\u6012\u6fe4\u5f0f\uff09\n\n\u30fb\u5404\u7a2e\u8868\n\u3000\u30fb\u611f\u60c5\u8868\uff08ET\uff09\n\u3000\u3000\u30dd\u30b8\u30c6\u30a3\u30d6\u3068\u30cd\u30ac\u30c6\u30a3\u30d6\u306e\u4e21\u65b9\u3092\u632f\u3063\u3066\u3001\u8868\u306b\u306a\u3063\u3066\u3044\u308b\u5074\u306b\u25cb\u3092\u4ed8\u3051\u3066\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u3000\u3082\u3061\u308d\u3093\u4efb\u610f\u3067\u9078\u3076\u90e8\u5206\u306f\u5909\u66f4\u3057\u3066\u69cb\u3044\u307e\u305b\u3093\u3002\n\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n'),c(o,"$initialize",function R(E){var e=this;return R.$$p=null,X(e,A(e,"initialize",R,!1,!0),"initialize",[E],null),e.sides_implicit_d=10}),o.$register_prefix("\\d+DX","ET"),$=_,C=[e=B(_[0],null,"DX")].concat($),t=s.$r(C),(m=e.$$prototype).modifier=m.critical_value=m.expression=m.num=m.modifier_str=m.target_value=r,e.$include(t("Translate")),c(e,"$initialize",function(h,b,y,L){var D=this;return D.num=h,D.critical_value=b,D.modifier=y,D.target_value=L,D.modifier_str=t("Format").$modifier(D.modifier),D.expression=D.$node_expression(),D.locale="ja_jp"}),c(e,"$execute",function(h){var b=this,y=r,L=r,D=r,W=r,Y=r,P=r;if(p(S(b.critical_value,2)))return t("Result").$new("("+b.expression+") \uff1e "+b.$translate("DoubleCross.DX.invalid_critical"));if(p(S(b.num,1)))return t("Result").$failure("("+b.expression+") \uff1e "+b.$translate("DoubleCross.DX.auto_failure"));for(y=[],L=b.num,D=0;p(p(W=H(L,0))?S(D,w(w(t("CommonCommand"),"RerollDice"),"REROLL_LIMIT")):W);)Y=h.$roll_barabara(L,10),P=t("ValueGroup").$new(Y,b.critical_value),y.$push(P),L=P.$num_of_critical_occurrences(),D=G(D,1);return b.$result(y)}),e.$private(),c(e,"$node_expression",function(){var b,h=this;return b=h.num+"DX"+h.critical_value+h.modifier_str,p(h.target_value)?b+">="+h.target_value:b}),c(e,"$result",function(h){var L,W,b=this,y=r,D=r,Y=r,P=r,O=r,ee=r;return(y=t("Result").$new())["$fumble="](h["$[]"](0).$values()["$all?"](1)),L=l(h,"map",[],"max".$to_proc()).$sum(),D=p(y["$fumble?"]())?0:G(L,b.modifier),W=p(y["$fumble?"]())?D+" ("+b.$translate("fumble")+")":D.$to_s(),y["$critical="](H(h.$length(),1)),Y=["("+b.expression+")",""+h.$join("+")+b.modifier_str,W],p(b.target_value)&&(P=p(O=y["$fumble?"]()["$!"]())?N(D,b.target_value):O,p(P)?y["$success="](!0):y["$failure="](!0),ee=b.$translate(p(P)?"success":"failure"),Y.$push(ee)),y["$text="](Y.$join(" \uff1e ")),y}),function(R,E){var $=B(R,null,"ValueGroup"),e=$.$$prototype;e.values=e.critical_value=r,$.$attr_reader("values"),$.$attr_reader("critical_value"),c($,"$initialize",function(t,m){return this.values=t.$sort(),this.critical_value=m}),c($,"$to_s",function(){return this.$max()+"["+this.values.$join(",")+"]"}),c($,"$max",function(){var t=this;return p(l(t.values,"any?",[],function m(T){return null==T&&(T=r),(null==m.$$s?this:m.$$s)["$critical?"](T)},{$$s:t}))?10:t.values.$max()}),c($,"$num_of_critical_occurrences",function(){return l(this.values,"count",[],function m(T){return null==T&&(T=r),(null==m.$$s?this:m.$$s)["$critical?"](T)},{$$s:this})}),$.$private(),c($,"$critical?",function(t){return N(t,this.critical_value)})}(_[0]),c(o,"$eval_game_system_specific_command",function(E){var $=this,e=r;return p(e=$.$parse_dx(E))?e.$execute($.randomizer):J(E,"ET")?$.$roll_emotion_table():r}),o.$private(),c(o,"$parse_dx",function(E){var e;return p(e=this.$parse_dx_od(E))?e:this.$parse_dx_shippu_doto(E)}),c(o,"$parse_dx_od",function(E){var C=r,t=r,m=r,T=r;return C=w(q("Command"),"Parser").$new(/\d+DX/,n(["round_type"],{round_type:this.$round_type()})).$enable_critical().$restrict_cmp_op_to(r,">=").$parse(E),p(C)?(t=C.$command().$to_i(),m=p(T=C.$critical())?T:10,w(this.$class(),"DX").$new(t,m,C.$modify_number(),C.$target_number())):r}),c(o,"$parse_dx_shippu_doto",function(E){var $,e,m=r,T=r,h=r,b=r;return m=w(q("Command"),"Parser").$new(/\d+DX\d*/,n(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(r,">=").$parse(E),p(m)?(e=l(m.$command().$split("DX",2),"map",[],function(L){var D;return null==L&&(L=r),(D=L)===r||null==D?r:D.$to_i()}),T=null==($=V(e))[0]?r:$[0],h=p(b=h=null==$[1]?r:$[1])?b:10,w(this.$class(),"DX").$new(T,h,m.$modify_number(),m.$target_number())):r}),c(o,"$roll_emotion_table",function(){var C,E=this,$=r,e=r,t=r,T=r;return $=w(E.$class(),"POSITIVE_EMOTION_TABLE").$roll(E.randomizer),e=w(E.$class(),"NEGATIVE_EMOTION_TABLE").$roll(E.randomizer),C=E.randomizer.$roll_once(2)["$=="](1),t=p(C)?["\u25cb"+$.$content(),e.$content()]:[$.$content(),"\u25cb"+e.$content()],T=[E.$translate("DoubleCross.ET.name")+"("+$.$sum()+"-"+e.$sum()+")",t.$join(" - ")],q("Result").$new(T.$join(" \uff1e "))}),function(R,E){var $=[R].concat(E),e=s.$r($);R.$private(),c(R,"$positive_emotion_table",function(t){return w(e("DiceTable"),"RangeTable").$new(e("I18n").$translate("DoubleCross.ET.positive.name",n(["locale"],{locale:t})),"1D100",[[a(1,5,!1),e("I18n").$translate("DoubleCross.ET.positive.items.1_5",n(["locale"],{locale:t}))],[a(6,10,!1),e("I18n").$translate("DoubleCross.ET.positive.items.6_10",n(["locale"],{locale:t}))],[a(11,15,!1),e("I18n").$translate("DoubleCross.ET.positive.items.11_15",n(["locale"],{locale:t}))],[a(16,20,!1),e("I18n").$translate("DoubleCross.ET.positive.items.16_20",n(["locale"],{locale:t}))],[a(21,25,!1),e("I18n").$translate("DoubleCross.ET.positive.items.21_25",n(["locale"],{locale:t}))],[a(26,30,!1),e("I18n").$translate("DoubleCross.ET.positive.items.26_30",n(["locale"],{locale:t}))],[a(31,35,!1),e("I18n").$translate("DoubleCross.ET.positive.items.31_35",n(["locale"],{locale:t}))],[a(36,40,!1),e("I18n").$translate("DoubleCross.ET.positive.items.36_40",n(["locale"],{locale:t}))],[a(41,45,!1),e("I18n").$translate("DoubleCross.ET.positive.items.41_45",n(["locale"],{locale:t}))],[a(46,50,!1),e("I18n").$translate("DoubleCross.ET.positive.items.46_50",n(["locale"],{locale:t}))],[a(51,55,!1),e("I18n").$translate("DoubleCross.ET.positive.items.51_55",n(["locale"],{locale:t}))],[a(56,60,!1),e("I18n").$translate("DoubleCross.ET.positive.items.56_60",n(["locale"],{locale:t}))],[a(61,65,!1),e("I18n").$translate("DoubleCross.ET.positive.items.61_65",n(["locale"],{locale:t}))],[a(66,70,!1),e("I18n").$translate("DoubleCross.ET.positive.items.66_70",n(["locale"],{locale:t}))],[a(71,75,!1),e("I18n").$translate("DoubleCross.ET.positive.items.71_75",n(["locale"],{locale:t}))],[a(76,80,!1),e("I18n").$translate("DoubleCross.ET.positive.items.76_80",n(["locale"],{locale:t}))],[a(81,85,!1),e("I18n").$translate("DoubleCross.ET.positive.items.81_85",n(["locale"],{locale:t}))],[a(86,90,!1),e("I18n").$translate("DoubleCross.ET.positive.items.86_90",n(["locale"],{locale:t}))],[a(91,95,!1),e("I18n").$translate("DoubleCross.ET.positive.items.91_95",n(["locale"],{locale:t}))],[a(96,100,!1),e("I18n").$translate("DoubleCross.ET.positive.items.96_100",n(["locale"],{locale:t}))]])}),c(R,"$negative_emotion_table",function(t){return w(e("DiceTable"),"RangeTable").$new(e("I18n").$translate("DoubleCross.ET.negative.name",n(["locale"],{locale:t})),"1D100",[[a(1,5,!1),e("I18n").$translate("DoubleCross.ET.negative.items.1_5",n(["locale"],{locale:t}))],[a(6,10,!1),e("I18n").$translate("DoubleCross.ET.negative.items.6_10",n(["locale"],{locale:t}))],[a(11,15,!1),e("I18n").$translate("DoubleCross.ET.negative.items.11_15",n(["locale"],{locale:t}))],[a(16,20,!1),e("I18n").$translate("DoubleCross.ET.negative.items.16_20",n(["locale"],{locale:t}))],[a(21,25,!1),e("I18n").$translate("DoubleCross.ET.negative.items.21_25",n(["locale"],{locale:t}))],[a(26,30,!1),e("I18n").$translate("DoubleCross.ET.negative.items.26_30",n(["locale"],{locale:t}))],[a(31,35,!1),e("I18n").$translate("DoubleCross.ET.negative.items.31_35",n(["locale"],{locale:t}))],[a(36,40,!1),e("I18n").$translate("DoubleCross.ET.negative.items.36_40",n(["locale"],{locale:t}))],[a(41,45,!1),e("I18n").$translate("DoubleCross.ET.negative.items.41_45",n(["locale"],{locale:t}))],[a(46,50,!1),e("I18n").$translate("DoubleCross.ET.negative.items.46_50",n(["locale"],{locale:t}))],[a(51,55,!1),e("I18n").$translate("DoubleCross.ET.negative.items.51_55",n(["locale"],{locale:t}))],[a(56,60,!1),e("I18n").$translate("DoubleCross.ET.negative.items.56_60",n(["locale"],{locale:t}))],[a(61,65,!1),e("I18n").$translate("DoubleCross.ET.negative.items.61_65",n(["locale"],{locale:t}))],[a(66,70,!1),e("I18n").$translate("DoubleCross.ET.negative.items.66_70",n(["locale"],{locale:t}))],[a(71,75,!1),e("I18n").$translate("DoubleCross.ET.negative.items.71_75",n(["locale"],{locale:t}))],[a(76,80,!1),e("I18n").$translate("DoubleCross.ET.negative.items.76_80",n(["locale"],{locale:t}))],[a(81,85,!1),e("I18n").$translate("DoubleCross.ET.negative.items.81_85",n(["locale"],{locale:t}))],[a(86,90,!1),e("I18n").$translate("DoubleCross.ET.negative.items.86_90",n(["locale"],{locale:t}))],[a(91,95,!1),e("I18n").$translate("DoubleCross.ET.negative.items.91_95",n(["locale"],{locale:t}))],[a(96,100,!1),e("I18n").$translate("DoubleCross.ET.negative.items.96_100",n(["locale"],{locale:t}))]]).$freeze()})}(s.get_singleton_class(o),_),z(_[0],"POSITIVE_EMOTION_TABLE",o.$positive_emotion_table("ja_jp").$freeze()),z(_[0],"NEGATIVE_EMOTION_TABLE",o.$negative_emotion_table("ja_jp").$freeze())})}}]);