(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1377],{5762:(J,Q,q)=>{q(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(t){var M,I,S,N,G,b,e,R,L=t.module,w=t.ensure_kwargs,m=t.truthy,T=t.thrower,A=t.def,c=[],C=t.nil,F=t.$$$;return M=c,I=R=[L(c[0],"BCDice")].concat(M),e=[b=L(R[0],"ArithmeticEvaluator")].concat(I),N=[S=t.get_singleton_class(b)].concat(e),G=t.$r(N),A(S,"$eval",function(U,D){try{T("eval_return");var h,P=C;return null==(h=(D=w(D)).$$smap.round_type)&&(h=F(G("RoundType"),"FLOOR")),m(U)&&m(P=G("Arithmetic").$eval(U,h))?P:0}catch(y){if(y===t.t_eval_return)return y.$v;throw y}},-2)},Opal.queue(function(t){var N,D,Y,n,s,r,$,d,f,a,z,h,P,j,L=t.module,w=t.klass,m=t.const_set,T=t.slice,A=t.send,c=t.def,C=t.send2,F=t.find_super,_=t.truthy,M=t.hash2,x=t.rb_plus,R=t.rb_ge,H=t.rb_le,b=[],e=t.nil,S=t.$$$;return t.top.$require("bcdice/arithmetic_evaluator"),N=b,D=j=[L(b[0],"BCDice")].concat(N),h=[L(j[0],"GameSystem")].concat(D),P=t.$r(h),Y=h,f=[d=w(h[0],P("Base"),"SRS")].concat(Y),a=t.$r(f),(z=d.$$prototype).round_type=z.randomizer=z.sort_add_dice=e,m(f[0],"ID","SRS"),m(f[0],"NAME","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0"),m(f[0],"SORT_KEY","\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080"),m(f[0],"HELP_MESSAGE_1","\u30fb\u5224\u5b9a\n\u3000\u30fb\u901a\u5e38\u5224\u5b9a\uff1a2D6+m@c#f>=t \u307e\u305f\u306f 2D6+m>=t[c,f]\n\u3000\u3000\u4fee\u6b63\u5024m\u3001\u76ee\u6a19\u5024t\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u3054\u3068\u7701\u7565\u53ef\u3001@c\u30fb#f\u306e\u6307\u5b9a\u306f\u9806\u4e0d\u540c\uff09\u3002\n\u3000\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u65e2\u5b9a\u5024\u306f\u3001\u305d\u308c\u305e\u308c12\u30012\u3067\u3059\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3001\u6210\u529f\u3001\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6>=10\u3000\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10\u3000\u3000\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[11]\u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2@11>=10 \u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[12,4]\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2@12#4>=10 \u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[,4]\u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\uff08\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u7701\u7565\uff09\n\u3000\u3000\u4f8b) 2d6+2#4>=10\u3000\u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\uff08\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u7701\u7565\uff09\n"),m(f[0],"HELP_MESSAGE_2","\u3000\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u304a\u3088\u3073\u30d5\u30a1\u30f3\u30d6\u30eb\u306e\u307f\u306e\u5224\u5b9a\uff1a2D6+m@c#f \u307e\u305f\u306f 2D6+m[c,f]\n\u3000\u3000\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u305b\u305a\u3001\u4fee\u6b63\u5024m\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u306f\u7701\u7565\u4e0d\u53ef\u3001@c\u30fb#f\u306e\u6307\u5b9a\u306f\u9806\u4e0d\u540c\uff09\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6[]\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[11]\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2@11 \u3000\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[12,4]\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2@12#4 \u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n"),m(f[0],"HELP_MESSAGE_3","\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\uff08\u5165\u308c\u66ff\u3048\u306a\u3057)\n"),m(f[0],"DEFAULT_HELP_MESSAGE",a("HELP_MESSAGE_1")+"\n"+a("HELP_MESSAGE_2")+"\n"+a("HELP_MESSAGE_3")),m(f[0],"HELP_MESSAGE",a("DEFAULT_HELP_MESSAGE")),n=f,r=[s=L(f[0],"ClassMethods")].concat(n),$=t.$r(r),s.$attr_reader("aliases"),s.$attr_reader("help_message"),c(s,"$set_aliases_for_srs_roll",function(u){var E,g=this,o=e;return E=T(arguments),o=A(E,"map",[],"upcase".$to_proc()),g.aliases=A(o,"map",[],function(p){return null==p&&(p=e),$("Regexp").$escape(p)}),g.help_message=g.$concatenate_help_messages(o),g},-1),c(s,"$clear_aliases_for_srs_roll",function(){var u=this;return u.aliases=[],u.help_message=S($("SRS"),"DEFAULT_HELP_MESSAGE"),u}),s.$private(),c(s,"$concatenate_help_messages",function(u){var E,v;return E=A(u,"map",[],function(o){return null==o&&(o=e),"\u3000\u3000\u4f8b) "+o+"+2>=10\u3000\u3000\u3000\u3000 2d6+2>=10\u3068\u540c\u3058\uff08"+o+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"}).$join(),v=A(u,"map",[],function(o){return null==o&&(o=e),"\u3000\u3000\u4f8b) "+o+"\u3000\u3000\u3000\u3000\u3000 2d6[]\u3068\u540c\u3058\uff08"+o+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n\u3000\u3000\u4f8b) "+o+"+2@12#4\u3000\u30002d6+2@12#4\u3068\u540c\u3058\uff08"+o+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"}).$join(),S($("SRS"),"HELP_MESSAGE_1")+(E+"\n")+S($("SRS"),"HELP_MESSAGE_2")+v+"\n"+S($("SRS"),"HELP_MESSAGE_3")}),function(l,n){var s=[l].concat(n),r=t.$r(s);c(l,"$inherited",function(i){return i.$extend(r("ClassMethods")).$clear_aliases_for_srs_roll()}),c(l,"$help_message",function(){return r("DEFAULT_HELP_MESSAGE")}),c(l,"$aliases",function(){return[]})}(t.get_singleton_class(d),f),d.$register_prefix("2D6"),c(d,"$initialize",function l(n){var r=this;return l.$$p=null,C(r,F(r,"initialize",l,!1,!0),"initialize",[n],null),r.sort_add_dice=!0,r.d66_sort_type=S(a("D66SortType"),"NO_SORT")}),c(d,"$help_message",function(){return this.$class().$help_message()}),c(d,"$aliases",function(){return this.$class().$aliases()}),m(f[0],"DEFAULT_CRITICAL_VALUE",12),m(f[0],"DEFAULT_FUMBLE_VALUE",2),m(f[0],"SRSRollNode",A(a("Struct"),"new",["modifier","critical_value","fumble_value","target_value"],function l(){return c(null==l.$$s?this:l.$$s,"$to_s",function(){var $,r=this;return $="2D6"+a("Format").$modifier(r.$modifier()),(_(r.$target_value())?$+">="+r.$target_value():$)+"["+r.$critical_value()+","+r.$fumble_value()+"]"})},{$$s:d})),c(d,"$eval_game_system_specific_command",function(n){var $,s=this,r=e;return r=/(.+)\[(.*)\]$/.$match(n),$=_(r)?s.$parse_legacy(r["$[]"](1),r["$[]"](2)):s.$parse(n),_($)?s.$execute_srs_roll($):e}),d.$private(),c(d,"$parse",function(n){var r,i=e;return r=a("Regexp").$new(["2D6"].$concat(this.$aliases()).$join("|"),S(a("Regexp"),"IGNORECASE")),i=S(a("Command"),"Parser").$new(r,M(["round_type"],{round_type:this.round_type})).$enable_critical().$enable_fumble().$restrict_cmp_op_to(e,">=").$parse(n),!_(i)||_(n["$start_with?"](/2D6/i))&&_(i.$critical()["$nil?"]())&&_(i.$fumble()["$nil?"]())&&_(i.$target_number()["$nil?"]())?e:(_(i.$critical())||i["$critical="](a("DEFAULT_CRITICAL_VALUE")),_(i.$fumble())||i["$fumble="](a("DEFAULT_FUMBLE_VALUE")),a("SRSRollNode").$new(i.$modify_number(),i.$critical(),i.$fumble(),i.$target_number()))}),c(d,"$parse_legacy",function(n,s){var r,$,u=e,E=e,v=e,g=e,o=e,p=e;return u=/^(-?\d+)?(?:,(-?\d+))?$/.$match(s),_(u)&&(E=_(v=(r=u["$[]"](1))===e||null==r?e:r.$to_i())?v:a("DEFAULT_CRITICAL_VALUE"),g=_(v=($=u["$[]"](2))===e||null==$?e:$.$to_i())?v:a("DEFAULT_FUMBLE_VALUE"),o=a("Regexp").$new(["2D6"].$concat(this.$aliases()).$join("|"),S(a("Regexp"),"IGNORECASE")),p=S(a("Command"),"Parser").$new(o,M(["round_type"],{round_type:this.round_type})).$restrict_cmp_op_to(e,">=").$parse(n),_(p))?a("SRSRollNode").$new(p.$modify_number(),E,g,p.$target_number()):e}),c(d,"$execute_srs_roll",function(n){var $,i,u,s=this,r=e,E=e,v=e;return r=s.randomizer.$roll_barabara(2,6),_(s.sort_add_dice)&&r["$sort!"](),$=r.$sum(),i=r.$join(","),u=x($,n.$modifier()),E=s.$compare_result(n,$,u),v=["("+n+")",$+"["+i+"]"+a("Format").$modifier(n.$modifier()),u,E.$text()],E["$text="](v.$compact().$join(" \uff1e ")),E}),c(d,"$compare_result",function(n,s,r){return _(R(s,n.$critical_value()))?a("Result").$critical("\u81ea\u52d5\u6210\u529f"):_(H(s,n.$fumble_value()))?a("Result").$fumble("\u81ea\u52d5\u5931\u6557"):_(n.$target_value()["$nil?"]())?a("Result").$new():_(R(r,n.$target_value()))?a("Result").$success("\u6210\u529f"):a("Result").$failure("\u5931\u6557")})})}}]);