(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4788],{817:(be,he,ve)=>{ve(9993),Opal.modules["i18n/backend/fallbacks"]=function(e){var N,n,r,s,a,d,F=e.module,M=e.class_variable_set,c=e.truthy,P=e.class_variable_get,T=e.def,S=e.send,G=e.send2,w=e.find_super,E=e.hash2,I=e.find_block_super,D=e.neqeq,H=e.thrower,K=e.return_val,U=[],L=e.nil,p=e.$$$;return N=U,d=[a=F(U[0],"I18n")].concat(N),M(d[0],"@@fallbacks",L),n=e.get_singleton_class(a),r=[n].concat(d),s=e.$r(r),T(n,"$fallbacks",function(){var q=L;return M(r[1],"@@fallbacks",c(null!=r[1].$$cvars["@@fallbacks"]?"class variable":L)&&c(q=P(r[1],"@@fallbacks",!1))?q:p(p(s("I18n"),"Locale"),"Fallbacks").$new()),c(q=s("Thread").$current()["$[]"]("i18n_fallbacks"))?q:P(r[1],"@@fallbacks",!1)}),T(n,"$fallbacks=",function(z){var q;return M(r[1],"@@fallbacks",c(z["$is_a?"](s("Array")))?p(p(s("I18n"),"Locale"),"Fallbacks").$new(z):z),q=["i18n_fallbacks",P(r[1],"@@fallbacks",!1)],S(s("Thread").$current(),"[]=",q),q[q.length-1]}),function(n,k){var z,q,g,f,s=[F(n,"Backend")].concat(k);return z=s,g=[q=F(s[0],"Fallbacks")].concat(z),f=e.$r(g),T(q,"$translate",function y(m,h,u){try{var v=H("return"),_=y.$$p||L,A=this,x=L,o=L;return y.$$p=null,null==u&&(u=f("EMPTY_HASH")),c(u.$fetch("fallback",!0))?c(u["$[]"]("fallback_in_progress"))?G(A,w(A,"translate",y,!1,!0),"translate",[m,h,u],_):(c(u["$[]"]("default"))&&(x=A["$extract_non_symbol_default!"](u)),o=u.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),S(f("I18n").$fallbacks()["$[]"](m),"each",[],function i(R){var t=null==i.$$s?this:i.$$s;null==R&&(R=L);try{return S(t,"catch",["exception"],function l(){var $=null==l.$$s?this:l.$$s,j=L;if(j=G($,I($,"translate",l.$$def||i.$$def||y,!1,!1),"translate",[R,h,o],null),c(j["$nil?"]()))return L;D(m.$to_s(),R.$to_s())&&$.$on_fallback(m,R,h,u),v.$throw(j)},{$$s:t,$$ret:v})}catch(l){if(!e.rescue(l,[p(f("I18n"),"InvalidLocale")]))throw l;try{return L}finally{e.pop_exception()}}},{$$s:A}),c(u["$key?"]("default"))&&c(u["$[]"]("default")["$nil?"]())?L:c(x)?G(A,w(A,"translate",y,!1,!0),"translate",[m,L,u.$merge(E(["default"],{default:x}))],null):A.$throw("exception",p(f("I18n"),"MissingTranslation").$new(m,h,u))):G(A,w(A,"translate",y,!1,!0),"translate",[m,h,u],_)}catch(i){if(i===v)return i.$v;throw i}},-3),T(q,"$extract_non_symbol_default!",function(m){var u,h=L;return h=[m["$[]"]("default")].$flatten(),u=S(h,"detect",[],function(_){return null==_&&(_=L),_["$is_a?"](f("Symbol"))["$!"]()}),c(u)&&m["$[]="]("default",h["$[]"](0,h.$index(u))),u}),T(q,"$exists?",function y(m,h,u){try{var v=H("return"),_=y.$$p||L,A=this;return y.$$p=null,null==u&&(u=f("EMPTY_HASH")),c(u.$fetch("fallback",!0))?(S(f("I18n").$fallbacks()["$[]"](m),"each",[],function x(o){var i=null==x.$$s?this:x.$$s;null==o&&(o=L);try{if(!c(G(i,I(i,"exists?",x.$$def||y,!1,!1),"exists?",[o,h],null)))return L;v.$throw(!0)}catch(R){if(!e.rescue(R,[p(f("I18n"),"InvalidLocale")]))throw R;try{return L}finally{e.pop_exception()}}},{$$s:A,$$ret:v}),!1):G(A,w(A,"exists?",y,!1,!0),"exists?",[m,h,u],_)}catch(x){if(x===v)return x.$v;throw x}},-3),q.$private(),T(q,"$on_fallback",K(L))}(d[0],d)},Opal.modules["bcdice/randomizer"]=function(e){var a,b,z,q,g,f,n,k,M=e.klass,c=e.const_set,P=e.def,T=e.truthy,S=e.rb_gt,G=e.rb_plus,w=e.rb_le,E=e.send,I=e.rb_minus,D=e.eqeq,H=e.rb_times,K=e.eqeqeq,U=e.rb_ge,L=[],p=e.nil,V=e.$$$;return a=L,n=[(0,e.module)(L[0],"BCDice")].concat(a),k=e.$r(n),b=n,q=[z=M(n[0],null,"Randomizer")].concat(b),g=e.$r(q),(f=z.$$prototype).rand_results=f.detailed_rand_results=p,c(q[0],"UPPER_LIMIT_DICE_TIMES",200),c(q[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(q[0],"UPPER_LIMIT_RANDS",1e4),P(z,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),c(q[0],"DetailedRandResult",g("Struct").$new("kind","sides","value")),P(z,"$roll_barabara",function(m,h){var u=this;return T(S(G(u.rand_results.$size(),m),g("UPPER_LIMIT_RANDS")))&&u.$raise(g("TooManyRandsError")),T(w(m,0))||T(S(m,g("UPPER_LIMIT_DICE_TIMES")))?[]:E(g("Array"),"new",[m],function v(){return(null==v.$$s?this:v.$$s).$roll_once(h)},{$$s:u})}),P(z,"$roll_sum",function(m,h){return this.$roll_barabara(m,h).$sum()}),P(z,"$roll_once",function(m){var u=p;return T(w(m,0))||T(S(m,g("UPPER_LIMIT_DICE_SIDES")))?0:(u=this.$rand_inner(m),this.$push_to_detail("normal",m,u),u)}),P(z,"$roll_index",function(m){return I(this.$roll_once(m),1)}),P(z,"$roll_tens_d10",function(){var u,h=p;return h=this.$rand_inner(10),D(h,10)&&(h=0),u=H(h,10),this.$push_to_detail("tens_d10",10,u),u}),P(z,"$roll_d9",function(){var h;return h=I(this.$rand_inner(10),1),this.$push_to_detail("d9",10,h),h}),P(z,"$roll_d66",function(m){var v,u=p;return u=E(g("Array"),"new",[2],function _(){return(null==_.$$s?this:_.$$s).$roll_once(6)},{$$s:this}),K(V(g("D66SortType"),"ASC"),v=m)?u["$sort!"]():K(V(g("D66SortType"),"DESC"),v)&&u["$sort!"]()["$reverse!"](),G(H(u["$[]"](0),10),u["$[]"](1))}),z.$private(),P(z,"$rand_inner",function(m){var u,h=this;return T(U(h.rand_results.$size(),g("UPPER_LIMIT_RANDS")))&&h.$raise(g("TooManyRandsError")),u=h.$random(m),h.rand_results["$<<"]([u,m]),u}),P(z,"$random",function(m){return G(g("Kernel").$rand(m),1)}),P(z,"$push_to_detail",function(m,h,u){var _;return _=g("DetailedRandResult").$new(m,h,u),this.detailed_rand_results.$push(_)}),M(n[0],k("StandardError"),"TooManyRandsError"),p},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,K,N,a,d,n,k,L,D,F=e.module,M=e.klass,c=e.def,P=e.truthy,T=e.return_val,S=[],G=e.nil;return E=S,K=D=[F(S[0],"BCDice")].concat(E),N=L=[F(D[0],"DiceTable")].concat(K),d=[a=M(L[0],null,"RollResult")].concat(N),n=e.$r(d),(k=a.$$prototype).table_name=k.value=k.body=G,c(a,"$initialize",function(s,b,z){var q=this;return q.table_name=s,q.value=b,q.body=z}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),c(a,"$to_s",function(){var s=this;return s.table_name+"("+s.value+") \uff1e "+s.body}),c(a,"$last_body",function(){var s=this;return P(s.body["$is_a?"](n("RollResult")))?s.body.$last_body():s.body}),c(a,"$empty?",T(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,K,N,a,d,n,k,L,D,F=e.module,M=e.klass,c=e.truthy,P=e.def,T=e.rb_minus,S=[],G=e.nil;return E=S,K=D=[F(S[0],"BCDice")].concat(E),N=L=[F(D[0],"DiceTable")].concat(K),d=[a=M(L[0],null,"ChainTable")].concat(N),n=e.$r(d),(k=a.$$prototype).times=k.sides=k.items=k.name=G,P(a,"$initialize",function(s,b,z){var q=this,g=G;return q.name=s,q.items=z.$freeze(),g=/(\d+)D(\d+)/i.$match(b),c(g)||q.$raise(n("ArgumentError"),"Unexpected table type: "+b),q.times=g["$[]"](1).$to_i(),q.sides=g["$[]"](2).$to_i()}),P(a,"$roll",function(s){var z,q,b=this,g=G;return z=s.$roll_sum(b.times,b.sides),q=T(z,b.times),g=b.items["$[]"](q),c(g["$respond_to?"]("roll"))&&(g=g.$roll(s)),n("RollResult").$new(b.name,z,g)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var H,p,n,k,r,s,b,N,U,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.def,S=e.rb_plus,G=e.rb_times,w=e.rb_minus,E=[],I=e.nil;return H=E,p=U=[F(E[0],"BCDice")].concat(H),n=N=[F(U[0],"DiceTable")].concat(p),r=[k=M(N[0],null,"D66GridTable")].concat(n),s=e.$r(r),(b=k.$$prototype).name=b.items=I,P(k,"$from_i18n",function(q,g){var y=I;return y=s("I18n").$t(q,c(["locale","raise"],{locale:g,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))}),T(k,"$initialize",function(q,g){return this.name=q,this.items=g.$freeze()}),T(k,"$roll",function(q){var f,y,m,h,u;return f=q.$roll_once(6),y=q.$roll_once(6),m=S(G(f,10),y),h=w(f,1),u=w(y,1),s("RollResult").$new(this.name,m,this.items["$[]"](h)["$[]"](u))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var I,U,d,n,k,r,p,V,H,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.def,G=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),I=G,U=H=[F(G[0],"BCDice")].concat(I),p=[F(H[0],"DiceTable")].concat(U),V=e.$r(p),d=p,k=[n=M(p[0],V("D66GridTable"),"D66HalfGridTable")].concat(d),r=e.$r(k),P(n,"$from_i18n",function(b,z){var g=w;return g=r("I18n").$t(b,c(["locale","raise"],{locale:z,raise:!0})),this.$new(g["$[]"]("name"),g["$[]"]("items_1_2_3"),g["$[]"]("items_4_5_6"))}),T(n,"$initialize",function(b,z,q){return this.name=b,this.items=[z,z,z,q,q,q].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var I,U,d,n,k,r,p,V,H,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.def,G=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),I=G,U=H=[F(G[0],"BCDice")].concat(I),p=[F(H[0],"DiceTable")].concat(U),V=e.$r(p),d=p,k=[n=M(p[0],V("D66GridTable"),"D66OneThirdTable")].concat(d),r=e.$r(k),P(n,"$from_i18n",function(b,z){var g=w;return g=r("I18n").$t(b,c(["locale","raise"],{locale:z,raise:!0})),this.$new(g["$[]"]("name"),g["$[]"]("items_1_2"),g["$[]"]("items_3_4"),g["$[]"]("items_5_6"))}),T(n,"$initialize",function(b,z,q,g){return this.name=b,this.items=[z,z,q,q,g,g].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var U,N,r,s,b,z,q,d,p,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.def,S=e.eqeqeq,G=e.rb_plus,w=e.rb_times,E=e.truthy,I=[],D=e.nil,H=e.$$$;return U=I,N=p=[F(I[0],"BCDice")].concat(U),r=d=[F(p[0],"DiceTable")].concat(N),b=[s=M(d[0],null,"D66Table")].concat(r),z=e.$r(b),(q=s.$$prototype).sort_type=q.items=q.name=D,P(s,"$from_i18n",function(f,y){var u,h=D;return h=z("I18n").$t(f,c(["locale"],{locale:y})),u=z("D66SortType").$const_get(h["$[]"]("d66_sort_type")),this.$new(h["$[]"]("name"),u,h["$[]"]("items"))}),T(s,"$initialize",function(f,y,m){var h=this;return h.name=f,h.sort_type=y,h.items=m.$freeze()}),T(s,"$roll",function(f){var y=this,m=D,h=D,u=D,v=D;return m=f.$roll_barabara(2,6),S(H(z("D66SortType"),"ASC"),h=y.sort_type)?m["$sort!"]():S(H(z("D66SortType"),"DESC"),h)&&m["$sort!"]()["$reverse!"](),u=G(w(m["$[]"](0),10),m["$[]"](1)),v=E(h=y.items["$[]"](u))?h:y.items["$[]"](u.$to_s()),E(v["$respond_to?"]("roll"))&&(v=v.$roll(f)),z("RollResult").$new(y.name,u,v)}),T(s,"$choice",function(f){return z("RollResult").$new(this.name,f,this.items["$[]"](f))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var L,a,n,k,V,F=e.module,M=e.klass,c=e.hash2,P=e.send,T=e.to_ary,S=e.rb_plus,G=e.rb_times,w=e.send2,E=e.find_super,I=e.def,H=[],K=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),L=H,a=V=[F(H[0],"BCDice")].concat(L),n=[F(V[0],"DiceTable")].concat(a),k=e.$r(n),I(M(n[0],k("D66Table"),"D66LeftRangeTable"),"$initialize",function z(q,g,f){var h;return z.$$p=null,h=c([],{}),P(f,"each",[],function(v){var _,o;return null==v&&(v=K),_=T(v),o=null==_[1]?K:_[1],P(null==_[0]?K:_[0],"each",[],function(R){return null==R&&(R=K),P(o,"each_with_index",[],function(l,$){var j,J;return null==l&&(l=K),null==$&&($=K),J=S(G(R,10),S($,1)),P(h,"[]=",j=[J,l]),j[j.length-1]})})}),w(this,E(this,"initialize",z,!1,!0),"initialize",[q,g,h],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var K,V,k,r,s,b,z,a,L,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.def,S=e.truthy,G=e.rb_minus,w=e.rb_plus,E=e.rb_times,I=[],D=e.nil;return K=I,V=L=[F(I[0],"BCDice")].concat(K),k=a=[F(L[0],"DiceTable")].concat(V),s=[r=M(a[0],null,"D66ParityTable")].concat(k),b=e.$r(s),(z=r.$$prototype).odd=z.even=z.name=D,P(r,"$from_i18n",function(g,f){var m=D;return m=b("I18n").$t(g,c(["locale","raise"],{locale:f,raise:!0})),this.$new(m["$[]"]("name"),m["$[]"]("odd"),m["$[]"]("even"))}),T(r,"$initialize",function(g,f,y){var m=this;return m.name=g,m.odd=f.$freeze(),m.even=y.$freeze()}),T(r,"$roll",function(g){var m,u,v,f=this,y=D;return y=g.$roll_once(6),m=g.$roll_once(6),u=(S(y["$odd?"]())?f.odd:f.even)["$[]"](G(m,1)),v=w(E(y,10),m),b("RollResult").$new(f.name,v,u)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var I,U,a,d,n,k,r,p,H,F=e.module,M=e.klass,c=e.def,P=e.rb_plus,T=e.rb_times,S=e.send,G=[],w=e.nil;return I=G,U=H=[F(G[0],"BCDice")].concat(I),a=p=[F(H[0],"DiceTable")].concat(U),n=[d=M(p[0],null,"D66RangeTable")].concat(a),k=e.$r(n),(r=d.$$prototype).items=r.name=w,c(d,"$initialize",function(b,z){return this.name=b,this.items=z.$freeze()}),c(d,"$roll",function(b){var q,g,f,y=w;return q=b.$roll_once(6),g=b.$roll_once(6),f=P(T(q,10),g),y=S(this.items,"find",[],function(h){return null==h&&(h=w),h["$[]"](0)["$include?"](f)}),k("RollResult").$new(this.name,f,y["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var K,V,k,r,s,b,z,a,L,F=e.module,M=e.klass,c=e.const_set,P=e.send,T=e.truthy,S=e.def,G=e.eqeqeq,w=e.rb_times,E=e.rb_plus,I=[],D=e.nil;return K=I,V=L=[F(I[0],"BCDice")].concat(K),k=a=[F(L[0],"DiceTable")].concat(V),s=[r=M(a[0],null,"RangeTable")].concat(k),b=e.$r(s),(z=r.$$prototype).name=z.items=z.num_of_dice=z.num_of_sides=z.formatter=D,c(s[0],"RollResult",P(b("Struct"),"new",["sum","values","content","formatted"],function q(){return(null==q.$$s?this:q.$$s).$alias_method("to_s","formatted")},{$$s:r})),c(s[0],"Item",b("Struct").$new("range","content")),c(s[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(s[0],"DEFAULT_FORMATTER",P(r,"lambda",[],function(g,f){return null==g&&(g=D),null==f&&(f=D),g.$name()+"("+f.$sum()+") \uff1e "+f.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),S(r,"$initialize",function q(g,f,y){var u,m=q.$$p||D,h=this,v=D;return q.$$p=null,h.name=g.$freeze(),h.formatter=T(u=m)?u:b("DEFAULT_FORMATTER"),v=b("DICE_ROLL_METHOD_RE").$match(f),T(v)||h.$raise(b("ArgumentError"),h.name+": invalid dice roll method: "+f),h.num_of_dice=v["$[]"](1).$to_i(),h.num_of_sides=v["$[]"](2).$to_i(),h.$store(y)}),S(r,"$fetch",function(g){var y,f=this;return y=P(f.items,"find",[],function(h){return null==h&&(h=D),h.$range()["$include?"](g)}),T(y)||f.$raise(b("RangeError"),f.name+": value is out of range: "+g),y}),S(r,"$roll",function(g){var m,f=this,y=D,h=D;return m=(y=g.$roll_barabara(f.num_of_dice,f.num_of_sides)).$sum(),(h=b("RollResult").$new(m,y,f.$fetch(m).$content()))["$formatted="](f.formatter["$[]"](f,h)),h}),r.$private(),S(r,"$store",function(g){var y,m,f=this;return y=P(g,"map",[],function h(u,v){return null==u&&(u=D),null==v&&(v=D),[(null==h.$$s?this:h.$$s).$coerce_to_int_range(u),v]},{$$s:f}),m=P(y,"sort_by",[],function(u,v){return null==u&&(u=D),null==v&&(v=D),u.$min()}),f.$assert_min_sum_is_covered(m),f.$assert_max_sum_is_covered(m),f.$assert_no_gap_or_overlap_in_ranges(m),f.items=P(m,"map",[],function(u,v){return null==u&&(u=D),null==v&&(v=D),b("Item").$new(u,v.$freeze()).$freeze()}).$freeze(),f}),S(r,"$coerce_to_int_range",function(g){var y;return G(b("Integer"),y=g)?b("Range").$new(g,g):G(b("Range"),y)&&T(g.$begin()["$is_a?"](b("Integer")))&&T(g.$end()["$is_a?"](b("Integer")))?g:this.$raise(b("TypeError"),this.name+": "+g+" ("+g.$class()+") must be an Integer or a Range with Integers ")}),S(r,"$assert_min_sum_is_covered",function(g){var y,f=this,m=D;return y=f.num_of_dice,m=g.$first()["$[]"](0),T(m["$include?"](y))||f.$raise(b("RangeError"),f.name+": min value ("+y+") is not covered: "+m),f}),S(r,"$assert_max_sum_is_covered",function(g){var y,f=this,m=D;return y=w(f.num_of_dice,f.num_of_sides),m=g.$last()["$[]"](0),T(m["$include?"](y))||f.$raise(b("RangeError"),f.name+": max value ("+y+") is not covered: "+m),f}),S(r,"$assert_no_gap_or_overlap_in_ranges",function(g){return P(g,"each_cons",[2],function y(m,h){var A,x,u=null==y.$$s?this:y.$$s,v=D,_=D;return null==u.name&&(u.name=D),null==m&&(m=D),null==h&&(h=D),v=m["$[]"](0),_=h["$[]"](0),A=v.$max(),x=E(A,1),T(_["$include?"](A))&&u.$raise(b("RangeError"),u.name+": Range overlap: "+v+" and "+_),T(_["$include?"](x))?D:u.$raise(b("RangeError"),u.name+": Range gap: "+v+" and "+_)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var D,L,d,b,z,q,g,k,V,K,F=e.module,M=e.klass,c=e.send,P=e.def,T=e.rb_minus,S=e.return_ivar,G=[],w=e.nil,E=e.$$$;return D=G,L=K=[F(G[0],"BCDice")].concat(D),d=V=[F(K[0],"DiceTable")].concat(L),b=k=[M(V[0],null,"SaiFicSkillTable")].concat(d),q=[z=M(k[0],null,"Category")].concat(b),g=e.$r(q),P(z,"$initialize",function(y,m,h,u){var v=this;return v.name=y,v.skills=c(m.$map(),"with_index",[2],function(A,x){return null==A&&(A=w),null==x&&(x=w),E(g("SaiFicSkillTable"),"Skill").$new(y,A,h,x,u)}),v.dice=h}),P(z,"$roll",function(y){return this.$skills()["$[]"](T(y.$roll_sum(2,6),2))}),P(z,"$to_s",S("name")),z.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var w,H,V,k,r,a,U,I,F=e.module,M=e.klass,c=e.def,P=e.hash2,T=[],S=e.nil;return w=T,H=I=[F(T[0],"BCDice")].concat(w),V=U=[F(I[0],"DiceTable")].concat(H),a=[M(U[0],null,"SaiFicSkillTable")].concat(V),(r=(k=M(a[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=S,c(k,"$initialize",function(b,z,q,g,f){var y=this;return y.category_name=b,y.name=z,y.category_dice=q,y.row_dice=g,y.s_format=f}),c(k,"$to_s",function(){var b=this;return b.$format(b.s_format,P(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),k.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,r,g,f,y,m,h,b,n,F=e.module,M=e.klass,c=e.ensure_kwargs,P=e.hash2,T=e.send,G=e.defs,w=e.const_set,E=e.to_ary,I=e.def,D=e.truthy,H=e.rb_minus,K=e.rb_plus,U=e.top,L=[],p=e.nil,V=e.$$$;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=L,r=n=[F(L[0],"BCDice")].concat(a),g=b=[F(n[0],"DiceTable")].concat(r),y=[f=M(b[0],null,"SaiFicSkillTable")].concat(g),m=e.$r(y),(h=f.$$prototype).rtt=h.rtt_format=h.rct=h.rct_format=h.rttn=h.rttn_format=h.categories=p,G(f,"$from_i18n",function(v,_,A){var x,o,i,$,l=p;return null==(x=(A=c(A)).$$smap.rtt)&&(x=p),null==(o=A.$$smap.rct)&&(o=p),null==(i=A.$$smap.rttn)&&(i=p),$=(l=m("I18n").$t("RTT",P(["locale","raise","default"],{locale:_,raise:!1,default:P([],{})})).$merge(m("I18n").$t(v,P(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),l=T(l,"select",[],function(J,Q){return null==J&&(J=p),null==Q&&(Q=p),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](J)}),this.$new($,e.to_hash(l).$merge(P(["rtt","rct","rttn"],{rtt:x,rct:o,rttn:i})))},-3),w(y[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),w(y[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),w(y[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),w(y[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),I(f,"$initialize",function(v,_){var A,x,o,i,R,t,l,$=this;return null==(A=(_=c(_)).$$smap.rtt)&&(A=p),null==(x=_.$$smap.rct)&&(x=p),null==(o=_.$$smap.rttn)&&(o=p),null==(i=_.$$smap.rtt_format)&&(i=m("DEFAULT_RTT")),null==(R=_.$$smap.rct_format)&&(R=m("DEFAULT_RCT")),null==(t=_.$$smap.rttn_format)&&(t=m("DEFAULT_RTTN")),null==(l=_.$$smap.s_format)&&(l=m("DEFAULT_S")),$.categories=T(v.$map(),"with_index",[1],function(J,Q){var ne,se,ie;return null==J&&(J=p),null==Q&&(Q=p),se=null==(ne=E(J))[0]?p:ne[0],ie=null==ne[1]?p:ne[1],V(m("SaiFicSkillTable"),"Category").$new(se,ie,Q,l)},{$$has_top_level_mlhs_arg:!0}),$.rtt=A,$.rct=x,$.rttn=o.$to_a(),$.rtt_format=i,$.rct_format=R,$.rttn_format=t},-2),w(y[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),f.$attr_reader("categories"),I(f,"$roll_command",function(v,_){var x,A=this,o=p,i=p;return D(["RTT",A.rtt]["$include?"](x=_))?A.$format_skill(A.rtt_format,A.$roll_skill(v)):D(["RCT",A.rct]["$include?"](x))?(o=A.$roll_category(v),A.$format(A.rct_format,P(["category_dice","category_name"],{category_dice:o.$dice(),category_name:o.$name()}))):D(i=m("RTTN").$index(x))||D(i=A.rttn.$index(x))?A.$format_skill(A.rttn_format,A.categories["$[]"](i).$roll(v)):p}),I(f,"$roll_category",function(v){return this.categories["$[]"](H(v.$roll_once(6),1))}),I(f,"$roll_skill",function(v){return this.$roll_category(v).$roll(v)}),I(f,"$prefixes",function(){var v=this;return K(["RTT[1-6]?","RCT",v.rtt,v.rct],v.rttn).$compact()}),f.$private(),I(f,"$format_skill",function(v,_){return this.$format(v,P(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var D,L,d,n,k,r,s,V,K,F=e.module,M=e.klass,c=e.hash2,P=e.defs,T=e.truthy,S=e.def,G=e.rb_minus,w=[],E=e.nil;return D=w,L=K=[F(w[0],"BCDice")].concat(D),d=V=[F(K[0],"DiceTable")].concat(L),k=[n=M(V[0],null,"Table")].concat(d),r=e.$r(k),(s=n.$$prototype).times=s.sides=s.name=s.items=E,P(n,"$from_i18n",function(z,q){var f=E;return f=r("I18n").$t(z,c(["locale"],{locale:q})),this.$new(f["$[]"]("name"),f["$[]"]("type"),f["$[]"]("items"))}),S(n,"$initialize",function(z,q,g){var f=this,y=E;return f.name=z,f.items=g.$freeze(),y=/(\d+)D(\d+)/i.$match(q),T(y)||f.$raise(r("ArgumentError"),"Unexpected table type: "+q),f.times=y["$[]"](1).$to_i(),f.sides=y["$[]"](2).$to_i()}),S(n,"$roll",function(z){var g,q=this;return g=z.$roll_sum(q.times,q.sides),q.$choice(g)}),S(n,"$choice",function(z){var g,q=this;return g=G(z,q.times),r("RollResult").$new(q.name,z,q.items["$[]"](g))})},Opal.modules["bcdice/dice_table"]=function(e){var F=e.top;return F.$require("bcdice/dice_table/roll_result"),F.$require("bcdice/dice_table/chain_table"),F.$require("bcdice/dice_table/d66_grid_table"),F.$require("bcdice/dice_table/d66_half_grid_table"),F.$require("bcdice/dice_table/d66_one_third_table"),F.$require("bcdice/dice_table/d66_left_range_table"),F.$require("bcdice/dice_table/d66_parity_table"),F.$require("bcdice/dice_table/d66_range_table"),F.$require("bcdice/dice_table/d66_table"),F.$require("bcdice/dice_table/range_table"),F.$require("bcdice/dice_table/sai_fic_skill_table"),F.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var S,I,H,w,F=e.module,M=e.const_set,c=[];return S=c,I=w=[F(c[0],"BCDice")].concat(S),H=[F(w[0],"D66SortType")].concat(I),M(H[0],"NO_SORT","no_sort"),M(H[0],"ASC","asc"),M(H[0],"DESC","desc"),function(E,I){var H=[F(E,"RoundType")].concat(I);return M(H[0],"CEIL","ceil"),M(H[0],"FLOOR","floor"),M(H[0],"ROUND","round")}(w[0],w)},Opal.modules["bcdice/translate"]=function(e){var I,U,L,p,V,H,F=e.module,M=e.ensure_kwargs,c=e.kwrestargs,T=e.hash2,S=e.def,G=[],w=e.nil;return I=G,U=H=[F(G[0],"BCDice")].concat(I),p=[L=F(H[0],"Translate")].concat(U),V=e.$r(p),S(L,"$translate",function(a,d){var n,k=this;return null==k.locale&&(k.locale=w),d=M(d),n=c(d,{}),V("I18n").$translate(a,T(["locale","raise"],{locale:k.locale,raise:!0}).$merge(e.to_hash(n)))},-2)},Opal.modules["bcdice/result"]=function(e){var L,N,p,I,H,M=e.klass,c=e.send,P=e.def,T=e.return_val,S=e.return_ivar,G=[],w=e.nil;return I=G,L=H=[(0,e.module)(G[0],"BCDice")].concat(I),[p=M(H[0],null,"Result")].concat(L),P(N=e.get_singleton_class(p),"$success",function(n){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](n),c(s,"success=",b=[!0]),b[b.length-1]})}),P(N,"$failure",function(n){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](n),c(s,"failure=",b=[!0]),b[b.length-1]})}),P(N,"$critical",function(n){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](n),s["$critical="](!0),c(s,"success=",b=[!0]),b[b.length-1]})}),P(N,"$fumble",function(n){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](n),s["$fumble="](!0),c(s,"failure=",b=[!0]),b[b.length-1]})}),P(N,"$nothing",T("nothing")),P(p,"$initialize",function(a){var d=this;return null==a&&(a=w),d.text=a,d.rands=w,d.detailed_rands=w,d.secret=!1,d.success=!1,d.failure=!1,d.critical=!1,d.fumble=!1},-1),p.$attr_accessor("text","rands","detailed_rands"),p.$attr_writer("secret","success","failure","critical","fumble"),P(p,"$secret?",S("secret")),P(p,"$success?",S("success")),P(p,"$failure?",S("failure")),P(p,"$critical?",S("critical")),P(p,"$fumble?",S("fumble")),P(p,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var z,g,f,F=e.module,M=e.klass,c=e.truthy,P=e.const_set,T=e.defs,S=e.gvars,G=e.rb_lt,w=e.def,E=e.to_ary,I=e.send,D=e.neqeq,H=e.rb_plus,K=e.eqeq,U=e.rb_ge,L=e.rb_gt,p=e.rb_minus,V=e.rb_le,N=e.rb_times,a=e.assign_ivar_val,n=[],k=e.$r(n),r=e.nil,s=e.$$$;return z=n,g=[F(n[0],"Racc")].concat(z),f=e.$r(g),M(g[0],f("StandardError"),"ParseError"),c(s("::","ParseError","skip_raise")?"constant":r)||P(n[0],"ParseError",s(k("Racc"),"ParseError")),function(b,z){var u,v,_,A,x,f=[F(b,"Racc")].concat(z),y=e.$r(f);return c(y("Racc_No_Extensions","skip_raise")?"constant":r)||P(f[0],"Racc_No_Extensions",!1),u=f,_=[v=M(f[0],null,"Parser")].concat(u),A=e.$r(_),(x=v.$$prototype).yydebug=x.racc_debug_out=x.racc_error_status=x.racc_t=x.racc_vstack=x.racc_val=x.racc_state=x.racc_tstack=r,P(_[0],"Racc_Runtime_Version","1.4.6"),P(_[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),P(_[0],"Racc_Runtime_Core_Version_R","1.4.6"),P(_[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),P(_[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),P(_[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),P(_[0],"Racc_Runtime_Core_Version",A("Racc_Runtime_Core_Version_R")),P(_[0],"Racc_Runtime_Core_Revision",A("Racc_Runtime_Core_Revision_R")),P(_[0],"Racc_Runtime_Type","ruby"),T(A("Parser"),"$racc_runtime_type",function(){return A("Racc_Runtime_Type")}),w(v,"$_racc_setup",function(){var i,R,t=this,l=r,$=r;return null==S.stderr&&(S.stderr=r),c(s(t.$class(),"Racc_debug_parser"))||(t.yydebug=!1),c(null!=(i=t.yydebug)&&i!==r?"instance-variable":r)||(t.yydebug=!1),c(t.yydebug)&&(c(null!=(R=t.racc_debug_out)&&R!==r?"instance-variable":r)||(t.racc_debug_out=S.stderr),t.racc_debug_out=c(l=t.racc_debug_out)?l:S.stderr),$=s(t.$class(),"Racc_arg"),c(G($.$size(),14))&&$["$[]="](13,!0),$}),w(v,"$_racc_init_sysvars",function(){var i=this;return i.racc_state=[0],i.racc_tstack=[],i.racc_vstack=[],i.racc_t=r,i.racc_val=r,i.racc_read_next=!0,i.racc_user_yyerror=!1,i.racc_error_status=0}),w(v,"$do_parse",function(){return this.$__send__(A("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),w(v,"$next_token",function(){return this.$raise(A("NotImplementedError"),this.$class()+"#next_token is not defined")}),w(v,"$_racc_do_parse_rb",function(i,R){var t,$=this,j=r,J=r,Q=r,ne=r,se=r,ie=r,ue=r,te=r;return t=E(i),j=null==t[0]?r:t[0],J=null==t[1]?r:t[1],Q=null==t[2]?r:t[2],ne=null==t[3]?r:t[3],se=null==t[10]?r:t[10],$.$_racc_init_sysvars(),ie=ue=te=r,I($,"catch",["racc_end_parse"],function W(){var C,Z,Y=null==W.$$s?this:W.$$s,B=r;for(null==Y.racc_state&&(Y.racc_state=r),null==Y.racc_read_next&&(Y.racc_read_next=r),null==Y.racc_t&&(Y.racc_t=r),null==Y.yydebug&&(Y.yydebug=r),null==Y.racc_val&&(Y.racc_val=r);c(!0);)for(c(te=ne["$[]"](Y.racc_state["$[]"](-1)))?(c(Y.racc_read_next)&&D(Y.racc_t,0)&&(Z=Y.$next_token(),C=E(Z),ie=null==C[0]?r:C[0],Y.racc_val=null==C[1]?r:C[1],Y.racc_t=c(ie)?c(B=se["$[]"](ie))?B:1:0,c(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,ie,Y.racc_val),Y.racc_read_next=!1),te=H(te,Y.racc_t),c(U(te,0))&&c(ue=j["$[]"](te))&&K(J["$[]"](te),Y.racc_state["$[]"](-1))||(ue=Q["$[]"](Y.racc_state["$[]"](-1)))):ue=Q["$[]"](Y.racc_state["$[]"](-1));c(ue=Y.$_racc_evalact(ue,i)););},{$$s:$})}),w(v,"$yyparse",function(i,R){return this.$__send__(A("Racc_YY_Parse_Method"),i,R,this.$_racc_setup(),!0)}),w(v,"$_racc_yyparse_rb",function(i,R,t,l){var $,J=this,Q=r,ne=r,$e=r,se=r,ue=r,te=r,W=r;return $=E(t),Q=null==$[0]?r:$[0],ne=null==$[1]?r:$[1],$e=null==$[2]?r:$[2],se=null==$[3]?r:$[3],ue=null==$[10]?r:$[10],J.$_racc_init_sysvars(),te=r,W=r,I(J,"catch",["racc_end_parse"],function C(){var Z=null==C.$$s?this:C.$$s;for(null==Z.racc_state&&(Z.racc_state=r);!c(W=se["$[]"](Z.racc_state["$[]"](-1)));)for(;c(te=Z.$_racc_evalact($e["$[]"](Z.racc_state["$[]"](-1)),t)););return I(i,"__send__",[R],function Y(B,ee){var O=null==Y.$$s?this:Y.$$s,re=r,X=r;for(null==O.racc_t&&(O.racc_t=r),null==O.racc_state&&(O.racc_state=r),null==O.racc_read_next&&(O.racc_read_next=r),null==B&&(B=r),null==ee&&(ee=r),O.racc_t=c(B)?c(re=ue["$[]"](B))?re:1:0,O.racc_val=ee,O.racc_read_next=!1,W=H(W,O.racc_t),c(U(W,0))&&c(te=Q["$[]"](W))&&K(ne["$[]"](W),O.racc_state["$[]"](-1))||(te=$e["$[]"](O.racc_state["$[]"](-1)));c(te=O.$_racc_evalact(te,t)););for(;c(c(re=c(X=(W=se["$[]"](O.racc_state["$[]"](-1)))["$!"]())?X:O.racc_read_next["$!"]())?re:O.racc_t["$=="](0));)for(c(W)&&c(W=H(W,O.racc_t))&&c(U(W,0))&&c(te=Q["$[]"](W))&&K(ne["$[]"](W),O.racc_state["$[]"](-1))||(te=$e["$[]"](O.racc_state["$[]"](-1)));c(te=O.$_racc_evalact(te,t)););},{$$s:Z})},{$$s:J})}),w(v,"$_racc_evalact",function(i,R){var t,$e,$=this,j=r,J=r,ne=r,se=r,ie=r,ue=r;if(j=null==(t=E(R))[0]?r:t[0],J=null==t[1]?r:t[1],ne=null==t[3]?r:t[3],$e=null==t[11]?r:t[11],se=null==t[12]?r:t[12],c(L(i,0))&&c(G(i,$e)))c(L($.racc_error_status,0))&&(K($.racc_t,1)||($.racc_error_status=p($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(i),$.racc_read_next=!0,c($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(c(G(i,0))&&c(L(i,se["$-@"]()))){if(ie=I($,"catch",["racc_jump"],function te(){var W=null==te.$$s?this:te.$$s;return null==W.racc_state&&(W.racc_state=r),W.racc_state.$push(W.$_racc_do_reduce(R,i)),!1},{$$s:$}),c(ie))switch(ie){case 1:return $.racc_user_yyerror=!0,se["$-@"]();case 2:return $e;default:$.$raise("[Racc Bug] unknown jump code")}}else if(K(i,$e))c($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(K(i,se["$-@"]())){switch($.racc_error_status){case 0:c(R["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:K($.racc_t,0)&&$.$throw("racc_end_parse",r),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;c(!0)&&!(c(ue=ne["$[]"]($.racc_state["$[]"](-1)))&&(ue=H(ue,1),c(U(ue,0))&&c(i=j["$[]"](ue))&&K(J["$[]"](ue),$.racc_state["$[]"](-1))));)c(V($.racc_state.$size(),1))&&$.$throw("racc_end_parse",r),$.racc_state.$pop(),$.racc_vstack.$pop(),c($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return i}$.$raise("[Racc Bug] unknown action "+i.$inspect())}return c($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),r}),w(v,"$_racc_do_reduce",function(i,R){var t,se,ue,B,ee,O,ae,$=this,J=r,Q=r,ne=r,$e=r,ie=r,te=r,W=r,C=r,Z=r,Y=r,re=r,X=r,ce=r;return J=null==(t=E(i))[4]?r:t[4],Q=null==t[5]?r:t[5],ne=null==t[6]?r:t[6],$e=null==t[7]?r:t[7],se=null==t[8]?r:t[8],ie=null==t[9]?r:t[9],ue=null==t[13]?r:t[13],te=$.racc_state,W=$.racc_vstack,C=$.racc_tstack,Z=N(R,-3),Y=ie["$[]"](Z),B=ie["$[]"](H(Z,1)),ee=ie["$[]"](H(Z,2)),O=[],c($.yydebug)&&(re=C["$[]"](Y["$-@"](),Y)),X=W["$[]"](Y["$-@"](),Y),c($.yydebug)&&C["$[]="](Y["$-@"](),Y,O),W["$[]="](Y["$-@"](),Y,O),te["$[]="](Y["$-@"](),Y,O),c(ue)?W.$push($.$__send__(ee,X,W,X["$[]"](0))):W.$push($.$__send__(ee,X,W)),C.$push(B),c($.yydebug)&&$.$racc_reduce(re,B,C,W),ae=p(B,se),c(Z=$e["$[]"](ae))&&(Z=H(Z,te["$[]"](-1)),c(U(Z,0))&&c(ce=J["$[]"](Z))&&K(Q["$[]"](Z),ae))?ce:ne["$[]"](ae)}),w(v,"$on_error",function(i,R,t){var $,l=this;return l.$raise(A("ParseError"),l.$sprintf("\nparse error on value %s (%s)",R.$inspect(),c($=l.$token_to_str(i))?$:"?"))}),w(v,"$yyerror",function(){return this.$throw("racc_jump",1)}),w(v,"$yyaccept",function(){return this.$throw("racc_jump",2)}),w(v,"$yyerrok",a("racc_error_status",0)),w(v,"$racc_read_token",function(i,R,t){var l=this;return l.racc_debug_out.$print("read    "),l.racc_debug_out.$print(R.$inspect(),"(",l.$racc_token2str(i),") "),l.racc_debug_out.$puts(t.$inspect()),l.racc_debug_out.$puts()}),w(v,"$racc_shift",function(i,R,t){var l=this;return l.racc_debug_out.$puts("shift   "+l.$racc_token2str(i)),l.$racc_print_stacks(R,t),l.racc_debug_out.$puts()}),w(v,"$racc_reduce",function(i,R,t,l){var $=this,j=r;return(j=$.racc_debug_out).$print("reduce "),c(i["$empty?"]())?j.$print(" <none>"):I(i,"each",[],function J(Q){return null==Q&&(Q=r),j.$print(" ",(null==J.$$s?this:J.$$s).$racc_token2str(Q))},{$$s:$}),j.$puts(" --\x3e "+$.$racc_token2str(R)),$.$racc_print_stacks(t,l),$.racc_debug_out.$puts()}),w(v,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),w(v,"$racc_e_pop",function(i,R,t){var l=this;return l.racc_debug_out.$puts("error recovering mode: pop token"),l.$racc_print_states(i),l.$racc_print_stacks(R,t),l.racc_debug_out.$puts()}),w(v,"$racc_next_state",function(i,R){var t=this;return t.racc_debug_out.$puts("goto    "+i),t.$racc_print_states(R),t.racc_debug_out.$puts()}),w(v,"$racc_print_stacks",function(i,R){var l=r;return(l=this.racc_debug_out).$print("        ["),I(i,"each_index",[],function $(j){return null==j&&(j=r),l.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(i["$[]"](j))," ",R["$[]"](j).$inspect(),")")},{$$s:this}),l.$puts(" ]")}),w(v,"$racc_print_states",function(i){var t=r;return(t=this.racc_debug_out).$print("        ["),I(i,"each",[],function($){return null==$&&($=r),t.$print(" ",$)}),t.$puts(" ]")}),w(v,"$racc_token2str",function(i){var t;return c(t=s(this.$class(),"Racc_token_to_s_table")["$[]"](i))?t:this.$raise("[Racc Bug] can't convert token "+i+" to string")}),w(v,"$token_to_str",function(i){return s(this.$class(),"Racc_token_to_s_table")["$[]"](i)})}(n[0],n)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,r,q,u,v,f,y,b,n,F=e.module,M=e.klass,c=e.def,P=e.thrower,T=e.return_ivar,S=e.send2,G=e.find_super,w=e.eqeq,E=e.const_set,I=e.eqeqeq,D=e.rb_divide,H=e.truthy,K=e.assign_ivar,U=e.alias,L=[],p=e.nil,V=e.$$$;return a=L,r=n=[F(L[0],"BCDice")].concat(a),q=b=[F(n[0],"Arithmetic")].concat(r),f=[F(b[0],"Node")].concat(q),y=e.$r(f),(v=(u=M(f[0],null,"BinaryOp")).$$prototype).lhs=v.rhs=v.op=p,c(u,"$initialize",function(A,x,o){var i=this;return i.lhs=A,i.op=x,i.rhs=o}),c(u,"$eval",function(A){try{P("eval_return");var R,o=this,i=p;return i=o.lhs.$eval(A),R=o.rhs.$eval(A),i.$send(o.op,R)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(u,"$output",function(){var A=this;return""+A.lhs.$output()+A.op+A.rhs.$output()}),c(u,"$s_exp",function(){var A=this;return"("+A.$op_for_s_exp()+" "+A.lhs.$s_exp()+" "+A.rhs.$s_exp()+")"}),c(u,"$op_for_s_exp",T("op")),function(m,h,u){var v=M(m,h,"DivideBase"),_=[v].concat(u),A=e.$r(_),x=v.$$prototype;x.lhs=x.rhs=x.op=p,c(v,"$initialize",function o(i,R){return o.$$p=null,S(this,G(this,"initialize",o,!1,!0),"initialize",[i,"/",R],null)}),c(v,"$eval",function(i){try{P("eval_return");var l,$,t=this;return l=t.lhs.$eval(i),$=t.rhs.$eval(i),w($,0)&&t.$raise(A("ZeroDivisionError")),t.$divide_and_round(l,$,i)}catch(j){if(j===e.t_eval_return)return j.$v;throw j}}),c(v,"$output",function o(){var i=o.$$p||p,R=this;return o.$$p=null,""+S(R,G(R,"output",o,!1,!0),"output",[],i)+R.$rounding_method()}),v.$private(),c(v,"$rounding_method",function(){return V(this.$class(),"ROUNDING_METHOD")}),c(v,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(v,"$divide_and_round",function(i,R,t){return this.$raise(A("NotImplementedError"))})}(f[0],y("BinaryOp"),f),function(m,h,u){var v=M(m,h,"DivideWithGameSystemDefault"),_=[v].concat(u),A=e.$r(_);E(_[0],"ROUNDING_METHOD",""),v.$private(),c(v,"$divide_and_round",function(o,i,R){var t,l=p;return I(V(A("RoundType"),"CEIL"),t=R)?D(o.$to_f(),i).$ceil():I(V(A("RoundType"),"ROUND"),t)?(l=D(o.$to_f(),i),H(l["$negative?"]())?l.$abs().$round()["$-@"]():l.$round()):D(o,i).$floor()})}(f[0],y("DivideBase"),f),function(m,h,u){var v=M(m,h,"DivideWithCeil"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","C"),v.$private(),c(v,"$divide_and_round",function(x,o,i){return D(x.$to_f(),o).$ceil()})}(f[0],y("DivideBase"),f),function(m,h,u){var v=M(m,h,"DivideWithRound"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","R"),v.$private(),c(v,"$divide_and_round",function(x,o,i){var R=p;return R=D(x.$to_f(),o),H(R["$negative?"]())?R.$abs().$round()["$-@"]():R.$round()})}(f[0],y("DivideBase"),f),function(m,h,u){var v=M(m,h,"DivideWithFloor"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","F"),v.$private(),c(v,"$divide_and_round",function(x,o,i){return D(x,o).$floor()})}(f[0],y("DivideBase"),f),function(m,h){var u=M(m,null,"Negative");u.$$prototype.body=p,c(u,"$initialize",K("body")),c(u,"$eval",function(A){try{return P("eval_return"),this.body.$eval(A)["$-@"]()}catch(i){if(i===e.t_eval_return)return i.$v;throw i}}),c(u,"$output",function(){return"-"+this.body.$output()}),c(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(f[0]),function(m,h){var u=M(m,null,"Parenthesis");u.$$prototype.expr=p,c(u,"$initialize",K("expr")),c(u,"$eval",function(A){try{return P("eval_return"),this.expr.$eval(A)}catch(i){if(i===e.t_eval_return)return i.$v;throw i}}),c(u,"$output",function(){return"("+this.expr.$output()+")"}),c(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(f[0]),function(m,h){var u=M(m,null,"Number");return u.$$prototype.value=p,c(u,"$initialize",K("value")),c(u,"$eval",T("value")),c(u,"$output",function(){return this.value.$to_s()}),U(u,"s_exp","output")}(f[0])},Opal.modules.strscan=function(e){var K,U,L,p,V,M=e.def,c=e.truthy,P=e.eqeqeq,T=e.Opal,S=e.return_ivar,G=e.send,w=e.alias,E=[],I=e.nil;return K=E,L=[U=(0,e.klass)(E[0],null,"StringScanner")].concat(K),p=e.$r(L),(V=U.$$prototype).pos=V.string=V.working=V.matched=V.prev_pos=V.match=I,U.$attr_reader("pos","matched"),M(U,"$initialize",function(a){var d=this;return d.string=a,d.pos=0,d.matched=I,d.working=a,d.match=[]}),U.$attr_reader("string"),M(U,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),M(U,"$scan",function(a){var d=this,n=(a=d.$anchor(a)).exec(d.working);return null==n?d.matched=I:(d.prev_pos=d.pos,d.pos+=n[0].length,d.working=d.working.substring(n[0].length),d.matched=n[0],d.match=n,n[0])}),M(U,"$scan_until",function(a){var d=this;a=d.$anchor(a);for(var n=d.working,k=0;n.length!=k;++k){var r=a.exec(n.substr(k));if(null!==r){var s=k+r[0].length,b=n.substr(0,s);return d.matched=r[0],d.match=r,d.prev_pos=d.pos+k,d.pos+=s,d.working=n.substr(s),b}}return d.matched=I}),M(U,"$[]",function(a){var n;if(c(this.match["$empty?"]()))return I;P(p("Symbol"),n=a)?a=a.$to_s():P(p("String"),n)||(a=T["$coerce_to!"](a,p("Integer"),"to_int"));var k=this.match;return a<0&&(a+=k.length),a<0||a>=k.length||null==k[a]?I:k[a]}),M(U,"$check",function(a){var d=this,n=(a=d.$anchor(a)).exec(d.working);return d.matched=null==n?I:n[0]}),M(U,"$check_until",function(a){var d=this,n=d.prev_pos,k=d.pos,r=d.working,s=d.$scan_until(a);return d.prev_pos=n,d.pos=k,d.working=r,s}),M(U,"$peek",function(a){return this.working.substring(0,a)}),M(U,"$eos?",function(){return 0===this.working.length}),M(U,"$exist?",function(a){var n=a.exec(this.working);return null==n?I:0==n.index?0:n.index+1}),M(U,"$skip",function(a){var d=this,n=(a=d.$anchor(a)).exec(d.working);if(null==n)return d.match=[],d.matched=I;var k=n[0],r=k.length;return d.matched=k,d.match=n,d.prev_pos=d.pos,d.pos+=r,d.working=d.working.substring(r),r}),M(U,"$skip_until",function(a){var n=this.$scan_until(a);return n===I?I:(this.matched=n.substr(-1),n.length)}),M(U,"$get_byte",function(){var a=this,d=I;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,d=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=I,d}),M(U,"$match?",function(a){var d=this,n=(a=d.$anchor(a)).exec(d.working);return null==n?I:(d.prev_pos=d.pos,n[0].length)}),M(U,"$pos=",function(a){var d=this;return a<0&&(a+=d.string.$length()),d.pos=a,d.working=d.string.slice(a)}),M(U,"$matched_size",function(){return this.matched===I?I:this.matched.length}),M(U,"$post_match",function(){var a=this;return a.matched===I?I:a.string.substr(a.pos)}),M(U,"$pre_match",function(){var a=this;return a.matched===I?I:a.string.substr(0,a.prev_pos)}),M(U,"$reset",function(){var a=this;return a.working=a.string,a.matched=I,a.pos=0}),M(U,"$rest",S("working")),M(U,"$rest?",function(){return 0!==this.working.length}),M(U,"$rest_size",function(){return this.$rest().$size()}),M(U,"$terminate",function(){var a,d=this;return d.match=I,a=[d.string.$length()],G(d,"pos=",a),a[a.length-1]}),M(U,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=I,a.match=I,a}),w(U,"bol?","beginning_of_line?"),w(U,"getch","get_byte"),U.$private(),M(U,"$anchor",function(a){var d=a.toString().match(/\/([^\/]+)$/);return d=d?d[1]:void 0,new RegExp("^(?:"+a.source+")",d)})},Opal.modules["bcdice/normalize"]=function(e){var w,H,I,F=e.module,M=e.eqeqeq,c=e.def,P=e.eqeq,T=[],S=e.nil;return w=T,I=[F(T[0],"BCDice")].concat(w),(H=F(I[0],"Normalize")).$module_function(),c(H,"$comparison_operator",function(U){var L;return M(/<=|=</,L=U)?"<=":M(/>=|=>/,L)?">=":M(/<>|!=|=!/,L)?"!=":M(/</,L)?"<":M(/>/,L)?">":M(/=/,L)?"==":S}),c(H,"$target_number",function(U){return P(U,"?")?U:U.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var K,V,k,r,s,b,z,a,L,F=e.module,M=e.klass,c=e.const_set,P=e.hash2,T=e.truthy,S=e.send,G=e.def,w=e.thrower,E=e.top,I=[],D=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),K=I,V=L=[F(I[0],"BCDice")].concat(K),k=a=[F(L[0],"Command")].concat(V),s=[r=M(a[0],null,"Lexer")].concat(k),b=e.$r(s),(z=r.$$prototype).scanner=z.notations=D,c(s[0],"SYMBOLS",P(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),G(r,"$initialize",function(g,f){var y,m,u;return g=T(u=(y=(m=g)===D||null==m?D:m.$split(" ",2))===D||null==y?D:y.$first())?u:"",this.scanner=b("StringScanner").$new(g),this.notations=S(f,"map",[],function(_){return null==_&&(_=D),T(_["$is_a?"](b("String")))?b("Regexp").$new(_):_})}),G(r,"$next_token",function(){try{var g=w("return"),f=this,y=D,m=D,u=D,v=D;return T(f.scanner["$eos?"]())?[!1,"$"]:(S(f.notations,"each",[],function _(A){var o,x=null==_.$$s?this:_.$$s;if(null==x.scanner&&(x.scanner=D),null==A&&(A=D),o=x.scanner.$scan(A),!T(o))return D;g.$throw(["NOTATION",o])},{$$s:f,$$ret:g}),T(y=f.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:T(m=f.scanner.$scan(/[<>!=]+/))?(m=b("Normalize").$comparison_operator(m),[T(m)?"CMP_OP":"ILLEGAL",m]):(u=f.scanner.$getch().$upcase(),[T(v=b("SYMBOLS")["$[]"](u))?v:u.$to_sym(),u]))}catch(_){if(_===g)return _.$v;throw _}}),G(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,K,N,a,d,n,k,L,D,F=e.module,M=e.klass,c=e.def,P=e.return_ivar,T=e.truthy,S=[],G=e.nil;return E=S,K=D=[F(S[0],"BCDice")].concat(E),N=L=[F(D[0],"Command")].concat(K),d=[a=M(L[0],null,"Parsed")].concat(N),n=e.$r(d),(k=a.$$prototype).critical=k.fumble=k.dollar=k.modify_number=k.question_target=k.target_number=k.prefix_number=k.command=k.suffix_number=k.cmp_op=G,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),c(a,"$initialize",function(){var s=this;return s.prefix_number=G,s.suffix_number=G,s.critical=G,s.fumble=G,s.dollar=G,s.cmp_op=G,s.target_number=G,s.question_target=!1}),c(a,"$question_target?",P("question_target")),c(a,"$to_s",function(s){var b=this,z=G,q=G,g=G,f=G,y=G;switch(null==s&&(s="after_command"),z=T(b.critical)?"@"+b.critical:G,q=T(b.fumble)?"#"+b.fumble:G,g=T(b.dollar)?"$"+b.dollar:G,f=n("Format").$modifier(b.modify_number),y=T(b.question_target)?"?":b.target_number,s){case"after_command":return[b.prefix_number,b.command,b.suffix_number,z,q,g,f,b.cmp_op,y].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,f,z,q,g,b.cmp_op,y].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,f,b.cmp_op,y,z,q,g].$join();default:return G}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var s,g,v,o,i,R,t,l,$,j,J,Q,se,_,A,x,te,y,m,z,F=e.klass,M=e.module,c=e.slice,P=e.extract_kwargs,T=e.ensure_kwargs,S=e.get_kwarg,G=e.send2,w=e.find_super,E=e.def,I=e.send,D=e.eqeq,H=e.thrower,K=e.hash,U=e.const_set,L=e.truthy,p=e.to_ary,V=e.hash2,N=e.top,a=[],d=e.$r(a),n=e.nil,k=e.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/arithmetic/node"),N.$require("bcdice/command/lexer"),N.$require("bcdice/command/parsed"),F(k(d("BCDice"),"Command"),k(d("Racc"),"Parser"),"Parser"),s=a,g=z=[M(a[0],"BCDice")].concat(s),y=[M(z[0],"Command")].concat(g),m=e.$r(y),v=y,A=[_=F(y[0],k(m("Racc"),"Parser"),"Parser")].concat(v),x=e.$r(A),(te=_.$$prototype).notations=te.lexer=te.modifier=te.suffix_number=te.prefix_number=te.need_suffix_number=te.need_prefix_number=te.critical=te.fumble=te.dollar=te.allowed_cmp_op=te.question_target=n,E(_,"$initialize",function W(C,Z){var Y,B,ee,O,X=this;return W.$$p=null,Y=c(arguments),B=P(Y),B=T(B),ee=Y,O=S(B,"round_type"),G(X,w(X,"initialize",W,!1,!0),"initialize",[],null),X.notations=ee,X.round_type=O,X.prefix_number=!1,X.suffix_number=!1,X.need_prefix_number=!1,X.need_suffix_number=!1,X.modifier=!0,X.critical=!1,X.fumble=!1,X.dollar=!1,X.allowed_cmp_op=[n,">=",">","<=","<","==","!="],X.question_target=!1},-2),E(_,"$disable_modifier",function(){return this.modifier=!1,this}),E(_,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(_,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(_,"$has_prefix_number",function(){var C=this;return C.prefix_number=!0,C.need_prefix_number=!0,C}),E(_,"$has_suffix_number",function(){var C=this;return C.suffix_number=!0,C.need_suffix_number=!0,C}),E(_,"$enable_critical",function(){return this.critical=!0,this}),E(_,"$enable_fumble",function(){return this.fumble=!0,this}),E(_,"$enable_dollar",function(){return this.dollar=!0,this}),E(_,"$restrict_cmp_op_to",function(C){var Z,B=this;return Z=c(arguments),B.allowed_cmp_op=Z,B},-1),E(_,"$enable_question_target",function(){return this.question_target=!0,this}),E(_,"$parse",function(C){var Z=this;try{return Z.lexer=x("Lexer").$new(C,Z.notations),Z.$do_parse()}catch(Y){if(!e.rescue(Y,[x("ParseError"),x("ZeroDivisionError")]))throw Y;try{return n}finally{e.pop_exception()}}}),_.$private(),E(_,"$parsed",function(C,Z,Y,B){try{return H("eval_return"),I(x("Parsed").$new(),"tap",[],function re(X){var ae,ce,oe,fe,de,le,me,_e=null==re.$$s?this:re.$$s;return null==_e.round_type&&(_e.round_type=n),null==X&&(X=n),X["$command="](C["$[]"]("command")),X["$prefix_number="]((ae=C["$[]"]("prefix"))===n||null==ae?n:ae.$eval(_e.round_type)),X["$suffix_number="]((ce=C["$[]"]("suffix"))===n||null==ce?n:ce.$eval(_e.round_type)),X["$critical="]((oe=Z["$[]"]("critical"))===n||null==oe?n:oe.$eval(_e.round_type)),X["$fumble="]((fe=Z["$[]"]("fumble"))===n||null==fe?n:fe.$eval(_e.round_type)),X["$dollar="]((de=Z["$[]"]("dollar"))===n||null==de?n:de.$eval(_e.round_type)),X["$modify_number="](Y.$eval(_e.round_type)),X["$cmp_op="](B["$[]"]("cmp_op")),D(B["$[]"]("target"),"?")?(X["$question_target="](!0),I(X,"target_number=",le=[0]),le[le.length-1]):(X["$question_target="](!1),le=[(me=B["$[]"]("target"),me===n||null==me?n:me.$eval(_e.round_type))],I(X,"target_number=",le),le[le.length-1])},{$$s:this})}catch(re){if(re===e.t_eval_return)return re.$v;throw re}}),E(_,"$next_token",function(){return this.lexer.$next_token()}),o=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),i=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),R=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),t=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),l=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),$=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),j=[n,6,13,3,9,-1,27,-15,-10,-1,-38],J=[n,n,n,n,n,n,19,16,15,n,n],Q=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),se=K(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),U(A[0],"Racc_arg",[o,i,t,R,l,$,J,j,19,Q,se,58,35,!0]),U(A[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),U(A[0],"Racc_debug_parser",!1),E(_,"$_reduce_1",function(C,Z,Y){var B,O=this;return L(O.modifier)||O.$raise(x("ParseError")),B=p(C),O.$parsed(null==B[0]?n:B[0],null==B[1]?n:B[1],null==B[2]?n:B[2],null==B[3]?n:B[3])}),E(_,"$_reduce_2",function(C,Z,Y){var B,O=this;return L(O.modifier)||O.$raise(x("ParseError")),B=p(C),O.$parsed(null==B[0]?n:B[0],null==B[2]?n:B[2],null==B[1]?n:B[1],null==B[3]?n:B[3])}),E(_,"$_reduce_3",function(C,Z,Y){var B,ae;return ae=null==(B=p(C))[2]?n:B[2],this.$parsed(null==B[0]?n:B[0],null==B[1]?n:B[1],k(k(x("Arithmetic"),"Node"),"Number").$new(0),ae)}),E(_,"$_reduce_4",function(C,Z,Y){var B=this;return L(B.prefix_number)&&L(B.suffix_number)||B.$raise(x("ParseError")),V(["command","prefix","suffix"],{command:C["$[]"](1),prefix:C["$[]"](0),suffix:C["$[]"](2)})}),E(_,"$_reduce_5",function(C,Z,Y){var B=this;return L(B.prefix_number)||B.$raise(x("ParseError")),L(B.need_suffix_number)&&B.$raise(x("ParseError")),V(["command","prefix"],{command:C["$[]"](1),prefix:C["$[]"](0)})}),E(_,"$_reduce_6",function(C,Z,Y){var B=this;return L(B.suffix_number)||B.$raise(x("ParseError")),L(B.need_prefix_number)&&B.$raise(x("ParseError")),V(["command","suffix"],{command:C["$[]"](0),suffix:C["$[]"](1)})}),E(_,"$_reduce_7",function(C,Z,Y){var B=this;return(L(B.need_prefix_number)||L(B.need_suffix_number))&&B.$raise(x("ParseError")),V(["command"],{command:C["$[]"](0)})}),E(_,"$_reduce_8",function(C,Z,Y){return V([],{})}),E(_,"$_reduce_9",function(C,Z,Y){var B,ae,re=n;return re=null==(B=p(C))[0]?n:B[0],ae=null==B[2]?n:B[2],L(this.critical)&&L(re["$[]"]("critical")["$nil?"]())||this.$raise(x("ParseError")),re["$[]="]("critical",ae),re}),E(_,"$_reduce_10",function(C,Z,Y){var B,ae,re=n;return re=null==(B=p(C))[0]?n:B[0],ae=null==B[2]?n:B[2],L(this.fumble)&&L(re["$[]"]("fumble")["$nil?"]())||this.$raise(x("ParseError")),re["$[]="]("fumble",ae),re}),E(_,"$_reduce_11",function(C,Z,Y){var B,ae,re=n;return re=null==(B=p(C))[0]?n:B[0],ae=null==B[2]?n:B[2],L(this.dollar)&&L(re["$[]"]("dollar")["$nil?"]())||this.$raise(x("ParseError")),re["$[]="]("dollar",ae),re}),E(_,"$_reduce_12",function(C,Z,Y){return C["$[]"](1)}),E(_,"$_reduce_13",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"Negative").$new(C["$[]"](1))}),E(_,"$_reduce_14",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"+",C["$[]"](2))}),E(_,"$_reduce_15",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"-",C["$[]"](2))}),E(_,"$_reduce_16",function(C,Z,Y){return L(this.allowed_cmp_op["$include?"](n))||this.$raise(x("ParseError")),V([],{})}),E(_,"$_reduce_17",function(C,Z,Y){var B,re,X;return X=null==(B=p(C))[1]?n:B[1],L(this.allowed_cmp_op["$include?"](re=null==B[0]?n:B[0]))||this.$raise(x("ParseError")),V(["cmp_op","target"],{cmp_op:re,target:X})}),E(_,"$_reduce_18",function(C,Z,Y){var ee,B=this;return ee=C["$[]"](0),L(B.question_target)||B.$raise(x("ParseError")),L(B.allowed_cmp_op["$include?"](ee))||B.$raise(x("ParseError")),V(["cmp_op","target"],{cmp_op:ee,target:"?"})}),E(_,"$_reduce_19",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"+",C["$[]"](2))}),E(_,"$_reduce_20",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"-",C["$[]"](2))}),E(_,"$_reduce_22",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"*",C["$[]"](2))}),E(_,"$_reduce_23",function(C,Z,Y){return C["$[]"](3).$new(C["$[]"](0),C["$[]"](2))}),E(_,"$_reduce_25",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(_,"$_reduce_26",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_27",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_28",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"DivideWithRound")}),E(_,"$_reduce_29",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"DivideWithFloor")}),E(_,"$_reduce_30",function(C,Z,Y){return C["$[]"](1)}),E(_,"$_reduce_31",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"Negative").$new(C["$[]"](1))}),E(_,"$_reduce_33",function(C,Z,Y){return C["$[]"](1)}),E(_,"$_reduce_34",function(C,Z,Y){return k(k(x("Arithmetic"),"Node"),"Number").$new(C["$[]"](0))}),E(_,"$_reduce_none",function(C,Z,Y){return C["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var I,U,N,a,d,n,p,H,F=e.module,M=e.send,c=e.eqeqeq,P=e.truthy,T=e.def,S=e.return_val,G=[],w=e.nil;return I=G,U=H=[F(G[0],"BCDice")].concat(I),N=p=[F(H[0],"Deprecated")].concat(U),d=[a=F(p[0],"Checker")].concat(N),n=e.$r(d),a.$private(),T(a,"$check_result_legacy",function(r,s,b,z){var y,q=this,g=w,f=w,m=w,h=w;return g=M(s,"map",[],"sides".$to_proc()),y=(f=M(s,"map",[],"value".$to_proc())).$sum(),m=c([100],h=g)?q.$check_1D100(r,y,b,z):c([20],h)?q.$check_1D20(r,y,b,z):c([6,6],h)?q.$check_2D6(r,y,f,b,z):w,(P(m["$nil?"]())||P(m["$empty?"]()))&&(m=c([10],h=g.$uniq())?q.$check_nD10(r,y,f,b,z):c([6],h)?q.$check_nD6(r,y,f,b,z):w,P(m["$nil?"]())||P(m["$empty?"]()))?w:n("Result").$new(m.$delete_prefix(" \uff1e "))}),T(a,"$check_1D100",S(w)),T(a,"$check_1D20",S(w)),T(a,"$check_nD10",S(w)),T(a,"$check_2D6",S(w)),T(a,"$check_nD6",S(w))},Opal.modules["bcdice/base"]=function(e){var d,q,h,x,i,R,u,v,_,A,f,F=e.module,M=e.klass,c=e.slice,P=e.rb_plus,T=e.truthy,S=e.def,G=e.regexp,w=e.send,E=e.thrower,I=e.return_ivar,D=e.assign_ivar_val,H=e.eqeqeq,K=e.eqeq,U=e.return_val,L=e.range,p=e.rb_minus,V=e.rb_divide,N=e.rb_times,a=e.rb_ge,n=e.top,k=[],r=e.$r(k),s=e.nil,b=e.$$$;return n.$require("i18n"),n.$require("i18n/backend/fallbacks"),n.$require("bcdice/randomizer"),n.$require("bcdice/dice_table"),n.$require("bcdice/enum"),n.$require("bcdice/translate"),n.$require("bcdice/result"),n.$require("bcdice/command/parser"),n.$require("bcdice/deprecated/checker"),q=k,h=f=[F(k[0],"BCDice")].concat(q),v=[u=M(f[0],null,"Base")].concat(h),_=e.$r(v),(A=u.$$prototype).raw_input=A.randomizer=A.enabled_upcase_input=A.debug=s,i=[x=e.get_singleton_class(u)].concat(v),R=e.$r(i),x.$attr_reader("prefixes"),S(x,"$register_prefix",function(l){var j,J=this,Q=s;return null==J.prefixes&&(J.prefixes=s),j=c(arguments),J.prefixes=P(T(Q=J.prefixes)?Q:[],j.$flatten())},-1),S(x,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),S(x,"$prefixes_pattern",function(){var l=this,$=s;return null==l.prefixes_pattern&&(l.prefixes_pattern=s),null==l.prefixes&&(l.prefixes=s),l.prefixes_pattern=T($=l.prefixes_pattern)?$:s,T(l.prefixes_pattern)?l.prefixes_pattern:(l.prefixes=T($=l.prefixes)?$:[],l.prefixes.$freeze(),l.prefixes_pattern=(T(l.prefixes["$empty?"]())?/(?!)/:G(["^(S)?(",l.prefixes.$join("|"),")"],"i")).$freeze())}),S(x,"$command_pattern",function(){var l=this,$=s,j=s;return null==l.command_pattern&&(l.command_pattern=s),null==l.prefixes&&(l.prefixes=s),l.command_pattern=T($=l.command_pattern)?$:s,T(l.command_pattern)?l.command_pattern:(l.prefixes=T($=l.prefixes)?$:[],l.prefixes.$freeze(),j=P(w(b(R("CommonCommand"),"COMMANDS"),"map",[],function(Q){return null==Q&&(Q=s),b(Q,"PREFIX_PATTERN").$source()}),l.prefixes),l.command_pattern=G(["^S?(",j.$join("|"),")"],"i").$freeze())}),S(x,"$eval",function(l){try{return E("eval_return"),this.$new(l).$eval()}catch(J){if(J===e.t_eval_return)return J.$v;throw J}}),u.$include(_("Translate")),u.$include(b(_("Deprecated"),"Checker")),S(u,"$initialize",function(o){var i=this;return i.raw_input=o,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=b(_("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=b(_("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=s,i.reroll_dice_reroll_threshold=s,i.default_cmp_op=s,i.default_target_number=s,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=b(_("BCDice"),"Randomizer").$new(),i.debug=!1}),u.$attr_accessor("randomizer"),u.$attr_reader("d66_sort_type"),u.$attr_reader("round_type"),u.$attr_reader("sides_implicit_d"),u.$attr_reader("upper_dice_reroll_threshold"),u.$attr_reader("reroll_dice_reroll_threshold"),u.$attr_reader("default_cmp_op"),u.$attr_reader("default_target_number"),S(u,"$sort_add_dice?",I("sort_add_dice")),S(u,"$sort_barabara_dice?",I("sort_barabara_dice")),S(u,"$enabled_d9?",I("enabled_d9")),S(u,"$enable_debug",D("debug",!0)),S(u,"$eval",function(){var i,t,o=this,R=s;return i=b(_("BCDice"),"Preprocessor").$process(o.raw_input,o),R=T(t=o.$dice_command(i))?t:o.$eval_common_command(o.raw_input),T(R)?(R["$rands="](o.randomizer.$rand_results()),R["$detailed_rands="](o.randomizer.$detailed_rand_results()),R):s}),S(u,"$change_text",function(o){return o}),S(u,"$check_result",function(o,i,R,t){var l=this,$=s,j=s,J=s,Q=s,ne=s;return $=l.$check_result_legacy(o,i,R,t),T($)?$:(j=w(i,"map",[],"sides".$to_proc()),Q=(J=w(i,"map",[],"value".$to_proc())).$sum(),$=H([100],ne=j)?l.$result_1d100(o,Q,R,t):H([20],ne)?l.$result_1d20(o,Q,R,t):H([6,6],ne)?l.$result_2d6(o,Q,J,R,t):s,K($,_("Result").$nothing())?s:T($)?$:($=H([10],ne=j.$uniq())?l.$result_nd10(o,Q,J,R,t):H([6],ne)?l.$result_nd6(o,Q,J,R,t):s,K($,_("Result").$nothing())?s:T($)?$:l.$result_ndx(o,R,t)))}),S(u,"$grich_text",U(s)),u.$private(),S(u,"$eval_common_command",function(o){try{E("eval_return");var R=E("return");return o=this.$change_text(o),w(b(_("CommonCommand"),"COMMANDS"),"each",[],function l($){var J,j=null==l.$$s?this:l.$$s;if(null==j.randomizer&&(j.randomizer=s),null==$&&($=s),J=$.$eval(o,j,j.randomizer),!T(J))return s;R.$throw(J)},{$$s:this,$$ret:R}),s}catch(l){if(l===e.t_eval_return||l===R)return l.$v;throw l}}),S(u,"$dice_command",function(o){var i=this,R=s,t=s,l=s,$=s;return T(i.enabled_upcase_input)&&(o=o.$upcase()),R=i.$class().$prefixes_pattern().$match(o),T(R)?(t=R["$[]"](1)["$nil?"]()["$!"](),T(t)&&(o=o["$[]"](L(1,-1,!1))),l=i.$eval_game_system_specific_command(o),T(l["$is_a?"](_("Result")))?(l["$secret="](T($=l["$secret?"]())?$:t),l):T(l["$nil?"]())||T(l["$empty?"]())||K(l,"1")?s:w(_("Result").$new(),"tap",[],function(J){var Q;return null==J&&(J=s),J["$text="](l.$to_s()),w(J,"secret=",Q=[t]),Q[Q.length-1]})):s}),S(u,"$eval_game_system_specific_command",U(s)),S(u,"$result_ndx",function(o,i,R){return T(R["$is_a?"](_("String")))?s:T(o.$send(i,R))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))}),S(u,"$result_1d100",U(s)),S(u,"$result_1d20",U(s)),S(u,"$result_nd10",U(s)),S(u,"$result_2d6",U(s)),S(u,"$result_nd6",U(s)),S(u,"$get_table_by_2d6",function(o){return this.$get_table_by_nD6(o,2)}),S(u,"$get_table_by_1d6",function(o){return this.$get_table_by_nD6(o,1)}),S(u,"$get_table_by_nD6",function(o,i){return this.$get_table_by_nDx(o,i,6)}),S(u,"$get_table_by_nDx",function(o,i,R){var l,$=s;return l=this.randomizer.$roll_sum(i,R),$=this.$get_table_value(o["$[]"](p(l,i))),T($["$nil?"]())?["1",0]:[$,l]}),S(u,"$get_table_by_1d3",function(o){var t,l,i=this,$=s;return i.$debug("get_table_by_1d3"),t=i.randomizer.$roll_sum(1,6),i.$debug("num",t),l=V(p(t,1),2).$to_i(),i.$debug("index",l),$=o["$[]"](l),T($["$nil?"]())?["1",0]:[$,t]}),S(u,"$get_table_by_d66_swap",function(o){var R;return R=this.randomizer.$roll_d66(b(_("D66SortType"),"ASC")),[this.$get_table_by_number(R,o),R]}),S(u,"$get_table_by_d66",function(o){var R,t,l,j,$=s;return R=this.randomizer.$roll_once(6),t=this.randomizer.$roll_once(6),l=P(N(p(R,1),6),p(t,1)),$=o["$[]"](l),j=""+R+t,T($["$nil?"]())?["1",j]:[$,j]}),S(u,"$get_table_by_number",function(o,i,R){try{var t=E("return");return null==R&&(R="1"),w(i,"each",[],function $(j){var Q,J=null==$.$$s?this:$.$$s;if(null==j&&(j=s),Q=j["$[]"](0),!T(a(Q,o)))return s;t.$throw(J.$get_table_value(j["$[]"](1)))},{$$s:this,$$ret:t}),this.$get_table_value(R)}catch($){if($===t)return $.$v;throw $}},-3),S(u,"$get_table_value",function(o){return T(o["$is_a?"](_("Proc")))?o.$call():o}),S(u,"$roll_tables",function(o,i){var t=s;return t=i["$[]"](o),T(t)?t.$roll(this.randomizer).$to_s():s}),S(u,"$debug",function(o,i){var t,l=this,$=s,j=s;return t=c(arguments,1),T(l.debug)?($=T(o["$is_a?"](_("String")))?o:o.$inspect(),T(t["$empty?"]())?l.$warn($):(j=w(t,"map",[],function(Q){return null==Q&&(Q=s),T(Q["$is_a?"](_("String")))?'"'+Q+'"':Q.$inspect()}),l.$warn($+": "+j.$join(", ")))):s},-2),b(b(r("I18n"),"Backend"),"Simple").$include(b(b(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),d=[["ja_jp"]],w(r("I18n").$fallbacks(),"defaults=",d),d[d.length-1]},Opal.modules["bcdice/game_system/DesperateRun"]=function(e){var n,b,m,h,u,v,q,g,r,F=e.module,M=e.klass,c=e.const_set,P=e.hash2,T=e.send2,S=e.find_super,G=e.def,w=e.truthy,E=e.to_ary,I=e.rb_plus,D=e.range,H=e.neqeq,K=e.eqeq,U=e.rb_ge,L=e.rb_minus,V=[],N=e.nil,a=e.$$$;return e.top.$require("bcdice/base"),n=V,b=r=[F(V[0],"BCDice")].concat(n),q=[F(r[0],"GameSystem")].concat(b),g=e.$r(q),m=q,u=[h=M(q[0],g("Base"),"DesperateRun")].concat(m),v=e.$r(u),h.$$prototype.randomizer=N,c(u[0],"ID","DesperateRun"),c(u[0],"NAME","Desperate Run TRPG"),c(u[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),c(u[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),c(u[0],"TABLES",P(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:a(v("DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:a(v("DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:a(v("DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:a(v("DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:a(v("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:a(v("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),h.$register_prefix("RC","DDC",v("TABLES").$keys()),G(h,"$initialize",function A(x){var i=this;return A.$$p=null,T(i,S(i,"initialize",A,!1,!0),"initialize",[x],null),i.sort_add_dice=!0,i.d66_sort_type=a(v("D66SortType"),"ASC")}),h.$private(),G(h,"$eval_game_system_specific_command",function(x){var i,R,o=this;return w(i=w(R=o.$check_roll(x))?R:o.$ddc_table(x))?i:o.$roll_tables(x,a(o.$class(),"TABLES"))}),G(h,"$check_roll",function(x){var o,i,l=N,$=N,j=N,J=N,Q=N,ne=N,$e=N,se=N,ie=N;return l=a(v("Command"),"Parser").$new(/RC\d+/,P(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(N).$parse(x),w(l)?(i=this.randomizer.$roll_barabara(2,6),o=E(i),J=I($=null==o[0]?N:o[0],j=null==o[1]?N:o[1]),Q=I(I($,j),l.$modify_number()),ne=l.$command()["$[]"](D(2,-1,!1)).$to_i(),H(l.$modify_number(),0)&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+l.$modify_number()),ie=["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+ne+$e,"\u51fa\u76ee\uff1a"+$+"\u3001"+j,(se=K($,j)?v("Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):K(J,7)?v("Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):w(U(Q,ne))?v("Result").$success(Q+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):v("Result").$failure(Q+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011")).$text()],se["$text="](ie.$join(" \uff1e ")),se):N}),G(h,"$ddc_table",function(x){var o,i,t=N,l=N,$=N,j=N,J=N;return H(x,"DDC")?N:(i=this.randomizer.$roll_barabara(2,6),i=[t=null==(o=E(i))[0]?N:o[0],l=null==o[1]?N:o[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+t+"\u3001"+l+" \uff1e "+(j=null==(o=E(i))[1]?N:o[1])+"-"+($=null==o[0]?N:o[0])+"="+(J=L(j,$))+" \uff1e \u96e3\u6613\u5ea6"+I(5,J))})},Opal.queue(function(e){var I,U,d,n,k,r,p,V,H,F=e.module,M=e.klass,c=e.const_set,P=e.hash2,S=[],w=e.$$$;return e.top.$require("bcdice/game_system/DesperateRun"),I=S,U=H=[F(S[0],"BCDice")].concat(I),p=[F(H[0],"GameSystem")].concat(U),V=e.$r(p),d=p,k=[n=M(p[0],V("DesperateRun"),"JekyllAndHyde")].concat(d),r=e.$r(k),c(k[0],"ID","JekyllAndHyde"),c(k[0],"NAME","\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9"),c(k[0],"SORT_KEY","\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089"),c(k[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u76ee\u6a19\u6c7a\u5b9a\u8868\u3000GOALT\n"),c(k[0],"TABLES",P(["GOALT"],{GOALT:w(r("DiceTable"),"Table").$new("\u76ee\u6a19\u6c7a\u5b9a\u8868","1D6",["\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d\u306e\u3069\u308c\u304b\u3092\u81ea\u7531\u306b\u9078\u3079\u308b"])}).$freeze()),n.$register_prefix("RC","DDC",r("TABLES").$keys())})}}]);