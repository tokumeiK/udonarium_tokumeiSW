(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[6447],{9464:(oe,ce,Y)=>{Y(9993),Opal.queue(function(o){var le,ue,_e,c,H,x,P,p,se,I,q=o.module,J=o.klass,F=o.const_set,Q=o.send2,U=o.find_super,V=o.range,g=o.def,y=o.eqeqeq,a=o.truthy,v=o.rb_le,b=o.rb_plus,T=o.eqeq,S=o.send,W=o.rb_times,C=o.rb_ge,B=o.rb_divide,L=o.rb_lt,X=o.rb_gt,Z=o.hash2,w=o.to_ary,A=o.rb_minus,O=o.thrower,ee=o.not,z=[],e=o.nil;return le=z,ue=I=[q(z[0],"BCDice")].concat(le),p=[q(I[0],"GameSystem")].concat(ue),se=o.$r(p),_e=p,H=[c=J(p[0],se("Base"),"Cthulhu7th_ChineseTraditional")].concat(_e),x=o.$r(H),(P=c.$$prototype).bonus_dice_range=P.randomizer=e,F(H[0],"ID","Cthulhu7th:ChineseTraditional"),F(H[0],"NAME","\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248"),F(H[0],"SORT_KEY","\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248"),F(H[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u3000CC(x)<=\uff08\u76ee\u6a19\u5024\uff09\n\u3000x\uff1a\u734e\u52f5\u9ab0/\u61f2\u7f70\u9ab0\uff1aBonus/Penalty Dice (2\uff5e\uff0d2)\u3002\u6c92\u6709\u7684\u8a71\u53ef\u4ee5\u7701\u7565\u3002\n\u3000\u81f4\u547d\u7684\u5931\u6557\uff1aFumble\uff0f\u5931\u6557\uff1aFailure\uff0f\u901a\u5e38\u6210\u529f\uff1aRegular success\uff0f\n\u3000\u56f0\u96e3\u6210\u529f\uff1aHard success\uff0f\u6975\u9650\u6210\u529f\uff1aExtreme success\uff0f\n\u3000\u6c7a\u5b9a\u6027\u7684\u6210\u529f\uff1aCritical success\u3000\u81ea\u52d5\u5224\u5b9a\u3002\n\u4f8b\uff09CC<=30\u3000CC(2)<=50\u3000CC(-1)<=75\n\n\u30fb\u7d44\u5408\u5224\u5b9a\u3000(CBR(x,y))\n\u3000\u9032\u884c\u76ee\u6a19\u5024 x \u548c y \u7684\u5224\u5b9a\u3002\n\u3000\u4f8b\uff09CBR(50,20)\n\n\u30fb\u9023\u5c04\uff08Full Auto\uff09\u5224\u5b9a\u3000FAR(w,x,y,z)\n\u3000w\uff1a\u5f48\u6578(1\uff5e100\uff09\u3001x\uff1a\u6280\u80fd\u5024\uff081\uff5e100\uff09\u3001y\uff1a\u6545\u969c\u7387\n\u3000z\uff1a\u734e\u52f5\u3001\u61f2\u7f70\u9ab0(-2\uff5e2)\u3002\u53ef\u7701\u7565\u3002\n\u3000\u53ea\u8a08\u7b97\u547d\u4e2d\u6578\u3001\u8cab\u7a7f\u6578\u53ca\u5269\u9918\u5f48\u85e5\uff0c\u4e0d\u8a08\u7b97\u50b7\u5bb3\u3002\n\u4f8b\uff09FAR(25,70,98)\u3000FAR(50,80,98,-1)\n\n\u30fb\u760b\u72c2\u8868\n\u30fb\u5be6\u6642\u578b\u3000Short\uff0f\u7e3d\u7d50\u578b\u3000Longer\n"),c.$register_prefix("CC","CBR","FAR"),g(c,"$initialize",function f(l){var i=this;return f.$$p=null,Q(i,U(i,"initialize",f,!1,!0),"initialize",[l],null),i.bonus_dice_range=V(-2,2,!1)}),g(c,"$eval_game_system_specific_command",function(l){var i,t=this;return y(/CC/i,i=l)?t.$getCheckResult(l):y(/CBR/i,i)?t.$getCombineRoll(l):y(/FAR/i,i)?t.$getFullAutoResult(l):e}),g(c,"$getCheckResult",function(l){var i,u,t=this,r=e,_=e,s=e,$=e,n=e;return a(/^CC([-\d]+)?<=(\d+)/i["$=~"](l)),i=x("Regexp").$last_match(1).$to_i(),u=x("Regexp").$last_match(2).$to_i(),a(v(u,0))?"\u932f\u8aa4\u3002\u76ee\u6a19\u503c\u9700\u70ba1\u4ee5\u4e0a\u3002":a(t.bonus_dice_range["$include?"](i))?(r=b(r="","(1D100<="+u+")"),r=b(r," \u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024["+i+"]"),_=t.$rollPercentD10(),s=t.$getTotalLists(i,_),$=t.$getTotal(s,i),n=t.$getCheckResultText($,u),r=b(r," \uff1e "+s.$join(", ")+" \uff1e "+$+" \uff1e "+n)):"\u932f\u8aa4\u3002\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024\u70ba"+t.bonus_dice_range.$min()+"\uff5e"+t.bonus_dice_range.$max()+"\u3002"}),g(c,"$rollPercentD10",function(){var t=e;return t=this.randomizer.$roll_once(10),T(t,10)&&(t=0),t}),g(c,"$getTotalLists",function(l,t){var r,u=e;return u=[],r=b(1,l.$abs()),S(r,"times",[],function _(){var $,n=e;return $=(null==_.$$s?this:_.$$s).$rollPercentD10(),n=b(W($,10),t),T(n,0)&&(n=100),u.$push(n)},{$$s:this}),u}),g(c,"$getTotal",function(l,t){return a(C(t,0))?l.$min():l.$max()}),g(c,"$getCheckResultText",function(l,t,i){var u;if(null==i&&(i=!1),a(v(l,t)))return T(l,1)?"\u6c7a\u5b9a\u6027\u7684\u6210\u529f":a(v(l,B(t,5).$to_i()))?"\u6975\u9650\u7684\u6210\u529f":a(v(l,B(t,2).$to_i()))?"\u56f0\u96e3\u7684\u6210\u529f":"\u901a\u5e38\u6210\u529f";if(u="\u81f4\u547d\u7684\u5931\u6557",T(l,100))return u;if(a(C(l,96))){if(a(L(t,50)))return u;if(a(i))return u}return"\u5931\u6557"},-3),g(c,"$getCombineRoll",function(l){var t=this,i=e,u=e,r=e,_=e,s=e,$=e,n=e;return a(/CBR\((\d+),(\d+)\)/i["$=~"](l))?(i=x("Regexp").$last_match(1).$to_i(),u=x("Regexp").$last_match(2).$to_i(),r=t.randomizer.$roll_once(100),_=t.$getCheckResultText(r,i),s=t.$getCheckResultText(r,u),n=0,a(($=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f","\u56f0\u96e3\u7684\u6210\u529f","\u901a\u5e38\u6210\u529f"])["$include?"](_))&&(n=b(n,1)),a($["$include?"](s))&&(n=b(n,1)),t.$debug("succesCount",n),"(1d100<="+i+","+u+") \uff1e "+r+"["+_+","+s+"] \uff1e "+(a(C(n,2))?"\u6210\u529f":T(n,1)?"\u90e8\u5206\u7684\u6210\u529f":"\u5931\u6557")):e}),g(c,"$getFullAutoResult",function(l){var t=this,i=e,u=e,r=e,_=e,s=e,$=e,n=e;return a(/^FAR\((-?\d+)(,(-?\d+))(,(-?\d+))(,(-?\d+))?\)/i["$=~"](l))?(i=x("Regexp").$last_match(1).$to_i(),u=x("Regexp").$last_match(3).$to_i(),r=x("Regexp").$last_match(5).$to_i(),_=(a(s=x("Regexp").$last_match(7))?s:0).$to_i(),$="",a(X(i,n=100))&&($=b($,"\n\u5f48\u85e5\u592a\u591a\u3002\u8acb\u6539\u88dd\u586b"+n+"\u767c\u3002\n"),i=n),a(v(i,0))?"\u6b63\u78ba\u88dd\u586b\u6578\u3002":a(v(u,0))?"\u6b63\u78ba\u76ee\u6a19\u503c\u3002":(a(L(r,0))&&($=b($,"\n\u6b63\u78ba\u6545\u969c\u503c\u3002\u6392\u9664\u734e\u52f5\u8a18\u865f\u3002\n"),r=r.$abs()),a(t.bonus_dice_range["$include?"](_))?($=b($,"\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024["+_+"]"),$=b($,t.$rollFullAuto(i,u,r,_))):"\n\u932f\u8aa4\u3002\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024\u70ba"+t.bonus_dice_range.$min()+"\uff5e"+t.bonus_dice_range.$max()+"\u3067\u3059\u3002")):e}),g(c,"$rollFullAuto",function(l,t,i,u){try{var r=O("return"),s=e,$=e,n=e;return s="",$=0,n=Z(["hit_bullet","impale_bullet","bullet"],{hit_bullet:0,impale_bullet:0,bullet:l}),S(4,"times",[],function h(m){var d,k,R=null==h.$$s?this:h.$$s,D=e,E=e,N=e,j=e,G=e,K=e;for(null==R.bonus_dice_range&&(R.bonus_dice_range=e),null==m&&(m=e),s=b(s,R.$getNextDifficltyMessage(m));a(C(u,R.bonus_dice_range.$min()));)$=b($,1),k=R.$getHitResultInfos(u,t,m),D=null==(d=w(k))[0]?e:d[0],E=null==d[1]?e:d[1],s=b(s,"\n"+$+"\u6b21: \uff1e "+(null==d[2]?e:d[2]).$join(", ")+" \uff1e "+D),a(C(E,i))&&(s=b(s,"\u5361\u5f48"),r.$throw(R.$getHitResultText(s,n))),N=R.$getHitType(m,D),k=R.$getBulletResults(n["$[]"]("bullet"),N,t),j=null==(d=w(k))[0]?e:d[0],G=null==d[1]?e:d[1],K=null==d[2]?e:d[2],n["$[]="]("hit_bullet",b(n["$[]"]("hit_bullet"),j)),n["$[]="]("impale_bullet",b(n["$[]"]("impale_bullet"),G)),n["$[]="]("bullet",A(n["$[]"]("bullet"),K)),a(v(n["$[]"]("bullet"),0))&&r.$throw(R.$getHitResultText(s,n)),u=A(u,1);return u=b(u,1)},{$$s:this,$$ret:r}),this.$getHitResultText(s,n)}catch(h){if(h===r)return h.$v;throw h}}),g(c,"$getHitResultInfos",function(l,t,i){var r,_,s,$,u=this;return r=u.$rollPercentD10(),_=u.$getTotalLists(l,r),s=u.$getTotal(_,l),$=u.$getFumbleable(i),[u.$getCheckResultText(s,t,$),s,_]}),g(c,"$getHitResultText",function(l,t){return l+"\n\uff1e "+t["$[]"]("hit_bullet")+"\u767c\u5c04\u64ca\u547d\u4e2d\u3001"+t["$[]"]("impale_bullet")+"\u5c04\u64ca\u8cab\u7a7f\u3001\u5269\u9918\u5f48\u85e5"+t["$[]"]("bullet")+"\u767c"}),g(c,"$getHitType",function(l,t){var i,u,s=e;return u=this.$getSuccessListImpaleBulletList(l),s=null==(i=w(u))[1]?e:i[1],a((null==i[0]?e:i[0])["$include?"](t))?"hit":a(s["$include?"](t))?"impale":""}),g(c,"$getBulletResults",function(l,t,i){var r,_,u=this,s=e,$=e,n=e,h=e,m=e;if(r=u.$getSetOfBullet(i),_=u.$getHitBulletCountBase(i,r),s=B(r,2..$to_f()),$=0,n=0,h=0,ee(u.$isLastBulletTurn(l,r))){switch(t){case"hit":n=_;break;case"impale":n=s.$floor(),h=s.$ceil()}$=r}else{switch(t){case"hit":n=u.$getLastHitBulletCount(l);break;case"impale":n=(m=B(l,2..$to_f())).$floor(),h=m.$ceil()}$=l}return[n,h,$]}),g(c,"$getSuccessListImpaleBulletList",function(l){var t=e,i=e;switch(t=[],i=[],l){case 0:t=["\u56f0\u96e3\u7684\u6210\u529f","\u901a\u5e38\u6210\u529f"],i=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"];break;case 1:t=["\u56f0\u96e3\u7684\u6210\u529f"],i=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"];break;case 2:t=[],i=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"];break;case 3:t=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f"],i=[]}return[t,i]}),g(c,"$getNextDifficltyMessage",function(l){switch(l){case 1:return"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u56f0\u96e3\u7684\u6210\u529f";case 2:return"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u6975\u9650\u7684\u6210\u529f";case 3:return"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u6c7a\u5b9a\u6027\u7684\u6210\u529f"}return""}),g(c,"$getSetOfBullet",function(l){var t=e;return t=B(l,10).$to_i(),a(C(l,1))&&a(L(l,10))&&(t=1),t}),g(c,"$getHitBulletCountBase",function(l,t){var i=e;return i=B(t,2).$to_i(),a(C(l,1))&&a(L(l,10))&&(i=1),i}),g(c,"$isLastBulletTurn",function(l,t){return L(A(l,t),0)}),g(c,"$getLastHitBulletCount",function(l){return T(l,1)?1:B(l,2..$to_f()).$floor()}),g(c,"$getFumbleable",function(l){return C(l,1)})})}}]);