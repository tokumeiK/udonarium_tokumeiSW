(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{7849:(E,de,ye)=>{"use strict";function f(n){return"function"==typeof n}function T(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const ne=T(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function v(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class S{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(f(i))try{i()}catch(o){t=o instanceof ne?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{J(o)}catch(s){t=null!=t?t:[],s instanceof ne?t=[...t,...s.errors]:t.push(s)}}if(t)throw new ne(t)}}add(t){var e;if(t&&t!==this)if(this.closed)J(t);else{if(t instanceof S){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&v(e,t)}remove(t){const{_finalizers:e}=this;e&&v(e,t),t instanceof S&&t._removeParent(this)}}S.EMPTY=(()=>{const n=new S;return n.closed=!0,n})();const L=S.EMPTY;function D(n){return n instanceof S||n&&"closed"in n&&f(n.remove)&&f(n.add)&&f(n.unsubscribe)}function J(n){f(n)?n():n.unsubscribe()}const j={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},F={setTimeout(n,t,...e){const{delegate:i}=F;return(null==i?void 0:i.setTimeout)?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=F;return((null==t?void 0:t.clearTimeout)||clearTimeout)(n)},delegate:void 0};function Z(n){F.setTimeout(()=>{const{onUnhandledError:t}=j;if(!t)throw n;t(n)})}function X(){}const K=le("C",void 0,void 0);function le(n,t,e){return{kind:n,value:t,error:e}}let q=null;function Y(n){if(j.useDeprecatedSynchronousErrorHandling){const t=!q;if(t&&(q={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=q;if(q=null,e)throw i}}else n()}class k extends S{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,D(t)&&t.add(this)):this.destination=z}static create(t,e,i){return new I(t,e,i)}next(t){this.isStopped?R(function H(n){return le("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?R(function P(n){return le("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?R(K,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const N=Function.prototype.bind;function te(n,t){return N.call(n,t)}class U{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){A(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){A(i)}else A(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){A(e)}}}class I extends k{constructor(t,e,i){let r;if(super(),f(t)||!t)r={next:null!=t?t:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let o;this&&j.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&te(t.next,o),error:t.error&&te(t.error,o),complete:t.complete&&te(t.complete,o)}):r=t}this.destination=new U(r)}}function A(n){j.useDeprecatedSynchronousErrorHandling?function Q(n){j.useDeprecatedSynchronousErrorHandling&&q&&(q.errorThrown=!0,q.error=n)}(n):Z(n)}function R(n,t){const{onStoppedNotification:e}=j;e&&F.setTimeout(()=>e(n,t))}const z={closed:!0,next:X,error:function y(n){throw n},complete:X},ie="function"==typeof Symbol&&Symbol.observable||"@@observable";function M(n){return n}function ge(...n){return B(n)}function B(n){return 0===n.length?M:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let O=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function c(n){return n&&n instanceof k||function l(n){return n&&f(n.next)&&f(n.error)&&f(n.complete)}(n)&&D(n)}(e)?e:new I(e,i,r);return Y(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=_(i))((r,o)=>{const s=new I({next:a=>{try{e(a)}catch(g){o(g),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ie](){return this}pipe(...e){return B(e)(this)}toPromise(e){return new(e=_(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=t=>new n(t),n})();function _(n){var t;return null!==(t=null!=n?n:j.Promise)&&void 0!==t?t:Promise}const h=T(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let d=(()=>{class n extends O{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new p(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new h}next(e){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Y(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?L:(this.currentObservers=null,o.push(e),new S(()=>{this.currentObservers=null,v(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new O;return e.source=this,e}}return n.create=(t,e)=>new p(t,e),n})();class p extends d{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:L}}function m(n){return f(null==n?void 0:n.lift)}function x(n){return t=>{if(m(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function $(n,t,e,i,r){return new re(n,t,e,i,r)}class re extends k{constructor(t,e,i,r,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(g){t.error(g)}}:super._next,this._error=r?function(a){try{r(a)}catch(g){t.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function se(n,t){return x((e,i)=>{let r=0;e.subscribe($(i,o=>{i.next(n.call(t,o,r++))}))})}var De=function(n,t){return(De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(n,t)};function Ae(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}De(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var fe=function(){return fe=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},fe.apply(this,arguments)};function be(n,t,e,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o}function Fe(n){return this instanceof Fe?(this.v=n,this):new Fe(n)}function Ue(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(ve){i[ve]&&(r[ve]=function(Ie){return new Promise(function(Oe,Ve){o.push([ve,Ie,Oe,Ve])>1||a(ve,Ie)})})}function a(ve,Ie){try{!function g(ve){ve.value instanceof Fe?Promise.resolve(ve.value.v).then(w,G):me(o[0][2],ve)}(i[ve](Ie))}catch(Oe){me(o[0][3],Oe)}}function w(ve){a("next",ve)}function G(ve){a("throw",ve)}function me(ve,Ie){ve(Ie),o.shift(),o.length&&a(o[0][0],o[0][1])}}function lt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function Ee(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=n[o]&&function(s){return new Promise(function(a,g){!function r(o,s,a,g){Promise.resolve(g).then(function(w){o({value:w,done:a})},s)}(a,g,(s=n[o](s)).done,s.value)})}}}const ar=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Hs(n){return f(null==n?void 0:n.then)}function Tl(n){return f(n[ie])}function $c(n){return Symbol.asyncIterator&&f(null==n?void 0:n[Symbol.asyncIterator])}function Qo(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const yd=function Sl(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Jc(n){return f(null==n?void 0:n[yd])}function Cd(n){return Ue(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield Fe(e.read());if(r)return yield Fe(void 0);yield yield Fe(i)}}finally{e.releaseLock()}})}function eu(n){return f(null==n?void 0:n.getReader)}function Mo(n){if(n instanceof O)return n;if(null!=n){if(Tl(n))return function Og(n){return new O(t=>{const e=n[ie]();if(f(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(ar(n))return function jf(n){return new O(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Hs(n))return function Gf(n){return new O(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Z)})}(n);if($c(n))return qf(n);if(Jc(n))return function Bg(n){return new O(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(eu(n))return function xd(n){return qf(Cd(n))}(n)}throw Qo(n)}function qf(n){return new O(t=>{(function tu(n,t){var e,i,r,o;return function Me(n,t,e,i){return new(e||(e=Promise))(function(o,s){function a(G){try{w(i.next(G))}catch(me){s(me)}}function g(G){try{w(i.throw(G))}catch(me){s(me)}}function w(G){G.done?o(G.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(G.value).then(a,g)}w((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=lt(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Jo(n,t,e,i=0,r=!1){const o=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function vc(n,t,e=1/0){return f(t)?vc((i,r)=>se((o,s)=>t(i,o,r,s))(Mo(n(i,r))),e):("number"==typeof t&&(e=t),x((i,r)=>function Lg(n,t,e,i,r,o,s,a){const g=[];let w=0,G=0,me=!1;const ve=()=>{me&&!g.length&&!w&&t.complete()},Ie=Ve=>w<i?Oe(Ve):g.push(Ve),Oe=Ve=>{o&&t.next(Ve),w++;let We=!1;Mo(e(Ve,G++)).subscribe($(t,Ye=>{null==r||r(Ye),o?Ie(Ye):t.next(Ye)},()=>{We=!0},void 0,()=>{if(We)try{for(w--;g.length&&w<i;){const Ye=g.shift();s?Jo(t,s,()=>Oe(Ye)):Oe(Ye)}ve()}catch(Ye){t.error(Ye)}}))};return n.subscribe($(t,Ie,()=>{me=!0,ve()})),()=>{null==a||a()}}(i,r,n,e)))}function nu(n=1/0){return vc(M,n)}const wd=new O(n=>n.complete());function Ed(n){return n&&f(n.schedule)}function iu(n){return n[n.length-1]}function Dl(n){return f(iu(n))?n.pop():void 0}function Il(n){return Ed(iu(n))?n.pop():void 0}function ha(n,t=0){return x((e,i)=>{e.subscribe($(i,r=>Jo(i,n,()=>i.next(r),t),()=>Jo(i,n,()=>i.complete(),t),r=>Jo(i,n,()=>i.error(r),t)))})}function kl(n,t=0){return x((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function yc(n,t){if(!n)throw new Error("Iterable cannot be null");return new O(e=>{Jo(e,t,()=>{const i=n[Symbol.asyncIterator]();Jo(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function po(n,t){return t?function Ao(n,t){if(null!=n){if(Tl(n))return function bc(n,t){return Mo(n).pipe(kl(t),ha(t))}(n,t);if(ar(n))return function Ml(n,t){return new O(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(Hs(n))return function ru(n,t){return Mo(n).pipe(kl(t),ha(t))}(n,t);if($c(n))return yc(n,t);if(Jc(n))return function Hg(n,t){return new O(e=>{let i;return Jo(e,t,()=>{i=n[yd](),Jo(e,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>f(null==i?void 0:i.return)&&i.return()})}(n,t);if(eu(n))return function ou(n,t){return yc(Cd(n),t)}(n,t)}throw Qo(n)}(n,t):Mo(n)}function _o(...n){const t=Il(n),e=function Td(n,t){return"number"==typeof iu(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?Mo(i[0]):nu(e)(po(i,t)):wd}function Po(n){return n<=0?()=>wd:x((t,e)=>{let i=0;t.subscribe($(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function Fo(n,t,...e){return!0===t?(n(),null):!1===t?null:t(...e).pipe(Po(1)).subscribe(()=>n())}function Zn(n){for(let t in n)if(n[t]===Zn)return t;throw Error("Could not find renamed property on target object.")}function su(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function ci(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ci).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Za(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Ro=Zn({__forward_ref__:Zn});function ri(n){return n.__forward_ref__=ri,n.toString=function(){return ci(this())},n}function Dn(n){return au(n)?n():n}function au(n){return"function"==typeof n&&n.hasOwnProperty(Ro)&&n.__forward_ref__===ri}class Vt extends Error{constructor(t,e){super(function Ya(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function _n(n){return"string"==typeof n?n:null==n?"":String(n)}function Sr(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():_n(n)}function Cc(n,t){const e=t?` in ${t}`:"";throw new Vt(-201,`No provider for ${Sr(n)} found${e}`)}function No(n,t){null==n&&function Gi(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function Tn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function es(n){return{providers:n.providers||[],imports:n.imports||[]}}function jg(n){return Xm(n,Wf)||Xm(n,Qm)}function Xm(n,t){return n.hasOwnProperty(t)?n[t]:null}function Ni(n){return n&&(n.hasOwnProperty(Gg)||n.hasOwnProperty(Cb))?n[Gg]:null}const Wf=Zn({\u0275prov:Zn}),Gg=Zn({\u0275inj:Zn}),Qm=Zn({ngInjectableDef:Zn}),Cb=Zn({ngInjectorDef:Zn});var Rn=(()=>((Rn=Rn||{})[Rn.Default=0]="Default",Rn[Rn.Host=1]="Host",Rn[Rn.Self=2]="Self",Rn[Rn.SkipSelf=4]="SkipSelf",Rn[Rn.Optional=8]="Optional",Rn))();let qg;function Pl(n){const t=qg;return qg=n,t}function Dr(n,t,e){const i=jg(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Rn.Optional?null:void 0!==t?t:void Cc(ci(n),"Injector")}function bs(n){return{toString:n}.toString()}var ys=(()=>((ys=ys||{})[ys.OnPush=0]="OnPush",ys[ys.Default=1]="Default",ys))(),Cs=(()=>{return(n=Cs||(Cs={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Cs;var n})();const t$="undefined"!=typeof globalThis&&globalThis,n$="undefined"!=typeof window&&window,i$="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,wi=t$||"undefined"!=typeof global&&global||n$||i$,Hr={},Oi=[],Id=Zn({\u0275cmp:Zn}),ga=Zn({\u0275dir:Zn}),cu=Zn({\u0275pipe:Zn}),Zf=Zn({\u0275mod:Zn}),ui=Zn({\u0275fac:Zn}),ws=Zn({__NG_ELEMENT_ID__:Zn});let Wg=0;function Xt(n){return bs(()=>{const e={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===ys.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Oi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Cs.Emulated,id:"c",styles:n.styles||Oi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,o=n.features,s=n.pipes;return i.id+=Wg++,i.inputs=xc(n.inputs,e),i.outputs=xc(n.outputs),o&&o.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(r$):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(o$):null,i})}function r$(n){return jr(n)||function pa(n){return n[ga]||null}(n)}function o$(n){return function Ka(n){return n[cu]||null}(n)}const s$={};function ts(n){return bs(()=>{const t={type:n.type,bootstrap:n.bootstrap||Oi,declarations:n.declarations||Oi,imports:n.imports||Oi,exports:n.exports||Oi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(s$[n.id]=n.type),t})}function xc(n,t){if(null==n)return Hr;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,t&&(t[r]=o)}return e}const rn=Xt;function Vr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function jr(n){return n[Id]||null}function ns(n,t){const e=n[Zf]||null;if(!e&&!0===t)throw new Error(`Type ${ci(n)} does not have '\u0275mod' property.`);return e}function _a(n){return Array.isArray(n)&&"object"==typeof n[1]}function Gs(n){return Array.isArray(n)&&!0===n[1]}function Kg(n){return 0!=(8&n.flags)}function Sc(n){return 2==(2&n.flags)}function ot(n){return 1==(1&n.flags)}function pt(n){return null!==n.template}function gt(n){return 0!=(512&n[2])}function ma(n,t){return n.hasOwnProperty(ui)?n[ui]:null}class c${constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function vr(){return ip}function ip(n){return n.type.prototype.ngOnChanges&&(n.setInput=Qf),u$}function u$(){const n=hu(this),t=null==n?void 0:n.current;if(t){const e=n.previous;if(e===Hr)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function Qf(n,t,e,i){const r=hu(n)||function Ic(n,t){return n[rp]=t}(n,{previous:Hr,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[e],g=s[a];o[a]=new c$(g&&g.currentValue,t,s===Hr),n[i]=t}vr.ngInherit=!0;const rp="__ngSimpleChanges__";function hu(n){return n[rp]||null}let eh;function ap(){return void 0!==eh?eh:"undefined"!=typeof document?document:void 0}function Yn(n){return!!n.listen}const d$={createRenderer:(n,t)=>ap()};function cr(n){for(;Array.isArray(n);)n=n[0];return n}function Rl(n,t){return cr(t[n])}function Bo(n,t){return cr(t[n.index])}function kc(n,t){return n.data[t]}function $a(n,t){return n[t]}function ro(n,t){const e=t[n];return _a(e)?e:e[0]}function Mc(n){return 4==(4&n[2])}function lp(n){return 128==(128&n[2])}function Nl(n,t){return null==t?null:n[t]}function h$(n){n[18]=0}function cp(n,t){n[5]+=t;let e=n,i=n[3];for(;null!==i&&(1===t&&1===e[5]||-1===t&&0===e[5]);)i[5]+=t,e=i,i=i[3]}const wn={lFrame:pp(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Rd(){return wn.bindingsEnabled}function Tt(){return wn.lFrame.lView}function ni(){return wn.lFrame.tView}function ze(n){return wn.lFrame.contextLView=n,n[8]}function Wi(){let n=p$();for(;null!==n&&64===n.type;)n=n.parent;return n}function p$(){return wn.lFrame.currentTNode}function va(n,t){const e=wn.lFrame;e.currentTNode=n,e.isParent=t}function up(){return wn.lFrame.isParent}function dp(){wn.lFrame.isParent=!1}function nh(){return wn.isInCheckNoChangesMode}function ih(n){wn.isInCheckNoChangesMode=n}function mo(){const n=wn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Xa(){return wn.lFrame.bindingIndex}function $u(){return wn.lFrame.bindingIndex++}function Qa(n){const t=wn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function Nb(n,t){const e=wn.lFrame;e.bindingIndex=e.bindingRootIndex=n,fp(t)}function fp(n){wn.lFrame.currentDirectiveIndex=n}function Ss(){return wn.lFrame.currentQueryIndex}function gp(n){wn.lFrame.currentQueryIndex=n}function Ob(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function m$(n,t,e){if(e&Rn.SkipSelf){let r=t,o=n;for(;!(r=r.parent,null!==r||e&Rn.Host||(r=Ob(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;t=r,n=o}const i=wn.lFrame=$$();return i.currentTNode=t,i.lView=n,!0}function rh(n){const t=$$(),e=n[1];wn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function $$(){const n=wn.lFrame,t=null===n?null:n.child;return null===t?pp(n):t}function pp(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function _p(){const n=wn.lFrame;return wn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const v$=_p;function oh(){const n=_p();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ar(){return wn.lFrame.selectedIndex}function Bl(n){wn.lFrame.selectedIndex=n}function er(){const n=wn.lFrame;return kc(n.tView,n.selectedIndex)}function vu(){wn.lFrame.currentNamespace="svg"}function Bd(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const o=n.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:g,ngAfterViewChecked:w,ngOnDestroy:G}=o;s&&(n.contentHooks||(n.contentHooks=[])).push(-e,s),a&&((n.contentHooks||(n.contentHooks=[])).push(e,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,a)),g&&(n.viewHooks||(n.viewHooks=[])).push(-e,g),w&&((n.viewHooks||(n.viewHooks=[])).push(e,w),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,w)),null!=G&&(n.destroyHooks||(n.destroyHooks=[])).push(e,G)}}function Ld(n,t,e){vp(n,t,3,e)}function Ll(n,t,e,i){(3&n[2])===e&&vp(n,t,e,i)}function ya(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function vp(n,t,e,i){const o=null!=i?i:-1,s=t.length-1;let a=0;for(let g=void 0!==i?65535&n[18]:0;g<s;g++)if("number"==typeof t[g+1]){if(a=t[g],null!=i&&a>=i)break}else t[g]<0&&(n[18]+=65536),(a<o||-1==o)&&(Lb(n,e,t,g),n[18]=(4294901760&n[18])+g+2),g++}function Lb(n,t,e,i){const r=e[i]<0,o=e[i+1],a=n[r?-e[i]:e[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class zd{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Ud(n,t,e){const i=Yn(n);let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const s=e[r++],a=e[r++],g=e[r++];i?n.setAttribute(t,a,g,s):t.setAttributeNS(s,a,g)}else{const s=o,a=e[++r];Hd(s)?i&&n.setProperty(t,s,a):i?n.setAttribute(t,s,a):t.setAttribute(s,a),r++}}return r}function oo(n){return 3===n||4===n||6===n}function Hd(n){return 64===n.charCodeAt(0)}function ah(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||y$(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function y$(n,t,e,i,r){let o=0,s=n.length;if(-1===t)s=-1;else for(;o<n.length;){const a=n[o++];if("number"==typeof a){if(a===t){s=-1;break}if(a>t){s=o-1;break}}}for(;o<n.length;){const a=n[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(n.splice(s,0,t),o=s+1),n.splice(o++,0,e),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}function C$(n){return-1!==n}function zl(n){return 32767&n}function xa(n,t){let e=function zb(n){return n>>16}(n),i=t;for(;e>0;)i=i[15],e--;return i}let lh=!0;function ch(n){const t=lh;return lh=n,t}let Ub=0;function Cu(n,t){const e=wp(n,t);if(-1!==e)return e;const i=t[1];i.firstCreatePass&&(n.injectorIndex=t.length,xp(i.data,n),xp(t,null),xp(i.blueprint,null));const r=uh(n,t),o=n.injectorIndex;if(C$(r)){const s=zl(r),a=xa(r,t),g=a[1].data;for(let w=0;w<8;w++)t[o+w]=a[s+w]|g[s+w]}return t[o+8]=r,o}function xp(n,t){n.push(0,0,0,0,0,0,0,0,t)}function wp(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function uh(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){const o=r[1],s=o.type;if(i=2===s?o.declTNode:1===s?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function Vd(n,t,e){!function Cp(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(ws)&&(i=e[ws]),null==i&&(i=e[ws]=Ub++);const r=255&i;t.data[n+(r>>5)]|=1<<r}(n,t,e)}function w$(n,t,e){if(e&Rn.Optional)return n;Cc(t,"NodeInjector")}function dh(n,t,e,i){if(e&Rn.Optional&&void 0===i&&(i=null),0==(e&(Rn.Self|Rn.Host))){const r=n[9],o=Pl(void 0);try{return r?r.get(t,i,e&Rn.Optional):Dr(t,i,e&Rn.Optional)}finally{Pl(o)}}return w$(i,t,e)}function Tp(n,t,e,i=Rn.Default,r){if(null!==n){const o=function T$(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(ws)?n[ws]:void 0;return"number"==typeof t?t>=0?255&t:E$:t}(e);if("function"==typeof o){if(!m$(t,n,i))return i&Rn.Host?w$(r,e,i):dh(t,e,i,r);try{const s=o(i);if(null!=s||i&Rn.Optional)return s;Cc(e)}finally{v$()}}else if("number"==typeof o){let s=null,a=wp(n,t),g=-1,w=i&Rn.Host?t[16][6]:null;for((-1===a||i&Rn.SkipSelf)&&(g=-1===a?uh(n,t):t[a+8],-1!==g&&Dp(i,!1)?(s=t[1],a=zl(g),t=xa(g,t)):a=-1);-1!==a;){const G=t[1];if(S$(o,a,G.data)){const me=fh(a,t,e,s,i,w);if(me!==Sp)return me}g=t[a+8],-1!==g&&Dp(i,t[1].data[a+8]===w)&&S$(o,a,t)?(s=G,a=zl(g),t=xa(g,t)):a=-1}}}return dh(t,e,i,r)}const Sp={};function E$(){return new wu(Wi(),Tt())}function fh(n,t,e,i,r,o){const s=t[1],a=s.data[n+8],G=hh(a,s,e,null==i?Sc(a)&&lh:i!=s&&0!=(3&a.type),r&Rn.Host&&o===a);return null!==G?xu(t,s,G,a):Sp}function hh(n,t,e,i,r){const o=n.providerIndexes,s=t.data,a=1048575&o,g=n.directiveStart,G=o>>20,ve=r?a+G:n.directiveEnd;for(let Ie=i?a:a+G;Ie<ve;Ie++){const Oe=s[Ie];if(Ie<g&&e===Oe||Ie>=g&&Oe.type===e)return Ie}if(r){const Ie=s[g];if(Ie&&pt(Ie)&&Ie.type===e)return g}return null}function xu(n,t,e,i){let r=n[e];const o=t.data;if(function b$(n){return n instanceof zd}(r)){const s=r;s.resolving&&function Dd(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Vt(-200,`Circular dependency in DI detected for ${n}${e}`)}(Sr(o[e]));const a=ch(s.canSeeViewProviders);s.resolving=!0;const g=s.injectImpl?Pl(s.injectImpl):null;m$(n,i,Rn.Default);try{r=n[e]=s.factory(void 0,o,n,i),t.firstCreatePass&&e>=i.directiveStart&&function Bb(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){const s=ip(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,s)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o))}(e,o[e],t)}finally{null!==g&&Pl(g),ch(a),s.resolving=!1,v$()}}return r}function S$(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function Dp(n,t){return!(n&Rn.Self||n&Rn.Host&&t)}class wu{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return Tp(this._tNode,this._lView,t,i,e)}}function Pr(n){return bs(()=>{const t=n.prototype.constructor,e=t[ui]||gh(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[ui]||gh(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function gh(n){return au(n)?()=>{const t=gh(Dn(n));return t&&t()}:ma(n)}function Rc(n){return function Ep(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const o=e[r];if(oo(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(o===t)return e[r+1];r+=2}}}return null}(Wi(),n)}const Ul="__parameters__";function wa(n,t,e){return bs(()=>{const i=function Ip(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(g,w,G){const me=g.hasOwnProperty(Ul)?g[Ul]:Object.defineProperty(g,Ul,{value:[]})[Ul];for(;me.length<=G;)me.push(null);return(me[G]=me[G]||[]).push(s),g}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Jn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Tn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Lo(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let i=n[e];Array.isArray(i)?(t===n&&(t=n.slice(0,e)),Lo(i,t)):t!==n&&t.push(i)}return t}function Ms(n,t){n.forEach(e=>Array.isArray(e)?Ms(e,t):t(e))}function el(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function ph(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function As(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function zo(n,t,e){let i=Du(n,t);return i>=0?n[1|i]=e:(i=~i,function Ap(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function _h(n,t){const e=Du(n,t);if(e>=0)return n[1|e]}function Du(n,t){return function Pp(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=n[o<<e];if(t===s)return o<<e;s>t?r=o:i=o+1}return~(r<<e)}(n,t,1)}const Iu={},Hl="__NG_DI_FLAG__",Vl="ngTempTokenPath",R$=/\n/gm,Gd="__source",O$=Zn({provide:String,useValue:Zn});let jl;function vh(n){const t=jl;return jl=n,t}function bh(n,t=Rn.Default){if(void 0===jl)throw new Vt(203,"");return null===jl?Dr(n,void 0,t):jl.get(n,t&Rn.Optional?null:void 0,t)}function In(n,t=Rn.Default){return(function Jm(){return qg}()||bh)(Dn(n),t)}const yh=In;function Ch(n){const t=[];for(let e=0;e<n.length;e++){const i=Dn(n[e]);if(Array.isArray(i)){if(0===i.length)throw new Vt(900,"");let r,o=Rn.Default;for(let s=0;s<i.length;s++){const a=i[s],g=Kb(a);"number"==typeof g?-1===g?r=a.token:o|=g:r=a}t.push(In(r,o))}else t.push(In(i))}return t}function Oc(n,t){return n[Hl]=t,n.prototype[Hl]=t,n}function Kb(n){return n[Hl]}const qd=Oc(wa("Optional"),8),Wd=Oc(wa("SkipSelf"),4);let Sh,Ih;function Mu(n){var t;return(null===(t=function Dh(){if(void 0===Sh&&(Sh=null,wi.trustedTypes))try{Sh=wi.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Sh}())||void 0===t?void 0:t.createHTML(n))||n}function ao(n){var t;return(null===(t=function Xs(){if(void 0===Ih&&(Ih=null,wi.trustedTypes))try{Ih=wi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Ih}())||void 0===t?void 0:t.createHTML(n))||n}class nl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class ty extends nl{getTypeName(){return"HTML"}}class ny extends nl{getTypeName(){return"Style"}}class Zd extends nl{getTypeName(){return"Script"}}class q$ extends nl{getTypeName(){return"URL"}}class W$ extends nl{getTypeName(){return"ResourceURL"}}function os(n){return n instanceof nl?n.changingThisBreaksApplicationSecurity:n}function Ta(n,t){const e=Z$(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function Z$(n){return n instanceof nl&&n.getTypeName()||null}class Yd{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Mu(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class Bp{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Mu(t),e;const i=this.inertDocument.createElement("body");return i.innerHTML=Mu(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const s=e.item(r).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&t.removeAttribute(s)}let i=t.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const Q$=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,J$=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ho(n){return(n=String(n)).match(Q$)||n.match(J$)?n:"unsafe:"+n}function ql(n){return(n=String(n)).split(",").map(t=>Ho(t.trim())).join(", ")}function Sa(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Au(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const e0=Sa("area,br,col,hr,img,wbr"),t0=Sa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n0=Sa("rp,rt"),zp=Au(e0,Au(t0,Sa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Au(n0,Sa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Au(n0,t0)),Up=Sa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Hp=Sa("srcset"),Vp=Au(Up,Hp,Sa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),r0=Sa("script,style,template");class o0{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!zp.hasOwnProperty(e))return this.sanitizedSomething=!0,!r0.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!Vp.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let g=o.value;Up[a]&&(g=Ho(g)),Hp[a]&&(g=ql(g)),this.buf.push(" ",s,'="',s0(g),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();zp.hasOwnProperty(e)&&!e0.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(s0(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const oy=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,sy=/([^\#-~ |!])/g;function s0(n){return n.replace(/&/g,"&amp;").replace(oy,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(sy,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Kd;function a0(n,t){let e=null;try{Kd=Kd||function Op(n){const t=new Bp(n);return function X$(){try{return!!(new window.DOMParser).parseFromString(Mu(""),"text/html")}catch(n){return!1}}()?new Yd(t):t}(n);let i=t?String(t):"";e=Kd.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Kd.getInertBodyElement(i)}while(i!==o);return Mu((new o0).sanitizeChildren(jp(e)||e))}finally{if(e){const i=jp(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function jp(n){return"content"in n&&function ay(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Vi=(()=>((Vi=Vi||{})[Vi.NONE=0]="NONE",Vi[Vi.HTML=1]="HTML",Vi[Vi.STYLE=2]="STYLE",Vi[Vi.SCRIPT=3]="SCRIPT",Vi[Vi.URL=4]="URL",Vi[Vi.RESOURCE_URL=5]="RESOURCE_URL",Vi))();function Bc(n){const t=Lc();return t?ao(t.sanitize(Vi.HTML,n)||""):Ta(n,"HTML")?ao(os(n)):a0(ap(),_n(n))}function fn(n){const t=Lc();return t?t.sanitize(Vi.URL,n)||"":Ta(n,"URL")?os(n):Ho(_n(n))}function Lc(){const n=Tt();return n&&n[12]}const d0="__ngContext__";function lo(n,t){n[d0]=t}function qp(n){const t=function Xd(n){return n[d0]||null}(n);return t?Array.isArray(t)?t:t.lView:null}function Zp(n){return n.ngOriginalError}function p0(n,...t){n.error(...t)}class Qd{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=function Yp(n){return n&&n.ngErrorLogger||p0}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Zp(t);for(;e&&Zp(e);)e=Zp(e);return e||null}}const Dy=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(wi))();function Ah(n){return n.ownerDocument}function Da(n){return n instanceof Function?n():n}var ss=(()=>((ss=ss||{})[ss.Important=1]="Important",ss[ss.DashCase=2]="DashCase",ss))();function Xp(n,t){return undefined(n,t)}function Jd(n){const t=n[3];return Gs(t)?t[3]:t}function e_(n){return b0(n[13])}function t_(n){return b0(n[4])}function b0(n){for(;null!==n&&!Gs(n);)n=n[4];return n}function il(n,t,e,i,r){if(null!=i){let o,s=!1;Gs(i)?o=i:_a(i)&&(s=!0,i=i[0]);const a=cr(i);0===n&&null!==e?null==r?a_(t,e,a):Wl(t,e,a,r||null,!0):1===n&&null!==e?Wl(t,e,a,r||null,!0):2===n?function I0(n,t,e){const i=Fh(n,t);i&&function Ly(n,t,e,i){Yn(n)?n.removeChild(t,e,i):t.removeChild(e)}(n,i,t,e)}(t,a,s):3===n&&t.destroyNode(a),null!=o&&function Uy(n,t,e,i,r){const o=e[7];o!==cr(e)&&il(t,n,i,o,r);for(let a=10;a<e.length;a++){const g=e[a];nf(g[1],g,n,t,i,o)}}(t,n,o,e,r)}}function i_(n,t,e){if(Yn(n))return n.createElement(t,e);{const i=null!==e?function Ib(n){const t=n.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?n.createElement(t):n.createElementNS(i,t)}}function C0(n,t){const e=n[9],i=e.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,cp(r,-1)),e.splice(i,1)}function Fu(n,t){if(n.length<=10)return;const e=10+t,i=n[e];if(i){const r=i[17];null!==r&&r!==n&&C0(r,i),t>0&&(n[e-1][4]=i[4]);const o=ph(n,10+t);!function Py(n,t){nf(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function x0(n,t){if(!(256&t[2])){const e=t[11];Yn(e)&&e.destroyNode&&nf(n,t,e,3,null,null),function Ny(n){let t=n[13];if(!t)return Ph(n[1],n);for(;t;){let e=null;if(_a(t))e=t[13];else{const i=t[10];i&&(e=i)}if(!e){for(;t&&!t[4]&&t!==n;)_a(t)&&Ph(t[1],t),t=t[3];null===t&&(t=n),_a(t)&&Ph(t[1],t),e=t&&t[4]}t=e}}(t)}}function Ph(n,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function r_(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof zd)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],g=o[s+1];try{g.call(a)}finally{}}else try{o.call(r)}finally{}}}}(n,t),function w0(n,t){const e=n.cleanup,i=t[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+1],a="function"==typeof s?s(t):cr(t[s]),g=i[r=e[o+2]],w=e[o+3];"boolean"==typeof w?a.removeEventListener(e[o],g,w):w>=0?i[r=w]():i[r=-w].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)i[o]();t[7]=null}}(n,t),1===t[1].type&&Yn(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&Gs(t[3])){e!==t[3]&&C0(e,t);const i=t[19];null!==i&&i.detachView(n)}}}function o_(n,t,e){return function s_(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Cs.None||r===Cs.Emulated)return null}return Bo(i,e)}(n,t.parent,e)}function Wl(n,t,e,i,r){Yn(n)?n.insertBefore(t,e,i,r):t.insertBefore(e,i,r)}function a_(n,t,e){Yn(n)?n.appendChild(t,e):t.appendChild(e)}function E0(n,t,e,i,r){null!==i?Wl(n,t,e,i,r):a_(n,t,e)}function Fh(n,t){return Yn(n)?n.parentNode(t):t.parentNode}function ef(n,t,e){return S0(n,t,e)}let S0=function T0(n,t,e){return 40&n.type?Bo(n,e):null};function Nh(n,t,e,i){const r=o_(n,i,t),o=t[11],a=ef(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(e))for(let g=0;g<e.length;g++)E0(o,r,e[g],a,!1);else E0(o,r,e,a,!1)}function Oh(n,t){if(null!==t){const e=t.type;if(3&e)return Bo(t,n);if(4&e)return c_(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Oh(n,i);{const r=n[t.index];return Gs(r)?c_(-1,r):cr(r)}}if(32&e)return Xp(t,n)()||cr(n[t.index]);{const i=D0(n,t);return null!==i?Array.isArray(i)?i[0]:Oh(Jd(n[16]),i):Oh(n,t.next)}}return null}function D0(n,t){return null!==t?n[16][6].projection[t.projection]:null}function c_(n,t){const e=10+n+1;if(e<t.length){const i=t[e],r=i[1].firstChild;if(null!==r)return Oh(i,r)}return t[7]}function u_(n,t,e,i,r,o,s){for(;null!=e;){const a=i[e.index],g=e.type;if(s&&0===t&&(a&&lo(cr(a),i),e.flags|=4),64!=(64&e.flags))if(8&g)u_(n,t,e.child,i,r,o,!1),il(t,n,r,a,o);else if(32&g){const w=Xp(e,i);let G;for(;G=w();)il(t,n,r,G,o);il(t,n,r,a,o)}else 16&g?k0(n,t,i,e,r,o):il(t,n,r,a,o);e=s?e.projectionNext:e.next}}function nf(n,t,e,i,r,o){u_(e,i,n.firstChild,t,r,o,!1)}function k0(n,t,e,i,r,o){const s=e[16],g=s[6].projection[i.projection];if(Array.isArray(g))for(let w=0;w<g.length;w++)il(t,n,r,g[w],o);else u_(n,t,g,s[3],r,o,!0)}function M0(n,t,e){Yn(n)?n.setAttribute(t,"style",e):t.style.cssText=e}function as(n,t,e){Yn(n)?""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e):t.className=e}function A0(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=t.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}e=r+1}}const Zl="ng-template";function On(n,t,e){let i=0;for(;i<n.length;){let r=n[i++];if(e&&"class"===r){if(r=n[i],-1!==A0(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function P0(n){return 4===n.type&&n.value!==Zl}function Vo(n,t,e){return t===(4!==n.type||e?n.value:Zl)}function ur(n,t,e){let i=4;const r=n.attrs||[],o=function jy(n){for(let t=0;t<n.length;t++)if(oo(n[t]))return t;return n.length}(r);let s=!1;for(let a=0;a<t.length;a++){const g=t[a];if("number"!=typeof g){if(!s)if(4&i){if(i=2|1&i,""!==g&&!Vo(n,g,e)||""===g&&1===t.length){if(Qs(i))return!1;s=!0}}else{const w=8&i?g:t[++a];if(8&i&&null!==n.attrs){if(!On(n.attrs,w,e)){if(Qs(i))return!1;s=!0}continue}const me=Yl(8&i?"class":g,r,P0(n),e);if(-1===me){if(Qs(i))return!1;s=!0;continue}if(""!==w){let ve;ve=me>o?"":r[me+1].toLowerCase();const Ie=8&i?ve:null;if(Ie&&-1!==A0(Ie,w,0)||2&i&&w!==ve){if(Qs(i))return!1;s=!0}}}}else{if(!s&&!Qs(i)&&!Qs(g))return!1;if(s&&Qs(g))continue;s=!1,i=g|1&i}}return Qs(i)||s}function Qs(n){return 0==(1&n)}function Yl(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let o=!1;for(;r<t.length;){const s=t[r];if(s===n)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function Gy(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function F0(n,t,e=!1){for(let i=0;i<t.length;i++)if(ur(n,t[i],e))return!0;return!1}function qy(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Bh(n,t){return n?":not("+t.trim()+")":t}function Wy(n){let t=n[0],e=1,i=2,r="",o=!1;for(;e<n.length;){let s=n[e];if("string"==typeof s)if(2&i){const a=n[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!Qs(s)&&(t+=Bh(o,r),r=""),i=s,o=o||!Qs(i);e++}return""!==r&&(t+=Bh(o,r)),t}const kn={};function W(n){tr(ni(),Tt(),Ar()+n,nh())}function tr(n,t,e,i){if(!i)if(3==(3&t[2])){const o=n.preOrderCheckHooks;null!==o&&Ld(t,o,e)}else{const o=n.preOrderHooks;null!==o&&Ll(t,o,0,e)}Bl(e)}function Lh(n,t){return n<<17|t<<2}function Js(n){return n>>17&32767}function f_(n){return 2|n}function ol(n){return(131068&n)>>2}function zh(n,t){return-131069&n|t<<2}function rf(n){return 1|n}function U0(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];if(-1!==o){const s=n.data[o];gp(r),s.contentQueries(2,t[o],o)}}}function of(n,t,e,i,r,o,s,a,g,w){const G=t.blueprint.slice();return G[0]=r,G[2]=140|i,h$(G),G[3]=G[15]=n,G[8]=e,G[10]=s||n&&n[10],G[11]=a||n&&n[11],G[12]=g||n&&n[12]||null,G[9]=w||n&&n[9]||null,G[6]=o,G[16]=2==t.type?n[16]:G,G}function Ou(n,t,e,i,r){let o=n.data[t];if(null===o)o=function Vh(n,t,e,i,r){const o=p$(),s=up(),g=n.data[t]=function Y0(n,t,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=g),null!==o&&(s?null==o.child&&null!==g.parent&&(o.child=g):null===o.next&&(o.next=g)),g}(n,t,e,i,r),function Rb(){return wn.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function Nd(){const n=wn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return va(o,!0),o}function Bu(n,t,e,i){if(0===e)return-1;const r=t.length;for(let o=0;o<e;o++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function sf(n,t,e){rh(t);try{const i=n.viewQuery;null!==i&&lf(1,i,e);const r=n.template;null!==r&&x_(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&U0(n,t),n.staticViewQueries&&lf(2,n.viewQuery,e);const o=n.components;null!==o&&function Jy(n,t){for(let e=0;e<t.length;e++)_C(n,t[e])}(t,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[2]&=-5,oh()}}function Lu(n,t,e,i){const r=t[2];if(256==(256&r))return;rh(t);const o=nh();try{h$(t),function ba(n){return wn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&x_(n,t,e,2,i);const s=3==(3&r);if(!o)if(s){const w=n.preOrderCheckHooks;null!==w&&Ld(t,w,null)}else{const w=n.preOrderHooks;null!==w&&Ll(t,w,0,null),ya(t,0)}if(function pC(n){for(let t=e_(n);null!==t;t=t_(t)){if(!t[2])continue;const e=t[9];for(let i=0;i<e.length;i++){const r=e[i],o=r[3];0==(1024&r[2])&&cp(o,1),r[2]|=1024}}}(t),function gC(n){for(let t=e_(n);null!==t;t=t_(t))for(let e=10;e<t.length;e++){const i=t[e],r=i[1];lp(i)&&Lu(r,i,r.template,i[8])}}(t),null!==n.contentQueries&&U0(n,t),!o)if(s){const w=n.contentCheckHooks;null!==w&&Ld(t,w)}else{const w=n.contentHooks;null!==w&&Ll(t,w,1),ya(t,1)}!function Qy(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Bl(~r);else{const o=r,s=e[++i],a=e[++i];Nb(s,o),a(2,t[o])}}}finally{Bl(-1)}}(n,t);const a=n.components;null!==a&&function H0(n,t){for(let e=0;e<t.length;e++)k_(n,t[e])}(t,a);const g=n.viewQuery;if(null!==g&&lf(2,g,i),!o)if(s){const w=n.viewCheckHooks;null!==w&&Ld(t,w)}else{const w=n.viewHooks;null!==w&&Ll(t,w,2),ya(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,cp(t[3],-1))}finally{oh()}}function V0(n,t,e,i){const r=t[10],o=!nh(),s=Mc(t);try{o&&!s&&r.begin&&r.begin(),s&&sf(n,t,i),Lu(n,t,e,i)}finally{o&&!s&&r.end&&r.end()}}function x_(n,t,e,i,r){const o=Ar(),s=2&i;try{Bl(-1),s&&t.length>20&&tr(n,t,20,nh()),e(i,r)}finally{Bl(o)}}function j0(n,t,e){if(Kg(t)){const r=t.directiveEnd;for(let o=t.directiveStart;o<r;o++){const s=n.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function w_(n,t,e){!Rd()||(function aC(n,t,e,i){const r=e.directiveStart,o=e.directiveEnd;n.firstCreatePass||Cu(e,t),lo(i,t);const s=e.initialInputs;for(let a=r;a<o;a++){const g=n.data[a],w=pt(g);w&&fC(t,e,g);const G=xu(t,n,a,e);lo(G,t),null!==s&&I_(0,a-r,G,g,0,s),w&&(ro(e.index,t)[8]=G)}}(n,t,e,Bo(e,t)),128==(128&e.flags)&&function lC(n,t,e){const i=e.directiveStart,r=e.directiveEnd,s=e.index,a=function Ac(){return wn.lFrame.currentDirectiveIndex}();try{Bl(s);for(let g=i;g<r;g++){const w=n.data[g],G=t[g];fp(g),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&Q0(w,G)}}finally{Bl(-1),fp(a)}}(n,t,e))}function E_(n,t,e=Bo){const i=t.localNames;if(null!==i){let r=t.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(t,n):n[s];n[r++]=a}}}function G0(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=ll(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function ll(n,t,e,i,r,o,s,a,g,w){const G=20+i,me=G+r,ve=function eC(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:kn);return e}(G,me),Ie="function"==typeof w?w():w;return ve[1]={type:n,blueprint:ve,template:e,queries:null,viewQuery:a,declTNode:t,data:ve.slice().fill(null,G),bindingStartIndex:G,expandoStartIndex:me,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:g,consts:Ie,incompleteFirstPass:!1}}function Z0(n,t,e,i){const r=ov(t);null===e?r.push(i):(r.push(e),n.firstCreatePass&&sv(n).push(i,r.length-1))}function T_(n,t,e){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(t,r):e[i]=[t,r]}return e}function ls(n,t,e,i,r,o,s,a){const g=Bo(t,e);let G,w=t.inputs;!a&&null!=w&&(G=w[i])?(lv(n,e,G,i,r),Sc(t)&&function iC(n,t){const e=ro(t,n);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(i=function nC(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=s?s(r,t.value||"",i):r,Yn(o)?o.setProperty(g,i,r):Hd(i)||(g.setProperty?g.setProperty(i,r):g[i]=r))}function S_(n,t,e,i){let r=!1;if(Rd()){const o=function cC(n,t,e){const i=n.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];F0(e,s.selectors,!1)&&(r||(r=[]),Vd(Cu(e,t),n,s.type),pt(s)?(J0(n,e),r.unshift(s)):r.push(s))}return r}(n,t,e),s=null===i?null:{"":-1};if(null!==o){r=!0,ev(e,n.data.length,o.length);for(let G=0;G<o.length;G++){const me=o[G];me.providersResolver&&me.providersResolver(me)}let a=!1,g=!1,w=Bu(n,t,o.length,null);for(let G=0;G<o.length;G++){const me=o[G];e.mergedAttrs=ah(e.mergedAttrs,me.hostAttrs),tv(n,e,t,w,me),dC(w,me,s),null!==me.contentQueries&&(e.flags|=8),(null!==me.hostBindings||null!==me.hostAttrs||0!==me.hostVars)&&(e.flags|=128);const ve=me.type.prototype;!a&&(ve.ngOnChanges||ve.ngOnInit||ve.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),a=!0),!g&&(ve.ngOnChanges||ve.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),g=!0),w++}!function tC(n,t){const i=t.directiveEnd,r=n.data,o=t.attrs,s=[];let a=null,g=null;for(let w=t.directiveStart;w<i;w++){const G=r[w],me=G.inputs,ve=null===o||P0(t)?null:nv(me,o);s.push(ve),a=T_(me,w,a),g=T_(G.outputs,w,g)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=a,t.outputs=g}(n,e)}s&&function uC(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const o=e[t[r+1]];if(null==o)throw new Vt(-301,!1);i.push(t[r],o)}}}(e,i,s)}return e.mergedAttrs=ah(e.mergedAttrs,e.attrs),r}function X0(n,t,e,i,r,o){const s=o.hostBindings;if(s){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const g=~t.index;(function sC(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(a)!=g&&a.push(g),a.push(i,r,s)}}function Q0(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function J0(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function dC(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;pt(t)&&(e[""]=n)}}function ev(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function tv(n,t,e,i,r){n.data[i]=r;const o=r.factory||(r.factory=ma(r.type)),s=new zd(o,pt(r),null);n.blueprint[i]=s,e[i]=s,X0(n,t,0,i,Bu(n,e,r.hostVars,kn),r)}function fC(n,t,e){const i=Bo(t,n),r=G0(e),o=n[10],s=qr(n,of(n,r,null,e.onPush?64:16,i,t,o,o.createRenderer(i,e),null,null));n[t.index]=s}function Ia(n,t,e,i,r,o){const s=Bo(n,t);!function D_(n,t,e,i,r,o,s){if(null==o)Yn(n)?n.removeAttribute(t,r,e):t.removeAttribute(r);else{const a=null==s?_n(o):s(o,i||"",r);Yn(n)?n.setAttribute(t,r,a,e):e?t.setAttributeNS(e,r,a):t.setAttribute(r,a)}}(t[11],s,o,n.value,e,i,r)}function I_(n,t,e,i,r,o){const s=o[t];if(null!==s){const a=i.setInput;for(let g=0;g<s.length;){const w=s[g++],G=s[g++],me=s[g++];null!==a?i.setInput(e,me,w,G):e[G]=me}}}function nv(n,t){let e=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,n[r],t[i+1])),i+=2}else i+=2;else i+=4}return e}function iv(n,t,e,i){return new Array(n,!0,!1,t,null,0,i,e,null,null)}function k_(n,t){const e=ro(t,n);if(lp(e)){const i=e[1];80&e[2]?Lu(i,e,i.template,e[8]):e[5]>0&&M_(e)}}function M_(n){for(let i=e_(n);null!==i;i=t_(i))for(let r=10;r<i.length;r++){const o=i[r];if(1024&o[2]){const s=o[1];Lu(s,o,s.template,o[8])}else o[5]>0&&M_(o)}const e=n[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=ro(e[i],n);lp(r)&&r[5]>0&&M_(r)}}function _C(n,t){const e=ro(t,n),i=e[1];(function mC(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),sf(i,e,e[8])}function qr(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function af(n){for(;n;){n[2]|=64;const t=Jd(n);if(gt(n)&&!t)return n;n=t}return null}function P_(n,t,e){const i=t[10];i.begin&&i.begin();try{Lu(n,t,n.template,e)}catch(r){throw av(t,r),r}finally{i.end&&i.end()}}function rv(n){!function A_(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],i=qp(e),r=i[1];V0(r,i,r.template,e)}}(n[8])}function lf(n,t,e){gp(0),t(n,e)}const bC=(()=>Promise.resolve(null))();function ov(n){return n[7]||(n[7]=[])}function sv(n){return n.cleanup||(n.cleanup=[])}function av(n,t){const e=n[9],i=e?e.get(Qd,null):null;i&&i.handleError(t)}function lv(n,t,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],g=t[s],w=n.data[s];null!==w.setInput?w.setInput(g,r,i,a):g[a]=r}}function cl(n,t,e){const i=Rl(t,n);!function y0(n,t,e){Yn(n)?n.setValue(t,e):t.textContent=e}(n[11],i,e)}function zu(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const a=t[s];"number"==typeof a?o=a:1==o?r=Za(r,a):2==o&&(i=Za(i,a+": "+t[++s]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}const O_=new Jn("INJECTOR",-1);class cv{get(t,e=Iu){if(e===Iu){const i=new Error(`NullInjectorError: No provider for ${ci(t)}!`);throw i.name="NullInjectorError",i}return e}}const B_=new Jn("Set Injector scope."),cf={},CC={};let L_;function uv(){return void 0===L_&&(L_=new cv),L_}function dv(n,t=null,e=null,i){const r=fv(n,t,e,i);return r._resolveInjectorDefTypes(),r}function fv(n,t=null,e=null,i){return new xC(n,e,t||uv(),i)}class xC{constructor(t,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];e&&Ms(e,a=>this.processProvider(a,t,e)),Ms([t],a=>this.processInjectorType(a,[],o)),this.records.set(O_,Uu(void 0,this));const s=this.records.get(B_);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof t?null:ci(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Iu,i=Rn.Default){this.assertNotDestroyed();const r=vh(this),o=Pl(void 0);try{if(!(i&Rn.SkipSelf)){let a=this.records.get(t);if(void 0===a){const g=function ke(n){return"function"==typeof n||"object"==typeof n&&n instanceof Jn}(t)&&jg(t);a=g&&this.injectableDefInScope(g)?Uu(z_(t),cf):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&Rn.Self?uv():this.parent).get(t,e=i&Rn.Optional&&e===Iu?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[Vl]=s[Vl]||[]).unshift(ci(t)),r)throw s;return function B$(n,t,e,i){const r=n[Vl];throw t[Gd]&&r.unshift(t[Gd]),n.message=function tl(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=ci(t);if(Array.isArray(t))r=t.map(ci).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let a=t[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):ci(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(R$,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[Vl]=null,n}(s,t,"R3InjectorError",this.source)}throw s}finally{Pl(o),vh(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(ci(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Vt(205,!1)}processInjectorType(t,e,i){if(!(t=Dn(t)))return!1;let r=Ni(t);const o=null==r&&t.ngModule||void 0,s=void 0===o?t:o,a=-1!==i.indexOf(s);if(void 0!==o&&(r=Ni(o)),null==r)return!1;if(null!=r.imports&&!a){let G;i.push(s);try{Ms(r.imports,me=>{this.processInjectorType(me,e,i)&&(void 0===G&&(G=[]),G.push(me))})}finally{}if(void 0!==G)for(let me=0;me<G.length;me++){const{ngModule:ve,providers:Ie}=G[me];Ms(Ie,Oe=>this.processProvider(Oe,ve,Ie||Oi))}}this.injectorDefTypes.add(s);const g=ma(s)||(()=>new s);this.records.set(s,Uu(g,cf));const w=r.providers;if(null!=w&&!a){const G=t;Ms(w,me=>this.processProvider(me,G,w))}return void 0!==o&&void 0!==t.providers}processProvider(t,e,i){let r=Hu(t=Dn(t))?t:Dn(t&&t.provide);const o=function EC(n,t,e){return gv(n)?Uu(void 0,n.useValue):Uu(hv(n),cf)}(t);if(Hu(t)||!0!==t.multi)this.records.get(r);else{let s=this.records.get(r);s||(s=Uu(void 0,cf,!0),s.factory=()=>Ch(s.multi),this.records.set(r,s)),r=t,s.multi.push(t)}this.records.set(r,o)}hydrate(t,e){return e.value===cf&&(e.value=CC,e.value=e.factory()),"object"==typeof e.value&&e.value&&function ue(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Dn(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function z_(n){const t=jg(n),e=null!==t?t.factory:ma(n);if(null!==e)return e;if(n instanceof Jn)throw new Vt(204,!1);if(n instanceof Function)return function wC(n){const t=n.length;if(t>0)throw As(t,"?"),new Vt(204,!1);const e=function yb(n){const t=n&&(n[Wf]||n[Qm]);if(t){const e=function qi(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Vt(204,!1)}function hv(n,t,e){let i;if(Hu(n)){const r=Dn(n);return ma(r)||z_(r)}if(gv(n))i=()=>Dn(n.useValue);else if(function SC(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Ch(n.deps||[]));else if(function TC(n){return!(!n||!n.useExisting)}(n))i=()=>In(Dn(n.useExisting));else{const r=Dn(n&&(n.useClass||n.provide));if(!function b(n){return!!n.deps}(n))return ma(r)||z_(r);i=()=>new r(...Ch(n.deps))}return i}function Uu(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function gv(n){return null!==n&&"object"==typeof n&&O$ in n}function Hu(n){return"function"==typeof n}let Ne=(()=>{class n{static create(e,i){var r;if(Array.isArray(e))return dv({name:""},i,e,"");{const o=null!==(r=e.name)&&void 0!==r?r:"";return dv({name:o},e.parent,e.providers,o)}}}return n.THROW_IF_NOT_FOUND=Iu,n.NULL=new cv,n.\u0275prov=Tn({token:n,providedIn:"any",factory:()=>In(O_)}),n.__NG_ELEMENT_ID__=-1,n})();function lF(n,t){Bd(qp(n)[1],Wi())}function Li(n){let t=function qE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(pt(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Vt(903,"");r=t.\u0275dir}if(r){if(e){i.push(r);const s=n;s.inputs=IC(n.inputs),s.declaredInputs=IC(n.declaredInputs),s.outputs=IC(n.outputs);const a=r.hostBindings;a&&fF(n,a);const g=r.viewQuery,w=r.contentQueries;if(g&&uF(n,g),w&&dF(n,w),su(n.inputs,r.inputs),su(n.declaredInputs,r.declaredInputs),su(n.outputs,r.outputs),pt(r)&&r.data.animation){const G=n.data;G.animation=(G.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(n),a===Li&&(e=!1)}}t=Object.getPrototypeOf(t)}!function cF(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ah(r.hostAttrs,e=ah(e,r.hostAttrs))}}(i)}function IC(n){return n===Hr?{}:n===Oi?[]:n}function uF(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function dF(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,o)=>{t(i,r,o),e(i,r,o)}:t}function fF(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}let pv=null;function jh(){if(!pv){const n=wi.Symbol;if(n&&n.iterator)pv=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(pv=i)}}}return pv}function U_(n){return!!kC(n)&&(Array.isArray(n)||!(n instanceof Map)&&jh()in n)}function kC(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Ql(n,t,e){return n[t]=e}function qo(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function uf(n,t,e,i){const r=qo(n,t,e);return qo(n,t+1,i)||r}function _v(n,t,e,i,r){const o=uf(n,t,e,i);return qo(n,t+2,r)||o}function Zt(n,t,e,i){const r=Tt();return qo(r,$u(),t)&&(ni(),Ia(er(),r,n,t,e,i)),Zt}function qh(n,t,e,i){return qo(n,$u(),e)?t+_n(e)+i:kn}function Wh(n,t,e,i,r,o){const a=uf(n,Xa(),e,r);return Qa(2),a?t+_n(e)+i+_n(r)+o:kn}function Se(n,t,e,i,r,o,s,a){const g=Tt(),w=ni(),G=n+20,me=w.firstCreatePass?function vF(n,t,e,i,r,o,s,a,g){const w=t.consts,G=Ou(t,n,4,s||null,Nl(w,a));S_(t,e,G,Nl(w,g)),Bd(t,G);const me=G.tViews=ll(2,G,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,w);return null!==t.queries&&(t.queries.template(t,G),me.queries=t.queries.embeddedTView(G)),G}(G,w,g,t,e,i,r,o,s):w.data[G];va(me,!1);const ve=g[11].createComment("");Nh(w,g,ve,me),lo(ve,g),qr(g,g[G]=iv(ve,g,ve,me)),ot(me)&&w_(w,g,me),null!=s&&E_(g,me,a)}function an(n){return $a(function Fb(){return wn.lFrame.contextLView}(),20+n)}function Be(n,t=Rn.Default){const e=Tt();return null===e?In(n,t):Tp(Wi(),e,Dn(n),t)}function oe(n,t,e){const i=Tt();return qo(i,$u(),t)&&ls(ni(),er(),i,n,t,i[11],e,!1),oe}function RC(n,t,e,i,r){const s=r?"class":"style";lv(n,e,t.inputs[s],s,i)}function ee(n,t,e,i){const r=Tt(),o=ni(),s=20+n,a=r[11],g=r[s]=i_(a,t,function Ds(){return wn.lFrame.currentNamespace}()),w=o.firstCreatePass?function UF(n,t,e,i,r,o,s){const a=t.consts,w=Ou(t,n,2,r,Nl(a,o));return S_(t,e,w,Nl(a,s)),null!==w.attrs&&zu(w,w.attrs,!1),null!==w.mergedAttrs&&zu(w,w.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,w),w}(s,o,r,0,t,e,i):o.data[s];va(w,!0);const G=w.mergedAttrs;null!==G&&Ud(a,g,G);const me=w.classes;null!==me&&as(a,g,me);const ve=w.styles;return null!==ve&&M0(a,g,ve),64!=(64&w.flags)&&Nh(o,r,g,w),0===function g$(){return wn.lFrame.elementDepthCount}()&&lo(g,r),function He(){wn.lFrame.elementDepthCount++}(),ot(w)&&(w_(o,r,w),j0(o,w,r)),null!==i&&E_(r,w),ee}function ce(){let n=Wi();up()?dp():(n=n.parent,va(n,!1));const t=n;!function mu(){wn.lFrame.elementDepthCount--}();const e=ni();return e.firstCreatePass&&(Bd(e,n),Kg(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ca(n){return 0!=(16&n.flags)}(t)&&RC(e,t,Tt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function bp(n){return 0!=(32&n.flags)}(t)&&RC(e,t,Tt(),t.stylesWithoutHost,!1),ce}function nt(n,t,e,i){return ee(n,t,e,i),ce(),nt}function Je(n,t,e){const i=Tt(),r=ni(),o=n+20,s=r.firstCreatePass?function HF(n,t,e,i,r){const o=t.consts,s=Nl(o,i),a=Ou(t,n,8,"ng-container",s);return null!==s&&zu(a,s,!0),S_(t,e,a,Nl(o,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(o,r,i,t,e):r.data[o];va(s,!0);const a=i[o]=i[11].createComment("");return Nh(r,i,a,s),lo(a,i),ot(s)&&(w_(r,i,s),j0(r,s,i)),null!=e&&E_(i,s),Je}function et(){let n=Wi();const t=ni();return up()?dp():(n=n.parent,va(n,!1)),t.firstCreatePass&&(Bd(t,n),Kg(n)&&t.queries.elementEnd(n)),et}function gn(n,t,e){return Je(n,t,e),et(),gn}function ht(){return Tt()}function $v(n){return!!n&&"function"==typeof n.then}const hT=function fT(n){return!!n&&"function"==typeof n.subscribe};function Re(n,t,e,i){const r=Tt(),o=ni(),s=Wi();return function pT(n,t,e,i,r,o,s,a){const g=ot(i),G=n.firstCreatePass&&sv(n),me=t[8],ve=ov(t);let Ie=!0;if(3&i.type||a){const We=Bo(i,t),Ye=a?a(We):We,Ge=ve.length,ct=a?rt=>a(cr(rt[i.index])):i.index;if(Yn(e)){let rt=null;if(!a&&g&&(rt=function VF(n,t,e,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=t[7],g=r[o+2];return a.length>g?a[g]:null}"string"==typeof s&&(o+=2)}return null}(n,t,r,i.index)),null!==rt)(rt.__ngLastListenerFn__||rt).__ngNextListenerFn__=o,rt.__ngLastListenerFn__=o,Ie=!1;else{o=NC(i,t,me,o,!1);const ft=e.listen(Ye,r,o);ve.push(o,ft),G&&G.push(r,ct,Ge,Ge+1)}}else o=NC(i,t,me,o,!0),Ye.addEventListener(r,o,s),ve.push(o),G&&G.push(r,ct,Ge,s)}else o=NC(i,t,me,o,!1);const Oe=i.outputs;let Ve;if(Ie&&null!==Oe&&(Ve=Oe[r])){const We=Ve.length;if(We)for(let Ye=0;Ye<We;Ye+=2){const Lt=t[Ve[Ye]][Ve[Ye+1]].subscribe(o),wt=ve.length;ve.push(o,Lt),G&&G.push(r,i.index,wt,-(wt+1))}}}(o,r,r[11],s,n,t,!!e,i),Re}function _T(n,t,e,i){try{return!1!==e(i)}catch(r){return av(n,r),!1}}function NC(n,t,e,i,r){return function o(s){if(s===Function)return i;const a=2&n.flags?ro(n.index,t):t;0==(32&t[2])&&af(a);let g=_T(t,0,i,s),w=o.__ngNextListenerFn__;for(;w;)g=_T(t,0,w,s)&&g,w=w.__ngNextListenerFn__;return r&&!1===g&&(s.preventDefault(),s.returnValue=!1),g}}function _e(n=1){return function mp(n){return(wn.lFrame.contextLView=function Od(n,t){for(;n>0;)t=t[15],n--;return t}(n,wn.lFrame.contextLView))[8]}(n)}function jF(n,t){let e=null;const i=function Vy(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const o=t[r];if("*"!==o){if(null===i?F0(n,o,!0):qy(i,o))return r}else e=r}return e}function V_(n){const t=Tt()[16][6];if(!t.projection){const i=t.projection=As(n?n.length:1,null),r=i.slice();let o=t.child;for(;null!==o;){const s=n?jF(o,n):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function j_(n,t=0,e){const i=Tt(),r=ni(),o=Ou(r,20+n,16,null,e||null);null===o.projection&&(o.projection=t),dp(),64!=(64&o.flags)&&function zy(n,t,e){k0(t[11],0,t,e,o_(n,e,t),ef(e.parent||t[6],e,t))}(r,i,o)}function sn(n,t,e){return ta(n,"",t,"",e),sn}function ta(n,t,e,i,r){const o=Tt(),s=qh(o,t,e,i);return s!==kn&&ls(ni(),er(),o,n,s,o[11],r,!1),ta}function tg(n,t,e,i,r,o,s){const a=Tt(),g=Wh(a,t,e,i,r,o);return g!==kn&&ls(ni(),er(),a,n,g,a[11],s,!1),tg}function wT(n,t,e,i,r){const o=n[e+1],s=null===t;let a=i?Js(o):ol(o),g=!1;for(;0!==a&&(!1===g||s);){const G=n[a+1];WF(n[a],t)&&(g=!0,n[a+1]=i?rf(G):f_(G)),a=i?Js(G):ol(G)}g&&(n[e+1]=i?f_(o):rf(o))}function WF(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Du(n,t)>=0}const Wr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ET(n){return n.substring(Wr.key,Wr.keyEnd)}function ZF(n){return n.substring(Wr.value,Wr.valueEnd)}function ST(n,t){const e=Wr.textEnd;let i=Wr.key=ng(n,t,e);return e===i?-1:(i=Wr.keyEnd=function QF(n,t,e){let i;for(;t<e&&(45===(i=n.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(n,i,e),i=IT(n,i,e),i=Wr.value=ng(n,i,e),i=Wr.valueEnd=function JF(n,t,e){let i=-1,r=-1,o=-1,s=t,a=s;for(;s<e;){const g=n.charCodeAt(s++);if(59===g)return a;34===g||39===g?a=s=kT(n,g,s,e):t===s-4&&85===o&&82===r&&76===i&&40===g?a=s=kT(n,41,s,e):g>32&&(a=s),o=r,r=i,i=-33&g}return a}(n,i,e),IT(n,i,e))}function ng(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function IT(n,t,e,i){return(t=ng(n,t,e))<e&&t++,t}function kT(n,t,e,i){let r=-1,o=e;for(;o<i;){const s=n.charCodeAt(o++);if(s==t&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function cn(n,t,e){return dl(n,t,e,!1),cn}function Aa(n,t){return dl(n,t,null,!0),Aa}function vi(n){!function fl(n,t,e,i){const r=ni(),o=Qa(2);r.firstUpdatePass&&AT(r,null,o,i);const s=Tt();if(e!==kn&&qo(s,o,e)){const a=r.data[Ar()];if(NT(a,i)&&!MT(r,o)){let g=i?a.classesWithoutHost:a.stylesWithoutHost;null!==g&&(e=Za(g,e||"")),RC(r,a,s,e,i)}else!function a4(n,t,e,i,r,o,s,a){r===kn&&(r=Oi);let g=0,w=0,G=0<r.length?r[0]:null,me=0<o.length?o[0]:null;for(;null!==G||null!==me;){const ve=g<r.length?r[g+1]:void 0,Ie=w<o.length?o[w+1]:void 0;let Ve,Oe=null;G===me?(g+=2,w+=2,ve!==Ie&&(Oe=me,Ve=Ie)):null===me||null!==G&&G<me?(g+=2,Oe=G):(w+=2,Oe=me,Ve=Ie),null!==Oe&&FT(n,t,e,i,Oe,Ve,s,a),G=g<r.length?r[g]:null,me=w<o.length?o[w]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function s4(n,t,e){if(null==e||""===e)return Oi;const i=[],r=os(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else"string"==typeof r&&t(i,r);return i}(n,t,e),i,o)}}(PT,e4,n,!1)}function e4(n,t){for(let e=function KF(n){return function DT(n){Wr.key=0,Wr.keyEnd=0,Wr.value=0,Wr.valueEnd=0,Wr.textEnd=n.length}(n),ST(n,ng(n,0,Wr.textEnd))}(t);e>=0;e=ST(t,e))PT(n,ET(t),ZF(t))}function dl(n,t,e,i){const r=Tt(),o=ni(),s=Qa(2);o.firstUpdatePass&&AT(o,n,s,i),t!==kn&&qo(r,s,t)&&FT(o,o.data[Ar()],r,r[11],n,r[s+1]=function l4(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=ci(os(n)))),n}(t,e),i,s)}function MT(n,t){return t>=n.expandoStartIndex}function AT(n,t,e,i){const r=n.data;if(null===r[e+1]){const o=r[Ar()],s=MT(n,e);NT(o,i)&&null===t&&!s&&(t=!1),t=function n4(n,t,e,i){const r=function hp(n){const t=wn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let o=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=G_(e=OC(null,n,t,e,i),t.attrs,i),o=null);else{const s=t.directiveStylingLast;if(-1===s||n[s]!==r)if(e=OC(r,n,t,e,i),null===o){let g=function i4(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==ol(i))return n[Js(i)]}(n,t,i);void 0!==g&&Array.isArray(g)&&(g=OC(null,n,t,g[1],i),g=G_(g,t.attrs,i),function r4(n,t,e,i){n[Js(e?t.classBindings:t.styleBindings)]=i}(n,t,i,g))}else o=function o4(n,t,e){let i;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)i=G_(i,n[o].hostAttrs,e);return G_(i,t.attrs,e)}(n,t,i)}return void 0!==o&&(i?t.residualClasses=o:t.residualStyles=o),e}(r,o,t,i),function GF(n,t,e,i,r,o){let s=o?t.classBindings:t.styleBindings,a=Js(s),g=ol(s);n[i]=e;let G,w=!1;if(Array.isArray(e)){const me=e;G=me[1],(null===G||Du(me,G)>0)&&(w=!0)}else G=e;if(r)if(0!==g){const ve=Js(n[a+1]);n[i+1]=Lh(ve,a),0!==ve&&(n[ve+1]=zh(n[ve+1],i)),n[a+1]=function Zy(n,t){return 131071&n|t<<17}(n[a+1],i)}else n[i+1]=Lh(a,0),0!==a&&(n[a+1]=zh(n[a+1],i)),a=i;else n[i+1]=Lh(g,0),0===a?a=i:n[g+1]=zh(n[g+1],i),g=i;w&&(n[i+1]=f_(n[i+1])),wT(n,G,i,!0),wT(n,G,i,!1),function qF(n,t,e,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof t&&Du(o,t)>=0&&(e[i+1]=rf(e[i+1]))}(t,G,n,i,o),s=Lh(a,g),o?t.classBindings=s:t.styleBindings=s}(r,o,t,e,s,i)}}function OC(n,t,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=t[a],i=G_(i,o.hostAttrs,r),o!==n);)a++;return null!==n&&(e.directiveStylingLast=a),i}function G_(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?r=s:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),zo(n,s,!!e||t[++o]))}return void 0===n?null:n}function PT(n,t,e){zo(n,t,os(e))}function FT(n,t,e,i,r,o,s,a){if(!(3&t.type))return;const g=n.data,w=g[a+1];vv(function Ru(n){return 1==(1&n)}(w)?RT(g,t,e,r,ol(w),s):void 0)||(vv(o)||function N0(n){return 2==(2&n)}(w)&&(o=RT(g,null,e,r,a,s)),function Hy(n,t,e,i,r){const o=Yn(n);if(t)r?o?n.addClass(e,i):e.classList.add(i):o?n.removeClass(e,i):e.classList.remove(i);else{let s=-1===i.indexOf("-")?void 0:ss.DashCase;if(null==r)o?n.removeStyle(e,i,s):e.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),s|=ss.Important),o?n.setStyle(e,i,r,s):e.style.setProperty(i,r,a?"important":"")}}}(i,s,Rl(Ar(),e),r,o))}function RT(n,t,e,i,r,o){const s=null===t;let a;for(;r>0;){const g=n[r],w=Array.isArray(g),G=w?g[1]:g,me=null===G;let ve=e[r+1];ve===kn&&(ve=me?Oi:void 0);let Ie=me?_h(ve,i):G===i?ve:void 0;if(w&&!vv(Ie)&&(Ie=_h(g,i)),vv(Ie)&&(a=Ie,s))return a;const Oe=n[r+1];r=s?Js(Oe):ol(Oe)}if(null!==t){let g=o?t.residualClasses:t.residualStyles;null!=g&&(a=_h(g,i))}return a}function vv(n){return void 0!==n}function NT(n,t){return 0!=(n.flags&(t?16:32))}function we(n,t=""){const e=Tt(),i=ni(),r=n+20,o=i.firstCreatePass?Ou(i,r,1,t,null):i.data[r],s=e[r]=function n_(n,t){return Yn(n)?n.createText(t):n.createTextNode(t)}(e[11],t);Nh(i,e,s,o),va(o,!1)}function Ct(n){return ln("",n,""),Ct}function ln(n,t,e){const i=Tt(),r=qh(i,n,t,e);return r!==kn&&cl(i,Ar(),r),ln}function na(n,t,e,i,r){const o=Tt(),s=Wh(o,n,t,e,i,r);return s!==kn&&cl(o,Ar(),s),na}function bv(n,t,e,i,r,o,s){const a=Tt(),g=function Zh(n,t,e,i,r,o,s,a){const w=_v(n,Xa(),e,r,s);return Qa(3),w?t+_n(e)+i+_n(r)+o+_n(s)+a:kn}(a,n,t,e,i,r,o,s);return g!==kn&&cl(a,Ar(),g),bv}const df=void 0;var D4=["en",[["a","p"],["AM","PM"],df],[["AM","PM"],df,df],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],df,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],df,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",df,"{1} 'at' {0}",df],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function S4(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let ig={};function cs(n){const t=function I4(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=n3(t);if(e)return e;const i=t.split("-")[0];if(e=n3(i),e)return e;if("en"===i)return D4;throw new Error(`Missing locale data for the locale "${n}".`)}function n3(n){return n in ig||(ig[n]=wi.ng&&wi.ng.common&&wi.ng.common.locales&&wi.ng.common.locales[n]),ig[n]}var Gt=(()=>((Gt=Gt||{})[Gt.LocaleId=0]="LocaleId",Gt[Gt.DayPeriodsFormat=1]="DayPeriodsFormat",Gt[Gt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Gt[Gt.DaysFormat=3]="DaysFormat",Gt[Gt.DaysStandalone=4]="DaysStandalone",Gt[Gt.MonthsFormat=5]="MonthsFormat",Gt[Gt.MonthsStandalone=6]="MonthsStandalone",Gt[Gt.Eras=7]="Eras",Gt[Gt.FirstDayOfWeek=8]="FirstDayOfWeek",Gt[Gt.WeekendRange=9]="WeekendRange",Gt[Gt.DateFormat=10]="DateFormat",Gt[Gt.TimeFormat=11]="TimeFormat",Gt[Gt.DateTimeFormat=12]="DateTimeFormat",Gt[Gt.NumberSymbols=13]="NumberSymbols",Gt[Gt.NumberFormats=14]="NumberFormats",Gt[Gt.CurrencyCode=15]="CurrencyCode",Gt[Gt.CurrencySymbol=16]="CurrencySymbol",Gt[Gt.CurrencyName=17]="CurrencyName",Gt[Gt.Currencies=18]="Currencies",Gt[Gt.Directionality=19]="Directionality",Gt[Gt.PluralCase=20]="PluralCase",Gt[Gt.ExtraData=21]="ExtraData",Gt))();const yv="en-US";let i3=yv;function zC(n,t,e,i,r){if(n=Dn(n),Array.isArray(n))for(let o=0;o<n.length;o++)zC(n[o],t,e,i,r);else{const o=ni(),s=Tt();let a=Hu(n)?n:Dn(n.provide),g=hv(n);const w=Wi(),G=1048575&w.providerIndexes,me=w.directiveStart,ve=w.providerIndexes>>20;if(Hu(n)||!n.multi){const Ie=new zd(g,r,Be),Oe=HC(a,t,r?G:G+ve,me);-1===Oe?(Vd(Cu(w,s),o,a),UC(o,n,t.length),t.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(Ie),s.push(Ie)):(e[Oe]=Ie,s[Oe]=Ie)}else{const Ie=HC(a,t,G+ve,me),Oe=HC(a,t,G,G+ve),Ve=Ie>=0&&e[Ie],We=Oe>=0&&e[Oe];if(r&&!We||!r&&!Ve){Vd(Cu(w,s),o,a);const Ye=function S5(n,t,e,i,r){const o=new zd(n,e,Be);return o.multi=[],o.index=t,o.componentProviders=0,S3(o,r,i&&!e),o}(r?T5:E5,e.length,r,i,g);!r&&We&&(e[Oe].providerFactory=Ye),UC(o,n,t.length,0),t.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(Ye),s.push(Ye)}else UC(o,n,Ie>-1?Ie:Oe,S3(e[r?Oe:Ie],g,!r&&i));!r&&i&&We&&e[Oe].componentProviders++}}}function UC(n,t,e,i){const r=Hu(t),o=function u(n){return!!n.useClass}(t);if(r||o){const g=(o?Dn(t.useClass):t).prototype.ngOnDestroy;if(g){const w=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const G=w.indexOf(e);-1===G?w.push(e,[i,g]):w[G+1].push(i,g)}else w.push(e,g)}}}function S3(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function HC(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function E5(n,t,e,i){return VC(this.multi,[])}function T5(n,t,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=xu(e,e[1],this.providerFactory.index,i);o=a.slice(0,s),VC(r,o);for(let g=s;g<a.length;g++)o.push(a[g])}else o=[],VC(r,o);return o}function VC(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Ki(n,t=[]){return e=>{e.providersResolver=(i,r)=>function w5(n,t,e){const i=ni();if(i.firstCreatePass){const r=pt(n);zC(e,i.data,i.blueprint,r,!0),zC(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}class D3{}class k5{resolveComponentFactory(t){throw function I5(n){const t=Error(`No component factory found for ${ci(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Vu=(()=>{class n{}return n.NULL=new k5,n})();function M5(){return og(Wi(),Tt())}function og(n,t){return new di(Bo(n,t))}let di=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=M5,n})();function A5(n){return n instanceof di?n.nativeElement:n}class K_{}let ju=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function F5(){const n=Tt(),e=ro(Wi().index,n);return function P5(n){return n[11]}(_a(e)?e:n)}(),n})(),R5=(()=>{class n{}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:()=>null}),n})();class Tv{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const N5=new Tv("13.3.1"),jC={};function Sv(n,t,e,i,r=!1){for(;null!==e;){const o=t[e.index];if(null!==o&&i.push(cr(o)),Gs(o))for(let a=10;a<o.length;a++){const g=o[a],w=g[1].firstChild;null!==w&&Sv(g[1],g,w,i)}const s=e.type;if(8&s)Sv(n,t,e.child,i);else if(32&s){const a=Xp(e,t);let g;for(;g=a();)i.push(g)}else if(16&s){const a=D0(t,e);if(Array.isArray(a))i.push(...a);else{const g=Jd(t[16]);Sv(g[1],g,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class X_{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Sv(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Gs(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(Fu(t,i),ph(e,i))}this._attachedToViewContainer=!1}x0(this._lView[1],this._lView)}onDestroy(t){Z0(this._lView[1],this._lView,null,t)}markForCheck(){af(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){P_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function F_(n,t,e){ih(!0);try{P_(n,t,e)}finally{ih(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Vt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Ry(n,t){nf(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Vt(902,"");this._appRef=t}}class O5 extends X_{constructor(t){super(t),this._view=t}detectChanges(){rv(this._view)}checkNoChanges(){!function vC(n){ih(!0);try{rv(n)}finally{ih(!1)}}(this._view)}get context(){return null}}class k3 extends Vu{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=jr(t);return new GC(e,this.ngModule)}}function M3(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class GC extends D3{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function rl(n){return n.map(Wy).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return M3(this.componentDef.inputs)}get outputs(){return M3(this.componentDef.outputs)}create(t,e,i,r){const o=(r=r||this.ngModule)?function L5(n,t){return{get:(e,i,r)=>{const o=n.get(e,jC,r);return o!==jC||i===jC?o:t.get(e,i,r)}}}(t,r.injector):t,s=o.get(K_,d$),a=o.get(R5,null),g=s.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",G=i?function W0(n,t,e){if(Yn(n))return n.selectRootElement(t,e===Cs.ShadowDom);let i="string"==typeof t?n.querySelector(t):t;return i.textContent="",i}(g,i,this.componentDef.encapsulation):i_(s.createRenderer(null,this.componentDef),w,function B5(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(w)),me=this.componentDef.onPush?576:528,ve=function GE(n,t){return{components:[],scheduler:n||Dy,clean:bC,playerHandler:t||null,flags:0}}(),Ie=ll(0,null,null,1,0,null,null,null,null,null),Oe=of(null,Ie,ve,me,null,null,s,g,a,o);let Ve,We;rh(Oe);try{const Ye=function VE(n,t,e,i,r,o){const s=e[1];e[20]=n;const g=Ou(s,20,2,"#host",null),w=g.mergedAttrs=t.hostAttrs;null!==w&&(zu(g,w,!0),null!==n&&(Ud(r,n,w),null!==g.classes&&as(r,n,g.classes),null!==g.styles&&M0(r,n,g.styles)));const G=i.createRenderer(n,t),me=of(e,G0(t),null,t.onPush?64:16,e[20],g,i,G,o||null,null);return s.firstCreatePass&&(Vd(Cu(g,e),s,t.type),J0(s,g),ev(g,e.length,1)),qr(e,me),e[20]=me}(G,this.componentDef,Oe,s,g);if(G)if(i)Ud(g,G,["ng-version",N5.full]);else{const{attrs:Ge,classes:ct}=function R0(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&t.push(o,n[++i]):8===r&&e.push(o);else{if(!Qs(r))break;r=o}i++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);Ge&&Ud(g,G,Ge),ct&&ct.length>0&&as(g,G,ct.join(" "))}if(We=kc(Ie,20),void 0!==e){const Ge=We.projection=[];for(let ct=0;ct<this.ngContentSelectors.length;ct++){const rt=e[ct];Ge.push(null!=rt?Array.from(rt):null)}}Ve=function jE(n,t,e,i,r){const o=e[1],s=function oC(n,t,e){const i=Wi();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),tv(n,i,t,Bu(n,t,1,null),e));const r=xu(t,n,i.directiveStart,i);lo(r,t);const o=Bo(i,t);return o&&lo(o,t),r}(o,e,t);if(i.components.push(s),n[8]=s,r&&r.forEach(g=>g(s,t)),t.contentQueries){const g=Wi();t.contentQueries(1,s,g.directiveStart)}const a=Wi();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Bl(a.index),X0(e[1],a,0,a.directiveStart,a.directiveEnd,t),Q0(t,s)),s}(Ye,this.componentDef,Oe,ve,[lF]),sf(Ie,Oe,null)}finally{oh()}return new U5(this.componentType,Ve,og(We,Oe),Oe,We)}}class U5 extends class D5{}{constructor(t,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new O5(r),this.componentType=t}get injector(){return new wu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class sg{}const ag=new Map;class F3 extends sg{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new k3(this);const i=ns(t);this._bootstrapComponents=Da(i.bootstrap),this._r3Injector=fv(t,e,[{provide:sg,useValue:this},{provide:Vu,useValue:this.componentFactoryResolver}],ci(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Ne.THROW_IF_NOT_FOUND,i=Rn.Default){return t===Ne||t===sg||t===O_?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class qC extends class V5{}{constructor(t){super(),this.moduleType=t,null!==ns(t)&&function j5(n){const t=new Set;!function e(i){const r=ns(i,!0),o=r.id;null!==o&&(function A3(n,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${n} - ${ci(t)} vs ${ci(t.name)}`)}(o,ag.get(o),i),ag.set(o,i));const s=Da(r.imports);for(const a of s)t.has(a)||(t.add(a),e(a))}(n)}(t)}create(t){return new F3(this.moduleType,t)}}function mr(n,t,e){const i=mo()+n,r=Tt();return r[i]===kn?Ql(r,i,e?t.call(e):t()):function H_(n,t){return n[t]}(r,i)}function Rt(n,t,e,i){return R3(Tt(),mo(),n,t,e,i)}function fi(n,t,e,i,r){return N3(Tt(),mo(),n,t,e,i,r)}function Wo(n,t,e,i,r,o){return function O3(n,t,e,i,r,o,s,a){const g=t+e;return _v(n,g,r,o,s)?Ql(n,g+3,a?i.call(a,r,o,s):i(r,o,s)):Q_(n,g+3)}(Tt(),mo(),n,t,e,i,r,o)}function Fr(n,t,e,i,r,o,s){return function B3(n,t,e,i,r,o,s,a,g){const w=t+e;return function Ma(n,t,e,i,r,o){const s=uf(n,t,e,i);return uf(n,t+2,r,o)||s}(n,w,r,o,s,a)?Ql(n,w+4,g?i.call(g,r,o,s,a):i(r,o,s,a)):Q_(n,w+4)}(Tt(),mo(),n,t,e,i,r,o,s)}function Q_(n,t){const e=n[t];return e===kn?void 0:e}function R3(n,t,e,i,r,o){const s=t+e;return qo(n,s,r)?Ql(n,s+1,o?i.call(o,r):i(r)):Q_(n,s+1)}function N3(n,t,e,i,r,o,s){const a=t+e;return uf(n,a,r,o)?Ql(n,a+2,s?i.call(s,r,o):i(r,o)):Q_(n,a+2)}function Ft(n,t){const e=ni();let i;const r=n+20;e.firstCreatePass?(i=function K5(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ma(i.type)),s=Pl(Be);try{const a=ch(!1),g=o();return ch(a),function bF(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,Tt(),r,g),g}finally{Pl(s)}}function Nt(n,t,e,i){const r=n+20,o=Tt(),s=$a(o,r);return J_(o,r)?N3(o,mo(),t,s.transform,e,i,s):s.transform(e,i)}function J_(n,t){return n[1].data[t].pure}function WC(n){return t=>{setTimeout(n,void 0,t)}}const Kt=class eR extends d{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){var r,o,s;let a=t,g=e||(()=>null),w=i;if(t&&"object"==typeof t){const me=t;a=null===(r=me.next)||void 0===r?void 0:r.bind(me),g=null===(o=me.error)||void 0===o?void 0:o.bind(me),w=null===(s=me.complete)||void 0===s?void 0:s.bind(me)}this.__isAsync&&(g=WC(g),a&&(a=WC(a)),w&&(w=WC(w)));const G=super.subscribe({next:a,error:g,complete:w});return t instanceof S&&t.add(G),G}};function tR(){return this._results[jh()]()}class ZC{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=jh(),i=ZC.prototype;i[e]||(i[e]=tR)}get changes(){return this._changes||(this._changes=new Kt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=Lo(t);(this._changesDetected=!function A$(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=t[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Ei=(()=>{class n{}return n.__NG_ELEMENT_ID__=rR,n})();const nR=Ei,iR=class extends nR{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=of(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(i[19]=o.createEmbeddedView(e)),sf(e,i,t),new X_(i)}};function rR(){return Dv(Wi(),Tt())}function Dv(n,t){return 4&n.type?new iR(t,n,og(n,t)):null}let us=(()=>{class n{}return n.__NG_ELEMENT_ID__=oR,n})();function oR(){return V3(Wi(),Tt())}const sR=us,U3=class extends sR{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return og(this._hostTNode,this._hostLView)}get injector(){return new wu(this._hostTNode,this._hostLView)}get parentInjector(){const t=uh(this._hostTNode,this._hostLView);if(C$(t)){const e=xa(t,this._hostLView),i=zl(t);return new wu(e[1].data[i+8],e)}return new wu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=H3(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){const r=t.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(t,e,i,r,o){const s=t&&!function Su(n){return"function"==typeof n}(t);let a;if(s)a=e;else{const me=e||{};a=me.index,i=me.injector,r=me.projectableNodes,o=me.ngModuleRef}const g=s?t:new GC(jr(t)),w=i||this.parentInjector;if(!o&&null==g.ngModule){const ve=(s?w:this.parentInjector).get(sg,null);ve&&(o=ve)}const G=g.create(w,r,void 0,o);return this.insert(G.hostView,a),G}insert(t,e){const i=t._lView,r=i[1];if(function Pb(n){return Gs(n[3])}(i)){const G=this.indexOf(t);if(-1!==G)this.detach(G);else{const me=i[3],ve=new U3(me,me[6],me[3]);ve.detach(ve.indexOf(t))}}const o=this._adjustIndex(e),s=this._lContainer;!function Oy(n,t,e,i){const r=10+i,o=e.length;i>0&&(e[r-1][4]=t),i<o-10?(t[4]=e[r],el(e,10+i,t)):(e.push(t),t[4]=null),t[3]=e;const s=t[17];null!==s&&e!==s&&function By(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(n),t[2]|=128}(r,i,s,o);const a=c_(o,s),g=i[11],w=Fh(g,s[7]);return null!==w&&function Fy(n,t,e,i,r,o){i[0]=r,i[6]=t,nf(n,i,e,1,r,o)}(r,s[6],g,i,w,a),t.attachToViewContainerRef(),el(YC(s),o,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=H3(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=Fu(this._lContainer,e);i&&(ph(YC(this._lContainer),e),x0(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=Fu(this._lContainer,e);return i&&null!=ph(YC(this._lContainer),e)?new X_(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function H3(n){return n[8]}function YC(n){return n[8]||(n[8]=[])}function V3(n,t){let e;const i=t[n.index];if(Gs(i))e=i;else{let r;if(8&n.type)r=cr(i);else{const o=t[11];r=o.createComment("");const s=Bo(n,t);Wl(o,Fh(o,s),r,function Rh(n,t){return Yn(n)?n.nextSibling(t):t.nextSibling}(o,s),!1)}t[n.index]=e=iv(i,t,r,n),qr(t,e)}return new U3(e,n,t)}class KC{constructor(t){this.queryList=t,this.matches=null}clone(){return new KC(this.queryList)}setDirty(){this.queryList.setDirty()}}class XC{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new XC(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Z3(t,e).matches&&this.queries[e].setDirty()}}class j3{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class QC{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new QC(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class JC{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new JC(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(t,e,cR(e,o)),this.matchTNodeWithReadOption(t,e,hh(e,t,o,!1,!1))}else i===Ei?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,hh(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===di||r===us||r===Ei&&4&e.type)this.addMatch(e.index,-2);else{const o=hh(e,t,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function cR(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function dR(n,t,e,i){return-1===e?function uR(n,t){return 11&n.type?og(n,t):4&n.type?Dv(n,t):null}(t,n):-2===e?function fR(n,t,e){return e===di?og(t,n):e===Ei?Dv(t,n):e===us?V3(t,n):void 0}(n,t,i):xu(n,n[1],e,t)}function G3(n,t,e,i){const r=t[19].queries[i];if(null===r.matches){const o=n.data,s=e.matches,a=[];for(let g=0;g<s.length;g+=2){const w=s[g];a.push(w<0?null:dR(t,o[w],s[g+1],e.metadata.read))}r.matches=a}return r.matches}function e2(n,t,e,i){const r=n.queries.getByIndex(e),o=r.matches;if(null!==o){const s=G3(n,t,r,e);for(let a=0;a<o.length;a+=2){const g=o[a];if(g>0)i.push(s[a/2]);else{const w=o[a+1],G=t[-g];for(let me=10;me<G.length;me++){const ve=G[me];ve[17]===ve[3]&&e2(ve[1],ve,w,i)}if(null!==G[9]){const me=G[9];for(let ve=0;ve<me.length;ve++){const Ie=me[ve];e2(Ie[1],Ie,w,i)}}}}}return i}function yn(n){const t=Tt(),e=ni(),i=Ss();gp(i+1);const r=Z3(e,i);if(n.dirty&&Mc(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?e2(e,t,i,[]):G3(e,t,r,i);n.reset(o,A5),n.notifyOnChanges()}return!0}return!1}function Gn(n,t,e){const i=ni();i.firstCreatePass&&(W3(i,new j3(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),q3(i,Tt(),t)}function ia(n,t,e,i){const r=ni();if(r.firstCreatePass){const o=Wi();W3(r,new j3(t,e,i),o.index),function gR(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),2==(2&e)&&(r.staticContentQueries=!0)}q3(r,Tt(),e)}function Cn(){return function hR(n,t){return n[19].queries[t].queryList}(Tt(),Ss())}function q3(n,t,e){const i=new ZC(4==(4&e));Z0(n,t,i,i.destroy),null===t[19]&&(t[19]=new XC),t[19].queries.push(new KC(i))}function W3(n,t,e){null===n.queries&&(n.queries=new QC),n.queries.track(new JC(t,e))}function Z3(n,t){return n.queries.getByIndex(t)}function zn(n,t){return Dv(n,t)}function Mv(...n){}const dS=new Jn("Application Initializer");let s2=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Mv,this.reject=Mv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if($v(o))e.push(o);else if(hT(o)){const s=new Promise((a,g)=>{o.subscribe({complete:a,error:g})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(In(dS,8))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tm=new Jn("AppId",{providedIn:"root",factory:function fS(){return`${a2()}${a2()}${a2()}`}});function a2(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const hS=new Jn("Platform Initializer"),Av=new Jn("Platform ID"),MR=new Jn("appBootstrapListener");let AR=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const Gu=new Jn("LocaleId",{providedIn:"root",factory:()=>yh(Gu,Rn.Optional|Rn.SkipSelf)||function PR(){return"undefined"!=typeof $localize&&$localize.locale||yv}()}),OR=(()=>Promise.resolve(0))();function l2(n){"undefined"==typeof Zone?OR.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class An{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Kt(!1),this.onMicrotaskEmpty=new Kt(!1),this.onStable=new Kt(!1),this.onError=new Kt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function BR(){let n=wi.requestAnimationFrame,t=wi.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function UR(n){const t=()=>{!function zR(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(wi,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,u2(n),n.isCheckStableRunning=!0,c2(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),u2(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return gS(n),e.invokeTask(r,o,s,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&t(),pS(n)}},onInvoke:(e,i,r,o,s,a,g)=>{try{return gS(n),e.invoke(r,o,s,a,g)}finally{n.shouldCoalesceRunChangeDetection&&t(),pS(n)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,u2(n),c2(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!An.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(An.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,t,LR,Mv,Mv);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const LR={};function c2(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function u2(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function gS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function pS(n){n._nesting--,c2(n)}class HR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Kt,this.onMicrotaskEmpty=new Kt,this.onStable=new Kt,this.onError=new Kt}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}let d2=(()=>{class n{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{An.assertNotInAngularZone(),l2(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())l2(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),_S=(()=>{class n{constructor(){this._applications=new Map,f2.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return f2.findTestabilityInTree(this,e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class VR{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}let hl,f2=new VR;const mS=new Jn("AllowMultipleToken");function $S(n,t,e=[]){const i=`Platform: ${t}`,r=new Jn(i);return(o=[])=>{let s=vS();if(!s||s.injector.get(mS,!1))if(n)n(e.concat(o).concat({provide:r,useValue:!0}));else{const a=e.concat(o).concat({provide:r,useValue:!0},{provide:B_,useValue:"platform"});!function WR(n){if(hl&&!hl.destroyed&&!hl.injector.get(mS,!1))throw new Vt(400,"");hl=n.get(bS);const t=n.get(hS,null);t&&t.forEach(e=>e())}(Ne.create({providers:a,name:i}))}return function ZR(n){const t=vS();if(!t)throw new Vt(401,"");return t}()}}function vS(){return hl&&!hl.destroyed?hl:null}let bS=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const a=function YR(n,t){let e;return e="noop"===n?new HR:("zone.js"===n?void 0:n)||new An({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),g=[{provide:An,useValue:a}];return a.run(()=>{const w=Ne.create({providers:g,parent:this.injector,name:e.moduleType.name}),G=e.create(w),me=G.injector.get(Qd,null);if(!me)throw new Vt(402,"");return a.runOutsideAngular(()=>{const ve=a.onError.subscribe({next:Ie=>{me.handleError(Ie)}});G.onDestroy(()=>{h2(this._modules,G),ve.unsubscribe()})}),function KR(n,t,e){try{const i=e();return $v(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(me,a,()=>{const ve=G.injector.get(s2);return ve.runInitializers(),ve.donePromise.then(()=>(function P4(n){No(n,"Expected localeId to be defined"),"string"==typeof n&&(i3=n.toLowerCase().replace(/_/g,"-"))}(G.injector.get(Gu,yv)||yv),this._moduleDoBootstrap(G),G))})})}bootstrapModule(e,i=[]){const r=yS({},i);return function GR(n,t,e){const i=new qC(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(CS);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Vt(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Vt(404,"");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(In(Ne))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();function yS(n,t){return Array.isArray(t)?t.reduce(yS,n):Object.assign(Object.assign({},n),t)}let CS=(()=>{class n{constructor(e,i,r,o,s){this._zone=e,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=o,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new O(w=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{w.next(this._stable),w.complete()})}),g=new O(w=>{let G;this._zone.runOutsideAngular(()=>{G=this._zone.onStable.subscribe(()=>{An.assertNotInAngularZone(),l2(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,w.next(!0))})})});const me=this._zone.onUnstable.subscribe(()=>{An.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{w.next(!1)}))});return()=>{G.unsubscribe(),me.unsubscribe()}});this.isStable=_o(a,g.pipe(function Al(n={}){const{connector:t=(()=>new d),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let s=null,a=null,g=null,w=0,G=!1,me=!1;const ve=()=>{null==a||a.unsubscribe(),a=null},Ie=()=>{ve(),s=g=null,G=me=!1},Oe=()=>{const Ve=s;Ie(),null==Ve||Ve.unsubscribe()};return x((Ve,We)=>{w++,!me&&!G&&ve();const Ye=g=null!=g?g:t();We.add(()=>{w--,0===w&&!me&&!G&&(a=Fo(Oe,r))}),Ye.subscribe(We),s||(s=new I({next:Ge=>Ye.next(Ge),error:Ge=>{me=!0,ve(),a=Fo(Ie,e,Ge),Ye.error(Ge)},complete:()=>{G=!0,ve(),a=Fo(Ie,i),Ye.complete()}}),po(Ve).subscribe(s))})(o)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new Vt(405,"");let r;r=e instanceof D3?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(r.componentType);const o=function qR(n){return n.isBoundToModule}(r)?void 0:this._injector.get(sg),a=r.create(Ne.NULL,[],i||r.selector,o),g=a.location.nativeElement,w=a.injector.get(d2,null),G=w&&a.injector.get(_S);return w&&G&&G.registerApplication(g,w),a.onDestroy(()=>{this.detachView(a.hostView),h2(this.components,a),G&&G.unregisterApplication(g)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Vt(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;h2(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(MR,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(e){return new(e||n)(In(An),In(Ne),In(Qd),In(Vu),In(s2))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function h2(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let wS=!0,bi=(()=>{class n{}return n.__NG_ELEMENT_ID__=JR,n})();function JR(n){return function eN(n,t,e){if(Sc(n)&&!e){const i=ro(n.index,t);return new X_(i,i)}return 47&n.type?new X_(t[16],t):null}(Wi(),Tt(),16==(16&n))}class IS{constructor(){}supports(t){return U_(t)}create(t){return new sN(t)}}const oN=(n,t)=>t;class sN{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||oN}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<MS(i,r,o)?e:i,a=MS(s,r,o),g=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const w=a-r,G=g-r;if(w!=G){for(let ve=0;ve<w;ve++){const Ie=ve<o.length?o[ve]:o[ve]=0,Oe=Ie+ve;G<=Oe&&Oe<w&&(o[ve]=Ie+1)}o[s.previousIndex]=G-w}}a!==g&&t(s,a,g)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!U_(t))throw new Vt(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function $F(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[jh()]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new aN(e,i),o,r),t}_verifyReinsertion(t,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,o=t._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new kS),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kS),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class aN{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class lN{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class kS{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new lN,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function MS(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}class AS{constructor(){}supports(t){return t instanceof Map||kC(t)}create(){return new cN}}class cN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||kC(t)))throw new Vt(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new uN(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class uN{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function PS(){return new Rv([new IS])}let Rv=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||PS()),deps:[[n,new Wd,new qd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new Vt(901,"")}}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:PS}),n})();function FS(){return new nm([new AS])}let nm=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||FS()),deps:[[n,new Wd,new qd]]}}find(e){const i=this.factories.find(o=>o.supports(e));if(i)return i;throw new Vt(901,"")}}return n.\u0275prov=Tn({token:n,providedIn:"root",factory:FS}),n})();const hN=$S(null,"core",[{provide:Av,useValue:"unknown"},{provide:bS,deps:[Ne]},{provide:_S,deps:[]},{provide:AR,deps:[]}]);let gN=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(In(CS))},n.\u0275mod=ts({type:n}),n.\u0275inj=es({}),n})(),Nv=null;function hf(){return Nv}const fs=new Jn("DocumentToken");var yr=(()=>((yr=yr||{})[yr.Format=0]="Format",yr[yr.Standalone=1]="Standalone",yr))(),ti=(()=>((ti=ti||{})[ti.Narrow=0]="Narrow",ti[ti.Abbreviated=1]="Abbreviated",ti[ti.Wide=2]="Wide",ti[ti.Short=3]="Short",ti))(),fr=(()=>((fr=fr||{})[fr.Short=0]="Short",fr[fr.Medium=1]="Medium",fr[fr.Long=2]="Long",fr[fr.Full=3]="Full",fr))(),En=(()=>((En=En||{})[En.Decimal=0]="Decimal",En[En.Group=1]="Group",En[En.List=2]="List",En[En.PercentSign=3]="PercentSign",En[En.PlusSign=4]="PlusSign",En[En.MinusSign=5]="MinusSign",En[En.Exponential=6]="Exponential",En[En.SuperscriptingExponent=7]="SuperscriptingExponent",En[En.PerMille=8]="PerMille",En[En.Infinity=9]="Infinity",En[En.NaN=10]="NaN",En[En.TimeSeparator=11]="TimeSeparator",En[En.CurrencyDecimal=12]="CurrencyDecimal",En[En.CurrencyGroup=13]="CurrencyGroup",En))();function Ov(n,t){return Fa(cs(n)[Gt.DateFormat],t)}function Bv(n,t){return Fa(cs(n)[Gt.TimeFormat],t)}function Lv(n,t){return Fa(cs(n)[Gt.DateTimeFormat],t)}function Pa(n,t){const e=cs(n),i=e[Gt.NumberSymbols][t];if(void 0===i){if(t===En.CurrencyDecimal)return e[Gt.NumberSymbols][En.Decimal];if(t===En.CurrencyGroup)return e[Gt.NumberSymbols][En.Group]}return i}function BS(n){if(!n[Gt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Gt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Fa(n,t){for(let e=t;e>-1;e--)if(void 0!==n[e])return n[e];throw new Error("Locale data API: locale data undefined")}function v2(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const PN=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,im={},FN=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Zr=(()=>((Zr=Zr||{})[Zr.Short=0]="Short",Zr[Zr.ShortGMT=1]="ShortGMT",Zr[Zr.Long=2]="Long",Zr[Zr.Extended=3]="Extended",Zr))(),Mn=(()=>((Mn=Mn||{})[Mn.FullYear=0]="FullYear",Mn[Mn.Month=1]="Month",Mn[Mn.Date=2]="Date",Mn[Mn.Hours=3]="Hours",Mn[Mn.Minutes=4]="Minutes",Mn[Mn.Seconds=5]="Seconds",Mn[Mn.FractionalSeconds=6]="FractionalSeconds",Mn[Mn.Day=7]="Day",Mn))(),qn=(()=>((qn=qn||{})[qn.DayPeriods=0]="DayPeriods",qn[qn.Days=1]="Days",qn[qn.Months=2]="Months",qn[qn.Eras=3]="Eras",qn))();function RN(n,t,e,i){let r=function jN(n){if(US(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,o=1,s=1]=n.split("-").map(a=>+a);return zv(r,o-1,s)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(PN))return function GN(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,o=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const s=Number(n[4]||0)-e,a=Number(n[5]||0)-i,g=Number(n[6]||0),w=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return o.call(t,s,a,g,w),t}(i)}const t=new Date(n);if(!US(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=zc(e,t)||t;let a,s=[];for(;t;){if(a=FN.exec(t),!a){s.push(t);break}{s=s.concat(a.slice(1));const G=s.pop();if(!G)break;t=G}}let g=r.getTimezoneOffset();i&&(g=zS(i,g),r=function VN(n,t,e){const i=e?-1:1,r=n.getTimezoneOffset();return function HN(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,i*(zS(t,r)-r))}(r,i,!0));let w="";return s.forEach(G=>{const me=function UN(n){if(y2[n])return y2[n];let t;switch(n){case"G":case"GG":case"GGG":t=Xi(qn.Eras,ti.Abbreviated);break;case"GGGG":t=Xi(qn.Eras,ti.Wide);break;case"GGGGG":t=Xi(qn.Eras,ti.Narrow);break;case"y":t=Nr(Mn.FullYear,1,0,!1,!0);break;case"yy":t=Nr(Mn.FullYear,2,0,!0,!0);break;case"yyy":t=Nr(Mn.FullYear,3,0,!1,!0);break;case"yyyy":t=Nr(Mn.FullYear,4,0,!1,!0);break;case"Y":t=jv(1);break;case"YY":t=jv(2,!0);break;case"YYY":t=jv(3);break;case"YYYY":t=jv(4);break;case"M":case"L":t=Nr(Mn.Month,1,1);break;case"MM":case"LL":t=Nr(Mn.Month,2,1);break;case"MMM":t=Xi(qn.Months,ti.Abbreviated);break;case"MMMM":t=Xi(qn.Months,ti.Wide);break;case"MMMMM":t=Xi(qn.Months,ti.Narrow);break;case"LLL":t=Xi(qn.Months,ti.Abbreviated,yr.Standalone);break;case"LLLL":t=Xi(qn.Months,ti.Wide,yr.Standalone);break;case"LLLLL":t=Xi(qn.Months,ti.Narrow,yr.Standalone);break;case"w":t=b2(1);break;case"ww":t=b2(2);break;case"W":t=b2(1,!0);break;case"d":t=Nr(Mn.Date,1);break;case"dd":t=Nr(Mn.Date,2);break;case"c":case"cc":t=Nr(Mn.Day,1);break;case"ccc":t=Xi(qn.Days,ti.Abbreviated,yr.Standalone);break;case"cccc":t=Xi(qn.Days,ti.Wide,yr.Standalone);break;case"ccccc":t=Xi(qn.Days,ti.Narrow,yr.Standalone);break;case"cccccc":t=Xi(qn.Days,ti.Short,yr.Standalone);break;case"E":case"EE":case"EEE":t=Xi(qn.Days,ti.Abbreviated);break;case"EEEE":t=Xi(qn.Days,ti.Wide);break;case"EEEEE":t=Xi(qn.Days,ti.Narrow);break;case"EEEEEE":t=Xi(qn.Days,ti.Short);break;case"a":case"aa":case"aaa":t=Xi(qn.DayPeriods,ti.Abbreviated);break;case"aaaa":t=Xi(qn.DayPeriods,ti.Wide);break;case"aaaaa":t=Xi(qn.DayPeriods,ti.Narrow);break;case"b":case"bb":case"bbb":t=Xi(qn.DayPeriods,ti.Abbreviated,yr.Standalone,!0);break;case"bbbb":t=Xi(qn.DayPeriods,ti.Wide,yr.Standalone,!0);break;case"bbbbb":t=Xi(qn.DayPeriods,ti.Narrow,yr.Standalone,!0);break;case"B":case"BB":case"BBB":t=Xi(qn.DayPeriods,ti.Abbreviated,yr.Format,!0);break;case"BBBB":t=Xi(qn.DayPeriods,ti.Wide,yr.Format,!0);break;case"BBBBB":t=Xi(qn.DayPeriods,ti.Narrow,yr.Format,!0);break;case"h":t=Nr(Mn.Hours,1,-12);break;case"hh":t=Nr(Mn.Hours,2,-12);break;case"H":t=Nr(Mn.Hours,1);break;case"HH":t=Nr(Mn.Hours,2);break;case"m":t=Nr(Mn.Minutes,1);break;case"mm":t=Nr(Mn.Minutes,2);break;case"s":t=Nr(Mn.Seconds,1);break;case"ss":t=Nr(Mn.Seconds,2);break;case"S":t=Nr(Mn.FractionalSeconds,1);break;case"SS":t=Nr(Mn.FractionalSeconds,2);break;case"SSS":t=Nr(Mn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Hv(Zr.Short);break;case"ZZZZZ":t=Hv(Zr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Hv(Zr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Hv(Zr.Long);break;default:return null}return y2[n]=t,t}(G);w+=me?me(r,e,g):"''"===G?"'":G.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),w}function zv(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function zc(n,t){const e=function yN(n){return cs(n)[Gt.LocaleId]}(n);if(im[e]=im[e]||{},im[e][t])return im[e][t];let i="";switch(t){case"shortDate":i=Ov(n,fr.Short);break;case"mediumDate":i=Ov(n,fr.Medium);break;case"longDate":i=Ov(n,fr.Long);break;case"fullDate":i=Ov(n,fr.Full);break;case"shortTime":i=Bv(n,fr.Short);break;case"mediumTime":i=Bv(n,fr.Medium);break;case"longTime":i=Bv(n,fr.Long);break;case"fullTime":i=Bv(n,fr.Full);break;case"short":const r=zc(n,"shortTime"),o=zc(n,"shortDate");i=Uv(Lv(n,fr.Short),[r,o]);break;case"medium":const s=zc(n,"mediumTime"),a=zc(n,"mediumDate");i=Uv(Lv(n,fr.Medium),[s,a]);break;case"long":const g=zc(n,"longTime"),w=zc(n,"longDate");i=Uv(Lv(n,fr.Long),[g,w]);break;case"full":const G=zc(n,"fullTime"),me=zc(n,"fullDate");i=Uv(Lv(n,fr.Full),[G,me])}return i&&(im[e][t]=i),i}function Uv(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function gl(n,t,e="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,o=e));let s=String(n);for(;s.length<t;)s="0"+s;return i&&(s=s.substr(s.length-t)),o+s}function Nr(n,t,e=0,i=!1,r=!1){return function(o,s){let a=function ON(n,t){switch(n){case Mn.FullYear:return t.getFullYear();case Mn.Month:return t.getMonth();case Mn.Date:return t.getDate();case Mn.Hours:return t.getHours();case Mn.Minutes:return t.getMinutes();case Mn.Seconds:return t.getSeconds();case Mn.FractionalSeconds:return t.getMilliseconds();case Mn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,o);if((e>0||a>-e)&&(a+=e),n===Mn.Hours)0===a&&-12===e&&(a=12);else if(n===Mn.FractionalSeconds)return function NN(n,t){return gl(n,3).substr(0,t)}(a,t);const g=Pa(s,En.MinusSign);return gl(a,t,g,i,r)}}function Xi(n,t,e=yr.Format,i=!1){return function(r,o){return function BN(n,t,e,i,r,o){switch(e){case qn.Months:return function wN(n,t,e){const i=cs(n),o=Fa([i[Gt.MonthsFormat],i[Gt.MonthsStandalone]],t);return Fa(o,e)}(t,r,i)[n.getMonth()];case qn.Days:return function xN(n,t,e){const i=cs(n),o=Fa([i[Gt.DaysFormat],i[Gt.DaysStandalone]],t);return Fa(o,e)}(t,r,i)[n.getDay()];case qn.DayPeriods:const s=n.getHours(),a=n.getMinutes();if(o){const w=function DN(n){const t=cs(n);return BS(t),(t[Gt.ExtraData][2]||[]).map(i=>"string"==typeof i?v2(i):[v2(i[0]),v2(i[1])])}(t),G=function IN(n,t,e){const i=cs(n);BS(i);const o=Fa([i[Gt.ExtraData][0],i[Gt.ExtraData][1]],t)||[];return Fa(o,e)||[]}(t,r,i),me=w.findIndex(ve=>{if(Array.isArray(ve)){const[Ie,Oe]=ve,Ve=s>=Ie.hours&&a>=Ie.minutes,We=s<Oe.hours||s===Oe.hours&&a<Oe.minutes;if(Ie.hours<Oe.hours){if(Ve&&We)return!0}else if(Ve||We)return!0}else if(ve.hours===s&&ve.minutes===a)return!0;return!1});if(-1!==me)return G[me]}return function CN(n,t,e){const i=cs(n),o=Fa([i[Gt.DayPeriodsFormat],i[Gt.DayPeriodsStandalone]],t);return Fa(o,e)}(t,r,i)[s<12?0:1];case qn.Eras:return function EN(n,t){return Fa(cs(n)[Gt.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,n,t,e,i)}}function Hv(n){return function(t,e,i){const r=-1*i,o=Pa(e,En.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Zr.Short:return(r>=0?"+":"")+gl(s,2,o)+gl(Math.abs(r%60),2,o);case Zr.ShortGMT:return"GMT"+(r>=0?"+":"")+gl(s,1,o);case Zr.Long:return"GMT"+(r>=0?"+":"")+gl(s,2,o)+":"+gl(Math.abs(r%60),2,o);case Zr.Extended:return 0===i?"Z":(r>=0?"+":"")+gl(s,2,o)+":"+gl(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}function LS(n){return zv(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function b2(n,t=!1){return function(e,i){let r;if(t){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=LS(e),s=function zN(n){const t=zv(n,0,1).getDay();return zv(n,0,1+(t<=4?4:11)-t)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return gl(r,n,Pa(i,En.MinusSign))}}function jv(n,t=!1){return function(e,i){return gl(LS(e).getFullYear(),n,Pa(i,En.MinusSign),t)}}const y2={};function zS(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function US(n){return n instanceof Date&&!isNaN(n.valueOf())}let nr=(()=>{class n{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(U_(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ci(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(e){return new(e||n)(Be(Rv),Be(nm),Be(di),Be(ju))},n.\u0275dir=rn({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class o6{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let oi=(()=>{class n{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new o6(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),GS(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{GS(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Be(us),Be(Ei),Be(Rv))},n.\u0275dir=rn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function GS(n,t){n.context.$implicit=t.item}let Sn=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new s6,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){qS("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){qS("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Be(us),Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class s6{constructor(){this.$implicit=null,this.ngIf=null}}function qS(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${ci(t)}'.`)}class S2{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let ec=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rn({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),qu=(()=>{class n{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new S2(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(Be(us),Be(Ei),Be(ec,9))},n.\u0275dir=rn({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),gf=(()=>{class n{constructor(e,i,r){r._addDefault(new S2(e,i))}}return n.\u0275fac=function(e){return new(e||n)(Be(us),Be(Ei),Be(ec,9))},n.\u0275dir=rn({type:n,selectors:[["","ngSwitchDefault",""]]}),n})(),bo=(()=>{class n{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split(".");null!=(i=null!=i&&o?`${i}${o}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(Be(di),Be(nm),Be(ju))},n.\u0275dir=rn({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),n})(),Ra=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(Be(us))},n.\u0275dir=rn({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[vr]}),n})();const m6=new Jn("DATE_PIPE_DEFAULT_TIMEZONE");let D2=(()=>{class n{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,o){var s;if(null==e||""===e||e!=e)return null;try{return RN(e,i,o||this.locale,null!==(s=null!=r?r:this.defaultTimezone)&&void 0!==s?s:void 0)}catch(a){throw function pl(n,t){return new Vt(2100,"")}()}}}return n.\u0275fac=function(e){return new(e||n)(Be(Gu,16),Be(m6,24))},n.\u0275pipe=Vr({name:"date",type:n,pure:!0}),n})(),M2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({}),n})();const YS="browser";class A2 extends class F6 extends class mN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function _N(n){Nv||(Nv=n)}(new A2)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function R6(){return om=om||document.querySelector("base"),om?om.getAttribute("href"):null}();return null==e?null:function N6(n){qv=qv||document.createElement("a"),qv.setAttribute("href",n);const t=qv.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){om=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function i6(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let qv,om=null;const XS=new Jn("TRANSITION_ID"),B6=[{provide:dS,useFactory:function O6(n,t,e){return()=>{e.get(s2).donePromise.then(()=>{const i=hf(),r=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[XS,fs,Ne],multi:!0}];class P2{static init(){!function jR(n){f2=n}(new P2)}addToWindow(t){wi.getAngularTestability=(i,r=!0)=>{const o=t.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},wi.getAllAngularTestabilities=()=>t.getAllTestabilities(),wi.getAllAngularRootElements=()=>t.getAllRootElements(),wi.frameworkStabilizers||(wi.frameworkStabilizers=[]),wi.frameworkStabilizers.push(i=>{const r=wi.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(g){s=s||g,o--,0==o&&i(s)};r.forEach(function(g){g.whenStable(a)})})}findTestabilityInTree(t,e,i){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:i?hf().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let L6=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const Wv=new Jn("EventManagerPlugins");let Zv=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(In(Wv),In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class QS{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const r=hf().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let JS=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),sm=(()=>{class n extends JS{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(eD),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(eD))}}return n.\u0275fac=function(e){return new(e||n)(In(fs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();function eD(n){hf().remove(n)}const F2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},R2=/%COMP%/g;function Yv(n,t,e){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?Yv(n,r,e):(r=r.replace(R2,n),e.push(r))}return e}function iD(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Kv=(()=>{class n{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new N2(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case Cs.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new G6(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case Cs.ShadowDom:return new q6(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=Yv(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(In(Zv),In(sm),In(tm))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class N2{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(F2[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const o=F2[r];o?t.setAttributeNS(o,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=F2[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(ss.DashCase|ss.Important)?t.style.setProperty(e,i,r&ss.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&ss.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,iD(i)):this.eventManager.addEventListener(t,e,iD(i))}}class G6 extends N2{constructor(t,e,i,r){super(t),this.component=i;const o=Yv(r+"-"+i.id,i.styles,[]);e.addStyles(o),this.contentAttr=function H6(n){return"_ngcontent-%COMP%".replace(R2,n)}(r+"-"+i.id),this.hostAttr=function V6(n){return"_nghost-%COMP%".replace(R2,n)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class q6 extends N2{constructor(t,e,i,r){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Yv(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let W6=(()=>{class n extends QS{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)(In(fs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const oD=["alt","control","meta","shift"],Y6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sD={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},K6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let X6=(()=>{class n extends QS{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const o=n.parseEventName(i),s=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hf().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let s="";if(oD.forEach(g=>{const w=i.indexOf(g);w>-1&&(i.splice(w,1),s+=g+".")}),s+=o,0!=i.length||0===o.length)return null;const a={};return a.domEventName=r,a.fullKey=s,a}static getEventFullKey(e){let i="",r=function Q6(n){let t=n.key;if(null==t){if(t=n.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===n.location&&sD.hasOwnProperty(t)&&(t=sD[t]))}return Y6[t]||t}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),oD.forEach(o=>{o!=r&&K6[o](e)&&(i+=o+".")}),i+=r,i}static eventCallback(e,i,r){return o=>{n.getEventFullKey(o)===e&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(In(fs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const nO=$S(hN,"browser",[{provide:Av,useValue:YS},{provide:hS,useValue:function J6(){A2.makeCurrent(),P2.init()},multi:!0},{provide:fs,useFactory:function tO(){return function kb(n){eh=n}(document),document},deps:[]}]),iO=[{provide:B_,useValue:"root"},{provide:Qd,useFactory:function eO(){return new Qd},deps:[]},{provide:Wv,useClass:W6,multi:!0,deps:[fs,An,Av]},{provide:Wv,useClass:X6,multi:!0,deps:[fs]},{provide:Kv,useClass:Kv,deps:[Zv,sm,tm]},{provide:K_,useExisting:Kv},{provide:JS,useExisting:sm},{provide:sm,useClass:sm,deps:[fs]},{provide:d2,useClass:d2,deps:[An]},{provide:Zv,useClass:Zv,deps:[Wv,An]},{provide:class P6{},useClass:L6,deps:[]}];let aD=(()=>{class n{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:n,providers:[{provide:tm,useValue:e.appId},{provide:XS,useExisting:tm},B6]}}}return n.\u0275fac=function(e){return new(e||n)(In(n,12))},n.\u0275mod=ts({type:n}),n.\u0275inj=es({providers:iO,imports:[M2,gN]}),n})();"undefined"!=typeof window&&window;let Xv=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:function(e){let i=null;return i=e?new(e||n):In(uD),i},providedIn:"root"}),n})(),uD=(()=>{class n extends Xv{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case Vi.NONE:return i;case Vi.HTML:return Ta(i,"HTML")?os(i):a0(this._doc,String(i)).toString();case Vi.STYLE:return Ta(i,"Style")?os(i):i;case Vi.SCRIPT:if(Ta(i,"Script"))return os(i);throw new Error("unsafe value used in a script context");case Vi.URL:return Z$(i),Ta(i,"URL")?os(i):Ho(String(i));case Vi.RESOURCE_URL:if(Ta(i,"ResourceURL"))return os(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function iy(n){return new ty(n)}(e)}bypassSecurityTrustStyle(e){return function Y$(n){return new ny(n)}(e)}bypassSecurityTrustScript(e){return function K$(n){return new Zd(n)}(e)}bypassSecurityTrustUrl(e){return function ry(n){return new q$(n)}(e)}bypassSecurityTrustResourceUrl(e){return function Np(n){return new W$(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(In(fs))},n.\u0275prov=Tn({token:n,factory:function(e){let i=null;return i=e?new e:function hO(n){return new uD(n.get(fs))}(In(Ne)),i},providedIn:"root"}),n})();ye(5386);const{isArray:gO}=Array,{getPrototypeOf:pO,prototype:_O,keys:mO}=Object;function dD(n){if(1===n.length){const t=n[0];if(gO(t))return{args:t,keys:null};if(function $O(n){return n&&"object"==typeof n&&pO(n)===_O}(t)){const e=mO(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:vO}=Array;function am(n){return se(t=>function bO(n,t){return vO(t)?n(...t):n(t)}(n,t))}function fD(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}let hD=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Be(ju),Be(di))},n.\u0275dir=rn({type:n}),n})(),pf=(()=>{class n extends hD{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,features:[Li]}),n})();const _l=new Jn("NgValueAccessor"),CO={provide:_l,useExisting:ri(()=>ra),multi:!0};let ra=(()=>{class n extends pf{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[Ki([CO]),Li]}),n})();const xO={provide:_l,useExisting:ri(()=>Fi),multi:!0},EO=new Jn("CompositionEventMode");let Fi=(()=>{class n extends hD{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function wO(){const n=hf()?hf().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(ju),Be(di),Be(EO,8))},n.\u0275dir=rn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Re("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Ki([xO]),Li]}),n})();function Zu(n){return null==n||0===n.length}function gD(n){return null!=n&&"number"==typeof n.length}const Zo=new Jn("NgValidators"),Yu=new Jn("NgAsyncValidators");function mD(n){return Zu(n.value)?{required:!0}:null}function Qv(n){return null}function xD(n){return null!=n}function wD(n){const t=$v(n)?po(n):n;return hT(t),t}function ED(n){let t={};return n.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function TD(n,t){return t.map(e=>e(n))}function SD(n){return n.map(t=>function SO(n){return!n.validate}(t)?t:e=>t.validate(e))}function B2(n){return null!=n?function DD(n){if(!n)return null;const t=n.filter(xD);return 0==t.length?null:function(e){return ED(TD(e,t))}}(SD(n)):null}function L2(n){return null!=n?function ID(n){if(!n)return null;const t=n.filter(xD);return 0==t.length?null:function(e){return function yO(...n){const t=Dl(n),{args:e,keys:i}=dD(n),r=new O(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let g=s,w=s;for(let G=0;G<s;G++){let me=!1;Mo(e[G]).subscribe($(o,ve=>{me||(me=!0,w--),a[G]=ve},()=>g--,void 0,()=>{(!g||!me)&&(w||o.next(i?fD(i,a):a),o.complete())}))}});return t?r.pipe(am(t)):r}(TD(e,t).map(wD)).pipe(se(ED))}}(SD(n)):null}function kD(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function z2(n){return n?Array.isArray(n)?n:[n]:[]}function Jv(n,t){return Array.isArray(n)?n.includes(t):n===t}function PD(n,t){const e=z2(t);return z2(n).forEach(r=>{Jv(e,r)||e.push(r)}),e}function FD(n,t){return z2(t).filter(e=>!Jv(n,e))}class RD{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=B2(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=L2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Ku extends RD{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class hs extends RD{get formDirective(){return null}get path(){return null}}class ND{constructor(t){this._cd=t}is(t){var e,i,r;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}let Ti=(()=>{class n extends ND{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(Ku,2))},n.\u0275dir=rn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Aa("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Li]}),n})(),gs=(()=>{class n extends ND{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(hs,10))},n.\u0275dir=rn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Aa("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[Li]}),n})();function lm(n,t){V2(n,t),t.valueAccessor.writeValue(n.value),function RO(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&BD(n,t)})}(n,t),function OO(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function NO(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&BD(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function FO(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function i1(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function V2(n,t){const e=function MD(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(kD(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function AD(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(kD(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();i1(t._rawValidators,r),i1(t._rawAsyncValidators,r)}function BD(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function q2(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const cm="VALID",o1="INVALID",cg="PENDING",um="DISABLED";function Z2(n){return(s1(n)?n.validators:n)||null}function HD(n){return Array.isArray(n)?B2(n):n||null}function Y2(n,t){return(s1(t)?t.asyncValidators:n)||null}function VD(n){return Array.isArray(n)?L2(n):n||null}function s1(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const K2=n=>n instanceof Q2;function GD(n){return(n=>n instanceof ZD)(n)?n.value:n.getRawValue()}function qD(n,t){const e=K2(n),i=n.controls;if(!(e?Object.keys(i):i).length)throw new Vt(1e3,"");if(!i[t])throw new Vt(1001,"")}function WD(n,t){K2(n),n._forEachChild((i,r)=>{if(void 0===t[r])throw new Vt(1002,"")})}class X2{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=HD(this._rawValidators),this._composedAsyncValidatorFn=VD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===cm}get invalid(){return this.status===o1}get pending(){return this.status==cg}get disabled(){return this.status===um}get enabled(){return this.status!==um}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=HD(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=VD(t)}addValidators(t){this.setValidators(PD(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(PD(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(FD(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(FD(t,this._rawAsyncValidators))}hasValidator(t){return Jv(this._rawValidators,t)}hasAsyncValidator(t){return Jv(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=cg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=um,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=cm,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===cm||this.status===cg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?um:cm}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=cg,this._hasOwnPendingAsyncValidator=!0;const e=wD(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function UO(n,t,e){if(null==t||(Array.isArray(t)||(t=t.split(e)),Array.isArray(t)&&0===t.length))return null;let i=n;return t.forEach(r=>{i=K2(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof VO)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Kt,this.statusChanges=new Kt}_calculateStatus(){return this._allControlsDisabled()?um:this.errors?o1:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(cg)?cg:this._anyControlsHaveStatus(o1)?o1:cm}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){s1(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ZD extends X2{constructor(t=null,e,i){super(Z2(e),Y2(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),s1(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){q2(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){q2(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Q2 extends X2{constructor(t,e,i){super(Z2(e),Y2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){WD(this,t),Object.keys(t).forEach(i=>{qD(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=GD(e),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class VO extends X2{constructor(t,e,i){super(Z2(e),Y2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){WD(this,t),t.forEach((i,r)=>{qD(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>GD(t))}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const jO={provide:hs,useExisting:ri(()=>yo)},dm=(()=>Promise.resolve(null))();let yo=(()=>{class n extends hs{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Kt,this.form=new Q2({},B2(e),L2(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){dm.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),lm(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){dm.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){dm.then(()=>{const i=this._findContainer(e.path),r=new Q2({});(function LD(n,t){V2(n,t)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){dm.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){dm.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function UD(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Be(Zo,10),Be(Yu,10))},n.\u0275dir=rn({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Re("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ki([jO]),Li]}),n})();const qO={provide:Ku,useExisting:ri(()=>yi)},XD=(()=>Promise.resolve(null))();let yi=(()=>{class n extends Ku{constructor(e,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new ZD,this._registered=!1,this.update=new Kt,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function G2(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(o=>{o.constructor===Fi?e=o:function zO(n){return Object.getPrototypeOf(n.constructor)===pf}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function j2(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){lm(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){XD.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;XD.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(e){return this._parent?function t1(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Be(hs,9),Be(Zo,10),Be(Yu,10),Be(_l,10),Be(bi,8))},n.\u0275dir=rn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ki([qO]),Li,vr]}),n})(),ps=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const WO={provide:_l,useExisting:ri(()=>_s),multi:!0};let _s=(()=>{class n extends pf{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Re("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ki([WO]),Li]}),n})();const ZO={provide:_l,useExisting:ri(()=>Xu),multi:!0};let QD=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({}),n})(),YO=(()=>{class n{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:QD}),n})(),Xu=(()=>{class n extends pf{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Ku),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(e){return new(e||n)(Be(ju),Be(di),Be(YO),Be(Ne))},n.\u0275dir=rn({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ki([ZO]),Li]}),n})();const KO={provide:_l,useExisting:ri(()=>oa),multi:!0};let oa=(()=>{class n extends pf{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ki([KO]),Li]}),n})();const n8={provide:_l,useExisting:ri(()=>tc),multi:!0};function iI(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let tc=(()=>{class n extends pf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=iI(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function i8(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ki([n8]),Li]}),n})(),nc=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(iI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Be(di),Be(ju),Be(tc,9))},n.\u0275dir=rn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const r8={provide:_l,useExisting:ri(()=>nx),multi:!0};function rI(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let nx=(()=>{class n extends pf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const w=this._getOptionValue(s[a].value);r.push(w)}}else{const s=i.options;for(let a=0;a<s.length;a++){const g=s[a];if(g.selected){const w=this._getOptionValue(g.value);r.push(w)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function o8(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Re("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ki([r8]),Li]}),n})(),ic=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(rI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(rI(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Be(di),Be(ju),Be(nx,9))},n.\u0275dir=rn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();function oI(n){return"number"==typeof n?n:parseInt(n,10)}function sI(n){return"number"==typeof n?n:parseFloat(n)}let _f=(()=>{class n{constructor(){this._validator=Qv}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Qv,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=rn({type:n,features:[vr]}),n})();const a8={provide:Zo,useExisting:ri(()=>Qu),multi:!0};let Qu=(()=>{class n extends _f{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>sI(e),this.createValidator=e=>function _D(n){return t=>{if(Zu(t.value)||Zu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Zt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[Ki([a8]),Li]}),n})();const l8={provide:Zo,useExisting:ri(()=>Ju),multi:!0};let Ju=(()=>{class n extends _f{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>sI(e),this.createValidator=e=>function pD(n){return t=>{if(Zu(t.value)||Zu(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Zt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[Ki([l8]),Li]}),n})();const c8={provide:Zo,useExisting:ri(()=>a1),multi:!0};let a1=(()=>{class n extends _f{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function s8(n){return null!=n&&!1!==n&&"false"!=`${n}`}(e),this.createValidator=e=>mD}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Zt("required",i._enabled?"":null)},inputs:{required:"required"},features:[Ki([c8]),Li]}),n})();const f8={provide:Zo,useExisting:ri(()=>ix),multi:!0};let ix=(()=>{class n extends _f{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>oI(e),this.createValidator=e=>function bD(n){return t=>Zu(t.value)||!gD(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Zt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[Ki([f8]),Li]}),n})();const h8={provide:Zo,useExisting:ri(()=>rx),multi:!0};let rx=(()=>{class n extends _f{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>oI(e),this.createValidator=e=>function yD(n){return t=>gD(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Pr(n)))(i||n)}}(),n.\u0275dir=rn({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Zt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ki([h8]),Li]}),n})(),p8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({imports:[[QD]]}),n})(),_8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({imports:[p8]}),n})();class uI{}const Uc="*";function Na(n,t){return{type:7,name:n,definitions:t,options:{}}}function Or(n,t=null){return{type:4,styles:t,timings:n}}function dI(n,t=null){return{type:2,steps:n,options:t}}function mn(n){return{type:6,styles:n,offset:null}}function ox(n,t,e){return{type:0,name:n,styles:t,options:e}}function Ns(n){return{type:5,steps:n}}function Br(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function fI(n){Promise.resolve(null).then(n)}class fm{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){fI(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class hI{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const o=this.players.length;0==o?fI(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const ii=!1;function gI(n){return new Vt(3e3,ii)}function X8(){return"undefined"!=typeof window&&void 0!==window.document}function ax(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function ed(n){switch(n.length){case 0:return new fm;case 1:return n[0];default:return new hI(n)}}function pI(n,t,e,i,r={},o={}){const s=[],a=[];let g=-1,w=null;if(i.forEach(G=>{const me=G.offset,ve=me==g,Ie=ve&&w||{};Object.keys(G).forEach(Oe=>{let Ve=Oe,We=G[Oe];if("offset"!==Oe)switch(Ve=t.normalizePropertyName(Ve,s),We){case"!":We=r[Oe];break;case Uc:We=o[Oe];break;default:We=t.normalizeStyleValue(Oe,Ve,We,s)}Ie[Ve]=We}),ve||a.push(Ie),w=Ie,g=me}),s.length)throw function z8(n){return new Vt(3502,ii)}();return a}function lx(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&cx(e,"start",n)));break;case"done":n.onDone(()=>i(e&&cx(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&cx(e,"destroy",n)))}}function cx(n,t,e){const i=e.totalTime,o=ux(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,null==i?n.totalTime:i,!!e.disabled),s=n._data;return null!=s&&(o._data=s),o}function ux(n,t,e,i,r="",o=0,s){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function sa(n,t,e){let i;return n instanceof Map?(i=n.get(t),i||n.set(t,i=e)):(i=n[t],i||(i=n[t]=e)),i}function _I(n){const t=n.indexOf(":");return[n.substring(1,t),n.substr(t+1)]}let dx=(n,t)=>!1,mI=(n,t,e)=>[],$I=null;function fx(n){const t=n.parentNode||n.host;return t===$I?null:t}(ax()||"undefined"!=typeof Element)&&(X8()?($I=(()=>document.documentElement)(),dx=(n,t)=>{for(;t;){if(t===n)return!0;t=fx(t)}return!1}):dx=(n,t)=>n.contains(t),mI=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let mf=null,vI=!1;function bI(n){mf||(mf=function J8(){return"undefined"!=typeof document?document.body:null}()||{},vI=!!mf.style&&"WebkitAppearance"in mf.style);let t=!0;return mf.style&&!function Q8(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in mf.style,!t&&vI&&(t="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in mf.style)),t}const yI=dx,CI=mI;let xI=(()=>{class n{validateStyleProperty(e){return bI(e)}matchesElement(e,i){return!1}containsElement(e,i){return yI(e,i)}getParentElement(e){return fx(e)}query(e,i,r){return CI(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],g){return new fm(r,o)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),hx=(()=>{class n{}return n.NOOP=new xI,n})();const gx="ng-enter",c1="ng-leave",u1="ng-trigger",d1=".ng-trigger",EI="ng-animating",px=".ng-animating";function $f(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:_x(parseFloat(t[1]),t[2])}function _x(n,t){return"s"===t?1e3*n:n}function f1(n,t,e){return n.hasOwnProperty("duration")?n:function nB(n,t,e){let r,o=0,s="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(gI()),{duration:0,delay:0,easing:""};r=_x(parseFloat(a[1]),a[2]);const g=a[3];null!=g&&(o=_x(parseFloat(g),a[4]));const w=a[5];w&&(s=w)}else r=n;if(!e){let a=!1,g=t.length;r<0&&(t.push(function $8(){return new Vt(3100,ii)}()),a=!0),o<0&&(t.push(function v8(){return new Vt(3101,ii)}()),a=!0),a&&t.splice(g,0,gI())}return{duration:r,delay:o,easing:s}}(n,t,e)}function ug(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function td(n,t,e={}){if(t)for(let i in n)e[i]=n[i];else ug(n,e);return e}function SI(n,t,e){return e?t+":"+e+";":""}function DI(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=SI(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=SI(0,oB(e),n.style[e]));n.setAttribute("style",t)}function rc(n,t,e){n.style&&(Object.keys(t).forEach(i=>{const r=$x(i);e&&!e.hasOwnProperty(i)&&(e[i]=n.style[r]),n.style[r]=t[i]}),ax()&&DI(n))}function vf(n,t){n.style&&(Object.keys(t).forEach(e=>{const i=$x(e);n.style[i]=""}),ax()&&DI(n))}function hm(n){return Array.isArray(n)?1==n.length?n[0]:dI(n):n}const mx=new RegExp("{{\\s*(.+?)\\s*}}","g");function II(n){let t=[];if("string"==typeof n){let e;for(;e=mx.exec(n);)t.push(e[1]);mx.lastIndex=0}return t}function h1(n,t,e){const i=n.toString(),r=i.replace(mx,(o,s)=>{let a=t[s];return t.hasOwnProperty(s)||(e.push(function y8(n){return new Vt(3003,ii)}()),a=""),a.toString()});return r==i?n:r}function g1(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const rB=/-+([a-z0-9])/g;function $x(n){return n.replace(rB,(...t)=>t[1].toUpperCase())}function oB(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function aa(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function C8(n){return new Vt(3004,ii)}()}}function kI(n,t){return window.getComputedStyle(n)[t]}function dB(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function fB(n,t,e){if(":"==n[0]){const g=function hB(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function N8(n){return new Vt(3016,ii)}()),"* => *"}}(n,e);if("function"==typeof g)return void t.push(g);n=g}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function R8(n){return new Vt(3015,ii)}()),t;const r=i[1],o=i[2],s=i[3];t.push(MI(r,s));"<"==o[0]&&!("*"==r&&"*"==s)&&t.push(MI(s,r))}(i,e,t)):e.push(n),e}const $1=new Set(["true","1"]),v1=new Set(["false","0"]);function MI(n,t){const e=$1.has(n)||v1.has(n),i=$1.has(t)||v1.has(t);return(r,o)=>{let s="*"==n||n==r,a="*"==t||t==o;return!s&&e&&"boolean"==typeof r&&(s=r?$1.has(n):v1.has(n)),!a&&i&&"boolean"==typeof o&&(a=o?$1.has(t):v1.has(t)),s&&a}}const gB=new RegExp("s*:selfs*,?","g");function vx(n,t,e,i){return new pB(n).build(t,e,i)}class pB{constructor(t){this._driver=t}build(t,e,i){const r=new $B(e);this._resetContextStyleTimingState(r);const o=aa(this,hm(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),o}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push(function w8(){return new Vt(3006,ii)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const g=a,w=g.name;w.toString().split(/\s*,\s*/).forEach(G=>{g.name=G,o.push(this.visitState(g,e))}),g.name=w}else if(1==a.type){const g=this.visitTransition(a,e);i+=g.queryCount,r+=g.depCount,s.push(g)}else e.errors.push(function E8(){return new Vt(3007,ii)}())}),{type:7,name:t.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{if(b1(a)){const g=a;Object.keys(g).forEach(w=>{II(g[w]).forEach(G=>{s.hasOwnProperty(G)||o.add(G)})})}}),o.size&&(g1(o.values()),e.errors.push(function T8(n,t){return new Vt(3008,ii)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=aa(this,hm(t.animation),e);return{type:1,matchers:dB(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:bf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>aa(this,i,e)),options:bf(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const o=t.steps.map(s=>{e.currentTime=i;const a=aa(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:bf(t.options)}}visitAnimate(t,e){const i=function bB(n,t){let e=null;if(n.hasOwnProperty("duration"))e=n;else if("number"==typeof n)return bx(f1(n,t).duration,0,"");const i=n;if(i.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=bx(0,0,"");return o.dynamic=!0,o.strValue=i,o}return e=e||f1(i,t),bx(e.duration,e.delay,e.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,o=t.styles?t.styles:mn({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=t.styles,a=!1;if(!s){a=!0;const w={};i.easing&&(w.easing=i.easing),s=mn(w)}e.currentTime+=i.duration+i.delay;const g=this.visitStyle(s,e);g.isEmptyStep=a,r=g}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[];Array.isArray(t.styles)?t.styles.forEach(s=>{"string"==typeof s?s==Uc?i.push(s):e.errors.push(function S8(n){return new Vt(3002,ii)}()):i.push(s)}):i.push(t.styles);let r=!1,o=null;return i.forEach(s=>{if(b1(s)){const a=s,g=a.easing;if(g&&(o=g,delete a.easing),!r)for(let w in a)if(a[w].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:o,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),t.styles.forEach(s=>{"string"!=typeof s&&Object.keys(s).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete s[a],void e.unsupportedCSSPropertiesFound.add(a);const g=e.collectedStyles[e.currentQuerySelector],w=g[a];let G=!0;w&&(o!=r&&o>=w.startTime&&r<=w.endTime&&(e.errors.push(function D8(n,t,e,i,r){return new Vt(3010,ii)}()),G=!1),o=w.startTime),G&&(g[a]={startTime:o,endTime:r}),e.options&&function iB(n,t,e){const i=t.params||{},r=II(n);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function b8(n){return new Vt(3001,ii)}())})}(s[a],e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function I8(){return new Vt(3011,ii)}()),i;let o=0;const s=[];let a=!1,g=!1,w=0;const G=t.steps.map(Ye=>{const Ge=this._makeStyleAst(Ye,e);let ct=null!=Ge.offset?Ge.offset:function vB(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(b1(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}});else if(b1(n)&&n.hasOwnProperty("offset")){const e=n;t=parseFloat(e.offset),delete e.offset}return t}(Ge.styles),rt=0;return null!=ct&&(o++,rt=Ge.offset=ct),g=g||rt<0||rt>1,a=a||rt<w,w=rt,s.push(rt),Ge});g&&e.errors.push(function k8(){return new Vt(3012,ii)}()),a&&e.errors.push(function M8(){return new Vt(3200,ii)}());const me=t.steps.length;let ve=0;o>0&&o<me?e.errors.push(function A8(){return new Vt(3202,ii)}()):0==o&&(ve=1/(me-1));const Ie=me-1,Oe=e.currentTime,Ve=e.currentAnimateTimings,We=Ve.duration;return G.forEach((Ye,Ge)=>{const ct=ve>0?Ge==Ie?1:ve*Ge:s[Ge],rt=ct*We;e.currentTime=Oe+Ve.delay+rt,Ve.duration=rt,this._validateStyleAst(Ye,e),Ye.offset=ct,i.styles.push(Ye)}),i}visitReference(t,e){return{type:8,animation:aa(this,hm(t.animation),e),options:bf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:bf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:bf(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[o,s]=function _B(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(gB,"")),n=n.replace(/@\*/g,d1).replace(/@\w+/g,e=>d1+"-"+e.substr(1)).replace(/:animating/g,px),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+o:o,sa(e.collectedStyles,e.currentQuerySelector,{});const a=aa(this,hm(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:t.selector,options:bf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function P8(){return new Vt(3013,ii)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:f1(t.timings,e.errors,!0);return{type:12,animation:aa(this,hm(t.animation),e),timings:i,options:null}}}class $B{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function b1(n){return!Array.isArray(n)&&"object"==typeof n}function bf(n){return n?(n=ug(n)).params&&(n.params=function mB(n){return n?ug(n):null}(n.params)):n={},n}function bx(n,t,e){return{duration:n,delay:t,easing:e}}function yx(n,t,e,i,r,o,s=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class y1{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const xB=new RegExp(":enter","g"),EB=new RegExp(":leave","g");function Cx(n,t,e,i,r,o={},s={},a,g,w=[]){return(new TB).buildKeyframes(n,t,e,i,r,o,s,a,g,w)}class TB{buildKeyframes(t,e,i,r,o,s,a,g,w,G=[]){w=w||new y1;const me=new xx(t,e,w,r,o,G,[]);me.options=g,me.currentTimeline.setStyles([s],null,me.errors,g),aa(this,i,me);const ve=me.timelines.filter(Ie=>Ie.containsAnimation());if(Object.keys(a).length){let Ie;for(let Oe=ve.length-1;Oe>=0;Oe--){const Ve=ve[Oe];if(Ve.element===e){Ie=Ve;break}}Ie&&!Ie.allowOnlyTimelineStyles()&&Ie.setStyles([a],null,me.errors,g)}return ve.length?ve.map(Ie=>Ie.buildKeyframes()):[yx(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?$f(i.duration):null,a=null!=i.delay?$f(i.delay):null;return 0!==s&&t.forEach(g=>{const w=e.appendInstructionToTimeline(g,s,a);o=Math.max(o,w.duration+w.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),aa(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=C1);const s=$f(o.delay);r.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>aa(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const o=t.options&&t.options.delay?$f(t.options.delay):0;t.steps.forEach(s=>{const a=e.createSubContext(t.options);o&&a.delayNextStep(o),aa(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return f1(e.params?h1(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=t.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const o=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(o):i.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(g=>{a.forwardTime((g.offset||0)*o),a.setStyles(g.styles,g.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?$f(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=C1);let s=i;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let g=null;a.forEach((w,G)=>{e.currentQueryIndex=G;const me=e.createSubContext(t.options,w);o&&me.delayNextStep(o),w===e.element&&(g=me.currentTimeline),aa(this,t.animation,me),me.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,me.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),g&&(e.currentTimeline.mergeTimelineCollectedStyles(g),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,o=t.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let g=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":g=a-g;break;case"full":g=i.currentStaggerTime}const G=e.currentTimeline;g&&G.delayNextStep(g);const me=G.currentTime;aa(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-me+(r.startTime-i.currentTimeline.startTime)}}const C1={};class xx{constructor(t,e,i,r,o,s,a,g){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=C1,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=g||new x1(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=$f(i.duration)),null!=i.delay&&(r.delay=$f(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=h1(o[a],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,o=new xx(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=C1,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},o=new SB(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,o,s){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(xB,"."+this._enterClassName)).replace(EB,"."+this._leaveClassName);let w=this._driver.query(this.element,t,1!=i);0!==i&&(w=i<0?w.slice(w.length+i,w.length):w.slice(0,i)),a.push(...w)}return!o&&0==a.length&&s.push(function F8(n){return new Vt(3014,ii)}()),a}}class x1{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new x1(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||Uc,this._currentKeyframe[e]=Uc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&(this._previousKeyframe.easing=e);const o=r&&r.params||{},s=function DB(n,t){const e={};let i;return n.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(o=>{e[o]=Uc})):td(r,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(s).forEach(a=>{const g=h1(s[a],o,i);this._pendingStyles[a]=g,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:Uc),this._updateStyle(a,g)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=t._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,g)=>{const w=td(a,!0);Object.keys(w).forEach(G=>{const me=w[G];"!"==me?t.add(G):me==Uc&&e.add(G)}),i||(w.offset=g/this.duration),r.push(w)});const o=t.size?g1(t.values()):[],s=e.size?g1(e.values()):[];if(i){const a=r[0],g=ug(a);a.offset=0,g.offset=1,r=[a,g]}return yx(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class SB extends x1{constructor(t,e,i,r,o,s,a=!1){super(t,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,g=td(t[0],!1);g.offset=0,o.push(g);const w=td(t[0],!1);w.offset=FI(a),o.push(w);const G=t.length-1;for(let me=1;me<=G;me++){let ve=td(t[me],!1);ve.offset=FI((e+ve.offset*i)/s),o.push(ve)}i=s,e=0,r="",t=o}return yx(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function FI(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class wx{}class IB extends wx{normalizePropertyName(t,e){return $x(t)}normalizeStyleValue(t,e,i,r){let o="";const s=i.toString().trim();if(kB[e]&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function x8(n,t){return new Vt(3005,ii)}())}return s+o}}const kB=(()=>function MB(n){const t={};return n.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function RI(n,t,e,i,r,o,s,a,g,w,G,me,ve){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:g,preStyleProps:w,postStyleProps:G,totalTime:me,errors:ve}}const Ex={};class NI{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function AB(n,t,e,i,r){return n.some(o=>o(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){const r=this._stateStyles["*"],o=this._stateStyles[t],s=r?r.buildStyles(e,i):{};return o?o.buildStyles(e,i):s}build(t,e,i,r,o,s,a,g,w,G){const me=[],ve=this.ast.options&&this.ast.options.params||Ex,Oe=this.buildStyles(i,a&&a.params||Ex,me),Ve=g&&g.params||Ex,We=this.buildStyles(r,Ve,me),Ye=new Set,Ge=new Map,ct=new Map,rt="void"===r,ft={params:Object.assign(Object.assign({},ve),Ve)},Lt=G?[]:Cx(t,e,this.ast.animation,o,s,Oe,We,ft,w,me);let wt=0;if(Lt.forEach(Dt=>{wt=Math.max(Dt.duration+Dt.delay,wt)}),me.length)return RI(e,this._triggerName,i,r,rt,Oe,We,[],[],Ge,ct,wt,me);Lt.forEach(Dt=>{const At=Dt.element,qt=sa(Ge,At,{});Dt.preStyleProps.forEach(Qn=>qt[Qn]=!0);const li=sa(ct,At,{});Dt.postStyleProps.forEach(Qn=>li[Qn]=!0),At!==e&&Ye.add(At)});const Ht=g1(Ye.values());return RI(e,this._triggerName,i,r,rt,Oe,We,Lt,Ht,Ge,ct,wt)}}class PB{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i={},r=ug(this.defaultParams);return Object.keys(t).forEach(o=>{const s=t[o];null!=s&&(r[o]=s)}),this.styles.styles.forEach(o=>{if("string"!=typeof o){const s=o;Object.keys(s).forEach(a=>{let g=s[a];g.length>1&&(g=h1(g,r,e));const w=this.normalizer.normalizePropertyName(a,e);g=this.normalizer.normalizeStyleValue(a,w,g,e),i[w]=g})}}),i}}class RB{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new PB(r.style,r.options&&r.options.params||{},i)}),OI(this.states,"true","1"),OI(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new NI(t,r,this.states))}),this.fallbackTransition=function NB(n,t,e){return new NI(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(s=>s.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function OI(n,t,e){n.hasOwnProperty(t)?n.hasOwnProperty(e)||(n[e]=n[t]):n.hasOwnProperty(e)&&(n[t]=n[e])}const OB=new y1;class BB{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,e){const i=[],o=vx(this._driver,e,i,[]);if(i.length)throw function U8(n){return new Vt(3503,ii)}();this._animations[t]=o}_buildPlayer(t,e,i){const r=t.element,o=pI(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],o=this._animations[t];let s;const a=new Map;if(o?(s=Cx(this._driver,e,o,gx,c1,{},{},i,OB,r),s.forEach(G=>{const me=sa(a,G.element,{});G.postStyleProps.forEach(ve=>me[ve]=null)})):(r.push(function H8(){return new Vt(3300,ii)}()),s=[]),r.length)throw function V8(n){return new Vt(3504,ii)}();a.forEach((G,me)=>{Object.keys(G).forEach(ve=>{G[ve]=this._driver.computeStyle(me,ve,Uc)})});const w=ed(s.map(G=>{const me=a.get(G.element);return this._buildPlayer(G,{},me)}));return this._playersById[t]=w,w.onDestroy(()=>this.destroy(t)),this.players.push(w),w}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function j8(n){return new Vt(3301,ii)}();return e}listen(t,e,i,r){const o=ux(e,"","","");return lx(this._getPlayer(t),i,o,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const o=this._getPlayer(t);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const BI="ng-animate-queued",Tx="ng-animate-disabled",VB=[],LI={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},jB={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Oa="__ng_removed";class Sx{constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function ZB(n){return null!=n?n:null}(i?t.value:t),i){const o=ug(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const gm="void",Dx=new Sx(gm);class GB{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Ba(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function G8(n,t){return new Vt(3302,ii)}();if(null==i||0==i.length)throw function q8(n){return new Vt(3303,ii)}();if(!function YB(n){return"start"==n||"done"==n}(i))throw function W8(n,t){return new Vt(3400,ii)}();const o=sa(this._elementListeners,t,[]),s={name:e,phase:i,callback:r};o.push(s);const a=sa(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(Ba(t,u1),Ba(t,u1+"-"+e),a[e]=Dx),()=>{this._engine.afterFlush(()=>{const g=o.indexOf(s);g>=0&&o.splice(g,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function Z8(n){return new Vt(3401,ii)}();return e}trigger(t,e,i,r=!0){const o=this._getTrigger(e),s=new Ix(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(Ba(t,u1),Ba(t,u1+"-"+e),this._engine.statesByElement.set(t,a={}));let g=a[e];const w=new Sx(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&g&&w.absorbOptions(g.options),a[e]=w,g||(g=Dx),w.value!==gm&&g.value===w.value){if(!function QB(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!t.hasOwnProperty(o)||n[o]!==t[o])return!1}return!0}(g.params,w.params)){const Ve=[],We=o.matchStyles(g.value,g.params,Ve),Ye=o.matchStyles(w.value,w.params,Ve);Ve.length?this._engine.reportError(Ve):this._engine.afterFlush(()=>{vf(t,We),rc(t,Ye)})}return}const ve=sa(this._engine.playersByElement,t,[]);ve.forEach(Ve=>{Ve.namespaceId==this.id&&Ve.triggerName==e&&Ve.queued&&Ve.destroy()});let Ie=o.matchTransition(g.value,w.value,t,w.params),Oe=!1;if(!Ie){if(!r)return;Ie=o.fallbackTransition,Oe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:Ie,fromState:g,toState:w,player:s,isFallbackTransition:Oe}),Oe||(Ba(t,BI),s.onStart(()=>{dg(t,BI)})),s.onDone(()=>{let Ve=this.players.indexOf(s);Ve>=0&&this.players.splice(Ve,1);const We=this._engine.playersByElement.get(t);if(We){let Ye=We.indexOf(s);Ye>=0&&We.splice(Ye,1)}}),this.players.push(s),ve.push(s),s}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,i)=>{delete e[t]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,d1,!0);i.forEach(r=>{if(r[Oa])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const o=this._engine.statesByElement.get(t),s=new Map;if(o){const a=[];if(Object.keys(o).forEach(g=>{if(s.set(g,o[g].value),this._triggers[g]){const w=this.trigger(t,g,gm,r);w&&a.push(w)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,s),i&&ed(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const g=this._triggers[s].fallbackTransition,w=i[s]||Dx,G=new Sx(gm),me=new Ix(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:g,fromState:w,toState:G,player:me,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let s=t;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const o=t[Oa];(!o||o===LI)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){Ba(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const g=ux(o,i.triggerName,i.fromState.value,i.toState.value);g._data=t,lx(i.player,a.phase,g,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class qB{constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new GB(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement,o=i.length-1;if(o>=0){let s=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(e);for(;a;){const g=r.get(a);if(g){const w=i.indexOf(g);i.splice(w+1,0,t),s=!0;break}a=this.driver.getParentElement(a)}}else for(let a=o;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,e)){i.splice(a+1,0,t),s=!0;break}s||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let o=0;o<r.length;o++){const s=i[r[o]].namespaceId;if(s){const a=this._fetchNamespace(s);a&&e.add(a)}}}return e}trigger(t,e,i,r){if(w1(e)){const o=this._fetchNamespace(t);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!w1(e))return;const o=e[Oa];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ba(t,Tx)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),dg(t,Tx))}removeNode(t,e,i,r){if(w1(e)){const o=t?this._fetchNamespace(t):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==t&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,o){this.collectedLeaveElements.push(e),e[Oa]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,i,r,o){return w1(e)?this._fetchNamespace(t).listen(e,i,r,o):()=>{}}_buildInstruction(t,e,i,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,d1,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,px,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ed(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const i=t[Oa];if(i&&i.setForRemoval){if(t[Oa]=LI,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(Tx))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ba(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?ed(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function Y8(n){return new Vt(3402,ii)}()}_flushAnimations(t,e){const i=new y1,r=[],o=new Map,s=[],a=new Map,g=new Map,w=new Map,G=new Set;this.disabledNodes.forEach(Pt=>{G.add(Pt);const Wt=this.driver.query(Pt,".ng-animate-queued",!0);for(let tn=0;tn<Wt.length;tn++)G.add(Wt[tn])});const me=this.bodyNode,ve=Array.from(this.statesByElement.keys()),Ie=HI(ve,this.collectedEnterElements),Oe=new Map;let Ve=0;Ie.forEach((Pt,Wt)=>{const tn=gx+Ve++;Oe.set(Wt,tn),Pt.forEach(un=>Ba(un,tn))});const We=[],Ye=new Set,Ge=new Set;for(let Pt=0;Pt<this.collectedLeaveElements.length;Pt++){const Wt=this.collectedLeaveElements[Pt],tn=Wt[Oa];tn&&tn.setForRemoval&&(We.push(Wt),Ye.add(Wt),tn.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(un=>Ye.add(un)):Ge.add(Wt))}const ct=new Map,rt=HI(ve,Array.from(Ye));rt.forEach((Pt,Wt)=>{const tn=c1+Ve++;ct.set(Wt,tn),Pt.forEach(un=>Ba(un,tn))}),t.push(()=>{Ie.forEach((Pt,Wt)=>{const tn=Oe.get(Wt);Pt.forEach(un=>dg(un,tn))}),rt.forEach((Pt,Wt)=>{const tn=ct.get(Wt);Pt.forEach(un=>dg(un,tn))}),We.forEach(Pt=>{this.processLeaveNode(Pt)})});const ft=[],Lt=[];for(let Pt=this._namespaceList.length-1;Pt>=0;Pt--)this._namespaceList[Pt].drainQueuedTransitions(e).forEach(tn=>{const un=tn.player,Wn=tn.element;if(ft.push(un),this.collectedEnterElements.length){const to=Wn[Oa];if(to&&to.setForMove){if(to.previousTriggersValues&&to.previousTriggersValues.has(tn.triggerName)){const wl=to.previousTriggersValues.get(tn.triggerName),El=this.statesByElement.get(tn.element);El&&El[tn.triggerName]&&(El[tn.triggerName].value=wl)}return void un.destroy()}}const mi=!me||!this.driver.containsElement(me,Wn),Mi=ct.get(Wn),sr=Oe.get(Wn),$i=this._buildInstruction(tn,i,sr,Mi,mi);if($i.errors&&$i.errors.length)return void Lt.push($i);if(mi)return un.onStart(()=>vf(Wn,$i.fromStyles)),un.onDestroy(()=>rc(Wn,$i.toStyles)),void r.push(un);if(tn.isFallbackTransition)return un.onStart(()=>vf(Wn,$i.fromStyles)),un.onDestroy(()=>rc(Wn,$i.toStyles)),void r.push(un);const Mt=[];$i.timelines.forEach(to=>{to.stretchStartingKeyframe=!0,this.disabledNodes.has(to.element)||Mt.push(to)}),$i.timelines=Mt,i.append(Wn,$i.timelines),s.push({instruction:$i,player:un,element:Wn}),$i.queriedElements.forEach(to=>sa(a,to,[]).push(un)),$i.preStyleProps.forEach((to,wl)=>{const El=Object.keys(to);if(El.length){let mc=g.get(wl);mc||g.set(wl,mc=new Set),El.forEach(Yw=>mc.add(Yw))}}),$i.postStyleProps.forEach((to,wl)=>{const El=Object.keys(to);let mc=w.get(wl);mc||w.set(wl,mc=new Set),El.forEach(Yw=>mc.add(Yw))})});if(Lt.length){const Pt=[];Lt.forEach(Wt=>{Pt.push(function K8(n,t){return new Vt(3505,ii)}())}),ft.forEach(Wt=>Wt.destroy()),this.reportError(Pt)}const wt=new Map,Ht=new Map;s.forEach(Pt=>{const Wt=Pt.element;i.has(Wt)&&(Ht.set(Wt,Wt),this._beforeAnimationBuild(Pt.player.namespaceId,Pt.instruction,wt))}),r.forEach(Pt=>{const Wt=Pt.element;this._getPreviousPlayers(Wt,!1,Pt.namespaceId,Pt.triggerName,null).forEach(un=>{sa(wt,Wt,[]).push(un),un.destroy()})});const Dt=We.filter(Pt=>jI(Pt,g,w)),At=new Map;UI(At,this.driver,Ge,w,Uc).forEach(Pt=>{jI(Pt,g,w)&&Dt.push(Pt)});const li=new Map;Ie.forEach((Pt,Wt)=>{UI(li,this.driver,new Set(Pt),g,"!")}),Dt.forEach(Pt=>{const Wt=At.get(Pt),tn=li.get(Pt);At.set(Pt,Object.assign(Object.assign({},Wt),tn))});const Qn=[],gi=[],Ri={};s.forEach(Pt=>{const{element:Wt,player:tn,instruction:un}=Pt;if(i.has(Wt)){if(G.has(Wt))return tn.onDestroy(()=>rc(Wt,un.toStyles)),tn.disabled=!0,tn.overrideTotalTime(un.totalTime),void r.push(tn);let Wn=Ri;if(Ht.size>1){let Mi=Wt;const sr=[];for(;Mi=Mi.parentNode;){const $i=Ht.get(Mi);if($i){Wn=$i;break}sr.push(Mi)}sr.forEach($i=>Ht.set($i,Wn))}const mi=this._buildAnimation(tn.namespaceId,un,wt,o,li,At);if(tn.setRealPlayer(mi),Wn===Ri)Qn.push(tn);else{const Mi=this.playersByElement.get(Wn);Mi&&Mi.length&&(tn.parentPlayer=ed(Mi)),r.push(tn)}}else vf(Wt,un.fromStyles),tn.onDestroy(()=>rc(Wt,un.toStyles)),gi.push(tn),G.has(Wt)&&r.push(tn)}),gi.forEach(Pt=>{const Wt=o.get(Pt.element);if(Wt&&Wt.length){const tn=ed(Wt);Pt.setRealPlayer(tn)}}),r.forEach(Pt=>{Pt.parentPlayer?Pt.syncPlayerEvents(Pt.parentPlayer):Pt.destroy()});for(let Pt=0;Pt<We.length;Pt++){const Wt=We[Pt],tn=Wt[Oa];if(dg(Wt,c1),tn&&tn.hasAnimation)continue;let un=[];if(a.size){let mi=a.get(Wt);mi&&mi.length&&un.push(...mi);let Mi=this.driver.query(Wt,px,!0);for(let sr=0;sr<Mi.length;sr++){let $i=a.get(Mi[sr]);$i&&$i.length&&un.push(...$i)}}const Wn=un.filter(mi=>!mi.destroyed);Wn.length?KB(this,Wt,Wn):this.processLeaveNode(Wt)}return We.length=0,Qn.forEach(Pt=>{this.players.push(Pt),Pt.onDone(()=>{Pt.destroy();const Wt=this.players.indexOf(Pt);this.players.splice(Wt,1)}),Pt.play()}),Qn}elementContainsData(t,e){let i=!1;const r=e[Oa];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(s=a)}else{const a=this.playersByElement.get(t);if(a){const g=!o||o==gm;a.forEach(w=>{w.queued||!g&&w.triggerName!=r||s.push(w)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(t,e,i){const o=e.element,s=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const g of e.timelines){const w=g.element,G=w!==o,me=sa(i,w,[]);this._getPreviousPlayers(w,G,s,a,e.toState).forEach(Ie=>{const Oe=Ie.getRealPlayer();Oe.beforeDestroy&&Oe.beforeDestroy(),Ie.destroy(),me.push(Ie)})}vf(o,e.fromStyles)}_buildAnimation(t,e,i,r,o,s){const a=e.triggerName,g=e.element,w=[],G=new Set,me=new Set,ve=e.timelines.map(Oe=>{const Ve=Oe.element;G.add(Ve);const We=Ve[Oa];if(We&&We.removedBeforeQueried)return new fm(Oe.duration,Oe.delay);const Ye=Ve!==g,Ge=function XB(n){const t=[];return VI(n,t),t}((i.get(Ve)||VB).map(wt=>wt.getRealPlayer())).filter(wt=>!!wt.element&&wt.element===Ve),ct=o.get(Ve),rt=s.get(Ve),ft=pI(0,this._normalizer,0,Oe.keyframes,ct,rt),Lt=this._buildPlayer(Oe,ft,Ge);if(Oe.subTimeline&&r&&me.add(Ve),Ye){const wt=new Ix(t,a,Ve);wt.setRealPlayer(Lt),w.push(wt)}return Lt});w.forEach(Oe=>{sa(this.playersByQueriedElement,Oe.element,[]).push(Oe),Oe.onDone(()=>function WB(n,t,e){let i;if(n instanceof Map){if(i=n.get(t),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}}else if(i=n[t],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete n[t]}return i}(this.playersByQueriedElement,Oe.element,Oe))}),G.forEach(Oe=>Ba(Oe,EI));const Ie=ed(ve);return Ie.onDestroy(()=>{G.forEach(Oe=>dg(Oe,EI)),rc(g,e.toStyles)}),me.forEach(Oe=>{sa(r,Oe,[]).push(Ie)}),Ie}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new fm(t.duration,t.delay)}}class Ix{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new fm,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>lx(t,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){sa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function w1(n){return n&&1===n.nodeType}function zI(n,t){const e=n.style.display;return n.style.display=null!=t?t:"none",e}function UI(n,t,e,i,r){const o=[];e.forEach(g=>o.push(zI(g)));const s=[];i.forEach((g,w)=>{const G={};g.forEach(me=>{const ve=G[me]=t.computeStyle(w,me,r);(!ve||0==ve.length)&&(w[Oa]=jB,s.push(w))}),n.set(w,G)});let a=0;return e.forEach(g=>zI(g,o[a++])),s}function HI(n,t){const e=new Map;if(n.forEach(a=>e.set(a,[])),0==t.length)return e;const r=new Set(t),o=new Map;function s(a){if(!a)return 1;let g=o.get(a);if(g)return g;const w=a.parentNode;return g=e.has(w)?w:r.has(w)?1:s(w),o.set(a,g),g}return t.forEach(a=>{const g=s(a);1!==g&&e.get(g).push(a)}),e}function Ba(n,t){var e;null===(e=n.classList)||void 0===e||e.add(t)}function dg(n,t){var e;null===(e=n.classList)||void 0===e||e.remove(t)}function KB(n,t,e){ed(e).onDone(()=>n.processLeaveNode(t))}function VI(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof hI?VI(i.players,t):t.push(i)}}function jI(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(o=>r.add(o)):t.set(n,i),e.delete(n),!0}class E1{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new qB(t,e,i),this._timelineEngine=new BB(t,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,i,r,o){const s=t+"-"+r;let a=this._triggerCache[s];if(!a){const g=[],G=vx(this._driver,o,g,[]);if(g.length)throw function L8(n,t){return new Vt(3404,ii)}();a=function FB(n,t,e){return new RB(n,t,e)}(r,G,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[o,s]=_I(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=_I(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(t,e,i,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let eL=(()=>{class n{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=n.initialStylesByElement.get(e);o||n.initialStylesByElement.set(e,o={}),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&rc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(rc(this._element,this._initialStyles),this._endStyles&&(rc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(vf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(vf(this._element,this._endStyles),this._endStyles=null),rc(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function kx(n){let t=null;const e=Object.keys(n);for(let i=0;i<e.length;i++){const r=e[i];tL(r)&&(t=t||{},t[r]=n[r])}return t}function tL(n){return"display"===n||"position"===n}class GI{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,i){return t.animate(e,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(t[i]=this._finished?e[i]:kI(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class nL{validateStyleProperty(t){return bI(t)}matchesElement(t,e){return!1}containsElement(t,e){return yI(t,e)}getParentElement(t){return fx(t)}query(t,e,i){return CI(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,o,s=[]){const g={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(g.easing=o);const w={},G=s.filter(ve=>ve instanceof GI);(function sB(n,t){return 0===n||0===t})(i,r)&&G.forEach(ve=>{let Ie=ve.currentSnapshot;Object.keys(Ie).forEach(Oe=>w[Oe]=Ie[Oe])}),e=function aB(n,t,e){const i=Object.keys(e);if(i.length&&t.length){let o=t[0],s=[];if(i.forEach(a=>{o.hasOwnProperty(a)||s.push(a),o[a]=e[a]}),s.length)for(var r=1;r<t.length;r++){let a=t[r];s.forEach(function(g){a[g]=kI(n,g)})}}return t}(t,e=e.map(ve=>td(ve,!1)),w);const me=function JB(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=kx(t[0]),t.length>1&&(i=kx(t[t.length-1]))):t&&(e=kx(t)),e||i?new eL(n,e,i):null}(t,e);return new GI(t,e,g,me)}}let iL=(()=>{class n extends uI{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Cs.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?dI(e):e;return qI(this._renderer,null,i,"register",[r]),new rL(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(In(K_),In(fs))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class rL extends class m8{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new oL(this._id,t,e||{},this._renderer)}}class oL{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return qI(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function qI(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const WI="@.disabled";let sL=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=null==s?void 0:s.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let G=this._rendererCache.get(o);return G||(G=new ZI("",o,this.engine),this._rendererCache.set(o,G)),G}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const g=G=>{Array.isArray(G)?G.forEach(g):this.engine.registerTrigger(s,a,e,G.name,G)};return i.data.animation.forEach(g),new aL(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(In(K_),In(E1),In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class ZI{constructor(t,e,i){this.namespaceId=t,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==WI?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class aL extends ZI{constructor(t,e,i,r){super(e,i,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==WI?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.substr(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function lL(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let o=e.substr(1),s="";return"@"!=o.charAt(0)&&([o,s]=function cL(n){const t=n.indexOf(".");return[n.substring(0,t),n.substr(t+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,e,i)}}let uL=(()=>{class n extends E1{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(In(fs),In(hx),In(wx))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const YI=new Jn("AnimationModuleType"),KI=[{provide:uI,useClass:iL},{provide:wx,useFactory:function dL(){return new IB}},{provide:E1,useClass:uL},{provide:K_,useFactory:function fL(n,t,e){return new sL(n,t,e)},deps:[Kv,E1,An]}],XI=[{provide:hx,useFactory:()=>new nL},{provide:YI,useValue:"BrowserAnimations"},...KI],hL=[{provide:hx,useClass:xI},{provide:YI,useValue:"NoopAnimations"},...KI];let gL=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?hL:XI}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({providers:XI,imports:[aD]}),n})();function QI(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var e=0,i=n.length;e<i;e++)if(n[e]===t)return e;return-1}function yf(n,t){for(var e=n.length-1;e>=0;e--)!0===t(n[e])&&n.splice(e,1)}function JI(n){throw new Error("Unhandled case for value: '".concat(n,"'"))}var e,Mx=function(){function n(t){void 0===t&&(t={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=t.tagName||"",this.attrs=t.attrs||{},this.innerHTML=t.innerHtml||t.innerHTML||""}return n.prototype.setTagName=function(t){return this.tagName=t,this},n.prototype.getTagName=function(){return this.tagName||""},n.prototype.setAttr=function(t,e){return this.getAttrs()[t]=e,this},n.prototype.getAttr=function(t){return this.getAttrs()[t]},n.prototype.setAttrs=function(t){return Object.assign(this.getAttrs(),t),this},n.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},n.prototype.setClass=function(t){return this.setAttr("class",t)},n.prototype.addClass=function(t){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=t.split(i);s=o.shift();)-1===QI(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},n.prototype.removeClass=function(t){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=t.split(i);r.length&&(s=o.shift());){var a=QI(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},n.prototype.getClass=function(){return this.getAttrs().class||""},n.prototype.hasClass=function(t){return-1!==(" "+this.getClass()+" ").indexOf(" "+t+" ")},n.prototype.setInnerHTML=function(t){return this.innerHTML=t,this},n.prototype.setInnerHtml=function(t){return this.setInnerHTML(t)},n.prototype.getInnerHTML=function(){return this.innerHTML||""},n.prototype.getInnerHtml=function(){return this.getInnerHTML()},n.prototype.toAnchorString=function(){var t=this.getTagName(),e=this.buildAttrsStr();return["<",t,e=e?" "+e:"",">",this.getInnerHtml(),"</",t,">"].join("")},n.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var t=this.getAttrs(),e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+'="'+t[i]+'"');return e.join(" ")},n}(),ek=function(){function n(t){void 0===t&&(t={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=t.newWindow||!1,this.truncate=t.truncate||{},this.className=t.className||""}return n.prototype.build=function(t){return new Mx({tagName:"a",attrs:this.createAttrs(t),innerHtml:this.processAnchorText(t.getAnchorText())})},n.prototype.createAttrs=function(t){var e={href:t.getAnchorHref()},i=this.createCssClass(t);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<t.getAnchorText().length&&(e.title=t.getAnchorHref()),e},n.prototype.createCssClass=function(t){var e=this.className;if(e){for(var i=[e],r=t.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},n.prototype.processAnchorText=function(t){return this.doTruncate(t)},n.prototype.doTruncate=function(t){var e=this.truncate;if(!e||!e.length)return t;var i=e.length,r=e.location;return"smart"===r?function $L(n,t,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function(Ge){var ct="";return Ge.scheme&&Ge.host&&(ct+=Ge.scheme+"://"),Ge.host&&(ct+=Ge.host),Ge.path&&(ct+="/"+Ge.path),Ge.query&&(ct+="?"+Ge.query),Ge.fragment&&(ct+="#"+Ge.fragment),ct},a=function(Ge,ct){var rt=ct/2,ft=Math.ceil(rt),Lt=-1*Math.floor(rt),wt="";return Lt<0&&(wt=Ge.substr(Lt)),Ge.substr(0,ft)+e+wt};if(n.length<=t)return n;var ct,rt,ft,g=t-r,w=(ct={},(ft=(rt=n).match(/^([a-z]+):\/\//i))&&(ct.scheme=ft[1],rt=rt.substr(ft[0].length)),(ft=rt.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(ct.host=ft[1],rt=rt.substr(ft[0].length)),(ft=rt.match(/^\/(.*?)(?=(\?|#|$))/i))&&(ct.path=ft[1],rt=rt.substr(ft[0].length)),(ft=rt.match(/^\?(.*?)(?=(#|$))/i))&&(ct.query=ft[1],rt=rt.substr(ft[0].length)),(ft=rt.match(/^#(.*?)$/i))&&(ct.fragment=ft[1]),ct);if(w.query){var G=w.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);G&&(w.query=w.query.substr(0,G[1].length),n=s(w))}if(n.length<=t||(w.host&&(w.host=w.host.replace(/^www\./,""),n=s(w)),n.length<=t))return n;var me="";if(w.host&&(me+=w.host),me.length>=g)return w.host.length==t?(w.host.substr(0,t-r)+e).substr(0,g+i):a(me,g).substr(0,g+i);var ve="";if(w.path&&(ve+="/"+w.path),w.query&&(ve+="?"+w.query),ve){if((me+ve).length>=g)return(me+ve).length==t?(me+ve).substr(0,t):(me+a(ve,g-me.length)).substr(0,g+i);me+=ve}if(w.fragment){var Oe="#"+w.fragment;if((me+Oe).length>=g)return(me+Oe).length==t?(me+Oe).substr(0,t):(me+a(Oe,g-me.length)).substr(0,g+i);me+=Oe}if(w.scheme&&w.host){var We=w.scheme+"://";if((me+We).length<g)return(We+me).substr(0,t)}if(me.length<=t)return me;var Ye="";return g>0&&(Ye=me.substr(-1*Math.floor(g/2))),(me.substr(0,Math.ceil(g/2))+e+Ye).substr(0,g+i)}(t,i):"middle"===r?function vL(n,t,e){if(n.length<=t)return n;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=t-r,s="";return o>0&&(s=n.substr(-1*Math.floor(o/2))),(n.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(t,i):function bL(n,t,e){return function _L(n,t,e){var i;return n.length>t&&(null==e?(e="&hellip;",i=3):i=e.length,n=n.substring(0,t-i)+e),n}(n,t,e)}(t,i)},n}(),fg=function(){function n(t){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=t.tagBuilder,this.matchedText=t.matchedText,this.offset=t.offset}return n.prototype.getMatchedText=function(){return this.matchedText},n.prototype.setOffset=function(t){this.offset=t},n.prototype.getOffset=function(){return this.offset},n.prototype.getCssClassSuffixes=function(){return[this.getType()]},n.prototype.buildTag=function(){return this.tagBuilder.build(this)},n}(),tk=function(n){function t(e){var i=n.call(this,e)||this;return i.email="",i.email=e.email,i}return Ae(t,n),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(fg),nk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Ae(t,n),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(fg),ik=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var e=n.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},t}(fg),rk=function(n){function t(e){var i=n.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Ae(t,n),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(fg),ok=function(n){function t(e){var i=n.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ae(t,n),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch(r){return i}},t}(fg),hg=function n(t){this.__jsduckDummyDocProp=null,this.tagBuilder=t.tagBuilder},Ax=/[A-Za-z]/,yL=/[\d]/,CL=/[\D]/,Cf=/\s/,Px=/['"]/,xL=/[\x00-\x1F\x7F]/,sk=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,ak=sk+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,S1=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,TL=ak+S1,Qi=ak+S1,SL="(?:["+S1+"]{1,3}\\.){3}["+S1+"]{1,3}",DL="["+Qi+"](?:["+Qi+"\\-]{0,61}["+Qi+"])?",lk=function(n){return"(?=("+DL+"))\\"+n},Fx=function(n){return"(?:"+lk(n)+"(?:\\."+lk(n+1)+"){0,126}|"+SL+")"},D1=(new RegExp("["+Qi+".\\-]*["+Qi+"\\-]"),new RegExp("[".concat(Qi,"]"))),ck=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,IL=new RegExp("[".concat(Qi,"!#$%&'*+/=?^_`{|}~-]")),kL=new RegExp("^".concat(ck.source,"$")),uk=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.localPartCharRegex=IL,e.strictTldRegex=kL,e}return Ae(t,n),t.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,g=new I1,w={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},G=0,me=0,ve=g;G<a;){var Ie=e.charAt(G);switch(me){case 0:"m"===(Dt=Ie)?Lt(1):r.test(Dt)&&Lt();break;case 1:Ve(e.charAt(G-1),Ie);break;case 2:We(Ie);break;case 3:Ye(Ie);break;case 4:Ge(Ie);break;case 5:ct(Ie);break;case 6:rt(Ie);break;case 7:ft(Ie);break;default:JI(me)}G++}var Dt;return Ht(),s;function Ve(Dt,At){":"===Dt?r.test(At)?(me=2,ve=new I1(fe(fe({},ve),{hasMailtoPrefix:!0}))):wt():w[Dt]===At||(r.test(At)?me=2:"."===At?me=3:"@"===At?me=4:wt())}function We(Dt){"."===Dt?me=3:"@"===Dt?me=4:r.test(Dt)||wt()}function Ye(Dt){"."===Dt||"@"===Dt?wt():r.test(Dt)?me=2:wt()}function Ge(Dt){D1.test(Dt)?me=5:wt()}function ct(Dt){"."===Dt?me=7:"-"===Dt?me=6:D1.test(Dt)||Ht()}function rt(Dt){"-"===Dt||"."===Dt?Ht():D1.test(Dt)?me=5:Ht()}function ft(Dt){"."===Dt||"-"===Dt?Ht():D1.test(Dt)?(me=5,ve=new I1(fe(fe({},ve),{hasDomainDot:!0}))):Ht()}function Lt(Dt){void 0===Dt&&(Dt=2),me=Dt,ve=new I1({idx:G})}function wt(){me=0,ve=g}function Ht(){if(ve.hasDomainDot){var Dt=e.slice(ve.idx,G);/[-.]$/.test(Dt)&&(Dt=Dt.slice(0,-1));var At=ve.hasMailtoPrefix?Dt.slice(7):Dt;(function qt(li){var gi=(li.split(".").pop()||"").toLowerCase();return o.test(gi)})(At)&&s.push(new tk({tagBuilder:i,matchedText:Dt,offset:ve.idx,email:At}))}wt()}},t}(hg),I1=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.hasMailtoPrefix=!!t.hasMailtoPrefix,this.hasDomainDot=!!t.hasDomainDot},ML=function(){function n(){}return n.isValid=function(t,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(t,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(t,e)&&!this.isValidIpAddress(t)||this.containsMultipleDots(t))},n.isValidIpAddress=function(t){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==t.match(e)},n.containsMultipleDots=function(t){var e=t;return this.hasFullProtocolRegex.test(t)&&(e=t.split("://")[1]),e.split("/")[0].indexOf("..")>-1},n.isValidUriScheme=function(t){var e=t.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},n.urlMatchDoesNotHaveProtocolOrDot=function(t,e){return!(!t||e&&this.hasFullProtocolRegex.test(e)||-1!==t.indexOf("."))},n.urlMatchDoesNotHaveAtLeastOneWordChar=function(t,e){return!(!t||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(t))},n.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,n.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,n.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+sk+"]"),n.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,n}(),AL=(e=new RegExp("[/?#](?:["+Qi+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Qi+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,Fx(2),")","|","(","(//)?",/(?:www\.)/.source,Fx(6),")","|","(","(//)?",Fx(10)+"\\.",ck.source,"(?![-"+TL+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),PL=new RegExp("["+Qi+"]"),dk=function(n){function t(e){var i=n.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=AL,i.wordCharRegExp=PL,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ae(t,n),t.prototype.parseMatches=function(e){for(var w,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,g=[],G=function(){var ve=w[0],Ie=w[1],Oe=w[4],Ye=w.index,Ge=w[5]||w[9],ct=e.charAt(Ye-1);if(!ML.isValid(ve,Ie)||Ye>0&&"@"===ct||Ye>0&&Ge&&me.wordCharRegExp.test(ct))return"continue";if(/\?$/.test(ve)&&(ve=ve.substr(0,ve.length-1)),me.matchHasUnbalancedClosingParen(ve))ve=ve.substr(0,ve.length-1);else{var rt=me.matchHasInvalidCharAfterTld(ve,Ie);rt>-1&&(ve=ve.substr(0,rt))}var ft=["http://","https://"].find(function(Dt){return!!Ie&&-1!==Ie.indexOf(Dt)});if(ft){var Lt=ve.indexOf(ft);ve=ve.substr(Lt),Ie=Ie.substr(Lt),Ye+=Lt}g.push(new ok({tagBuilder:a,matchedText:ve,offset:Ye,urlMatchType:Ie?"scheme":Oe?"www":"tld",url:ve,protocolUrlMatch:!!Ie,protocolRelativeMatch:!!Ge,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},me=this;null!==(w=i.exec(e));)G();return g},t.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var g=e.charAt(s);g===r?o++:g===i&&(o=Math.max(o-1,0))}return 0===o},t.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Qi+"]*[-"+Qi+"]\\.[-"+Qi+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},t}(hg),FL=new RegExp("#[_".concat(Qi,"]{1,139}(?![_").concat(Qi,"])"),"g"),RL=new RegExp("[^"+Qi+"]"),fk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegex=FL,i.nonWordCharRegex=RL,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.parseMatches=function(e){for(var g,i=this.matcherRegex,r=this.nonWordCharRegex,o=this.serviceName,s=this.tagBuilder,a=[];null!==(g=i.exec(e));){var w=g.index,G=e.charAt(w-1);if(0===w||r.test(G)){var me=g[0],ve=g[0].slice(1);a.push(new nk({tagBuilder:s,matchedText:me,offset:w,serviceName:o,hashtag:ve}))}}return a},t}(hg),BL=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),hk=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.matcherRegex=BL,e}return Ae(t,n),t.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],g=a.replace(/[^0-9,;#]/g,""),w=!(!s[1]&&!s[2]),G=0==s.index?"":e.substr(s.index-1,1),me=e.substr(s.index+a.length,1),ve=!G.match(/\d/)&&!me.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&ve&&o.push(new rk({tagBuilder:r,matchedText:a,offset:s.index,number:g,plusSign:w}))}return o},t.prototype.testMatch=function(e){return CL.test(e)},t}(hg),LL=new RegExp("@[_".concat(Qi,"]{1,50}(?![_").concat(Qi,"])"),"g"),zL=new RegExp("@[_.".concat(Qi,"]{1,30}(?![_").concat(Qi,"])"),"g"),UL=new RegExp("@[-_.".concat(Qi,"]{1,50}(?![-_").concat(Qi,"])"),"g"),HL=new RegExp("@[_.".concat(Qi,"]{1,23}[_").concat(Qi,"](?![_").concat(Qi,"])"),"g"),VL=new RegExp("[^"+Qi+"]"),gk=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:LL,instagram:zL,soundcloud:UL,tiktok:HL},i.nonWordCharRegex=VL,i.serviceName=e.serviceName,i}return Ae(t,n),t.prototype.parseMatches=function(e){var g,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(g=r.exec(e));){var w=g.index,G=e.charAt(w-1);if(0===w||o.test(G)){var me=g[0].replace(/\.+$/g,""),ve=me.slice(1);a.push(new ik({tagBuilder:s,matchedText:me,offset:w,serviceName:i,mention:ve}))}}return a},t}(hg);var oc=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.type=t.type||"tag",this.name=t.name||"",this.isOpening=!!t.isOpening,this.isClosing=!!t.isClosing},GL=function(){function n(t){void 0===t&&(t={}),this.version=n.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===["twitter","facebook","instagram","tiktok"].indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return n.link=function(t,e){return new n(e).link(t)},n.parse=function(t,e){return new n(e).parse(t)},n.prototype.normalizeUrlsCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{schemeMatches:t,wwwMatches:t,tldMatches:t}:{schemeMatches:"boolean"!=typeof t.schemeMatches||t.schemeMatches,wwwMatches:"boolean"!=typeof t.wwwMatches||t.wwwMatches,tldMatches:"boolean"!=typeof t.tldMatches||t.tldMatches}},n.prototype.normalizeStripPrefixCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{scheme:t,www:t}:{scheme:"boolean"!=typeof t.scheme||t.scheme,www:"boolean"!=typeof t.www||t.www}},n.prototype.normalizeTruncateCfg=function(t){return"number"==typeof t?{length:t,location:"end"}:function pL(n,t){for(var e in t)t.hasOwnProperty(e)&&void 0===n[e]&&(n[e]=t[e]);return n}(t||{},{length:Number.POSITIVE_INFINITY,location:"end"})},n.prototype.parse=function(t){var e=this,i=["a","style","script"],r=0,o=[];return function jL(n,t){for(var e=t.onOpenTag,i=t.onCloseTag,r=t.onText,o=t.onComment,s=t.onDoctype,a=new oc,g=0,w=n.length,G=0,me=0,ve=a;g<w;){var Ie=n.charAt(g);switch(G){case 0:"<"===Ie&&Wn();break;case 1:"!"===(Mt=Ie)?G=13:"/"===Mt?(G=2,ve=new oc(fe(fe({},ve),{isClosing:!0}))):"<"===Mt?Wn():Ax.test(Mt)?(G=3,ve=new oc(fe(fe({},ve),{isOpening:!0}))):(G=0,ve=a);break;case 2:Ye(Ie);break;case 3:We(Ie);break;case 4:Ge(Ie);break;case 5:ct(Ie);break;case 6:rt(Ie);break;case 7:ft(Ie);break;case 8:Lt(Ie);break;case 9:wt(Ie);break;case 10:Ht(Ie);break;case 11:Dt(Ie);break;case 12:At(Ie);break;case 13:"--"===n.substr(g,2)?(g+=2,ve=new oc(fe(fe({},ve),{type:"comment"})),G=14):"DOCTYPE"===n.substr(g,7).toUpperCase()?(g+=7,ve=new oc(fe(fe({},ve),{type:"doctype"})),G=20):un();break;case 14:li(Ie);break;case 15:Qn(Ie);break;case 16:gi(Ie);break;case 17:Ri(Ie);break;case 18:Pt(Ie);break;case 19:Wt(Ie);break;case 20:tn(Ie);break;default:JI(G)}g++}var Mt;function We(Mt){Cf.test(Mt)?(ve=new oc(fe(fe({},ve),{name:sr()})),G=4):"<"===Mt?Wn():"/"===Mt?(ve=new oc(fe(fe({},ve),{name:sr()})),G=12):">"===Mt?(ve=new oc(fe(fe({},ve),{name:sr()})),mi()):!Ax.test(Mt)&&!yL.test(Mt)&&":"!==Mt&&un()}function Ye(Mt){">"===Mt?un():Ax.test(Mt)?G=3:un()}function Ge(Mt){Cf.test(Mt)||("/"===Mt?G=12:">"===Mt?mi():"<"===Mt?Wn():"="===Mt||Px.test(Mt)||xL.test(Mt)?un():G=5)}function ct(Mt){Cf.test(Mt)?G=6:"/"===Mt?G=12:"="===Mt?G=7:">"===Mt?mi():"<"===Mt?Wn():Px.test(Mt)&&un()}function rt(Mt){Cf.test(Mt)||("/"===Mt?G=12:"="===Mt?G=7:">"===Mt?mi():"<"===Mt?Wn():Px.test(Mt)?un():G=5)}function ft(Mt){Cf.test(Mt)||('"'===Mt?G=8:"'"===Mt?G=9:/[>=`]/.test(Mt)?un():"<"===Mt?Wn():G=10)}function Lt(Mt){'"'===Mt&&(G=11)}function wt(Mt){"'"===Mt&&(G=11)}function Ht(Mt){Cf.test(Mt)?G=4:">"===Mt?mi():"<"===Mt&&Wn()}function Dt(Mt){Cf.test(Mt)?G=4:"/"===Mt?G=12:">"===Mt?mi():"<"===Mt?Wn():(G=4,function $i(){g--}())}function At(Mt){">"===Mt?(ve=new oc(fe(fe({},ve),{isClosing:!0})),mi()):G=4}function li(Mt){"-"===Mt?G=15:">"===Mt?un():G=16}function Qn(Mt){"-"===Mt?G=18:">"===Mt?un():G=16}function gi(Mt){"-"===Mt&&(G=17)}function Ri(Mt){G="-"===Mt?18:16}function Pt(Mt){">"===Mt?mi():"!"===Mt?G=19:"-"===Mt||(G=16)}function Wt(Mt){"-"===Mt?G=17:">"===Mt?mi():G=16}function tn(Mt){">"===Mt?mi():"<"===Mt&&Wn()}function un(){G=0,ve=a}function Wn(){G=1,ve=new oc({idx:g})}function mi(){var Mt=n.slice(me,ve.idx);Mt&&r(Mt,me),"comment"===ve.type?o(ve.idx):"doctype"===ve.type?s(ve.idx):(ve.isOpening&&e(ve.name,ve.idx),ve.isClosing&&i(ve.name,ve.idx)),un(),me=g+1}function sr(){return n.slice(ve.idx+(ve.isClosing?2:1),g).toLowerCase()}me<g&&function Mi(){var Mt=n.slice(me,g);r(Mt,me),me=g+1}()}(t,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var w=function mL(n,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=t.exec(n);)e.push(n.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(n.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),G=a;w.forEach(function(me,ve){if(ve%2==0){var Ie=e.parseText(me,G);o.push.apply(o,Ie)}G+=me.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},n.prototype.compactMatches=function(t){t.sort(function(g,w){return g.getOffset()-w.getOffset()});for(var e=0;e<t.length-1;){var i=t[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<t.length){if(t[e+1].getOffset()===r){var a=t[e+1].getMatchedText().length>o?e:e+1;t.splice(a,1);continue}if(t[e+1].getOffset()<s){t.splice(e+1,1);continue}}e++}return t},n.prototype.removeUnwantedMatches=function(t){return this.hashtag||yf(t,function(e){return"hashtag"===e.getType()}),this.email||yf(t,function(e){return"email"===e.getType()}),this.phone||yf(t,function(e){return"phone"===e.getType()}),this.mention||yf(t,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||yf(t,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||yf(t,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||yf(t,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),t},n.prototype.parseText=function(t,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(t),g=0,w=a.length;g<w;g++)a[g].setOffset(e+a[g].getOffset());r.push.apply(r,a)}return r},n.prototype.link=function(t){if(!t)return"";this.sanitizeHtml&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(t),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(t.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(t.substring(r)),i.join("")},n.prototype.createMatchReturnVal=function(t){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,t)),"string"==typeof e?e:!1===e?t.getMatchedText():e instanceof Mx?e.toAnchorString():t.buildTag().toAnchorString()},n.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var t=this.getTagBuilder(),e=[new fk({tagBuilder:t,serviceName:this.hashtag}),new uk({tagBuilder:t}),new hk({tagBuilder:t}),new gk({tagBuilder:t,serviceName:this.mention}),new dk({tagBuilder:t,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},n.prototype.getTagBuilder=function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new ek({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},n.version="3.15.0",n.AnchorTagBuilder=ek,n.HtmlTag=Mx,n.matcher={Email:uk,Hashtag:fk,Matcher:hg,Mention:gk,Phone:hk,Url:dk},n.match={Email:tk,Hashtag:nk,Match:fg,Mention:ik,Phone:rk,Url:ok},n}();const qL=GL;let Rx=(()=>{class n{transform(e,i){return qL.link(e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=Vr({name:"linky",type:n,pure:!0}),n})(),WL=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({}),n})();function Hc(n){return x((t,e)=>{Mo(n).subscribe($(e,()=>e.complete(),X)),!e.closed&&t.subscribe(e)})}class ZL extends S{constructor(t,e){super()}schedule(t,e=0){return this}}const k1={setInterval(n,t,...e){const{delegate:i}=k1;return(null==i?void 0:i.setInterval)?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=k1;return((null==t?void 0:t.clearInterval)||clearInterval)(n)},delegate:void 0};class Nx extends ZL{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,i=0){return k1.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;k1.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,v(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const pk={now:()=>(pk.delegate||Date).now(),delegate:void 0};class pm{constructor(t,e=pm.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}pm.now=pk.now;class Ox extends pm{constructor(t,e=pm.now){super(t,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const Bx=new Ox(Nx),YL=Bx;function JL(n,t=Bx){return function KL(n){return x((t,e)=>{let i=!1,r=null,o=null,s=!1;const a=()=>{if(null==o||o.unsubscribe(),o=null,i){i=!1;const w=r;r=null,e.next(w)}s&&e.complete()},g=()=>{o=null,s&&e.complete()};t.subscribe($(e,w=>{i=!0,r=w,o||Mo(n(w)).subscribe(o=$(e,a,g))},()=>{s=!0,(!i||!o||o.closed)&&e.complete()}))})}(()=>function QL(n=0,t,e=YL){let i=-1;return null!=t&&(Ed(t)?e=t:i=t),new O(r=>{let o=function XL(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(n,t))}function _k(...n){return function ez(){return nu(1)}()(po(n,Il(n)))}function Lx(...n){const t=Il(n);return x((e,i)=>{(t?_k(n,e,t):_k(n,e)).subscribe(i)})}function mk(n,t,e){const i=f(n)||t||e?{next:n,error:t,complete:e}:n;return i?x((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe($(o,g=>{var w;null===(w=i.next)||void 0===w||w.call(i,g),o.next(g)},()=>{var g;a=!1,null===(g=i.complete)||void 0===g||g.call(i),o.complete()},g=>{var w;a=!1,null===(w=i.error)||void 0===w||w.call(i,g),o.error(g)},()=>{var g,w;a&&(null===(g=i.unsubscribe)||void 0===g||g.call(i)),null===(w=i.finalize)||void 0===w||w.call(i)}))}):M}function $k(n,t){return x((e,i)=>{let r=0;e.subscribe($(i,o=>n.call(t,o,r++)&&i.next(o)))})}const _m={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=_m;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const r=t(o=>{e=void 0,n(o)});return new S(()=>null==e?void 0:e(r))},requestAnimationFrame(...n){const{delegate:t}=_m;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=_m;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame)(...n)},delegate:void 0},rz=new class iz extends Ox{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class nz extends Nx{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=_m.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(t,e,i);t.actions.some(r=>r.id===e)||(_m.cancelAnimationFrame(e),t._scheduled=void 0)}});let zx,oz=1;const M1={};function vk(n){return n in M1&&(delete M1[n],!0)}const sz={setImmediate(n){const t=oz++;return M1[t]=!0,zx||(zx=Promise.resolve()),zx.then(()=>vk(t)&&n()),t},clearImmediate(n){vk(n)}},{setImmediate:az,clearImmediate:lz}=sz,A1={setImmediate(...n){const{delegate:t}=A1;return((null==t?void 0:t.setImmediate)||az)(...n)},clearImmediate(n){const{delegate:t}=A1;return((null==t?void 0:t.clearImmediate)||lz)(n)},delegate:void 0},dz=new class uz extends Ox{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class cz extends Nx{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=A1.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(t,e,i);t.actions.some(r=>r.id===e)||(A1.clearImmediate(e),t._scheduled=void 0)}}),fz=["addListener","removeListener"],hz=["addEventListener","removeEventListener"],gz=["on","off"];function gg(n,t,e,i){if(f(e)&&(i=e,e=void 0),i)return gg(n,t,e).pipe(am(i));const[r,o]=function mz(n){return f(n.addEventListener)&&f(n.removeEventListener)}(n)?hz.map(s=>a=>n[s](t,a,e)):function pz(n){return f(n.addListener)&&f(n.removeListener)}(n)?fz.map(bk(n,t)):function _z(n){return f(n.on)&&f(n.off)}(n)?gz.map(bk(n,t)):[];if(!r&&ar(n))return vc(s=>gg(s,t,e))(Mo(n));if(!r)throw new TypeError("Invalid event target");return new O(s=>{const a=(...g)=>s.next(1<g.length?g:g[0]);return r(a),()=>o(a)})}function bk(n,t){return e=>i=>n[e](t,i)}const $z=["content"],vz=["scroll"],bz=["padding"],mm=function(n){return{searchTerm:n}};function yz(n,t){if(1&n&&(ee(0,"div",6),gn(1,7),ce()),2&n){const e=_e();W(1),oe("ngTemplateOutlet",e.headerTemplate)("ngTemplateOutletContext",Rt(2,mm,e.filterValue))}}function Cz(n,t){if(1&n&&(ee(0,"div",8),gn(1,7),ce()),2&n){const e=_e();W(1),oe("ngTemplateOutlet",e.footerTemplate)("ngTemplateOutletContext",Rt(2,mm,e.filterValue))}}const yk=["*"],xz=["searchInput"];function wz(n,t){if(1&n){const e=ht();ee(0,"span",15),Re("click",function(){ze(e);const r=_e().$implicit;return _e(2).unselect(r)}),we(1,"\xd7"),ce(),nt(2,"span",16)}if(2&n){const e=_e().$implicit,i=_e(2);W(2),oe("ngItemLabel",e.label)("escape",i.escapeHTML)}}function Ez(n,t){}const Tz=function(n,t,e){return{item:n,clear:t,label:e}};function Sz(n,t){if(1&n&&(ee(0,"div",12),Se(1,wz,3,2,"ng-template",null,13,zn),Se(3,Ez,0,0,"ng-template",14),ce()),2&n){const e=t.$implicit,i=an(2),r=_e(2);Aa("ng-value-disabled",e.disabled),W(3),oe("ngTemplateOutlet",r.labelTemplate||i)("ngTemplateOutletContext",Wo(4,Tz,e.value,r.clearItem,e.label))}}function Dz(n,t){if(1&n&&(Je(0),Se(1,Sz,4,8,"div",11),et()),2&n){const e=_e();W(1),oe("ngForOf",e.selectedItems)("ngForTrackBy",e.trackByOption)}}function Iz(n,t){}const kz=function(n,t){return{items:n,clear:t}};function Mz(n,t){if(1&n&&Se(0,Iz,0,0,"ng-template",14),2&n){const e=_e();oe("ngTemplateOutlet",e.multiLabelTemplate)("ngTemplateOutletContext",fi(2,kz,e.selectedValues,e.clearItem))}}function Az(n,t){1&n&&nt(0,"div",19)}function Pz(n,t){}function Fz(n,t){if(1&n&&(Je(0),Se(1,Az,1,0,"ng-template",null,17,zn),Se(3,Pz,0,0,"ng-template",18),et()),2&n){const e=an(2),i=_e();W(3),oe("ngTemplateOutlet",i.loadingSpinnerTemplate||e)}}function Rz(n,t){1&n&&(ee(0,"span",20)(1,"span",21),we(2,"\xd7"),ce()()),2&n&&sn("title",_e().clearAllText)}function Nz(n,t){if(1&n&&nt(0,"span",27),2&n){const e=_e().$implicit,i=_e(2);oe("ngItemLabel",e.label)("escape",i.escapeHTML)}}function Oz(n,t){}const Bz=function(n,t,e,i){return{item:n,item$:t,index:e,searchTerm:i}};function Lz(n,t){if(1&n){const e=ht();ee(0,"div",25),Re("click",function(){const o=ze(e).$implicit;return _e(2).toggleItem(o)})("mouseover",function(){const o=ze(e).$implicit;return _e(2).onItemHover(o)}),Se(1,Nz,1,2,"ng-template",null,26,zn),Se(3,Oz,0,0,"ng-template",14),ce()}if(2&n){const e=t.$implicit,i=an(2),r=_e(2);Aa("ng-option-disabled",e.disabled)("ng-option-selected",e.selected)("ng-optgroup",e.children)("ng-option",!e.children)("ng-option-child",!!e.parent)("ng-option-marked",e===r.itemsList.markedItem),Zt("role",e.children?"group":"option")("aria-selected",e.selected)("id",null==e?null:e.htmlId),W(3),oe("ngTemplateOutlet",e.children?r.optgroupTemplate||i:r.optionTemplate||i)("ngTemplateOutletContext",Fr(17,Bz,e.value,e,e.index,r.searchTerm))}}function zz(n,t){if(1&n&&(ee(0,"span")(1,"span",30),we(2),ce(),we(3),ce()),2&n){const e=_e(3);W(2),Ct(e.addTagText),W(1),ln('"',e.searchTerm,'"')}}function Uz(n,t){}function Hz(n,t){if(1&n){const e=ht();ee(0,"div",28),Re("mouseover",function(){return ze(e),_e(2).itemsList.unmarkItem()})("click",function(){return ze(e),_e(2).selectTag()}),Se(1,zz,4,2,"ng-template",null,29,zn),Se(3,Uz,0,0,"ng-template",14),ce()}if(2&n){const e=an(2),i=_e(2);Aa("ng-option-marked",!i.itemsList.markedItem),W(3),oe("ngTemplateOutlet",i.tagTemplate||e)("ngTemplateOutletContext",Rt(4,mm,i.searchTerm))}}function Vz(n,t){if(1&n&&(ee(0,"div",32),we(1),ce()),2&n){const e=_e(3);W(1),Ct(e.notFoundText)}}function jz(n,t){}function Gz(n,t){if(1&n&&(Je(0),Se(1,Vz,2,1,"ng-template",null,31,zn),Se(3,jz,0,0,"ng-template",14),et()),2&n){const e=an(2),i=_e(2);W(3),oe("ngTemplateOutlet",i.notFoundTemplate||e)("ngTemplateOutletContext",Rt(2,mm,i.searchTerm))}}function qz(n,t){if(1&n&&(ee(0,"div",32),we(1),ce()),2&n){const e=_e(3);W(1),Ct(e.typeToSearchText)}}function Wz(n,t){}function Zz(n,t){if(1&n&&(Je(0),Se(1,qz,2,1,"ng-template",null,33,zn),Se(3,Wz,0,0,"ng-template",18),et()),2&n){const e=an(2),i=_e(2);W(3),oe("ngTemplateOutlet",i.typeToSearchTemplate||e)}}function Yz(n,t){if(1&n&&(ee(0,"div",32),we(1),ce()),2&n){const e=_e(3);W(1),Ct(e.loadingText)}}function Kz(n,t){}function Xz(n,t){if(1&n&&(Je(0),Se(1,Yz,2,1,"ng-template",null,34,zn),Se(3,Kz,0,0,"ng-template",14),et()),2&n){const e=an(2),i=_e(2);W(3),oe("ngTemplateOutlet",i.loadingTextTemplate||e)("ngTemplateOutletContext",Rt(2,mm,i.searchTerm))}}function Qz(n,t){if(1&n){const e=ht();ee(0,"ng-dropdown-panel",22),Re("update",function(r){return ze(e),_e().viewPortItems=r})("scroll",function(r){return ze(e),_e().scroll.emit(r)})("scrollToEnd",function(r){return ze(e),_e().scrollToEnd.emit(r)})("outsideClick",function(){return ze(e),_e().close()}),Je(1),Se(2,Lz,4,22,"div",23),Se(3,Hz,4,6,"div",24),et(),Se(4,Gz,4,4,"ng-container",3),Se(5,Zz,4,1,"ng-container",3),Se(6,Xz,4,4,"ng-container",3),ce()}if(2&n){const e=_e();Aa("ng-select-multiple",e.multiple),oe("virtualScroll",e.virtualScroll)("bufferAmount",e.bufferAmount)("appendTo",e.appendTo)("position",e.dropdownPosition)("headerTemplate",e.headerTemplate)("footerTemplate",e.footerTemplate)("filterValue",e.searchTerm)("items",e.itemsList.filteredItems)("markedItem",e.itemsList.markedItem)("ngClass",e.appendTo?e.classes:null)("id",e.dropdownId),W(2),oe("ngForOf",e.viewPortItems)("ngForTrackBy",e.trackByOption),W(1),oe("ngIf",e.showAddTag),W(1),oe("ngIf",e.showNoItemsFound()),W(1),oe("ngIf",e.showTypeToSearch()),W(1),oe("ngIf",e.loading&&0===e.itemsList.filteredItems.length)}}const Ck=/[&<>"']/g,Jz=RegExp(Ck.source),e9={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Cr(n){return null!=n}function $m(n){return"object"==typeof n&&Cr(n)}function P1(n){return n instanceof Function}let i9=(()=>{class n{constructor(e){this.element=e,this.escape=!0}ngOnChanges(e){this.element.nativeElement.innerHTML=this.escape?function t9(n){return n&&Jz.test(n)?n.replace(Ck,t=>e9[t]):n}(this.ngItemLabel):this.ngItemLabel}}return n.\u0275fac=function(e){return new(e||n)(Be(di))},n.\u0275dir=rn({type:n,selectors:[["","ngItemLabel",""]],inputs:{ngItemLabel:"ngItemLabel",escape:"escape"},features:[vr]}),n})(),r9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-option-tmp",""]]}),n})(),o9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-optgroup-tmp",""]]}),n})(),s9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-label-tmp",""]]}),n})(),a9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-multi-label-tmp",""]]}),n})(),l9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-header-tmp",""]]}),n})(),c9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-footer-tmp",""]]}),n})(),u9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-notfound-tmp",""]]}),n})(),d9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-typetosearch-tmp",""]]}),n})(),f9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-loadingtext-tmp",""]]}),n})(),h9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-tag-tmp",""]]}),n})(),g9=(()=>{class n{constructor(e){this.template=e}}return n.\u0275fac=function(e){return new(e||n)(Be(Ei))},n.\u0275dir=rn({type:n,selectors:[["","ng-loadingspinner-tmp",""]]}),n})();function xk(){return"axxxxxxxxxxx".replace(/[x]/g,()=>(16*Math.random()|0).toString(16))}const p9={"\u24b6":"A",\uff21:"A",\u00c0:"A",\u00c1:"A",\u00c2:"A",\u1ea6:"A",\u1ea4:"A",\u1eaa:"A",\u1ea8:"A",\u00c3:"A",\u0100:"A",\u0102:"A",\u1eb0:"A",\u1eae:"A",\u1eb4:"A",\u1eb2:"A",\u0226:"A",\u01e0:"A",\u00c4:"A",\u01de:"A",\u1ea2:"A",\u00c5:"A",\u01fa:"A",\u01cd:"A",\u0200:"A",\u0202:"A",\u1ea0:"A",\u1eac:"A",\u1eb6:"A",\u1e00:"A",\u0104:"A",\u023a:"A",\u2c6f:"A",\ua732:"AA",\u00c6:"AE",\u01fc:"AE",\u01e2:"AE",\ua734:"AO",\ua736:"AU",\ua738:"AV",\ua73a:"AV",\ua73c:"AY","\u24b7":"B",\uff22:"B",\u1e02:"B",\u1e04:"B",\u1e06:"B",\u0243:"B",\u0182:"B",\u0181:"B","\u24b8":"C",\uff23:"C",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u00c7:"C",\u1e08:"C",\u0187:"C",\u023b:"C",\ua73e:"C","\u24b9":"D",\uff24:"D",\u1e0a:"D",\u010e:"D",\u1e0c:"D",\u1e10:"D",\u1e12:"D",\u1e0e:"D",\u0110:"D",\u018b:"D",\u018a:"D",\u0189:"D",\ua779:"D",\u01f1:"DZ",\u01c4:"DZ",\u01f2:"Dz",\u01c5:"Dz","\u24ba":"E",\uff25:"E",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u1ec0:"E",\u1ebe:"E",\u1ec4:"E",\u1ec2:"E",\u1ebc:"E",\u0112:"E",\u1e14:"E",\u1e16:"E",\u0114:"E",\u0116:"E",\u00cb:"E",\u1eba:"E",\u011a:"E",\u0204:"E",\u0206:"E",\u1eb8:"E",\u1ec6:"E",\u0228:"E",\u1e1c:"E",\u0118:"E",\u1e18:"E",\u1e1a:"E",\u0190:"E",\u018e:"E","\u24bb":"F",\uff26:"F",\u1e1e:"F",\u0191:"F",\ua77b:"F","\u24bc":"G",\uff27:"G",\u01f4:"G",\u011c:"G",\u1e20:"G",\u011e:"G",\u0120:"G",\u01e6:"G",\u0122:"G",\u01e4:"G",\u0193:"G",\ua7a0:"G",\ua77d:"G",\ua77e:"G","\u24bd":"H",\uff28:"H",\u0124:"H",\u1e22:"H",\u1e26:"H",\u021e:"H",\u1e24:"H",\u1e28:"H",\u1e2a:"H",\u0126:"H",\u2c67:"H",\u2c75:"H",\ua78d:"H","\u24be":"I",\uff29:"I",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u0128:"I",\u012a:"I",\u012c:"I",\u0130:"I",\u00cf:"I",\u1e2e:"I",\u1ec8:"I",\u01cf:"I",\u0208:"I",\u020a:"I",\u1eca:"I",\u012e:"I",\u1e2c:"I",\u0197:"I","\u24bf":"J",\uff2a:"J",\u0134:"J",\u0248:"J","\u24c0":"K",\uff2b:"K",\u1e30:"K",\u01e8:"K",\u1e32:"K",\u0136:"K",\u1e34:"K",\u0198:"K",\u2c69:"K",\ua740:"K",\ua742:"K",\ua744:"K",\ua7a2:"K","\u24c1":"L",\uff2c:"L",\u013f:"L",\u0139:"L",\u013d:"L",\u1e36:"L",\u1e38:"L",\u013b:"L",\u1e3c:"L",\u1e3a:"L",\u0141:"L",\u023d:"L",\u2c62:"L",\u2c60:"L",\ua748:"L",\ua746:"L",\ua780:"L",\u01c7:"LJ",\u01c8:"Lj","\u24c2":"M",\uff2d:"M",\u1e3e:"M",\u1e40:"M",\u1e42:"M",\u2c6e:"M",\u019c:"M","\u24c3":"N",\uff2e:"N",\u01f8:"N",\u0143:"N",\u00d1:"N",\u1e44:"N",\u0147:"N",\u1e46:"N",\u0145:"N",\u1e4a:"N",\u1e48:"N",\u0220:"N",\u019d:"N",\ua790:"N",\ua7a4:"N",\u01ca:"NJ",\u01cb:"Nj","\u24c4":"O",\uff2f:"O",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u1ed2:"O",\u1ed0:"O",\u1ed6:"O",\u1ed4:"O",\u00d5:"O",\u1e4c:"O",\u022c:"O",\u1e4e:"O",\u014c:"O",\u1e50:"O",\u1e52:"O",\u014e:"O",\u022e:"O",\u0230:"O",\u00d6:"O",\u022a:"O",\u1ece:"O",\u0150:"O",\u01d1:"O",\u020c:"O",\u020e:"O",\u01a0:"O",\u1edc:"O",\u1eda:"O",\u1ee0:"O",\u1ede:"O",\u1ee2:"O",\u1ecc:"O",\u1ed8:"O",\u01ea:"O",\u01ec:"O",\u00d8:"O",\u01fe:"O",\u0186:"O",\u019f:"O",\ua74a:"O",\ua74c:"O",\u01a2:"OI",\ua74e:"OO",\u0222:"OU","\u24c5":"P",\uff30:"P",\u1e54:"P",\u1e56:"P",\u01a4:"P",\u2c63:"P",\ua750:"P",\ua752:"P",\ua754:"P","\u24c6":"Q",\uff31:"Q",\ua756:"Q",\ua758:"Q",\u024a:"Q","\u24c7":"R",\uff32:"R",\u0154:"R",\u1e58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1e5a:"R",\u1e5c:"R",\u0156:"R",\u1e5e:"R",\u024c:"R",\u2c64:"R",\ua75a:"R",\ua7a6:"R",\ua782:"R","\u24c8":"S",\uff33:"S",\u1e9e:"S",\u015a:"S",\u1e64:"S",\u015c:"S",\u1e60:"S",\u0160:"S",\u1e66:"S",\u1e62:"S",\u1e68:"S",\u0218:"S",\u015e:"S",\u2c7e:"S",\ua7a8:"S",\ua784:"S","\u24c9":"T",\uff34:"T",\u1e6a:"T",\u0164:"T",\u1e6c:"T",\u021a:"T",\u0162:"T",\u1e70:"T",\u1e6e:"T",\u0166:"T",\u01ac:"T",\u01ae:"T",\u023e:"T",\ua786:"T",\ua728:"TZ","\u24ca":"U",\uff35:"U",\u00d9:"U",\u00da:"U",\u00db:"U",\u0168:"U",\u1e78:"U",\u016a:"U",\u1e7a:"U",\u016c:"U",\u00dc:"U",\u01db:"U",\u01d7:"U",\u01d5:"U",\u01d9:"U",\u1ee6:"U",\u016e:"U",\u0170:"U",\u01d3:"U",\u0214:"U",\u0216:"U",\u01af:"U",\u1eea:"U",\u1ee8:"U",\u1eee:"U",\u1eec:"U",\u1ef0:"U",\u1ee4:"U",\u1e72:"U",\u0172:"U",\u1e76:"U",\u1e74:"U",\u0244:"U","\u24cb":"V",\uff36:"V",\u1e7c:"V",\u1e7e:"V",\u01b2:"V",\ua75e:"V",\u0245:"V",\ua760:"VY","\u24cc":"W",\uff37:"W",\u1e80:"W",\u1e82:"W",\u0174:"W",\u1e86:"W",\u1e84:"W",\u1e88:"W",\u2c72:"W","\u24cd":"X",\uff38:"X",\u1e8a:"X",\u1e8c:"X","\u24ce":"Y",\uff39:"Y",\u1ef2:"Y",\u00dd:"Y",\u0176:"Y",\u1ef8:"Y",\u0232:"Y",\u1e8e:"Y",\u0178:"Y",\u1ef6:"Y",\u1ef4:"Y",\u01b3:"Y",\u024e:"Y",\u1efe:"Y","\u24cf":"Z",\uff3a:"Z",\u0179:"Z",\u1e90:"Z",\u017b:"Z",\u017d:"Z",\u1e92:"Z",\u1e94:"Z",\u01b5:"Z",\u0224:"Z",\u2c7f:"Z",\u2c6b:"Z",\ua762:"Z","\u24d0":"a",\uff41:"a",\u1e9a:"a",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u1ea7:"a",\u1ea5:"a",\u1eab:"a",\u1ea9:"a",\u00e3:"a",\u0101:"a",\u0103:"a",\u1eb1:"a",\u1eaf:"a",\u1eb5:"a",\u1eb3:"a",\u0227:"a",\u01e1:"a",\u00e4:"a",\u01df:"a",\u1ea3:"a",\u00e5:"a",\u01fb:"a",\u01ce:"a",\u0201:"a",\u0203:"a",\u1ea1:"a",\u1ead:"a",\u1eb7:"a",\u1e01:"a",\u0105:"a",\u2c65:"a",\u0250:"a",\ua733:"aa",\u00e6:"ae",\u01fd:"ae",\u01e3:"ae",\ua735:"ao",\ua737:"au",\ua739:"av",\ua73b:"av",\ua73d:"ay","\u24d1":"b",\uff42:"b",\u1e03:"b",\u1e05:"b",\u1e07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24d2":"c",\uff43:"c",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u00e7:"c",\u1e09:"c",\u0188:"c",\u023c:"c",\ua73f:"c",\u2184:"c","\u24d3":"d",\uff44:"d",\u1e0b:"d",\u010f:"d",\u1e0d:"d",\u1e11:"d",\u1e13:"d",\u1e0f:"d",\u0111:"d",\u018c:"d",\u0256:"d",\u0257:"d",\ua77a:"d",\u01f3:"dz",\u01c6:"dz","\u24d4":"e",\uff45:"e",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u1ec1:"e",\u1ebf:"e",\u1ec5:"e",\u1ec3:"e",\u1ebd:"e",\u0113:"e",\u1e15:"e",\u1e17:"e",\u0115:"e",\u0117:"e",\u00eb:"e",\u1ebb:"e",\u011b:"e",\u0205:"e",\u0207:"e",\u1eb9:"e",\u1ec7:"e",\u0229:"e",\u1e1d:"e",\u0119:"e",\u1e19:"e",\u1e1b:"e",\u0247:"e",\u025b:"e",\u01dd:"e","\u24d5":"f",\uff46:"f",\u1e1f:"f",\u0192:"f",\ua77c:"f","\u24d6":"g",\uff47:"g",\u01f5:"g",\u011d:"g",\u1e21:"g",\u011f:"g",\u0121:"g",\u01e7:"g",\u0123:"g",\u01e5:"g",\u0260:"g",\ua7a1:"g",\u1d79:"g",\ua77f:"g","\u24d7":"h",\uff48:"h",\u0125:"h",\u1e23:"h",\u1e27:"h",\u021f:"h",\u1e25:"h",\u1e29:"h",\u1e2b:"h",\u1e96:"h",\u0127:"h",\u2c68:"h",\u2c76:"h",\u0265:"h",\u0195:"hv","\u24d8":"i",\uff49:"i",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u0129:"i",\u012b:"i",\u012d:"i",\u00ef:"i",\u1e2f:"i",\u1ec9:"i",\u01d0:"i",\u0209:"i",\u020b:"i",\u1ecb:"i",\u012f:"i",\u1e2d:"i",\u0268:"i",\u0131:"i","\u24d9":"j",\uff4a:"j",\u0135:"j",\u01f0:"j",\u0249:"j","\u24da":"k",\uff4b:"k",\u1e31:"k",\u01e9:"k",\u1e33:"k",\u0137:"k",\u1e35:"k",\u0199:"k",\u2c6a:"k",\ua741:"k",\ua743:"k",\ua745:"k",\ua7a3:"k","\u24db":"l",\uff4c:"l",\u0140:"l",\u013a:"l",\u013e:"l",\u1e37:"l",\u1e39:"l",\u013c:"l",\u1e3d:"l",\u1e3b:"l",\u017f:"l",\u0142:"l",\u019a:"l",\u026b:"l",\u2c61:"l",\ua749:"l",\ua781:"l",\ua747:"l",\u01c9:"lj","\u24dc":"m",\uff4d:"m",\u1e3f:"m",\u1e41:"m",\u1e43:"m",\u0271:"m",\u026f:"m","\u24dd":"n",\uff4e:"n",\u01f9:"n",\u0144:"n",\u00f1:"n",\u1e45:"n",\u0148:"n",\u1e47:"n",\u0146:"n",\u1e4b:"n",\u1e49:"n",\u019e:"n",\u0272:"n",\u0149:"n",\ua791:"n",\ua7a5:"n",\u01cc:"nj","\u24de":"o",\uff4f:"o",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u1ed3:"o",\u1ed1:"o",\u1ed7:"o",\u1ed5:"o",\u00f5:"o",\u1e4d:"o",\u022d:"o",\u1e4f:"o",\u014d:"o",\u1e51:"o",\u1e53:"o",\u014f:"o",\u022f:"o",\u0231:"o",\u00f6:"o",\u022b:"o",\u1ecf:"o",\u0151:"o",\u01d2:"o",\u020d:"o",\u020f:"o",\u01a1:"o",\u1edd:"o",\u1edb:"o",\u1ee1:"o",\u1edf:"o",\u1ee3:"o",\u1ecd:"o",\u1ed9:"o",\u01eb:"o",\u01ed:"o",\u00f8:"o",\u01ff:"o",\u0254:"o",\ua74b:"o",\ua74d:"o",\u0275:"o",\u01a3:"oi",\u0223:"ou",\ua74f:"oo","\u24df":"p",\uff50:"p",\u1e55:"p",\u1e57:"p",\u01a5:"p",\u1d7d:"p",\ua751:"p",\ua753:"p",\ua755:"p","\u24e0":"q",\uff51:"q",\u024b:"q",\ua757:"q",\ua759:"q","\u24e1":"r",\uff52:"r",\u0155:"r",\u1e59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1e5b:"r",\u1e5d:"r",\u0157:"r",\u1e5f:"r",\u024d:"r",\u027d:"r",\ua75b:"r",\ua7a7:"r",\ua783:"r","\u24e2":"s",\uff53:"s",\u00df:"s",\u015b:"s",\u1e65:"s",\u015d:"s",\u1e61:"s",\u0161:"s",\u1e67:"s",\u1e63:"s",\u1e69:"s",\u0219:"s",\u015f:"s",\u023f:"s",\ua7a9:"s",\ua785:"s",\u1e9b:"s","\u24e3":"t",\uff54:"t",\u1e6b:"t",\u1e97:"t",\u0165:"t",\u1e6d:"t",\u021b:"t",\u0163:"t",\u1e71:"t",\u1e6f:"t",\u0167:"t",\u01ad:"t",\u0288:"t",\u2c66:"t",\ua787:"t",\ua729:"tz","\u24e4":"u",\uff55:"u",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u0169:"u",\u1e79:"u",\u016b:"u",\u1e7b:"u",\u016d:"u",\u00fc:"u",\u01dc:"u",\u01d8:"u",\u01d6:"u",\u01da:"u",\u1ee7:"u",\u016f:"u",\u0171:"u",\u01d4:"u",\u0215:"u",\u0217:"u",\u01b0:"u",\u1eeb:"u",\u1ee9:"u",\u1eef:"u",\u1eed:"u",\u1ef1:"u",\u1ee5:"u",\u1e73:"u",\u0173:"u",\u1e77:"u",\u1e75:"u",\u0289:"u","\u24e5":"v",\uff56:"v",\u1e7d:"v",\u1e7f:"v",\u028b:"v",\ua75f:"v",\u028c:"v",\ua761:"vy","\u24e6":"w",\uff57:"w",\u1e81:"w",\u1e83:"w",\u0175:"w",\u1e87:"w",\u1e85:"w",\u1e98:"w",\u1e89:"w",\u2c73:"w","\u24e7":"x",\uff58:"x",\u1e8b:"x",\u1e8d:"x","\u24e8":"y",\uff59:"y",\u1ef3:"y",\u00fd:"y",\u0177:"y",\u1ef9:"y",\u0233:"y",\u1e8f:"y",\u00ff:"y",\u1ef7:"y",\u1e99:"y",\u1ef5:"y",\u01b4:"y",\u024f:"y",\u1eff:"y","\u24e9":"z",\uff5a:"z",\u017a:"z",\u1e91:"z",\u017c:"z",\u017e:"z",\u1e93:"z",\u1e95:"z",\u01b6:"z",\u0225:"z",\u0240:"z",\u2c6c:"z",\ua763:"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038a:"\u0399",\u03aa:"\u0399",\u038c:"\u039f",\u038e:"\u03a5",\u03ab:"\u03a5",\u038f:"\u03a9",\u03ac:"\u03b1",\u03ad:"\u03b5",\u03ae:"\u03b7",\u03af:"\u03b9",\u03ca:"\u03b9",\u0390:"\u03b9",\u03cc:"\u03bf",\u03cd:"\u03c5",\u03cb:"\u03c5",\u03b0:"\u03c5",\u03c9:"\u03c9",\u03c2:"\u03c3"};function F1(n){return n.replace(/[^\u0000-\u007E]/g,e=>p9[e]||e)}class _9{constructor(t,e){this._ngSelect=t,this._selectionModel=e,this._items=[],this._filteredItems=[],this._markedIndex=-1}get items(){return this._items}get filteredItems(){return this._filteredItems}get markedIndex(){return this._markedIndex}get selectedItems(){return this._selectionModel.value}get markedItem(){return this._filteredItems[this._markedIndex]}get noItemsToSelect(){return this._ngSelect.hideSelected&&this._items.length===this.selectedItems.length}get maxItemsSelected(){return this._ngSelect.multiple&&this._ngSelect.maxSelectedItems<=this.selectedItems.length}get lastSelectedItem(){let t=this.selectedItems.length-1;for(;t>=0;t--){const e=this.selectedItems[t];if(!e.disabled)return e}return null}setItems(t){this._items=t.map((e,i)=>this.mapItem(e,i)),this._ngSelect.groupBy?(this._groups=this._groupBy(this._items,this._ngSelect.groupBy),this._items=this._flatten(this._groups)):(this._groups=new Map,this._groups.set(void 0,this._items)),this._filteredItems=[...this._items]}select(t){if(t.selected||this.maxItemsSelected)return;const e=this._ngSelect.multiple;e||this.clearSelected(),this._selectionModel.select(t,e,this._ngSelect.selectableGroupAsModel),this._ngSelect.hideSelected&&this._hideSelected(t)}unselect(t){!t.selected||(this._selectionModel.unselect(t,this._ngSelect.multiple),this._ngSelect.hideSelected&&Cr(t.index)&&this._ngSelect.multiple&&this._showSelected(t))}findItem(t){let e;return e=this._ngSelect.compareWith?i=>this._ngSelect.compareWith(i.value,t):this._ngSelect.bindValue?i=>!i.children&&this.resolveNested(i.value,this._ngSelect.bindValue)===t:i=>i.value===t||!i.children&&i.label&&i.label===this.resolveNested(t,this._ngSelect.bindLabel),this._items.find(i=>e(i))}addItem(t){const e=this.mapItem(t,this._items.length);return this._items.push(e),this._filteredItems.push(e),e}clearSelected(t=!1){this._selectionModel.clear(t),this._items.forEach(e=>{e.selected=t&&e.selected&&e.disabled,e.marked=!1}),this._ngSelect.hideSelected&&this.resetFilteredItems()}findByLabel(t){return t=F1(t).toLocaleLowerCase(),this.filteredItems.find(e=>F1(e.label).toLocaleLowerCase().substr(0,t.length)===t)}filter(t){if(!t)return void this.resetFilteredItems();this._filteredItems=[],t=this._ngSelect.searchFn?t:F1(t).toLocaleLowerCase();const e=this._ngSelect.searchFn||this._defaultSearchFn,i=this._ngSelect.hideSelected;for(const r of Array.from(this._groups.keys())){const o=[];for(const s of this._groups.get(r))i&&(s.parent&&s.parent.selected||s.selected)||e(t,this._ngSelect.searchFn?s.value:s)&&o.push(s);if(o.length>0){const[s]=o.slice(-1);if(s.parent){const a=this._items.find(g=>g===s.parent);this._filteredItems.push(a)}this._filteredItems.push(...o)}}}resetFilteredItems(){this._filteredItems.length!==this._items.length&&(this._filteredItems=this._ngSelect.hideSelected&&this.selectedItems.length>0?this._items.filter(t=>!t.selected):this._items)}unmarkItem(){this._markedIndex=-1}markNextItem(){this._stepToItem(1)}markPreviousItem(){this._stepToItem(-1)}markItem(t){this._markedIndex=this._filteredItems.indexOf(t)}markSelectedOrDefault(t){if(0===this._filteredItems.length)return;const e=this._getLastMarkedIndex();this._markedIndex=e>-1?e:t?this.filteredItems.findIndex(i=>!i.disabled):-1}resolveNested(t,e){if(!$m(t))return t;if(-1===e.indexOf("."))return t[e];{const i=e.split(".");let r=t;for(let o=0,s=i.length;o<s;++o){if(null==r)return null;r=r[i[o]]}return r}}mapItem(t,e){const i=Cr(t.$ngOptionLabel)?t.$ngOptionLabel:this.resolveNested(t,this._ngSelect.bindLabel),r=Cr(t.$ngOptionValue)?t.$ngOptionValue:t;return{index:e,label:Cr(i)?i.toString():"",value:r,disabled:t.disabled,htmlId:`${this._ngSelect.dropdownId}-${e}`}}mapSelectedItems(){const t=this._ngSelect.multiple;for(const e of this.selectedItems){const i=this._ngSelect.bindValue?this.resolveNested(e.value,this._ngSelect.bindValue):e.value,r=Cr(i)?this.findItem(i):null;this._selectionModel.unselect(e,t),this._selectionModel.select(r||e,t,this._ngSelect.selectableGroupAsModel)}this._ngSelect.hideSelected&&(this._filteredItems=this.filteredItems.filter(e=>-1===this.selectedItems.indexOf(e)))}_showSelected(t){if(this._filteredItems.push(t),t.parent){const e=t.parent;this._filteredItems.find(r=>r===e)||this._filteredItems.push(e)}else if(t.children)for(const e of t.children)e.selected=!1,this._filteredItems.push(e);this._filteredItems=[...this._filteredItems.sort((e,i)=>e.index-i.index)]}_hideSelected(t){this._filteredItems=this._filteredItems.filter(e=>e!==t),t.parent?t.parent.children.every(i=>i.selected)&&(this._filteredItems=this._filteredItems.filter(i=>i!==t.parent)):t.children&&(this._filteredItems=this.filteredItems.filter(e=>e.parent!==t))}_defaultSearchFn(t,e){return F1(e.label).toLocaleLowerCase().indexOf(t)>-1}_getNextItemIndex(t){return t>0?this._markedIndex>=this._filteredItems.length-1?0:this._markedIndex+1:this._markedIndex<=0?this._filteredItems.length-1:this._markedIndex-1}_stepToItem(t){0===this._filteredItems.length||this._filteredItems.every(e=>e.disabled)||(this._markedIndex=this._getNextItemIndex(t),this.markedItem.disabled&&this._stepToItem(t))}_getLastMarkedIndex(){if(this._ngSelect.hideSelected||this._markedIndex>-1&&void 0===this.markedItem)return-1;const t=this._filteredItems.indexOf(this.lastSelectedItem);return this.lastSelectedItem&&t<0?-1:Math.max(this.markedIndex,t)}_groupBy(t,e){const i=new Map;if(0===t.length)return i;if(Array.isArray(t[0].value[e])){for(const s of t){const a=(s.value[e]||[]).map((g,w)=>this.mapItem(g,w));i.set(s,a)}return i}const r=P1(this._ngSelect.groupBy),o=s=>{const a=r?e(s.value):s.value[e];return Cr(a)?a:void 0};for(const s of t){const a=o(s),g=i.get(a);g?g.push(s):i.set(a,[s])}return i}_flatten(t){const e=P1(this._ngSelect.groupBy),i=[];for(const r of Array.from(t.keys())){let o=i.length;if(void 0===r){const me=t.get(void 0)||[];i.push(...me.map(ve=>(ve.index=o++,ve)));continue}const s=$m(r),a={label:s?"":String(r),children:void 0,parent:null,index:o++,disabled:!this._ngSelect.selectableGroup,htmlId:xk()},g=e?this._ngSelect.bindLabel:this._ngSelect.groupBy,w=this._ngSelect.groupValue||(()=>s?r.value:{[g]:r}),G=t.get(r).map(me=>(me.parent=a,me.children=void 0,me.index=o++,me));a.children=G,a.value=w(r,G.map(me=>me.value)),i.push(a),i.push(...G)}return i}}var ml=(()=>{return(n=ml||(ml={}))[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Esc=27]="Esc",n[n.Space=32]="Space",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowDown=40]="ArrowDown",n[n.Backspace=8]="Backspace",ml;var n})();let wk=(()=>{class n{constructor(){this._dimensions={itemHeight:0,panelHeight:0,itemsPerViewport:0}}get dimensions(){return this._dimensions}calculateItems(e,i,r){const o=this._dimensions,s=o.itemHeight*i,g=Math.max(0,e)/s*i;let w=Math.min(i,Math.ceil(g)+(o.itemsPerViewport+1));const me=Math.max(0,w-o.itemsPerViewport);let ve=Math.min(me,Math.floor(g)),Ie=o.itemHeight*Math.ceil(ve)-o.itemHeight*Math.min(ve,r);return Ie=isNaN(Ie)?0:Ie,ve=isNaN(ve)?-1:ve,w=isNaN(w)?-1:w,ve-=r,ve=Math.max(0,ve),w+=r,w=Math.min(i,w),{topPadding:Ie,scrollHeight:s,start:ve,end:w}}setDimensions(e,i){const r=Math.max(1,Math.floor(i/e));this._dimensions={itemHeight:e,panelHeight:i,itemsPerViewport:r}}getScrollTo(e,i,r){const{panelHeight:o}=this.dimensions,s=e+i,g=r+o;return o>=s&&r===e?null:s>g?r+s-g:e<=r?e:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();const Ek=["top","right","bottom","left"],m9="undefined"!=typeof requestAnimationFrame?rz:dz;let Tk=(()=>{class n{constructor(e,i,r,o,s){this._renderer=e,this._zone=i,this._panelService=r,this._document=s,this.items=[],this.position="auto",this.virtualScroll=!1,this.filterValue=null,this.update=new Kt,this.scroll=new Kt,this.scrollToEnd=new Kt,this.outsideClick=new Kt,this._destroy$=new d,this._scrollToEndFired=!1,this._updateScrollHeight=!1,this._lastScrollPosition=0,this._dropdown=o.nativeElement}get currentPosition(){return this._currentPosition}get itemsLength(){return this._itemsLength}set itemsLength(e){e!==this._itemsLength&&(this._itemsLength=e,this._onItemsLengthChanged())}get _startOffset(){if(this.markedItem){const{itemHeight:e,panelHeight:i}=this._panelService.dimensions,r=this.markedItem.index*e;return i>r?0:r}return 0}ngOnInit(){this._select=this._dropdown.parentElement,this._virtualPadding=this.paddingElementRef.nativeElement,this._scrollablePanel=this.scrollElementRef.nativeElement,this._contentPanel=this.contentElementRef.nativeElement,this._handleScroll(),this._handleOutsideClick(),this._appendDropdown(),this._setupMousedownListener()}ngOnChanges(e){if(e.items){const i=e.items;this._onItemsChange(i.currentValue,i.firstChange)}}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete(),this._destroy$.unsubscribe(),this.appendTo&&this._renderer.removeChild(this._dropdown.parentNode,this._dropdown)}scrollTo(e,i=!1){if(!e)return;const r=this.items.indexOf(e);if(r<0||r>=this.itemsLength)return;let o;if(this.virtualScroll){const s=this._panelService.dimensions.itemHeight;o=this._panelService.getScrollTo(r*s,s,this._lastScrollPosition)}else{const s=this._dropdown.querySelector(`#${e.htmlId}`);o=this._panelService.getScrollTo(s.offsetTop,s.clientHeight,i?s.offsetTop:this._lastScrollPosition)}Cr(o)&&(this._scrollablePanel.scrollTop=o)}scrollToTag(){const e=this._scrollablePanel;e.scrollTop=e.scrollHeight-e.clientHeight}adjustPosition(){this._updateYPosition()}_handleDropdownPosition(){this._currentPosition=this._calculateCurrentPosition(this._dropdown),Ek.includes(this._currentPosition)?this._updateDropdownClass(this._currentPosition):this._updateDropdownClass("bottom"),this.appendTo&&this._updateYPosition(),this._dropdown.style.opacity="1"}_updateDropdownClass(e){Ek.forEach(r=>{const o=`ng-select-${r}`;this._renderer.removeClass(this._dropdown,o),this._renderer.removeClass(this._select,o)});const i=`ng-select-${e}`;this._renderer.addClass(this._dropdown,i),this._renderer.addClass(this._select,i)}_handleScroll(){this._zone.runOutsideAngular(()=>{gg(this.scrollElementRef.nativeElement,"scroll").pipe(Hc(this._destroy$),JL(0,m9)).subscribe(e=>{const i=e.path||e.composedPath&&e.composedPath();this._onContentScrolled(i&&0!==i.length?i[0].scrollTop:e.target.scrollTop)})})}_handleOutsideClick(){!this._document||this._zone.runOutsideAngular(()=>{_o(gg(this._document,"touchstart",{capture:!0}),gg(this._document,"mousedown",{capture:!0})).pipe(Hc(this._destroy$)).subscribe(e=>this._checkToClose(e))})}_checkToClose(e){if(this._select.contains(e.target)||this._dropdown.contains(e.target))return;const i=e.path||e.composedPath&&e.composedPath();e.target&&e.target.shadowRoot&&i&&i[0]&&this._select.contains(i[0])||this._zone.run(()=>this.outsideClick.emit())}_onItemsChange(e,i){this.items=e||[],this._scrollToEndFired=!1,this.itemsLength=e.length,this.virtualScroll?this._updateItemsRange(i):(this._setVirtualHeight(),this._updateItems(i))}_updateItems(e){this.update.emit(this.items),!1!==e&&this._zone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._panelService.setDimensions(0,this._scrollablePanel.clientHeight),this._handleDropdownPosition(),this.scrollTo(this.markedItem,e)})})}_updateItemsRange(e){this._zone.runOutsideAngular(()=>{this._measureDimensions().then(()=>{e?(this._renderItemsRange(this._startOffset),this._handleDropdownPosition()):this._renderItemsRange()})})}_onContentScrolled(e){this.virtualScroll&&this._renderItemsRange(e),this._lastScrollPosition=e,this._fireScrollToEnd(e)}_updateVirtualHeight(e){this._updateScrollHeight&&(this._virtualPadding.style.height=`${e}px`,this._updateScrollHeight=!1)}_setVirtualHeight(){!this._virtualPadding||(this._virtualPadding.style.height="0px")}_onItemsLengthChanged(){this._updateScrollHeight=!0}_renderItemsRange(e=null){if(e&&this._lastScrollPosition===e)return;const i=this._panelService.calculateItems(e=e||this._scrollablePanel.scrollTop,this.itemsLength,this.bufferAmount);this._updateVirtualHeight(i.scrollHeight),this._contentPanel.style.transform=`translateY(${i.topPadding}px)`,this._zone.run(()=>{this.update.emit(this.items.slice(i.start,i.end)),this.scroll.emit({start:i.start,end:i.end})}),Cr(e)&&0===this._lastScrollPosition&&(this._scrollablePanel.scrollTop=e,this._lastScrollPosition=e)}_measureDimensions(){if(this._panelService.dimensions.itemHeight>0||0===this.itemsLength)return Promise.resolve(this._panelService.dimensions);const[e]=this.items;return this.update.emit([e]),Promise.resolve().then(()=>{const r=this._dropdown.querySelector(`#${e.htmlId}`).clientHeight;return this._virtualPadding.style.height=r*this.itemsLength+"px",this._panelService.setDimensions(r,this._scrollablePanel.clientHeight),this._panelService.dimensions})}_fireScrollToEnd(e){this._scrollToEndFired||0===e||e+this._dropdown.clientHeight>=(this.virtualScroll?this._virtualPadding:this._contentPanel).clientHeight-1&&(this._zone.run(()=>this.scrollToEnd.emit()),this._scrollToEndFired=!0)}_calculateCurrentPosition(e){if("auto"!==this.position)return this.position;const i=this._select.getBoundingClientRect(),r=document.documentElement.scrollTop||document.body.scrollTop;return i.top+window.pageYOffset+i.height+e.getBoundingClientRect().height>r+document.documentElement.clientHeight?"top":"bottom"}_appendDropdown(){if(this.appendTo){if(this._parent=document.querySelector(this.appendTo),!this._parent)throw new Error(`appendTo selector ${this.appendTo} did not found any parent element`);this._updateXPosition(),this._parent.appendChild(this._dropdown)}}_updateXPosition(){const e=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect();this._dropdown.style.left=e.left-i.left+"px",this._dropdown.style.width=e.width+"px",this._dropdown.style.minWidth=e.width+"px"}_updateYPosition(){const e=this._select.getBoundingClientRect(),i=this._parent.getBoundingClientRect(),r=e.height;"top"===this._currentPosition?(this._dropdown.style.bottom=i.bottom-e.bottom+r+"px",this._dropdown.style.top="auto"):"bottom"===this._currentPosition&&(this._dropdown.style.top=e.top-i.top+r+"px",this._dropdown.style.bottom="auto")}_setupMousedownListener(){this._zone.runOutsideAngular(()=>{gg(this._dropdown,"mousedown").pipe(Hc(this._destroy$)).subscribe(e=>{"INPUT"!==e.target.tagName&&e.preventDefault()})})}}return n.\u0275fac=function(e){return new(e||n)(Be(ju),Be(An),Be(wk),Be(di),Be(fs,8))},n.\u0275cmp=Xt({type:n,selectors:[["ng-dropdown-panel"]],viewQuery:function(e,i){if(1&e&&(Gn($z,7,di),Gn(vz,7,di),Gn(bz,7,di)),2&e){let r;yn(r=Cn())&&(i.contentElementRef=r.first),yn(r=Cn())&&(i.scrollElementRef=r.first),yn(r=Cn())&&(i.paddingElementRef=r.first)}},inputs:{items:"items",markedItem:"markedItem",position:"position",appendTo:"appendTo",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",headerTemplate:"headerTemplate",footerTemplate:"footerTemplate",filterValue:"filterValue"},outputs:{update:"update",scroll:"scroll",scrollToEnd:"scrollToEnd",outsideClick:"outsideClick"},features:[vr],ngContentSelectors:yk,decls:9,vars:6,consts:[["class","ng-dropdown-header",4,"ngIf"],[1,"ng-dropdown-panel-items","scroll-host"],["scroll",""],["padding",""],["content",""],["class","ng-dropdown-footer",4,"ngIf"],[1,"ng-dropdown-header"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ng-dropdown-footer"]],template:function(e,i){1&e&&(V_(),Se(0,yz,2,4,"div",0),ee(1,"div",1,2),nt(3,"div",null,3),ee(5,"div",null,4),j_(7),ce()(),Se(8,Cz,2,4,"div",5)),2&e&&(oe("ngIf",i.headerTemplate),W(3),Aa("total-padding",i.virtualScroll),W(2),Aa("scrollable-content",i.virtualScroll&&i.items.length),W(3),oe("ngIf",i.footerTemplate))},directives:[Sn,Ra],encapsulation:2,changeDetection:0}),n})(),xf=(()=>{class n{constructor(e){this.elementRef=e,this.stateChange$=new d,this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=this._isDisabled(e)}get label(){return(this.elementRef.nativeElement.textContent||"").trim()}ngOnChanges(e){e.disabled&&this.stateChange$.next({value:this.value,disabled:this._disabled})}ngAfterViewChecked(){this.label!==this._previousLabel&&(this._previousLabel=this.label,this.stateChange$.next({value:this.value,disabled:this._disabled,label:this.elementRef.nativeElement.innerHTML}))}ngOnDestroy(){this.stateChange$.complete()}_isDisabled(e){return null!=e&&"false"!=`${e}`}}return n.\u0275fac=function(e){return new(e||n)(Be(di))},n.\u0275cmp=Xt({type:n,selectors:[["ng-option"]],inputs:{value:"value",disabled:"disabled"},features:[vr],ngContentSelectors:yk,decls:1,vars:0,template:function(e,i){1&e&&(V_(),j_(0))},encapsulation:2,changeDetection:0}),n})(),Sk=(()=>{class n{constructor(){this.notFoundText="No items found",this.typeToSearchText="Type to search",this.addTagText="Add item",this.loadingText="Loading...",this.clearAllText="Clear all",this.disableVirtualScroll=!0,this.openOnEnter=!0,this.appearance="underline"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$9=(()=>{class n{warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Dk=new Jn("ng-select-selection-model");let pg=(()=>{class n{constructor(e,i,r,o,s,a,g){this.classes=e,this.autoFocus=i,this.config=r,this._cd=a,this._console=g,this.markFirst=!0,this.dropdownPosition="auto",this.loading=!1,this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.bufferAmount=4,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.searchFn=null,this.trackByFn=null,this.clearOnBackspace=!0,this.labelForId=null,this.inputAttrs={},this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.keyDownFn=w=>!0,this.multiple=!1,this.addTag=!1,this.searchable=!0,this.clearable=!0,this.isOpen=!1,this.blurEvent=new Kt,this.focusEvent=new Kt,this.changeEvent=new Kt,this.openEvent=new Kt,this.closeEvent=new Kt,this.searchEvent=new Kt,this.clearEvent=new Kt,this.addEvent=new Kt,this.removeEvent=new Kt,this.scroll=new Kt,this.scrollToEnd=new Kt,this.useDefaultClass=!0,this.viewPortItems=[],this.searchTerm=null,this.dropdownId=xk(),this.escapeHTML=!0,this._items=[],this._defaultLabel="label",this._pressedKeys=[],this._isComposing=!1,this._destroy$=new d,this._keyPress$=new d,this._onChange=w=>{},this._onTouched=()=>{},this.clearItem=w=>{const G=this.selectedItems.find(me=>me.value===w);this.unselect(G)},this.trackByOption=(w,G)=>this.trackByFn?this.trackByFn(G.value):G,this._mergeGlobalConfig(r),this.itemsList=new _9(this,o()),this.element=s.nativeElement}get items(){return this._items}set items(e){null===e&&(e=[]),this._itemsAreUsed=!0,this._items=e}get compareWith(){return this._compareWith}set compareWith(e){if(null!=e&&!P1(e))throw Error("`compareWith` must be a function.");this._compareWith=e}get clearSearchOnAdd(){return Cr(this._clearSearchOnAdd)?this._clearSearchOnAdd:Cr(this.config.clearSearchOnAdd)?this.config.clearSearchOnAdd:this.closeOnSelect}set clearSearchOnAdd(e){this._clearSearchOnAdd=e}get disabled(){return this.readonly||this._disabled}get filtered(){return!!this.searchTerm&&this.searchable||this._isComposing}get single(){return!this.multiple}get _editableSearchTerm(){return this.editableSearchTerm&&!this.multiple}get selectedItems(){return this.itemsList.selectedItems}get selectedValues(){return this.selectedItems.map(e=>e.value)}get hasValue(){return this.selectedItems.length>0}get currentPanelPosition(){if(this.dropdownPanel)return this.dropdownPanel.currentPosition}ngOnInit(){this._handleKeyPresses(),this._setInputAttributes()}ngOnChanges(e){e.multiple&&this.itemsList.clearSelected(),e.items&&this._setItems(e.items.currentValue||[]),e.isOpen&&(this._manualOpen=Cr(e.isOpen.currentValue))}ngAfterViewInit(){this._itemsAreUsed||(this.escapeHTML=!1,this._setItemsFromNgOptions()),Cr(this.autoFocus)&&this.focus()}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}handleKeyDown(e){if(ml[e.which]){if(!1===this.keyDownFn(e))return;this.handleKeyCode(e)}else e.key&&1===e.key.length&&this._keyPress$.next(e.key.toLocaleLowerCase())}handleKeyCode(e){switch(e.which){case ml.ArrowDown:this._handleArrowDown(e);break;case ml.ArrowUp:this._handleArrowUp(e);break;case ml.Space:this._handleSpace(e);break;case ml.Enter:this._handleEnter(e);break;case ml.Tab:this._handleTab(e);break;case ml.Esc:this.close(),e.preventDefault();break;case ml.Backspace:this._handleBackspace()}}handleMousedown(e){const i=e.target;"INPUT"!==i.tagName&&e.preventDefault(),i.classList.contains("ng-clear-wrapper")?this.handleClearClick():i.classList.contains("ng-arrow-wrapper")?this.handleArrowClick():i.classList.contains("ng-value-icon")||(this.focused||this.focus(),this.searchable?this.open():this.toggle())}handleArrowClick(){this.isOpen?this.close():this.open()}handleClearClick(){this.hasValue&&(this.itemsList.clearSelected(!0),this._updateNgModel()),this._clearSearch(),this.focus(),this.clearEvent.emit(),this._onSelectionChanged()}clearModel(){!this.clearable||(this.itemsList.clearSelected(),this._updateNgModel())}writeValue(e){this.itemsList.clearSelected(),this._handleWriteValue(e),this._cd.markForCheck()}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._disabled=e,this._cd.markForCheck()}toggle(){this.isOpen?this.close():this.open()}open(){this.disabled||this.isOpen||this.itemsList.maxItemsSelected||this._manualOpen||!this._isTypeahead&&!this.addTag&&this.itemsList.noItemsToSelect||(this.isOpen=!0,this.itemsList.markSelectedOrDefault(this.markFirst),this.openEvent.emit(),this.searchTerm||this.focus(),this.detectChanges())}close(){!this.isOpen||this._manualOpen||(this.isOpen=!1,this._isComposing=!1,this._editableSearchTerm?this.itemsList.resetFilteredItems():this._clearSearch(),this.itemsList.unmarkItem(),this._onTouched(),this.closeEvent.emit(),this._cd.markForCheck())}toggleItem(e){!e||e.disabled||this.disabled||(this.multiple&&e.selected?this.unselect(e):this.select(e),this._editableSearchTerm&&this._setSearchTermFromItems(),this._onSelectionChanged())}select(e){e.selected||(this.itemsList.select(e),this.clearSearchOnAdd&&!this._editableSearchTerm&&this._clearSearch(),this._updateNgModel(),this.multiple&&this.addEvent.emit(e.value)),(this.closeOnSelect||this.itemsList.noItemsToSelect)&&this.close()}focus(){this.searchInput.nativeElement.focus()}blur(){this.searchInput.nativeElement.blur()}unselect(e){!e||(this.itemsList.unselect(e),this.focus(),this._updateNgModel(),this.removeEvent.emit(e))}selectTag(){let e;e=P1(this.addTag)?this.addTag(this.searchTerm):this._primitive?this.searchTerm:{[this.bindLabel]:this.searchTerm};const i=r=>this._isTypeahead||!this.isOpen?this.itemsList.mapItem(r,null):this.itemsList.addItem(r);!function n9(n){return n instanceof Promise}(e)?e&&this.select(i(e)):e.then(r=>this.select(i(r))).catch(()=>{})}showClear(){return this.clearable&&(this.hasValue||this.searchTerm)&&!this.disabled}get showAddTag(){if(!this._validTerm)return!1;const e=this.searchTerm.toLowerCase().trim();return this.addTag&&!this.itemsList.filteredItems.some(i=>i.label.toLowerCase()===e)&&(!this.hideSelected&&this.isOpen||!this.selectedItems.some(i=>i.label.toLowerCase()===e))&&!this.loading}showNoItemsFound(){const e=0===this.itemsList.filteredItems.length;return(e&&!this._isTypeahead&&!this.loading||e&&this._isTypeahead&&this._validTerm&&!this.loading)&&!this.showAddTag}showTypeToSearch(){return 0===this.itemsList.filteredItems.length&&this._isTypeahead&&!this._validTerm&&!this.loading}onCompositionStart(){this._isComposing=!0}onCompositionEnd(e){this._isComposing=!1,!this.searchWhileComposing&&this.filter(e)}filter(e){this._isComposing&&!this.searchWhileComposing||(this.searchTerm=e,this._isTypeahead&&(this._validTerm||0===this.minTermLength)&&this.typeahead.next(e),this._isTypeahead||(this.itemsList.filter(this.searchTerm),this.isOpen&&this.itemsList.markSelectedOrDefault(this.markFirst)),this.searchEvent.emit({term:e,items:this.itemsList.filteredItems.map(i=>i.value)}),this.open())}onInputFocus(e){this.focused||(this._editableSearchTerm&&this._setSearchTermFromItems(),this.element.classList.add("ng-select-focused"),this.focusEvent.emit(e),this.focused=!0)}onInputBlur(e){this.element.classList.remove("ng-select-focused"),this.blurEvent.emit(e),!this.isOpen&&!this.disabled&&this._onTouched(),this._editableSearchTerm&&this._setSearchTermFromItems(),this.focused=!1}onItemHover(e){e.disabled||this.itemsList.markItem(e)}detectChanges(){this._cd.destroyed||this._cd.detectChanges()}_setSearchTermFromItems(){const e=this.selectedItems&&this.selectedItems[0];this.searchTerm=e&&e.label||null}_setItems(e){const i=e[0];this.bindLabel=this.bindLabel||this._defaultLabel,this._primitive=Cr(i)?!$m(i):this._primitive||this.bindLabel===this._defaultLabel,this.itemsList.setItems(e),e.length>0&&this.hasValue&&this.itemsList.mapSelectedItems(),this.isOpen&&Cr(this.searchTerm)&&!this._isTypeahead&&this.itemsList.filter(this.searchTerm),(this._isTypeahead||this.isOpen)&&this.itemsList.markSelectedOrDefault(this.markFirst)}_setItemsFromNgOptions(){const e=r=>{this.items=r.map(o=>({$ngOptionValue:o.value,$ngOptionLabel:o.elementRef.nativeElement.innerHTML,disabled:o.disabled})),this.itemsList.setItems(this.items),this.hasValue&&this.itemsList.mapSelectedItems(),this.detectChanges()},i=()=>{const r=_o(this.ngOptions.changes,this._destroy$);_o(...this.ngOptions.map(o=>o.stateChange$)).pipe(Hc(r)).subscribe(o=>{const s=this.itemsList.findItem(o.value);s.disabled=o.disabled,s.label=o.label||s.label,this._cd.detectChanges()})};this.ngOptions.changes.pipe(Lx(this.ngOptions),Hc(this._destroy$)).subscribe(r=>{this.bindLabel=this._defaultLabel,e(r),i()})}_isValidWriteValue(e){if(!Cr(e)||this.multiple&&""===e||Array.isArray(e)&&0===e.length)return!1;const i=r=>!(!Cr(this.compareWith)&&$m(r)&&this.bindValue&&(this._console.warn(`Setting object(${JSON.stringify(r)}) as your model with bindValue is not allowed unless [compareWith] is used.`),1));return this.multiple?Array.isArray(e)?e.every(r=>i(r)):(this._console.warn("Multiple select ngModel should be array."),!1):i(e)}_handleWriteValue(e){if(!this._isValidWriteValue(e))return;const i=r=>{let o=this.itemsList.findItem(r);if(o)this.itemsList.select(o);else{const s=$m(r),a=!s&&!this.bindValue;s||a?this.itemsList.select(this.itemsList.mapItem(r,null)):this.bindValue&&(o={[this.bindLabel]:null,[this.bindValue]:r},this.itemsList.select(this.itemsList.mapItem(o,null)))}};this.multiple?e.forEach(r=>i(r)):i(e)}_handleKeyPresses(){this.searchable||this._keyPress$.pipe(Hc(this._destroy$),mk(e=>this._pressedKeys.push(e)),function tz(n,t=Bx){return x((e,i)=>{let r=null,o=null,s=null;const a=()=>{if(r){r.unsubscribe(),r=null;const w=o;o=null,i.next(w)}};function g(){const w=s+n,G=t.now();if(G<w)return r=this.schedule(void 0,w-G),void i.add(r);a()}e.subscribe($(i,w=>{o=w,s=t.now(),r||(r=t.schedule(g,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}(200),$k(()=>this._pressedKeys.length>0),se(()=>this._pressedKeys.join(""))).subscribe(e=>{const i=this.itemsList.findByLabel(e);i&&(this.isOpen?(this.itemsList.markItem(i),this._scrollToMarked(),this._cd.markForCheck()):this.select(i)),this._pressedKeys=[]})}_setInputAttributes(){const e=this.searchInput.nativeElement,i=Object.assign({type:"text",autocorrect:"off",autocapitalize:"off",autocomplete:this.labelForId?"off":this.dropdownId},this.inputAttrs);for(const r of Object.keys(i))e.setAttribute(r,i[r])}_updateNgModel(){const e=[];for(const r of this.selectedItems)if(this.bindValue){let o=null;o=r.children?r.value[(this.groupValue?this.bindValue:this.groupBy)||this.groupBy]:this.itemsList.resolveNested(r.value,this.bindValue),e.push(o)}else e.push(r.value);const i=this.selectedItems.map(r=>r.value);this.multiple?(this._onChange(e),this.changeEvent.emit(i)):(this._onChange(Cr(e[0])?e[0]:null),this.changeEvent.emit(i[0])),this._cd.markForCheck()}_clearSearch(){!this.searchTerm||(this._changeSearch(null),this.itemsList.resetFilteredItems())}_changeSearch(e){this.searchTerm=e,this._isTypeahead&&this.typeahead.next(e)}_scrollToMarked(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollTo(this.itemsList.markedItem)}_scrollToTag(){!this.isOpen||!this.dropdownPanel||this.dropdownPanel.scrollToTag()}_onSelectionChanged(){this.isOpen&&this.multiple&&this.appendTo&&(this._cd.detectChanges(),this.dropdownPanel.adjustPosition())}_handleTab(e){!1===this.isOpen&&!this.addTag||(this.selectOnTab?this.itemsList.markedItem?(this.toggleItem(this.itemsList.markedItem),e.preventDefault()):this.showAddTag?(this.selectTag(),e.preventDefault()):this.close():this.close())}_handleEnter(e){if(this.isOpen||this._manualOpen)this.itemsList.markedItem?this.toggleItem(this.itemsList.markedItem):this.showAddTag&&this.selectTag();else{if(!this.openOnEnter)return;this.open()}e.preventDefault()}_handleSpace(e){this.isOpen||this._manualOpen||(this.open(),e.preventDefault())}_handleArrowDown(e){this._nextItemIsTag(1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markNextItem(),this._scrollToMarked()),this.open(),e.preventDefault()}_handleArrowUp(e){!this.isOpen||(this._nextItemIsTag(-1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markPreviousItem(),this._scrollToMarked()),e.preventDefault())}_nextItemIsTag(e){const i=this.itemsList.markedIndex+e;return this.addTag&&this.searchTerm&&this.itemsList.markedItem&&(i<0||i===this.itemsList.filteredItems.length)}_handleBackspace(){this.searchTerm||!this.clearable||!this.clearOnBackspace||!this.hasValue||(this.multiple?this.unselect(this.itemsList.lastSelectedItem):this.clearModel())}get _isTypeahead(){return this.typeahead&&this.typeahead.observers.length>0}get _validTerm(){const e=this.searchTerm&&this.searchTerm.trim();return e&&e.length>=this.minTermLength}_mergeGlobalConfig(e){this.placeholder=this.placeholder||e.placeholder,this.notFoundText=this.notFoundText||e.notFoundText,this.typeToSearchText=this.typeToSearchText||e.typeToSearchText,this.addTagText=this.addTagText||e.addTagText,this.loadingText=this.loadingText||e.loadingText,this.clearAllText=this.clearAllText||e.clearAllText,this.virtualScroll=Cr(this.virtualScroll)?this.virtualScroll:!!Cr(e.disableVirtualScroll)&&!e.disableVirtualScroll,this.openOnEnter=Cr(this.openOnEnter)?this.openOnEnter:e.openOnEnter,this.appendTo=this.appendTo||e.appendTo,this.bindValue=this.bindValue||e.bindValue,this.bindLabel=this.bindLabel||e.bindLabel,this.appearance=this.appearance||e.appearance}}return n.\u0275fac=function(e){return new(e||n)(Rc("class"),Rc("autofocus"),Be(Sk),Be(Dk),Be(di),Be(bi),Be($9))},n.\u0275cmp=Xt({type:n,selectors:[["ng-select"]],contentQueries:function(e,i,r){if(1&e&&(ia(r,r9,5,Ei),ia(r,o9,5,Ei),ia(r,s9,5,Ei),ia(r,a9,5,Ei),ia(r,l9,5,Ei),ia(r,c9,5,Ei),ia(r,u9,5,Ei),ia(r,d9,5,Ei),ia(r,f9,5,Ei),ia(r,h9,5,Ei),ia(r,g9,5,Ei),ia(r,xf,5)),2&e){let o;yn(o=Cn())&&(i.optionTemplate=o.first),yn(o=Cn())&&(i.optgroupTemplate=o.first),yn(o=Cn())&&(i.labelTemplate=o.first),yn(o=Cn())&&(i.multiLabelTemplate=o.first),yn(o=Cn())&&(i.headerTemplate=o.first),yn(o=Cn())&&(i.footerTemplate=o.first),yn(o=Cn())&&(i.notFoundTemplate=o.first),yn(o=Cn())&&(i.typeToSearchTemplate=o.first),yn(o=Cn())&&(i.loadingTextTemplate=o.first),yn(o=Cn())&&(i.tagTemplate=o.first),yn(o=Cn())&&(i.loadingSpinnerTemplate=o.first),yn(o=Cn())&&(i.ngOptions=o)}},viewQuery:function(e,i){if(1&e&&(Gn(Tk,5),Gn(xz,7)),2&e){let r;yn(r=Cn())&&(i.dropdownPanel=r.first),yn(r=Cn())&&(i.searchInput=r.first)}},hostVars:20,hostBindings:function(e,i){1&e&&Re("keydown",function(o){return i.handleKeyDown(o)}),2&e&&Aa("ng-select-typeahead",i.typeahead)("ng-select-multiple",i.multiple)("ng-select-taggable",i.addTag)("ng-select-searchable",i.searchable)("ng-select-clearable",i.clearable)("ng-select-opened",i.isOpen)("ng-select",i.useDefaultClass)("ng-select-disabled",i.disabled)("ng-select-filtered",i.filtered)("ng-select-single",i.single)},inputs:{bindLabel:"bindLabel",bindValue:"bindValue",markFirst:"markFirst",placeholder:"placeholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",loading:"loading",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",openOnEnter:"openOnEnter",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:"tabIndex",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",keyDownFn:"keyDownFn",typeahead:"typeahead",multiple:"multiple",addTag:"addTag",searchable:"searchable",clearable:"clearable",isOpen:"isOpen",items:"items",compareWith:"compareWith",clearSearchOnAdd:"clearSearchOnAdd"},outputs:{blurEvent:"blur",focusEvent:"focus",changeEvent:"change",openEvent:"open",closeEvent:"close",searchEvent:"search",clearEvent:"clear",addEvent:"add",removeEvent:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[Ki([{provide:_l,useExisting:ri(()=>n),multi:!0},wk]),vr],decls:14,vars:19,consts:[[1,"ng-select-container",3,"mousedown"],[1,"ng-value-container"],[1,"ng-placeholder"],[4,"ngIf"],["role","combobox","aria-haspopup","listbox",1,"ng-input"],["aria-autocomplete","list",3,"readOnly","disabled","value","input","compositionstart","compositionend","focus","blur","change"],["searchInput",""],["class","ng-clear-wrapper",3,"title",4,"ngIf"],[1,"ng-arrow-wrapper"],[1,"ng-arrow"],["class","ng-dropdown-panel","role","listbox","aria-label","Options list",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ng-select-multiple","ngClass","id","update","scroll","scrollToEnd","outsideClick",4,"ngIf"],["class","ng-value",3,"ng-value-disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"ng-value"],["defaultLabelTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true",1,"ng-value-icon","left",3,"click"],[1,"ng-value-label",3,"ngItemLabel","escape"],["defaultLoadingSpinnerTemplate",""],[3,"ngTemplateOutlet"],[1,"ng-spinner-loader"],[1,"ng-clear-wrapper",3,"title"],["aria-hidden","true",1,"ng-clear"],["role","listbox","aria-label","Options list",1,"ng-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ngClass","id","update","scroll","scrollToEnd","outsideClick"],["class","ng-option",3,"ng-option-disabled","ng-option-selected","ng-optgroup","ng-option","ng-option-child","ng-option-marked","click","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","ng-option","role","option",3,"ng-option-marked","mouseover","click",4,"ngIf"],[1,"ng-option",3,"click","mouseover"],["defaultOptionTemplate",""],[1,"ng-option-label",3,"ngItemLabel","escape"],["role","option",1,"ng-option",3,"mouseover","click"],["defaultTagTemplate",""],[1,"ng-tag-label"],["defaultNotFoundTemplate",""],[1,"ng-option","ng-option-disabled"],["defaultTypeToSearchTemplate",""],["defaultLoadingTextTemplate",""]],template:function(e,i){if(1&e){const r=ht();ee(0,"div",0),Re("mousedown",function(s){return i.handleMousedown(s)}),ee(1,"div",1)(2,"div",2),we(3),ce(),Se(4,Dz,2,2,"ng-container",3),Se(5,Mz,1,5,null,3),ee(6,"div",4)(7,"input",5,6),Re("input",function(){ze(r);const s=an(8);return i.filter(s.value)})("compositionstart",function(){return i.onCompositionStart()})("compositionend",function(){ze(r);const s=an(8);return i.onCompositionEnd(s.value)})("focus",function(s){return i.onInputFocus(s)})("blur",function(s){return i.onInputBlur(s)})("change",function(s){return s.stopPropagation()}),ce()()(),Se(9,Fz,4,1,"ng-container",3),Se(10,Rz,3,1,"span",7),ee(11,"span",8),nt(12,"span",9),ce()(),Se(13,Qz,7,19,"ng-dropdown-panel",10)}2&e&&(Aa("ng-appearance-outline","outline"===i.appearance)("ng-has-value",i.hasValue),W(3),Ct(i.placeholder),W(1),oe("ngIf",(!i.multiLabelTemplate||!i.multiple)&&i.selectedItems.length>0),W(1),oe("ngIf",i.multiple&&i.multiLabelTemplate&&i.selectedValues.length>0),W(1),Zt("aria-expanded",i.isOpen)("aria-owns",i.isOpen?i.dropdownId:null),W(1),oe("readOnly",!i.searchable||i.itemsList.maxItemsSelected)("disabled",i.disabled)("value",i.searchTerm?i.searchTerm:""),Zt("id",i.labelForId)("tabindex",i.tabIndex)("aria-activedescendant",i.isOpen?null==i.itemsList||null==i.itemsList.markedItem?null:i.itemsList.markedItem.htmlId:null)("aria-controls",i.isOpen?i.dropdownId:null),W(2),oe("ngIf",i.loading),W(1),oe("ngIf",i.showClear()),W(3),oe("ngIf",i.isOpen))},directives:[Tk,Sn,oi,i9,Ra,nr],styles:['@charset "UTF-8";.ng-select{position:relative;display:block;box-sizing:border-box}.ng-select div,.ng-select input,.ng-select span{box-sizing:border-box}.ng-select [hidden]{display:none}.ng-select.ng-select-searchable .ng-select-container .ng-value-container .ng-input{opacity:1}.ng-select.ng-select-opened .ng-select-container{z-index:1001}.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-placeholder,.ng-select.ng-select-disabled .ng-select-container .ng-value-container .ng-value{-webkit-user-select:none;user-select:none;cursor:default}.ng-select.ng-select-disabled .ng-arrow-wrapper{cursor:default}.ng-select.ng-select-filtered .ng-placeholder{display:none}.ng-select .ng-select-container{cursor:default;display:flex;outline:none;overflow:hidden;position:relative;width:100%}.ng-select .ng-select-container .ng-value-container{display:flex;flex:1}.ng-select .ng-select-container .ng-value-container .ng-input{opacity:0}.ng-select .ng-select-container .ng-value-container .ng-input>input{box-sizing:content-box;background:none transparent;border:0 none;box-shadow:none;outline:none;padding:0;cursor:default;width:100%}.ng-select .ng-select-container .ng-value-container .ng-input>input::-ms-clear{display:none}.ng-select .ng-select-container .ng-value-container .ng-input>input[readonly]{-webkit-user-select:none;user-select:none;width:0;padding:0}.ng-select.ng-select-single.ng-select-filtered .ng-select-container .ng-value-container .ng-value{visibility:hidden}.ng-select.ng-select-single .ng-select-container .ng-value-container,.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-single .ng-select-container .ng-value-container .ng-input{position:absolute;left:0;width:100%}.ng-select.ng-select-multiple.ng-select-disabled>.ng-select-container .ng-value-container .ng-value .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container{flex-wrap:wrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{position:absolute}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value{white-space:nowrap}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value.ng-value-disabled .ng-value-icon{display:none}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-value .ng-value-icon{cursor:pointer}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-input{flex:1;z-index:2}.ng-select.ng-select-multiple .ng-select-container .ng-value-container .ng-placeholder{z-index:1}.ng-select .ng-clear-wrapper{cursor:pointer;position:relative;width:17px;-webkit-user-select:none;user-select:none}.ng-select .ng-clear-wrapper .ng-clear{display:inline-block;font-size:18px;line-height:1;pointer-events:none}.ng-select .ng-spinner-loader{border-radius:50%;width:17px;height:17px;margin-right:5px;font-size:10px;position:relative;text-indent:-9999em;border-top:2px solid rgba(66,66,66,.2);border-right:2px solid rgba(66,66,66,.2);border-bottom:2px solid rgba(66,66,66,.2);border-left:2px solid #424242;transform:translateZ(0);animation:load8 .8s infinite linear}.ng-select .ng-spinner-loader:after{border-radius:50%;width:17px;height:17px}@keyframes load8{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.ng-select .ng-arrow-wrapper{cursor:pointer;position:relative;text-align:center;-webkit-user-select:none;user-select:none}.ng-select .ng-arrow-wrapper .ng-arrow{pointer-events:none;display:inline-block;height:0;width:0;position:relative}.ng-dropdown-panel{box-sizing:border-box;position:absolute;opacity:0;width:100%;z-index:1050;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .ng-dropdown-panel-items{display:block;height:auto;box-sizing:border-box;max-height:240px;overflow-y:auto}.ng-dropdown-panel .ng-dropdown-panel-items .ng-optgroup{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option{box-sizing:border-box;cursor:pointer;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .ng-option-label:empty:before{content:"\\200b"}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option .highlighted{font-weight:700;text-decoration:underline}.ng-dropdown-panel .ng-dropdown-panel-items .ng-option.disabled{cursor:default}.ng-dropdown-panel .scroll-host{overflow:hidden;overflow-y:auto;position:relative;display:block;-webkit-overflow-scrolling:touch}.ng-dropdown-panel .scrollable-content{top:0;left:0;width:100%;height:100%;position:absolute}.ng-dropdown-panel .total-padding{width:1px;opacity:0}\n'],encapsulation:2,changeDetection:0}),n})();function v9(){return new b9}class b9{constructor(){this._selected=[]}get value(){return this._selected}select(t,e,i){if(t.selected=!0,(!t.children||!e&&i)&&this._selected.push(t),e)if(t.parent){const r=t.parent.children.length,o=t.parent.children.filter(s=>s.selected).length;t.parent.selected=r===o}else t.children&&(this._setChildrenSelectedState(t.children,!0),this._removeChildren(t),this._selected=i&&this._activeChildren(t)?[...this._selected.filter(r=>r.parent!==t),t]:[...this._selected,...t.children.filter(r=>!r.disabled)])}unselect(t,e){if(this._selected=this._selected.filter(i=>i!==t),t.selected=!1,e)if(t.parent&&t.parent.selected){const i=t.parent.children;this._removeParent(t.parent),this._removeChildren(t.parent),this._selected.push(...i.filter(r=>r!==t&&!r.disabled)),t.parent.selected=!1}else t.children&&(this._setChildrenSelectedState(t.children,!1),this._removeChildren(t))}clear(t){this._selected=t?this._selected.filter(e=>e.disabled):[]}_setChildrenSelectedState(t,e){for(const i of t)i.disabled||(i.selected=e)}_removeChildren(t){this._selected=[...this._selected.filter(e=>e.parent!==t),...t.children.filter(e=>e.parent===t&&e.disabled&&e.selected)]}_removeParent(t){this._selected=this._selected.filter(e=>e!==t)}_activeChildren(t){return t.children.every(e=>!e.disabled||e.selected)}}let y9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({providers:[{provide:Dk,useValue:v9}],imports:[[M2]]}),n})();class nd extends d{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function vm(...n){return po(n,Il(n))}function Ik(n,t,e){return e?Ik(n,t).pipe(am(e)):new O(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=n(r);return f(t)?()=>t(r,o):void 0})}function id(...n){const t=Il(n),e=Dl(n),{args:i,keys:r}=dD(n);if(0===i.length)return po([],t);const o=new O(kk(i,t,r?s=>fD(r,s):M));return e?o.pipe(am(e)):o}function kk(n,t,e=M){return i=>{Mk(t,()=>{const{length:r}=n,o=new Array(r);let s=r,a=r;for(let g=0;g<r;g++)Mk(t,()=>{const w=po(n[g],t);let G=!1;w.subscribe($(i,me=>{o[g]=me,G||(G=!0,a--),a||i.next(e(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function Mk(n,t,e){n?Jo(e,n,t):t()}class x9 extends O{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,m(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new S;const e=this.getSubject();t.add(this.source.subscribe($(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=S.EMPTY)}return t}refCount(){return function C9(){return x((n,t)=>{let e=null;n._refCount++;const i=$(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}()(this)}}const E9={connector:()=>new d};function Ak(n,t=E9){const{connector:e}=t;return x((i,r)=>{const o=e();po(n(function w9(n){return new O(t=>n.subscribe(t))}(o))).subscribe(r),r.add(i.subscribe(o))})}function Ux(...n){const t=Dl(n);return x((e,i)=>{const r=n.length,o=new Array(r);let s=n.map(()=>!1),a=!1;for(let g=0;g<r;g++)Mo(n[g]).subscribe($(i,w=>{o[g]=w,!a&&!s[g]&&(s[g]=!0,(a=s.every(M))&&(s=null))},X));e.subscribe($(i,g=>{if(a){const w=[g,...o];i.next(t?t(...w):w)}}))})}function I9(n,t,e,i,r){return(o,s)=>{let a=e,g=t,w=0;o.subscribe($(s,G=>{const me=w++;g=a?n(g,G,me):(a=!0,G),i&&s.next(g)},r&&(()=>{a&&s.next(g),s.complete()})))}}function A9(n,t){return n===t}const{isArray:P9}=Array;function F9(n){return 1===n.length&&P9(n[0])?n[0]:n}function Pk(...n){const t=Dl(n);return t?ge(Pk(...n),am(t)):x((e,i)=>{kk([e,...F9(n)])(i)})}const N9=["youtubeContainer"];let Nk=(()=>{class n{constructor(e,i){this._ngZone=e,this._youtubeContainer=new d,this._destroyed=new d,this._playerChanges=new nd(void 0),this._videoId=new nd(void 0),this._height=new nd(390),this._width=new nd(640),this._startSeconds=new nd(void 0),this._endSeconds=new nd(void 0),this._suggestedQuality=new nd(void 0),this._playerVars=new nd(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=function M6(n){return n===YS}(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=vm(!0);if(!window.YT||!window.YT.Player){const r=new d;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(Po(1),Lx(!1))}const i=function z9(n,t,e,i,r,o,s){const a=id([t,o]).pipe(Ux(id([i,r])),se(([g,w])=>{const[G,me]=g,[ve,Ie]=w;return G?{videoId:G,playerVars:me,width:ve,height:Ie}:void 0}));return id([n,a,vm(s)]).pipe(function U9(n){return ge(Pk(n),function R9(n){return x((t,e)=>{let i=!1,r=0;t.subscribe($(e,o=>(i||(i=!n(o,r++)))&&e.next(o)))})}(([t,e])=>!e),se(([t])=>t))}(e),function k9(n,t){return x(I9(n,t,arguments.length>=2,!0))}(H9,void 0),function M9(n,t=M){return n=null!=n?n:A9,x((e,i)=>{let r,o=!0;e.subscribe($(i,s=>{const a=t(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(mk(r=>{this._playerChanges.next(r)}),function L9(n){return vc(t=>t?Ok(t)?vm(t):new O(e=>{let i=!1,r=!1;const o=s=>{r=!0,i||(s.target.removeEventListener("onReady",o),e.next(s.target))};return t.addEventListener("onReady",o),()=>{i=!0,r||n(t)}}).pipe(Po(1),Lx(void 0)):vm(void 0))}(r=>{Ok(r)||r.destroy()}),Hc(this._destroyed),function S9(n){return n?t=>Ak(n)(t):t=>function T9(n,t){const e=f(n)?n:()=>n;return f(t)?Ak(t,{connector:e}):i=>new x9(i,e)}(new d)(t)}());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function O9(n,t,e){id([n,t,e]).subscribe(([i,r,o])=>i&&i.setSize(r,o))}(i,this._width,this._height),function B9(n,t){id([n,t]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function V9(n,t,e,i,r,o){const s=id([e,i]).pipe(se(([G,me])=>({startSeconds:G,endSeconds:me}))),a=s.pipe(Hx(n,G=>!!G&&!function j9(n){const t=n.getPlayerState();return t!==YT.PlayerState.UNSTARTED&&t!==YT.PlayerState.CUED}(G))),g=t.pipe(Hx(n,(G,me)=>!!G&&G.videoId!==me));_o(n.pipe(Hx(id([t,s]),([G,me],ve)=>!(!ve||G==ve.videoId&&!me.startSeconds&&!me.endSeconds))),g,a).pipe(Ux(id([n,t,s,r])),se(([G,me])=>me),Hc(o)).subscribe(([G,me,ve,Ie])=>{!me||!G||(G.videoId=me,G.cueVideoById(Object.assign({videoId:me,suggestedQuality:Ie},ve)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:g}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=g&&e.seekTo(g.seconds,g.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(function D9(n,t){return x((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe($(i,g=>{null==r||r.unsubscribe();let w=0;const G=o++;Mo(n(g,G)).subscribe(r=$(i,me=>i.next(t?t(g,me,G,w++):me),()=>{r=null,a()}))},()=>{s=!0,a()}))})}(i=>i?Ik(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch(o){}}):vm()),i=>new O(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),Hc(this._destroyed))}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Av))},n.\u0275cmp=Xt({type:n,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&Gn(N9,5),2&e){let r;yn(r=Cn())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&nt(0,"div",null,0)},encapsulation:2,changeDetection:0}),n})();function H9(n,[t,e,i]){if(n&&e&&n.playerVars!==e.playerVars)n.destroy();else{if(!e)return void(n&&n.destroy());if(n)return n}const r=i.runOutsideAngular(()=>new YT.Player(t,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function Ok(n){return"getPlayerStatus"in n}function Hx(n,t){return ge(Ux(n),$k(([e,i])=>t(i,e)),se(([e])=>e))}let G9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n}),n.\u0275inj=es({}),n})();var xn=ye(5861);let _g=0;const bm=new Map,R1=new MessageChannel;function Yo(n){if(4294967296===_g&&(_g=0),++_g in bm)throw new Error("setZeroTimeout queue overflow.");return bm.set(_g,n),R1.port2.postMessage(_g),_g}R1.port1.onmessage=function(n){const t=bm.get(n.data);bm.delete(n.data),t&&t()},R1.port1.start(),R1.port2.start();class Bk{}var Lk=ye(8497),zk=ye(1817),rd=(()=>{return(n=rd||(rd={}))[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LOW=1]="LOW",n[n.MIDDLE=2]="MIDDLE",n[n.HIGH=3]="HIGH",rd;var n})();const Z9=function W9(n){if(n.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let w=0;w<t.length;w++)t[w]=255;for(let w=0;w<n.length;w++){const G=n.charAt(w),me=G.charCodeAt(0);if(255!==t[me])throw new TypeError(G+" is ambiguous");t[me]=w}const e=n.length,i=n.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function a(w){if("string"!=typeof w)throw new TypeError("Expected String");if(0===w.length)return new Uint8Array;let G=0;if(" "===w[G])return;let me=0,ve=0;for(;w[G]===i;)me++,G++;const Ie=(w.length-G)*r+1>>>0,Oe=new Uint8Array(Ie);for(;w[G];){let Ge=t[w.charCodeAt(G)];if(255===Ge)return;let ct=0;for(let rt=Ie-1;(0!==Ge||ct<ve)&&-1!==rt;rt--,ct++)Ge+=e*Oe[rt]>>>0,Oe[rt]=Ge%256>>>0,Ge=Ge/256>>>0;if(0!==Ge)throw new Error("Non-zero carry");ve=ct,G++}if(" "===w[G])return;let Ve=Ie-ve;for(;Ve!==Ie&&0===Oe[Ve];)Ve++;const We=new Uint8Array(me+(Ie-Ve));let Ye=me;for(;Ve!==Ie;)We[Ye++]=Oe[Ve++];return We}return{encode:function s(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===w.length)return"";let G=0,me=0,ve=0;const Ie=w.length;for(;ve!==Ie&&0===w[ve];)ve++,G++;const Oe=(Ie-ve)*o+1>>>0,Ve=new Uint8Array(Oe);for(;ve!==Ie;){let Ge=w[ve],ct=0;for(let rt=Oe-1;(0!==Ge||ct<me)&&-1!==rt;rt--,ct++)Ge+=256*Ve[rt]>>>0,Ve[rt]=Ge%e>>>0,Ge=Ge/e>>>0;if(0!==Ge)throw new Error("Non-zero carry");me=ct,ve++}let We=Oe-me;for(;We!==Oe&&0===Ve[We];)We++;let Ye=i.repeat(G);for(;We<Oe;++We)Ye+=n.charAt(Ve[We]);return Ye},decodeUnsafe:a,decode:function g(w){const G=a(w);if(G)return G;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Y9=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class zi{constructor(t){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:rd.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(t)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(t){try{this.peerId=t;let e=Y9.exec(t);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=Lk.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=t}verifyPassword(t){return Uk(this.roomId,t)===this.digestPassword}static parse(t){return new zi(t)}static create(...t){return t.length<=1?zi._create.apply(this,t):zi._createRoom.apply(this,t)}static _create(t=""){let e=function K9(n){return null==n?"":Hk(n)}(t),i=new zi(e);return i.userId=t,i}static _createRoom(t="",e="",i="",r=""){let o=this.generateId("******"),s=Uk(e,r),a=`${o}${e}${Lk.n(i)}-${s}`,g=new zi(a);return g.userId=t,g.password=r,g}static generateId(t="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=t;return i=t.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function Uk(n,t){return null==n||null==t?"":0<t.length?Hk(n+t,7):""}function Hk(n,t=-1){if(null==n)return"";let e=zk(n),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=Z9.encode(i);return t<0&&(t=r.length),r.length<t&&(t=r.length),r=r.slice(0,t),r}function mg(n){let t=n.length;for(;--t>=0;)n[t]=0}const Wx=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),N1=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),r7=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Kk=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vc=new Array(576);mg(Vc);const xm=new Array(60);mg(xm);const wm=new Array(512);mg(wm);const Em=new Array(256);mg(Em);const Zx=new Array(29);mg(Zx);const O1=new Array(30);function Yx(n,t,e,i,r){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=n&&n.length}let Xk,Qk,Jk;function Kx(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}mg(O1);const eM=n=>n<256?wm[n]:wm[256+(n>>>7)],Tm=(n,t)=>{n.pending_buf[n.pending++]=255&t,n.pending_buf[n.pending++]=t>>>8&255},Os=(n,t,e)=>{n.bi_valid>16-e?(n.bi_buf|=t<<n.bi_valid&65535,Tm(n,n.bi_buf),n.bi_buf=t>>16-n.bi_valid,n.bi_valid+=e-16):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},sc=(n,t,e)=>{Os(n,e[2*t],e[2*t+1])},tM=(n,t)=>{let e=0;do{e|=1&n,n>>>=1,e<<=1}while(--t>0);return e>>>1},nM=(n,t,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)i[o]=r=r+e[o-1]<<1;for(s=0;s<=t;s++){let a=n[2*s+1];0!==a&&(n[2*s]=tM(i[a]++,a))}},iM=n=>{let t;for(t=0;t<286;t++)n.dyn_ltree[2*t]=0;for(t=0;t<30;t++)n.dyn_dtree[2*t]=0;for(t=0;t<19;t++)n.bl_tree[2*t]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},rM=n=>{n.bi_valid>8?Tm(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},oM=(n,t,e,i)=>{const r=2*t,o=2*e;return n[r]<n[o]||n[r]===n[o]&&i[t]<=i[e]},Xx=(n,t,e)=>{const i=n.heap[e];let r=e<<1;for(;r<=n.heap_len&&(r<n.heap_len&&oM(t,n.heap[r+1],n.heap[r],n.depth)&&r++,!oM(t,i,n.heap[r],n.depth));)n.heap[e]=n.heap[r],e=r,r<<=1;n.heap[e]=i},sM=(n,t,e)=>{let i,r,s,a,o=0;if(0!==n.last_lit)do{i=n.pending_buf[n.d_buf+2*o]<<8|n.pending_buf[n.d_buf+2*o+1],r=n.pending_buf[n.l_buf+o],o++,0===i?sc(n,r,t):(s=Em[r],sc(n,s+256+1,t),a=Wx[s],0!==a&&(r-=Zx[s],Os(n,r,a)),i--,s=eM(i),sc(n,s,e),a=N1[s],0!==a&&(i-=O1[s],Os(n,i,a)))}while(o<n.last_lit);sc(n,256,t)},Qx=(n,t)=>{const e=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,w,g=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(n.heap[++n.heap_len]=g=s,n.depth[s]=0):e[2*s+1]=0;for(;n.heap_len<2;)w=n.heap[++n.heap_len]=g<2?++g:0,e[2*w]=1,n.depth[w]=0,n.opt_len--,r&&(n.static_len-=i[2*w+1]);for(t.max_code=g,s=n.heap_len>>1;s>=1;s--)Xx(n,e,s);w=o;do{s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Xx(n,e,1),a=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=a,e[2*w]=e[2*s]+e[2*a],n.depth[w]=(n.depth[s]>=n.depth[a]?n.depth[s]:n.depth[a])+1,e[2*s+1]=e[2*a+1]=w,n.heap[1]=w++,Xx(n,e,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((n,t)=>{const e=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,g=t.stat_desc.max_length;let w,G,me,ve,Ie,Oe,Ve=0;for(ve=0;ve<=15;ve++)n.bl_count[ve]=0;for(e[2*n.heap[n.heap_max]+1]=0,w=n.heap_max+1;w<573;w++)G=n.heap[w],ve=e[2*e[2*G+1]+1]+1,ve>g&&(ve=g,Ve++),e[2*G+1]=ve,!(G>i)&&(n.bl_count[ve]++,Ie=0,G>=a&&(Ie=s[G-a]),Oe=e[2*G],n.opt_len+=Oe*(ve+Ie),o&&(n.static_len+=Oe*(r[2*G+1]+Ie)));if(0!==Ve){do{for(ve=g-1;0===n.bl_count[ve];)ve--;n.bl_count[ve]--,n.bl_count[ve+1]+=2,n.bl_count[g]--,Ve-=2}while(Ve>0);for(ve=g;0!==ve;ve--)for(G=n.bl_count[ve];0!==G;)me=n.heap[--w],!(me>i)&&(e[2*me+1]!==ve&&(n.opt_len+=(ve-e[2*me+1])*e[2*me],e[2*me+1]=ve),G--)}})(n,t),nM(e,g,n.bl_count)},aM=(n,t,e)=>{let i,o,r=-1,s=t[1],a=0,g=7,w=4;for(0===s&&(g=138,w=3),t[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=t[2*(i+1)+1],!(++a<g&&o===s)&&(a<w?n.bl_tree[2*o]+=a:0!==o?(o!==r&&n.bl_tree[2*o]++,n.bl_tree[32]++):a<=10?n.bl_tree[34]++:n.bl_tree[36]++,a=0,r=o,0===s?(g=138,w=3):o===s?(g=6,w=3):(g=7,w=4))},lM=(n,t,e)=>{let i,o,r=-1,s=t[1],a=0,g=7,w=4;for(0===s&&(g=138,w=3),i=0;i<=e;i++)if(o=s,s=t[2*(i+1)+1],!(++a<g&&o===s)){if(a<w)do{sc(n,o,n.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(sc(n,o,n.bl_tree),a--),sc(n,16,n.bl_tree),Os(n,a-3,2)):a<=10?(sc(n,17,n.bl_tree),Os(n,a-3,3)):(sc(n,18,n.bl_tree),Os(n,a-11,7));a=0,r=o,0===s?(g=138,w=3):o===s?(g=6,w=3):(g=7,w=4)}};let cM=!1;const uM=(n,t,e,i)=>{Os(n,0+(i?1:0),3),((n,t,e,i)=>{rM(n),Tm(n,e),Tm(n,~e),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e})(n,t,e)};var C7={_tr_init:n=>{cM||((()=>{let n,t,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(Zx[i]=e,n=0;n<1<<Wx[i];n++)Em[e++]=i;for(Em[e-1]=i,r=0,i=0;i<16;i++)for(O1[i]=r,n=0;n<1<<N1[i];n++)wm[r++]=i;for(r>>=7;i<30;i++)for(O1[i]=r<<7,n=0;n<1<<N1[i]-7;n++)wm[256+r++]=i;for(t=0;t<=15;t++)o[t]=0;for(n=0;n<=143;)Vc[2*n+1]=8,n++,o[8]++;for(;n<=255;)Vc[2*n+1]=9,n++,o[9]++;for(;n<=279;)Vc[2*n+1]=7,n++,o[7]++;for(;n<=287;)Vc[2*n+1]=8,n++,o[8]++;for(nM(Vc,287,o),n=0;n<30;n++)xm[2*n+1]=5,xm[2*n]=tM(n,5);Xk=new Yx(Vc,Wx,257,286,15),Qk=new Yx(xm,N1,0,30,15),Jk=new Yx(new Array(0),r7,0,19,7)})(),cM=!0),n.l_desc=new Kx(n.dyn_ltree,Xk),n.d_desc=new Kx(n.dyn_dtree,Qk),n.bl_desc=new Kx(n.bl_tree,Jk),n.bi_buf=0,n.bi_valid=0,iM(n)},_tr_stored_block:uM,_tr_flush_block:(n,t,e,i)=>{let r,o,s=0;n.level>0?(2===n.strm.data_type&&(n.strm.data_type=(n=>{let e,t=4093624447;for(e=0;e<=31;e++,t>>>=1)if(1&t&&0!==n.dyn_ltree[2*e])return 0;if(0!==n.dyn_ltree[18]||0!==n.dyn_ltree[20]||0!==n.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==n.dyn_ltree[2*e])return 1;return 0})(n)),Qx(n,n.l_desc),Qx(n,n.d_desc),s=(n=>{let t;for(aM(n,n.dyn_ltree,n.l_desc.max_code),aM(n,n.dyn_dtree,n.d_desc.max_code),Qx(n,n.bl_desc),t=18;t>=3&&0===n.bl_tree[2*Kk[t]+1];t--);return n.opt_len+=3*(t+1)+5+5+4,t})(n),r=n.opt_len+3+7>>>3,o=n.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==t?uM(n,t,e,i):4===n.strategy||o===r?(Os(n,2+(i?1:0),3),sM(n,Vc,xm)):(Os(n,4+(i?1:0),3),((n,t,e,i)=>{let r;for(Os(n,t-257,5),Os(n,e-1,5),Os(n,i-4,4),r=0;r<i;r++)Os(n,n.bl_tree[2*Kk[r]+1],3);lM(n,n.dyn_ltree,t-1),lM(n,n.dyn_dtree,e-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),sM(n,n.dyn_ltree,n.dyn_dtree)),iM(n),i&&rM(n)},_tr_tally:(n,t,e)=>(n.pending_buf[n.d_buf+2*n.last_lit]=t>>>8&255,n.pending_buf[n.d_buf+2*n.last_lit+1]=255&t,n.pending_buf[n.l_buf+n.last_lit]=255&e,n.last_lit++,0===t?n.dyn_ltree[2*e]++:(n.matches++,t--,n.dyn_ltree[2*(Em[e]+256+1)]++,n.dyn_dtree[2*eM(t)]++),n.last_lit===n.lit_bufsize-1),_tr_align:n=>{Os(n,2,3),sc(n,256,Vc),(n=>{16===n.bi_valid?(Tm(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(n)}},Sm=(n,t,e,i)=>{let r=65535&n|0,o=n>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+t[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const w7=new Uint32Array((()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t})());var uo=(n,t,e,i)=>{const r=w7,o=i+e;n^=-1;for(let s=i;s<o;s++)n=n>>>8^r[255&(n^t[s])];return-1^n},Ef={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Tf={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:E7,_tr_stored_block:T7,_tr_flush_block:S7,_tr_tally:od,_tr_align:D7}=C7,{Z_NO_FLUSH:Sf,Z_PARTIAL_FLUSH:I7,Z_FULL_FLUSH:k7,Z_FINISH:sd,Z_BLOCK:dM,Z_OK:ac,Z_STREAM_END:fM,Z_STREAM_ERROR:La,Z_DATA_ERROR:M7,Z_BUF_ERROR:Jx,Z_DEFAULT_COMPRESSION:A7,Z_FILTERED:P7,Z_HUFFMAN_ONLY:B1,Z_RLE:F7,Z_FIXED:R7,Z_DEFAULT_STRATEGY:N7,Z_UNKNOWN:O7,Z_DEFLATED:L1}=Tf,$l=262,ld=(n,t)=>(n.msg=Ef[t],t),hM=n=>(n<<1)-(n>4?9:0),cd=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let ud=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const dd=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),0!==e&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,0===t.pending&&(t.pending_out=0))},Co=(n,t)=>{S7(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,dd(n.strm)},Ci=(n,t)=>{n.pending_buf[n.pending++]=t},km=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=255&t},Z7=(n,t,e,i)=>{let r=n.avail_in;return r>i&&(r=i),0===r?0:(n.avail_in-=r,t.set(n.input.subarray(n.next_in,n.next_in+r),e),1===n.state.wrap?n.adler=Sm(n.adler,t,r,e):2===n.state.wrap&&(n.adler=uo(n.adler,t,r,e)),n.next_in+=r,n.total_in+=r,r)},gM=(n,t)=>{let r,o,e=n.max_chain_length,i=n.strstart,s=n.prev_length,a=n.nice_match;const g=n.strstart>n.w_size-$l?n.strstart-(n.w_size-$l):0,w=n.window,G=n.w_mask,me=n.prev,ve=n.strstart+258;let Ie=w[i+s-1],Oe=w[i+s];n.prev_length>=n.good_match&&(e>>=2),a>n.lookahead&&(a=n.lookahead);do{if(r=t,w[r+s]===Oe&&w[r+s-1]===Ie&&w[r]===w[i]&&w[++r]===w[i+1]){i+=2,r++;do{}while(w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&i<ve);if(o=258-(ve-i),i=ve-258,o>s){if(n.match_start=t,s=o,o>=a)break;Ie=w[i+s-1],Oe=w[i+s]}}}while((t=me[t&G])>g&&0!=--e);return s<=n.lookahead?s:n.lookahead},kf=n=>{const t=n.w_size;let e,i,r,o,s;do{if(o=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-$l)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,i=n.hash_size,e=i;do{r=n.head[--e],n.head[e]=r>=t?r-t:0}while(--i);i=t,e=i;do{r=n.prev[--e],n.prev[e]=r>=t?r-t:0}while(--i);o+=t}if(0===n.strm.avail_in)break;if(i=Z7(n.strm,n.window,n.strstart+n.lookahead,o),n.lookahead+=i,n.lookahead+n.insert>=3)for(s=n.strstart-n.insert,n.ins_h=n.window[s],n.ins_h=ud(n,n.ins_h,n.window[s+1]);n.insert&&(n.ins_h=ud(n,n.ins_h,n.window[s+3-1]),n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<$l&&0!==n.strm.avail_in)},nw=(n,t)=>{let e,i;for(;;){if(n.lookahead<$l){if(kf(n),n.lookahead<$l&&t===Sf)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),0!==e&&n.strstart-e<=n.w_size-$l&&(n.match_length=gM(n,e)),n.match_length>=3)if(i=od(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do{n.strstart++,n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart}while(0!=--n.match_length);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=ud(n,n.ins_h,n.window[n.strstart+1]);else i=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(Co(n,!1),0===n.strm.avail_out))return 1}return n.insert=n.strstart<2?n.strstart:2,t===sd?(Co(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(Co(n,!1),0===n.strm.avail_out)?1:2},bg=(n,t)=>{let e,i,r;for(;;){if(n.lookahead<$l){if(kf(n),n.lookahead<$l&&t===Sf)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,0!==e&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-$l&&(n.match_length=gM(n,e),n.match_length<=5&&(n.strategy===P7||3===n.match_length&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){r=n.strstart+n.lookahead-3,i=od(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do{++n.strstart<=r&&(n.ins_h=ud(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart)}while(0!=--n.prev_length);if(n.match_available=0,n.match_length=2,n.strstart++,i&&(Co(n,!1),0===n.strm.avail_out))return 1}else if(n.match_available){if(i=od(n,0,n.window[n.strstart-1]),i&&Co(n,!1),n.strstart++,n.lookahead--,0===n.strm.avail_out)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=od(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,t===sd?(Co(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(Co(n,!1),0===n.strm.avail_out)?1:2};function lc(n,t,e,i,r){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=i,this.func=r}const Mm=[new lc(0,0,0,0,(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(kf(n),0===n.lookahead&&t===Sf)return 1;if(0===n.lookahead)break}n.strstart+=n.lookahead,n.lookahead=0;const i=n.block_start+e;if((0===n.strstart||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,Co(n,!1),0===n.strm.avail_out)||n.strstart-n.block_start>=n.w_size-$l&&(Co(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(Co(n,!0),0===n.strm.avail_out?3:4):(n.strstart>n.block_start&&Co(n,!1),1)}),new lc(4,4,8,4,nw),new lc(4,5,16,8,nw),new lc(4,6,32,32,nw),new lc(4,4,16,16,bg),new lc(8,16,32,32,bg),new lc(8,16,128,128,bg),new lc(8,32,128,256,bg),new lc(32,128,258,1024,bg),new lc(32,258,258,4096,bg)];function J7(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=L1,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),cd(this.dyn_ltree),cd(this.dyn_dtree),cd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),cd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),cd(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const pM=n=>{if(!n||!n.state)return ld(n,La);n.total_in=n.total_out=0,n.data_type=O7;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,n.adler=2===t.wrap?0:1,t.last_flush=Sf,E7(t),ac},_M=n=>{const t=pM(n);return t===ac&&(n=>{n.window_size=2*n.w_size,cd(n.head),n.max_lazy_match=Mm[n.level].max_lazy,n.good_match=Mm[n.level].good_length,n.nice_match=Mm[n.level].nice_length,n.max_chain_length=Mm[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0})(n.state),t},mM=(n,t,e,i,r,o)=>{if(!n)return La;let s=1;if(t===A7&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==L1||i<8||i>15||t<0||t>9||o<0||o>R7)return ld(n,La);8===i&&(i=9);const a=new J7;return n.state=a,a.strm=n,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=e,_M(n)};var Am_deflateInit2=mM,Am_deflateSetHeader=(n,t)=>n&&n.state&&2===n.state.wrap?(n.state.gzhead=t,ac):La,Am_deflate=(n,t)=>{let e,i;if(!n||!n.state||t>dM||t<0)return n?ld(n,La):La;const r=n.state;if(!n.output||!n.input&&0!==n.avail_in||666===r.status&&t!==sd)return ld(n,0===n.avail_out?Jx:La);r.strm=n;const o=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)n.adler=0,Ci(r,31),Ci(r,139),Ci(r,8),r.gzhead?(Ci(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ci(r,255&r.gzhead.time),Ci(r,r.gzhead.time>>8&255),Ci(r,r.gzhead.time>>16&255),Ci(r,r.gzhead.time>>24&255),Ci(r,9===r.level?2:r.strategy>=B1||r.level<2?4:0),Ci(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ci(r,255&r.gzhead.extra.length),Ci(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(n.adler=uo(n.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,0),Ci(r,9===r.level?2:r.strategy>=B1||r.level<2?4:0),Ci(r,3),r.status=113);else{let s=L1+(r.w_bits-8<<4)<<8,a=-1;a=r.strategy>=B1||r.level<2?0:r.level<6?1:6===r.level?2:3,s|=a<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=113,km(r,s),0!==r.strstart&&(km(r,n.adler>>>16),km(r,65535&n.adler)),n.adler=1}if(69===r.status)if(r.gzhead.extra){for(e=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending!==r.pending_buf_size));)Ci(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ci(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),dd(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ci(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=uo(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&dd(n),r.pending+2<=r.pending_buf_size&&(Ci(r,255&n.adler),Ci(r,n.adler>>8&255),n.adler=0,r.status=113)):r.status=113),0!==r.pending){if(dd(n),0===n.avail_out)return r.last_flush=-1,ac}else if(0===n.avail_in&&hM(t)<=hM(o)&&t!==sd)return ld(n,Jx);if(666===r.status&&0!==n.avail_in)return ld(n,Jx);if(0!==n.avail_in||0!==r.lookahead||t!==Sf&&666!==r.status){let s=r.strategy===B1?((n,t)=>{let e;for(;;){if(0===n.lookahead&&(kf(n),0===n.lookahead)){if(t===Sf)return 1;break}if(n.match_length=0,e=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(Co(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(Co(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(Co(n,!1),0===n.strm.avail_out)?1:2})(r,t):r.strategy===F7?((n,t)=>{let e,i,r,o;const s=n.window;for(;;){if(n.lookahead<=258){if(kf(n),n.lookahead<=258&&t===Sf)return 1;if(0===n.lookahead)break}if(n.match_length=0,n.lookahead>=3&&n.strstart>0&&(r=n.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=n.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);n.match_length=258-(o-r),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=3?(e=od(n,1,n.match_length-3),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=od(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(Co(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===sd?(Co(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(Co(n,!1),0===n.strm.avail_out)?1:2})(r,t):Mm[r.level].func(r,t);if((3===s||4===s)&&(r.status=666),1===s||3===s)return 0===n.avail_out&&(r.last_flush=-1),ac;if(2===s&&(t===I7?D7(r):t!==dM&&(T7(r,0,0,!1),t===k7&&(cd(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),dd(n),0===n.avail_out))return r.last_flush=-1,ac}return t!==sd?ac:r.wrap<=0?fM:(2===r.wrap?(Ci(r,255&n.adler),Ci(r,n.adler>>8&255),Ci(r,n.adler>>16&255),Ci(r,n.adler>>24&255),Ci(r,255&n.total_in),Ci(r,n.total_in>>8&255),Ci(r,n.total_in>>16&255),Ci(r,n.total_in>>24&255)):(km(r,n.adler>>>16),km(r,65535&n.adler)),dd(n),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?ac:fM)},Am_deflateEnd=n=>{if(!n||!n.state)return La;const t=n.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?ld(n,La):(n.state=null,113===t?ld(n,M7):ac)},Am_deflateSetDictionary=(n,t)=>{let e=t.length;if(!n||!n.state)return La;const i=n.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return La;if(1===r&&(n.adler=Sm(n.adler,t,e,0)),i.wrap=0,e>=i.w_size){0===r&&(cd(i.head),i.strstart=0,i.block_start=0,i.insert=0);let g=new Uint8Array(i.w_size);g.set(t.subarray(e-i.w_size,e),0),t=g,e=i.w_size}const o=n.avail_in,s=n.next_in,a=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,kf(i);i.lookahead>=3;){let g=i.strstart,w=i.lookahead-2;do{i.ins_h=ud(i,i.ins_h,i.window[g+3-1]),i.prev[g&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=g,g++}while(--w);i.strstart=g,i.lookahead=2,kf(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,n.next_in=s,n.input=a,n.avail_in=o,i.wrap=r,ac};const gU=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var j1_assign=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)gU(e,i)&&(n[i]=e[i])}}return n},j1_flattenChunks=n=>{let t=0;for(let i=0,r=n.length;i<r;i++)t+=n[i].length;const e=new Uint8Array(t);for(let i=0,r=0,o=n.length;i<o;i++){let s=n[i];e.set(s,r),r+=s.length}return e};let $M=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){$M=!1}const Pm=new Uint8Array(256);for(let n=0;n<256;n++)Pm[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Pm[254]=Pm[254]=1;var Fm_string2buf=n=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(n);let t,e,i,r,o,s=n.length,a=0;for(r=0;r<s;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?t[o++]=e:e<2048?(t[o++]=192|e>>>6,t[o++]=128|63&e):e<65536?(t[o++]=224|e>>>12,t[o++]=128|e>>>6&63,t[o++]=128|63&e):(t[o++]=240|e>>>18,t[o++]=128|e>>>12&63,t[o++]=128|e>>>6&63,t[o++]=128|63&e);return t},Fm_buf2string=(n,t)=>{const e=t||n.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(n.subarray(0,t));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=n[i++];if(s<128){o[r++]=s;continue}let a=Pm[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&n[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((n,t)=>{if(t<65534&&n.subarray&&$M)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(n[i]);return e})(o,r)},Fm_utf8border=(n,t)=>{(t=t||n.length)>n.length&&(t=n.length);let e=t-1;for(;e>=0&&128==(192&n[e]);)e--;return e<0||0===e?t:e+Pm[n[e]]>t?e:t},vM=function yU(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const bM=Object.prototype.toString,{Z_NO_FLUSH:CU,Z_SYNC_FLUSH:xU,Z_FULL_FLUSH:wU,Z_FINISH:EU,Z_OK:G1,Z_STREAM_END:TU,Z_DEFAULT_COMPRESSION:SU,Z_DEFAULT_STRATEGY:DU,Z_DEFLATED:IU}=Tf;function Rm(n){this.options=j1_assign({level:SU,method:IU,chunkSize:16384,windowBits:15,memLevel:8,strategy:DU},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vM,this.strm.avail_out=0;let e=Am_deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==G1)throw new Error(Ef[e]);if(t.header&&Am_deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(i="string"==typeof t.dictionary?Fm_string2buf(t.dictionary):"[object ArrayBuffer]"===bM.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,e=Am_deflateSetDictionary(this.strm,i),e!==G1)throw new Error(Ef[e]);this._dict_set=!0}}function iw(n,t){const e=new Rm(t);if(e.push(n,!0),e.err)throw e.msg||Ef[e.err];return e.result}Rm.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?EU:CU,e.input="string"==typeof n?Fm_string2buf(n):"[object ArrayBuffer]"===bM.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===xU||o===wU)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Am_deflate(e,o),r===TU)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Am_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===G1;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Rm.prototype.onData=function(n){this.chunks.push(n)},Rm.prototype.onEnd=function(n){n===G1&&(this.result=j1_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var OU={Deflate:Rm,deflate:iw,deflateRaw:function kU(n,t){return(t=t||{}).raw=!0,iw(n,t)},gzip:function MU(n,t){return(t=t||{}).gzip=!0,iw(n,t)},constants:Tf},LU=function(t,e){let i,r,o,s,a,g,w,G,me,ve,Ie,Oe,Ve,We,Ye,Ge,ct,rt,ft,Lt,wt,Ht,Dt,At;const qt=t.state;i=t.next_in,Dt=t.input,r=i+(t.avail_in-5),o=t.next_out,At=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),g=qt.dmax,w=qt.wsize,G=qt.whave,me=qt.wnext,ve=qt.window,Ie=qt.hold,Oe=qt.bits,Ve=qt.lencode,We=qt.distcode,Ye=(1<<qt.lenbits)-1,Ge=(1<<qt.distbits)-1;e:do{Oe<15&&(Ie+=Dt[i++]<<Oe,Oe+=8,Ie+=Dt[i++]<<Oe,Oe+=8),ct=Ve[Ie&Ye];t:for(;;){if(rt=ct>>>24,Ie>>>=rt,Oe-=rt,rt=ct>>>16&255,0===rt)At[o++]=65535&ct;else{if(!(16&rt)){if(0==(64&rt)){ct=Ve[(65535&ct)+(Ie&(1<<rt)-1)];continue t}if(32&rt){qt.mode=12;break e}t.msg="invalid literal/length code",qt.mode=30;break e}ft=65535&ct,rt&=15,rt&&(Oe<rt&&(Ie+=Dt[i++]<<Oe,Oe+=8),ft+=Ie&(1<<rt)-1,Ie>>>=rt,Oe-=rt),Oe<15&&(Ie+=Dt[i++]<<Oe,Oe+=8,Ie+=Dt[i++]<<Oe,Oe+=8),ct=We[Ie&Ge];n:for(;;){if(rt=ct>>>24,Ie>>>=rt,Oe-=rt,rt=ct>>>16&255,!(16&rt)){if(0==(64&rt)){ct=We[(65535&ct)+(Ie&(1<<rt)-1)];continue n}t.msg="invalid distance code",qt.mode=30;break e}if(Lt=65535&ct,rt&=15,Oe<rt&&(Ie+=Dt[i++]<<Oe,Oe+=8,Oe<rt&&(Ie+=Dt[i++]<<Oe,Oe+=8)),Lt+=Ie&(1<<rt)-1,Lt>g){t.msg="invalid distance too far back",qt.mode=30;break e}if(Ie>>>=rt,Oe-=rt,rt=o-s,Lt>rt){if(rt=Lt-rt,rt>G&&qt.sane){t.msg="invalid distance too far back",qt.mode=30;break e}if(wt=0,Ht=ve,0===me){if(wt+=w-rt,rt<ft){ft-=rt;do{At[o++]=ve[wt++]}while(--rt);wt=o-Lt,Ht=At}}else if(me<rt){if(wt+=w+me-rt,rt-=me,rt<ft){ft-=rt;do{At[o++]=ve[wt++]}while(--rt);if(wt=0,me<ft){rt=me,ft-=rt;do{At[o++]=ve[wt++]}while(--rt);wt=o-Lt,Ht=At}}}else if(wt+=me-rt,rt<ft){ft-=rt;do{At[o++]=ve[wt++]}while(--rt);wt=o-Lt,Ht=At}for(;ft>2;)At[o++]=Ht[wt++],At[o++]=Ht[wt++],At[o++]=Ht[wt++],ft-=3;ft&&(At[o++]=Ht[wt++],ft>1&&(At[o++]=Ht[wt++]))}else{wt=o-Lt;do{At[o++]=At[wt++],At[o++]=At[wt++],At[o++]=At[wt++],ft-=3}while(ft>2);ft&&(At[o++]=At[wt++],ft>1&&(At[o++]=At[wt++]))}break}}break}}while(i<r&&o<a);ft=Oe>>3,i-=ft,Oe-=ft<<3,Ie&=(1<<Oe)-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<a?a-o+257:257-(o-a),qt.hold=Ie,qt.bits=Oe};const zU=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),UU=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),HU=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),VU=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Nm=(n,t,e,i,r,o,s,a)=>{const g=a.bits;let ct,rt,ft,Lt,wt,At,w=0,G=0,me=0,ve=0,Ie=0,Oe=0,Ve=0,We=0,Ye=0,Ge=0,Ht=null,Dt=0;const qt=new Uint16Array(16),li=new Uint16Array(16);let Ri,Pt,Wt,Qn=null,gi=0;for(w=0;w<=15;w++)qt[w]=0;for(G=0;G<i;G++)qt[t[e+G]]++;for(Ie=g,ve=15;ve>=1&&0===qt[ve];ve--);if(Ie>ve&&(Ie=ve),0===ve)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(me=1;me<ve&&0===qt[me];me++);for(Ie<me&&(Ie=me),We=1,w=1;w<=15;w++)if(We<<=1,We-=qt[w],We<0)return-1;if(We>0&&(0===n||1!==ve))return-1;for(li[1]=0,w=1;w<15;w++)li[w+1]=li[w]+qt[w];for(G=0;G<i;G++)0!==t[e+G]&&(s[li[t[e+G]]++]=G);if(0===n?(Ht=Qn=s,At=19):1===n?(Ht=zU,Dt-=257,Qn=UU,gi-=257,At=256):(Ht=HU,Qn=VU,At=-1),Ge=0,G=0,w=me,wt=o,Oe=Ie,Ve=0,ft=-1,Ye=1<<Ie,Lt=Ye-1,1===n&&Ye>852||2===n&&Ye>592)return 1;for(;;){Ri=w-Ve,s[G]<At?(Pt=0,Wt=s[G]):s[G]>At?(Pt=Qn[gi+s[G]],Wt=Ht[Dt+s[G]]):(Pt=96,Wt=0),ct=1<<w-Ve,rt=1<<Oe,me=rt;do{rt-=ct,r[wt+(Ge>>Ve)+rt]=Ri<<24|Pt<<16|Wt|0}while(0!==rt);for(ct=1<<w-1;Ge&ct;)ct>>=1;if(0!==ct?(Ge&=ct-1,Ge+=ct):Ge=0,G++,0==--qt[w]){if(w===ve)break;w=t[e+s[G]]}if(w>Ie&&(Ge&Lt)!==ft){for(0===Ve&&(Ve=Ie),wt+=me,Oe=w-Ve,We=1<<Oe;Oe+Ve<ve&&(We-=qt[Oe+Ve],!(We<=0));)Oe++,We<<=1;if(Ye+=1<<Oe,1===n&&Ye>852||2===n&&Ye>592)return 1;ft=Ge&Lt,r[ft]=Ie<<24|Oe<<16|wt-o|0}}return 0!==Ge&&(r[wt+Ge]=w-Ve<<24|64<<16|0),a.bits=Ie,0};const{Z_FINISH:SM,Z_BLOCK:GU,Z_TREES:W1,Z_OK:Mf,Z_STREAM_END:qU,Z_NEED_DICT:WU,Z_STREAM_ERROR:za,Z_DATA_ERROR:DM,Z_MEM_ERROR:IM,Z_BUF_ERROR:ZU,Z_DEFLATED:kM}=Tf,eA=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function JU(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tA=n=>{if(!n||!n.state)return za;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Mf},nA=n=>{if(!n||!n.state)return za;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,tA(n)},iA=(n,t)=>{let e;if(!n||!n.state)return za;const i=n.state;return t<0?(e=0,t=-t):(e=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?za:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,nA(n))},rA=(n,t)=>{if(!n)return za;const e=new JU;n.state=e,e.window=null;const i=iA(n,t);return i!==Mf&&(n.state=null),i};let lw,cw,oA=!0;const tH=n=>{if(oA){lw=new Int32Array(512),cw=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Nm(1,n.lens,0,288,lw,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Nm(2,n.lens,0,32,cw,0,n.work,{bits:5}),oA=!1}n.lencode=lw,n.lenbits=9,n.distcode=cw,n.distbits=5},sA=(n,t,e,i)=>{let r;const o=n.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(t.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(t.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Gc_inflateReset=nA,Gc_inflateInit2=rA,Gc_inflate=(n,t)=>{let e,i,r,o,s,a,g,w,G,me,ve,Ie,Oe,Ve,Ye,Ge,ct,rt,ft,Lt,wt,Ht,We=0;const Dt=new Uint8Array(4);let At,qt;const li=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&0!==n.avail_in)return za;e=n.state,12===e.mode&&(e.mode=13),s=n.next_out,r=n.output,g=n.avail_out,o=n.next_in,i=n.input,a=n.avail_in,w=e.hold,G=e.bits,me=a,ve=g,Ht=Mf;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;G<16;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(2&e.wrap&&35615===w){e.check=0,Dt[0]=255&w,Dt[1]=w>>>8&255,e.check=uo(e.check,Dt,2,0),w=0,G=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&w)<<8)+(w>>8))%31){n.msg="incorrect header check",e.mode=30;break}if((15&w)!==kM){n.msg="unknown compression method",e.mode=30;break}if(w>>>=4,G-=4,wt=8+(15&w),0===e.wbits)e.wbits=wt;else if(wt>e.wbits){n.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=512&w?10:12,w=0,G=0;break;case 2:for(;G<16;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(e.flags=w,(255&e.flags)!==kM){n.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){n.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=w>>8&1),512&e.flags&&(Dt[0]=255&w,Dt[1]=w>>>8&255,e.check=uo(e.check,Dt,2,0)),w=0,G=0,e.mode=3;case 3:for(;G<32;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.head&&(e.head.time=w),512&e.flags&&(Dt[0]=255&w,Dt[1]=w>>>8&255,Dt[2]=w>>>16&255,Dt[3]=w>>>24&255,e.check=uo(e.check,Dt,4,0)),w=0,G=0,e.mode=4;case 4:for(;G<16;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.head&&(e.head.xflags=255&w,e.head.os=w>>8),512&e.flags&&(Dt[0]=255&w,Dt[1]=w>>>8&255,e.check=uo(e.check,Dt,2,0)),w=0,G=0,e.mode=5;case 5:if(1024&e.flags){for(;G<16;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.length=w,e.head&&(e.head.extra_len=w),512&e.flags&&(Dt[0]=255&w,Dt[1]=w>>>8&255,e.check=uo(e.check,Dt,2,0)),w=0,G=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(Ie=e.length,Ie>a&&(Ie=a),Ie&&(e.head&&(wt=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+Ie),wt)),512&e.flags&&(e.check=uo(e.check,i,Ie,o)),a-=Ie,o+=Ie,e.length-=Ie),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===a)break e;Ie=0;do{wt=i[o+Ie++],e.head&&wt&&e.length<65536&&(e.head.name+=String.fromCharCode(wt))}while(wt&&Ie<a);if(512&e.flags&&(e.check=uo(e.check,i,Ie,o)),a-=Ie,o+=Ie,wt)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===a)break e;Ie=0;do{wt=i[o+Ie++],e.head&&wt&&e.length<65536&&(e.head.comment+=String.fromCharCode(wt))}while(wt&&Ie<a);if(512&e.flags&&(e.check=uo(e.check,i,Ie,o)),a-=Ie,o+=Ie,wt)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;G<16;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(w!==(65535&e.check)){n.msg="header crc mismatch",e.mode=30;break}w=0,G=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=12;break;case 10:for(;G<32;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}n.adler=e.check=eA(w),w=0,G=0,e.mode=11;case 11:if(0===e.havedict)return n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=G,WU;n.adler=e.check=1,e.mode=12;case 12:if(t===GU||t===W1)break e;case 13:if(e.last){w>>>=7&G,G-=7&G,e.mode=27;break}for(;G<3;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}switch(e.last=1&w,w>>>=1,G-=1,3&w){case 0:e.mode=14;break;case 1:if(tH(e),e.mode=20,t===W1){w>>>=2,G-=2;break e}break;case 2:e.mode=17;break;case 3:n.msg="invalid block type",e.mode=30}w>>>=2,G-=2;break;case 14:for(w>>>=7&G,G-=7&G;G<32;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if((65535&w)!=(w>>>16^65535)){n.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&w,w=0,G=0,e.mode=15,t===W1)break e;case 15:e.mode=16;case 16:if(Ie=e.length,Ie){if(Ie>a&&(Ie=a),Ie>g&&(Ie=g),0===Ie)break e;r.set(i.subarray(o,o+Ie),s),a-=Ie,o+=Ie,g-=Ie,s+=Ie,e.length-=Ie;break}e.mode=12;break;case 17:for(;G<14;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(e.nlen=257+(31&w),w>>>=5,G-=5,e.ndist=1+(31&w),w>>>=5,G-=5,e.ncode=4+(15&w),w>>>=4,G-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;G<3;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.lens[li[e.have++]]=7&w,w>>>=3,G-=3}for(;e.have<19;)e.lens[li[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,At={bits:e.lenbits},Ht=Nm(0,e.lens,0,19,e.lencode,0,e.work,At),e.lenbits=At.bits,Ht){n.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;We=e.lencode[w&(1<<e.lenbits)-1],Ye=We>>>24,Ge=We>>>16&255,ct=65535&We,!(Ye<=G);){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(ct<16)w>>>=Ye,G-=Ye,e.lens[e.have++]=ct;else{if(16===ct){for(qt=Ye+2;G<qt;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(w>>>=Ye,G-=Ye,0===e.have){n.msg="invalid bit length repeat",e.mode=30;break}wt=e.lens[e.have-1],Ie=3+(3&w),w>>>=2,G-=2}else if(17===ct){for(qt=Ye+3;G<qt;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}w>>>=Ye,G-=Ye,wt=0,Ie=3+(7&w),w>>>=3,G-=3}else{for(qt=Ye+7;G<qt;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}w>>>=Ye,G-=Ye,wt=0,Ie=11+(127&w),w>>>=7,G-=7}if(e.have+Ie>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=30;break}for(;Ie--;)e.lens[e.have++]=wt}}if(30===e.mode)break;if(0===e.lens[256]){n.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,At={bits:e.lenbits},Ht=Nm(1,e.lens,0,e.nlen,e.lencode,0,e.work,At),e.lenbits=At.bits,Ht){n.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,At={bits:e.distbits},Ht=Nm(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,At),e.distbits=At.bits,Ht){n.msg="invalid distances set",e.mode=30;break}if(e.mode=20,t===W1)break e;case 20:e.mode=21;case 21:if(a>=6&&g>=258){n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=G,LU(n,ve),s=n.next_out,r=n.output,g=n.avail_out,o=n.next_in,i=n.input,a=n.avail_in,w=e.hold,G=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;We=e.lencode[w&(1<<e.lenbits)-1],Ye=We>>>24,Ge=We>>>16&255,ct=65535&We,!(Ye<=G);){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(Ge&&0==(240&Ge)){for(rt=Ye,ft=Ge,Lt=ct;We=e.lencode[Lt+((w&(1<<rt+ft)-1)>>rt)],Ye=We>>>24,Ge=We>>>16&255,ct=65535&We,!(rt+Ye<=G);){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}w>>>=rt,G-=rt,e.back+=rt}if(w>>>=Ye,G-=Ye,e.back+=Ye,e.length=ct,0===Ge){e.mode=26;break}if(32&Ge){e.back=-1,e.mode=12;break}if(64&Ge){n.msg="invalid literal/length code",e.mode=30;break}e.extra=15&Ge,e.mode=22;case 22:if(e.extra){for(qt=e.extra;G<qt;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.length+=w&(1<<e.extra)-1,w>>>=e.extra,G-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;We=e.distcode[w&(1<<e.distbits)-1],Ye=We>>>24,Ge=We>>>16&255,ct=65535&We,!(Ye<=G);){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(0==(240&Ge)){for(rt=Ye,ft=Ge,Lt=ct;We=e.distcode[Lt+((w&(1<<rt+ft)-1)>>rt)],Ye=We>>>24,Ge=We>>>16&255,ct=65535&We,!(rt+Ye<=G);){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}w>>>=rt,G-=rt,e.back+=rt}if(w>>>=Ye,G-=Ye,e.back+=Ye,64&Ge){n.msg="invalid distance code",e.mode=30;break}e.offset=ct,e.extra=15&Ge,e.mode=24;case 24:if(e.extra){for(qt=e.extra;G<qt;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}e.offset+=w&(1<<e.extra)-1,w>>>=e.extra,G-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===g)break e;if(Ie=ve-g,e.offset>Ie){if(Ie=e.offset-Ie,Ie>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=30;break}Ie>e.wnext?(Ie-=e.wnext,Oe=e.wsize-Ie):Oe=e.wnext-Ie,Ie>e.length&&(Ie=e.length),Ve=e.window}else Ve=r,Oe=s-e.offset,Ie=e.length;Ie>g&&(Ie=g),g-=Ie,e.length-=Ie;do{r[s++]=Ve[Oe++]}while(--Ie);0===e.length&&(e.mode=21);break;case 26:if(0===g)break e;r[s++]=e.length,g--,e.mode=21;break;case 27:if(e.wrap){for(;G<32;){if(0===a)break e;a--,w|=i[o++]<<G,G+=8}if(ve-=g,n.total_out+=ve,e.total+=ve,ve&&(n.adler=e.check=e.flags?uo(e.check,r,ve,s-ve):Sm(e.check,r,ve,s-ve)),ve=g,(e.flags?w:eA(w))!==e.check){n.msg="incorrect data check",e.mode=30;break}w=0,G=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;G<32;){if(0===a)break e;a--,w+=i[o++]<<G,G+=8}if(w!==(4294967295&e.total)){n.msg="incorrect length check",e.mode=30;break}w=0,G=0}e.mode=29;case 29:Ht=qU;break e;case 30:Ht=DM;break e;case 31:return IM;default:return za}return n.next_out=s,n.avail_out=g,n.next_in=o,n.avail_in=a,e.hold=w,e.bits=G,(e.wsize||ve!==n.avail_out&&e.mode<30&&(e.mode<27||t!==SM))&&sA(n,n.output,n.next_out,ve-n.avail_out),me-=n.avail_in,ve-=n.avail_out,n.total_in+=me,n.total_out+=ve,e.total+=ve,e.wrap&&ve&&(n.adler=e.check=e.flags?uo(e.check,r,ve,n.next_out-ve):Sm(e.check,r,ve,n.next_out-ve)),n.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===me&&0===ve||t===SM)&&Ht===Mf&&(Ht=ZU),Ht},Gc_inflateEnd=n=>{if(!n||!n.state)return za;let t=n.state;return t.window&&(t.window=null),n.state=null,Mf},Gc_inflateGetHeader=(n,t)=>{if(!n||!n.state)return za;const e=n.state;return 0==(2&e.wrap)?za:(e.head=t,t.done=!1,Mf)},Gc_inflateSetDictionary=(n,t)=>{const e=t.length;let i,r,o;return n&&n.state&&(i=n.state,0===i.wrap||11===i.mode)?11===i.mode&&(r=1,r=Sm(r,t,e,0),r!==i.check)?DM:(o=sA(n,t,e,e),o?(i.mode=31,IM):(i.havedict=1,Mf)):za},mH=function _H(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const aA=Object.prototype.toString,{Z_NO_FLUSH:$H,Z_FINISH:vH,Z_OK:Om,Z_STREAM_END:uw,Z_NEED_DICT:dw,Z_STREAM_ERROR:bH,Z_DATA_ERROR:lA,Z_MEM_ERROR:yH}=Tf;function Bm(n){this.options=j1_assign({chunkSize:65536,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new vM,this.strm.avail_out=0;let e=Gc_inflateInit2(this.strm,t.windowBits);if(e!==Om)throw new Error(Ef[e]);if(this.header=new mH,Gc_inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Fm_string2buf(t.dictionary):"[object ArrayBuffer]"===aA.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Gc_inflateSetDictionary(this.strm,t.dictionary),e!==Om)))throw new Error(Ef[e])}function fw(n,t){const e=new Bm(t);if(e.push(n),e.err)throw e.msg||Ef[e.err];return e.result}Bm.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?vH:$H,e.input="[object ArrayBuffer]"===aA.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Gc_inflate(e,s),o===dw&&r&&(o=Gc_inflateSetDictionary(e,r),o===Om?o=Gc_inflate(e,s):o===lA&&(o=dw));e.avail_in>0&&o===uw&&e.state.wrap>0&&0!==n[e.next_in];)Gc_inflateReset(e),o=Gc_inflate(e,s);switch(o){case bH:case lA:case dw:case yH:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===uw))if("string"===this.options.to){let g=Fm_utf8border(e.output,e.next_out),w=e.next_out-g,G=Fm_buf2string(e.output,g);e.next_out=w,e.avail_out=i-w,w&&e.output.set(e.output.subarray(g,g+w),0),this.onData(G)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==Om||0!==a){if(o===uw)return o=Gc_inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Bm.prototype.onData=function(n){this.chunks.push(n)},Bm.prototype.onEnd=function(n){n===Om&&(this.result="string"===this.options.to?this.chunks.join(""):j1_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var DH={Inflate:Bm,inflate:fw,inflateRaw:function CH(n,t){return(t=t||{}).raw=!0,fw(n,t)},ungzip:fw,constants:Tf};const{Deflate:IH}=OU,{Inflate:PH}=DH;var cA=IH,uA=PH;function hw(){return hw=(0,xn.Z)(function*(n,t){const e=new cA({level:2,gzip:!0});try{return yield dA(e,n,t),e.result}catch(i){console.error(i)}return null}),hw.apply(this,arguments)}function gw(){return gw=(0,xn.Z)(function*(n,t){const e=new uA;try{return yield dA(e,n,t),e.result}catch(i){console.error(i)}return null}),gw.apply(this,arguments)}function dA(n,t){return pw.apply(this,arguments)}function pw(){return pw=(0,xn.Z)(function*(n,t,e=16384){let i=Math.ceil(t.byteLength/e),r=null;for(let o=0;o<i;o++)yield qH(),r=t.slice(o*e,(o+1)*e),n.push(r,i<=o+1);if(n.err)throw new Error(`error: ${n.err}`);return n}),pw.apply(this,arguments)}function qH(){return new Promise(n=>Yo(n))}var la,n,fA=ye(2391);(n=la||(la={})).encode=function t(i){try{return fA.encode(i)}catch(r){console.error(r,i)}return null},n.decode=function e(i){try{return fA.decode(i)}catch(r){console.error(r,i)}return null};var fd,WH=ye(9069);!function(n){let t=[];for(let i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);n.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]+"-"+t[255&o]+t[o>>8&255]+"-"+t[o>>16&15|64]+t[o>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&a]+t[a>>8&255]+t[a>>16&255]+t[a>>24&255]}}(fd||(fd={}));class cc{constructor(t,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=t,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...t){1===t.length?this.timerMilliSecond=t[0]:1<t.length&&(this.callback=t[0],this.timerMilliSecond=t[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class X1{constructor(){}static add(t){this.monitoringConnections.add(t),t.updateStatsAsync(),this.restart()}static remove(t){this.monitoringConnections.delete(t)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new cc(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var t=this;return(0,xn.Z)(function*(){for(let e of t.monitoringConnections)e.open?yield e.updateStatsAsync():t.remove(e);t.monitoringConnections.size<1?t.updateWebRTCStatsTimer=null:t.restart()})()}}X1.updateWebRTCStatsTimer=null,X1.monitoringConnections=new Set;var Ua=(()=>(function(n){n.UNKNOWN="unknown",n.RELAY="relay",n.PRFLX="prflx",n.SRFLX="srflx",n.HOST="host"}(Ua||(Ua={})),Ua))();class ZH{constructor(t){this.peerConnection=t,this.candidateType=Ua.UNKNOWN}updateAsync(){var t=this;return(0,xn.Z)(function*(){let e=null;try{e=yield t.peerConnection.getStats()}catch(ve){console.warn(ve)}if(null==e)return void(t.candidateType=Ua.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],g=[],w=[];e.forEach(ve=>{0<=ve.type.indexOf("candidate-pair")&&i.push(ve),0<=ve.type.indexOf("local-candidate")&&r.push(ve),0<=ve.type.indexOf("remote-candidate")&&o.push(ve)}),i.forEach(ve=>{"succeeded"===ve.state&&(s.push(ve.localCandidateId),a.push(ve.remoteCandidateId))}),r.forEach(ve=>{s.includes(ve.id)&&g.push(ve)}),o.forEach(ve=>{a.includes(ve.id)&&w.push(ve)});let G=Ua.UNKNOWN,me=Object.values(Ua);g.concat(w).forEach(ve=>{let Ie=me.indexOf(ve.candidateType);me.indexOf(G)<Ie&&(G=me[Ie])}),t.candidateType=G})()}}class hA extends WH.EventEmitter{constructor(t){super(),this.conn=t,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Ua.UNKNOWN,t.on("data",e=>this.onData(e)),t.on("open",()=>{this.stats=new ZH(this.getPeerConnection()),this.clearTimeoutTimer(),function YH(n){n._dc&&n._sendBuffer&&(n._startSendLoop=KH)}(t),this.emit("open"),this.startMonitoring()}),t.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),t.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var t,e;return null!==(e=null===(t=this.conn._dc)||void 0===t?void 0:t.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(t){this._timestamp=t}get ping(){return this._ping}set ping(t){this._ping=t}get candidateType(){return this._candidateType}set candidateType(t){this._candidateType=t}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(t){let e=la.encode(t),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=fd.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(la.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){X1.add(this)}stopMonitoring(){X1.remove(this)}updateStatsAsync(){var t=this;return(0,xn.Z)(function*(){null!=t.stats&&(t.sendPing(),yield t.stats.updateAsync(),t.candidateType=t.stats.candidateType,t.emit("stats",t.stats))})()}sendPing(){let t=la.encode({from:this.remoteId,ping:performance.now()});this.conn.send(t)}receivePing(t){if(t.from===this.remoteId){let i=performance.now()-t.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=la.encode(t);this.conn.send(e)}}onData(t){this.timestamp=performance.now();let e=la.decode(new Uint8Array(t));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let w of o.chanks)s.set(w,a),a+=w.byteLength;let g=la.decode(s);this.emit("data",g)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function KH(){this.sendInterval||(this.sendInterval=Yo(gA.bind(this)))}function gA(){const n=this._sendBuffer.shift();try{this._dc.send(n)}catch(t){this._sendBuffer.push(n)}this.sendInterval=0===this._sendBuffer.length?void 0:Yo(gA.bind(this))}class XH{constructor(){this._peerIds=[],this.peerContext=zi.parse("???"),this.peerContexts=[],this.callback=new Bk,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...t){console.log("open",t),this.peerContext=0===t.length?zi.create(zi.generateId()):1===t.length?zi.create(t[0]):zi.create(t[0],t[1],t[2],t[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=zi.parse("???")}connect(t){if(!this.shouldConnect(t))return!1;let e=new hA(this.peer.connect(t,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(t){return this.peerContext&&this.peer&&this.peerId?this.peerId===t?(console.log("connect() is Fail. "+t+" is me."),!1):this.findDataConnection(t)?(console.log("connect() is Fail. <"+t+"> is already connecting."),!1):!(!t||!t.length||t===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(t){let e=this.findDataConnection(t);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let t of this.connections.concat())this.closeDataConnection(t)}send(t,e){var i=this;if(this.connections.length<1)return;let r={data:la.encode(t),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Yo((0,xn.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(t)&&1<t.length){let g=yield function jH(n,t){return hw.apply(this,arguments)}(r.data);g.byteLength<r.data.byteLength&&(r.data=g,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(t,e){t.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(t)}sendBroadcast(t){for(let e of this.connections)e.open&&e.send(t)}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return new Promise((t,e)=>{if(!this.peer)return t([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void t(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),t(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let t=new Peer(this.peerContext.peerId,{key:this.key});t.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=zi.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),t.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),t.on("connection",e=>{this.openDataConnection(new hA(e))}),t.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=t}openDataConnection(t){if(!1===this.addDataConnection(t))return;let e=this.connections.indexOf(t),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(t.remoteId),t.on("data",r=>{this.onData(t,r)}),t.on("open",()=>{this.maybeUnavailablePeerIds.delete(t.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(t.remoteId)}),t.on("close",()=>{this.closeDataConnection(t)}),t.on("error",()=>{this.closeDataConnection(t)}),t.on("stats",()=>{let r=performance.now()-t.timestamp,o=r<=1e4?1:5e3/(r-1e4+5e3),s=o<1?r:t.ping,a=500/(s+500);switch(i.session.health=o,i.session.ping=s,i.session.speed=a*o,t.candidateType){case Ua.HOST:i.session.grade=rd.HIGH;break;case Ua.SRFLX:case Ua.PRFLX:i.session.grade=rd.MIDDLE;break;case Ua.RELAY:i.session.grade=rd.LOW;break;default:i.session.grade=rd.UNSPECIFIED}i.session.description=t.candidateType,i.session.health<.2&&this.closeDataConnection(t)})}closeDataConnection(t){t.close();let e=this.connections.indexOf(t);0<=e&&(console.log(t.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(t.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(t.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+t.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(t.remoteId)}addDataConnection(t){let e=this.findDataConnection(t.remoteId);if(null!==e){if(console.log("add() is Fail. "+t.remoteId+" is already connecting."),e!==t){if(!(e.metadata.sendFrom<t.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(t),!0;this.closeDataConnection(t)}return!1}return this.connections.push(t),this.peerContexts.push(zi.parse(t.remoteId)),console.log("<add()> Peer:"+t.remoteId+" length:"+this.connections.length),!0}findDataConnection(t){for(let e of this.connections)if(e.remoteId===t)return e;return null}onData(t,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(t,e),0<e.ttl&&this.onRelay(t,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Yo((0,xn.Z)(function*(){let a=e.isCompressed?yield function GH(n,t){return gw.apply(this,arguments)}(e.data):e.data;return i.callback.onData(t.remoteId,la.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(t,e){e.ttl--;let i=this.relayingPeerIds.get(t.remoteId);if(null!=i)for(let r of i){let o=this.findDataConnection(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}onUpdatePeerList(t,e){let i=[],r=[],o=function QH(n,t){let e=[],i=[],r=!1,o=!1;for(let s of n.concat(t))r=n.includes(s),o=t.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=o.diff1,r=o.diff2,this.relayingPeerIds.set(t.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let s of r)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let t=[];for(let e of this.connections)e.open&&t.push(e.remoteId);return t.push(this.peerId),t.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=t,console.log("<update()>",t),this.notifyPeerList(),t}notifyPeerList(){if(this.connections.length<1)return;let t={data:la.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(t)}getSkyWayErrorMessage(t){switch(t){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const pA=zi.parse("???");class uc{constructor(){this.callback=new Bk,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=t=>{this.close()},console.log("Network ready...")}static get instance(){return uc._instance||(uc._instance=new uc),uc._instance}get peerId(){return this.connection?this.connection.peerId:pA.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:pA}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...t){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",t),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,t),window.addEventListener("unload",this.callbackUnload,!1)}connectionClose(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...\u5186\u67f1")}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(t){return!!this.connection&&this.connection.connect(t)}disconnect(t){!this.connection||this.connection.disconnect(t)&&(console.log("<disconnectPeer()> Peer:"+t),this.disconnect(t))}send(t,e){this.queue.add({data:t,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Yo(this.sendCallback))}sendQueue(){let t=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?t.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){t.length&&this.connection.send(t);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,t),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?Yo(this.sendCallback):null}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let t=new XH;return t.setApiKey(this.key),t.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},t.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},t.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},t.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},t.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},t.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Yo(this.sendCallback)),t}}class Cg{constructor(t,e,i=uc.instance.peerId){this.eventName=t,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===uc.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class _w{constructor(t,e){this._priority=0,this._isRegistered=!1,this._subject=t,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...t){return this._isOnlyOnce=!1,2===t.length?this.register(t[0],0,t[1]):this.register(t[0],t[1],t[2])}once(...t){let e=this.on.apply(this,t);return this._isOnlyOnce=!0,e}register(t,e,i){return this.isRegistered&&this.unregister(),this._eventName=t||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new _w(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(t){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[t,this]),this.isOnlyOnce&&this.unregister())}isEqual(t,e,i){return!(null!=t&&t!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Af{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return Af._instance||(Af._instance=new Af,Af._instance.initializeNetworkEvent()),Af._instance}register(t){return new _w(this,t)}unregister(...t){1===t.length?this._unregister(t[0],null,null):2===t.length?"string"==typeof t[1]?this._unregister(t[0],t[1],null):this._unregister(t[0],null,t[1]):this._unregister(t[0],t[1],t[2])}_unregister(t=this,e,i){let r=this.listenerMap.values();for(let o of r)for(let s of o.concat())s.isEqual(t,e,i)&&s.unregister()}registerListener(t){let e=this.getListeners(t.eventName);return e.push(t),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(t.eventName,e),t}unregisterListener(t){let e=this.getListeners(t.eventName),i=e.indexOf(t);return i<0?null:(e.splice(i,1),t.unregister(),e.length<1&&this.listenerMap.delete(t.eventName),t)}call(...t){"string"==typeof t[0]?this._call(new Cg(t[0],t[1]),t[2]):this._call(t[0],t[1])}_call(t,e){let i=t.toContext();uc.instance.send(i,e)}trigger(...t){if(2!==t.length)return this._trigger(t[0]instanceof Cg?t[0]:new Cg(t[0].eventName,t[0].data,t[0].sendFrom));this._trigger(new Cg(t[0],t[1]))}_trigger(t){let e=this.getListeners(t.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(t);return t}getListeners(t){return this.listenerMap.has(t)?this.listenerMap.get(t):[]}initializeNetworkEvent(){let t=uc.instance.callback;t.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},t.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},t.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},t.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},t.onData=(e,i)=>{for(let r of i)this.trigger(r)},t.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(t){console.log(t)}}const Qe=Af.instance,$t=uc.instance;var Kr_isObject=function JH(n){return"object"==typeof n&&null!==n},Kr_repeat=function nV(n,t){var i,e="";for(i=0;i<t;i+=1)e+=n;return e},Kr_isNegativeZero=function iV(n){return 0===n&&Number.NEGATIVE_INFINITY===1/n};function mA(n,t){var e="",i=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(e+='in "'+n.mark.name+'" '),e+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!t&&n.mark.snippet&&(e+="\n\n"+n.mark.snippet),i+" "+e):i}function Lm(n,t){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=t,this.message=mA(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Lm.prototype=Object.create(Error.prototype)).constructor=Lm,Lm.prototype.toString=function(t){return this.name+": "+mA(this,t)};var ms=Lm;function mw(n,t,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-t>a&&(t=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+n.slice(t,e).replace(/\t/g,"\u2192")+s,pos:i-t+o.length}}function $w(n,t){return Kr_repeat(" ",t-n.length)+n}var fV=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],hV=["scalar","sequence","mapping"],xo=function pV(n,t){if(t=t||{},Object.keys(t).forEach(function(e){if(-1===fV.indexOf(e))throw new ms('Unknown option "'+e+'" is met in definition of "'+n+'" YAML type.')}),this.options=t,this.tag=n,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function gV(n){var t={};return null!==n&&Object.keys(n).forEach(function(e){n[e].forEach(function(i){t[String(i)]=e})}),t}(t.styleAliases||null),-1===hV.indexOf(this.kind))throw new ms('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')};function $A(n,t){var e=[];return n[t].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function vw(n){return this.extend(n)}vw.prototype.extend=function(t){var e=[],i=[];if(t instanceof xo)i.push(t);else if(Array.isArray(t))i=i.concat(t);else{if(!t||!Array.isArray(t.implicit)&&!Array.isArray(t.explicit))throw new ms("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.implicit&&(e=e.concat(t.implicit)),t.explicit&&(i=i.concat(t.explicit))}e.forEach(function(o){if(!(o instanceof xo))throw new ms("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new ms("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new ms("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof xo))throw new ms("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(vw.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=$A(r,"implicit"),r.compiledExplicit=$A(r,"explicit"),r.compiledTypeMap=function _V(){var t,e,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(n.multi[r.kind].push(r),n.multi.fallback.push(r)):n[r.kind][r.tag]=n.fallback[r.tag]=r}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(i);return n}(r.compiledImplicit,r.compiledExplicit),r};var vA=vw,bA=new xo("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return null!==n?n:""}}),yA=new xo("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return null!==n?n:[]}}),CA=new xo("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return null!==n?n:{}}}),xA=new vA({explicit:[bA,yA,CA]}),wA=new xo("tag:yaml.org,2002:null",{kind:"scalar",resolve:function mV(n){if(null===n)return!0;var t=n.length;return 1===t&&"~"===n||4===t&&("null"===n||"Null"===n||"NULL"===n)},construct:function $V(){return null},predicate:function vV(n){return null===n},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),EA=new xo("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function bV(n){if(null===n)return!1;var t=n.length;return 4===t&&("true"===n||"True"===n||"TRUE"===n)||5===t&&("false"===n||"False"===n||"FALSE"===n)},construct:function yV(n){return"true"===n||"True"===n||"TRUE"===n},predicate:function CV(n){return"[object Boolean]"===Object.prototype.toString.call(n)},represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function xV(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function wV(n){return 48<=n&&n<=55}function EV(n){return 48<=n&&n<=57}var TA=new xo("tag:yaml.org,2002:int",{kind:"scalar",resolve:function TV(n){if(null===n)return!1;var r,t=n.length,e=0,i=!1;if(!t)return!1;if(("-"===(r=n[e])||"+"===r)&&(r=n[++e]),"0"===r){if(e+1===t)return!0;if("b"===(r=n[++e])){for(e++;e<t;e++)if("_"!==(r=n[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!xV(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!wV(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<t;e++)if("_"!==(r=n[e])){if(!EV(n.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function SV(n){var i,t=n,e=1;if(-1!==t.indexOf("_")&&(t=t.replace(/_/g,"")),("-"===(i=t[0])||"+"===i)&&("-"===i&&(e=-1),i=(t=t.slice(1))[0]),"0"===t)return 0;if("0"===i){if("b"===t[1])return e*parseInt(t.slice(2),2);if("x"===t[1])return e*parseInt(t.slice(2),16);if("o"===t[1])return e*parseInt(t.slice(2),8)}return e*parseInt(t,10)},predicate:function DV(n){return"[object Number]"===Object.prototype.toString.call(n)&&n%1==0&&!Kr_isNegativeZero(n)},represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),IV=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),AV=/^[-+]?[0-9]+e/,SA=new xo("tag:yaml.org,2002:float",{kind:"scalar",resolve:function kV(n){return!(null===n||!IV.test(n)||"_"===n[n.length-1])},construct:function MV(n){var t,e;return e="-"===(t=n.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:e*parseFloat(t,10)},predicate:function FV(n){return"[object Number]"===Object.prototype.toString.call(n)&&(n%1!=0||Kr_isNegativeZero(n))},represent:function PV(n,t){var e;if(isNaN(n))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Kr_isNegativeZero(n))return"-0.0";return e=n.toString(10),AV.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),IA=xA.extend({implicit:[wA,EA,TA,SA]}),kA=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),MA=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),AA=new xo("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function RV(n){return null!==n&&(null!==kA.exec(n)||null!==MA.exec(n))},construct:function NV(n){var t,e,i,r,o,s,a,ve,g=0,w=null;if(null===(t=kA.exec(n))&&(t=MA.exec(n)),null===t)throw new Error("Date resolve error");if(e=+t[1],i=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(e,i,r));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(g=t[7].slice(0,3);g.length<3;)g+="0";g=+g}return t[9]&&(w=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(w=-w)),ve=new Date(Date.UTC(e,i,r,o,s,a,g)),w&&ve.setTime(ve.getTime()-w),ve},instanceOf:Date,represent:function OV(n){return n.toISOString()}}),PA=new xo("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function BV(n){return"<<"===n||null===n}}),bw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",FA=new xo("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function LV(n){if(null===n)return!1;var t,e,i=0,r=n.length,o=bw;for(e=0;e<r;e++)if(!((t=o.indexOf(n.charAt(e)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function zV(n){var t,e,i=n.replace(/[\r\n=]/g,""),r=i.length,o=bw,s=0,a=[];for(t=0;t<r;t++)t%4==0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(t));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function HV(n){return"[object Uint8Array]"===Object.prototype.toString.call(n)},represent:function UV(n){var i,r,t="",e=0,o=n.length,s=bw;for(i=0;i<o;i++)i%3==0&&i&&(t+=s[e>>18&63],t+=s[e>>12&63],t+=s[e>>6&63],t+=s[63&e]),e=(e<<8)+n[i];return 0==(r=o%3)?(t+=s[e>>18&63],t+=s[e>>12&63],t+=s[e>>6&63],t+=s[63&e]):2===r?(t+=s[e>>10&63],t+=s[e>>4&63],t+=s[e<<2&63],t+=s[64]):1===r&&(t+=s[e>>2&63],t+=s[e<<4&63],t+=s[64],t+=s[64]),t}}),VV=Object.prototype.hasOwnProperty,jV=Object.prototype.toString,RA=new xo("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function GV(n){if(null===n)return!0;var e,i,r,o,s,t=[],a=n;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==jV.call(r=a[e]))return!1;for(o in r)if(VV.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==t.indexOf(o))return!1;t.push(o)}return!0},construct:function qV(n){return null!==n?n:[]}}),WV=Object.prototype.toString,NA=new xo("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function ZV(n){if(null===n)return!0;var t,e,i,r,o,s=n;for(o=new Array(s.length),t=0,e=s.length;t<e;t+=1){if("[object Object]"!==WV.call(i=s[t])||1!==(r=Object.keys(i)).length)return!1;o[t]=[r[0],i[r[0]]]}return!0},construct:function YV(n){if(null===n)return[];var t,e,i,r,o,s=n;for(o=new Array(s.length),t=0,e=s.length;t<e;t+=1)i=s[t],r=Object.keys(i),o[t]=[r[0],i[r[0]]];return o}}),KV=Object.prototype.hasOwnProperty,OA=new xo("tag:yaml.org,2002:set",{kind:"mapping",resolve:function XV(n){if(null===n)return!0;var t,e=n;for(t in e)if(KV.call(e,t)&&null!==e[t])return!1;return!0},construct:function QV(n){return null!==n?n:{}}}),yw=IA.extend({implicit:[AA,PA],explicit:[FA,RA,NA,OA]}),hd=Object.prototype.hasOwnProperty,ej=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,tj=/[\x85\u2028\u2029]/,nj=/[,\[\]\{\}]/,UA=/^(?:!|!!|![a-z\-]+!)$/i,HA=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function VA(n){return Object.prototype.toString.call(n)}function dc(n){return 10===n||13===n}function Pf(n){return 9===n||32===n}function Bs(n){return 9===n||32===n||10===n||13===n}function xg(n){return 44===n||91===n||93===n||123===n||125===n}function ij(n){var t;return 48<=n&&n<=57?n-48:97<=(t=32|n)&&t<=102?t-97+10:-1}function rj(n){return 120===n?2:117===n?4:85===n?8:0}function oj(n){return 48<=n&&n<=57?n-48:-1}function jA(n){return 48===n?"\0":97===n?"\x07":98===n?"\b":116===n||9===n?"\t":110===n?"\n":118===n?"\v":102===n?"\f":114===n?"\r":101===n?"\x1b":32===n?" ":34===n?'"':47===n?"/":92===n?"\\":78===n?"\x85":95===n?"\xa0":76===n?"\u2028":80===n?"\u2029":""}function sj(n){return n<=65535?String.fromCharCode(n):String.fromCharCode(55296+(n-65536>>10),56320+(n-65536&1023))}for(var GA=new Array(256),qA=new Array(256),wg=0;wg<256;wg++)GA[wg]=jA(wg)?1:0,qA[wg]=jA(wg);function aj(n,t){this.input=n,this.filename=t.filename||null,this.schema=t.schema||yw,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=n.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function WA(n,t){var e={name:n.filename,buffer:n.input.slice(0,-1),position:n.position,line:n.line,column:n.position-n.lineStart};return e.snippet=function uV(n,t){if(t=Object.create(t||null),!n.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(n.buffer);)r.push(o.index),i.push(o.index+o[0].length),n.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var g,w,a="",G=Math.min(n.line+t.linesAfter,r.length).toString().length,me=t.maxLength-(t.indent+G+3);for(g=1;g<=t.linesBefore&&!(s-g<0);g++)w=mw(n.buffer,i[s-g],r[s-g],n.position-(i[s]-i[s-g]),me),a=Kr_repeat(" ",t.indent)+$w((n.line-g+1).toString(),G)+" | "+w.str+"\n"+a;for(w=mw(n.buffer,i[s],r[s],n.position,me),a+=Kr_repeat(" ",t.indent)+$w((n.line+1).toString(),G)+" | "+w.str+"\n",a+=Kr_repeat("-",t.indent+G+3+w.pos)+"^\n",g=1;g<=t.linesAfter&&!(s+g>=r.length);g++)w=mw(n.buffer,i[s+g],r[s+g],n.position-(i[s]-i[s+g]),me),a+=Kr_repeat(" ",t.indent)+$w((n.line+g+1).toString(),G)+" | "+w.str+"\n";return a.replace(/\n$/,"")}(e),new ms(t,e)}function pn(n,t){throw WA(n,t)}function eb(n,t){n.onWarning&&n.onWarning.call(null,WA(n,t))}var ZA={YAML:function(t,e,i){var r,o,s;null!==t.version&&pn(t,"duplication of %YAML directive"),1!==i.length&&pn(t,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&pn(t,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&pn(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=s<2,1!==s&&2!==s&&eb(t,"unsupported YAML version of the document")},TAG:function(t,e,i){var r,o;2!==i.length&&pn(t,"TAG directive accepts exactly two arguments"),o=i[1],UA.test(r=i[0])||pn(t,"ill-formed tag handle (first argument) of the TAG directive"),hd.call(t.tagMap,r)&&pn(t,'there is a previously declared suffix for "'+r+'" tag handle'),HA.test(o)||pn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch(s){pn(t,"tag prefix is malformed: "+o)}t.tagMap[r]=o}};function gd(n,t,e,i){var r,o,s,a;if(t<e){if(a=n.input.slice(t,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||pn(n,"expected valid JSON character");else ej.test(a)&&pn(n,"the stream contains non-printable characters");n.result+=a}}function YA(n,t,e,i){var r,o,s,a;for(Kr_isObject(e)||pn(n,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)hd.call(t,o=r[s])||(t[o]=e[o],i[o]=!0)}function Eg(n,t,e,i,r,o,s,a,g){var w,G;if(Array.isArray(r))for(w=0,G=(r=Array.prototype.slice.call(r)).length;w<G;w+=1)Array.isArray(r[w])&&pn(n,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===VA(r[w])&&(r[w]="[object Object]");if("object"==typeof r&&"[object Object]"===VA(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(w=0,G=o.length;w<G;w+=1)YA(n,t,o[w],e);else YA(n,t,o,e);else!n.json&&!hd.call(e,r)&&hd.call(t,r)&&(n.line=s||n.line,n.lineStart=a||n.lineStart,n.position=g||n.position,pn(n,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[r]=o,delete e[r];return t}function xw(n){var t;10===(t=n.input.charCodeAt(n.position))?n.position++:13===t?(n.position++,10===n.input.charCodeAt(n.position)&&n.position++):pn(n,"a line break is expected"),n.line+=1,n.lineStart=n.position,n.firstTabInLine=-1}function Lr(n,t,e){for(var i=0,r=n.input.charCodeAt(n.position);0!==r;){for(;Pf(r);)9===r&&-1===n.firstTabInLine&&(n.firstTabInLine=n.position),r=n.input.charCodeAt(++n.position);if(t&&35===r)do{r=n.input.charCodeAt(++n.position)}while(10!==r&&13!==r&&0!==r);if(!dc(r))break;for(xw(n),r=n.input.charCodeAt(n.position),i++,n.lineIndent=0;32===r;)n.lineIndent++,r=n.input.charCodeAt(++n.position)}return-1!==e&&0!==i&&n.lineIndent<e&&eb(n,"deficient indentation"),i}function tb(n){var e,t=n.position;return!(45!==(e=n.input.charCodeAt(t))&&46!==e||e!==n.input.charCodeAt(t+1)||e!==n.input.charCodeAt(t+2)||(t+=3,e=n.input.charCodeAt(t),0!==e&&!Bs(e)))}function ww(n,t){1===t?n.result+=" ":t>1&&(n.result+=Kr_repeat("\n",t-1))}function KA(n,t){var e,g,i=n.tag,r=n.anchor,o=[],a=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=o),g=n.input.charCodeAt(n.position);0!==g&&(-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,pn(n,"tab characters must not be used in indentation")),45===g&&Bs(n.input.charCodeAt(n.position+1)));)if(a=!0,n.position++,Lr(n,!0,-1)&&n.lineIndent<=t)o.push(null),g=n.input.charCodeAt(n.position);else if(e=n.line,Tg(n,t,3,!1,!0),o.push(n.result),Lr(n,!0,-1),g=n.input.charCodeAt(n.position),(n.line===e||n.lineIndent>t)&&0!==g)pn(n,"bad indentation of a sequence entry");else if(n.lineIndent<t)break;return!!a&&(n.tag=i,n.anchor=r,n.kind="sequence",n.result=o,!0)}function gj(n){var t,r,o,s,e=!1,i=!1;if(33!==(s=n.input.charCodeAt(n.position)))return!1;if(null!==n.tag&&pn(n,"duplication of a tag property"),60===(s=n.input.charCodeAt(++n.position))?(e=!0,s=n.input.charCodeAt(++n.position)):33===s?(i=!0,r="!!",s=n.input.charCodeAt(++n.position)):r="!",t=n.position,e){do{s=n.input.charCodeAt(++n.position)}while(0!==s&&62!==s);n.position<n.length?(o=n.input.slice(t,n.position),s=n.input.charCodeAt(++n.position)):pn(n,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!Bs(s);)33===s&&(i?pn(n,"tag suffix cannot contain exclamation marks"):(r=n.input.slice(t-1,n.position+1),UA.test(r)||pn(n,"named tag handle cannot contain such characters"),i=!0,t=n.position+1)),s=n.input.charCodeAt(++n.position);o=n.input.slice(t,n.position),nj.test(o)&&pn(n,"tag suffix cannot contain flow indicator characters")}o&&!HA.test(o)&&pn(n,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch(a){pn(n,"tag name is malformed: "+o)}return e?n.tag=o:hd.call(n.tagMap,r)?n.tag=n.tagMap[r]+o:"!"===r?n.tag="!"+o:"!!"===r?n.tag="tag:yaml.org,2002:"+o:pn(n,'undeclared tag handle "'+r+'"'),!0}function pj(n){var t,e;if(38!==(e=n.input.charCodeAt(n.position)))return!1;for(null!==n.anchor&&pn(n,"duplication of an anchor property"),e=n.input.charCodeAt(++n.position),t=n.position;0!==e&&!Bs(e)&&!xg(e);)e=n.input.charCodeAt(++n.position);return n.position===t&&pn(n,"name of an anchor node must contain at least one character"),n.anchor=n.input.slice(t,n.position),!0}function Tg(n,t,e,i,r){var o,s,a,me,ve,Ie,Oe,Ve,We,g=1,w=!1,G=!1;if(null!==n.listener&&n.listener("open",n),n.tag=null,n.anchor=null,n.kind=null,n.result=null,o=s=a=4===e||3===e,i&&Lr(n,!0,-1)&&(w=!0,n.lineIndent>t?g=1:n.lineIndent===t?g=0:n.lineIndent<t&&(g=-1)),1===g)for(;gj(n)||pj(n);)Lr(n,!0,-1)?(w=!0,a=o,n.lineIndent>t?g=1:n.lineIndent===t?g=0:n.lineIndent<t&&(g=-1)):a=!1;if(a&&(a=w||r),(1===g||4===e)&&(Ve=1===e||2===e?t:t+1,We=n.position-n.lineStart,1===g?a&&(KA(n,We)||function hj(n,t,e){var i,r,o,s,a,g,Ge,w=n.tag,G=n.anchor,me={},ve=Object.create(null),Ie=null,Oe=null,Ve=null,We=!1,Ye=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=me),Ge=n.input.charCodeAt(n.position);0!==Ge;){if(!We&&-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,pn(n,"tab characters must not be used in indentation")),i=n.input.charCodeAt(n.position+1),o=n.line,63!==Ge&&58!==Ge||!Bs(i)){if(s=n.line,a=n.lineStart,g=n.position,!Tg(n,e,2,!1,!0))break;if(n.line===o){for(Ge=n.input.charCodeAt(n.position);Pf(Ge);)Ge=n.input.charCodeAt(++n.position);if(58===Ge)Bs(Ge=n.input.charCodeAt(++n.position))||pn(n,"a whitespace character is expected after the key-value separator within a block mapping"),We&&(Eg(n,me,ve,Ie,Oe,null,s,a,g),Ie=Oe=Ve=null),Ye=!0,We=!1,r=!1,Ie=n.tag,Oe=n.result;else{if(!Ye)return n.tag=w,n.anchor=G,!0;pn(n,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Ye)return n.tag=w,n.anchor=G,!0;pn(n,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===Ge?(We&&(Eg(n,me,ve,Ie,Oe,null,s,a,g),Ie=Oe=Ve=null),Ye=!0,We=!0,r=!0):We?(We=!1,r=!0):pn(n,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),n.position+=1,Ge=i;if((n.line===o||n.lineIndent>t)&&(We&&(s=n.line,a=n.lineStart,g=n.position),Tg(n,t,4,!0,r)&&(We?Oe=n.result:Ve=n.result),We||(Eg(n,me,ve,Ie,Oe,Ve,s,a,g),Ie=Oe=Ve=null),Lr(n,!0,-1),Ge=n.input.charCodeAt(n.position)),(n.line===o||n.lineIndent>t)&&0!==Ge)pn(n,"bad indentation of a mapping entry");else if(n.lineIndent<t)break}return We&&Eg(n,me,ve,Ie,Oe,null,s,a,g),Ye&&(n.tag=w,n.anchor=G,n.kind="mapping",n.result=me),Ye}(n,We,Ve))||function dj(n,t){var i,r,o,a,G,me,ve,Ie,Ve,We,Ye,Ge,e=!0,s=n.tag,g=n.anchor,Oe=Object.create(null);if(91===(Ge=n.input.charCodeAt(n.position)))G=93,Ie=!1,a=[];else{if(123!==Ge)return!1;G=125,Ie=!0,a={}}for(null!==n.anchor&&(n.anchorMap[n.anchor]=a),Ge=n.input.charCodeAt(++n.position);0!==Ge;){if(Lr(n,!0,t),(Ge=n.input.charCodeAt(n.position))===G)return n.position++,n.tag=s,n.anchor=g,n.kind=Ie?"mapping":"sequence",n.result=a,!0;e?44===Ge&&pn(n,"expected the node content, but found ','"):pn(n,"missed comma between flow collection entries"),Ye=null,me=ve=!1,63===Ge&&Bs(n.input.charCodeAt(n.position+1))&&(me=ve=!0,n.position++,Lr(n,!0,t)),i=n.line,r=n.lineStart,o=n.position,Tg(n,t,1,!1,!0),We=n.tag,Ve=n.result,Lr(n,!0,t),Ge=n.input.charCodeAt(n.position),(ve||n.line===i)&&58===Ge&&(me=!0,Ge=n.input.charCodeAt(++n.position),Lr(n,!0,t),Tg(n,t,1,!1,!0),Ye=n.result),Ie?Eg(n,a,Oe,We,Ve,Ye,i,r,o):a.push(me?Eg(n,null,Oe,We,Ve,Ye,i,r,o):Ve),Lr(n,!0,t),44===(Ge=n.input.charCodeAt(n.position))?(e=!0,Ge=n.input.charCodeAt(++n.position)):e=!1}pn(n,"unexpected end of the stream within a flow collection")}(n,Ve)?G=!0:(s&&function fj(n,t){var e,i,G,me,r=1,o=!1,s=!1,a=t,g=0,w=!1;if(124===(me=n.input.charCodeAt(n.position)))i=!1;else{if(62!==me)return!1;i=!0}for(n.kind="scalar",n.result="";0!==me;)if(43===(me=n.input.charCodeAt(++n.position))||45===me)1===r?r=43===me?3:2:pn(n,"repeat of a chomping mode identifier");else{if(!((G=oj(me))>=0))break;0===G?pn(n,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?pn(n,"repeat of an indentation width identifier"):(a=t+G-1,s=!0)}if(Pf(me)){do{me=n.input.charCodeAt(++n.position)}while(Pf(me));if(35===me)do{me=n.input.charCodeAt(++n.position)}while(!dc(me)&&0!==me)}for(;0!==me;){for(xw(n),n.lineIndent=0,me=n.input.charCodeAt(n.position);(!s||n.lineIndent<a)&&32===me;)n.lineIndent++,me=n.input.charCodeAt(++n.position);if(!s&&n.lineIndent>a&&(a=n.lineIndent),dc(me))g++;else{if(n.lineIndent<a){3===r?n.result+=Kr_repeat("\n",o?1+g:g):1===r&&o&&(n.result+="\n");break}for(i?Pf(me)?(w=!0,n.result+=Kr_repeat("\n",o?1+g:g)):w?(w=!1,n.result+=Kr_repeat("\n",g+1)):0===g?o&&(n.result+=" "):n.result+=Kr_repeat("\n",g):n.result+=Kr_repeat("\n",o?1+g:g),o=!0,s=!0,g=0,e=n.position;!dc(me)&&0!==me;)me=n.input.charCodeAt(++n.position);gd(n,e,n.position,!1)}}return!0}(n,Ve)||function cj(n,t){var e,i,r;if(39!==(e=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,i=r=n.position;0!==(e=n.input.charCodeAt(n.position));)if(39===e){if(gd(n,i,n.position,!0),39!==(e=n.input.charCodeAt(++n.position)))return!0;i=n.position,n.position++,r=n.position}else dc(e)?(gd(n,i,r,!0),ww(n,Lr(n,!1,t)),i=r=n.position):n.position===n.lineStart&&tb(n)?pn(n,"unexpected end of the document within a single quoted scalar"):(n.position++,r=n.position);pn(n,"unexpected end of the stream within a single quoted scalar")}(n,Ve)||function uj(n,t){var e,i,r,o,s,a;if(34!==(a=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,e=i=n.position;0!==(a=n.input.charCodeAt(n.position));){if(34===a)return gd(n,e,n.position,!0),n.position++,!0;if(92===a){if(gd(n,e,n.position,!0),dc(a=n.input.charCodeAt(++n.position)))Lr(n,!1,t);else if(a<256&&GA[a])n.result+=qA[a],n.position++;else if((s=rj(a))>0){for(r=s,o=0;r>0;r--)(s=ij(a=n.input.charCodeAt(++n.position)))>=0?o=(o<<4)+s:pn(n,"expected hexadecimal character");n.result+=sj(o),n.position++}else pn(n,"unknown escape sequence");e=i=n.position}else dc(a)?(gd(n,e,i,!0),ww(n,Lr(n,!1,t)),e=i=n.position):n.position===n.lineStart&&tb(n)?pn(n,"unexpected end of the document within a double quoted scalar"):(n.position++,i=n.position)}pn(n,"unexpected end of the stream within a double quoted scalar")}(n,Ve)?G=!0:function _j(n){var t,e,i;if(42!==(i=n.input.charCodeAt(n.position)))return!1;for(i=n.input.charCodeAt(++n.position),t=n.position;0!==i&&!Bs(i)&&!xg(i);)i=n.input.charCodeAt(++n.position);return n.position===t&&pn(n,"name of an alias node must contain at least one character"),e=n.input.slice(t,n.position),hd.call(n.anchorMap,e)||pn(n,'unidentified alias "'+e+'"'),n.result=n.anchorMap[e],Lr(n,!0,-1),!0}(n)?(G=!0,(null!==n.tag||null!==n.anchor)&&pn(n,"alias node should not have any properties")):function lj(n,t,e){var r,o,s,a,g,w,G,Ie,me=n.kind,ve=n.result;if(Bs(Ie=n.input.charCodeAt(n.position))||xg(Ie)||35===Ie||38===Ie||42===Ie||33===Ie||124===Ie||62===Ie||39===Ie||34===Ie||37===Ie||64===Ie||96===Ie||(63===Ie||45===Ie)&&(Bs(r=n.input.charCodeAt(n.position+1))||e&&xg(r)))return!1;for(n.kind="scalar",n.result="",o=s=n.position,a=!1;0!==Ie;){if(58===Ie){if(Bs(r=n.input.charCodeAt(n.position+1))||e&&xg(r))break}else if(35===Ie){if(Bs(n.input.charCodeAt(n.position-1)))break}else{if(n.position===n.lineStart&&tb(n)||e&&xg(Ie))break;if(dc(Ie)){if(g=n.line,w=n.lineStart,G=n.lineIndent,Lr(n,!1,-1),n.lineIndent>=t){a=!0,Ie=n.input.charCodeAt(n.position);continue}n.position=s,n.line=g,n.lineStart=w,n.lineIndent=G;break}}a&&(gd(n,o,s,!1),ww(n,n.line-g),o=s=n.position,a=!1),Pf(Ie)||(s=n.position+1),Ie=n.input.charCodeAt(++n.position)}return gd(n,o,s,!1),!!n.result||(n.kind=me,n.result=ve,!1)}(n,Ve,1===e)&&(G=!0,null===n.tag&&(n.tag="?")),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):0===g&&(G=a&&KA(n,We))),null===n.tag)null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);else if("?"===n.tag){for(null!==n.result&&"scalar"!==n.kind&&pn(n,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+n.kind+'"'),me=0,ve=n.implicitTypes.length;me<ve;me+=1)if((Oe=n.implicitTypes[me]).resolve(n.result)){n.result=Oe.construct(n.result),n.tag=Oe.tag,null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);break}}else if("!"!==n.tag){if(hd.call(n.typeMap[n.kind||"fallback"],n.tag))Oe=n.typeMap[n.kind||"fallback"][n.tag];else for(Oe=null,me=0,ve=(Ie=n.typeMap.multi[n.kind||"fallback"]).length;me<ve;me+=1)if(n.tag.slice(0,Ie[me].tag.length)===Ie[me].tag){Oe=Ie[me];break}Oe||pn(n,"unknown tag !<"+n.tag+">"),null!==n.result&&Oe.kind!==n.kind&&pn(n,"unacceptable node kind for !<"+n.tag+'> tag; it should be "'+Oe.kind+'", not "'+n.kind+'"'),Oe.resolve(n.result,n.tag)?(n.result=Oe.construct(n.result,n.tag),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):pn(n,"cannot resolve a node with !<"+n.tag+"> explicit tag")}return null!==n.listener&&n.listener("close",n),null!==n.tag||null!==n.anchor||G}function mj(n){var e,i,r,s,t=n.position,o=!1;for(n.version=null,n.checkLineBreaks=n.legacy,n.tagMap=Object.create(null),n.anchorMap=Object.create(null);0!==(s=n.input.charCodeAt(n.position))&&(Lr(n,!0,-1),s=n.input.charCodeAt(n.position),!(n.lineIndent>0||37!==s));){for(o=!0,s=n.input.charCodeAt(++n.position),e=n.position;0!==s&&!Bs(s);)s=n.input.charCodeAt(++n.position);for(r=[],(i=n.input.slice(e,n.position)).length<1&&pn(n,"directive name must not be less than one character in length");0!==s;){for(;Pf(s);)s=n.input.charCodeAt(++n.position);if(35===s){do{s=n.input.charCodeAt(++n.position)}while(0!==s&&!dc(s));break}if(dc(s))break;for(e=n.position;0!==s&&!Bs(s);)s=n.input.charCodeAt(++n.position);r.push(n.input.slice(e,n.position))}0!==s&&xw(n),hd.call(ZA,i)?ZA[i](n,i,r):eb(n,'unknown document directive "'+i+'"')}Lr(n,!0,-1),0===n.lineIndent&&45===n.input.charCodeAt(n.position)&&45===n.input.charCodeAt(n.position+1)&&45===n.input.charCodeAt(n.position+2)?(n.position+=3,Lr(n,!0,-1)):o&&pn(n,"directives end mark is expected"),Tg(n,n.lineIndent-1,4,!1,!0),Lr(n,!0,-1),n.checkLineBreaks&&tj.test(n.input.slice(t,n.position))&&eb(n,"non-ASCII line breaks are interpreted as content"),n.documents.push(n.result),n.position===n.lineStart&&tb(n)?46===n.input.charCodeAt(n.position)&&(n.position+=3,Lr(n,!0,-1)):n.position<n.length-1&&pn(n,"end of the stream or a document separator is expected")}function XA(n,t){t=t||{},0!==(n=String(n)).length&&(10!==n.charCodeAt(n.length-1)&&13!==n.charCodeAt(n.length-1)&&(n+="\n"),65279===n.charCodeAt(0)&&(n=n.slice(1)));var e=new aj(n,t),i=n.indexOf("\0");for(-1!==i&&(e.position=i,pn(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)mj(e);return e.documents}var QA_load=function vj(n,t){var e=XA(n,t);if(0!==e.length){if(1===e.length)return e[0];throw new ms("expected a single document in the stream, but found more")}};function kw(n,t){return function(){throw new Error("Function yaml."+n+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var $P=QA_load;kw("safeLoad","load"),kw("safeLoadAll","loadAll"),kw("safeDump","dump");const vP=Object.getOwnPropertyNames(Object.prototype),mG=Object.getOwnPropertyNames(Array.prototype);let Mw=(()=>{class n{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,xn.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=$P(i);n.applyConfig(r)}catch(i){console.warn(i)}Qe.trigger("LOAD_CONFIG",n.appConfig)})()}loadYaml(){return(0,xn.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=n.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?vP.concat(mG):vP).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),n.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return n.appConfig={webrtc:{key:""},app:{title:"",mode:""}},n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var Aw;!function(n){n.resize=function t(e,i,r,o){let s=e.width,a=e.height,g=s/(i=Math.round(i)),w=a/(r=Math.round(r)),G=Math.ceil(g/2),me=Math.ceil(w/2),ve=e.getContext("2d"),Ie=ve.getImageData(0,0,s,a),Oe=ve.createImageData(i,r),Ve=Ie.data,We=Oe.data;for(let Ye=0;Ye<r;Ye++)for(let Ge=0;Ge<i;Ge++){let ct=4*(Ge+Ye*i),rt=0,ft=0,Lt=0,wt=0,Ht=0,Dt=0,At=0,qt=(Ye+.5)*w,li=Math.floor(Ye*w),Qn=Math.ceil((Ye+1)*w);for(let gi=li;gi<Qn;gi++){let Ri=Math.abs(qt-(gi+.5))/me,Pt=(Ge+.5)*g,Wt=Ri*Ri,tn=Math.floor(Ge*g),un=Math.ceil((Ge+1)*g);for(let Wn=tn;Wn<un;Wn++){let mi=Math.abs(Pt-(Wn+.5))/G,Mi=Math.sqrt(Wt+mi*mi);if(Mi>=1)continue;rt=2*Mi*Mi*Mi-3*Mi*Mi+1;let sr=4*(Wn+gi*s);At+=rt*Ve[sr+3],Lt+=rt,Ve[sr+3]<255&&(rt=rt*Ve[sr+3]/250),wt+=rt*Ve[sr],Ht+=rt*Ve[sr+1],Dt+=rt*Ve[sr+2],ft+=rt}}We[ct]=wt/ft,We[ct+1]=Ht/ft,We[ct+2]=Dt/ft,We[ct+3]=At/Lt}!0===o?(e.width=i,e.height=r):ve.clearRect(0,0,s,a),ve.putImageData(Oe,0,0)}}(Aw||(Aw={}));var vl,$G=ye(7412);!function(n){function r(){return(r=(0,xn.Z)(function*(g){return g instanceof Blob?o(g):a(g)})).apply(this,arguments)}function o(g){return s.apply(this,arguments)}function s(){return(s=(0,xn.Z)(function*(g){return a(yield n.readAsArrayBufferAsync(g))})).apply(this,arguments)}function a(g){let w=$G.create(g);return zk(w).toString()}n.readAsArrayBufferAsync=function t(g){return new Promise((w,G)=>{let me=new FileReader;me.onload=ve=>{w(me.result)},me.onabort=me.onerror=ve=>{G(ve)},me.readAsArrayBuffer(g)})},n.readAsTextAsync=function e(g){return new Promise((w,G)=>{let me=new FileReader;me.onload=ve=>{w(me.result)},me.onabort=me.onerror=ve=>{G(ve)},me.readAsText(g)})},n.calcSHA256Async=function i(g){return r.apply(this,arguments)}}(vl||(vl={}));var Wc,zr=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(zr||(zr={})),zr))();class Ot{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?zr.URL:this.blob===this.thumbnail.blob?zr.THUMBNAIL:zr.COMPLETE:zr.NULL}get isEmpty(){return this.state<=zr.NULL}static createEmpty(t){let e=new Ot;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new Ot;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new Ot;return e.apply(t),e}}static createAsync(t){return(0,xn.Z)(function*(){return t instanceof File?yield Ot._createAsync(t,t.name):t instanceof Blob?yield Ot._createAsync(t):void 0})()}static _createAsync(t,e){return(0,xn.Z)(function*(){let i=yield vl.readAsArrayBufferAsync(t),r=new Ot;r.context.identifier=yield vl.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Ot.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),!this.context.name&&t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==zr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),!this.context.thumbnail.blob&&t.thumbnail.blob&&(this.context.thumbnail.blob=t.thumbnail.blob),!this.context.thumbnail.type&&t.thumbnail.type&&(this.context.thumbnail.type=t.thumbnail.type),!this.context.thumbnail.url&&t.thumbnail.url&&(this.state!==zr.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=t.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==zr.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==zr.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(t){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,g=r.height*s,w=document.createElement("canvas"),G=w.getContext("2d");w.width=r.width,w.height=r.height,G.drawImage(r,0,0),Aw.resize(w,a,g,!0),w.toBlob(me=>{let ve={type:me.type,blob:me,url:window.URL.createObjectURL(me)};e(ve)},t.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=t.url})}}Ot.Empty=Ot.createEmpty("null");class xt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return xt._instance||(xt._instance=new xt),xt._instance}get images(){let t=[];for(let e in this.imageHash)t.push(this.imageHash[e]);return t}destroy(){for(let t in this.imageHash)this.delete(t)}addAsync(t){var e=this;return(0,xn.Z)(function*(){let i=yield Ot.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=Ot.create(t);else if(t instanceof Ot)e=t;else{if(this.update(t))return this.imageHash[t.identifier];e=Ot.create(t)}return this._add(e)}_add(t){return zr.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.imageHash[t.identifier]:(this.imageHash[t.identifier]=t,console.log("add Image: "+t.identifier),t)}update(t){let e;e=t instanceof Ot?t.toContext():t;let i=this.imageHash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.imageHash[t];return!!e&&(e.destroy(),delete this.imageHash[t],!0)}get(t){return this.imageHash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Qe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new cc(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of this.images)zr.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}class fc{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return fc._instance||(fc._instance=new fc),fc._instance}register(t,e){var i,r,o;e||(e=null!==(i=t.name)&&void 0!==i?i:null!==(o=null===(r=t.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==o?o:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(t)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",t):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,t),this.aliasMap.set(t,e))}create(t,e){let i=this.constructorMap.get(t);return i?new i(e):(console.error(t+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(t){var e;return null!==(e=this.aliasMap.get(t))&&void 0!==e?e:""}}function bP(n){return t=>{fc.instance.register(t,n)}}function Dg(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.context.syncData[t]},set:function i(r){this.context.syncData[t]=r,this.update()},enumerable:!0,configurable:!0})}}!function(n){const t=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function G(ve){return e[ve]}function me(ve){return r[ve]}n.xml2element=function s(ve){let Ie=new DOMParser,Oe=null;try{ve=function w(ve){return ve.replace(o,"").trim()}(ve),Oe=Ie.parseFromString(ve,"application/xml"),Oe.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",Oe.documentElement),Oe=null)}catch(Ve){console.error(Ve)}return Oe?Oe.documentElement:null},n.encodeEntityReference=function a(ve){return ve.replace(t,G)},n.decodeEntityReference=function g(ve){return ve.replace(i,me)}}(Wc||(Wc={}));const bG=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Ji{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return Ji._instance||(Ji._instance=new Ji),Ji._instance}toXml(t){let e="",i="toAttributes"in t?t.toAttributes():Ji.toAttributes(t.toContext().syncData),r=t.aliasName,o="";for(let s in i){let a=Wc.encodeEntityReference(i[s]+"");null!=a&&(o+=" "+s+'="'+a+'"')}return e+=`<${r+o}>`,e+="innerXml"in t?t.innerXml():"",e+=`</${r}>`,e}static toAttributes(t){let e={};for(let i in t){let s=Ji.make2Attributes(t[i],i);for(let a in s)e[a]=s[a]}return e}static make2Attributes(t,e){let i={};if(Array.isArray(t)){let r=Ji.array2attributes(t,e);for(let o in r)i[o]=r[o]}else if("object"==typeof t){let r=Ji.object2attributes(t,e);for(let o in r)i[o]=r[o]}else i[e]=t;return i}static object2attributes(t,e){let i={};for(let r in t){let a=Ji.make2Attributes(t[r],e+"."+r);for(let g in a)i[g]=a[g]}return i}static array2attributes(t,e){let i={},r=t.length;for(let o=0;o<r;o++){let g=Ji.make2Attributes(t[o],e+"."+o);for(let w in g)i[w]=g[w]}return i}parseXml(t){let e=null;if(e="string"==typeof t?Wc.xml2element(t):t,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=fc.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();Ji.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(t,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Wc.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],g=t,w=s.find(me=>bG.includes(me));null==w?1<s.length&&(({obj:g,key:a}=Ji.attributes2object(s,g,a)),null==a)||("string"!=typeof g[a]&&null!=g[a]&&(o=JSON.parse(o)),g[a]=o):console.log(`skip invalid key (${w})`)}return t}static attributes2object(t,e,i){let r=null,o=t.length;for(let s=0;s<o;s++){let a=parseInt(t[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?t[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(t){return null}}class Xe{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Xe._instance||(Xe._instance=new Xe),Xe._instance}add(t,e=!0){return null!=this.get(t.identifier)||this.isDeleted(t.identifier)?null:(this.identifierMap.set(t.identifier,t),(this.aliasNameMap.has(t.aliasName)?this.aliasNameMap.get(t.aliasName):this.aliasNameMap.set(t.aliasName,new Map).get(t.aliasName)).set(t.identifier,t),t.onStoreAdded(),e&&this.update(t.toContext()),t)}remove(t){if(!this.identifierMap.has(t.identifier))return null;this.identifierMap.delete(t.identifier);let e=this.aliasNameMap.get(t.aliasName);return e&&e.delete(t.identifier),t.onStoreRemoved(),t}delete(t,e=!0){let i=null,r=null;return"string"==typeof t?(i=this.get(t),r=t):(i=t,r=t.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(t,e){return console.log("\u5186\u67f1\u3000_delete:"+t.aliasName),null===this.remove(t)?null:(e&&Qe.call("DELETE_GAME_OBJECT",{aliasName:t.aliasName,identifier:t.identifier}),t)}markForDelete(t){console.log("\u5186\u67f1\u3000markForDelete"+t),this.garbageMap.set(t,performance.now()),this.garbageCollection(6e5)}get(t){return this.identifierMap.has(t)?this.identifierMap.get(t):null}getObjects(t){if(null==t)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof t?t:t.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(t){let e=null;if("string"==typeof t){let i=this.get(t);i&&(e=i.toContext())}else e=t;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Qe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Yo(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(t){return null!=this.garbageMap.get(t)}getCatalog(){let t=[];for(let e of this.identifierMap.values())t.push({identifier:e.identifier,version:e.version});return t}clearDeleteHistory(){this.garbageMap.clear()}dispGarbageMap(){for(let t of this.garbageMap)console.log("garbageMap \u5c65\u6b74:"+t)}garbageCollection(t){"number"==typeof t?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(t)):this.garbageMap.delete(t.identifier)}_garbageCollection(t){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;let s=o.value[0];o.value[1]+t<e||this.garbageMap.delete(s)}}}class ca{constructor(t=fd.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=t}static get aliasName(){return fc.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Xe.instance.add(this)}destroy(){Xe.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Xe.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(t){null!==t&&this.identifier===t.identifier&&(this.context.majorVersion=t.majorVersion,this.context.minorVersion=t.minorVersion,this.context.syncData=t.syncData)}clone(){let t=this.toXml();return Ji.instance.parseXml(t)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:yP(this.context.syncData)}}toXml(){return Ji.instance.toXml(this)}}function yP(n){if(null==n)return n;let t=Array.isArray(n)?[]:{},e=Object.getOwnPropertyNames(n);for(let i of e){let r=typeof n[i];null!=n[i]&&"object"===r?t[i]=yP(n[i]):"function"!==r&&(t[i]=n[i])}return t}var hc;let Si=hc=class extends ca{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(t){this.majorIndex=0|t,this.minorIndex=t-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Xe.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Xe.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Xe.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((t,e)=>t.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let t of this._children.concat())t.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(t){}onChildRemoved(t){}_onChildAdded(t){let e=this;for(;e&&(e.onChildAdded(t),e=e.parent,e!==this););}_onChildRemoved(t){let e=this;for(;e&&(e.onChildRemoved(t),e=e.parent,e!==this););}initializeChildren(){if(null==hc.unknownNodes[this.identifier])return;let t=hc.unknownNodes[this.identifier];for(let e of t)e.parent===this&&this.updateChildren(e);hc.unknownNodes[this.identifier]&&delete hc.unknownNodes[this.identifier]}updateChildren(t=this){let e=this._children.indexOf(t),i=!1,r=t.parent===this;if(e<0&&r)this._children.push(t),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(t);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>t.index||t.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(t))}updateIndexs(){let t=this.children;for(let e=0;e<t.length;e++)t[e].majorIndex=e,t[e].minorIndex=Math.random()}appendChild(t){if(t.contains(this))return null;t.parent&&t.parent!==this&&t.parent.removeChild(t);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return t.parentIdentifier=this.identifier,t.majorIndex=e,t.minorIndex=Math.random(),this.updateChildren(t),t}insertBefore(t,e){if(t.contains(this))return null;if(t===e&&t.parent===this)return t;t.parent&&t.parent!==this&&t.parent.removeChild(t);let i=this.children.indexOf(e);if(i<0)return this.appendChild(t);t.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return t.majorIndex=0|s,t.minorIndex=s-t.majorIndex,this.updateChildren(t),o<1e-7&&this.updateIndexs(),t}removeChild(t){return this.children.indexOf(t)<0?null:(t.parentIdentifier="",t.majorIndex=0,t.minorIndex=Math.random(),this.updateChildren(t),t)}contains(t){let e=t.parent;for(;e;){if(e===t)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",t),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(t,e){this.attributes[t]=e,this.update()}getAttribute(t){return null==this.attributes[t]?"":this.attributes[t]}removeAttribute(t){delete this.attributes[t],this.update()}toAttributes(){return Ji.toAttributes(this.attributes)}parseAttributes(t){Ji.parseAttributes(this.attributes,t)}innerXml(){let t="";t+=Wc.encodeEntityReference(this.value+"");for(let e of this.children)t+=Ji.instance.toXml(e);return t}parseInnerXml(t){let e=t.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=Ji.instance.parseXml(e[r]);o instanceof hc&&this.appendChild(o)}else this.value=Wc.decodeEntityReference(t.innerHTML)}apply(t){let e=this.parent;super.apply(t),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in hc.unknownNodes||(hc.unknownNodes[this.parentIdentifier]=[]),hc.unknownNodes[this.parentIdentifier].push(this))}};function ai(n){return t=>{bP(n)(t)}}function st(){return(n,t)=>{n instanceof Si?function vG(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.getAttribute(t)},set:function i(r){this.setAttribute(t,r)},enumerable:!0,configurable:!0})}}()(n,t):Dg()(n,t)}}Si.unknownNodes={},be([Dg()],Si.prototype,"value",void 0),be([Dg()],Si.prototype,"attributes",void 0),be([Dg()],Si.prototype,"parentIdentifier",void 0),be([Dg()],Si.prototype,"majorIndex",void 0),be([Dg()],Si.prototype,"minorIndex",void 0),Si=hc=be([bP("node")],Si);let fo=class extends Si{constructor(){super(...arguments),this.fixd=!1,this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(t){this.value=t}get timestamp(){let t=this.getAttribute("timestamp"),e=t?+t:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return xt.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===$t.peerContext.userId||this.originFrom===$t.peerContext.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf($t.peerContext.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}get chatTabList(){return Xe.instance.get("ChatTabList")}get isSystemToPL(){return-1<this.tags.indexOf("to-pl-system-message")}get changeable(){return this.from==$t.peerContext.userId&&"\u30b7\u30b9\u30c6\u30e0\u30e1\u30c3\u30bb\u30fc\u30b8"!=this.name}};be([st()],fo.prototype,"originFrom",void 0),be([st()],fo.prototype,"from",void 0),be([st()],fo.prototype,"to",void 0),be([st()],fo.prototype,"name",void 0),be([st()],fo.prototype,"tag",void 0),be([st()],fo.prototype,"dicebot",void 0),be([st()],fo.prototype,"imageIdentifier",void 0),be([st()],fo.prototype,"imagePos",void 0),be([st()],fo.prototype,"messColor",void 0),be([st()],fo.prototype,"sendFrom",void 0),be([st()],fo.prototype,"fixd",void 0),fo=be([ai("chat")],fo);let Ha=class extends Si{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.pos_num=-1,this.imageIdentifier=["a","b","c","d","e","f","g","h","i","j","k","l"],this.imageCharactorName=["#0","#1","#2","#3","#4","#5","#6","#7","#8","#9","#10","#11"],this.imageIdentifierZpos=[0,1,2,3,4,5,6,7,8,9,10,11],this.count=0,this.imageIdentifierDummy="test",this._displayableMessageNum=0,this.imageDispFlag=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],this.chatSimpleDispFlag=0,this.tachieDispFlag=1,this._dispCharctorIcon=!0,this._unreadLength=0}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}displayableMessagesLength(){return this._displayableMessageNum}tachieReset(){this.imageIdentifier=["a","b","c","d","e","f","g","h","i","j","k","l"],this.imageCharactorName=["#0","#1","#2","#3","#4","#5","#6","#7","#8","#9","#10","#11"],this.imageIdentifierZpos=[0,1,2,3,4,5,6,7,8,9,10,11],this.imageIdentifierDummy="test"}get chatMessages(){return this.children}get imageZposList(){return this.imageIdentifierZpos.slice()}getImageCharactorPos(t){for(let e=0;e<this.imageCharactorName.length;e++)if(t==this.imageCharactorName[e])return e;return-1}tachiePosHide(t){this.imageDispFlag[t]=!1,console.log(this.imageDispFlag)}tachiePosIsDisp(t){return this.imageDispFlag[t]}tachieZindex(t){return this.imageIdentifierZpos.indexOf(Number(t))}replaceTachieZindex(t){let e=this.imageIdentifierZpos.indexOf(Number(t));e>=0&&(this.imageIdentifierZpos.splice(e,1),this.imageIdentifierZpos.push(Number(t)))}get dispCharctorIcon(){return this._dispCharctorIcon}set dispCharctorIcon(t){this._dispCharctorIcon=t}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let t=this.chatMessages.length-1;return t<0?0:this.chatMessages[t].timestamp}onChildAdded(t){super.onChildAdded(t),t.parent===this&&t instanceof fo&&t.isDisplayable&&(1==this.children.length?(this._unreadLength=1,this._displayableMessageNum=1):(this._unreadLength++,this._displayableMessageNum++),null!=t.to&&""!==t.to||(this.imageDispFlag[t.imagePos]=!0),Qe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:t.identifier}))}addMessage(t,e){t.tabIdentifier=this.identifier;let i=new fo;for(let o in t)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){i.value=t[o];continue}if(null!=t[o]&&""!==t[o]){if("imagePos"===o){if(null!=t.to&&""!==t.to)continue;if(this.pos_num=t[o],0<=this.pos_num&&this.pos_num<this.imageIdentifier.length){let s=this.getImageCharactorPos(t.name);s>=0&&(this.imageIdentifier[s]="",this.imageCharactorName[s]="",this.imageDispFlag[s]=!1),""==t.imageIdentifier||(this.imageIdentifier[this.pos_num]=t.imageIdentifier,this.imageCharactorName[this.pos_num]=t.name,this.replaceTachieZindex(this.pos_num),this.imageDispFlag[this.pos_num]=!0,i.setAttribute(o,t[o])),this.imageIdentifierDummy=t.imageIdentifier}continue}i.setAttribute(o,t[o])}}i.initialize(),0>i.tags.indexOf("secret")&&this.cutInLauncher.chatActivateCutIn(i.text,t.to);let r=!1;if(e&&e.length>=1&&(r=!0),r)for(let o of e)Qe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTrget:o});else Qe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTrget:null});return Qe.trigger("DICE_TABLE_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier}),Qe.trigger("RESOURCE_EDIT_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier,messageTargetContext:e||null}),Qe.trigger("APRIL_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:i.identifier}),this.appendChild(i),i}markForRead(){this._unreadLength=0}innerXml(){let t="";for(let e of this.children)e instanceof fo&&!e.isDisplayable||(t+=Ji.instance.toXml(e));return t}messageHtml(t,e,i){let r="";if(i){if(e&&(r+="["+this.escapeHtml(e)+"]"),t){let s=new Date(i.timestamp);r+=("00"+s.getHours()).slice(-2)+":"+("00"+s.getMinutes()).slice(-2)+"\uff1a"}r+="<font color='",i.messColor&&(r+=i.messColor.toLowerCase()),r+="'>",r+="<b>",i.name&&(r+=this.escapeHtml(i.name)),r+="</b>",r+="\uff1a",!i.isSecret||i.isSendFromSelf?i.text&&(r+=this.escapeHtml(i.text).replace(/\n/g,"<br>")):r+="\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let o="";i.fixd&&(o=" (\u7de8\u96c6\u6e08)"),r+=o,r+="</font><br>",r+="\n"}return r}messageHtmlCoc(t,e){let i="";if(e){i+='    <p style="color:'+e.messColor.toLowerCase()+';">\n',i+="      <span> ["+t+"]</span>\n",i+="      <span>"+this.escapeHtml(e.name).replace("<","").replace(">","")+"</span>\n",i+="      <span>\n",i+="        ",!e.isSecret||e.isSendFromSelf?e.text&&(i+=this.escapeHtml(e.text).replace(/\n/g,"<br>").replace(/\u2192/g,"\uff1e")):i+="\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let r="";e.fixd&&(r=" (\u7de8\u96c6\u6e08)"),i+=r,i+="\n",i+="      </span>\n",i+="    </p>\n",i+="    \n"}return i}escapeHtml(t){return"string"!=typeof t?t:t.replace(/[&'`"<>]/g,function(i){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[i]}).replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rt>$2</rt></ruby>").replace(/\\s/g," ")}logHtml(){let t="<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>\n<html xmlns='http://www.w3.org/1999/xhtml' lang='ja'>\n  <head>\n    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />\n    <title>\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a"+this.escapeHtml(this.name)+"</title>\n  </head>\n  <body>\n",i="";for(let o of this.chatMessages){let s=o.to,a=o.from,g=$t.peerContext.userId;console.log("from:"+o.from+" To:"+o.to+"myId:"+g),(!s||s==g||a==g)&&(i+=this.messageHtml(!0,"",o))}return t+i+"\n  </body>\n</html>"}logHtmlCoc(){let i="";for(let o of this.chatMessages){let s=o.to,a=o.from,g=$t.peerContext.userId;console.log("from:"+o.from+" To:"+o.to+"myId:"+g),(!s||s==g||a==g)&&(i+=this.messageHtmlCoc(this.escapeHtml(this.name),o))}return'<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>udonaliumlily - logs</title>\n  </head>\n  <body>\n   \n'+i+"  </body>\n</html>"}parseInnerXml(t){return super.parseInnerXml(t)}};var Va;be([st()],Ha.prototype,"name",void 0),be([st()],Ha.prototype,"pos_num",void 0),be([st()],Ha.prototype,"imageIdentifier",void 0),be([st()],Ha.prototype,"imageCharactorName",void 0),be([st()],Ha.prototype,"imageIdentifierZpos",void 0),be([st()],Ha.prototype,"count",void 0),be([st()],Ha.prototype,"imageIdentifierDummy",void 0),Ha=be([ai("chat-tab")],Ha);let Ls=Va=class extends Si{constructor(){super(...arguments),this._systemMessageTabIndex=0,this.tachieHeightValue=200,this.minTachieSize=100,this.maxTachieSize=500,this.isTachieInWindow=!1,this.isKeepTachieOutWindow=!1,this.simpleDispFlagTime_=0,this.simpleDispFlagUserId_=0}set systemMessageTabIndex(t){this._systemMessageTabIndex=t}get systemMessageTabIndex(){return this._systemMessageTabIndex}get systemMessageTab(){return this.chatTabs.length>this.systemMessageTabIndex?this.chatTabs[this.systemMessageTabIndex]:null}get reloadCheck(){return Xe.instance.get("ReloadCheck")}static get instance(){return Va._instance||(Va._instance=new Va("ChatTabList"),Va._instance.initialize()),Va._instance}get chatTabs(){return this.children}set simpleDispFlagTime(t){this.simpleDispFlagTime_=t}get simpleDispFlagTime(){return this.simpleDispFlagTime_}set simpleDispFlagUserId(t){this.simpleDispFlagUserId_=t}get simpleDispFlagUserId(){return this.simpleDispFlagUserId_}addChatTab(...t){let e=null;if(t[0]instanceof Ha)e=t[0];else{let i=t[0];e=new Ha(t[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(t){let e=!0;if(e=this.reloadCheck.answerCheck(),e){for(let r of Va.instance.children)r.destroy();let i=Va.instance.toContext();i.syncData=this.toContext().syncData,Va.instance.apply(i),Va.instance.update(),super.parseInnerXml.apply(Va.instance,[t]),this.destroy()}}logHtml(){let i="";if(this.chatTabs){let o=this.chatTabs.length,s=[];console.log("tabNum :"+o);for(let w=0;w<o;w++)s.push(0);let a=null,g=null;for(;;){a=-1,g=-1;for(let ve=0;ve<o;ve++)this.chatTabs[ve].chatMessages.length<=s[ve]||(-1==g&&(g=this.chatTabs[ve].chatMessages[s[ve]].timestamp,a=ve),g>this.chatTabs[ve].chatMessages[s[ve]].timestamp&&(g=this.chatTabs[ve].chatMessages[s[ve]].timestamp,a=ve));if(-1==a)break;let w=this.chatTabs[a].chatMessages[s[a]].to,G=this.chatTabs[a].chatMessages[s[a]].from,me=$t.peerContext.userId;w&&w!=me&&G!=me?(console.log(" SKIP "+G+" > "+w+" : "+this.chatTabs[a].chatMessages[s[a]].text),s[a]++):(i+=this.chatTabs[a].messageHtml(!!this.simpleDispFlagTime,this.chatTabs[a].name,this.chatTabs[a].chatMessages[s[a]]),s[a]++)}}return"<?xml version='1.0' encoding='UTF-8'?>\n<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>\n<html xmlns='http://www.w3.org/1999/xhtml' lang='ja'>\n  <head>\n    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />\n    <title>\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u30bf\u30d6</title>\n  </head>\n  <body>\n"+i+"\n  </body>\n</html>"}logHtmlCoc(){let i="";if(this.chatTabs){let o=this.chatTabs.length,s=[];console.log("tabNum :"+o);for(let w=0;w<o;w++)s.push(0);let a=null,g=null;for(;;){a=-1,g=-1;for(let ve=0;ve<o;ve++)this.chatTabs[ve].chatMessages.length<=s[ve]||(-1==g&&(g=this.chatTabs[ve].chatMessages[s[ve]].timestamp,a=ve),g>this.chatTabs[ve].chatMessages[s[ve]].timestamp&&(g=this.chatTabs[ve].chatMessages[s[ve]].timestamp,a=ve));if(-1==a)break;let w=this.chatTabs[a].chatMessages[s[a]].to,G=this.chatTabs[a].chatMessages[s[a]].from,me=$t.peerContext.userId;w&&w!=me&&G!=me?(console.log(" SKIP "+G+" > "+w+" : "+this.chatTabs[a].chatMessages[s[a]].text),s[a]++):(i+=this.chatTabs[a].messageHtmlCoc(this.chatTabs[a].name,this.chatTabs[a].chatMessages[s[a]]),s[a]++)}}return'<!DOCTYPE html>\n<html lang="ja">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <meta http-equiv="X-UA-Compatible" content="ie=edge" />\n    <title>udonaliumlily - logs</title>\n  </head>\n  <body>\n   \n'+i+"\n  </body>\n</html>"}};var wo;be([st()],Ls.prototype,"_systemMessageTabIndex",void 0),Ls=Va=be([ai("chat-tab-list")],Ls),function(n){n.toHalfWidth=function t(e){return e.replace(/[\uff01-\uff5e]/g,i=>String.fromCharCode(i.charCodeAt(0)-65248))}}(wo||(wo={}));let Zc=class extends Si{constructor(){super(...arguments),this.dicebot="DiceBot",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}isPaletteIndex(t,e){let i={name:"",line:0},r=t.match(/^\/\/--[-]+(.*)$/),o=t.match(/^\u25c6(.*)$/);return r?(i.name=r[1].replace(/-+$/,""),i.line=e,i):o?(i.name=o[1],i.line=e,i):null}get paletteIndex(){let e,t=0,i=[],o=this.value.split("\n");for(let s of o)e=this.isPaletteIndex(s,t),e&&i.push(e),t++;return i}paletteMatch(t){let i=[],o=this.value.split("\n");for(let s of o)s.indexOf(t)>=0&&i.push(s);return i}paletteMatchLine(t,e){let i=0,r=0,s=this.value.split("\n");for(let a of s){if(a.indexOf(t)>=0){if(i==e)return r;i++}r++}return-1}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(t){this.value=t,this.isAnalized=!1}checkTargetCharactor(t){let e=!!t.match(/[tT\uff54\uff34][{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g);return t.match(/^[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(e=!0),t.match(/\s[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(e=!0),t.match(/^[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(e=!0),t.match(/\s[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(e=!0),console.log("\u8907\u6570\u5bfe\u8c61\u7528\u30b3\u30de\u30f3\u30c9\uff1a"+e),e}evaluate(t,e,i){let r="";r="string"==typeof t?t:t.palette,console.log(r);let s=0,a=!0;for(;a;)s++,a=!1,r=r.replace(/[tT\uff54\uff34]?[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(g,w)=>{let G=!1,me=(w=wo.toHalfWidth(w)).match(/(.+)([\^\uff3e]$)/);if(me&&(w=me[1],G=!0),a=!0,g.match(/^[tT\uff54\uff34].*/)){for(let ve of i.chatPalette.paletteVariables)if(ve.name==w)return ve.value.replace(/[{\uff5b]/g,"t{");if(i){let ve=i.rootDataElement.getFirstElementByName(w);if(ve){let Ie="";return Ie=G&&ve.isNumberResource?ve.value+"":ve.isNumberResource?ve.currentValue+"":ve.value+"",Ie.match(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g)&&(Ie=Ie.replace(/[{\uff5b]/g,"t{")),Ie}}}else{for(let ve of this.paletteVariables)if(ve.name==w)return ve.value;if(e){let ve=e.getFirstElementByName(w);if(ve)return G&&ve.isNumberResource?ve.value+"":ve.isNumberResource?ve.currentValue+"":ve.value+""}}return""}),128<s&&(a=!1);return r}parse(t){this._palettes=t.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(t){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(t);return e?{name:wo.toHalfWidth(e[1]),value:e[2]}:null}apply(t){super.apply(t),this.isAnalized=!1}};be([st()],Zc.prototype,"dicebot",void 0),Zc=be([ai("chat-palette")],Zc);let rb=class extends Zc{};rb=be([ai("buff-palette")],rb);let jm=class extends Zc{};var Ff;jm=be([ai("dice-table-palette")],jm);let yt=Ff=class extends Si{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(t,e="",i={},r=""){let o;return o=r&&0<r.length?new Ff(r):new Ff,o.attributes=i,o.name=t,o.value=e,o.initialize(),o}getElementsByName(t){let e=[];for(let i of this.children)i instanceof Ff&&(i.getAttribute("name")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(t)));return e}getElementsByType(t){let e=[];for(let i of this.children)i instanceof Ff&&(i.getAttribute("type")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(t)));return e}getFirstElementByName(t){for(let e of this.children)if(e instanceof Ff){if(e.getAttribute("name")===t)return e;let i=e.getFirstElementByName(t);if(i)return i}return null}get myIdentifer(){return this.identifier}get nowValueColor(){if((this.name.match(/^[Ss\uff33\uff53][Aa\uff21\uff41][Nn\uff2en]$/i)||this.name.match(/^\u6b63\u6c17\u5ea6$/i))&&this.isNumberResource){let t=this.currentValue,e=this.value;if(t<=4*e/5&&t==this.currentValue&&e==this.value)return"#D22"}return"#444"}};be([st()],yt.prototype,"name",void 0),be([st()],yt.prototype,"type",void 0),be([st()],yt.prototype,"currentValue",void 0),yt=Ff=be([ai("data")],yt);let Xr=class extends Si{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Ot.Empty,this._dataElements={},this.isAltitudeIndicate=!1}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let t of this.children)if(t.getAttribute("name")===this.aliasName)return t;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get buffDataElement(){return this.getElement("buff")}addBuffDataElement(){this.buffDataElement||this.rootDataElement.appendChild(yt.create("buff","",{},"buff_"+this.identifier))}get imageFile(){if(!this.imageDataElement)return this._imageFile;let t=this.imageDataElement.getFirstElementByName("imageIdentifier");if(t&&this._imageFile.identifier!==t.value){let e=xt.instance.get(t.value);this._imageFile=e||Ot.Empty}return this._imageFile}get altitude(){let t=this.getElement("altitude",this.commonDataElement);!t&&this.commonDataElement&&this.commonDataElement.appendChild(yt.create("altitude",0,{},"altitude_"+this.identifier));let e=t?+t.value:0;return Number.isNaN(e)?0:e}set altitude(t){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=t)}createDataElements(){this.initialize();let t=this.aliasName;if(!this.rootDataElement){let e=yt.create(t,"",{},t+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(yt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(yt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(yt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(yt.create("detail","",{},"detail_"+this.identifier)),this.buffDataElement||this.rootDataElement.appendChild(yt.create("buff","",{},"buff_"+this.identifier))}getElement(t,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[t]?Xe.instance.get(this._dataElements[t]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(t),this._dataElements[t]=i?i.identifier:null),i}getCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);!i||(i.value=e)}getImageFile(t){if(!this.imageDataElement)return null;let e=this.getElement(t,this.imageDataElement);return e?xt.instance.get(e.value):null}setImageFile(t,e){let i=e?this.getElement(t,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(t){this.location.name=t,this.update()}};var ob;be([st()],Xr.prototype,"location",void 0),be([st()],Xr.prototype,"posZ",void 0),be([st()],Xr.prototype,"isAltitudeIndicate",void 0),Xr=be([ai("TabletopObject")],Xr);let Bt=ob=class extends Xr{constructor(t=fd.generateUuid()){super(t),this.isLock=!1,this.rotate=0,this.roll=0,this.isDropShadow=!1,this.hideInventory=!1,this.nonTalkFlag=!1,this.overViewWidth=270,this.overViewMaxHeight=250,this.specifyKomaImageFlag=!1,this.komaImageHeignt=100,this.chatColorCode=["#000000","#FF0000","#0099FF"],this.syncDummyCounter=0,this._targeted=!1,this._selectedTachieNum=0,this.isAltitudeIndicate=!0}get targeted(){return this._targeted}set targeted(t){this._targeted=t}get selectedTachieNum(){return this._selectedTachieNum>this.imageDataElement.children.length-1&&(this._selectedTachieNum=this.imageDataElement.children.length-1),this._selectedTachieNum<0&&(this._selectedTachieNum=0),this._selectedTachieNum}set selectedTachieNum(t){console.log("set selectedTachieNum NUM="+t+" len"+this.imageDataElement.children.length),t>this.imageDataElement.children.length-1&&(t=this.imageDataElement.children.length-1),t<0&&(t=0),this._selectedTachieNum=t,console.log("set selectedTachieNum"+this._selectedTachieNum)}getIconNumElement(){const t=this.detailDataElement.getFirstElementByName("ICON");return t&&t.isNumberResource?t:null}get imageFile(){if(!this.imageDataElement)return Ot.Empty;const t=this.getIconNumElement();if(t){let e=t.currentValue;return e>this.imageDataElement.children.length-1&&(e=this.imageDataElement.children.length-1),xt.instance.get(this.imageDataElement.children[e].value)||Ot.Empty}{const e=this.imageDataElement.getFirstElementByName("imageIdentifier");return xt.instance.get(e.value)||Ot.Empty}}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let t of this.children)if(t instanceof Zc)return t;return null}set name(t){this.setCommonValue("name",t)}TestExec(){console.log("TestExec")}get remoteController(){for(let t of this.children)if(t instanceof rb)return t;return null}static create(t,e,i){let r=new ob;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(t,e,i),r}addExtendData(){if(this.addBuffDataElement(),0==this.detailDataElement.getElementsByName("\u7acb\u3061\u7d75\u4f4d\u7f6e").length){let r=yt.create("\u7acb\u3061\u7d75\u4f4d\u7f6e","",{},"\u7acb\u3061\u7d75\u4f4d\u7f6e"+this.identifier);this.detailDataElement.appendChild(r),r.appendChild(yt.create("POS",11,{type:"numberResource",currentValue:"0"},"POS_"+this.identifier))}if(0==this.detailDataElement.getElementsByName("\u30b3\u30de\u753b\u50cf").length){let r=yt.create("\u30b3\u30de\u753b\u50cf","",{},"\u30b3\u30de\u753b\u50cf"+this.identifier);this.detailDataElement.appendChild(r);let o=this.detailDataElement.getElementsByName("\u7acb\u3061\u7d75\u4f4d\u7f6e");if(0!=o.length){let s=o[0].parent,a=s.children.indexOf(o[0]);if(console.log("\u7acb\u3061\u7d75\u306e\u6b21\u306b\u5dee\u3057\u8fbc\u307f INdex"+a),a<s.children.length-1){let g=s.children[a+1];console.log("\u7acb\u3061\u7d75\u306e\u6b21\u306b\u5dee\u3057\u8fbc\u307f nextElement"+g),s.insertBefore(r,g)}}r.appendChild(yt.create("ICON",this.imageDataElement.children.length-1,{type:"numberResource",currentValue:0},"ICON_"+this.identifier))}if(0==this.buffDataElement.getElementsByName("\u30d0\u30d5/\u30c7\u30d0\u30d5").length){let r=yt.create("\u30d0\u30d5/\u30c7\u30d0\u30d5","",{},"\u30d0\u30d5/\u30c7\u30d0\u30d5"+this.identifier);this.buffDataElement.appendChild(r)}if(null==this.remoteController){let r=new rb("RemotController_"+this.identifier);r.setPalette("\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u5165\u529b\u4f8b\uff1a\n\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc DB+2 3\n\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4 A 18\n\u30bb\u30a4\u30af\u30ea\u30c3\u30c9\u30a6\u30a7\u30dd\u30f3 \u547d+1\u653b+2 18"),r.initialize(),this.appendChild(r)}}clone(){let e,t=super.clone(),i=new RegExp("^(.*)_([0-9]+)$"),r=t.name.match(i),o=0;null!=r&&3==r.length?(e=r[1],o=parseInt(r[2])+1):(e=t.name,o=2);let s=Xe.instance.getObjects(ob);for(let a of s)if("graveyard"!=a.location.name&&(r=a.name.match(i),null!=r&&3==r.length&&r[1]==e)){let g=parseInt(r[2])+1;o<=g&&(o=g)}return t.name=e+"_"+o,t.update(),t}createTestGameDataElement(t,e,i){this.createDataElements();let r=yt.create("name",t,{},"name_"+this.identifier),o=yt.create("size",e,{},"size_"+this.identifier),s=yt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let a=yt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),g=yt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),w=yt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w);let G=yt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(G),G.appendChild(yt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),G.appendChild(yt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),G=yt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(G),G.appendChild(yt.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),G.appendChild(yt.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),G.appendChild(yt.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),G.appendChild(yt.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),G.appendChild(yt.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),G.appendChild(yt.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),G=yt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(G),G.appendChild(yt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),G.appendChild(yt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),G.appendChild(yt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),G.appendChild(yt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),G.appendChild(yt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),G.appendChild(yt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ie=new Zc("ChatPalette_"+this.identifier);Ie.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n\n\u81ea\u5df1\u30d0\u30d5\u3001\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u4f8b\uff1a\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3\n:MP-3\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3:MP-3\n\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Ie.initialize(),this.appendChild(Ie),this.addExtendData()}createTestGameDataElementCheckTable(t,e,i){this.createDataElements();let r=yt.create("name",t,{},"name_"+this.identifier),o=yt.create("size",e,{},"size_"+this.identifier),s=yt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let a=yt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),g=yt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),w=yt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.detailDataElement.appendChild(a),a.appendChild(g),a.appendChild(w);let G=yt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(G),G.appendChild(yt.create("\u5fcd\u8853","\u30c6\u30fc\u30d6\u30eb\u8868\n|[]|[]\u5668\u8853|[]|[]\u4f53\u8853|[]|[]\u5fcd\u8853|[]|[]\u8b00\u8853|[]|[]\u6226\u8853|[]|[]\u5996\u8853||\n|\u3000|[]\u7d61\u7e70\u8853|\u3000|[]\u9a0e\u4e57\u8853|\u3000|[]\u751f\u5b58\u8853|\u3000|[]\u533b\u8853|\u3000|[]\u5175\u7ce7\u8853|\u3000|[]\u7570\u5f62\u5316|2|\n|\u3000|[]\u706b\u8853|\u3000|[]\u7832\u8853|\u3000|[]\u6f5c\u4f0f\u8853|\u3000|[]\u6bd2\u8853|\u3000|[]\u9ce5\u7363\u8853|\u3000|[]\u53ec\u559a\u8853|3|\n|\u3000|[]\u6c34\u8853|\u3000|[]\u624b\u88cf\u5263\u8853|\u3000|[]\u9041\u8d70\u8853|\u3000|[]\u7f60\u8853|\u3000|[]\u91ce\u6226\u8853|\u3000|[]\u6b7b\u970a\u8853|4|\n|\u3000|[]\u91dd\u8853|\u3000|[]\u624b\u7df4|\u3000|[]\u76d7\u8074\u8853|\u3000|[]\u8abf\u67fb\u8853|\u3000|[]\u5730\u306e\u5229|\u3000|[]\u7d50\u754c\u8853|5|\n|\u3000|[]\u4ed5\u8fbc\u307f|\u3000|[]\u8eab\u4f53\u64cd\u8853|\u3000|[]\u8179\u8a71\u8853|\u3000|[]\u8a50\u8853|\u3000|[]\u610f\u6c17|\u3000|[]\u5c01\u8853|6|\n|\u3000|[]\u8863\u88c5\u8853|\u3000|[]\u6b69\u6cd5|\u3000|[]\u96a0\u5f62\u8853|\u3000|[]\u5bfe\u4eba\u8853|\u3000|[]\u7528\u5175\u8853|\u3000|[]\u8a00\u970a\u8853|7|\n|\u3000|[]\u7e04\u8853|\u3000|[]\u8d70\u6cd5|\u3000|[]\u5909\u88c5\u8853|\u3000|[]\u904a\u82b8|\u3000|[]\u8a18\u61b6\u8853|\u3000|[]\u5e7b\u8853|8|\n|\u3000|[]\u767b\u8853|\u3000|[]\u98db\u8853|\u3000|[]\u9999\u8853|\u3000|[]\u4e5d\u30ce\u4e00\u306e\u8853|\u3000|[]\u898b\u6575\u8853|\u3000|[]\u77b3\u8853|9|\n|\u3000|[]\u62f7\u554f\u8853|\u3000|[]\u9aa8\u6cd5\u8853|\u3000|[]\u5206\u8eab\u306e\u8853|\u3000|[]\u5080\u5121\u306e\u8853|\u3000|[]\u6697\u53f7\u8853|\u3000|[]\u5343\u91cc\u773c\u306e\u8853|10|\n|\u3000|[]\u58ca\u5668\u8853|\u3000|[]\u5200\u8853|\u3000|[]\u96a0\u853d\u8853|\u3000|[]\u6d41\u8a00\u306e\u8853|\u3000|[]\u4f1d\u9054\u8853|\u3000|[]\u6191\u4f9d\u8853|11|\n|\u3000|[]\u6398\u524a\u8853|\u3000|[]\u602a\u529b|\u3000|[]\u7b2c\u516d\u611f|\u3000|[]\u7d4c\u6e08\u529b|\u3000|[]\u4eba\u8108|\u3000|[]\u546a\u8853|12|\n",{type:"markdown"},"\u5fcd\u8853"+this.identifier)),G.appendChild(yt.create("\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u30d1\u30fc\u30c4","|\u640d\u50b7|\u4f7f\u7528|\u30bf\u30a4\u30df\u30f3\u30b0|\u30b3\u30b9\u30c8|\u5c04\u7a0b|\u52b9\u679c|\n|[]\u3053\u3076\u3057|[]|\u30a2\u30af\u30b7\u30e7\u30f3|2|0|\u8089\u5f3e\u653b\u64831|\n|[]\u3046\u3067|[]|\u30b8\u30e3\u30c3\u30b8|1|0|\u652f\u63f41|",{type:"markdown"},"\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u30d1\u30fc\u30c4"+this.identifier)),G.appendChild(yt.create("\u5b9d\u7269\u3078\u306e\u4f9d\u5b58","[][][][] \u5e7c\u5150\u9000\u884c",{type:"markdown"},"\u30cd\u30af\u30ed\u30cb\u30ab\u7684\u672a\u7df4"+this.identifier)),this.overViewWidth=800,this.overViewMaxHeight=620,G=yt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(G),G.appendChild(yt.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),G.appendChild(yt.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),G.appendChild(yt.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),G.appendChild(yt.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),G.appendChild(yt.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),G.appendChild(yt.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),G=yt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(G),G.appendChild(yt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),G.appendChild(yt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),G.appendChild(yt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),G.appendChild(yt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),G.appendChild(yt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),G.appendChild(yt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ve=new Zc("ChatPalette_"+this.identifier);Ve.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n\n\u81ea\u5df1\u30d0\u30d5\u3001\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u4f8b\uff1a\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3\n:MP-3\n&\u30de\u30c3\u30b9\u30eb\u30d9\u30a2\u30fc/\u7b4bB+2/3:MP-3\n\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Ve.initialize(),this.appendChild(Ve),this.addExtendData()}createTestGameDataElementExtendSample(t,e,i){this.createDataElements();let r=yt.create("name",t,{},"name_"+this.identifier),o=yt.create("size",e,{},"size_"+this.identifier),s=yt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s);let a=yt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(a),a.appendChild(yt.create("\u8aac\u660e","\u3053\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB\u306e\u88dc\u52a9\u7528\u306e\u30b3\u30de\u3092\u4f5c\u308b\u3068\u304d\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u307e\u305a\u3001\u3053\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8\u306e\u8a2d\u5b9a\u3067\u300c\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u975e\u8868\u793a\u300d\u300c\u767a\u8a00\u3092\u3057\u306a\u3044\u300d\u306e\u30c1\u30a7\u30c3\u30af\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306f\u300c\u975e\u8868\u793a\u300d\u3067\u8db3\u5143\u306e\u30b5\u30fc\u30af\u30eb\u306e\u8272\u304c\u9752\u306b\u5909\u308f\u308a\u3001\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u3084\u30ea\u30ea\u30a3\u8ffd\u52a0\u6a5f\u80fd\u306e\u30ab\u30a6\u30f3\u30bf\u30fc\u30ea\u30e2\u30b3\u30f3\u306b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u6226\u95d8\u975e\u53c2\u52a0\u30ad\u30e3\u30e9\u3092\u7acb\u3061\u7d75\u3084\u30b3\u30de\u306e\u305f\u3081\u306b\u30c6\u30fc\u30d6\u30eb\u306b\u51fa\u3057\u305f\u3044\u5834\u5408\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u30d7\u30ed\u30d5\u7b49\u306e\u8ffd\u52a0\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306e\u30b3\u30de\u7b49\u3001\u767a\u8a00\u304c\u4e0d\u8981\u306a\u5834\u5408\u3001\u300c\u767a\u8a00\u3092\u3057\u306a\u3044\u300d\u306e\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u7b49\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u90e8\u4f4d\u6570\u304c10\u3042\u308b\u30e2\u30f3\u30b9\u30bf\u30fc\u306e\u99d2\u3092\u51fa\u3057\u305f\u3051\u3069\u982d\u3060\u3051\u558b\u308c\u3070\u3044\u3044\u3001\u7b49\u306e\u5834\u5408\u306b\u4f7f\u3044\u307e\u3059\u3002\u3053\u306e\u30c1\u30a7\u30c3\u30af\u3092ON\u306b\u3059\u308b\u3068\u30b3\u30de\u306e\u4e0a\u306e\u30ad\u30e3\u30e9\u540d\u304c\u767d\u5730\u306b\u9ed2\u6587\u5b57\u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\u6b21\u306b\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u306e\u30b5\u30a4\u30ba\u8a2d\u5b9a\u3067\u3059\u3002\u30ea\u30ea\u30a3\u3067\u306f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8\u304b\u3089\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u306e\u6a2a\u5e45\u3001\u6700\u5927\u7e26\u5e45\u3092\u5909\u66f4\u53ef\u80fd\u306a\u69d8\u306b\u62e1\u5f35\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u904a\u3076\u4ef2\u9593\u304c\u8a31\u3057\u3066\u304f\u308c\u308c\u3070\u3001\u6570\u5343\u6587\u5b57\u306e\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u66f8\u3044\u3066\u3082\u5927\u4e08\u592b\u3067\u3059\u3002\n\n\u306a\u304a\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3059\u308b\u9805\u76ee\u306e\u8a2d\u5b9a\u306f \u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\uff1e\u8a2d\u5b9a\uff1e\u8868\u793a\u9805\u76ee \u3067\u884c\u3044\u307e\u3059\u3002\n\u30ea\u30ea\u30a3\u3067\u306f\u8aac\u660e\u306e\u305f\u3081\u521d\u671f\u306e\u9805\u76ee\u306b\u60c5\u5831\u3092\u306b\u8ffd\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u60c5\u5831\u306e\u5b50\u9805\u76ee\u306e\u3053\u306e\u6587\u7ae0\u3067\u3042\u308b\u300c\u8aac\u660e\u300d\u3068\u300c\u6301\u3061\u7269\u300d\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u3066\u3082\u6301\u3063\u3066\u3044\u306a\u3044\u9805\u76ee\u306f\u8868\u793a\u3055\u308c\u306a\u3044\u306e\u3067\u3053\u306e\u30b3\u30de\u304b\u3089\u306fHP\u3084\u80fd\u529b\u5024\u3092\u524a\u3063\u3066\u3044\u307e\u3059\u3002\n\u30b2\u30fc\u30e0\u3054\u3068\u306b\u4f7f\u3044\u3084\u3059\u3044\u3088\u3046\u306b\u4f7f\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n",{type:"note"},"\u8aac\u660e"+this.identifier)),a.appendChild(yt.create("\u6301\u3061\u7269","\u3053\u3046\u3044\u3063\u305f\u6587\u7ae0\u3082\u898b\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30a4\u30c6\u30e01\uff1a3\u500b\u3000\u52b9\u679c\u3007\u3007\n\u30a2\u30a4\u30c6\u30e02\uff1a3\u500b\u3000\u52b9\u679c\u30d1\u30fc\u30c6\u30a3\u5185\u4e00\u4eba\u306eHP\u3092XX\u3059\u308b\n\u30a2\u30a4\u30c6\u30e03\uff1a3\u500b\u3000\u52b9\u679c\u6575\u4e00\u4eba\u306e\u9b54\u6cd5\u3092\u25b3\u3059\u308b\n\u30a2\u30a4\u30c6\u30e04\uff1a3\u500b\u3000\u52b9\u679cA\n\u30a2\u30a4\u30c6\u30e05\uff1a3\u500b\u3000\u52b9\u679cB",{type:"note"},"\u6301\u3061\u7269"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let G=new Zc("ChatPalette_"+this.identifier);G.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),G.initialize(),this.appendChild(G),this.addExtendData()}deleteBuff(t){if(this.buffDataElement.children){const i=this.buffDataElement.children[0].getFirstElementByName(t);return!!i&&(i.destroy(),!0)}return!1}decreaseBuffRound(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r-=1,e.value=r}}}increaseBuffRound(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r+=1,e.value=r}}}deleteZeroRoundBuff(){if(this.buffDataElement.children){const t=this.buffDataElement.children[0];for(const e of t.children){let r,i="";i=e.value,r=parseInt(i),r<=0&&e.destroy()}}}addBuffRound(t,e,i){let r="",o=3;if(e&&(r=e),null!=i&&(o=i),this.buffDataElement.children){let s=this.buffDataElement.children[0],a=this.buffDataElement.getFirstElementByName(t);a?(a.value=o,a.currentValue=r):s.appendChild(yt.create(t,o,{type:"numberResource",currentValue:r}))}}chkChangeStatusName(t){const e=this.detailDataElement.getFirstElementByName(t);return!!e&&("numberResource"==e.type||""==e.type||"note"==e.type)}chkChangeStatus(t,e){const i=this.detailDataElement.getFirstElementByName(t);if(!i)return!1;if("numberResource"==i.type){if("now"==e||"max"==e)return!0}else if(""==i.type){if("now"==e)return!0}else if("note"==i.type&&"now"==e)return!0;return!1}getStatusType(t,e){let i="";const r=this.detailDataElement.getFirstElementByName(t);if(!r)return null;if("numberResource"==r.type)"now"==e?i="currentValue":"max"==e&&(i="value");else{if(""!=r.type)return null;if("now"!=e)return null;i="value"}return i}getStatusTextType(t){let e="";const i=this.detailDataElement.getFirstElementByName(t);return i?(e="numberResource"==i.type?"currentValue":"value",e):null}getStatusValue(t,e){const i=this.detailDataElement.getFirstElementByName(t);if(!i)return null;let r=this.getStatusType(t,e);if(null==r)return null;let o="";return console.log("getStatusValue type"+r),"value"==r&&(o=i.value),"currentValue"==r&&(o=i.currentValue),parseInt(o)}setStatusValue(t,e,i){const r=this.detailDataElement.getFirstElementByName(t);if(!r)return!1;let o=this.getStatusType(t,e);return null!=o&&("value"==o&&(r.value=i),"currentValue"==o&&(r.currentValue=i),!0)}setStatusText(t,e){const i=this.detailDataElement.getFirstElementByName(t);if(!i)return!1;let r=this.getStatusTextType(t);return null!=r&&("value"==r&&(i.value=e),"currentValue"==r&&(i.currentValue=e),!0)}changeStatusValue(t,e,i,r,o){const s=this.detailDataElement.getFirstElementByName(t);let a="",g=this.getStatusType(t,e);if(!s)return a;let G=this.getStatusValue(t,e);if(null==G)return a;let me=G+i,ve="";return"value"==g&&(r&&me<=0&&r&&(ve="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me)),"currentValue"==g&&(me>=s.value&&o&&(ve="(\u6700\u5927)",me=this.getStatusValue(t,"max")),r&&me<=0&&r&&(ve="(\u6700\u5c0f)",me=0),this.setStatusValue(t,e,me)),a=a+"["+this.name+" "+G+">"+me+ve+"] ",a}};var $r;be([st()],Bt.prototype,"isLock",void 0),be([st()],Bt.prototype,"rotate",void 0),be([st()],Bt.prototype,"roll",void 0),be([st()],Bt.prototype,"isDropShadow",void 0),be([st()],Bt.prototype,"hideInventory",void 0),be([st()],Bt.prototype,"nonTalkFlag",void 0),be([st()],Bt.prototype,"overViewWidth",void 0),be([st()],Bt.prototype,"overViewMaxHeight",void 0),be([st()],Bt.prototype,"specifyKomaImageFlag",void 0),be([st()],Bt.prototype,"komaImageHeignt",void 0),be([st()],Bt.prototype,"chatColorCode",void 0),be([st()],Bt.prototype,"syncDummyCounter",void 0),Bt=ob=be([ai("character")],Bt);let _t=$r=class extends ca{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.lastControlImageIdentifier="",this.lastControlCharacterName="",this.lastControlImageIndex=0,this.lastControlSendFrom="",this.voteAnswer=-1,this.voteId=-1,this._reConnectPass="",this._timestampSend=-1,this._timestampReceive=-1,this._timeDiffUp=0,this._timeDiffDown=0,this._timeLatency=99999,this._firstTimeSignNo=-1,this._lastTimeSignNo=-1,this._totalTimeSignNum=0,this._timeout=40,this._isDisConnect=!0,this._debugTimeShift=0,this._debugReceiveDelay=0,this.chatColorCode=["#000000","#FF0000","#0099FF"],this._diceImageType="",this._diceImageIndex=-1}get isDisConnect(){return this._isDisConnect}set isDisConnect(t){this._isDisConnect=t}get timestampSend(){return this._timestampSend}set timestampSend(t){this._timestampSend=t}get timestampReceive(){return this._timestampReceive}set timestampReceive(t){this._timestampReceive=t+this._debugReceiveDelay}get timeDiffUp(){return this._timeDiffUp}set timeDiffUp(t){this._timeDiffUp=t}get timeDiffDown(){return this._timeDiffDown}set timeDiffDown(t){this._timeDiffDown=t}get timeLatency(){return this._timeLatency}set timeLatency(t){this._timeLatency=t}get debugTimeShift(){return this._debugTimeShift}set debugTimeShift(t){this._debugTimeShift=t}get debugReceiveDelay(){return this._debugReceiveDelay}set debugReceiveDelay(t){this._debugReceiveDelay=t}get timeout(){return this._timeout>0?this._timeout:1}set timeout(t){this._timeout=t}get firstTimeSignNo(){return this._firstTimeSignNo}set firstTimeSignNo(t){this._firstTimeSignNo=t}get lastTimeSignNo(){return this._lastTimeSignNo}set lastTimeSignNo(t){this._lastTimeSignNo=t}get totalTimeSignNum(){return this._totalTimeSignNum}set totalTimeSignNum(t){this._totalTimeSignNum=t}get reConnectPass(){return this._reConnectPass}set reConnectPass(t){this._reConnectPass=t}get vote(){return Xe.instance.get("Vote")}get diceImageType(){return this._diceImageType}get diceImageIndex(){return this._diceImageIndex}set diceImageType(t){this._diceImageType=t}set diceImageIndex(t){this._diceImageIndex=t}get diceImageIdentifier(){return""!=this.diceImageType?this.diceImageType+"_dice["+this.diceImageIndex.toString().padStart(2,"0")+"]":""}get isMine(){return $r.myCursor&&$r.myCursor===this}get image(){return xt.instance.get(this.imageIdentifier)}get lastControlImage(){return xt.instance.get(this.lastControlImageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Qe.register(this).on("DISCONNECT_PEER",t=>{t.data.peerId===this.peerId&&setTimeout(()=>{$t.peerIds.includes(this.peerId)||($r.userIdMap.delete(this.userId),$r.peerIdMap.delete(this.peerId),Xe.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this),$r.userIdMap.delete(this.userId),$r.peerIdMap.delete(this.peerId)}static findByUserId(t){return this.find($r.userIdMap,t,!0)}static findByPeerId(t){return this.find($r.peerIdMap,t,!1)}static find(t,e,i){let r=t.get(e);if(null!=r&&Xe.instance.get(r))return Xe.instance.get(r);let o=Xe.instance.getObjects($r);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return t.set(a,s.identifier),s}return null}static createMyCursor(){return $r.myCursor?(console.warn("It is already created."),$r.myCursor):($r.myCursor=new $r,$r.myCursor.peerId=$t.peerId,$r.myCursor.initialize(),$r.myCursor)}apply(t){let e=t.syncData.userId,i=t.syncData.peerId;e!==this.userId&&($r.userIdMap.set(e,this.identifier),$r.userIdMap.delete(this.userId)),i!==this.peerId&&($r.peerIdMap.set(i,this.identifier),$r.peerIdMap.delete(this.peerId));let r=this.voteId;super.apply(t),r!=this.voteId&&this.vote.chkFinishVote()}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};_t.myCursor=null,_t.userIdMap=new Map,_t.peerIdMap=new Map,be([st()],_t.prototype,"userId",void 0),be([st()],_t.prototype,"peerId",void 0),be([st()],_t.prototype,"name",void 0),be([st()],_t.prototype,"imageIdentifier",void 0),be([st()],_t.prototype,"lastControlImageIdentifier",void 0),be([st()],_t.prototype,"lastControlCharacterName",void 0),be([st()],_t.prototype,"lastControlImageIndex",void 0),be([st()],_t.prototype,"lastControlSendFrom",void 0),be([st()],_t.prototype,"voteAnswer",void 0),be([st()],_t.prototype,"voteId",void 0),_t=$r=be([ai("PeerCursor")],_t);let Eo=(()=>{class n{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType="DiceBot",this._ImageIndex=0}get chatTabs(){return Ls.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,w=new Date(o.utc_datetime).getTime();this.timeOffset=w+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+w),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendSystemMessageOnePlayer(e,i,r,o){let s;s=o||"#006633";let a={from:this.findId(r),to:this.findId(r),name:"\u30b7\u30b9\u30c6\u30e0\u30e1\u30c3\u30bb\u30fc\u30b8",imageIdentifier:"",timestamp:this.calcTimeStamp(e),tag:"DiceBot to-pl-system-message",text:i,imagePos:-1,messColor:s,sendFrom:null};return e.addMessage(a)}sendSystemMessageLastSendCharactor(e){const r=Xe.instance.get("ChatTabList").systemMessageTab,o=_t.myCursor.lastControlSendFrom?_t.myCursor.lastControlSendFrom:_t.myCursor.identifier;let s=_t.myCursor.lastControlImageIndex;this.findImageIdentifier(o,s)!=_t.myCursor.lastControlImageIdentifier&&(s=0),this.sendMessage(r,e,null,o,null,s,"#006633")}sendMessage(e,i,r,o,s,a,g,w){let me,ve;me=a>0?a:0,ve=g||"#000000";let Oe,Ie=Xe.instance.get("DiceBot");Oe=null==r?"":Ie.checkSecretDiceCommand(r,i)||Ie.checkSecretEditCommand(i)?`${r.ID} secret`:r.ID;let Ve={from:$t.peerContext.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o,me),timestamp:this.calcTimeStamp(e),tag:Oe,text:i,imagePos:this.findImagePos(o),messColor:ve,sendFrom:o};console.log(i+" "+o+" "+s+" "+a),this.setLastControlInfoToPeer(o,this.findImageIdentifier(o,me),a,s);let Ye=(" "+i).match(/\s[@\uff20](\S+)\s*$/i);if(Ye){console.log(Ye);const Ge=Ye[1].match(/^[hH\uff48\uff28][iI\uff49\uff29][dD\uff44\uff24][eE\uff45\uff25]$/),ct=Ye[1].match(/(\d+)$/);if(Ge)Ve.imageIdentifier="",Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");else if(ct){const rt=parseInt(ct[1]),ft=this.findImageIdentifier(o,rt);if(ft){Ve.imageIdentifier=ft,Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");let Lt=Xe.instance.get(o);Lt instanceof Bt&&(Lt.selectedTachieNum=parseInt(ct[1]))}}else{const ft=this.findImageIdentifierName(o,Ye[1]);if(ft){Ve.imageIdentifier=ft,Ve.text=i.replace(/([@\uff20]\S+\s*)$/i,"");let Lt=Xe.instance.get(o);Lt instanceof Bt&&(Lt.selectedTachieNum=this._ImageIndex)}}}return e.addMessage(Ve,w||null)}findId(e){let i=Xe.instance.get(e);return i instanceof Bt?i.identifier:i instanceof _t?i.userId:null}findObjectName(e){let i=Xe.instance.get(e);return i instanceof Bt||i instanceof _t?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}setLastControlInfoToPeer(e,i,r,o){const s=this.findObjectName(e),a=_t.myCursor;!a||(console.log("peerCursor:"+a),(null==o||o.length<1)&&(a.lastControlImageIdentifier!=i&&(a.lastControlImageIdentifier=i),a.lastControlCharacterName!=s&&(a.lastControlCharacterName=s),a.lastControlSendFrom=e,a.lastControlImageIndex=r))}findImageIdentifierName(e,i){let r=Xe.instance.get(e);if(this._ImageIndex=0,r instanceof Bt){let o=r.imageDataElement;for(let s of o.children){if(s instanceof yt&&s.getAttribute("currentValue")==i){console.log("HIT!!"+s.getAttribute("currentValue")+"="+i);const a=xt.instance.get(s.value);if(a)return a.identifier}this._ImageIndex++}this._ImageIndex=0;for(let s of o.children){if(s instanceof yt&&(console.log("child"+s.getAttribute("currentValue")),0==s.getAttribute("currentValue").indexOf(i))){console.log("HIT!!"+s.getAttribute("currentValue")+"="+i);const a=xt.instance.get(s.value);if(a)return a.identifier}this._ImageIndex++}}return""}findImageIdentifier(e,i){let r=Xe.instance.get(e);if(r instanceof Bt){if(r.imageDataElement.children.length>i){let o=xt.instance.get(r.imageDataElement.children[i].value);if(o)return o.identifier}return""}return r instanceof _t?r.imageIdentifier:""}findImagePos(e){let i=Xe.instance.get(e);if(i instanceof Bt){let r=i.detailDataElement.getFirstElementByName("POS");return r&&0<=r.currentValue&&r.currentValue<=11?r.currentValue:0}return-1}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var sb=(()=>(function(n){n.ACTION="action",n.SEPARATOR="separator"}(sb||(sb={})),sb))();const xi={name:"",enabled:!0,type:sb.SEPARATOR};let To=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.title="",this.actions=[],this.position={x:0,y:0}}get isShow(){return!!this.panelComponentRef}open(e,i,r,o){let s;this.close(),o||(o=n.defaultParentViewContainerRef,console.log("Context Open"));const a=o.injector,g=this.componentFactoryResolver.resolveComponentFactory(n.ContextMenuComponentClass);s=o.createComponent(g,o.length,a);const w=s.injector.get(n);w.panelComponentRef=s,i&&(w.actions=i),e&&(w.position.x=e.x,w.position.y=e.y),w.title=null!=r?r:"",s.onDestroy(()=>{w.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.ContextMenuComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(Vu))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();var gc,pd=(()=>(function(n){n.ASC="ASC",n.DESC="DESC"}(pd||(pd={})),pd))();let ja=gc=class extends ca{constructor(){super(...arguments),this.sortTag="HP",this.sortOrder=pd.ASC,this.sortTag2nd="name",this.sortOrder2nd=pd.ASC,this.dataTag="HP MP SAN \u654f\u6377\u5ea6 \u7cbe\u795e\u529b \u60c5\u5831"}static get instance(){return gc._instance||(gc._instance=new gc("DataSummarySetting"),gc._instance.initialize()),gc._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(t){let e=gc.instance.toContext();e.syncData=this.toContext().syncData,gc.instance.apply(e),gc.instance.update(),this.destroy()}};be([st()],ja.prototype,"sortTag",void 0),be([st()],ja.prototype,"sortOrder",void 0),be([st()],ja.prototype,"sortTag2nd",void 0),be([st()],ja.prototype,"sortOrder2nd",void 0),be([st()],ja.prototype,"dataTag",void 0),ja=gc=be([ai("summary-setting")],ja);let ab=(()=>{class n{constructor(){this.tableInventory=new lb(e=>"table"===e.location.name),this.commonInventory=new lb(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new lb(e=>e.location.name===$t.peerId),this.graveyardInventory=new lb(e=>"graveyard"===e.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=yt.create(this.newLineString),this.initialize()}get summarySetting(){return ja.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get sortTag2nd(){return this.summarySetting.sortTag2nd}set sortTag2nd(e){this.summarySetting.sortTag2nd=e}get sortOrder2nd(){return this.summarySetting.sortOrder2nd}set sortOrder2nd(e){this.summarySetting.sortOrder2nd=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}initialize(){Qe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);if(i)if(i instanceof Bt){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof yt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),(this.sortTag===i.name||this.sortTag2nd===i.name)&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof ja&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Bt.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){Qe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===$t.peerId||"graveyard"===e)return!0;for(let i of $t.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class lb{constructor(t){this.classifier=t,this.newLineString="/",this.newLineDataElement=yt.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return ja.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(t){this.summarySetting.sortTag=t}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(t){this.summarySetting.sortOrder=t}get sortTag2nd(){return this.summarySetting.sortTag2nd}set sortTag2nd(t){this.summarySetting.sortTag2nd=t}get sortOrder2nd(){return this.summarySetting.sortOrder2nd}set sortOrder2nd(t){this.summarySetting.sortOrder2nd=t}get dataTag(){return this.summarySetting.dataTag}set dataTag(t){this.summarySetting.dataTag=t}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let t=this.tabletopObjects;for(let e of t){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let t=Xe.instance.getObjects(Bt),e=[];for(let i of t)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(t){let e=this.sortTag.length?this.sortTag.trim():"",i=this.sortTag2nd.length?this.sortTag2nd.trim():"",r="ASC"===this.sortOrder?-1:1,o="ASC"===this.sortOrder2nd?-1:1;return e.length<1||t.sort((s,a)=>{var g,w;let G=null===(g=s.rootDataElement)||void 0===g?void 0:g.getFirstElementByName(e),me=null===(w=a.rootDataElement)||void 0===w?void 0:w.getFirstElementByName(e);if(!G&&!me)return 0;if(!me)return-1;if(!G)return 1;let ve=this.convertToSortableValue(G),Ie=this.convertToSortableValue(me);if(ve<Ie)return r;if(ve>Ie)return-1*r;let Oe=s.rootDataElement.getFirstElementByName(i),Ve=a.rootDataElement.getFirstElementByName(i);if(!Oe&&!Ve)return 0;if(!Ve)return-1;if(!Oe)return 1;let We=this.convertToSortableValue(Oe),Ye=this.convertToSortableValue(Ve);return We<Ye?o:We>Ye?-1*o:0}),t}convertToSortableValue(t){let i=wo.toHalfWidth(((t.isNumberResource?t.currentValue:t.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}class CG{constructor(t,e,i){this._resolve=t,this._reject=e,this.option=i}resolve(t){this._resolve(t),this._resolve=null}reject(t){this._reject(t),this._reject=null}}let hi=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let o;return r||(r=n.defaultParentViewContainerRef),new Promise((s,a)=>{const G=new n(this.componentFactoryResolver);G.modalContext=new CG(Ve=>{o&&(o.destroy(),s(Ve),this.count--)},Ve=>{o&&(o.destroy(),a(Ve),this.count--)},i);const ve=Ne.create([{provide:n,useValue:G}],r.injector),Ie=this.componentFactoryResolver.resolveComponentFactory(n.ModalComponentClass),Oe=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(Ie,r.length,ve),o.instance.content.createComponent(Oe),o.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return n.ModalComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(Vu))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),$n=(()=>{class n{constructor(e){this.componentFactoryResolver=e,this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isCutIn=!1,this.cutInIdentifier="",this.chatTab=null,this.cardStack=null,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let o;r||(r=n.defaultParentViewContainerRef);const s=r.injector,a=this.componentFactoryResolver.resolveComponentFactory(n.UIPanelComponentClass),g=this.componentFactoryResolver.resolveComponentFactory(e);o=r.createComponent(a,r.length,s);let w=o.instance.content.createComponent(g);const G=o.injector.get(n);return G.panelComponentRef=o,i&&(i.title&&(G.title=i.title),i.top&&(G.top=i.top),i.left&&(G.left=i.left),i.width&&(G.width=i.width),i.height&&(G.height=i.height),i.isCutIn&&(G.isCutIn=i.isCutIn),i.cutInIdentifier&&(G.cutInIdentifier=i.cutInIdentifier)),o.onDestroy(()=>{G.panelComponentRef=null}),w.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.UIPanelComponentClass=null,n.\u0275fac=function(e){return new(e||n)(In(Vu))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})(),Di=(()=>{class n{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Pw(n,t=[]){let e=Xe.instance.getObjects(n.aliasName);t.forEach(o=>e=e.concat(Xe.instance.getObjects(o))),e=e.filter(o=>o.isVisibleOnTable);let i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==n.zindex||r)&&(n.zindex=i+1,!(n.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}var cb,Yc=(()=>(function(n){n[n.FRONT=0]="FRONT",n[n.BACK=1]="BACK"}(Yc||(Yc={})),Yc))();let Qr=cb=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.dispLockMark=!0,this.state=Yc.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.overViewWidth=250,this.overViewMaxHeight=250}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(t){this.setCommonValue("size",t)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&$t.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}get isHand(){return $t.peerContext.userId===this.owner}get isFront(){return this.state===Yc.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=Yc.FRONT,this.owner=""}faceDown(){this.state=Yc.BACK,this.owner=""}toTopmost(){Pw(this,["card-stack"])}static create(t,e,i,r=2,o){let s=null;return s=o?new cb(o):new cb,s.createDataElements(),s.commonDataElement.appendChild(yt.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(yt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(yt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(yt.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var ub;be([st()],Qr.prototype,"isLock",void 0),be([st()],Qr.prototype,"dispLockMark",void 0),be([st()],Qr.prototype,"state",void 0),be([st()],Qr.prototype,"rotate",void 0),be([st()],Qr.prototype,"owner",void 0),be([st()],Qr.prototype,"zindex",void 0),be([st()],Qr.prototype,"overViewWidth",void 0),be([st()],Qr.prototype,"overViewMaxHeight",void 0),Qr=cb=be([ai("card")],Qr);let xr=ub=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.overViewWidth=250,this.overViewMaxHeight=250}get name(){return this.getCommonValue("name","")}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let t of this.children)if("cardRoot"===t.getAttribute("name"))return t;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(t){super.onChildRemoved(t),t instanceof Qr&&Qe.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:t.identifier})}shuffle(){if(!this.cardRoot)return;let t=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*t,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let t=this.topCard?this.cardRoot.removeChild(this.topCard):null;return t&&(t.rotate+=this.rotate,360<t.rotate&&(t.rotate-=360),this.setSamePositionFor(t),t.toTopmost()),t}drawCardAll(){let t=this.cards;for(let e of t)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return t}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let t of this.cards)t.faceUp(),this.setSamePositionFor(t)}faceDownAll(){for(let t of this.cards)t.faceDown(),this.setSamePositionFor(t)}uprightAll(){for(let t of this.cards)t.rotate=0,this.setSamePositionFor(t)}unifyCardsSize(t){for(const e of this.cards)e.size!==t&&(e.size=t)}putOnTop(t){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(t);t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.insertBefore(t,this.topCard)}putOnBottom(t){if(!this.cardRoot)return null;t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.appendChild(t)}toTopmost(){Pw(this,["card"])}setLocation(t){super.setLocation(t);let e=this.cards;for(let i of e)i.setLocation(t)}setSamePositionFor(t){t.location.name=this.location.name,t.location.x=this.location.x,t.location.y=this.location.y,t.posZ=this.posZ}static create(t,e){let i=null;i=e?new ub(e):new ub,i.createDataElements(),i.commonDataElement.appendChild(yt.create("name",t,{},"name_"+i.identifier));let r=new Si("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};be([st()],xr.prototype,"isLock",void 0),be([st()],xr.prototype,"rotate",void 0),be([st()],xr.prototype,"zindex",void 0),be([st()],xr.prototype,"owner",void 0),be([st()],xr.prototype,"isShowTotal",void 0),be([st()],xr.prototype,"overViewWidth",void 0),be([st()],xr.prototype,"overViewMaxHeight",void 0),xr=ub=be([ai("card-stack")],xr);var db,ho=(()=>(function(n){n[n.D2=0]="D2",n[n.D4=1]="D4",n[n.D6=2]="D6",n[n.D8=3]="D8",n[n.D10=4]="D10",n[n.D10_10TIMES=5]="D10_10TIMES",n[n.D12=6]="D12",n[n.D20=7]="D20"}(ho||(ho={})),ho))();let zs=db=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.face="0",this.owner="",this.rotate=0,this.specifyKomaImageFlag=!1,this.komaImageHeignt=100}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get size(){return this.getCommonValue("size",1)}set size(t){this.setCommonValue("size",t)}get faces(){return this.imageDataElement.children.map(t=>t.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&$t.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}get isMine(){return $t.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let t=this.faces;return this.face=0<t.length?t[Math.floor(Math.random()*t.length)]:"",this.face}setDicetype(t){this.makeDiceFace(t)}makeDiceFace(t,e){let i=1,r=[],o=s=>s+1+"";switch(t){case ho.D2:i=2;break;case ho.D4:i=4;break;case ho.D6:i=6;break;case ho.D8:i=8;break;case ho.D10_10TIMES:o=s=>s+1+"0";case ho.D10:i=10;break;case ho.D12:i=12;break;case ho.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(yt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(t,e,i,r){let o=r?new db(r):new db;return o.createDataElements(),o.commonDataElement.appendChild(yt.create("name",t,{},"name_"+o.identifier)),o.commonDataElement.appendChild(yt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var fb;be([st()],zs.prototype,"isLock",void 0),be([st()],zs.prototype,"face",void 0),be([st()],zs.prototype,"owner",void 0),be([st()],zs.prototype,"rotate",void 0),be([st()],zs.prototype,"specifyKomaImageFlag",void 0),be([st()],zs.prototype,"komaImageHeignt",void 0),zs=db=be([ai("dice-symbol")],zs);let So=fb=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.dispLockMark=!0,this.owner="",this.scratchingGrids="",this.scratchedGrids="",this.isPreview=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}get color(){let t=this.getElement("color",this.commonDataElement);return t?t.value+"":"#555555"}set color(t){this.setCommonValue("color",t)}get bgcolor(){let t=this.getElement("color",this.commonDataElement);return t?t.currentValue+"":"#0a0a0a"}set bgcolor(t){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=t)}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get ownerColor(){return"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&($t.peerContext.userId===this.owner&&$t.peerContext.isOpen||$t.peerContexts.some(t=>{const e=_t.findByPeerId(t.peerId);return e&&e.userId===this.owner&&t.isOpen}))}get isMine(){return $t.peerContext.userId===this.owner}complement(){}static create(t,e,i,r,o){let s=null;return s=o?new fb(o):new fb,s.createDataElements(),s.commonDataElement.appendChild(yt.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(yt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(yt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(yt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};var hb;be([st()],So.prototype,"isLock",void 0),be([st()],So.prototype,"dispLockMark",void 0),be([st()],So.prototype,"owner",void 0),be([st()],So.prototype,"scratchingGrids",void 0),be([st()],So.prototype,"scratchedGrids",void 0),be([st()],So.prototype,"isPreview",void 0),So=fb=be([ai("table-mask")],So);let Do=hb=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.isScratch=!1,this.dispLockMark=!0,this.color="#404040",this.changeColor="#FF5050",this.owner="",this.M=[],this.fillMapBack=[],this.scratchingGrids="",this.scratchedGrids="",this.dummy=0,this.maxSize=50}getMaxSize(){return this.maxSize}getMapXY(t,e,i){return i?this.fillMapBack.length<this.M.length?(console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd getMapXY:"+this.fillMapBack.length),!1):this.fillMapBack[this.maxSize*e+t]:this.M[this.maxSize*e+t]}setMapXY(t,e,i){this.fillMapBack.length<this.M.length?console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd setMapXY:"+this.fillMapBack.length):this.fillMapBack[this.maxSize*e+t]=i}copyBack2MainMap(){this.M=this.fillMapBack.concat(),console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\uff1a\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u9818\u57df\u304b\u3089\u53cd\u6620:"+this.fillMapBack.length),this.dummy++,this.dummy>=100&&(this.dummy=0)}copyMain2BackMap(){this.fillMapBack=this.M.concat(),console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\uff1a\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u9818\u57df\u306b\u8907\u88fd:"+this.fillMapBack.length)}reverseMapXY(t,e){this.fillMapBack.length<this.M.length?console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd reverseMapXY:"+this.fillMapBack.length):this.fillMapBack[this.maxSize*e+t]=!this.fillMapBack[this.maxSize*e+t]}isMapXYChange(t,e){return this.fillMapBack.length<this.M.length?(console.log("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af\u4f5c\u696d\u9818\u57df\u672a\u78ba\u4fdd isMapXYChange:"+this.fillMapBack.length),!1):this.M[this.maxSize*e+t]!=this.fillMapBack[this.maxSize*e+t]}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get ownerName(){let t=_t.findByUserId(this.owner);return t?t.name:""}get hasOwner(){return 0<this.owner.length}get isMine(){return $t.peerContext.userId===this.owner}get ownerIsOnline(){return this.hasOwner&&$t.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}static create(t,e,i,r,o){let s=null;return s=o?new hb(o):new hb,s.M=new Array(s.maxSize*s.maxSize).fill(1),s.createDataElements(),s.commonDataElement.appendChild(yt.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(yt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(yt.create("height",i,{},"height_"+s.identifier)),s.initialize(),s}};be([st()],Do.prototype,"isLock",void 0),be([st()],Do.prototype,"isScratch",void 0),be([st()],Do.prototype,"dispLockMark",void 0),be([st()],Do.prototype,"color",void 0),be([st()],Do.prototype,"changeColor",void 0),be([st()],Do.prototype,"owner",void 0),be([st()],Do.prototype,"M",void 0),be([st()],Do.prototype,"scratchingGrids",void 0),be([st()],Do.prototype,"scratchedGrids",void 0),be([st()],Do.prototype,"dummy",void 0),Do=hb=be([ai("table-scratch-mask")],Do);var gb,_d=(()=>(function(n){n[n.NULL=0]="NULL",n[n.FLOOR=1]="FLOOR",n[n.WALL=2]="WALL",n[n.ALL=3]="ALL"}(_d||(_d={})),_d))(),ji=(()=>(function(n){n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=3]="LEFT",n[n.RIGHT=4]="RIGHT"}(ji||(ji={})),ji))();let go=gb=class extends Xr{constructor(){super(...arguments),this.isLocked=!1,this.mode=_d.ALL,this.rotate=0,this.isDropShadow=!0,this.isSlope=!1,this.isSurfaceShading=!0,this.slopeDirection=ji.NONE,this.isGrid=!1}get width(){return this.getCommonValue("width",1)}set width(t){this.setCommonValue("width",t)}get height(){return this.getCommonValue("height",1)}set height(t){this.setCommonValue("height",t)}get depth(){return this.getCommonValue("depth",1)}set depth(t){this.setCommonValue("depth",t)}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&_d.WALL)}get hasFloor(){return!!(this.mode&_d.FLOOR)}static create(t,e,i,r,o,s,a){let g=null;return g=a?new gb(a):new gb,g.createDataElements(),g.commonDataElement.appendChild(yt.create("name",t,{},"name_"+g.identifier)),g.commonDataElement.appendChild(yt.create("width",e,{},"width_"+g.identifier)),g.commonDataElement.appendChild(yt.create("height",r,{},"height_"+g.identifier)),g.commonDataElement.appendChild(yt.create("depth",i,{},"depth_"+g.identifier)),g.imageDataElement.appendChild(yt.create("wall",o,{type:"image"},"wall_"+g.identifier)),g.imageDataElement.appendChild(yt.create("floor",s,{type:"image"},"floor_"+g.identifier)),g.initialize(),g}};be([st()],go.prototype,"isLocked",void 0),be([st()],go.prototype,"mode",void 0),be([st()],go.prototype,"rotate",void 0),be([st()],go.prototype,"isDropShadow",void 0),be([st()],go.prototype,"isSlope",void 0),be([st()],go.prototype,"isSurfaceShading",void 0),be([st()],go.prototype,"slopeDirection",void 0),be([st()],go.prototype,"isGrid",void 0),go=gb=be([ai("terrain")],go);var $s=(()=>(function(n){n[n.NONE=-1]="NONE",n[n.SQUARE=0]="SQUARE",n[n.HEX_VERTICAL=1]="HEX_VERTICAL",n[n.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}($s||($s={})),$s))(),pb=(()=>(function(n){n.NONE="",n.WHITE="white",n.BLACK="black"}(pb||(pb={})),pb))();let Jr=class extends Si{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=pb.NONE,this.selected=!1,this.gridType=$s.SQUARE,this.gridColor="#000000e6",this.gridClipRect=null}get terrains(){let t=[];return this.children.forEach(e=>{e instanceof go&&t.push(e)}),t}get masks(){let t=[];return this.children.forEach(e=>{e instanceof So&&t.push(e)}),t}get scratchMasks(){let t=[];return this.children.forEach(e=>{e instanceof Do&&t.push(e)}),t}onStoreAdded(){super.onStoreAdded(),this.selected&&Qe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};be([st()],Jr.prototype,"name",void 0),be([st()],Jr.prototype,"width",void 0),be([st()],Jr.prototype,"height",void 0),be([st()],Jr.prototype,"gridSize",void 0),be([st()],Jr.prototype,"imageIdentifier",void 0),be([st()],Jr.prototype,"backgroundImageIdentifier",void 0),be([st()],Jr.prototype,"backgroundFilterType",void 0),be([st()],Jr.prototype,"selected",void 0),be([st()],Jr.prototype,"gridType",void 0),be([st()],Jr.prototype,"gridColor",void 0),Jr=be([ai("game-table")],Jr);var Io=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(Io||(Io={})),Io))();class ua{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Io.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Io.URL:Io.COMPLETE:Io.NULL}static createEmpty(t){let e=new ua;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new ua;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new ua;return e.apply(t),e}}static createAsync(t){return(0,xn.Z)(function*(){return t instanceof File?yield ua._createAsync(t,t.name):t instanceof Blob?yield ua._createAsync(t):void 0})()}static _createAsync(t,e){return(0,xn.Z)(function*(){let i=yield vl.readAsArrayBufferAsync(t),r=new ua;return r.context.identifier=yield vl.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==Io.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),this.createURLs()}createURLs(){this.state!==Io.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Io.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Ig,Rf=(()=>(function(n){n[n.MASTER=0]="MASTER",n[n.AUDITION=1]="AUDITION"}(Rf||(Rf={})),Rf))();class Qt{constructor(t){this.volumeType=Rf.MASTER,this.audio=t}static get audioContext(){return Qt._audioContext||(Qt._audioContext=new(window.AudioContext||window.webkitAudioContext)),Qt._audioContext}static get volume(){return Qt._volume}static set volume(t){Qt._volume=t,Qt.masterGainNode.gain.setTargetAtTime(Qt._volume,Qt.audioContext.currentTime,.01)}static get auditionVolume(){return Qt._auditionVolume}static set auditionVolume(t){Qt._auditionVolume=t,Qt.auditionGainNode.gain.setTargetAtTime(Qt._auditionVolume,Qt.audioContext.currentTime,.01)}static get masterGainNode(){if(!Qt._masterGainNode){let t=Qt.audioContext.createGain();t.gain.setValueAtTime(Qt._volume,Qt.audioContext.currentTime),t.connect(Qt.audioContext.destination),Qt._masterGainNode=t}return Qt._masterGainNode}static get auditionGainNode(){if(!Qt._auditionGainNode){let t=Qt.audioContext.createGain();t.gain.setValueAtTime(Qt._auditionVolume,Qt.audioContext.currentTime),t.connect(Qt.audioContext.destination),Qt._auditionGainNode=t}return Qt._auditionGainNode}static get rootNode(){return Qt.masterGainNode}static get auditionNode(){return Qt.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=Qt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(t){this.audioElm.volume=t}get loop(){return this.audioElm.loop}set loop(t){this.audioElm.loop=t}get paused(){return this.audioElm.paused}static play(t,e=1){this.playBufferAsync(t,e)}play(t=this.audio){if(this.stop(),this.audio=t,!this.audio)return;let e=this.audio.url;t.state===Io.URL&&(Qt.cacheMap.has(t.identifier)?e=Qt.cacheMap.get(t.identifier).url:Qt.createCacheAsync(t)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===Rf.AUDITION?Qt.auditionNode:Qt.rootNode}static playBufferAsync(t,e=1){return(0,xn.Z)(function*(){let i=yield Qt.createBufferSourceAsync(t);if(!i)return;let r=Qt.audioContext.createGain();r.gain.setValueAtTime(e,Qt.audioContext.currentTime),r.connect(Qt.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(t){var e=this;return(0,xn.Z)(function*(){if(!t)return null;try{let i=t.blob;if(t.state===Io.URL)if(Qt.cacheMap.has(t.identifier))i=Qt.cacheMap.get(t.identifier).blob;else{let s=yield Qt.createCacheAsync(t);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=Qt.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(t){return new Promise(function(){var e=(0,xn.Z)(function*(i,r){Qt.audioContext.decodeAudioData(yield vl.readAsArrayBufferAsync(t),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(t){return(0,xn.Z)(function*(){if(t.blob)return t.blob;if(t.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(t.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(t){return(0,xn.Z)(function*(){let e={url:t.url,blob:null};try{e.blob=yield Qt.getBlobAsync(t)}catch(i){return console.error(i),e}return Qt.cacheMap.has(t.identifier)?Qt.cacheMap.get(t.identifier):(e.url=URL.createObjectURL(e.blob),Qt.cacheMap.set(t.identifier,e),e)})()}static resumeAudioContext(){Qt.audioContext.resume();let t=()=>{Qt.audioContext.resume(),document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0)}}Qt._volume=.5,Qt._auditionVolume=.5,Qt.cacheMap=new Map;class Jt{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Jt._instance||(Jt._instance=new Jt),Jt._instance}get audios(){let t=[];for(let e in this.hash)t.push(this.hash[e]);return t}destroy(){for(let t in this.hash)this.delete(t)}addAsync(t){var e=this;return(0,xn.Z)(function*(){let i=yield ua.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=ua.create(t);else if(t instanceof ua)e=t;else{if(this.update(t))return this.hash[t.identifier];e=ua.create(t)}return this._add(e)}_add(t){return Io.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.hash[t.identifier]:(this.hash[t.identifier]=t,console.log("add Audio: "+t.identifier),t)}update(t){let e;e=t instanceof ua?t.toContext():t;let i=this.hash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.hash[t];return!!e&&(e.destroy(),delete this.hash[t],!0)}get(t){return this.hash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Qe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new cc(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of Jt.instance.audios)Io.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}let ut=(()=>{class n{}return n.dicePick="",n.dicePut="",n.diceRoll1="",n.diceRoll2="",n.cardDraw="",n.cardPick="",n.cardPut="",n.cardShuffle="",n.piecePick="",n.piecePut="",n.blockPick="",n.blockPut="",n.lock="",n.unlock="",n.sweep="",n.alarm="",n})(),mt=Ig=class extends ca{onStoreAdded(){super.onStoreAdded(),Qe.register(this).on("SOUND_EFFECT",t=>{Qt.play(Jt.instance.get(t.data),.5)}).on("SEND_MESSAGE",t=>{let e=Xe.instance.get(t.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?Ig.play(ut.diceRoll1):Ig.play(ut.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}play(t){Ig.play(t)}static play(t){let e="";e="string"==typeof t?t:t.identifier,Ig._play(e)}static _play(t){Qe.call("SOUND_EFFECT",t)}};var Nf;mt=Ig=be([ai("sound-effect")],mt);let da=Nf=class extends ca{constructor(){super(...arguments),this.viewTableIdentifier="",this.tableGridDummy=!1,this.gridShow=!1,this.gridSnap=!0}static get instance(){return Nf._instance||(Nf._instance=new Nf("TableSelecter"),Nf._instance.initialize()),Nf._instance}onStoreAdded(){super.onStoreAdded(),Qe.register(this).on("SELECT_GAME_TABLE",t=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=t.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}get viewTable(){let t=Xe.instance.get(this.viewTableIdentifier);return t||(t=Xe.instance.getObjects(Jr)[0],t&&(this.viewTableIdentifier.length<1||Xe.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=t.identifier,Qe.trigger("SELECT_GAME_TABLE",{identifier:t.identifier}))),t}};var _b;be([st()],da.prototype,"viewTableIdentifier",void 0),be([st()],da.prototype,"tableGridDummy",void 0),da=Nf=be([ai("TableSelecter")],da);let rr=_b=class extends Xr{constructor(t=fd.generateUuid()){super(t),this.isLock=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.gridColor="#FFFF00",this.rangeColor="#000000",this.type="CORN",this.fillOutLine=!1,this.subDivisionSnapPolygonal=!0,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0),console.log(this.followingCounterDummy)}following(){let t=Xe.instance.get(this.followingCharctorIdentifier);if(!t)return console.log("\u8ffd\u5f93\u5bfe\u8c61\u898b\u5931\u3044"),void(this.followingCharctorIdentifier=null);console.log("following x:"+t.location.x+" y:"+t.location.y),this.location.x=t.location.x+this.gridSize*t.size/2,this.location.y=t.location.y+this.gridSize*t.size/2,this.followingCounterDummyCount()}static create(t,e,i,r,o){let s=null;return s=o?new _b(o):new _b,s.createDataElements(),s.commonDataElement.appendChild(yt.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(yt.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(yt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(yt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};var mb;be([st()],rr.prototype,"isLock",void 0),be([st()],rr.prototype,"rotate",void 0),be([st()],rr.prototype,"followingCharctorIdentifier",void 0),be([st()],rr.prototype,"followingCounterDummy",void 0),be([st()],rr.prototype,"offSetX",void 0),be([st()],rr.prototype,"offSetY",void 0),be([st()],rr.prototype,"gridColor",void 0),be([st()],rr.prototype,"rangeColor",void 0),be([st()],rr.prototype,"type",void 0),be([st()],rr.prototype,"fillOutLine",void 0),be([st()],rr.prototype,"subDivisionSnapPolygonal",void 0),rr=_b=be([ai("range")],rr);let Xo=mb=class extends Xr{constructor(){super(...arguments),this.isLock=!1,this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.limitHeight=!1,this.overViewWidth=250,this.overViewMaxHeight=250}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(t){this.setCommonValue("text",t)}toTopmost(){Pw(this)}static create(t,e,i=16,r=1,o=1,s){let a=s?new mb(s):new mb;return a.createDataElements(),a.commonDataElement.appendChild(yt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(yt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(yt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(yt.create("title",t,{},"title_"+a.identifier)),a.commonDataElement.appendChild(yt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};var wr;be([st()],Xo.prototype,"isLock",void 0),be([st()],Xo.prototype,"rotate",void 0),be([st()],Xo.prototype,"zindex",void 0),be([st()],Xo.prototype,"password",void 0),be([st()],Xo.prototype,"isUpright",void 0),be([st()],Xo.prototype,"limitHeight",void 0),be([st()],Xo.prototype,"overViewWidth",void 0),be([st()],Xo.prototype,"overViewMaxHeight",void 0),Xo=mb=be([ai("text-note")],Xo),function(n){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}n.relation=function t(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},n.parse=e}(wr||(wr={}));class eo{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(t,e=null,i=new eo){return t&&t.ownerDocument?i.setCSS((e||window.getComputedStyle(t)).transform):i.identity()}setData(t){if(null==t)return;let e=t.length;return 16==e?(this.m11=t[0],this.m12=t[1],this.m13=t[2],this.m14=t[3],this.m21=t[4],this.m22=t[5],this.m23=t[6],this.m24=t[7],this.m31=t[8],this.m32=t[9],this.m33=t[10],this.m34=t[11],this.m41=t[12],this.m42=t[13],this.m43=t[14],this.m44=t[15]):6==e?(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=0,this.m21=t[2],this.m22=t[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[4],this.m42=t[5],this.m43=0,this.m44=1):9==e&&(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=t[2],this.m21=t[3],this.m22=t[4],this.m23=0,this.m24=t[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[6],this.m42=t[7],this.m43=0,this.m44=t[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(t){return this.m11*=t,this.m12*=t,this.m13*=t,this.m14*=t,this.m21*=t,this.m22*=t,this.m23*=t,this.m24*=t,this.m31*=t,this.m32*=t,this.m33*=t,this.m34*=t,this.m41*=t,this.m42*=t,this.m43*=t,this.m44*=t,this}unproject(t,e={x:0,y:0,z:0,w:1}){let i=t.x*this.m11+t.y*this.m21+this.m41,r=t.x*this.m12+t.y*this.m22+this.m42,o=t.x*this.m13+t.y*this.m23+this.m43,s=t.x*this.m14+t.y*this.m24+this.m44,a=i+this.m31,g=r+this.m32,w=o+this.m33,G=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==G&&(G=1e-4),a/=G,g/=G,w/=G;let me=w-o;if(0==me)return e.x=i,e.y=r,e.z=o,e.w=o,e;let ve=-o/me;return i+=ve*(a-i),r+=ve*(g-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(t,e={x:0,y:0,z:0,w:1}){let i=t.z,r=t.x*this.m14+t.y*this.m24+i*this.m34+this.m44,o=t.x*this.m11+t.y*this.m21+i*this.m31+this.m41,s=t.x*this.m12+t.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(t){return eo.multiply(this,t,this)}setPosition(t){return this.m41=t.x,this.m42=t.y,this.m43=t.z,this}getPosition(t={x:0,y:0,z:0,w:1}){return t.x=this.m41,t.y=this.m42,t.z=this.m43,t}static makePosition(t,e=new eo){return e.identity(),e.setPosition(t),e}appendPosition(...t){let e;return e=1===t.length?t[0]:{x:t[0],y:t[1],z:t[2],w:1},this.append(eo.makePosition(e,eo.MATRIX3D))}static makePerspective(t,e=new eo){return e.identity(),e.m34=t?-1/t:0,e}appendPerspective(t){return t?this.append(eo.makePerspective(t,eo.MATRIX3D)):this}invert(t){t=t||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,g=this.m22,w=this.m23,G=this.m24,me=this.m31,ve=this.m32,Ie=this.m33,Oe=this.m34,Ve=this.m41,We=this.m42,Ye=this.m43,Ge=this.m44;e[0]=w*Oe*We-G*Ie*We+G*ve*Ye-g*Oe*Ye-w*ve*Ge+g*Ie*Ge,e[1]=s*Ie*We-o*Oe*We-s*ve*Ye+r*Oe*Ye+o*ve*Ge-r*Ie*Ge,e[2]=o*G*We-s*w*We+s*g*Ye-r*G*Ye-o*g*Ge+r*w*Ge,e[3]=s*w*ve-o*G*ve-s*g*Ie+r*G*Ie+o*g*Oe-r*w*Oe;let ct=i*e[0]+a*e[1]+me*e[2]+Ve*e[3];return 0==ct?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=G*Ie*Ve-w*Oe*Ve-G*me*Ye+a*Oe*Ye+w*me*Ge-a*Ie*Ge,e[5]=o*Oe*Ve-s*Ie*Ve+s*me*Ye-i*Oe*Ye-o*me*Ge+i*Ie*Ge,e[6]=s*w*Ve-o*G*Ve-s*a*Ye+i*G*Ye+o*a*Ge-i*w*Ge,e[7]=o*G*me-s*w*me+s*a*Ie-i*G*Ie-o*a*Oe+i*w*Oe,e[8]=g*Oe*Ve-G*ve*Ve+G*me*We-a*Oe*We-g*me*Ge+a*ve*Ge,e[9]=s*ve*Ve-r*Oe*Ve-s*me*We+i*Oe*We+r*me*Ge-i*ve*Ge,e[10]=r*G*Ve-s*g*Ve+s*a*We-i*G*We-r*a*Ge+i*g*Ge,e[11]=s*g*me-r*G*me-s*a*ve+i*G*ve+r*a*Oe-i*g*Oe,e[12]=w*ve*Ve-g*Ie*Ve-w*me*We+a*Ie*We+g*me*Ye-a*ve*Ye,e[13]=r*Ie*Ve-o*ve*Ve+o*me*We-i*Ie*We-r*me*Ye+i*ve*Ye,e[14]=o*g*Ve-r*w*Ve-o*a*We+i*w*We+r*a*Ye-i*g*Ye,e[15]=r*w*me-o*g*me+o*a*ve-i*w*ve-r*a*Ie+i*g*Ie,t.setData(e),t.scalar(1/ct),t)}setCSS(t){if(!t||"none"==t)return this.identity();let e=t.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=wr.parse(e[r]);return this.setData(e)}appendCSS(t,e=!1){return t&&"none"!=t?e&&t.indexOf("matrix3d")>=0?this.append(eo.MATRIX3D.setCSS(t).flatten()):this.append(eo.MATRIX3D.setCSS(t)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(t,e,i=new eo){let o=t.m11*e.m12+t.m12*e.m22+t.m13*e.m32+t.m14*e.m42,s=t.m11*e.m13+t.m12*e.m23+t.m13*e.m33+t.m14*e.m43,a=t.m11*e.m14+t.m12*e.m24+t.m13*e.m34+t.m14*e.m44,g=t.m21*e.m11+t.m22*e.m21+t.m23*e.m31+t.m24*e.m41,w=t.m21*e.m12+t.m22*e.m22+t.m23*e.m32+t.m24*e.m42,G=t.m21*e.m13+t.m22*e.m23+t.m23*e.m33+t.m24*e.m43,me=t.m21*e.m14+t.m22*e.m24+t.m23*e.m34+t.m24*e.m44,ve=t.m31*e.m11+t.m32*e.m21+t.m33*e.m31+t.m34*e.m41,Ie=t.m31*e.m12+t.m32*e.m22+t.m33*e.m32+t.m34*e.m42,Oe=t.m31*e.m13+t.m32*e.m23+t.m33*e.m33+t.m34*e.m43,Ve=t.m31*e.m14+t.m32*e.m24+t.m33*e.m34+t.m34*e.m44,We=t.m41*e.m11+t.m42*e.m21+t.m43*e.m31+t.m44*e.m41,Ye=t.m41*e.m12+t.m42*e.m22+t.m43*e.m32+t.m44*e.m42,Ge=t.m41*e.m13+t.m42*e.m23+t.m43*e.m33+t.m44*e.m43,ct=t.m41*e.m14+t.m42*e.m24+t.m43*e.m34+t.m44*e.m44;return i.m11=t.m11*e.m11+t.m12*e.m21+t.m13*e.m31+t.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=g,i.m22=w,i.m23=G,i.m24=me,i.m31=ve,i.m32=Ie,i.m33=Oe,i.m34=Ve,i.m41=We,i.m42=Ye,i.m43=Ge,i.m44=ct,i}toString(t=3){return"m11="+this.m11.toFixed(t)+"\tm21="+this.m21.toFixed(t)+"\tm31="+this.m31.toFixed(t)+"\tm41="+this.m41.toFixed(t)+"\nm12="+this.m12.toFixed(t)+"\tm22="+this.m22.toFixed(t)+"\tm32="+this.m32.toFixed(t)+"\tm42="+this.m42.toFixed(t)+"\nm13="+this.m13.toFixed(t)+"\tm23="+this.m23.toFixed(t)+"\tm33="+this.m33.toFixed(t)+"\tm43="+this.m43.toFixed(t)+"\nm14="+this.m14.toFixed(t)+"\tm24="+this.m24.toFixed(t)+"\tm34="+this.m34.toFixed(t)+"\tm44="+this.m44.toFixed(t)}}eo.MATRIX3D=new eo;class Gm{constructor(t){this.matrix=new eo,this.sceneTransform=new eo,this.inverseSceneTransform=new eo,this.initialize(t)}clear(){return this.element=null,this.matrix.identity(),this}initialize(t){if(!t)return;this.element=t;let e=window.getComputedStyle(t),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=wr.relation(e.paddingTop,i),this.paddingTop=wr.relation(e.paddingTop,r),this.marginLeft=wr.relation(e.marginLeft,i),this.marginTop=wr.relation(e.marginTop,r),this.borderLeft=wr.relation(e.borderLeft,i),this.borderTop=wr.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(t,e,i,r){let o_x=t,o_y=e,o_z=i,s=new Gm(r),a=eo.multiply(this.sceneTransform,s.inverseSceneTransform),g={x:0,y:0,z:0,w:1};return g.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,g.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,g.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,g.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(g),g}extract(t,e){let r=t.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(t,e=null){if(e||(e=new eo),!t)return e;let i=t,r=window.getComputedStyle(t);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],g=wr.relation(a[0],i.offsetWidth,.5*i.offsetWidth),w=wr.relation(a[1],i.offsetHeight,.5*i.offsetHeight),G=wr.relation(a[2],0,0);e.appendPosition(-g,-w,-G),e.appendCSS(r.transform),e.appendPosition(g,w,G)}let o=this.getPosition(t);e.appendPosition(o.x,o.y,0);let s=0;if(t.parentElement){let a=window.getComputedStyle(t.parentElement);s=wr.parse(a.perspective)}if(t.parentElement&&s){let g=window.getComputedStyle(t.parentElement).perspectiveOrigin.split(" "),w=wr.relation(g[0],i.parentElement.offsetWidth),G=wr.relation(g[1],i.parentElement.offsetHeight);e.appendPosition(-w,-G,0),e.appendPerspective(s),e.appendPosition(w,G,0)}return e}getPosition(t){let e={x:0,y:0};return e.x=t.offsetParent?t.parentElement===t.offsetParent?t.offsetLeft:t.parentElement.offsetParent===t.offsetParent?t.offsetLeft-t.parentElement.offsetLeft:0:t.offsetLeft,e.y=t.offsetParent?t.parentElement===t.offsetParent?t.offsetTop:t.parentElement.offsetParent===t.offsetParent?t.offsetTop-t.parentElement.offsetTop:0:t.offsetTop,e.x+=t.offsetParent?t.offsetParent.clientLeft:0,e.y+=t.offsetParent?t.offsetParent.clientTop:0,e}fromBorderBox(t){t.x+=this.paddingLeft,t.y+=this.paddingTop,t.x-=this.marginLeft,t.y-=this.marginTop,t.x-=this.borderLeft,t.y-=this.borderTop}toBorderBox(t){t.x-=this.paddingLeft,t.y-=this.paddingTop,t.x+=this.marginLeft,t.y+=this.marginTop,t.x+=this.borderLeft,t.y+=this.borderTop}}let md=(()=>{class n{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new Gm(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new Gm(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new Gm(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return n.\u0275fac=function(e){return new(e||n)(In(Di))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qm=(()=>{class n{constructor(e){this.coordinateService=e,this._emptyTable=new Jr(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Kc(()=>Xe.instance.getObjects(Bt).filter(i=>i.isVisibleOnTable)),this.cardCache=new Kc(()=>Xe.instance.getObjects(Qr).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Kc(()=>Xe.instance.getObjects(xr).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Kc(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.tableScratchMaskCache=new Kc(()=>{let i=this.tableSelecter.viewTable;return i?i.scratchMasks:[]}),this.rangeCache=new Kc(()=>Xe.instance.getObjects(rr).filter(i=>i.isVisibleOnTable)),this.terrainCache=new Kc(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Kc(()=>Xe.instance.getObjects(Xo)),this.diceSymbolCache=new Kc(()=>Xe.instance.getObjects(zs)),this.initialize()}get tableSelecter(){return da.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get tableScratchMasks(){return this.tableScratchMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Xe.instance.getObjects(_t)}initialize(){this.refreshCacheAll(),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(So.aliasName),this.refreshCache(Do.aliasName),void this.refreshCache(go.aliasName);let i=Xe.instance.get(e.data.identifier);i&&i instanceof Xr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let i=e.data.xmlElement;console.log("parseXml todo:\u7acb\u4f53\u5730\u5f62\u306e\u4e0a\u306b\u30c9\u30ed\u30c3\u30d7\u3057\u305f\u6642\u306e\u6319\u52d5");let r=Ji.instance.parseXml(i);if(r instanceof Xr){console.log("TabletopObject \u8ffd\u52a0");let s=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=s.x-25,r.location.y=s.y-25,r.posZ=s.z,this.placeToTabletop(r),mt.play(ut.piecePut)}else r instanceof Ha&&Ls.instance.addChatTab(r);let o=Xe.instance.getObjects(Bt);for(let s of o)s instanceof Bt&&(console.log("GameCharacter Load \u8ffd\u52a0\u30c7\u30fc\u30bf\u78ba\u8a8d"),s.addExtendData())})}findCache(e){switch(e){case Bt.aliasName:return this.characterCache;case Qr.aliasName:return this.cardCache;case xr.aliasName:return this.cardStackCache;case So.aliasName:return this.tableMaskCache;case Do.aliasName:return this.tableScratchMaskCache;case rr.aliasName:return this.rangeCache;case go.aliasName:return this.terrainCache;case Xo.aliasName:return this.textNoteCache;case zs.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.tableScratchMaskCache.refresh(),this.rangeCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case So.aliasName:e instanceof So&&(e.isLock=!1);case go.aliasName:if(e instanceof go&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return n.\u0275fac=function(e){return new(e||n)(In(md))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac}),n})();class Kc{constructor(t){this.refreshCollector=t,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}var bl;let Of=bl=class extends Si{constructor(){super(...arguments),this._defaultDiceBot="DiceBot",this._roomVolume=1,this._roomGridDispAlways=!1}get defaultDiceBot(){return""==this._defaultDiceBot?"DiceBot":this._defaultDiceBot}set defaultDiceBot(t){this._defaultDiceBot=t}get roomVolume(){return this._roomVolume}set roomVolume(t){this._roomVolume=t}get jukebox(){return Xe.instance.get("Jukebox")}get roomGridDispAlways(){return this._roomGridDispAlways}set roomGridDispAlways(t){this._roomGridDispAlways=t}static get instance(){return bl._instance||(bl._instance=new bl("Config"),bl._instance.initialize()),bl._instance}parseInnerXml(t){let e=bl.instance.toContext();e.syncData=this.toContext().syncData,bl.instance.apply(e),bl.instance.update(),super.parseInnerXml.apply(bl.instance,[t]),this.destroy()}apply(t){let e=this._roomVolume,i=this._defaultDiceBot;super.apply(t),i!==this._defaultDiceBot&&console.log("this._defaultDiceBot\u5909\u66f4"),e!==this._roomVolume&&(this.jukebox.setNewVolume(),console.log("\u5168\u4f53\u30dc\u30ea\u30e5\u30fc\u30e0\u5909\u66f4"))}};be([st()],Of.prototype,"_defaultDiceBot",void 0),be([st()],Of.prototype,"_roomVolume",void 0),be([st()],Of.prototype,"_roomGridDispAlways",void 0),Of=bl=be([ai("config")],Of);class Bf{constructor(t,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=t,this.sendTo=e,this.data=i}static createSendTask(t,e,i){let r=new Bf(t,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(t){let e=new Bf(t);return e.onstart=()=>e.initializeReceive(),e}start(t){this.onstart?(this.data=t,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(t,e){this.onprogress&&this.onprogress(this,t,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Qe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Qe.unregister(this),this.sendChankTimer&&function q9(n){bm.delete(n)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=la.encode(this.data);let t=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(t),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Qe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Yo(()=>this.sendChank(0))}sendChank(t){let e=this.uint8Array.slice(t*this.chankSize,(t+1)*this.chankSize);Qe.call("FILE_SEND_CHANK_"+this.identifier,{index:t,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=t,this.sendChankTimer=null,this.chanks.length<=t+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Yo(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=t?this.resetTimeout():this.sendChankTimer=Yo(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Qe.register(this).on("FILE_SEND_CHANK_"+this.identifier,t=>{this.chanks.length<1&&(this.chanks=new Array(t.data.length)),null==this.chanks[t.data.index]?(this.chankReceiveCount++,this.chanks[t.data.index]=t.data.chank,this.progress(t.data.index,t.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Qe.call("FILE_MORE_CHANK_"+this.identifier,t.data.index,t.sendFrom))):console.log(`already received. [${t.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",t=>{t.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,t.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,t=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,t.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let t=0;for(let r of this.chanks)t+=r.byteLength;this.outputTransferRate(t);let e=new Uint8Array(t),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=la.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new cc(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(t){let e=performance.now()-this.startTime,i=t/1024/1024/(e/1e3);console.log(`${(t/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class kg{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return kg._instance||(kg._instance=new kg),kg._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Qe.register(this).on("CONNECT_PEER",-1,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",t.data.peerId),Jt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+t.sendFrom);let e=t.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=Jt.instance.get(o.identifier);null===s&&(s=ua.createEmpty(o.identifier),Jt.instance.add(s)),s.state<Io.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Jt.instance.getCatalog().length&&Jt.instance.synchronize(t.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],t.sendFrom)}).on("REQUEST_AUDIO_RESOURE",t=>{if(t.isSendFromSelf)return;let e=t.data.identifiers,i=[];for(let r of e){let o=Jt.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(t.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+t.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=Jt.instance.get(i[r].identifier);this.startSendTask(s,t.data.receiver)}else{let r=t.data.candidatePeers,o=r.indexOf($t.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+t.data.identifiers),void Qe.call(t,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+t.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,t=>{let e=t.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+t.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Jt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",t=>{console.log("START_AUDIO_TRANSMISSION "+t.data.fileIdentifier);let e=t.data.fileIdentifier,i=Jt.instance.get(e);this.receiveTaskMap.has(e)||i&&Io.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Qe.call("CANCEL_TASK_"+e,null,t.sendFrom)):this.startReceiveTask(e)})}destroy(){Qe.unregister(this)}startSendTask(t,e){var i=this;return(0,xn.Z)(function*(){let r=Bf.createSendTask(t.identifier,e);i.sendTaskMap.set(t.identifier,r),Qe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:t.identifier},e);let o={identifier:t.identifier,name:t.name,blob:null,type:"",url:null};t.state===Io.URL?o.url=t.url:(o.blob=yield vl.readAsArrayBufferAsync(t.blob),o.type=t.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Jt.instance.synchronize()},r.start(o)})()}startReceiveTask(t){let e=Jt.instance.get(t),i=Bf.createReceiveTask(t);this.receiveTaskMap.set(t,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&Qe.trigger("UPDATE_AUDIO_RESOURE",[o]),Jt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=$t.peerIds;i.splice(i.indexOf($t.peerId),1),Qe.call("REQUEST_AUDIO_RESOURE",{identifiers:t,receiver:$t.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}var Lf,Wm=ye(4327),CP=ye(5650);!function(n){const t={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};n.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return t[o]?t[o]:""},n.extension=function i(r){for(let o in t)if(t[o]===r)return o;return r.split("/")[1]}}(Lf||(Lf={}));class yl{constructor(){this.networkService=$t,this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return yl._instance||(yl._instance=new yl),yl._instance}get reloadCheck(){return Xe.instance.get("ReloadCheck")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=t=>this.onDragEnter(t),this.callbackOnDragOver=t=>this.onDragOver(t),this.callbackOnDrop=t=>this.onDrop(t),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(t){t.preventDefault()}onDragOver(t){t.preventDefault()}onDrop(t){t.preventDefault(),this.reloadCheck.reloadCheckStart(""!=this.networkService.peerContext.roomName),console.log("onDrop",t.dataTransfer),this.load(t.dataTransfer.files)}load(t){var e=this;return(0,xn.Z)(function*(){if(!t)return;let i=t instanceof FileList?wP(t):t;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Qe.trigger("FILE_LOADED",{file:r})})()}handleImage(t){var e=this;return(0,xn.Z)(function*(){if(!(t.type.indexOf("image/")<0)&&e.reloadCheck.isLoadOk()){if(e.maxImageSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield xt.instance.addAsync(t)}})()}handleAudio(t){var e=this;return(0,xn.Z)(function*(){if(!(t.type.indexOf("audio/")<0)){if(e.maxAudioeSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield Jt.instance.addAsync(t)}})()}handleText(t){var e=this;return(0,xn.Z)(function*(){if(t.type.indexOf("text/")<0)return;let i=!0;if(("config.xml"==t.name||"imagetag.xml"==t.name||"summary.xml"==t.name)&&(i=e.reloadCheck.isLoadOk()),i){console.log(t.name+" type:"+t.type);try{let r=Wc.xml2element(yield vl.readAsTextAsync(t));r&&Qe.trigger("XML_LOADED",{xmlElement:r})}catch(r){console.warn(r)}}})()}handleZip(t){var e=this;return(0,xn.Z)(function*(){if(!(0<=t.type.indexOf("application/")||t.type.length<1))return;let i=new CP;try{i=yield i.loadAsync(t)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:Lf.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(t,e,i){return(0,xn.Z)(function*(){if(!t)return;let r=t instanceof FileList?wP(t):t,o=new CP;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,Wm.saveAs)(s,e+".zip")})()}}function wP(n){let t=[],e=n.length;for(let i=0;i<e;i++)t.push(n[i]);return t}class Mg{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return Mg._instance||(Mg._instance=new Mg),Mg._instance}initialize(){var t=this;Qe.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),xt.instance.synchronize())}).on("XML_LOADED",e=>{!function wG(n){let t=[],e=n.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!xt.instance.get(r)&&0<Lf.type(r).length&&t.push(r)}e=n.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!xt.instance.get(r)&&0<Lf.type(r).length&&t.push(r)}for(let i of t)xt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=xt.instance.get(o.identifier);null===s&&(s=Ot.createEmpty(o.identifier),xt.instance.add(s)),s.state<zr.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<xt.instance.getCatalog().length&&xt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,xn.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=xt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===t.isLimitSendTask()&&0<o.length&&!t.existsSendTask(i.data.receiver)){let s=t.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),t.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf($t.peerId);-1<a&&s.splice(a,1);for(let g of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+g+" -> "+i.data.identifiers),void Qe.call(i,g);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),xt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=xt.instance.get(i);this.receiveTaskMap.has(i)||r&&zr.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Qe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Qe.unregister(this)}startSendTask(t,e){var i=this;return(0,xn.Z)(function*(){let r=1===t.length?t[0].identifier:fd.generateUuid(),o=Bf.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),Qe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of t)s.thumbnail.blob?s.thumbnail.blob=yield vl.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield vl.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),xt.instance.synchronize()},o.start(t)})()}startReceiveTask(t){let e=Bf.createReceiveTask(t);this.receiveTaskMap.set(t,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Qe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),xt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=$t.peerIds;i.splice(i.indexOf($t.peerId),1),Qe.call("REQUEST_FILE_RESOURE",{identifiers:t,receiver:$t.peerId,candidatePeers:i},e)}makeSendUpdateImages(t,e=524288){let i=[],r=0;for(let o=t.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[t[o],t[s]]=[t[s],t[o]]}t.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<t.length;o++){let s=t[o],a=xt.instance.get(s.identifier),g={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===zr.URL?g.url=a.url:s.state===zr.NULL?(g.thumbnail.blob=a.thumbnail.blob,g.thumbnail.type=a.thumbnail.type):(g.blob=a.blob,g.type=a.blob.type);let w=g.blob?g.blob.size:g.thumbnail.blob?g.thumbnail.blob.size:100;if(i.push(g),r+=w,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}const Fw=new Map,Rw=new Set;let Nw=!1;function EP(n,t=$t.peerId){Fw.set(n.identifier,{object:n,originFrom:t}),n instanceof Si&&function EG(n){let t=n;for(;t&&(Rw.add(t.identifier),t=t.parent,t!==n););TP()}(n.parent),TP()}function TP(){Nw||(queueMicrotask(TG),Nw=!0)}const TG=()=>{Nw=!1;let n=Array.from(Fw.values()),t=Array.from(Rw.values());Fw.clear(),Rw.clear();for(let e of n){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};Qe.trigger(new Cg(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),Qe.trigger(new Cg(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of t)Qe.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};class Er{constructor(t){this.peerId=t,this.requestMap=new Map}static create(t,e){Er.tasksMap.size<1&&Qe.register(Er.key).on("DISCONNECT_PEER",r=>{Er.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Er.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Er.onUpdate(r.data.identifier)});let i=new Er(t);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let t of this.requestMap.values())this.deleteTasksMap(t.identifier);this.requestMap.clear()}initialize(t){for(let e of t){e.ttl--,this.requestMap.set(e.identifier,e);let i=Er.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Er.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Qe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(t=>0<=t.ttl)),this.finish()}static onDisconnect(t){for(let e of Er.tasksMap.values())for(let i of e.concat())i.peerId===t&&i.timeout();Er.tasksMap.size<1&&Qe.unregister(Er.key)}static onUpdate(t){if(!Er.tasksMap.has(t))return;let e=Er.tasksMap.get(t);for(let i of e.concat())i.onUpdate(t);Er.tasksMap.size<1&&Qe.unregister(Er.key)}onUpdate(t){this.requestMap.delete(t),this.onsynchronize&&this.onsynchronize(this,t),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(t){let e=Er.tasksMap.get(t),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Er.tasksMap.delete(t)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new cc(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Er.key={},Er.tasksMap=new Map;class Ag{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Ag._instance||(Ag._instance=new Ag),Ag._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Qe.register(this).on("CONNECT_PEER",2,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",t.data.peerId),this.sendCatalog(t.data.peerId))}).on("DISCONNECT_PEER",t=>{this.removePeerMap(t.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+t.sendFrom);let e=t.data;for(let i of e)Xe.instance.isDeleted(i.identifier)?Qe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},t.sendFrom):this.addRequestMap(i,t.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",t=>{if(!t.isSendFromSelf)if(Xe.instance.isDeleted(t.data))Qe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:t.data},t.sendFrom);else{let e=Xe.instance.get(t.data);e&&Qe.call("UPDATE_GAME_OBJECT",e.toContext(),t.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,t=>{let e=t.data,i=Xe.instance.get(e.identifier);i?(t.isSendFromSelf||(i=this.updateObject(i,e)),EP(i,t.sendFrom)):Xe.instance.isDeleted(e.identifier)?Qe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},t.sendFrom):(i=this.createObject(e),EP(i,t.sendFrom))}).on("DELETE_GAME_OBJECT",1e3,t=>{Xe.instance.delete(t.data.identifier,!1)})}destroy(){Qe.unregister(this)}updateObject(t,e){return e.majorVersion+e.minorVersion>t.version&&t.apply(e),t}createObject(t){let e=fc.instance.create(t.aliasName,t.identifier);if(e)return Xe.instance.add(e,!1),e.apply(t),e;console.warn(t.aliasName+" is Unknown...?",t)}sendCatalog(t){let e=Xe.instance.getCatalog(),i=setInterval(()=>{Qe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),t),e.length<1&&clearInterval(i)})}addRequestMap(t,e){let i=this.requestMap.get(t.identifier);i&&i.version===t.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<t.version)&&(this.requestMap.set(t.identifier,{identifier:t.identifier,version:t.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(t){this.peerMap.has(t)||this.peerMap.set(t,[])}removePeerMap(t){this.peerMap.delete(t)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let t=this.getTargetPeerId(),e=this.makeRequestList(t);if(e.length<1)return void this.removePeerMap(t);let i=Er.create(t,e);this.tasks.push(i);let r=this.peerMap.get(t);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(t);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(t,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(t))continue;let s=Xe.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let t=9999,e=null,i=$t.peerContexts;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<t&&(t=o.length,e=r.peerId)}return e}}class SP{constructor(t="Queue"){this.name=t,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(t){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof t.then?()=>t:0<t.length?()=>new Promise(t):t);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var Ow;let pc=Ow=class extends Si{constructor(){super(...arguments),this.name="\u30c0\u30a4\u30b9\u8868",this.command="SAMPLE",this.dice="1d6",this.text=""}get diceTablePalette(){for(let t of this.children)if(t instanceof jm)return t;return null}static create(){let t=new Ow;t.name="\u767d\u7d19\u306e\u30c0\u30a4\u30b9\u8868",t.initialize();let e=new jm("table_"+t.identifier);return e.setPalette("\u30c0\u30a4\u30b9\u8868\u5165\u529b\u4f8b\uff1a\n1:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u68ee\u3011\n2:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u6d77\u3011\n3:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u5e73\u5730\u3011\n4:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u6cbc\u3011\n5:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u7a7a\u3011\n6:\u30c0\u30a4\u30b9\u8868\u30c1\u30e3\u30fc\u30c8\u4f8b\u3010\u5c71\u3011"),e.initialize(),t.appendChild(e),t}apply(t){super.apply(t)}};be([st()],pc.prototype,"name",void 0),be([st()],pc.prototype,"command",void 0),be([st()],pc.prototype,"dice",void 0),pc=Ow=be([ai("dice-table")],pc);var Tr,DP=ye(5904);class Xc extends DP.default{constructor(t,e){const i=t.replace(/^repeat/i,"x").replace(/^rep/i,"x").match(/^x([0-9]+)\s+(.*)/i);let r,o;null!==i?(o=parseInt(i[1],10),o<=0&&(o=1),r=i[2]):(o=1,r=t);const s=r.replace(/^KD/i,"2D6").replace(/^SKD/i,"S2D6");super(o>1?`x${o} ${s}`:s,e),this.command=t,this.commandWithoutRepeat=r,this.repeat=o}static eval(t){return new Xc(t).eval()}eval(){return this.commandWithoutRepeat.match(/^KD/i)||this.commandWithoutRepeat.match(/^SKD/i)?this.custom_dice():super.eval()}custom_dice(){const t=super.eval();if(null==t)return null;let i,e=0;for(let o=0;o<this.repeat;o++)t.detailedRands[2*o].value===t.detailedRands[2*o+1].value&&(e+=1);i=1==this.repeat&&1==e?" \uff1e \u30be\u30ed\u76ee\uff01":e>=1?`\n\n\uff1e \u30be\u30ed\u76ee${e}\u500b\uff01`:"";const r=t.text+i;return Object.assign(Object.assign({},t),{text:r})}}Xc.ID="KariDice",Xc.NAME="\u4eee\u30c0\u30a4\u30b9",Xc.SORT_KEY="\u304b\u308a\u305f\u3044\u3059",Xc.COMMAND_PATTERN=/^S?([+\-(]*\d+|\d+B\d+|C[+\-(]*\d+|choice|D66|(repeat|rep|x)\d+|\d+R\d+|\d+U\d+|BCDiceVersion|KD)/i,Xc.HELP_MESSAGE="\n\u30fbKD\n\u30be\u30ed\u76ee\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\n".trim();class Qc extends DP.default{constructor(t,e){const i=t.replace(/^repeat/i,"x").replace(/^rep/i,"x").match(/^x([0-9]+)\s+(.*)$/i);let r,o;null!==i?(o=parseInt(i[1],10),o<=0&&(o=1),r=i[2]):(o=1,r=t);let s="",g=r.match(/^([S]?)ID(\d*)<=([\d\-\+\*\/\(\)CR]+)(.*)$/i);if(g){let ve=""==g[2]?"1":g[2],Ie=g[2];return parseInt(ve,10)<1&&(ve="1",Ie=""),s=g[1]+ve+"b100<="+g[3],super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,this.repeat=o,this.dicenum=parseInt(ve,10),this.option=g[4].split(/\s/)[0],this.optionCommand(this.option),void(this.dispCommandId=g[1]+"ID"+Ie+"<=")}if(g=r.match(/^([S]?)1d100<=([\d\-\+\*\/\(\)CR]+)(.*)$/i),g&&""==g[3].split(/\s/)[0])return console.log("matchResult"+g),s=g[1]+"1d100<="+g[2],super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=g[1]+"1d100<="+g[2],this.repeat=o,this.dicenum=1,void(this.dispCommandId="1d100<=");if(g=r.match(/^([S]?)RES\(([\d\-\+\*\/\(\)CR]+)\)(.*)$/i),g&&""==g[3].split(/\s/)[0])return s=g[1]+"1d100<=("+g[2]+")*5+50",super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,void(this.repeat=o);if(g=r.match(/^([S]?)CBR\((\d+),(\d+)\)(.*)$/i),g&&""==g[4].split(/\s/)[0]){const ve=parseInt(g[2],10),Ie=parseInt(g[3],10);return s=g[1]+"1d100<="+(ve<Ie?ve:Ie),console.log("val1:"+ve+" val2:"+Ie+" text:"+s),super(o>1?`x${o} ${s}`:s,e),console.log("matchResult"+g),this.commandWithoutRepeat=r,this.repeat=o,void(this.dispCommandCbr="1d100<="+g[2]+","+g[3])}s=r,super(o>1?`x${o} ${s}`:s,e),this.commandWithoutRepeat=r,this.repeat=o,this.dispCommandId=""}static eval(t){return new Qc(t).eval()}eval(){return this.commandWithoutRepeat.match(/^S?ID/i)?this.chkOptionCommand(this.option)?this.custom_dice_id():null:this.dispCommandId.match(/^1d100<=/i)?this.custom_dice_d100():this.commandWithoutRepeat.match(/^S?RES/i)?this.custom_dice_res():this.commandWithoutRepeat.match(/^S?CBR/i)?this.custom_dice_cbr():super.eval()}chkOptionCommand(t){return""==t.replace(/P/i,"S4C10").replace(/S\d+/i,"").replace(/C\d+/i,"").replace(/F\d+|B/i,"")}optionCommand(t){this.critical=5,this.famble=96,this.special=5;const e=t.match(/C(\d+)/i);e&&(this.critical=parseInt(e[1],10));const i=t.match(/F(\d+)/i);i&&(this.famble=parseInt(i[1],10));const r=t.match(/S(\d+)/i);r&&(this.special=parseInt(r[1],10)),t.match(/B/i)&&(this.famble=100),t.match(/P/i)&&(this.special=4,this.critical=10),console.log("C:"+this.critical+" F:"+this.famble+" S:"+this.special)}diceResultTextSingleId(t){let e="("+this.dispCommandId.toUpperCase()+this.target+")";if(5!=this.special&&(e+=" S"+this.special),5!=this.critical&&(e+=" C"+this.critical),96!=this.famble&&(e+=" F"+this.famble),e+=" \uff1e ",1==t.length)e+=t[0]+" \uff1e ",e+=t[0]>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t[0]>this.target?"\u5931\u6557":t[0]<=this.critical&&t[0]<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t[0]<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t[0]<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f";else{for(let i=0;i<t.length;i++)0!=i&&(e+=","),e+=t[i];e+=" \uff1e ";for(let i=0;i<t.length;i++)0!=i&&(e+=","),e+=t[i]>=100?"100F":t[i]>=this.famble?"F":t[i]>this.target?"X":t[i]<=1?"1C":t[i]<=this.critical?"C":t[i]<=this.target/this.special?"S":"N"}return e}custom_dice_id(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/b100<=(\d+)/i);if(!e)return null;this.target=parseInt(e[1],10);let i="";for(let o=0;o<this.repeat;o++){const s=[];for(let a=0;a<this.dicenum;a++)s.push(t.detailedRands[this.dicenum*o+a].value);this.repeat>1?(o>0&&(i+="\n\n"),i+="#"+(o+1)+"\n"+this.diceResultTextSingleId(s)):i+=this.diceResultTextSingleId(s)}const r=i;return Object.assign(Object.assign({},t),{text:r})}diceResultTextSingleD100(t){let e="("+this.dispCommandId.toUpperCase()+this.target+")";return this.critical=5,this.famble=96,this.special=5,e+=" \uff1e "+t+" \uff1e ",e+=t>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t>this.target?"\u5931\u6557":t<=this.critical&&t<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f",e}custom_dice_d100(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;this.target=parseInt(e[1],10),console.log("target:"+e);let i="";for(let o=0;o<this.repeat;o++){let s;s=t.detailedRands[o].value,this.repeat>1?(o>0&&(i+="\n\n"),i+="#"+(o+1)+"\n"+this.diceResultTextSingleD100(s)):i+=this.diceResultTextSingleD100(s)}const r=i;return Object.assign(Object.assign({},t),{text:r})}diceResultTextSingleRes(t,e){let i="(1D100<="+e+") \uff1e ";return e>=100?i+="\u81ea\u52d5\u6210\u529f":e<=0?i+="\u81ea\u52d5\u5931\u6557":t<=e?(i+=t+" \uff1e ",i+="\u6210\u529f"):(i+=t+" \uff1e ",i+="\u5931\u6557"),i}custom_dice_res(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;const i=parseInt(e[1],10);let r="";for(let s=0;s<this.repeat;s++){const a=t.detailedRands[s].value;console.log("dice value:"+a),this.repeat>1?(s>0&&(r+="\n\n"),r+="#"+(s+1)+"\n"+this.diceResultTextSingleRes(a,i)):r+=this.diceResultTextSingleRes(a,i)}const o=r;return Object.assign(Object.assign({},t),{text:o})}diceResultTextSingleCbr(t,e){let i="("+this.dispCommandCbr+") \uff1e ";return this.target=e,this.critical=5,this.special=5,this.famble=96,i+=t+" \uff1e ",i+=t>=this.famble?"\u81f4\u547d\u7684\u5931\u6557":t>this.target?"\u5931\u6557":t<=this.critical&&t<=this.target/this.special?"\u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb":t<=this.critical?"\u6c7a\u5b9a\u7684\u6210\u529f":t<=this.target/this.special?"\u30b9\u30da\u30b7\u30e3\u30eb":"\u6210\u529f",i}custom_dice_cbr(){const t=super.eval();if(null==t)return null;console.log("result:"+t.text);const e=t.text.match(/1d100<=(\d+)/i);if(!e)return null;const i=parseInt(e[1],10);let r="";for(let s=0;s<this.repeat;s++){const a=t.detailedRands[s].value;console.log("dice value:"+a),this.repeat>1?(s>0&&(r+="\n\n"),r+="#"+(s+1)+"\n"+this.diceResultTextSingleCbr(a,i)):r+=this.diceResultTextSingleCbr(a,i)}const o=r;return Object.assign(Object.assign({},t),{text:o})}}Qc.ID="IdoDice",Qc.NAME="\u30a4\u30c9\u306e\u8a3c\u660e",Qc.SORT_KEY="\u3044\u3068\u306e\u3057\u3087\u3046\u3081\u3044",Qc.COMMAND_PATTERN=/^S?([+\-(]*\d+|\d+B\d+|C[+\-(]*\d+|choice|D66|(repeat|rep|x)\d+|\d+R\d+|\d+U\d+|BCDiceVersion|ID\d*<=[+\-(]*\d+|RES\([\+\-\d\(\)\/\*CR]+\)|CBR\(\d+,\d+\))/i,Qc.HELP_MESSAGE="\n\u30fb\u5186\u67f1\u306e\u8eab\u5185\u7528\u306b\u4f5c\u6210\u3057\u305f\u30ab\u30b9\u30bf\u30e0\u30c0\u30a4\u30b9\n1d100\u3068\u76ee\u6a19\u5024\u306b\u3088\u308b\u6210\u529f\u5ea6\u3092\u7b97\u51fa\u3057\u307e\u3059\u3002\n\n\u30fbCoC\u3068\u306f\u4f3c\u3066\u3044\u307e\u3059\u304c\u5224\u5b9a\u57fa\u6e96\u7d30\u90e8\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\u30fbF\u5024(\u6a19\u6e9696)\u4ee5\u4e0a\uff1e\u30d5\u30a1\u30f3\u30d6\u30eb\n\u30fb\u76ee\u6a19\u5024\u3092\u8d85\u3048\u308b\uff1e\u5931\u6557\n\u30fb\u76ee\u6a19\u5024\u3092\u4ee5\u4e0b\uff1e\u6210\u529f\n\u30fb1/S\u5024(\u6a19\u6e961/5)\u4ee5\u4e0b\uff1e\u30b9\u30da\u30b7\u30e3\u30eb\n\u30fbC\u5024(\u6a19\u6e965)\u4ee5\u4e0b\uff1e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\n\n\u30fb\u5c02\u7528\u547d\u4ee4(ID<=x(\u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\uff1a\u7701\u7565\u53ef))\n  \u4f7f\u7528\u4f8b)\u6280\u80fd\u5024200\u3067\u5224\u5b9a\u3059\u308b\u5834\u5408\n  ID<=200 :1d100<=200\u3068\u540c\u3058\n  (ID<=200) \u2192 31 \u2192 \u30b9\u30da\u30b7\u30e3\u30eb\n  \u25a0\u8ffd\u52a0\u6587\u5b57\u5b9a\u7fa9\n    Fn\uff1aF\u5024n\u3067\u5224\u5b9a \u7121\u6307\u5b9a\u306fn=96\u6271\u3044\n      ID<=200F90\n      (ID<=200F90) F90 \u2192 91 \u2192 \u81f4\u547d\u7684\u5931\u6557\n    Sn\uff1aS\u5024\u30921/n\u306b\u5909\u66f4\u3059\u308b \u7121\u6307\u5b9an=5\u6271\u3044\n      ID<=200S3\n      (ID<=200S3) S3 \u2192 65 \u2192 \u30b9\u30da\u30b7\u30e3\u30eb\n    Cn\uff1aC\u5024\u3092n\u306b\u5909\u66f4\u3059\u308b \u7121\u6307\u5b9an=5\u6271\u3044\n      ID<=200C10\n      (ID<=200C10) C10 \u2192 10 \u2192 \u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb\n    P\uff1a\u30d1\u30fc\u30d5\u30a7\u30af\u30c8\u30aa\u30fc\u30c0\u30fc\u72b6\u614bS\u50241/4\u3001C10\u3067\u5224\u5b9a(S4C10\u3068\u540c\u3058)\n      ID<=200P\n      (ID<=200P) S4 C10 \u2192 41 \u2192 \u30b9\u30da\u30b7 \u30e3\u30eb\n    B\uff1a\u30dc\u30b9\u30d5\u30e9\u30b0F\u5024100\u3067\u5224\u5b9a(F100\u3068\u540c\u3058)\n    ID<=200B\n    (ID<=200B) F100 \u2192 99 \u2192 \u6210\u529f\n    \u8907\u6570\u7a2e\u540c\u6642\u5b9a\u7fa9\u53ef\u80fd\n      ID<=200BC20S3\u3000\u30dc\u30b9\u304cC\u502420S1/3\u3067\u5224\u5b9a\n      (ID<=200BC20S3) S3 C20 F100 \u2192 15 \u2192 \u6c7a\u5b9a\u7684\u6210\u529f/\u30b9\u30da\u30b7\u30e3\u30eb\n\n\u30fb\u8907\u6570\u5224\u5b9a(IDy<=x(\u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\uff1a\u7701\u7565\u53ef)):\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u524d\u8ff0\u306e\u66f8\u5f0f\u3068\u540c\u69d8\n\n    y\u56de\u306e\u5224\u5b9a\u7d50\u679c\u3092\n    C\uff08\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff09S\uff08\u30b9\u30da\u30b7\u30e3\u30eb\uff091C\uff081\u30af\u30ea\uff09F\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\uff09\n    100F\uff08100\u30d5\u30a1\u30f3\u30d6\u30eb\uff09N\uff08\u901a\u5e38\u6210\u529f\uff09X\uff08\u5931\u6557\uff09\u3067\u8868\u793a\n\n    IDy<=x \u3067\u76ee\u6a19\u5024x\u3067y\u56de\u5224\u5b9a\n      ID4<=85\u3000\u3000\u4fee\u9a13\u5f8b\u52d54\u4eba\u639b\u3051\u7b49\n      (ID4<=85) \u2192 73,60,12,64 \u2192 N,N,S,N\n\n    \u30aa\u30d7\u30b7\u30e7\u30f3\u6587\u5b57\u6307\u5b9a\u4f8b\n      ID3<=120PB \u30d1\u30d5\u30a7\u30aa\u30dc\u30b9\u4e71\u69cd\n      (ID3<=120PB) S4 C10 F100 \u2192 4,81,21 \u2192 C,N,S\n".trim();let or=Tr=class extends ca{static getCustomGameSystemInfo(t,e){return{id:t.ID,name:t.NAME,className:t.ID,sortKey:t.SORT_KEY,locale:e,superClassName:"Base"}}static listAvailableGameSystems(){const t=Tr.loader.listAvailableGameSystems();return t.push(this.getCustomGameSystemInfo(Xc,"ja_jp")),t.push(this.getCustomGameSystemInfo(Qc,"ja_jp")),t}static diceRollAsync(t,e){return(0,xn.Z)(function*(){return Tr.queue.add(()=>{try{const i=e.eval(t);if(i)return console.log("diceRoll!!!",i.text),console.log("isSecret!!!",i.secret),{id:e.ID,result:`${e.ID} : ${i.text}`.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:i.secret}}catch(i){console.error(i)}return{id:e.ID,result:"",isSecret:!1}})})()}static getHelpMessage(t){return(0,xn.Z)(function*(){try{return(yield Tr.loadGameSystemAsync(t)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadCustomGameSystem(t){return"KariDice"==t?Xc:"IdoDice"==t?Qc:null}static loadGameSystemAsync(t){var e=this;return(0,xn.Z)(function*(){return yield Tr.queue.add(()=>{let i=e.loadCustomGameSystem(t);if(i)return i;const r=e.diceBotInfos.some(o=>o.id===t)?t:"DiceBot";try{return Tr.loader.getGameSystemClass(r)}catch(o){return Tr.loader.dynamicLoad(r)}})})()}static initializeDiceBotQueue(){let t=new SP("DiceBotQueue");return t.add((0,xn.Z)(function*(){Tr.loader=new((yield ye.e(2460).then(ye.bind(ye,383))).default),Tr.diceBotInfos=Tr.listAvailableGameSystems().sort((e,i)=>e.sortKey<i.sortKey?-1:e.sortKey>i.sortKey?1:0)})),t}getDiceTables(){return Xe.instance.getObjects(pc)}static deleteMyselfResourceBuff(t){let e=!0,i=!1,r=!1,o=!1,s="";for(let a=0;a<t.length;a++){let g=t[a];e&&g.match(/[tT\uff54\uff34]/)?(e=!1,i=!0,o=!1,r=!1,console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/[tT\uff54\uff34]/)"),s+=t[a]):i&&g.match(/[:\uff1a&\uff06]/)?(e=!1,i=!1,o=!1,r=!0,console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/[:\uff1a&\uff06]/)"),s+=t[a]):(r||e||o)&&g.match(/[:\uff1a&\uff06]/)?(e=!1,i=!1,o=!0,r=!1):g.match(/\s/)?(e=!0,i=!1,o=!1,r=!1,s+=t[a],console.log("sendChat\u6587\u5b57\u7f6e\u63dbmatch(/\\s/)")):(e=!1,o||(s+=t[a]))}return s}checkSecretEditCommand(t){let r=(" "+wo.toHalfWidth(t).toLowerCase()).replace("\uff1a",":").match(/\sST?:/i);return console.log(r),!!r}checkSecretDiceCommand(t,e){const r=wo.toHalfWidth(e).toLowerCase().replace(/^(\d+)?\s+/,"repeat1 ").replace(/^x(\d+)?\s+/,"repeat1 ").replace(/repeat(\d+)?\s+/,""),o=/^s(.*)?/gi.exec(r);return console.log("checkSecretDiceCommand:"+e+" gameSystem.name:"+t.name),t.COMMAND_PATTERN?o&&t.COMMAND_PATTERN.test(o[1]):(console.log("checkSecretDiceCommand:"+!1),!1)}onStoreAdded(){var t=this;super.onStoreAdded(),Qe.register(this).on("SEND_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o;o=wo.toHalfWidth(i.data.messageTrget?i.data.messageTrget.text:r.text);const s=r.tags?r.tags[0]:"";try{const a=/^((\d+)?\s+)?(.*)?/gi.exec(o),g=null!=a[2]?Number(a[2]):1;let w=null!=a[3]?a[3]:o;console.log("SEND_MESSAGE gameType :"+s);const G=yield Tr.loadGameSystemAsync(s);if(G.COMMAND_PATTERN&&!G.COMMAND_PATTERN.test(w)||!w||g<1)return;g>1&&(w=`x${g} ${w}`);const me=yield Tr.diceRollAsync(w,G);if(!me.result)return;i.data.messageTrget&&i.data.messageTrget.object?t.sendResultMessage(me,r," ["+i.data.messageTrget.object.name+"]"):t.sendResultMessage(me,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}()).on("DICE_TABLE_MESSAGE",function(){var e=(0,xn.Z)(function*(i){console.log("\u30c0\u30a4\u30b9\u8868\u5224\u5b9a");const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;const o=wo.toHalfWidth(r.text).trim(),s=o.split(/\s/),a=t.getDiceTables();if(!a||0==s.length)return;console.log("\u30b3\u30de\u30f3\u30c9\u5019\u88dc:"+s[0]);let w=null;for(const G of a)G.command==s[0]&&(w=G);if(w)try{const G=/^((\d+)?\s+)?(.*)?/gi.exec(w.dice),me=null!=G[2]?Number(G[2]):1,ve=null!=G[3]?G[3]:o,Ie={id:null,result:"",isSecret:!1};for(let We=0;We<me&&We<32;We++){const Ye=yield Tr.loadGameSystemAsync(w.diceTablePalette.dicebot),Ge=yield Tr.diceRollAsync(ve,Ye);if(Ge.result.length<1)break;Ie.result+=Ge.result,Ie.isSecret=Ie.isSecret||Ge.isSecret,1<me&&(Ie.result+=` #${We+1}`)}const Oe=Ie.result.match(/\d+$/);let Ve="\u30c0\u30a4\u30b9\u76ee\u306e\u756a\u53f7\u304c\u8868\u306b\u3042\u308a\u307e\u305b\u3093";if(Oe){console.log("rolledDiceNum:"+Oe[0]);const We=w.diceTablePalette.getPalette();console.log("tablePalette:"+We);for(const Ye in We)console.log("oneTable:"+We[Ye]),We[Ye].split(/[:\uff1a,\uff0c\s]/)[0]==Oe[0]&&(Ve=We[Ye].replace(/\\n/g,"\n"))}Ie.result+="\n"+Ve,t.sendResultMessage(Ie,r)}catch(G){console.error(G)}});return function(i){return e.apply(this,arguments)}}()).on("RESOURCE_EDIT_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);r&&r.isSendFromSelf&&!r.isSystem&&(wo.toHalfWidth(r.text),console.log("\u30ea\u30bd\u30fc\u30b9\u64cd\u4f5c\u5224\u5b9a"),t.checkResourceEditCommand(r,i.data.messageTargetContext?i.data.messageTargetContext:[]))});return function(i){return e.apply(this,arguments)}}()).on("APRIL_MESSAGE",function(){var e=(0,xn.Z)(function*(i){const r=Xe.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;const o=wo.toHalfWidth(r.text),s=o.split(/\s/),a=yield Tr.loadGameSystemAsync(r.tags?r.tags[0]:"");if(!t.getDiceTables()||0==s.length)return;if("#\u307e\u305d\u3063\u3077"==s[0]||"#\u30a8\u30a4\u30d7\u30ea\u30eb"==s[0])return void setTimeout(()=>{t.alertAprilMessage(r)},10);if("#\u3048\u3044\u3077\u308a\u308b"!=s[0])return;console.log("\u3048\u3044\u3077\u308a\u308b\u5b9f\u884c:"+s[0]+":"+s[1]+":"+s.length);let w="2d6",G="d6";if(s.length>=2){const Ge=s[1].toLowerCase();("1d4"==Ge||"4"==Ge)&&(w="1d4",G="d4"),("1d6"==Ge||"6"==Ge)&&(w="1d6",G="d6"),"2d6"==Ge&&(w="2d6",G="d6"),("1d8"==Ge||"8"==Ge)&&(w="1d8",G="d8"),("1d10"==Ge||"10"==Ge)&&(w="1d10",G="d10"),("1d12"==Ge||"12"==Ge)&&(w="1d12",G="d12"),("1d20"==Ge||"20"==Ge)&&(w="1d20",G="d20"),("1d100"==Ge||"100"==Ge)&&(w="1d100",G="d100"),"0"==Ge&&(w="")}console.log("\u3048\u3044\u3077\u308a\u308b \u30c0\u30a4\u30b9\u30bf\u30a4\u30d7:"+w);const me=_t.myCursor.diceImageIndex;let ve=0;if(me<0?ve=Math.floor(4*Math.random()):(ve=Math.floor(3*Math.random()),me<=ve&&ve++),_t.myCursor.diceImageType=w,""==w)return _t.myCursor.diceImageIndex=-1,void setTimeout(()=>{t.unDispDiceAprilMessage(r)},10);_t.myCursor.diceImageIndex=ve;let Ve=Math.floor(100*Math.random())+1;Ve<1&&(Ve=1),Ve>100&&(Ve=100);let We=Math.floor(100*Math.random())+1;We<1&&(We=1),We>100&&(We=100);let Ye="";Ye="2d6"==w?100+G+"+100"+G+"+"+Ve+G+"+"+Ve+G+"+"+We+G+"+"+We+G:100+G+"+"+Ve+G+"+"+We+G;try{const Ge=/^((\d+)?\s+)?([^\s]*)?/gi.exec(Ye),ct=null!=Ge[3]?Ge[3]:o,rt=yield Tr.diceRollAsync(ct,a);if(!rt.result)return;t.sendAprilMessage(rt,100+Ve+We,r)}catch(Ge){console.error(Ge)}});return function(i){return e.apply(this,arguments)}}())}alertAprilMessage(t){const i={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:"System",timestamp:t.timestamp+1,imageIdentifier:"april[01]",tag:"system",name:"<\u3048\u3044\u3077\u308a\u308b>",text:"\u300c\u3061\u3083\u3093\u3068\u300e#\u3048\u3044\u3077\u308a\u308b\u300f\u3063\u3066\u3088\u3093\u3067\u304f\u3060\u3055\u3044\uff01\u30c0\u30a4\u30b9\u904b\u4e0b\u3052\u307e\u3059\u3088\u3063\uff01\uff1f\u300d",messColor:t.messColor,imagePos:t.imagePos?t.imagePos:null},r=Xe.instance.get(t.tabIdentifier);r&&r.addMessage(i)}unDispDiceAprilMessage(t){const i={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:"System",timestamp:t.timestamp+1,imageIdentifier:"april[00]",tag:"system",name:"<\u3048\u3044\u3077\u308a\u308b>",text:"\u30c0\u30a4\u30b9\u753b\u50cf\u3092\u30c7\u30d5\u30a9\u30eb\u30c8(\u975e\u8868\u793a)\u306b\u3057\u307e\u3057\u305f",messColor:t.messColor},r=Xe.instance.get(t.tabIdentifier);r&&r.addMessage(i)}sendAprilMessage(t,e,i){const r=t.result;if(r.length<1)return;console.log("result.length:"+r.length);const s=r.match(/\d+$/),g={identifier:"",tabIdentifier:i.tabIdentifier,originFrom:i.from,from:"System-BCDice",timestamp:i.timestamp+1,imageIdentifier:"april[00]",tag:"system",name:"<BCDice\uff1a\u3048\u3044\u3077\u308a\u308b>",text:"\u300c\u307e\u305d\u3063\u3077\uff01\u300d\u3048\u3044\u3077\u308a\u308b\u306f\u708e\u306e\u5263\u3067 "+e+" \u9023\u7d9a\u3067\u30c0\u30a4\u30b9\u3092\u7a81\u3044\u305f \u2192 "+s+" \u904b\u547d\u304c\u5909\u308f\u3063\u305f\u304b\u3082\u3057\u308c\u306a\u3044",messColor:i.messColor,imagePos:i.imagePos?i.imagePos:null};null!=i.to&&0<i.to.length&&(g.to=i.to,i.to.indexOf(i.from)<0&&(g.to+=" "+i.from));const w=Xe.instance.get(i.tabIdentifier);w&&w.addMessage(g)}targeted(t){return t.targeted}targetedGameCharacterList(){let t=[];return t=Xe.instance.getObjects(Bt).filter(e=>this.targeted(e)),t}messageSendGameCharacter(t){let e=Xe.instance.get(t);return e instanceof Bt?e:(console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u304b\u3089\u306e\u767a\u4fe1\u3058\u3083\u3042\u308a\u307e\u305b\u3093"),null)}checkResourceEditCommand(t,e){let i=[],r=[],o=this.messageSendGameCharacter(t.sendFrom),s=!1;for(const a of e){let g=" "+a.text;g.match(/(\s[sS\uff53\uff33][tT\uff54\uff34]?[:\uff1a&\uff06])/i)&&(s=!0);let We=g.replace(/(\s[sS\uff53\uff33][tT\uff54\uff34][:\uff1a])/i," t:").replace(/(\s[sS\uff53\uff33][:\uff1a])/i," :").replace(/([tT\uff54\uff34][:\uff1a])/gi,"t:").replace(/([tT\uff54\uff34][&\uff06])/gi,"t&").replace(/([:\uff1a])/gi,":").replace(/([&\uff06])/gi,"&").split(/\s/);for(const rt of We){if(console.log("chktxt="+rt),!rt.match(/^(t?[:&][^:\uff1a&\uff06])+/gi))continue;let ft=rt.match(/t?:[^:\uff1a&\uff06]+/gi),Lt=rt.match(/t?&[^:\uff1a&\uff06]+/gi);if(ft)for(let wt of ft){console.log(wt);let Ht={resourceCommand:"",object:null};Ht.resourceCommand=wt,Ht.object=a.object,i.push(Ht)}if(Lt)for(let wt of Lt){let Ht={buffCommand:"",object:null};Ht.buffCommand=wt,Ht.object=a.object,r.push(Ht)}}}this.resourceEditProcess(o,i,r,t,s)}resourceEditParseOption(t){let e={limitMinMax:!1,zeroLimit:!1,isErr:!1};const i=wo.toHalfWidth(t).match(/([A-CE-Z]+)$/i);if(!i)return e;let r=i[1];return r.match(/L/i)&&(r=r.replace(/L/i,""),e.limitMinMax=!0),r.match(/Z/i)?(r=r.replace(/Z/i,""),e.zeroLimit=!0):e.zeroLimit=!1,0!=r.length&&(e.isErr=!0),e}resourceCommandToEdit(t,e,i,r){console.log("\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\u30b3\u30de\u30f3\u30c9\u51e6\u7406\u958b\u59cb"),t.object=i,t.targeted=r;const o=" "+e.replace("\uff1a",":").replace("\uff0b","+").replace("\uff0d","-").replace("\uff1d","=").replace("\uff1e",">");console.log("\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\uff1a"+o);const a=o.match(/[:]([^-+=>]+)([-+=>])(.*)/);if(">"!=a[2]&&""==a[3])return!1;let w,G,me=a[1].match(/(.+)([\^\uff3e]$)/);me?(w=me[1],G=wo.toHalfWidth(w),t.nowOrMax="max"):(w=a[1],G=wo.toHalfWidth(w),t.nowOrMax="now");const Ie=a[2];if(t.operator=Ie,i.chkChangeStatusName(w))t.target=w;else{if(!i.chkChangeStatusName(G))return!1;t.target=G}if(">"==t.operator)t.replace=a[3];else{let Oe=a[3].replace(/[A-CE-Z\uff21-\uff23\uff25-\uff3a]+$/i,"");t.command=("-"==t.operator?"-":"")+wo.toHalfWidth(Oe)+"+(1d1-1)",console.log(w+"/"+Ie+"/"+Oe),Oe=Oe.replace(/[A-CE-Z\uff21-\uff23\uff25-\uff3a]+$/i,"");const We=this.resourceEditParseOption(a[3]);if(We.isErr)return!1;t.option=We,t.isDiceRoll=!!wo.toHalfWidth(Oe).match(/\d[dD]/)}return!0}defaultResourceEdit(){return{target:"",operator:"",diceResult:"",command:"",replace:"",isDiceRoll:!1,calcAns:0,nowOrMax:"now",option:null,object:null,targeted:!1}}resourceEditProcess(t,e,i,r,o){var s=this;return(0,xn.Z)(function*(){const a=[],g=yield Tr.loadGameSystemAsync(r.tags?r.tags[0]:"");console.log("resourceEditProcess");for(const me of e){let Oe,ve=me.resourceCommand,Ie=!!ve.match(/^t:/i);if(Ie){let Ve=me.object,We=s.defaultResourceEdit();if(!s.resourceCommandToEdit(We,ve,Ve,Ie))return;if(">"!=We.operator)try{const Ye=yield Tr.diceRollAsync(We.command,g);if(!Ye.result)return null;const Ge=Ye.result.split(" \uff1e ");We.diceResult=Ge[Ge.length-2].replace(/\+\(1\[1\]\-1\)$/,"");const ct=Ye.result.match(/([-+]?\d+)$/);We.calcAns=parseInt(ct[1],10)}catch(Ye){console.error(Ye)}a.push(We)}else{if(null==t)return Oe=null,void console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306a\u3044\u30ea\u30bd\u30fc\u30b9\u306f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093");{Oe=t;let Ve=s.defaultResourceEdit();if(!s.resourceCommandToEdit(Ve,ve,Oe,Ie))return;if(">"!=Ve.operator)try{const We=yield Tr.diceRollAsync(Ve.command,g);if(!We.result)return null;const Ye=We.result.split(" \uff1e ");Ve.diceResult=Ye[Ye.length-2].replace(/\+\(1\[1\]\-1\)$/,"");const Ge=We.result.match(/([-+]?\d+)$/);Ve.calcAns=parseInt(Ge[1],10)}catch(We){console.error(We)}a.push(Ve)}}}let G=[];for(const me of i){let Oe,ve=me.buffCommand,Ie=!!ve.match(/^t&/i);if(Ie){let Ve=me.object,Ye={command:ve.replace("\uff06","&").replace(/\uff0b$/,"+").replace(/\uff0d$/,"-"),object:Ve,targeted:Ie};G.push(Ye)}else{if(null==t)return Oe=null,void console.log("\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306a\u3044\u3082\u306e\u306b\u5bfe\u3057\u3066\u30d0\u30d5\u64cd\u4f5c\u306f\u3067\u304d\u307e\u305b\u3093");{let We={command:ve.replace("\uff06","&").replace(/\uff0b$/,"+").replace(/\uff0d$/,"-"),object:t,targeted:Ie};G.push(We)}}}s.resourceBuffEdit(a,G,r,o)})()}resourceTextEdit(t,e){return e.setStatusText(t.target,t.replace),t.target+"\uff1e"+t.replace+"    "}resourceEdit(t,e){let i="",r=0,o=0,s=null,a=t.nowOrMax;if(s=e.getStatusValue(t.target,"max"),"max"==a&&null==s&&(a="now"),r=e.getStatusValue(t.target,"now"==a?"now":"max"),"="==t.operator)o=t.calcAns;else{const me=t.option.zeroLimit;me&&"+"==t.operator&&t.calcAns<0||me&&"-"==t.operator&&t.calcAns>0?(o=r+0,i="(0\u5236\u9650)"):o=r+t.calcAns}return t.option.limitMinMax&&null!=s&&(o>s&&"now"==a&&(o=s,i="(\u6700\u5927)"),o<0&&(o=0,i="(\u6700\u5c0f)")),e.setStatusValue(t.target,"now"==a?"now":"max",o),t.target+("max"==a?"(\u6700\u5927\u5024)":"")+":"+r+("-"==t.operator?"":t.operator)+t.diceResult+"\uff1e"+o+i+"    "}buffEdit(t,e){let i=t.command,r="";if(t.targeted&&(r+="["+e.name+"] "),i.match(/^[tT\uff54\uff34]?&[R\uff32r\uff52]-$/i))e.decreaseBuffRound(),r+="\u30d0\u30d5R\u3092\u6e1b\u5c11",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&[R\uff32r\uff52][+]$/i))e.increaseBuffRound(),r+="\u30d0\u30d5R\u3092\u5897\u52a0",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&[D\uff24d\uff44]$/i))e.deleteZeroRoundBuff(),r+="0R\u4ee5\u4e0b\u306e\u30d0\u30d5\u3092\u6d88\u53bb",r+="    ";else if(i.match(/^[tT\uff54\uff34]?&.+-$/i)){let o=i.match(/^[tT\uff54\uff34]?&(.+)-$/i);console.log("match"+o);const s=o[1];e.deleteBuff(s)&&(r+=s+"\u3092\u6d88\u53bb",r+="    ")}else{const o=i.replace(/^[tT\uff54\uff34]?&/i,"").split("/");let s=null,a="",g="",w="";g=o[0],w=o[0],o.length>1&&(a=o[1],w=w+"/"+o[1]),o.length>2&&(o[2]?(s=parseInt(o[2]),Number.isNaN(s)&&(s=3)):s=3,w=w+"/"+s+"R"),e.addBuffRound(g,a,s),r+="\u30d0\u30d5\u3092\u4ed8\u4e0e "+w,r+="    "}return r}resourceBuffEdit(t,e,i,r){let g,w,G,s="",a=!1;for(let Ie of t)g=Ie.object,Ie.targeted&&(s+="["+g.name+"] "),s+=">"==Ie.operator?this.resourceTextEdit(Ie,g):this.resourceEdit(Ie,g),Ie.isDiceRoll&&(a=!0);for(let Ie of e)g=Ie.object,s+=this.buffEdit(Ie,g);if(s=s.replace(/\s\s\s\s$/,""),""==s)return;a?(w="System-BCDice",G="<BCDice\uff1a"+i.name+">"):(w="System",G=i.name);const me={identifier:"",tabIdentifier:i.tabIdentifier,originFrom:i.from,from:w,timestamp:i.timestamp+2,imageIdentifier:_t.myCursor.diceImageIdentifier,tag:r?"system secret":"system",name:G,text:s,messColor:i.messColor},ve=Xe.instance.get(i.tabIdentifier);ve&&ve.addMessage(me)}sendResultMessage(t,e,i){let r=t.result;const o=t.isSecret;if(r.length<1)return;console.log("result.length:"+r.length),r=r.replace(/[\uff1e]/g,g=>"\u2192").trim();const s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:_t.myCursor.diceImageIdentifier,tag:o?"system secret":"system",name:o?"<Secret-BCDice\uff1a"+e.name+">":"<BCDice\uff1a"+e.name+">",text:i?r+i:r,messColor:e.messColor};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));const a=Xe.instance.get(e.tabIdentifier);a&&a.addMessage(s)}onStoreRemoved(){super.onStoreRemoved(),Qe.unregister(this)}};or.queue=Tr.initializeDiceBotQueue(),or.diceBotInfos=[],or=Tr=be([ai("dice-bot")],or);let zf=class extends ca{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new Qt,this._volume=.5,this._auditionVolume=.5}get audio(){return Jt.instance.get(this.audioIdentifier)}get config(){return Xe.instance.get("Config")}get volume(){return this._volume}set volume(t){this._volume=t}get auditionVolume(){return this._auditionVolume}set auditionVolume(t){this._auditionVolume=t}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}setNewVolume(){Qt.volume=this.volume*this.config.roomVolume,Qt.auditionVolume=this.auditionVolume*this.config.roomVolume}play(t,e=!1){let i=Jt.instance.get(t);!i||!i.isReady||(this.audioIdentifier=t,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Qe.register(this).on("UPDATE_AUDIO_RESOURE",t=>{this._play()})}unlockAfterUserInteraction(){let t=()=>{document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)}unregisterEvent(){Qe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(t){let e=this.audioIdentifier,i=this.isPlaying;super.apply(t),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};be([st()],zf.prototype,"audioIdentifier",void 0),be([st()],zf.prototype,"startTime",void 0),be([st()],zf.prototype,"isLoop",void 0),be([st()],zf.prototype,"isPlaying",void 0),zf=be([ai("jukebox")],zf);let Bw=class extends Xr{constructor(){super(...arguments),this.reloadOK=!0,this.isAnswer=!1}reloadCheckStart(t){t?(this.reloadOK=!0,this.isAnswer=!1):(this.reloadOK=!0,this.isAnswer=!0)}answerCheck(){return 0==this.isAnswer&&(this.reloadOK=window.confirm("\u30d7\u30ec\u30a4\u4e2d\u306b\u30eb\u30fc\u30e0\u6839\u5e79\u8a2d\u5b9a\u3092\u542b\u3080\u30c7\u30fc\u30bf\u304c\u5165\u529b\u3055\u308c\u307e\u3057\u305f\n\u3053\u306e\u30c7\u30fc\u30bf\u3092\u672c\u5f53\u306b\u8aad\u307f\u8fbc\u3093\u3067\u3044\u3044\u3067\u3059\u304b\uff1f \u53e4\u3044\u30c7\u30fc\u30bf\u306f\u4e0a\u66f8\u304d\u3055\u308c\u307e\u3059"),this.isAnswer=!0),this.reloadOK}isLoadOk(){return console.log("isLoadOk :"+this.reloadOK),this.reloadOK}};Bw=be([ai("reload-check")],Bw);let Lw=class extends ca{constructor(){super(...arguments),this.clickTimeStamp=0}changeMarkDownCheckBox(t,e){let i=t.match(/^(.*)_mark_(\d{8})$/);if(!i)return;let o=i[2],s=Xe.instance.get(i[1]);if(!s||this.clickTimeStamp==e)return;this.clickTimeStamp=e;let a=s.value,g=parseInt(o),w=a.split(/[\[\uff3b][xX\uff58\uff38]?[\]\uff3d]/g),G=a.match(/[\[\uff3b][xX\uff58\uff38]?[\]\uff3d]/g),me=G[g];me=me.match(/[\[\uff3b][xX\uff58\uff38][\]\uff3d]/)?"[]":"[x]";let Ie,ve="";for(Ie=0;Ie<G.length;Ie++)ve+=Ie!=g?w[Ie]+G[Ie]:w[Ie]+me;for(;Ie<w.length;Ie++)ve+=w[Ie];s.value=ve}markDownCheckBox(t,e){let i="",s=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/[\[\uff3b][xX\uff58\uff38][\]\uff3d]/g,'<input type="checkbox" checked="checked" class="markDounBox" />').replace(/[\[\uff3b][\]\uff3d]/g,'<input type="checkbox" class="markDounBox" />').split("<input ");for(let a=0;a<s.length&&(i+=s[a],a<s.length-1&&(i+='<input id="'+e+"_mark_"+("00000000"+a).slice(-8)+'" '),!(a>=99999999));a++);return i}markDownTable(t){let e=t.split("\n"),i="",r=!1;for(let o=0;o<e.length;o++){let s=e[o].split(/[|\uff5c]/);if(1==s.length)0==r?i+=e[o]+"\n":(i+="</div>",i+=e[o]+"\n",r=!1);else if(0==r){i+=s[0],i+='<div class="markdown_table" style="display: table; table-layout: fixed; border: 1px solid #000000;">',i+='  <div class="markdown_table_row" style="display: table-row; border: 1px solid #000000;">';for(let a=1;a<s.length-1;a++)i+='    <div class="markdown_table_cell" style="display: table-cell; border: 1px solid #000000;">'+s[a]+"</div>";i+="  </div>",r=!0}else{i+='  <div class="markdown_table_row" style="display: table-row; border: 1px solid #000000;">';for(let a=1;a<s.length-1;a++)i+='    <div class="markdown_table_cell" style="display: table-cell; border: 1px solid #000000;">'+s[a]+"</div>";i+="  </div>"}}return 1==r&&(i+="</div>"),i}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}};Lw=be([ai("markdown")],Lw);let Zi=class extends ca{constructor(){super(...arguments),this.name="\u30ab\u30c3\u30c8\u30a4\u30f3",this.width=480,this.height=320,this.originalSize=!0,this.x_pos=50,this.y_pos=50,this.imageIdentifier="imageIdentifier",this.audioIdentifier="",this.audioName="",this.startTime=0,this.tagName="",this.selected=!1,this.isLoop=!1,this.chatActivate=!1,this.outTime=0,this.isPlaying=!1,this.keepImageAspect=!1,this.isVideoCutIn=!1,this.videoUrl="",this.normalMinSizeWidth=10,this.normalMinSizeHeight=10,this.normalMaxSizeWidth=1200,this.normalMaxSizeHeight=1200,this.videoMinSizeWidth=448,this.videoMinSizeHeight=252,this.videoMaxSizeWidth=1920,this.videoMaxSizeHeight=1080,this._defVideoSizeWidth=640,this._defVideoSizeHeight=360,this.audioPlayer=new Qt}get defVideoSizeWidth(){return this._defVideoSizeWidth}get defVideoSizeHeight(){return this._defVideoSizeHeight}minSizeWidth(t){return t?this.videoMinSizeWidth:this.normalMinSizeWidth}maxSizeWidth(t){return t?this.videoMaxSizeWidth:this.normalMaxSizeWidth}minSizeHeight(t){return t?this.videoMinSizeHeight:this.normalMinSizeHeight}maxSizeHeight(t){return t?this.videoMaxSizeHeight:this.normalMaxSizeHeight}get audio(){return Jt.instance.get(this.audioIdentifier)}get cutInImage(){return this.imageIdentifier&&xt.instance.get(this.imageIdentifier)||Ot.Empty}validUrl(t){if(!t)return!1;try{new URL(t.trim())}catch(e){return!1}return/^https?\:\/\//.test(t.trim())}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let t="";if(!this.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const t=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return t&&t[1]?this._sec(t[1]):null}_sec(t){if(!t)return null;let e=null;if(e=/^(\d+)$/.exec(t))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(t)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let t="";if(!this.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(t=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioName.length||0==this.audioIdentifier.length||!!Jt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}};be([st()],Zi.prototype,"name",void 0),be([st()],Zi.prototype,"width",void 0),be([st()],Zi.prototype,"height",void 0),be([st()],Zi.prototype,"originalSize",void 0),be([st()],Zi.prototype,"x_pos",void 0),be([st()],Zi.prototype,"y_pos",void 0),be([st()],Zi.prototype,"imageIdentifier",void 0),be([st()],Zi.prototype,"audioIdentifier",void 0),be([st()],Zi.prototype,"audioName",void 0),be([st()],Zi.prototype,"startTime",void 0),be([st()],Zi.prototype,"tagName",void 0),be([st()],Zi.prototype,"selected",void 0),be([st()],Zi.prototype,"isLoop",void 0),be([st()],Zi.prototype,"chatActivate",void 0),be([st()],Zi.prototype,"outTime",void 0),be([st()],Zi.prototype,"isPlaying",void 0),be([st()],Zi.prototype,"keepImageAspect",void 0),be([st()],Zi.prototype,"isVideoCutIn",void 0),be([st()],Zi.prototype,"videoUrl",void 0),Zi=be([ai("cut-in")],Zi);let _c=class extends ca{constructor(){super(...arguments),this.test="test001",this.launchCutInIdentifier="",this.launchTimeStamp=0,this.launchMySelf=!1,this.launchIsStart=!1,this.stopBlankTagCutInTimeStamp=0,this.sendTo="",this.reloadDummy=5}get jukebox(){return Xe.instance.get("Jukebox")}isCutInBgmUploaded(t){return!!Jt.instance.get(t)}chatActivateCutIn(t,e){let o="";if((" "+t).match(/\s(\S+)$/i)){o=RegExp.$1;const s=this.getCutIns();for(const a of s)if(a.chatActivate&&a.name==o)return this.isCutInBgmUploaded(a.audioIdentifier)&&""==a.tagName&&this.jukebox.stop(),void this.startCutIn(a,e)}}startCutInMySelf(t){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!0,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!0,this.sendTo="",this.startSelfCutIn()}startCutIn(t,e){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!0,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!1,this.sendTo=e||"",this.startSelfCutIn()}stopCutIn(t){this.launchCutInIdentifier=t.identifier,this.launchIsStart=!1,this.launchTimeStamp=this.launchTimeStamp+1,this.launchMySelf=!1,this.stopSelfCutIn()}stopBlankTagCutIn(){this.stopBlankTagCutInTimeStamp=this.stopBlankTagCutInTimeStamp+1,Qe.trigger("STOP_CUT_IN_BY_BGM",{})}sameTagCutIn(t){const e=this.getCutIns(),i=t.tagName,r=[];for(const o of e)o.tagName==i&&o.identifier!==t.identifier&&r.push(o);return r}startSelfCutIn(){const t=Xe.instance.get(this.launchCutInIdentifier);Qe.trigger("START_CUT_IN",{cutIn:t})}stopSelfCutIn(){const t=Xe.instance.get(this.launchCutInIdentifier);Qe.trigger("STOP_CUT_IN",{cutIn:t})}stopSelfCutInByIdentifier(t){const e=Xe.instance.get(t);Qe.trigger("STOP_CUT_IN",{cutIn:e})}getCutIns(){return Xe.instance.getObjects(Zi)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("CutInLauncher apply() CALL");const e=this.launchCutInIdentifier,i=this.launchIsStart,r=this.launchTimeStamp,o=this.stopBlankTagCutInTimeStamp;super.apply(t),!this.launchMySelf&&(console.log("this.sendTo :"+this.sendTo),o!==this.stopBlankTagCutInTimeStamp&&(console.log("\u30c7\u30fc\u30bf\u4f1d\u642c\u3067\u691c\u77e5 \u7121\u30bf\u30b0\u30ab\u30c3\u30c8\u30a4\u30f3\u505c\u6b62\u306e\u30c8\u30ea\u30ac\u30fc"),Qe.trigger("STOP_CUT_IN_BY_BGM",{})),(""==this.sendTo||this.sendTo==$t.peerContext.userId)&&(e!==this.launchCutInIdentifier||i!==this.launchIsStart||r!==this.launchTimeStamp)&&(this.launchIsStart?this.startSelfCutIn():this.stopSelfCutIn()))}};be([st()],_c.prototype,"test",void 0),be([st()],_c.prototype,"launchCutInIdentifier",void 0),be([st()],_c.prototype,"launchTimeStamp",void 0),be([st()],_c.prototype,"launchMySelf",void 0),be([st()],_c.prototype,"launchIsStart",void 0),be([st()],_c.prototype,"stopBlankTagCutInTimeStamp",void 0),be([st()],_c.prototype,"sendTo",void 0),_c=be([ai("cut-in-launcher")],_c);let Cl=class extends ca{constructor(){super(...arguments),this.initTimeStamp=0,this.voteTitle="",this.targetPeerId=[],this.choices=[],this.chairId="",this.isRollCall=!1,this.isFinish=!1,this.voteId=0}voteAnswerByPeerId(t){let e=_t.findByPeerId(t);return e?e.voteId==this.voteId?e.voteAnswer:-1:-2}get voteAnswer(){let t=[];for(let e of this.targetPeerId)t.push(this.voteAnswerByPeerId(e));return t}makeVote(t,e,i,r,o){this.isRollCall=o,this.chairId=t,this.choices=r,this.voteTitle=e,this.voteId++,this.targetPeerId=i,this.initTimeStamp=Date.now()}isVoteEnd(t){for(let e of this.targetPeerId)if(e==t){let i=_t.findByPeerId(t);if(!i||i.voteId==this.voteId)return!0}return!1}voting(t,e){_t.myCursor.voteAnswer=t?this.choices.indexOf(t):-2,_t.myCursor.voteId=this.voteId,this.chkFinishVote()}chkFinishVote(){if(this.chairId==_t.myCursor.peerId&&this.votedTotalNum()==this.targetPeerId.length){let t;if(this.isRollCall)t="\u70b9\u547c\u7d42\u4e86("+this.votedTotalNum()+"/"+this.targetPeerId.length+")",0!=this.votedNumByIndex(-2)&&(t+=" \u68c4\u6a29\uff1a"+this.votedNumByIndex(-2));else{t="\u6295\u7968\u7d42\u4e86("+this.voteTitle+") ";for(let e of this.choices)t+=" "+e+"\uff1a"+this.votedNumByChoice(e);0!=this.votedNumByIndex(-2)&&(t+=" \u68c4\u6a29\uff1a"+this.votedNumByIndex(-2))}setTimeout(()=>{Qe.trigger("FINISH_VOTE",{text:t})},1)}}votedTotalNum(){const t=this.voteAnswer;let e=0;for(let i of t)(i>=0||-2==i)&&e++;return e}votedNumByIndex(t){const e=this.voteAnswer;let i=0;for(let r of e)r==t&&i++;return i}votedNumByChoice(t){const e=this.choices.indexOf(t);return this.votedNumByIndex(e)}indexToChoice(t){return t<0||t>=this.choices.length?"":this.choices[t]}chkToMe(){for(let t of this.targetPeerId)if(_t.myCursor.peerId==t)return!0;return!1}startVote(){Qe.trigger("END_OLD_VOTE",{}),Qe.trigger("START_VOTE",{})}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("Vote apply() CALL");const e=this.initTimeStamp;super.apply(t),e!==this.initTimeStamp&&this.startVote(),this.chkFinishVote()}};be([st()],Cl.prototype,"initTimeStamp",void 0),be([st()],Cl.prototype,"voteTitle",void 0),be([st()],Cl.prototype,"targetPeerId",void 0),be([st()],Cl.prototype,"choices",void 0),be([st()],Cl.prototype,"chairId",void 0),be([st()],Cl.prototype,"isRollCall",void 0),be([st()],Cl.prototype,"isFinish",void 0),be([st()],Cl.prototype,"voteId",void 0),Cl=be([ai("Vote")],Cl);let Ga=class extends ca{constructor(){super(...arguments),this.initTimeStamp=0,this.alarmTitle="",this.targetPeerId=[],this.alarmTime=0,this.alarmId=0,this.alarmPeerId="",this.targetText="",this.isSound=!1,this.isPopUp=!1}get myPeer(){return _t.myCursor}makeAlarm(t,e,i,r,o,s,a){this.alarmTitle=e,this.alarmTime=t,this.alarmId++,this.alarmPeerId=r,this.targetPeerId=i,this.targetText=o,this.initTimeStamp=Date.now(),this.isSound=s,this.isPopUp=a}chkToMe(){for(let t of this.targetPeerId)if(_t.myCursor.peerId==t)return!0;return!1}startAlarm(){this.chkToMe()&&setTimeout(()=>{this.isSound&&(Qe.trigger("ALARM_TIMEUP_ORIGIN",{text:"\u30a2\u30e9\u30fc\u30e0("+this.alarmTime+"\u79d2)\u7d4c\u904e"+this.targetText+this.alarmTitle}),Qt.play(Jt.instance.get(ut.alarm),.5),console.log("\u30a2\u30e9\u30fc\u30e0\u97f3\u518d\u751f")),this.isPopUp&&(console.log("\u30a2\u30e9\u30fc\u30e0 \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u518d\u751f"),Qe.trigger("ALARM_POP",{title:this.alarmTitle,time:this.alarmTime}))},1e3*this.alarmTime)}onStoreAdded(){super.onStoreAdded()}onStoreRemoved(){super.onStoreRemoved()}apply(t){console.log("Alarm timer apply() CALL");const e=this.initTimeStamp;super.apply(t),e!==this.initTimeStamp&&this.startAlarm()}};be([st()],Ga.prototype,"initTimeStamp",void 0),be([st()],Ga.prototype,"alarmTitle",void 0),be([st()],Ga.prototype,"targetPeerId",void 0),be([st()],Ga.prototype,"alarmTime",void 0),be([st()],Ga.prototype,"alarmId",void 0),be([st()],Ga.prototype,"alarmPeerId",void 0),be([st()],Ga.prototype,"targetText",void 0),be([st()],Ga.prototype,"isSound",void 0),be([st()],Ga.prototype,"isPopUp",void 0),Ga=be([ai("Alarm")],Ga);let zw=class extends ca{onStoreAdded(){super.onStoreAdded(),Xe.instance.remove(this)}get reloadCheck(){return Xe.instance.get("ReloadCheck")}innerXml(){let t="",e=[];e=e.concat(Xe.instance.getObjects(Jr)),e=e.concat(Xe.instance.getObjects(Bt)),e=e.concat(Xe.instance.getObjects(rr)),e=e.concat(Xe.instance.getObjects(Xo)),e=e.concat(Xe.instance.getObjects(xr)),e=e.concat(Xe.instance.getObjects(Qr).filter(i=>null===i.parent)),e=e.concat(Xe.instance.getObjects(zs)),e=e.concat(Xe.instance.getObjects(Zi)),e=e.concat(Xe.instance.getObjects(pc));for(let i of e)t+=i.toXml();return t}parseInnerXml(t){let e=[];e=e.concat(Xe.instance.getObjects(Jr)),e=e.concat(Xe.instance.getObjects(So)),e=e.concat(Xe.instance.getObjects(Do)),e=e.concat(Xe.instance.getObjects(go)),e=e.concat(Xe.instance.getObjects(Bt)),e=e.concat(Xe.instance.getObjects(rr)),e=e.concat(Xe.instance.getObjects(Xo)),e=e.concat(Xe.instance.getObjects(xr)),e=e.concat(Xe.instance.getObjects(Qr)),e=e.concat(Xe.instance.getObjects(zs)),e=e.concat(Xe.instance.getObjects(Zi)),e=e.concat(Xe.instance.getObjects(pc));let i=!0;if(i=this.reloadCheck.answerCheck(),i){for(let r of e)r.destroy();for(let r=0;r<t.children.length;r++)Ji.instance.parseXml(t.children[r])}}};zw=be([ai("room")],zw);var Pg,SG=ye(1203);let en=Pg=class extends Si{constructor(){super(...arguments),this.imageIdentifier="",this.tag=""}containsWords(t){return t.every(e=>this.tag.indexOf(e)>=0)}static searchImages(t){return Xe.instance.getObjects(Pg).filter(e=>e.containsWords(t)).map(e=>xt.instance.get(e.imageIdentifier)).filter(e=>e)}static get(t){return Xe.instance.get(`imagetag_${t}`)}static create(t){const e=new Pg(`imagetag_${t}`);return e.imageIdentifier=t,e.initialize(),e}parseInnerXml(t){let e=Pg.get(this.imageIdentifier);e||(e=Pg.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Uw;be([st()],en.prototype,"imageIdentifier",void 0),be([st()],en.prototype,"tag",void 0),en=Pg=be([ai("image-tag")],en);let $b=Uw=class extends Si{constructor(){super(...arguments),this.identifiers=[]}onStoreAdded(){super.onStoreAdded(),Xe.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(t=>en.get(t)).filter(t=>t).map(t=>t.toXml()).join("")}static create(t){const e=new Uw;return e.identifiers=t.map(i=>i.identifier),e}};$b=Uw=be([ai("image-tag-list")],$b);class ko{constructor(t){this.ngZone=t}saveRoomAsync(t="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return ko.queue.add((i,r)=>i(this._saveRoomAsync(t,e)))}_saveRoomAsync(t="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new zw),o=this.convertToXml(Ls.instance),s=this.convertToXml(Of.instance),a=this.convertToXml(ja.instance);i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"config.xml",{type:"text/plain"})),i.push(new File([a],"summary.xml",{type:"text/plain"}));let g=[];g=g.concat(this.searchImageFiles(r)),g=g.concat(this.searchImageFiles(o));for(const G of g)G.state===zr.COMPLETE&&i.push(new File([G.blob],G.identifier+"."+Lf.extension(G.blob.type),{type:G.blob.type}));let w=this.convertToXml($b.create(g));return i.push(new File([w],"imagetag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(t),e)}saveGameObjectAsync(t,e="xml_data",i){return ko.queue.add((r,o)=>r(this._saveGameObjectAsync(t,e,i)))}_saveGameObjectAsync(t,e="xml_data",i){let r=[],o=this.convertToXml(t);r.push(new File([o],"data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const g of s)g.state===zr.COMPLETE&&r.push(new File([g.blob],g.identifier+"."+Lf.extension(g.blob.type),{type:g.blob.type}));let a=this.convertToXml($b.create(s));return r.push(new File([a],"imagetag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(t,e,i){let r=-1;return yl.instance.saveAsync(t,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(t){return'<?xml version="1.0" encoding="UTF-8"?>\n'+SG.xml(t.toXml(),2)}searchImageFiles(t){let e=Wc.xml2element(t),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=xt.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=xt.instance.get(a));let g=o[s].getAttribute("backgroundImageIdentifier");g&&(r[g]=xt.instance.get(g))}for(let s in r){let a=r[s];a&&i.push(a)}return i}saveHtmlChatLog(t,e){let i=t.logHtml(),r=new Blob([i],{type:"text/plain;charset=utf-8"});(0,Wm.saveAs)(r,e+".html")}saveHtmlChatLogAll(t){let e=Ls.instance.logHtml(),i=new Blob([e],{type:"text/plain;charset=utf-8"});(0,Wm.saveAs)(i,t+".html")}saveHtmlChatLogCoc(t,e){let i=t.logHtmlCoc(),r=new Blob([i],{type:"text/plain;charset=utf-8"});(0,Wm.saveAs)(r,e+".html")}saveHtmlChatLogAllCoc(t){let e=Ls.instance.logHtmlCoc(),i=new Blob([e],{type:"text/plain;charset=utf-8"});(0,Wm.saveAs)(i,t+".html")}appendTimestamp(t){let e=new Date;return t+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}}function DG(n,t){if(1&n&&(ee(0,"option",9),we(1),ce()),2&n){const e=t.$implicit;sn("value",e.identifier),W(1),Ct(e.name)}}function IG(n,t){if(1&n&&(ee(0,"div",19),we(1),ce()),2&n){const e=_e(3);W(1),ln("",e.progresPercent,"%")}}ko.queue=new SP("SaveDataServiceQueue"),ko.\u0275fac=function(t){return new(t||ko)(In(An))},ko.\u0275prov=Tn({token:ko,factory:ko.\u0275fac,providedIn:"root"});const kG=function(n){return{"is-hidden":n}};function MG(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",11),we(2," \u30bf\u30d6\u524a\u9664\u3092\u6709\u52b9\u306b\u3059\u308b"),ee(3,"input",12),Re("ngModelChange",function(r){return ze(e),_e(2).allowDeleteTab=r}),ce()(),ee(4,"button",2),Re("click",function(){return ze(e),_e(2).upTabIndex()}),we(5,"\u2191"),ce(),ee(6,"button",2),Re("click",function(){return ze(e),_e(2).downTabIndex()}),we(7,"\u2193"),ce(),ee(8,"button",13),Re("click",function(){return ze(e),_e(2).save()}),ee(9,"div",14)(10,"div",15),we(11,"\u4fdd\u5b58"),ce(),Se(12,IG,2,1,"div",16),ce()(),nt(13,"span",17),ee(14,"button",18),Re("click",function(){return ze(e),_e(2).delete()}),we(15,"\u9078\u629e\u30bf\u30d6\u524a\u9664"),ce(),nt(16,"br"),et()}if(2&n){const e=_e(2);W(3),oe("ngModel",e.allowDeleteTab),W(5),oe("disabled",e.isSaveing),W(2),oe("ngClass",Rt(6,kG,e.isSaveing)),W(2),oe("ngIf",e.isSaveing),W(2),Zt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteTab?null:"")}}function AG(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",2),Re("click",function(){return ze(e),_e(2).restore()}),we(2,"\u5143\u306b\u623b\u3059"),ce(),et()}}function PG(n,t){if(1&n){const e=ht();Je(0),nt(1,"hr"),ee(2,"button",20),Re("click",function(){return ze(e),_e(2).saveLog()}),we(3,"\u30ed\u30b0\u4fdd\u5b58"),ce(),ee(4,"span",5),we(5,"\u30ea\u30b9\u30c8\u304b\u3089\u9078\u3093\u3060\u30ed\u30b0\u3092\u4fdd\u5b58"),ce(),nt(6,"br"),ee(7,"button",20),Re("click",function(){return ze(e),_e(2).saveAllLog()}),we(8,"\u5168\u30bf\u30d6\u30ed\u30b0\u4fdd\u5b58"),ce(),ee(9,"span",5),we(10,"\u6642\u7cfb\u5217\u9806\u306b\u307e\u3068\u3081\u3066\u4fdd\u5b58"),ce(),nt(11,"br"),ee(12,"span"),we(13,"\u306b\u308f\u3068\u308a\u3055\u3093\u98a8\u306e\u5f62\u5f0f\u306b\u3059\u308b"),ce(),ee(14,"input",21),Re("ngModelChange",function(r){return ze(e),_e(2).modeCocLog=r}),ce(),nt(15,"br"),et()}if(2&n){const e=_e(2);W(14),oe("ngModel",e.modeCocLog)}}function FG(n,t){if(1&n){const e=ht();Je(0),we(1," \u30ed\u30b0\u306e\u6d88\u53bb\u6a5f\u80fd\u3092\u6709\u52b9\u306b\u3059\u308b"),ee(2,"input",22),Re("ngModelChange",function(r){return ze(e),_e(2).allowDeleteLog=r}),ce(),nt(3,"br"),ee(4,"button",23),Re("click",function(){return ze(e),_e(2).deleteLog()}),we(5,"\u9078\u629e\u30ed\u30b0\u6d88\u53bb"),ce(),ee(6,"button",23),Re("click",function(){return ze(e),_e(2).deleteLogALL()}),we(7,"\u5168\u30ed\u30b0\u6d88\u53bb"),ce(),et()}if(2&n){const e=_e(2);W(2),oe("ngModel",e.allowDeleteLog),W(2),Zt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteLog?null:""),W(2),Zt("disabled",e.chatTabs.length<=1?"":null)("disabled",e.allowDeleteLog?null:"")}}function RG(n,t){if(1&n){const e=ht();Je(0),ee(1,"div"),we(2,"\u30bf\u30d6\u540d : "),ee(3,"input",10),Re("ngModelChange",function(r){return ze(e),_e().tabName=r}),ce()(),nt(4,"hr"),ee(5,"div"),Se(6,MG,17,8,"ng-container",8),Se(7,AG,3,0,"ng-container",8),Se(8,PG,16,1,"ng-container",8),nt(9,"hr")(10,"br")(11,"br"),Se(12,FG,8,5,"ng-container",8),ce(),et()}if(2&n){const e=_e();W(3),oe("ngModel",e.tabName),Zt("disabled",e.isEditable?null:""),W(3),oe("ngIf",!e.isDeleted),W(1),oe("ngIf",e.isDeleted),W(1),oe("ngIf",!e.isDeleted),W(4),oe("ngIf",!e.isDeleted)}}function NG(n,t){1&n&&(Je(0),ee(1,"div",5),we(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ce(),et())}let OG=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0,this.allowDeleteLog=!1,this.allowDeleteTab=!1,this.modeCocLog=!1}get chatTabList(){return Xe.instance.get("ChatTabList")}get systemTabIndex(){return this.chatTabList.systemMessageTabIndex}set systemTabIndex(e){this.chatTabList.systemMessageTabIndex=e}systemTab(){return this.chatTabList.systemMessageTab}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Xe.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),Qe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Xe.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Qe.unregister(this)}onChangeSelectTab(e){this.selectedTab=Xe.instance.get(e),this.selectedTabXml=""}onChangeSystemTab(){if(this.selectedTab){const i=this.selectedTab.parent.children.indexOf(this.selectedTab);this.chatTabList.systemMessageTabIndex=i}else this.chatTabList.systemMessageTabIndex=0}create(){Ls.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}get roomName(){return $t.peerContext&&0<$t.peerContext.roomName.length?$t.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}appendTimestamp(e){let i=new Date;return e+`_${i.getFullYear()}-${("00"+(i.getMonth()+1)).slice(-2)}-${("00"+i.getDate()).slice(-2)}_${("00"+i.getHours()).slice(-2)}${("00"+i.getMinutes()).slice(-2)}`}saveLog(){if(!this.selectedTab)return;let i=this.appendTimestamp(this.roomName+"_log_"+this.selectedTab.name);console.log("this.modeCocLog:"+this.modeCocLog),this.modeCocLog?this.saveDataService.saveHtmlChatLogCoc(this.selectedTab,i):this.saveDataService.saveHtmlChatLog(this.selectedTab,i)}saveAllLog(){let i=this.appendTimestamp(this.roomName+"_log_\u5168\u30bf\u30d6");console.log("this.modeCocLog:"+this.modeCocLog),this.modeCocLog?this.saveDataService.saveHtmlChatLogAllCoc(i):this.saveDataService.saveHtmlChatLogAll(i)}delete(){if(!this.isEmpty&&this.selectedTab){let i=this.selectedTab.parent.children.indexOf(this.selectedTab);this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy(),this.systemTabIndex>i&&this.systemTabIndex--,this.chkSystemTabIndex()}}get myPeer(){return _t.myCursor}deleteLog(){if(this.allowDeleteLog){if(!this.isEmpty&&this.selectedTab){for(;this.selectedTab.children.length>0;)this.selectedTab.children[0].destroy();this.selectedTab.tachieReset()}this.chatMessageService.sendMessage(this.selectedTab,"\u30ed\u30b0\u3092\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f",null,this.myPeer.identifier,"",0,"#000000")}}deleteLogALL(){if(this.allowDeleteLog)for(let o of Ls.instance.chatTabs){for(;o.children.length>0;)o.children[0].destroy();o.tachieReset(),this.chatMessageService.sendMessage(o,"\u30ed\u30b0\u3092\u30af\u30ea\u30a2\u3057\u307e\u3057\u305f",null,this.myPeer.identifier,"",0,"#000000")}}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Ji.instance.parseXml(this.selectedTabXml);Ls.instance.addChatTab(e),this.selectedTabXml=""}}chkSystemTabIndex(){let e=this.chatTabList;this.systemTabIndex>=e.children.length&&(this.systemTabIndex=e.children.length-1),this.systemTabIndex<0&&(this.systemTabIndex=0)}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&(e.insertBefore(this.selectedTab,e.children[i-1]),this.systemTabIndex==i?this.systemTabIndex--:this.systemTabIndex==i-1&&this.systemTabIndex++,this.chkSystemTabIndex())}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&(e.insertBefore(e.children[i+1],this.selectedTab),this.systemTabIndex==i?this.systemTabIndex++:this.systemTabIndex==i+1&&this.systemTabIndex--,this.chkSystemTabIndex())}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(Eo),Be(ko))},n.\u0275cmp=Xt({type:n,selectors:[["app-chat-tab-setting"]],decls:17,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[2,"font-size","12px"],[2,"width","10em","overflow","hidden","font-size","14px"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],[2,"padding-left","45px"],["type","checkbox","value","allowDeleteTab",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[2,"display","inline-block","width","2em"],[1,"danger",3,"click"],[1,"progress"],[2,"width","9em",3,"click"],["type","checkbox","value","modeCocLog",3,"ngModel","ngModelChange"],["type","checkbox","value","allowDeleteLog",3,"ngModel","ngModelChange"],[1,"danger",2,"width","9em",3,"click"]],template:function(e,i){if(1&e&&(ee(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.create()}),we(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),ce()(),ee(5,"select",3),Re("change",function(o){return i.onChangeSelectTab(o.target.value)}),Se(6,DG,2,2,"option",4),ce(),ee(7,"div",5)(8,"button",2),Re("click",function(){return i.onChangeSystemTab()}),we(9,"\u30b7\u30b9\u30c6\u30e0\u8868\u793a\u5148\u6307\u5b9a"),ce()(),ee(10,"div",6),we(11," \u73fe\u5728\u30b7\u30b9\u30c6\u30e0\u8868\u793a\u5148\uff1a"),nt(12,"br"),we(13),ce()(),ee(14,"div",7),Se(15,RG,13,6,"ng-container",8),ce()(),Se(16,NG,3,0,"ng-container",8)),2&e){let r;W(5),oe("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),W(1),oe("ngForOf",i.chatTabs),W(7),ln("",null==(r=i.systemTab())?null:r.name," "),W(2),oe("ngIf",!i.isEmpty&&i.selectedTab),W(1),oe("ngIf",i.isEmpty)}},directives:[tc,Ti,yi,oi,nc,ic,Sn,Fi,ra,nr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function BG(n,t){if(1&n&&(ee(0,"option",19),we(1),ce()),2&n){const e=t.$implicit;sn("value",e.identifier),W(1),Ct(e.name)}}function LG(n,t){if(1&n&&(ee(0,"ng-option",19),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.id),W(1),Ct(e.name)}}function zG(n,t){1&n&&(ee(0,"div",20)(1,"i",21),we(2,"info_outline"),ce(),we(3," \u30c0\u30a4\u30b9\u8868\u7de8\u96c6\u4e2d\u3067\u3059 "),ce())}function UG(n,t){if(1&n&&(ee(0,"option",19),we(1),ce()),2&n){const e=t.$implicit;sn("value",e),W(1),Ct(e)}}function HG(n,t){if(1&n&&(Je(0),Se(1,UG,2,2,"option",4),et()),2&n){const e=_e(3);W(1),oe("ngForOf",e.selectedTable.diceTablePalette.getPalette())}}function VG(n,t){if(1&n&&(Je(0),Se(1,HG,2,1,"ng-container",18),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.selectedTable.diceTablePalette)}}function jG(n,t){if(1&n&&(ee(0,"div",22)(1,"select",23),Se(2,VG,2,1,"ng-container",18),ce()()),2&n){const e=_e();W(2),oe("ngIf",e.selectedTable)}}function GG(n,t){if(1&n){const e=ht();ee(0,"div",22)(1,"textarea",24),Re("ngModelChange",function(r){return ze(e),_e().editPalette=r}),ce()()}if(2&n){const e=_e();W(1),oe("ngModel",e.editPalette)}}function qG(n,t){1&n&&(ee(0,"span"),we(1,"\u30c0\u30a4\u30b9\u8868\u306e\u7de8\u96c6"),ce())}function WG(n,t){1&n&&(ee(0,"span"),we(1,"\u30c0\u30a4\u30b9\u8868\u3092\u78ba\u5b9a"),ce())}function ZG(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",2),Re("click",function(){return ze(e),_e().save()}),we(2,"\u4fdd\u5b58"),ce(),ee(3,"button",25),Re("click",function(){return ze(e),_e().delete()}),we(4,"\u524a\u9664"),ce(),et()}if(2&n){const e=_e();W(3),Zt("disabled",e.getDiceTables().length<=0?"":null)}}function YG(n,t){1&n&&(Je(0),ee(1,"div",26),we(2,"\u203b\u30c0\u30a4\u30b9\u8868\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u8868\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c0\u30a4\u30b9\u8868\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ce(),et())}const KG=function(){return{standalone:!0}};let XG=(()=>{class n{constructor(e,i,r){this.modalService=e,this.saveDataService=i,this.panelService=r,this._gameType="",this.gameTypeChange=new Kt,this.isEdit=!1,this.selectedTable=null,this.editPalette="",this.isSaveing=!1,this.progresPercent=0}get gameType(){return this.isEditable?this.selectedTable.diceTablePalette.dicebot:""}set gameType(e){this.isEditable&&(this.selectedTable.diceTablePalette.dicebot=e,this._gameType=e,this.gameTypeChange.emit(e))}loadDiceBot(e){console.log("onChangeGameType ready"),or.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}get diceBotInfos(){return or.diceBotInfos}get tableName(){return this.isEditable?this.selectedTable.name:""}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableDice(){return this.isEditable?this.selectedTable.dice:""}set tableDice(e){this.isEditable&&(this.selectedTable.dice=e)}get tableCommand(){return this.isEditable?this.selectedTable.command:""}set tableCommand(e){this.isEditable&&(this.selectedTable.command=e)}get tableText(){return this.isEditable?this.selectedTable.text:""}set tableText(e){this.isEditable&&console.log(e),this.isEditable&&(this.selectedTable.text=e+"")}get diceTablePalette(){if(!this.isEditable)return null;for(let e of this.selectedTable.children)if(e instanceof jm)return e;return null}get isEmpty(){return!1}get isSelected(){return!!this.selectedTable}get isDeleted(){return!this.selectedTable||null==Xe.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&this.isSelected&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u8868\u8a2d\u5b9a")}ngAfterViewInit(){}ngOnDestroy(){}selectDiceTable(e){this.selectedTable=Xe.instance.get(e)}getDiceTables(){return Xe.instance.getObjects(pc)}createDiceTable(){let e=pc.create();this.selectDiceTable(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedTable)return;e.isSaveing=!0,e.progresPercent=0;let i="dice_table_"+e.selectedTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTable&&this.selectedTable.destroy()}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.selectedTable.diceTablePalette.value+"":this.selectedTable.diceTablePalette.setPalette(this.editPalette)}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be(ko),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["dice-table-setting"]],inputs:{_gameType:["gameType","_gameType"]},outputs:{gameTypeChange:"gameTypeChange"},decls:41,vars:24,consts:[[1,"table"],[1,"table-cell",2,"width","13em"],[3,"click"],["size","15;padding-right:5px",2,"width","100%",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell",2,"width","5px","max-width","5px"],[1,"table-cell"],[1,"table-cell",2,"width","7em"],[2,"width","7em","display","inline-block"],[1,"table-cell",2,"width","100%","padding-right","10px"],["placeholder","Name",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],["placeholder","Dice",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],["placeholder","Command",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 150px;",4,"ngIf"],[2,"flex-grow","0"],["type","submit",3,"click"],[4,"ngIf"],[3,"value"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","150px"],["size","5",1,"palette",2,"overflow-y","auto"],["placeholder","\u30c0\u30a4\u30b9\u8868",1,"palette","is-caret",2,"resize","none",3,"ngModel","ngModelChange"],[1,"danger",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createDiceTable()}),we(4,"\u65b0\u3057\u3044\u8868\u3092\u4f5c\u308b"),ce()(),ee(5,"select",3),Re("change",function(o){return i.selectDiceTable(o.target.value)}),Se(6,BG,2,2,"option",4),ce()(),nt(7,"div",5),ee(8,"div",6)(9,"div",0)(10,"div",7)(11,"span",8),we(12,"\u8868\u30bf\u30a4\u30c8\u30eb :"),ce()(),ee(13,"div",9)(14,"input",10),Re("ngModelChange",function(o){return i.tableName=o}),ce()()(),ee(15,"div",0)(16,"div",7)(17,"span",8),we(18,"\u30c0\u30a4\u30b9 :"),ce()(),ee(19,"div",9)(20,"input",11),Re("ngModelChange",function(o){return i.tableDice=o}),ce()()(),ee(21,"div")(22,"div",7)(23,"span",8),we(24,"\u30b3\u30de\u30f3\u30c9 :"),ce()(),ee(25,"div",9)(26,"input",12),Re("ngModelChange",function(o){return i.tableCommand=o}),ce()()(),ee(27,"div")(28,"ng-select",13),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Se(29,LG,2,2,"ng-option",4),ce()(),Se(30,zG,4,0,"div",14),Se(31,jG,3,1,"div",15),Se(32,GG,2,1,"div",15),ee(33,"div",16)(34,"button",17),Re("click",function(){return i.toggleEditMode()}),Se(35,qG,2,0,"span",18),Se(36,WG,2,0,"span",18),ce()(),nt(37,"hr"),ee(38,"div"),Se(39,ZG,5,1,"ng-container",18),ce(),Se(40,YG,3,0,"ng-container",18),ce()()),2&e&&(W(3),Zt("disabled",i.isEdit?"":null),W(2),oe("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),Zt("disabled",i.isEdit?"":null),W(1),oe("ngForOf",i.getDiceTables()),W(8),oe("ngModel",i.tableName),Zt("disabled",i.isEditable?null:""),W(6),oe("ngModel",i.tableDice),Zt("disabled",i.isEditable?null:""),W(6),oe("ngModel",i.tableCommand),Zt("disabled",i.isEditable?null:""),W(2),oe("ngModel",i.gameType)("ngModelOptions",mr(23,KG))("clearable",!1),Zt("disabled",i.isEditable?null:""),W(1),oe("ngForOf",i.diceBotInfos),W(1),oe("ngIf",i.isEdit),W(1),oe("ngIf",!i.isEdit),W(1),oe("ngIf",i.isEdit),W(2),Zt("disabled",i.isEditable?null:""),W(1),oe("ngIf",!i.isEdit),W(1),oe("ngIf",i.isEdit),W(3),oe("ngIf",!i.isDeleted),W(1),oe("ngIf",i.isEmpty))},directives:[tc,Ti,yi,oi,nc,ic,Fi,pg,xf,Sn],styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}.dice-table[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:15em}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:top;box-sizing:border-box}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),Ii=(()=>{class n{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return n.\u0275fac=function(e){return new(e||n)(Be(Xv,16))},n.\u0275pipe=Vr({name:"safe",type:n,pure:!0}),n})();function QG(n,t){1&n&&gn(0)}function JG(n,t){1&n&&(ee(0,"div"),we(1,"\u81ea\u5206\u3057\u304b\u90e8\u5c4b\u306b\u3044\u307e\u305b\u3093"),ce())}function eq(n,t){1&n&&gn(0)}const tq=function(){return{box:!0}},nq=function(n){return{peer:n}};function iq(n,t){if(1&n&&(ee(0,"div",6),Se(1,eq,1,0,"ng-container",7),ce()),2&n){const e=t.$implicit;_e();const i=an(7);oe("ngClass",mr(3,tq)),W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(4,nq,e))}}function rq(n,t){if(1&n){const e=ht();ee(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"input",12),Re("ngModelChange",function(r){return ze(e),_e().includSelf=r})("click",function(){return ze(e),_e().changeIncludSelf()}),ce(),ee(5,"span"),we(6,"\u81ea\u5206\u3092\u542b\u3081\u308b"),ce(),ee(7,"input",13),Re("change",function(){return ze(e),_e().onChangeType()}),ce(),ee(8,"span"),we(9,"\u70b9\u547c"),ce(),ee(10,"input",14),Re("change",function(){return ze(e),_e().onChangeType()}),ce(),ee(11,"span"),we(12,"\u6295\u7968"),ce()(),ee(13,"div",11)(14,"span",15),we(15,"\u30bf\u30a4\u30c8\u30eb:"),ce(),ee(16,"input",16),Re("ngModelChange",function(r){return ze(e),_e().voteTitle=r}),ce(),nt(17,"br"),ee(18,"span",15),we(19,"\u9078\u629e\u80a2:"),ce(),ee(20,"input",17),Re("ngModelChange",function(r){return ze(e),_e().voteContentsText=r}),ce()(),ee(21,"div",11)(22,"button",18),Re("click",function(){return ze(e),_e().send()}),we(23,"\u9001\u4fe1"),ce(),nt(24,"br"),ee(25,"span",19),we(26),ce()()()()()}if(2&n){const e=_e();W(4),ta("id","includSelf_",e.initTimestamp,""),oe("ngModel",e.includSelf),W(3),ta("id","rollcall_",e.initTimestamp,""),oe("checked",!0),W(3),ta("id","vote_",e.initTimestamp,""),W(6),oe("ngModel",e.voteTitle),Zt("disabled",e.isRollCall?"":null),W(4),oe("ngModel",e.voteContentsText),Zt("disabled",e.isRollCall?"":null),W(2),Zt("disabled",0==e.selectedNum()?"":null),W(4),ln("\u4eba\u6570:",e.selectedNum(),"")}}function oq(n,t){if(1&n&&(ee(0,"div",31),Ft(1,"safe"),ce()),2&n){const e=_e().peer;cn("background-image",Nt(1,2,"url("+_e().findPeerImage(e.peerId).url+")","style"))}}function sq(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e().peer,i=_e();W(1),Ct(i.findPeerLastControlName(e.peerId))}}function aq(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function lq(n,t){if(1&n&&(ee(0,"div",31),Ft(1,"safe"),ce()),2&n){const e=_e().peer;cn("background-image",Nt(1,2,"url("+_e().findPeerLastControlImage(e.peerId).url+")","style"))}}function cq(n,t){1&n&&nt(0,"div",32)}function uq(n,t){if(1&n){const e=ht();ee(0,"div",20),Re("click",function(){const o=ze(e).peer;return _e().voteBlockClick(o.peerId)}),ee(1,"div",21)(2,"div",22)(3,"div",23),we(4," \u9001\u4fe1\u5bfe\u8c61 "),ce(),ee(5,"div",24)(6,"div")(7,"input",25),Re("change",function(){const o=ze(e).peer;return _e().onChange(o.peerId)}),ce()()()(),ee(8,"div",22)(9,"div",26),we(10),ce(),ee(11,"div",27),Se(12,oq,2,5,"div",28),ce()(),ee(13,"div",22)(14,"div",26),Se(15,sq,2,1,"ng-container",2),Se(16,aq,2,0,"ng-container",2),ce(),ee(17,"div",27),Se(18,lq,2,5,"div",28),Se(19,cq,1,0,"div",28),ce()(),ee(20,"div",29)(21,"div",30),we(22," \u73fe\u5728\u63a5\u7d9a\u304c\u5207\u308c\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u308b\u76f8\u624b\u3067\u3059 "),ce()()()()}if(2&n){const e=t.peer,i=_e();W(7),tg("id","",e.peerId,"_",i.initTimestamp,""),W(3),ln(" ",i.findPeerName(e.peerId)," "),W(2),oe("ngIf",i.findPeerImage(e.peerId)),W(3),oe("ngIf",i.findPeerLastControlName(e.peerId)),W(1),oe("ngIf",!i.findPeerLastControlName(e.peerId)),W(2),oe("ngIf",i.findPeerLastControlImage(e.peerId)),W(1),oe("ngIf",!i.findPeerLastControlImage(e.peerId)),W(2),oe("hidden",!i.isPeerIsDisConnect(e.peerId))}}let dq=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.initTimestamp=0,this.networkService=$t,this.voteContentsText="",this.voteTitle="\u6295\u7968",this.isRollCall=!0,this.includSelf=!1,this.initTimestamp=Date.now()}get peerList(){return this.networkService.peerContexts}get myPeer(){return _t.myCursor}get vote(){return Xe.instance.get("Vote")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u70b9\u547c/\u6295\u7968\u8a2d\u5b9a"),this.setDefaultCheck()}ngAfterViewInit(){setTimeout(()=>{this.setDefaultCheck()},0)}isPeerIsDisConnect(e){return!_t.findByPeerId(e)||_t.findByPeerId(e).isDisConnect}setDefaultCheck(){const e=this.peerList;for(let i of e){let r=document.getElementById(i.peerId+"_"+this.initTimestamp);r&&(r.checked=!this.isPeerIsDisConnect(i.peerId))}}selectedNum(){return this.selectedList().length}selectedList(){const i=this.peerList;let r=[];for(let o of i){let s=document.getElementById(o.peerId+"_"+this.initTimestamp);s&&s.checked&&r.push(o.peerId)}return this.includSelf&&r.push(this.myPeer.peerId),r}send(){let i,o,e=this.vote,r=this.voteContentsText.replace(/\s*$/i,"").replace(/^\s*/i,"");this.isRollCall?(r="\u6e96\u5099\u5b8c\u4e86",o="\u70b9\u547c\u958b\u59cb\uff01",i="\u70b9\u547c"):(r=0==r.length?"\u8cdb\u6210 \u53cd\u5bfe":r,o="\u6295\u7968\u958b\u59cb\uff01("+this.voteTitle+")",i=this.voteTitle);let s=r.split(/\s+/i),a=this.selectedList();e.makeVote(_t.myCursor.peerId,i,a,s,this.isRollCall),e.startVote(),this.chatMessageService.sendSystemMessageLastSendCharactor(o),this.panelService.close()}changeIncludSelf(){}onChangeType(e){let i=document.getElementById("rollcall_"+this.initTimestamp);this.isRollCall=i.checked}voteBlockClick(e){let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.voteBlockClick(e)}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(Eo),Be(ko))},n.\u0275cmp=Xt({type:n,selectors:[["app-vote-menu"]],decls:8,vars:3,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["voteTop",""],["voteTargets",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"display","table"],[2,"display","table-cell"],["type","checkbox","value","includSelf","name","includSelf",3,"ngModel","id","ngModelChange","click"],["type","radio","name","vote_rollcall","value","rollcall",3,"checked","id","change"],["type","radio","name","vote_rollcall","value","vote",3,"id","change"],[2,"display","inline-block","width","5em","margin-left","0.5em"],["placeholder","","name","voteTitle",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207 \u672a\u5165\u529b\u3067\u8cdb\u6210/\u53cd\u5bfe","name","voteContents",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],[3,"click"],[2,"display","inline-block","margin-left","0.5em"],[1,"inventory-object",3,"click"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name",2,"width","6em"],[1,"message",2,"height","64px"],["type","checkbox","name","vote_chk",3,"id","change"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[1,"table-cell","message"],[3,"hidden"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(ee(0,"div",0),Se(1,QG,1,0,"ng-container",1),Se(2,JG,2,0,"div",2),Se(3,iq,2,6,"div",3),ce(),Se(4,rq,27,11,"ng-template",null,4,zn),Se(6,uq,23,9,"ng-template",null,5,zn)),2&e){const r=an(5);W(1),oe("ngTemplateOutlet",r),W(1),oe("ngIf",i.peerList.length<1),W(1),oe("ngForOf",i.peerList)}},directives:[Ra,Sn,oi,nr,ps,gs,yo,ra,Ti,yi,Fi],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:10px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function fq(n,t){1&n&&gn(0)}function hq(n,t){1&n&&(ee(0,"div"),we(1,"\u81ea\u5206\u3057\u304b\u90e8\u5c4b\u306b\u3044\u307e\u305b\u3093"),ce())}function gq(n,t){1&n&&gn(0)}const pq=function(){return{box:!0}},_q=function(n){return{peer:n}};function mq(n,t){if(1&n&&(ee(0,"div",6),Se(1,gq,1,0,"ng-container",7),ce()),2&n){const e=t.$implicit;_e();const i=an(7);oe("ngClass",mr(3,pq)),W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(4,_q,e))}}function $q(n,t){if(1&n){const e=ht();ee(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"input",12),Re("ngModelChange",function(r){return ze(e),_e().includSelf=r})("click",function(){return ze(e),_e().changeIncludSelf()}),ce(),ee(5,"span"),we(6,"\u81ea\u5206\u3092\u542b\u3081\u308b"),ce()(),ee(7,"div",13)(8,"div",14)(9,"span",15),we(10,"\u30bf\u30a4\u30c8\u30eb:"),ce(),ee(11,"input",16),Re("ngModelChange",function(r){return ze(e),_e().alarmTitle=r}),ce(),nt(12,"br"),ee(13,"span",15),we(14,"\u6642\u9593:"),ce(),ee(15,"input",17),Re("ngModelChange",function(r){return ze(e),_e().alarmTime=r})("change",function(){return ze(e),_e().changeAlarmTime()}),ce(),we(16,"\u79d2 "),ce()(),ee(17,"div",11)(18,"button",18),Re("click",function(){return ze(e),_e().send()}),we(19,"\u9001\u4fe1"),ce(),nt(20,"br"),ee(21,"span",19),we(22),ce()(),ee(23,"div",13)(24,"input",20),Re("ngModelChange",function(r){return ze(e),_e().isSound=r})("click",function(){return ze(e),_e().changeIsSound()}),ce(),ee(25,"span"),we(26,"\u97f3"),ce(),ee(27,"input",21),Re("ngModelChange",function(r){return ze(e),_e().isPopUp=r})("click",function(){return ze(e),_e().changeIsPopUp()}),ce(),ee(28,"span"),we(29,"\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7"),ce()()()()()}if(2&n){const e=_e();W(4),ta("id","includSelf_",e.initTimestamp,""),oe("ngModel",e.includSelf),W(7),oe("ngModel",e.alarmTitle),W(4),oe("ngModel",e.alarmTime),W(3),Zt("disabled",0==e.selectedNum()?"":null),W(4),ln("\u4eba\u6570:",e.selectedNum(),""),W(2),ta("id","isSound_",e.initTimestamp,""),oe("ngModel",e.isSound),W(3),ta("id","isPopUp_",e.initTimestamp,""),oe("ngModel",e.isPopUp)}}function vq(n,t){if(1&n&&(ee(0,"div",33),Ft(1,"safe"),ce()),2&n){const e=_e().peer;cn("background-image",Nt(1,2,"url("+_e().findPeerImage(e.peerId).url+")","style"))}}function bq(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e().peer,i=_e();W(1),Ct(i.findPeerLastControlName(e.peerId))}}function yq(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function Cq(n,t){if(1&n&&(ee(0,"div",33),Ft(1,"safe"),ce()),2&n){const e=_e().peer;cn("background-image",Nt(1,2,"url("+_e().findPeerLastControlImage(e.peerId).url+")","style"))}}function xq(n,t){1&n&&nt(0,"div",34)}function wq(n,t){if(1&n){const e=ht();ee(0,"div",22),Re("click",function(){const o=ze(e).peer;return _e().voteBlockClick(o.peerId)}),ee(1,"div",23)(2,"div",24)(3,"div",25),we(4," \u9001\u4fe1\u5bfe\u8c61 "),ce(),ee(5,"div",26)(6,"div")(7,"input",27),Re("change",function(){const o=ze(e).peer;return _e().onChange(o.peerId)}),ce()()()(),ee(8,"div",24)(9,"div",28),we(10),ce(),ee(11,"div",29),Se(12,vq,2,5,"div",30),ce()(),ee(13,"div",24)(14,"div",28),Se(15,bq,2,1,"ng-container",2),Se(16,yq,2,0,"ng-container",2),ce(),ee(17,"div",29),Se(18,Cq,2,5,"div",30),Se(19,xq,1,0,"div",30),ce()(),ee(20,"div",31)(21,"div",32),we(22," \u73fe\u5728\u63a5\u7d9a\u304c\u5207\u308c\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u308b\u76f8\u624b\u3067\u3059 "),ce()()()()}if(2&n){const e=t.peer,i=_e();W(7),tg("id","",e.peerId,"_",i.initTimestamp,""),W(3),ln(" ",i.findPeerName(e.peerId)," "),W(2),oe("ngIf",i.findPeerImage(e.peerId)),W(3),oe("ngIf",i.findPeerLastControlName(e.peerId)),W(1),oe("ngIf",!i.findPeerLastControlName(e.peerId)),W(2),oe("ngIf",i.findPeerLastControlImage(e.peerId)),W(1),oe("ngIf",!i.findPeerLastControlImage(e.peerId)),W(2),oe("hidden",!i.isPeerIsDisConnect(e.peerId))}}let Eq=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.initTimestamp=0,this.networkService=$t,this.voteContentsText="",this.alarmTitle="\u30bf\u30a4\u30de",this.alarmTime=60,this.isRollCall=!0,this.includSelf=!0,this.isSound=!0,this.isPopUp=!0,this.initTimestamp=Date.now()}get peerList(){return this.networkService.peerContexts}get myPeer(){return _t.myCursor}get alarm(){return Xe.instance.get("Alarm")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30a2\u30e9\u30fc\u30e0\u30bf\u30a4\u30de"),this.setDefaultCheck()}ngAfterViewInit(){setTimeout(()=>{this.setDefaultCheck()},0)}isPeerIsDisConnect(e){return!_t.findByPeerId(e)||_t.findByPeerId(e).isDisConnect}setDefaultCheck(){const e=this.peerList;for(let i of e){let r=document.getElementById(i.peerId+"_"+this.initTimestamp);r&&(r.checked=!this.isPeerIsDisConnect(i.peerId))}}selectedNum(){return this.selectedList().length}selectedList(){const i=this.peerList;let r=[];for(let o of i){let s=document.getElementById(o.peerId+"_"+this.initTimestamp);s&&s.checked&&r.push(o.peerId)}return this.includSelf&&r.push(this.myPeer.peerId),r}send(){this.changeAlarmTime();let r,o,e=this.alarm,i=this.alarmTitle,s=this.selectedList();if(r="\u30a2\u30e9\u30fc\u30e0\u30bb\u30c3\u30c8 "+this.alarmTime+"\u79d2",this.peerList.length+1==this.selectedNum())o=" >\u5168\u54e1 ";else{o=" >";for(let a of s)o+=this.findPeerName(a)+" "}r+=o,e.makeAlarm(this.alarmTime,i,s,this.myPeer.peerId,o,this.isSound,this.isPopUp),this.chatMessageService.sendSystemMessageLastSendCharactor(r),e.startAlarm(),this.panelService.close()}changeAlarmTime(){this.alarmTime<=0&&(this.alarmTime=0),this.alarmTime>=3600&&(this.alarmTime=3600)}changeIncludSelf(){}changeIsSound(){}changeIsPopUp(){}onChangeType(e){let i=document.getElementById("rollcall_"+this.initTimestamp);this.isRollCall=i.checked}voteBlockClick(e){let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.voteBlockClick(e)}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(Eo),Be(ko))},n.\u0275cmp=Xt({type:n,selectors:[["app-alarm-menu"]],decls:8,vars:3,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["alarmTop",""],["alarmTargets",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"display","table"],[2,"display","table-cell"],["type","checkbox","value","includSelf","name","includSelf",3,"ngModel","id","ngModelChange","click"],[2,"display","table-cell","align","left"],[2,"text-align","left"],[2,"display","inline-block","width","5em","margin-left","0.5em"],["placeholder","\u30a2\u30e9\u30fc\u30e0","name","alarmTitle",1,"is-caret",2,"width","15em",3,"ngModel","ngModelChange"],["type","number","placeholder","","name","alarmTime",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange","change"],[3,"click"],[2,"display","inline-block","margin-left","0.5em"],["type","checkbox","value","isSound","name","isSound",3,"ngModel","id","ngModelChange","click"],["type","checkbox","value","isPopUp","name","isPopUp",3,"ngModel","id","ngModelChange","click"],[1,"inventory-object",3,"click"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name",2,"width","6em"],[1,"message",2,"height","64px"],["type","checkbox","name","vote_chk",3,"id","change"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[1,"table-cell","message"],[3,"hidden"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(ee(0,"div",0),Se(1,fq,1,0,"ng-container",1),Se(2,hq,2,0,"div",2),Se(3,mq,2,6,"div",3),ce(),Se(4,$q,30,10,"ng-template",null,4,zn),Se(6,wq,23,9,"ng-template",null,5,zn)),2&e){const r=an(5);W(1),oe("ngTemplateOutlet",r),W(1),oe("ngIf",i.peerList.length<1),W(1),oe("ngForOf",i.peerList)}},directives:[Ra,Sn,oi,nr,ps,gs,yo,ra,Ti,yi,Fi,_s],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:10px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),Fg=(()=>{class n{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Yo(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return n.\u0275fac=function(e){return new(e||n)(In(An))},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Tq=["textArea"],Sq=function(){return{standalone:!0}};let Dq=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this._autoCompleteListLen=-1,this._text="",this.chat=new Kt,this.initTimestamp=0,this.previousWritingLength=0,this.calcFitHeightInterval=null,this.history=new Array,this.currentHistoryIndex=-1,this.initTimestamp=Date.now()}get text(){return this._text}set text(e){this._text=e}get diceBotInfos(){return or.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){this.kickCalcFitHeight()}ngOnDestroy(){}onInput(){this.previousWritingLength=this.text.length,this.calcFitHeight()}kickCalcFitHeight(){null==this.calcFitHeightInterval&&(this.calcFitHeightInterval=setTimeout(()=>{this.calcFitHeightInterval=null,this.calcFitHeight(),document.getElementById("messageFix_"+this.initTimestamp).focus()},0))}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;console.log("calcFitHeight"),e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}fix(e){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.chatMessage.text!=this.text&&(this.chatMessage.text=this.text,this.chatMessage.fixd=!0),this.panelService.close())}cancel(){this.panelService.close()}}return n.MAX_HISTORY_NUM=1e3,n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Eo),Be(Fg),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["chat-message-fix"]],viewQuery:function(e,i){if(1&e&&Gn(Tq,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{_autoCompleteListLen:["autoCompleteListLen","_autoCompleteListLen"],_text:["text","_text"]},outputs:{chat:"chat"},decls:7,vars:4,consts:[[1,"table"],[1,"chat-input","is-caret",3,"id","ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"textarea",1,2),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.fix(o)}),ce(),ee(3,"button",3),Re("click",function(){return i.fix(null)}),we(4,"\u5909\u66f4"),ce(),ee(5,"button",3),Re("click",function(){return i.cancel()}),we(6,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce()()),2&e&&(W(1),ta("id","messageFix_",i.initTimestamp,""),oe("ngModel",i.text)("ngModelOptions",mr(3,Sq)))},directives:[Fi,Ti,yi],styles:[".small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 180px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function Iq(n,t){if(1&n&&(nt(0,"img",14),Ft(1,"safe")),2&n){const e=_e(2);oe("src",Nt(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),fn)}}function kq(n,t){1&n&&gn(0)}function Mq(n,t){1&n&&(Je(0),we(1,"\xa0(\u7de8\u96c6\u6e08)"),et())}function Aq(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",15),Re("click",function(){return ze(e),_e(2).clickFix()}),we(2,"\xa0[\u7de8\u96c6]"),ce(),et()}}const IP=function(n,t,e){return{"direct-message":n,"system-message":t,"dicebot-message":e}},kP=function(n){return{color:n}};function Pq(n,t){if(1&n&&(Je(0),ee(1,"div",4)(2,"div",5),Se(3,Iq,2,4,"img",6),ce(),ee(4,"div",7)(5,"div",8)(6,"span",9),we(7),ce(),ee(8,"span",10),we(9),ce(),ee(10,"span",11),we(11),Ft(12,"date"),ce()(),ee(13,"div",12),Se(14,kq,1,0,"ng-container",13),Se(15,Mq,2,0,"ng-container",1),Se(16,Aq,3,0,"ng-container",1),ce()()(),et()),2&n){const e=_e(),i=an(5),r=an(7);W(1),oe("ngClass",Wo(14,IP,(e.chatMessage.isDirect||e.chatMessage.isSecret)&&!e.chatMessage.isSystemToPL,e.chatMessage.isSystem,e.chatMessage.isDicebot)),W(2),oe("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length)),W(1),oe("ngStyle",Rt(18,kP,e.chatMessage.messColor)),W(3),Ct(e.chatMessage.name),W(2),Ct(e.chatMessage.from),W(2),Ct(Nt(12,11,e.chatMessage.timestamp,"y/M/d H:mm")),W(3),oe("ngIf",!e.chatMessage.isSecret||e.chatMessage.isSendFromSelf)("ngIfThen",i)("ngIfElse",r),W(1),oe("ngIf",e.chatMessage.fixd),W(1),oe("ngIf",e.chatMessage.changeable)}}function Fq(n,t){if(1&n&&(ee(0,"font",10),we(1),ce()),2&n){const e=_e(2);W(1),Ct(e.chatMessage.from)}}function Rq(n,t){if(1&n&&(ee(0,"font",11),we(1),Ft(2,"date"),ce()),2&n){const e=_e(2);W(1),Ct(Nt(2,1,e.chatMessage.timestamp,"H:mm"))}}function Nq(n,t){1&n&&gn(0)}function Oq(n,t){1&n&&(Je(0),we(1,"\xa0(\u7de8\u96c6\u6e08)"),et())}function Bq(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",15),Re("click",function(){return ze(e),_e(2).clickFix()}),we(2,"\xa0[\u7de8\u96c6]"),ce(),et()}}function Lq(n,t){if(1&n&&(Je(0),ee(1,"div",16)(2,"div",7)(3,"span",8)(4,"font",9),we(5),ce(),we(6,"\uff1a "),Se(7,Fq,2,1,"font",17),Se(8,Rq,3,4,"font",18),ee(9,"font",12),Se(10,Nq,1,0,"ng-container",13),Se(11,Oq,2,0,"ng-container",1),Se(12,Bq,3,0,"ng-container",1),ce()()()(),et()),2&n){const e=_e(),i=an(5),r=an(7);W(1),oe("ngClass",Wo(10,IP,(e.chatMessage.isDirect||e.chatMessage.isSecret)&&!e.chatMessage.isSystemToPL,e.chatMessage.isSystem,e.chatMessage.isDicebot)),W(1),oe("ngStyle",Rt(14,kP,e.chatMessage.messColor)),W(3),Ct(e.chatMessage.name),W(2),oe("ngIf",e.simpleDispFlagUserId),W(1),oe("ngIf",e.simpleDispFlagTime),W(2),oe("ngIf",!e.chatMessage.isSecret||e.chatMessage.isSendFromSelf)("ngIfThen",i)("ngIfElse",r),W(1),oe("ngIf",e.chatMessage.fixd),W(1),oe("ngIf",e.chatMessage.changeable)}}function zq(n,t){if(1&n){const e=ht();ee(0,"button",21),Re("click",function(){return ze(e),_e(2).discloseMessage()}),we(1,"\u5185\u5bb9\u3092\u516c\u958b"),ce()}}const Uq=function(){return{stripPrefix:!1}};function Hq(n,t){if(1&n&&(nt(0,"span",19),Ft(1,"safe"),Ft(2,"linky"),Se(3,zq,2,0,"button",20)),2&n){const e=_e();oe("innerHTML",function z3(n,t,e){const i=n+20,r=Tt(),o=$a(r,i);return J_(r,i)?R3(r,mo(),t,o.transform,e,o):o.transform(e)}(1,2,Nt(2,4,e.escapeHtmlAndRuby(e.chatMessage.text),mr(7,Uq))),Bc),W(3),oe("ngIf",e.chatMessage.isSecret)}}function Vq(n,t){1&n&&(ee(0,"span"),we(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),ce())}let jq=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.pointerDeviceService=i,this.panelService=r,this.simpleDispFlagTime=!1,this.simpleDispFlagUserId=!1,this.chatSimpleDispFlag=!1,this.imageFile=Ot.Empty,this.animeState="inactive"}get chatTabList(){return Xe.instance.get("ChatTabList")}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}clickFix(){console.log("clickFix");let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(Dq,{width:700,height:120,left:e.x,top:e.y,title:"\u30c1\u30e3\u30c3\u30c8\u7de8\u96c6"});r.chatMessage=this.chatMessage,r.text=this.chatMessage.text}escapeHtmlAndRuby(e){return this.escapeHtml(e).replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,'<ruby style="white-space:normal;">$1<rt>$2</rt></ruby>').replace(/\\s/g," ")}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}return n.\u0275fac=function(e){return new(e||n)(Be(Eo),Be(Di),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage",simpleDispFlagTime:"simpleDispFlagTime",simpleDispFlagUserId:"simpleDispFlagUserId",chatSimpleDispFlag:"chatSimpleDispFlag"},decls:8,vars:3,consts:[[1,"container"],[4,"ngIf"],["visible",""],["secret",""],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body",3,"ngStyle"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"src"],[1,"fix",3,"click"],[1,"message-small",3,"ngClass"],["class","tip msg-from",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[3,"innerHTML"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div"),Se(2,Pq,17,20,"ng-container",1),Se(3,Lq,13,16,"ng-container",1),ce()(),Se(4,Hq,4,8,"ng-template",null,2,zn),Se(6,Vq,2,0,"ng-template",null,3,zn)),2&e&&(W(1),oe("@flyInOut",i.animeState),W(1),oe("ngIf",!i.chatSimpleDispFlag),W(1),oe("ngIf",i.chatSimpleDispFlag))},directives:[Sn,nr,bo],pipes:[Ii,D2,Rx],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.message-small[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:2px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%], .message-small[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.fix[_ngcontent-%COMP%]{display:none;opacity:0}.container[_ngcontent-%COMP%]:hover   .fix[_ngcontent-%COMP%]{display:inline-block;opacity:1}"],data:{animation:[Na("flyInOut",[Br("* => active",[Or("200ms ease-out",Ns([mn({transform:"translateX(100px)",opacity:"0",offset:0}),mn({transform:"translateX(0)",opacity:"1",offset:1})]))]),Br("void => *",[Or("200ms ease-out",Ns([mn({opacity:"0",offset:0}),mn({opacity:"1",offset:1})]))])])]}}),n})();const Gq=["logContainer"],qq=["messageContainer"];function Wq(n,t){if(1&n&&nt(0,"chat-message",7),2&n){const e=_e().$implicit,i=_e(2);oe("chatMessage",e)("simpleDispFlagTime",i.chatTabList.simpleDispFlagTime)("simpleDispFlagUserId",i.chatTabList.simpleDispFlagUserId)("chatSimpleDispFlag",i.chatTab.chatSimpleDispFlag)}}function Zq(n,t){if(1&n&&(Je(0),Se(1,Wq,1,4,"chat-message",6),et()),2&n){const e=t.$implicit;W(1),oe("ngIf",e.isDisplayable)}}function Yq(n,t){if(1&n&&(Je(0),Se(1,Zq,2,1,"ng-container",5),et()),2&n){const e=_e();W(1),oe("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function Kq(n,t){1&n&&nt(0,"chat-message",7),2&n&&oe("chatMessage",t.$implicit)("simpleDispFlagTime",!1)("simpleDispFlagUserId",!1)("chatSimpleDispFlag",!1)}function Xq(n,t){if(1&n&&(Je(0),Se(1,Kq,1,4,"chat-message",8),et()),2&n){const e=_e();W(1),oe("ngForOf",e.sampleMessages)}}const Hw=window.navigator.userAgent.toLowerCase(),MP=Hw.indexOf("iphone")>-1||Hw.indexOf("ipad")>-1||Hw.indexOf("macintosh")>-1&&"ontouchend"in document;let Qq=(()=>{class n{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u672c\u30bd\u30d5\u30c8\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b 3rdpartylicenses \u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044 "+location.href.replace("/index.html","").replace(/\/$/,"")+"/3rdpartylicenses.txt"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u672c\u30bd\u30d5\u30c8\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u958b\u767a\u306b\u5bc4\u4e0e\u3057\u3066\u304f\u3060\u3055\u3063\u305f\u65b9\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044 https://github.com/entyu/udonarium_lily"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30ea\u30ea\u30a3\u8ffd\u52a0\u6a5f\u80fd\uff1a\u30c1\u30e3\u30c3\u30c8\u7c21\u6613\u8868\u793a\u6a5f\u80fd\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u5165\u529b\u3092\u5165\u529b\u3059\u308b\u3068\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this._minMessageHeight=26,this._minMessageHeightNormal=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.addMessage=new Kt}get minMessageHeight(){return this.chatTab&&this.chatTab.chatSimpleDispFlag?this._minMessageHeight:this._minMessageHeightNormal}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}chatMessagesDisplayableTopIndex(e,i){let o=0,s=e.length-1;for(;s>=0;s--)if(e[s].isDisplayable&&o++,o>=i)return s;return s}get minScrollHeight(){let e=this.chatTab?this.chatTab.displayableMessagesLength():this.sampleMessages.length;return console.log("minScrollHeight"+e),(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get chatTabList(){return Xe.instance.get("ChatTabList")}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new fo;for(let o in i)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){r.value=i[o];continue}null==i[o]||""===i[o]||r.setAttribute(o,i[o])}e.push(r)}this.sampleMessages=e,Qe.register(this).on("MESSAGE_ADDED",i=>{let r=Xe.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=Xe.instance.get(i.data.identifier);r&&r instanceof fo&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()}).on("RE_DRAW_CHAT",i=>{console.log("\u30c1\u30e3\u30c3\u30c8\u518d\u63cf\u753b"),setTimeout(()=>this.redraw(),0)})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new cc(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new cc(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Qe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.addMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=this.chatMessagesDisplayableTopIndex(this.chatTab.chatMessages,Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight)+1),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),console.log("resetMessages top:"+this.topIndex+" bottom:"+this.bottomIndex),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Yo(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,g=null,w=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),g=s.getBoundingClientRect(),w=a.top-g.top-this.scrollSpeed,(!r||!o)&&.25<w**2&&(this.panelService.scrollablePanel.scrollTop-=w);let G=this.logContainerRef.nativeElement.getBoundingClientRect(),me=this.messageContainerRef.nativeElement.getBoundingClientRect(),ve=me.top-G.top,Ie=ve+me.height,Oe=this.getScrollPosition();return r=Oe.top<ve,o=Ie<Oe.bottom&&Oe.bottom<Oe.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Yo(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,g=this.getScrollPosition();this.scrollSpeed=g.top-this.preScrollTop,this.preScrollTop=g.top;let w=g.top<r,G=o<g.bottom&&g.bottom<g.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!w&&!G)return;let me=g.top-(!e&&w?100:1200),ve=g.bottom+(!e&&G?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,me,ve,g,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Yo(()=>{let Oe=this.getScrollPosition();this.scrollSpeed=Oe.top-this.preScrollTop,this.preScrollTop=Oe.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}redraw(){this.changeDetector.detectChanges()}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let g=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/g)+1:r>e&&(MP||(this.topIndex+=Math.floor((r-e)/g))),i>o?MP||(this.bottomIndex-=Math.floor((i-o)/g)):i<o&&(this.bottomIndex+=Math.floor((o-i)/g)+1)}this.adjustIndex()}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(bi),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(Gn(Gq,7),Gn(qq,7)),2&e){let r;yn(r=Cn())&&(i.logContainerRef=r.first),yn(r=Cn())&&(i.messageContainerRef=r.first)}},inputs:{chatTab:"chatTab"},outputs:{addMessage:"addMessage"},features:[vr],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag",4,"ngIf"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag"],[3,"chatMessage","simpleDispFlagTime","simpleDispFlagUserId","chatSimpleDispFlag",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(ee(0,"div",0,1)(2,"div",2,3),Se(4,Yq,2,2,"ng-container",4),Se(5,Xq,2,1,"ng-container",4),ce()()),2&e&&(cn("min-height",i.minScrollHeight,"px"),W(2),cn("margin-bottom",i.bottomSpace,"px"),W(2),oe("ngIf",0<i.chatMessages.length),W(1),oe("ngIf",i.chatMessages.length<=0))},directives:[Sn,oi,jq],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),n})(),Jq=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.tabletopObject=null}get myPeer(){return _t.myCursor}get chatTabList(){return Xe.instance.get("ChatTabList")}changeDispFlagTime(){Qe.trigger("RE_DRAW_CHAT",{})}changeDispFlagUserId(){Qe.trigger("RE_DRAW_CHAT",{})}changeTachieInWindow(){}changeKeepTachieOutWindow(){}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["chat-message-setting"]],inputs:{isAllowedEmpty:"isAllowedEmpty",tabletopObject:"tabletopObject"},decls:23,vars:5,consts:[["id","file-list"],[1,"table"],[1,"table-cell",2,"width","16em"],[1,"table-cell"],["type","checkbox","value","isTachieInWindow","name","tachieInWindow",3,"ngModel","ngModelChange","click"],["type","checkbox","value","isKeepTachieOutWindow","name","isKeepTachieOutWindow",3,"ngModel","ngModelChange","click"],["type","checkbox","value","simpleDispFlagTime","name","hideInventory",3,"ngModel","ngModelChange","click"],["type","checkbox","value","simpleDispFlagUserId","name","hideInventory",3,"ngModel","ngModelChange","click"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u7acb\u3061\u7d75\u3092\u30a6\u30a3\u30f3\u30c9\u30a6\u5185\u306b\u8868\u793a: "),ce(),ee(4,"div",3)(5,"input",4),Re("ngModelChange",function(o){return i.chatTabList.isTachieInWindow=o})("click",function(){return i.changeTachieInWindow()}),ce()()(),ee(6,"div",1)(7,"div",2),we(8," \u30de\u30a6\u30b9\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u96e2\u8131\u6642"),nt(9,"br"),we(10," \u30a6\u30a3\u30f3\u30c9\u30a6\u5916\u306e\u7acb\u3061\u7d75\u3092\u4fdd\u6301: "),ce(),ee(11,"div",3)(12,"input",5),Re("ngModelChange",function(o){return i.chatTabList.isKeepTachieOutWindow=o})("click",function(){return i.changeKeepTachieOutWindow()}),ce()()(),ee(13,"div",1)(14,"div",2),we(15," \u7c21\u6613\u8868\u793a\u3067\u6642\u9593\u3092\u8868\u793a: "),ce(),ee(16,"div",3)(17,"input",6),Re("ngModelChange",function(o){return i.chatTabList.simpleDispFlagTime=o})("click",function(){return i.changeDispFlagTime()}),ce()()(),ee(18,"div",1)(19,"div",2),we(20," \u7c21\u6613\u8868\u793a\u3067ID\u3092\u8868\u793a: "),ce(),ee(21,"div",3)(22,"input",7),Re("ngModelChange",function(o){return i.chatTabList.simpleDispFlagUserId=o})("click",function(){return i.changeDispFlagUserId()}),ce()()()()),2&e&&(W(5),oe("ngModel",i.chatTabList.isTachieInWindow),W(7),oe("ngModel",i.chatTabList.isKeepTachieOutWindow),Zt("disabled",i.chatTabList.isTachieInWindow?"":null),W(5),oe("ngModel",i.chatTabList.simpleDispFlagTime),W(5),oe("ngModel",i.chatTabList.simpleDispFlagUserId))},directives:[ra,Ti,yi],styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();const eW=["tachieArea"],qa=function(n,t,e,i){return{transform:n,"z-index":t,opacity:e,height:i}};function tW(n,t){if(1&n){const e=ht();ee(0,"img",16,17),Re("mousedown",function(){return ze(e),_e(4).tachieClick(0)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_00,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 0  ) ) translateY( "+e.tachieY_Pos+"px)",e.zIndex_00,e.opacity_00,e.tachieAreaHeight00+"px"))}}function nW(n,t){if(1&n){const e=ht();ee(0,"img",18,19),Re("mousedown",function(){return ze(e),_e(4).tachieClick(1)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_01,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 1  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_01,e.opacity_01,e.tachieAreaHeight01+"px"))}}function iW(n,t){if(1&n){const e=ht();ee(0,"img",20,21),Re("mousedown",function(){return ze(e),_e(4).tachieClick(2)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_02,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 2  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_02,e.opacity_02,e.tachieAreaHeight02+"px"))}}function rW(n,t){if(1&n){const e=ht();ee(0,"img",22,23),Re("mousedown",function(){return ze(e),_e(4).tachieClick(3)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_03,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 3  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_03,e.opacity_03,e.tachieAreaHeight03+"px"))}}function oW(n,t){if(1&n){const e=ht();ee(0,"img",24,25),Re("mousedown",function(){return ze(e),_e(4).tachieClick(4)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_04,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 4  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_04,e.opacity_04,e.tachieAreaHeight04+"px"))}}function sW(n,t){if(1&n){const e=ht();ee(0,"img",26,27),Re("mousedown",function(){return ze(e),_e(4).tachieClick(5)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_05,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 5  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_05,e.opacity_05,e.tachieAreaHeight05+"px"))}}function aW(n,t){if(1&n){const e=ht();ee(0,"img",28,29),Re("mousedown",function(){return ze(e),_e(4).tachieClick(6)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_06,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 6  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_06,e.opacity_06,e.tachieAreaHeight06+"px"))}}function lW(n,t){if(1&n){const e=ht();ee(0,"img",30,31),Re("mousedown",function(){return ze(e),_e(4).tachieClick(7)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_07,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 7  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_07,e.opacity_07,e.tachieAreaHeight07+"px"))}}function cW(n,t){if(1&n){const e=ht();ee(0,"img",32,33),Re("mousedown",function(){return ze(e),_e(4).tachieClick(8)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_08,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 8  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_08,e.opacity_08,e.tachieAreaHeight08+"px"))}}function uW(n,t){if(1&n){const e=ht();ee(0,"img",34,35),Re("mousedown",function(){return ze(e),_e(4).tachieClick(9)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_09,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 9  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_09,e.opacity_09,e.tachieAreaHeight09+"px"))}}function dW(n,t){if(1&n){const e=ht();ee(0,"img",36,37),Re("mousedown",function(){return ze(e),_e(4).tachieClick(10)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_10,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 10  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_10,e.opacity_10,e.tachieAreaHeight10+"px"))}}function fW(n,t){if(1&n){const e=ht();ee(0,"img",38,39),Re("mousedown",function(){return ze(e),_e(4).tachieClick(11)}),Ft(2,"safe"),ce()}if(2&n){const e=_e(4);oe("src",Nt(2,2,e.imageFileUrl_11,"resourceUrl"),fn)("ngStyle",Fr(5,qa,"translateX(  calc( ("+e.tachieAreaWidth+"px - 100% ) / 11 * 11  ) ) translateY("+e.tachieY_Pos+"px)",e.zIndex_11,e.opacity_11,e.tachieAreaHeight11+"px"))}}function hW(n,t){if(1&n&&(Je(0),Se(1,tW,3,10,"img",4),Se(2,nW,3,10,"img",5),Se(3,iW,3,10,"img",6),Se(4,rW,3,10,"img",7),Se(5,oW,3,10,"img",8),Se(6,sW,3,10,"img",9),Se(7,aW,3,10,"img",10),Se(8,lW,3,10,"img",11),Se(9,cW,3,10,"img",12),Se(10,uW,3,10,"img",13),Se(11,dW,3,10,"img",14),Se(12,fW,3,10,"img",15),et()),2&n){const e=_e(3);W(1),oe("ngIf",0<e.imageFileUrl_00.length),W(1),oe("ngIf",0<e.imageFileUrl_01.length),W(1),oe("ngIf",0<e.imageFileUrl_02.length),W(1),oe("ngIf",0<e.imageFileUrl_03.length),W(1),oe("ngIf",0<e.imageFileUrl_04.length),W(1),oe("ngIf",0<e.imageFileUrl_05.length),W(1),oe("ngIf",0<e.imageFileUrl_06.length),W(1),oe("ngIf",0<e.imageFileUrl_07.length),W(1),oe("ngIf",0<e.imageFileUrl_08.length),W(1),oe("ngIf",0<e.imageFileUrl_09.length),W(1),oe("ngIf",0<e.imageFileUrl_10.length),W(1),oe("ngIf",0<e.imageFileUrl_11.length)}}function gW(n,t){if(1&n&&(Je(0),Se(1,hW,13,12,"ng-container",3),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isTachieDispMode)}}function pW(n,t){if(1&n&&(Je(0),Se(1,gW,2,1,"ng-container",3),et()),2&n){const e=_e();W(1),oe("ngIf",e.chatTab.tachieDispFlag)}}let AP=(()=>{class n{constructor(e,i,r,o){this.chatMessageService=e,this.changeDetectionRef=i,this.panelService=r,this.pointerDeviceService=o,this.chatTabidentifier="",this.isTilteTop=!1,this.dispByMouse=!1,this._tachieAreaWidth=0,this._zindexOffset=10,this._opacity=.66}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get tachieY_Pos(){return this.chatTabList.isTachieInWindow?0:-this.chatTabList.tachieHeightValue-26}get tachieAreaWidth(){return this._tachieAreaWidth}get chatTabList(){return Xe.instance.get("ChatTabList")}get dispFlag(){return!!(this.isTilteTop&&!this.chatTabList.isTachieInWindow||!this.isTilteTop&&this.chatTabList.isTachieInWindow)}get isTachieDispMode(){return this.chatTabList.isKeepTachieOutWindow?this.dispFlag:this.dispFlag&&this.dispByMouse}tachieAreaHeight(e){return this.chatTab&&this.chatTab.tachieDispFlag&&this.chatTab.tachiePosIsDisp(e)?this.chatTabList.tachieHeightValue:0}get tachieAreaHeight00(){return this.tachieAreaHeight(0)}get tachieAreaHeight01(){return this.tachieAreaHeight(1)}get tachieAreaHeight02(){return this.tachieAreaHeight(2)}get tachieAreaHeight03(){return this.tachieAreaHeight(3)}get tachieAreaHeight04(){return this.tachieAreaHeight(4)}get tachieAreaHeight05(){return this.tachieAreaHeight(5)}get tachieAreaHeight06(){return this.tachieAreaHeight(6)}get tachieAreaHeight07(){return this.tachieAreaHeight(7)}get tachieAreaHeight08(){return this.tachieAreaHeight(8)}get tachieAreaHeight09(){return this.tachieAreaHeight(9)}get tachieAreaHeight10(){return this.tachieAreaHeight(10)}get tachieAreaHeight11(){return this.tachieAreaHeight(11)}ngAfterViewInit(){this._tachieAreaWidth=this.tachieArea.nativeElement.offsetWidth,this.changeDetectionRef.detectChanges()}ngAfterViewChecked(){this._tachieAreaWidth=this.tachieArea.nativeElement.offsetWidth,this.changeDetectionRef.detectChanges()}get zIndex_00(){return this.chatTab.tachieZindex(0)+this._zindexOffset}get zIndex_01(){return this.chatTab.tachieZindex(1)+this._zindexOffset}get zIndex_02(){return this.chatTab.tachieZindex(2)+this._zindexOffset}get zIndex_03(){return this.chatTab.tachieZindex(3)+this._zindexOffset}get zIndex_04(){return this.chatTab.tachieZindex(4)+this._zindexOffset}get zIndex_05(){return this.chatTab.tachieZindex(5)+this._zindexOffset}get zIndex_06(){return this.chatTab.tachieZindex(6)+this._zindexOffset}get zIndex_07(){return this.chatTab.tachieZindex(7)+this._zindexOffset}get zIndex_08(){return this.chatTab.tachieZindex(8)+this._zindexOffset}get zIndex_09(){return this.chatTab.tachieZindex(9)+this._zindexOffset}get zIndex_10(){return this.chatTab.tachieZindex(10)+this._zindexOffset}get zIndex_11(){return this.chatTab.tachieZindex(11)+this._zindexOffset}get opacity_00(){return 11==this.chatTab.tachieZindex(0)?1:this._opacity}get opacity_01(){return 11==this.chatTab.tachieZindex(1)?1:this._opacity}get opacity_02(){return 11==this.chatTab.tachieZindex(2)?1:this._opacity}get opacity_03(){return 11==this.chatTab.tachieZindex(3)?1:this._opacity}get opacity_04(){return 11==this.chatTab.tachieZindex(4)?1:this._opacity}get opacity_05(){return 11==this.chatTab.tachieZindex(5)?1:this._opacity}get opacity_06(){return 11==this.chatTab.tachieZindex(6)?1:this._opacity}get opacity_07(){return 11==this.chatTab.tachieZindex(7)?1:this._opacity}get opacity_08(){return 11==this.chatTab.tachieZindex(8)?1:this._opacity}get opacity_09(){return 11==this.chatTab.tachieZindex(9)?1:this._opacity}get opacity_10(){return 11==this.chatTab.tachieZindex(10)?1:this._opacity}get opacity_11(){return 11==this.chatTab.tachieZindex(11)?1:this._opacity}get imageFileUrl_00(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[0]);return e?e.url:""}get imageFileUrl_01(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[1]);return e?e.url:""}get imageFileUrl_02(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[2]);return e?e.url:""}get imageFileUrl_03(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[3]);return e?e.url:""}get imageFileUrl_04(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[4]);return e?e.url:""}get imageFileUrl_05(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[5]);return e?e.url:""}get imageFileUrl_06(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[6]);return e?e.url:""}get imageFileUrl_07(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[7]);return e?e.url:""}get imageFileUrl_08(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[8]);return e?e.url:""}get imageFileUrl_09(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[9]);return e?e.url:""}get imageFileUrl_10(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[10]);return e?e.url:""}get imageFileUrl_11(){if(!this.chatTab.imageIdentifier)return"";let e=xt.instance.get(this.chatTab.imageIdentifier[11]);return e?e.url:""}tachieClick(e){console.log("tachieClick"+e),this.chatTab.tachiePosHide(e)}ngOnInit(){}ngOnDestroy(){Qe.unregister(this)}trackByChatTab(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(Eo),Be(bi),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["chat-tachie-img"]],viewQuery:function(e,i){if(1&e&&Gn(eW,5,di),2&e){let r;yn(r=Cn())&&(i.tachieArea=r.first)}},inputs:{chatTabidentifier:"chatTabidentifier",isTilteTop:"isTilteTop",dispByMouse:"dispByMouse"},decls:5,vars:1,consts:[["id","tachie-component_"],[1,"tachie-image-box",2,"height","0px,width:100%"],["tachieArea",""],[4,"ngIf"],["class","tachie-image pos00",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos01",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos02",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos03",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos04",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos05",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos06",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos07",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos08",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos09",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos10",3,"src","ngStyle","mousedown",4,"ngIf"],["class","tachie-image pos11",3,"src","ngStyle","mousedown",4,"ngIf"],[1,"tachie-image","pos00",3,"src","ngStyle","mousedown"],["tachie00",""],[1,"tachie-image","pos01",3,"src","ngStyle","mousedown"],["tachie01",""],[1,"tachie-image","pos02",3,"src","ngStyle","mousedown"],["tachie02",""],[1,"tachie-image","pos03",3,"src","ngStyle","mousedown"],["tachie03",""],[1,"tachie-image","pos04",3,"src","ngStyle","mousedown"],["tachie04",""],[1,"tachie-image","pos05",3,"src","ngStyle","mousedown"],["tachie05",""],[1,"tachie-image","pos06",3,"src","ngStyle","mousedown"],["tachie06",""],[1,"tachie-image","pos07",3,"src","ngStyle","mousedown"],["tachie07",""],[1,"tachie-image","pos08",3,"src","ngStyle","mousedown"],["tachie08",""],[1,"tachie-image","pos09",3,"src","ngStyle","mousedown"],["tachie09",""],[1,"tachie-image","pos10",3,"src","ngStyle","mousedown"],["tachie10",""],[1,"tachie-image","pos11",3,"src","ngStyle","mousedown"],["tachie11",""]],template:function(e,i){1&e&&(ee(0,"div")(1,"div",0)(2,"div",1,2),Se(4,pW,2,1,"ng-container",3),ce()()()),2&e&&(W(4),oe("ngIf",i.chatTab))},directives:[Sn,bo],pipes:[Ii],styles:[".message-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.message-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.tachie-image[_ngcontent-%COMP%]{position:absolute;height:250px;padding:0;vertical-align:bottom;z-index:1}"]}),n})();const _W=["tachieArea"];function mW(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",7),Re("ngModelChange",function(r){return ze(e),_e().chatTab.tachieDispFlag=r}),ce(),et()}if(2&n){const e=_e();W(1),oe("ngModel",e.chatTab.tachieDispFlag)}}function $W(n,t){1&n&&(Je(0),nt(1,"input",8),et())}function vW(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",9),Re("ngModelChange",function(r){return ze(e),_e().chatTab.chatSimpleDispFlag=r})("click",function(){return ze(e),_e().changeSimpleDisp()}),ce(),et()}if(2&n){const e=_e();W(1),oe("ngModel",e.chatTab.chatSimpleDispFlag)}}const bW=function(n){return{height:n}};let yW=(()=>{class n{constructor(e,i,r,o){this.chatMessageService=e,this.changeDetectionRef=i,this.panelService=r,this.pointerDeviceService=o,this.chatTabidentifier="",this._tachieAreaWidth=0}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get chatTabList(){return Xe.instance.get("ChatTabList")}get tachieAreaWidth(){return this._tachieAreaWidth}chkHeight(e){e<=this.chatTabList.minTachieSize&&(this.chatTabList.tachieHeightValue=this.chatTabList.minTachieSize),e>=this.chatTabList.maxTachieSize&&(this.chatTabList.tachieHeightValue=this.chatTabList.maxTachieSize)}get tachieAreaHeight(){return this.chatTab&&this.chatTab.tachieDispFlag&&this.chatTabList.isTachieInWindow?this.chatTabList.tachieHeightValue:0}ngAfterViewInit(){}ngAfterViewChecked(){}shoeMessageSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Jq,{title:"\u30c1\u30e3\u30c3\u30c8\u8a73\u7d30\u8a2d\u5b9a",left:e.x+50,top:e.y-200,width:340,height:220})}ngOnInit(){}ngOnDestroy(){Qe.unregister(this)}trackByChatTab(e,i){return i.identifier}changeSimpleDisp(){Qe.trigger("RE_DRAW_CHAT",{})}}return n.\u0275fac=function(e){return new(e||n)(Be(Eo),Be(bi),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["chat-tachie"]],viewQuery:function(e,i){if(1&e&&Gn(_W,5,di),2&e){let r;yn(r=Cn())&&(i.tachieArea=r.first)}},inputs:{chatTabidentifier:"chatTabidentifier"},decls:17,vars:12,consts:[["id","tachie-component_",3,"ngStyle"],["tachieArea",""],[3,"chatTabidentifier","isTilteTop","dispByMouse"],[4,"ngIf"],["type","number","name","tachieHeight",1,"is-caret",3,"ngModel","min","max","ngModelChange","change"],[1,"message-setting","small-font",3,"click"],[1,"material-icons","small-font"],["type","checkbox","value","tachieDispFlag","name","tachieDispFlag",3,"ngModel","ngModelChange"],["type","checkbox"],["type","checkbox","value","chatSimpleDispFlag","name","chatSimpleDispFlag",3,"ngModel","ngModelChange","click"]],template:function(e,i){1&e&&(ee(0,"div")(1,"form")(2,"div",0,1),nt(4,"chat-tachie-img",2),ce(),ee(5,"div"),we(6," \u7acb\u3061\u7d75\u8868\u793a: "),Se(7,mW,2,1,"ng-container",3),Se(8,$W,2,0,"ng-container",3),we(9," /\u30b5\u30a4\u30ba: "),ee(10,"input",4),Re("ngModelChange",function(o){return i.chatTabList.tachieHeightValue=o})("change",function(o){return i.chkHeight(o.target.value)}),ce(),we(11," \u30c1\u30e3\u30c3\u30c8\u7c21\u6613\u8868\u793a: "),Se(12,vW,2,1,"ng-container",3),ee(13,"button",5),Re("click",function(){return i.shoeMessageSetting()}),ee(14,"i",6),we(15,"settings"),ce(),we(16,"\u8a73\u7d30"),ce()()()()),2&e&&(W(2),oe("ngStyle",Rt(10,bW,i.tachieAreaHeight+"px")),W(2),oe("chatTabidentifier",i.chatTabidentifier)("isTilteTop",0)("dispByMouse",!0),W(3),oe("ngIf",i.chatTab),W(1),oe("ngIf",!i.chatTab),W(2),sn("min",i.chatTabList.minTachieSize),sn("max",i.chatTabList.maxTachieSize),oe("ngModel",i.chatTabList.tachieHeightValue),W(2),oe("ngIf",i.chatTab))},directives:[ps,gs,yo,bo,AP,Sn,ra,Ti,yi,_s,Ju,Qu,Fi],styles:[".message-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.message-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.tachie-image[_ngcontent-%COMP%]{position:absolute;height:250px;padding:0;vertical-align:bottom;z-index:1}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})(),PP=(()=>{class n{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Xt({type:n,selectors:[["badge"]],inputs:{count:"count"},features:[vr],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(ee(0,"div",0),we(1),ce()),2&e&&(oe("@bounce",i.animeState),W(1),Ct(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Na("bounce",[ox("active",mn({transform:""})),Br("* => active",[Or("600ms ease",Ns([mn({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),mn({transform:"scale3d(2, 2, 2)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),n})(),Vw=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(e,i){1&e&&(ee(0,"span")(1,"pre",0),we(2),ce()()),2&e&&(W(2),Ct(i.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),n})(),jw=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.tabletopObject=null,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get myPeer(){return _t.myCursor}changeColor(e,i){this.tabletopObject?(this.tabletopObject.chatColorCode[i]=e,this.tabletopObject.syncDummyCounter=this.tabletopObject.syncDummyCounter<2?this.tabletopObject.syncDummyCounter+1:0,console.log("changeColor:count:"+this.tabletopObject.syncDummyCounter)):this.myPeer.chatColorCode[i]=e}ngOnInit(){}chatColorCode(e){return this.tabletopObject?this.tabletopObject.chatColorCode[e]:this.myPeer.chatColorCode[e]}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["chat-color-setting"]],inputs:{isAllowedEmpty:"isAllowedEmpty",tabletopObject:"tabletopObject"},decls:14,vars:3,consts:[["id","file-list"],[1,"table"],[1,"table-cell"],["type","color","name","color01","list","color-list_01",3,"value","change"],["type","color","name","color02","list","color-list_02",3,"value","change"],["type","color","name","color03","list","color-list_03",3,"value","change"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),we(4,"\u7b2c1\u8272"),ce(),ee(5,"input",3),Re("change",function(o){return i.changeColor(o.target.value,0)}),ce()(),ee(6,"div",2)(7,"div"),we(8,"\u7b2c2\u8272"),ce(),ee(9,"input",4),Re("change",function(o){return i.changeColor(o.target.value,1)}),ce()(),ee(10,"div",2)(11,"div"),we(12,"\u7b2c3\u8272"),ce(),ee(13,"input",5),Re("change",function(o){return i.changeColor(o.target.value,2)}),ce()()()()),2&e&&(W(5),sn("value",i.chatColorCode(0)),W(4),sn("value",i.chatColorCode(1)),W(4),sn("value",i.chatColorCode(2)))},styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();const CW=["textArea"];function xW(n,t){1&n&&(nt(0,"img",23),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().imageFile.url,"resourceUrl"),fn)}function wW(n,t){if(1&n&&(ee(0,"ng-option",8),we(1),ce()),2&n){const e=_e();oe("value",null==e.myPeer?null:e.myPeer.identifier),W(1),ln("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function EW(n,t){if(1&n&&(ee(0,"ng-option",8),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.identifier),W(1),ln("",e.name," ")}}function TW(n,t){1&n&&(Je(0),we(1,"\uff08\u3042\u306a\u305f\uff09"),et())}function SW(n,t){if(1&n&&(ee(0,"ng-option",8),we(1),Se(2,TW,2,0,"ng-container",11),ce()),2&n){const e=t.$implicit,i=_e();oe("value",e.identifier),W(1),ln("",e.name," "),W(1),oe("ngIf",e===i.myPeer)}}function DW(n,t){if(1&n&&(ee(0,"ng-option",8),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.id),W(1),Ct(e.name)}}function IW(n,t){1&n&&(Je(0),ee(1,"font",24),we(2,"\u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093(\u304a\u305d\u3089\u304f\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u3059)\u518d\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ce(),et())}const Rg=function(n,t,e){return{"background-color":n,border:t,"border-radius":e}};function kW(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",25),Re("click",function(){return ze(e),_e().setColorNum(0)}),ce(),ee(2,"div",25),Re("click",function(){return ze(e),_e().setColorNum(1)}),ce(),ee(3,"div",25),Re("click",function(){return ze(e),_e().setColorNum(2)}),ce(),et()}if(2&n){const e=_e();W(1),oe("ngStyle",Wo(3,Rg,e.playerChatColor_0,"solid "+e.colorSelectorBoxBorder_0+" #666666",e.colorSelectorRadius_0)),W(1),oe("ngStyle",Wo(7,Rg,e.playerChatColor_1,"solid "+e.colorSelectorBoxBorder_1+" #666666",e.colorSelectorRadius_1)),W(1),oe("ngStyle",Wo(11,Rg,e.playerChatColor_2,"solid "+e.colorSelectorBoxBorder_2+" #666666",e.colorSelectorRadius_2))}}function MW(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",25),Re("click",function(){return ze(e),_e().setColorNum(0)}),ce(),ee(2,"div",25),Re("click",function(){return ze(e),_e().setColorNum(1)}),ce(),ee(3,"div",25),Re("click",function(){return ze(e),_e().setColorNum(2)}),ce(),et()}if(2&n){const e=_e();W(1),oe("ngStyle",Wo(3,Rg,e.charactorChatColor_0,"solid "+e.colorSelectorBoxBorder_0+" #666666",e.colorSelectorRadius_0)),W(1),oe("ngStyle",Wo(7,Rg,e.charactorChatColor_1,"solid "+e.colorSelectorBoxBorder_1+" #666666",e.colorSelectorRadius_1)),W(1),oe("ngStyle",Wo(11,Rg,e.charactorChatColor_2,"solid "+e.colorSelectorBoxBorder_2+" #666666",e.colorSelectorRadius_2))}}function AW(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",26),Re("ngModelChange",function(r){return ze(e),_e().tachieNum=r}),Ft(2,"safe"),ce(),we(3," 0/0 \u7acb\u3061\u7d75 "),et()}if(2&n){const e=_e();W(1),vi(Nt(2,3,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tachieNum)}}function PW(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e(3);W(1),ln(" ",e.selectCharacterTachie.currentValue," ")}}function FW(n,t){if(1&n&&(Je(0),Se(1,PW,2,1,"ng-container",11),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.selectCharacterTachie.currentValue.length>0)}}function RW(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",27),Re("ngModelChange",function(r){return ze(e),_e().tachieNum=r}),Ft(2,"safe"),ce(),we(3),Se(4,FW,2,1,"ng-container",11),et()}if(2&n){const e=_e();W(1),vi(Nt(2,7,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),sn("max",e.selectCharacterTachieNum-1),oe("ngModel",e.tachieNum),W(2),na(" ",e.tachieNum,"/",e.selectCharacterTachieNum-1," \u7acb\u3061\u7d75\n"),W(1),oe("ngIf",e.selectCharacterTachie)}}function NW(n,t){1&n&&(ee(0,"span"),we(1,", "),ce())}function OW(n,t){if(1&n&&(ee(0,"span",29),we(1),Se(2,NW,2,0,"span",11),ce()),2&n){const e=t.$implicit,i=t.index,r=_e(2);W(1),Ct(e),W(1),oe("ngIf",r.writingPeerNames.length!==i+1)}}function BW(n,t){if(1&n&&(Je(0),Se(1,OW,3,2,"span",28),ee(2,"span"),we(3," \u304c\u5165\u529b\u4e2d..."),ce(),et()),2&n){const e=_e();W(1),oe("ngForOf",e.writingPeerNames)}}const LW=function(n){return{"direct-message":n}},FP=function(){return{standalone:!0}};let RP=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this.autoCompleteIndex=-1,this._gameType="",this.gameTypeChange=new Kt,this._isGameTypeByUser=0,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Kt,this._sendTo="",this.sendToChange=new Kt,this._autoCompleteListLen=-1,this._text="",this.textChange=new Kt,this.chat=new Kt,this.tabSwitch=new Kt,this.autoCompleteSwitch=new Kt,this.autoCompleteDo=new Kt,this.gameHelp="",this.loadDiceName="",this.colorSelectNo_=0,this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[],this.calcFitHeightInterval=null,this.history=new Array,this.currentHistoryIndex=-1}get gameType(){return"DiceBot"==this._gameType&&0==this._isGameTypeByUser?this.config.defaultDiceBot:this._gameType}set gameType(e){this._isGameTypeByUser=1,this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get config(){return Xe.instance.get("Config")}get tachieNum(){let e=Xe.instance.get(this.sendFrom);return e instanceof Bt?e.selectedTachieNum:0}set tachieNum(e){let i=Xe.instance.get(this.sendFrom);i instanceof Bt&&(i.selectedTachieNum=e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get isGameCharacter(){return Xe.instance.get(this.sendFrom)instanceof Bt}get colorSelectNo(){return this.colorSelectNo_}set colorSelectNo(e){this.colorSelectNo_=e<0?0:e>2?2:e}get colorSelectorBoxBorder_0(){return 0==this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_1(){return 1==this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_2(){return 2==this.colorSelectNo?"3px":"1px"}get colorSelectorRadius_0(){return 0==this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_1(){return 1==this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_2(){return 2==this.colorSelectNo?"9px":"0px"}charactorChatColor(e){let i=Xe.instance.get(this.sendFrom);return i instanceof Bt?i.chatColorCode[e]:"#000000"}get selectChatColor(){return Xe.instance.get(this.sendFrom)instanceof Bt?this.charactorChatColor(this.colorSelectNo):this.playerChatColor(this.colorSelectNo)}get charactorChatColor_0(){return this.charactorChatColor(0)}get charactorChatColor_1(){return this.charactorChatColor(1)}get charactorChatColor_2(){return this.charactorChatColor(2)}playerChatColor(e){return this.myPeer.chatColorCode[e]}get playerChatColor_0(){return this.playerChatColor(0)}get playerChatColor_1(){return this.playerChatColor(1)}get playerChatColor_2(){return this.playerChatColor(2)}setColorNum(e){this.colorSelectNo=e}get selectCharacterTachie(){let e=Xe.instance.get(this.sendFrom);return e instanceof Bt&&e.imageDataElement.children.length>this.tachieNum?e.imageDataElement.children[this.tachieNum]:null}get selectCharacterTachieNum(){let e=Xe.instance.get(this.sendFrom);return e instanceof Bt?e.imageDataElement.children.length:0}get imageFile(){if(this.selectCharacterTachie)return xt.instance.get(this.selectCharacterTachie.value)||Ot.Empty;let e=Xe.instance.get(this.sendFrom),i=null;return e instanceof Bt?i=e.imageFile:e instanceof _t&&(i=e.image),i||Ot.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Bt).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return or.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Xe.instance.get(e.data.messageIdentifier),r=Xe.instance.getObjects(_t).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on("UPDATE_GAME_OBJECT",e=>{if(e.data.aliasName!==Bt.aliasName||(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom))return;let i=Xe.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=Xe.instance.get(this.sendTo);i instanceof _t&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new cc(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Qe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=_t.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=Xe.instance.get(this.sendTo);if(i instanceof _t){let r=zi.parse(i.peerId);r&&(e=r.peerId)}}Qe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(e,i){let r;e&&e.preventDefault(),this.currentHistoryIndex=i<0&&this.currentHistoryIndex<0?this.history.length-1:i>0&&this.currentHistoryIndex>=this.history.length-1?-1:this.currentHistoryIndex+i,r=this.currentHistoryIndex<0?"":this.history[this.currentHistoryIndex],this.text=r,this.previousWritingLength=this.text.length,this.kickCalcFitHeight()}selectAutoComplete(e,i){this._autoCompleteListLen>1&&e&&e.preventDefault(),this.autoCompleteSwitch.emit(i)}tabSwitchAction(e,i){e&&e.preventDefault(),this.tabSwitch.emit(i)}sendChat(e){if(e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode)return;if(this.autoCompleteIndex>=0)return console.log("\u30aa\u30fc\u30c8\u30b3\u30f3\u30d7\u30ea\u30fc\u30c8\u51e6\u7406\u5b9f\u884c INDEX:"+this.autoCompleteIndex),void this.autoCompleteDo.emit(this.autoCompleteIndex);this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.history.length>=n.MAX_HISTORY_NUM&&this.history.shift(),this.history.push(this.text),this.currentHistoryIndex=-1;const i={text:this.text,sendFrom:this.sendFrom,sendTo:this.sendTo,tachieNum:this.tachieNum,messColor:this.selectChatColor};or.loadGameSystemAsync(this.gameType).then(r=>{this.chat.emit({text:i.text,gameSystem:r,sendFrom:i.sendFrom,sendTo:i.sendTo,tachieNum:i.tachieNum,messColor:i.messColor})}),this.text="",this.previousWritingLength=this.text.length,this.kickCalcFitHeight()}kickCalcFitHeight(){null==this.calcFitHeightInterval&&(this.calcFitHeightInterval=setTimeout(()=>{this.calcFitHeightInterval=null,this.calcFitHeight()},0))}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),or.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}isGameTypeInList(){for(let e of this.diceBotInfos)if(e.id===this.gameType)return!0;return!1}showDicebotHelp(){or.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of or.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(Vw,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}shoeColorSetting(){let e=Xe.instance.get(this.sendFrom);if(e instanceof Bt){let i=this.pointerDeviceService.pointers[0],r="\u8272\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(jw,{title:r,left:i.x+50,top:i.y-300,width:300,height:170}).tabletopObject=e}else{let i=this.pointerDeviceService.pointers[0];this.panelService.open(jw,{title:"\u8272\u8a2d\u5b9a",left:i.x+50,top:i.y-150,width:300,height:120}).tabletopObject=null}}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!e.nonTalkFlag;case"graveyard":return!1;default:if(e.nonTalkFlag)return!1;for(const i of $t.peerContexts)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return n.MAX_HISTORY_NUM=1e3,n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Eo),Be(Fg),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&Gn(CW,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",autoCompleteIndex:"autoCompleteIndex",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_autoCompleteListLen:["autoCompleteListLen","_autoCompleteListLen"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat",tabSwitch:"tabSwitch",autoCompleteSwitch:"autoCompleteSwitch",autoCompleteDo:"autoCompleteDo"},decls:40,vars:26,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell",2,"width","100%"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"ud-select","is-caret",2,"width","10em",3,"ngModel","clearable","ngModelChange"],[3,"value"],[1,"ud-select","is-caret",2,"width","15em","margin-left",".1em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],[3,"click"],[4,"ngIf"],[1,"table"],[1,"table-cell","color-box-tag"],[1,"table-cell","color-setting-tag"],[1,"color-setting","small-font",3,"click"],[1,"material-icons","small-font"],[1,"table-cell","tachie-tag"],[1,"table-cell"],["placeholder","Enter:\u9001\u4fe1 Shift+Enter:\u6539\u884c Ctrl+\u4e0a\u4e0b:\u5c65\u6b74 Ctrl+\u5de6\u53f3:\u30bf\u30d6\u5207\u66ff",1,"chat-input","is-caret",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown","keydown.arrowup","keydown.arrowdown","keydown.control.arrowleft","keydown.control.arrowright"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],["size","1.5","color","#FF0000"],[1,"color",3,"ngStyle","click"],["type","range","min","0","max","0",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1),Se(2,xW,2,4,"img",2),ce(),ee(3,"div",3)(4,"div")(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Se(6,wW,2,2,"ng-option",5),Se(7,EW,2,2,"ng-option",6),ce(),we(8," \uff1e "),ee(9,"ng-select",7),Re("ngModelChange",function(o){return i.sendTo=o}),ee(10,"ng-option",8),we(11,"\u5168\u54e1"),ce(),Se(12,SW,3,3,"ng-option",6),ce(),ee(13,"ng-select",9),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Se(14,DW,2,2,"ng-option",6),ce(),ee(15,"button",10),Re("click",function(){return i.showDicebotHelp()}),we(16,"?"),ce()(),ee(17,"div"),Se(18,IW,3,0,"ng-container",11),ce(),ee(19,"div",12)(20,"div",13),Se(21,kW,4,15,"ng-container",11),Se(22,MW,4,15,"ng-container",11),ce(),ee(23,"div",14)(24,"button",15),Re("click",function(){return i.shoeColorSetting()}),ee(25,"i",16),we(26,"settings"),ce(),we(27,"\u8272\u8a2d\u5b9a"),ce()(),ee(28,"div",17),Se(29,AW,4,6,"ng-container",11),Se(30,RW,5,10,"ng-container",11),ce(),nt(31,"div",18),ce(),ee(32,"div")(33,"form")(34,"textarea",19,20),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)})("keydown.control.arrowup",function(o){return i.moveHistory(o,-1)})("keydown.control.arrowdown",function(o){return i.moveHistory(o,1)})("keydown.arrowup",function(o){return i.selectAutoComplete(o,-1)})("keydown.arrowdown",function(o){return i.selectAutoComplete(o,1)})("keydown.control.arrowleft",function(o){return i.tabSwitchAction(o,-1)})("keydown.control.arrowright",function(o){return i.tabSwitchAction(o,1)}),ce(),ee(36,"button",21),Re("click",function(){return i.sendChat(null)}),we(37,"SEND"),ce()()(),ee(38,"div",22),Se(39,BW,4,1,"ng-container",11),ce()()()),2&e&&(oe("ngClass",Rt(22,LW,i.isDirect)),W(2),oe("ngIf",0<i.imageFile.url.length),W(3),oe("ngModel",i.sendFrom)("clearable",!1),W(1),oe("ngIf",!i.onlyCharacters),W(1),oe("ngForOf",i.gameCharacters),W(2),oe("ngModel",i.sendTo)("clearable",!1),W(1),oe("value",""),W(2),oe("ngForOf",i.otherPeers),W(1),oe("ngModel",i.gameType)("ngModelOptions",mr(24,FP))("clearable",!1),W(1),oe("ngForOf",i.diceBotInfos),W(4),oe("ngIf",!i.isGameTypeInList()),W(3),oe("ngIf",!i.isGameCharacter),W(1),oe("ngIf",i.isGameCharacter),W(7),oe("ngIf",1>i.selectCharacterTachieNum),W(1),oe("ngIf",1<=i.selectCharacterTachieNum),W(4),oe("ngModel",i.text)("ngModelOptions",mr(25,FP)),W(5),oe("ngIf",0<i.writingPeerNames.length))},directives:[nr,Sn,pg,Ti,yi,xf,oi,bo,oa,Fi,ps,gs,yo],pipes:[Ii],styles:[".color-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.color-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}div.color[_ngcontent-%COMP%]{display:inline-block;border:solid 1px #000;box-sizing:border-box;position:relative;top:4px;width:18px;height:18px;margin-left:2px;margin-right:2px;background-color:#888;cursor:pointer}button.color[_ngcontent-%COMP%]:focus{outline:none}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.color-box-tag[_ngcontent-%COMP%], .color-setting-tag[_ngcontent-%COMP%]{width:4.5em;max-width:4.5em;min-width:4.5em}.tachie-tag[_ngcontent-%COMP%]{vertical-align:bottom;overflow:hidden;max-width:10em;white-space:nowrap}.tachie-num[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function zW(n,t){if(1&n){const e=ht();ee(0,"chat-tab",11),Re("addMessage",function(){return ze(e),_e().scrollToBottom()}),ce()}2&n&&oe("chatTab",_e().chatTab)}function UW(n,t){1&n&&(ee(0,"div"),we(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ce())}function HW(n,t){1&n&&nt(0,"badge",14),2&n&&oe("count",_e().$implicit.unreadLength)}function VW(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",12),Re("ngModelChange",function(r){return ze(e),_e().chatTabidentifier=r}),ce(),ee(2,"div"),we(3),Se(4,HW,1,1,"badge",13),ce()()}if(2&n){const e=t.$implicit,i=_e();W(1),sn("value",e.identifier),oe("ngModel",i.chatTabidentifier),W(2),Ct(e.name),W(1),oe("ngIf",e.hasUnread)}}let NP=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.testcount=0,this.isAutoScroll=!0,this.scrollToBottomTimer=null}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}chatTabSwitchRelative(e){let o,i=this.chatMessageService.chatTabs,r=i.findIndex(s=>s.identifier==this.chatTabidentifier);r<0||(o=r==i.length-1&&1==e?0:0==r&&-1==e?i.length-1:r+e,this.chatTabidentifier=i[o].identifier)}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}testadd(){this.chatTab.count++}get testmess(){return this.chatTab.imageIdentifier}ngOnInit(){this.sendFrom=_t.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Xe.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Qe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.chatTab?(this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name,this.panelService.chatTab=this.chatTab):(this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6",this.panelService.chatTab=null)}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(OG,{left:e.x-250,top:e.y-175,width:500,height:380}).selectedTab=this.chatTab}showDiceTableSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(XG,{left:e.x+50,top:e.y-450,width:650,height:400})}showVoteMenu(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(dq,{left:e.x+50,top:e.y-450,width:650,height:400})}showAlarmMenu(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Eq,{left:e.x+50,top:e.y-450,width:650,height:400})}checkTargetCharactor(e){let i=!1;return e.match(/^[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(i=!0),e.match(/\s[sS\uff53\uff33]?[tT\uff54\uff34][:\uff1a]([^:\uff1a]+)/g)&&(i=!0),e.match(/^[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(i=!0),e.match(/\s[tT\uff54\uff34][&\uff06]([^&\uff06]+)/g)&&(i=!0),i}targeted(e){return"table"==e.location.name&&e.targeted}targetedGameCharacterList(){let e=[];return e=Xe.instance.getObjects(Bt).filter(i=>this.targeted(i)),e}sendChat(e){if(this.chatTab){let i="",r=[],o=[];if(console.log(e.text+":"+this.checkTargetCharactor(e.text)),this.checkTargetCharactor(e.text)){r=this.targetedGameCharacterList();let s=!0;0==r.length&&(i+="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059");for(let a of r){i+=s?"":"\n";let g=e.text,w="";w=s?g:or.deleteMyselfResourceBuff(g),i+=w,i+=" ["+a.name+"]",s=!1;let G={text:"",object:null};G.text=w,G.object=a,o.push(G)}}else{i=e.text;let s={text:"",object:null};s.text=e.text,s.object=null,o.push(s)}this.chatMessageService.sendMessage(this.chatTab,i,e.gameSystem,e.sendFrom,e.sendTo,e.tachieNum,e.messColor,o)}}trackByChatTab(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(Eo),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["chat-window"]],decls:25,vars:8,consts:[[1,"component"],[1,"log"],[3,"chatTab","addMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[3,"chatTabidentifier"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat","tabSwitch"],[3,"chatTab","addMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1),Se(2,zW,1,1,"chat-tab",2),Se(3,UW,2,0,"div",3),ce(),ee(4,"div",4)(5,"form"),nt(6,"chat-tachie",5),ee(7,"div",6),Se(8,VW,5,4,"label",7),ee(9,"button",8),Re("click",function(){return i.showTabSetting()}),ee(10,"i",9),we(11,"settings"),ce(),we(12,"\u30bf\u30d6\u8a2d\u5b9a"),ce(),ee(13,"button",8),Re("click",function(){return i.showDiceTableSetting()}),ee(14,"i",9),we(15,"settings"),ce(),we(16,"\u30c0\u30a4\u30b9\u8868\u8a2d\u5b9a"),ce(),ee(17,"button",8),Re("click",function(){return i.showVoteMenu()}),ee(18,"i",9),we(19,"group"),ce(),we(20,"\u70b9\u547c"),ce(),ee(21,"button",8),Re("click",function(){return i.showAlarmMenu()}),ee(22,"i",9),we(23,"alarm"),ce()()()(),ee(24,"chat-input",10),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)})("tabSwitch",function(o){return i.chatTabSwitchRelative(o)}),ce()()()),2&e&&(W(2),oe("ngIf",i.chatTab),W(1),oe("ngIf",!i.chatTab),W(3),oe("chatTabidentifier",i.chatTabidentifier),W(2),oe("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),W(16),oe("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[Sn,Qq,ps,gs,yo,yW,oi,Xu,Fi,Ti,yi,PP,RP],styles:[".loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),n})();const jW=["root"];function GW(n,t){if(1&n&&(ee(0,"div",11),we(1),ce()),2&n){const e=_e();W(1),Ct(e.title)}}function qW(n,t){1&n&&(ee(0,"div",12)(1,"div",13),we(2,"\u9ad8"),ce(),ee(3,"div",14),we(4,"0"),ce(),ee(5,"div",15),we(6,"\u4f4e"),ce()())}function WW(n,t){if(1&n){const e=ht();ee(0,"div",16)(1,"input",17,18),Re("ngModelChange",function(r){return ze(e),_e().altitudeHande.altitude=r}),ce()()}if(2&n){const e=_e();W(1),sn("title",e.altitudeHande.altitude),oe("ngModel",e.altitudeHande.altitude)}}function ZW(n,t){if(1&n){const e=ht();ee(0,"span",20),we(1," (\u9ad8\u5ea6 "),ee(2,"input",21),Re("ngModelChange",function(r){return ze(e),_e(2).altitudeHande.altitude=r}),ce(),we(3,")"),ce()}if(2&n){const e=_e(2);W(2),oe("ngModel",e.altitudeHande.altitude)}}function YW(n,t){if(1&n&&(ee(0,"div")(1,"div",11),Se(2,ZW,4,1,"span",19),ce()()),2&n){const e=_e();W(1),cn("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),W(1),oe("ngIf",e.altitudeHande)}}function KW(n,t){1&n&&gn(0)}const OP=function(n){return{action:n}};function XW(n,t){if(1&n&&(Je(0),Se(1,KW,1,0,"ng-container",23),et()),2&n){const e=t.$implicit;_e(2);const i=an(16),r=an(14);W(1),oe("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",Rt(2,OP,e))}}function QW(n,t){if(1&n&&(Je(0),Se(1,XW,2,4,"ng-container",22),et()),2&n){const e=_e();W(1),oe("ngForOf",e.actions)}}function JW(n,t){1&n&&gn(0)}function eZ(n,t){if(1&n&&(Je(0),Se(1,JW,1,0,"ng-container",23),et()),2&n){const e=t.$implicit;_e(2);const i=an(16),r=an(12);W(1),oe("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",Rt(2,OP,e))}}function tZ(n,t){if(1&n&&(Je(0),Se(1,eZ,2,4,"ng-container",22),et()),2&n){const e=_e();W(1),oe("ngForOf",e.actions)}}function nZ(n,t){if(1&n){const e=ht();ee(0,"li",24),Re("click",function(){const o=ze(e).action;return _e().indexAction(o.line,o.id)}),ee(1,"div",25),we(2),ce()()}if(2&n){const e=t.action;W(2),na("",e.line,":",e.name,"")}}function iZ(n,t){1&n&&nt(0,"input",33),2&n&&oe("disabled",_e().action.disabled)}function rZ(n,t){1&n&&nt(0,"input",34),2&n&&oe("disabled",_e().action.disabled)}function oZ(n,t){1&n&&nt(0,"input",35),2&n&&oe("disabled",_e().action.disabled)}function sZ(n,t){1&n&&nt(0,"input",36),2&n&&oe("disabled",_e().action.disabled)}function aZ(n,t){1&n&&(ee(0,"div",37)(1,"i",38),we(2,"arrow_forward_ios"),ce()())}function lZ(n,t){if(1&n&&nt(0,"context-menu",39),2&n){const e=_e().action,i=_e();oe("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function cZ(n,t){if(1&n){const e=ht();ee(0,"li",26),Re("click",function(){const o=ze(e).action;return _e().doAction(o)})("mouseenter",function(){const o=ze(e).action;return _e().showSubMenu(o)}),ee(1,"div",25),Se(2,iZ,1,1,"input",27),Se(3,rZ,1,1,"input",28),Se(4,oZ,1,1,"input",29),Se(5,sZ,1,1,"input",30),we(6),ce(),Se(7,aZ,3,0,"div",31),Se(8,lZ,1,3,"context-menu",32),ce()}if(2&n){const e=t.action,i=_e();W(2),oe("ngIf",e.name&&0==e.name.indexOf("\u2611")),W(1),oe("ngIf",e.name&&0==e.name.indexOf("\u2610")),W(1),oe("ngIf",e.name&&0==e.name.indexOf("\u25c9")),W(1),oe("ngIf",e.name&&0==e.name.indexOf("\u25cb")),W(1),ln(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb","")," "),W(1),oe("ngIf",e.subActions),W(1),oe("ngIf",i.subMenu&&i.parentMenu===e)}}function uZ(n,t){1&n&&(ee(0,"li"),nt(1,"hr",40),ce())}const dZ=function(n,t,e){return{"submenu-panel":n,"is-max-limit":t,"pointer-events-none":e}};let fZ=(()=>{class n{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0)),this.indexMenuPosion()}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}indexMenuPosion(){if("\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"!=this.title)return;let e=this.rootElementRef.nativeElement,i=e.getBoundingClientRect();console.log("\u4f4d\u7f6e\u4fee\u6b63 lr:"+i.left+" "+i.right),e.style.left=i.left-(i.right-i.left)+"px"}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}indexAction(e,i){Qe.trigger("JUMP_INDEX",{lineNo:e,targetId:i})}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return n.\u0275fac=function(e){return new(e||n)(Be(di),Be(To),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&Gn(jW,7),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:17,vars:11,consts:[[1,"component",3,"ngClass","mouseleave"],["root",""],["class","title",4,"ngIf"],[2,"display","flex","align-items","top"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngIf"],["indexMenu",""],["actionMenu",""],["separator",""],[1,"title"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click"],[1,"menu-title"],[1,"hasHighlight",3,"click","mouseenter"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(ee(0,"div",0,1),Re("mouseleave",function(){return i.hideSubMenu()}),Se(2,GW,2,1,"div",2),ee(3,"div",3),Se(4,qW,7,0,"div",4),Se(5,WW,3,2,"div",5),ee(6,"div",6),Se(7,YW,3,5,"div",7),ee(8,"ul"),Se(9,QW,2,1,"ng-container",7),Se(10,tZ,2,1,"ng-container",7),ce()()()(),Se(11,nZ,3,2,"ng-template",null,8,zn),Se(13,cZ,9,7,"ng-template",null,9,zn),Se(15,uZ,2,0,"ng-template",null,10,zn)),2&e&&(oe("ngClass",Wo(7,dZ,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),W(2),oe("ngIf",0<i.title.length),W(2),oe("ngIf",i.altitudeHande),W(1),oe("ngIf",i.altitudeHande),W(2),oe("ngIf",i.altitudeHande),W(2),oe("ngIf","\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"!=i.title),W(1),oe("ngIf","\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"==i.title))},directives:[nr,Sn,oa,Fi,Ti,yi,_s,oi,Ra,n],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}td.altitude[_ngcontent-%COMP%]{vertical-align:middle;height:100%}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:200px;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]}),n})();function hZ(n,t){1&n&&(ee(0,"div"),we(1,"\u672a\u8a2d\u5b9a"),ce())}function gZ(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e().$implicit;W(1),Ct(e)}}function pZ(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",11),Re("ngModelChange",function(r){return ze(e),_e().selectTag=r})("change",function(){return ze(e),_e().resetBtn()}),ce(),Se(2,hZ,2,0,"div",12),Se(3,gZ,2,1,"div",12),ce()}if(2&n){const e=t.$implicit,i=_e();W(1),sn("value",e),oe("ngModel",i.selectTag),W(1),oe("ngIf",0==e.length),W(1),oe("ngIf",e.length>0)}}function _Z(n,t){if(1&n){const e=ht();ee(0,"img",18),Re("click",function(){ze(e);const r=_e().$implicit;return _e().onSelectedFile(r)}),Ft(1,"safe"),ce()}if(2&n){const e=_e().$implicit;oe("src",Nt(1,2,e.url,"resourceUrl"),fn)("alt",e.name)}}function mZ(n,t){1&n&&nt(0,"img",19),2&n&&sn("alt",_e().$implicit.name)}function $Z(n,t){if(1&n){const e=ht();ee(0,"input",20),Re("change",function(){ze(e);const r=_e().$implicit;return _e().onChange(r.identifier)}),ce()}if(2&n){const e=_e().$implicit,i=_e();tg("id","",e.identifier,"_",i.initTimestamp,"")}}function vZ(n,t){if(1&n){const e=ht();ee(0,"span",13)(1,"div",14),Re("click",function(){const o=ze(e).$implicit;return _e().imgBlockClick(o.identifier)}),Se(2,_Z,2,5,"img",15),Se(3,mZ,1,1,"img",16),Se(4,$Z,1,2,"input",17),ce()()}if(2&n){const e=t.$implicit;W(2),oe("ngIf",0<e.url.length),W(1),oe("ngIf",e.url.length<=0),W(1),oe("ngIf",0<e.url.length)}}let bZ=(()=>{class n{constructor(e,i){this.changeDetector=e,this.panelService=i,this.initTimestamp=0,this.searchWord="",this.selectedFile=null,this.fileStorageService=xt.instance,this.selectTag="",this.newTagName="",this.initTimestamp=Date.now()}get searchWords(){return this._searchWord!==this.searchWord&&(this._searchWord=this.searchWord,this._searchWords=null!=this.searchWord&&0<this.searchWord.trim().length?this.searchWord.trim().split(/\s+/):[]),this._searchWords}getAllImage(){let e=[];for(let i of this.fileStorageService.images){let r=i.context.identifier,o="";en.get(r)&&(o=en.get(r).tag),"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=o&&e.push(i)}return e}get images(){let e=[];if("\u5168\u3066"==this.selectTag)return this.getAllImage();for(let i of this.fileStorageService.images){let r=i.context.identifier;en.get(r)?en.get(r).tag==this.selectTag&&e.push(i):""==this.selectTag&&e.push(i)}return e}get isSelected(){return null!=this.selectedFile}get selectedImageTag(){return this.isSelected?en.get(this.selectedFile.identifier)||en.create(this.selectedFile.identifier):null}get tagList(){let e=[];for(let r of this.fileStorageService.images){let s=en.get(r.context.identifier);s&&s.tag&&"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=s.tag&&e.push(s.tag)}let i=Array.from(new Set(e));return i.unshift("\u5168\u3066"),i.unshift(""),i}inputNewTag(e){this.newTagName=e}changeTag(){if("\u5168\u3066"==this.newTagName||"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"==this.newTagName)return;let e=this.images;console.log("this.newTagName"+this.newTagName);for(let i of e){let r=document.getElementById(i.context.identifier+"_"+this.initTimestamp);if(r&&r.checked){let o=en.get(i.context.identifier);o=o||en.create(i.context.identifier),o.tag="\u672a\u8a2d\u5b9a"==this.newTagName?"":this.newTagName}}}resetBtn(){}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Qe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&yl.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),Qe.call("SELECT_FILE",{fileIdentifier:e.identifier},$t.peerId),this.selectedFile=e}imgBlockClick(e){console.log("identifier:"+e);let i=document.getElementById(e+"_"+this.initTimestamp);i.checked=!i.checked}onChange(e){this.imgBlockClick(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["file-storage"]],decls:23,vars:2,consts:[[1,"image-chg"],[4,"ngFor","ngForOf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[3,"click"],["maxlength","12","placeholder","\u65b0\u30bf\u30b0\u540d",1,"input","is-caret",3,"input"],["id","file-list"],["class","image_",4,"ngFor","ngForOf"],["name","image-chg","type","radio",3,"value","ngModel","ngModelChange","change"],[4,"ngIf"],[1,"image_"],[1,"img-box",2,"float","left",3,"click"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["class","img-chk","name","tag_chg_chk","type","checkbox",3,"id","change",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],["name","tag_chg_chk","type","checkbox",1,"img-chk",3,"id","change"]],template:function(e,i){1&e&&(ee(0,"form")(1,"div",0),Se(2,pZ,4,4,"label",1),ce()(),ee(3,"label")(4,"div",2)(5,"div")(6,"i",3),we(7,"add_photo_alternate"),ce()(),ee(8,"div"),we(9,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),ce(),ee(10,"div",4),we(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ce(),ee(12,"input",5),Re("change",function(o){return i.handleFileSelect(o)}),ce(),ee(13,"div",4),nt(14,"br"),we(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),ce()()(),ee(16,"div",6)(17,"div")(18,"button",7),Re("click",function(){return i.changeTag()}),we(19,"\u30bf\u30b0\u3092\u5909\u66f4"),ce(),ee(20,"input",8),Re("input",function(o){return i.inputNewTag(o.target.value)}),ce()()(),ee(21,"div",9),Se(22,vZ,5,3,"span",10),ce()),2&e&&(W(2),oe("ngForOf",i.tagList),W(20),oe("ngForOf",i.images))},directives:[ps,gs,yo,oi,Xu,Fi,Ti,yi,Sn],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer;margin-bottom:5px}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;padding:2px;border:transparent 2px solid;border-top:transparent 6px solid}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.img-chk[_ngcontent-%COMP%]{height:1em;margin-left:0}.img-box[_ngcontent-%COMP%]{border:2px dotted #666}.selected[_ngcontent-%COMP%]{border:2px dotted #666;border-top:6px solid #444}.sticky-top[_ngcontent-%COMP%]{padding:5px;position:sticky;top:0;background-color:#f0dabdcc;border-top:1px dotted #666;border-bottom:1px dotted #666}.sticky-top[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 75px)}.image-chg[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.image-chg[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}'],changeDetection:0}),n})();function yZ(n,t){1&n&&(ee(0,"div"),we(1,"\u672a\u8a2d\u5b9a"),ce())}function CZ(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e().$implicit;W(1),Ct(e)}}function xZ(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",5),Re("ngModelChange",function(r){return ze(e),_e().selectTag=r})("change",function(){return ze(e),_e().resetBtn()}),ce(),Se(2,yZ,2,0,"div",6),Se(3,CZ,2,1,"div",6),ce()}if(2&n){const e=t.$implicit,i=_e();W(1),sn("value",e),oe("ngModel",i.selectTag),W(1),oe("ngIf",0==e.length),W(1),oe("ngIf",e.length>0)}}function wZ(n,t){if(1&n){const e=ht();ee(0,"span",7)(1,"button",8),Re("click",function(){ze(e);const r=_e();return r.onSelectedFile(r.empty)}),we(2,"\u753b\u50cf\u306a\u3057"),ce()()}}function EZ(n,t){if(1&n){const e=ht();ee(0,"img",13),Re("click",function(){ze(e);const r=_e().$implicit;return _e().onSelectedFile(r)}),Ft(1,"safe"),ce()}if(2&n){const e=_e().$implicit;oe("src",Nt(1,2,e.url,"resourceUrl"),fn)("alt",e.name)}}function TZ(n,t){1&n&&nt(0,"img",14),2&n&&sn("alt",_e().$implicit.name)}function SZ(n,t){if(1&n&&(ee(0,"span",9)(1,"div",10),Se(2,EZ,2,5,"img",11),Se(3,TZ,1,1,"img",12),ce()()),2&n){const e=t.$implicit;W(2),oe("ngIf",0<e.url.length),W(1),oe("ngIf",e.url.length<=0)}}let Uf=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.searchWord="",this.isAllowedEmpty=!1,this.selectedFile=null,this.selectTag="",this.fileStorageService=xt.instance,this.identifierList=[],this.newTagName="",this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get searchWords(){return this._searchWord!==this.searchWord&&(this._searchWord=this.searchWord,this._searchWords=null!=this.searchWord&&0<this.searchWord.trim().length?this.searchWord.trim().split(/\s+/):[]),this._searchWords}getAllImage(){let e=[];for(let i of this.fileStorageService.images){let r=i.context.identifier,o="";en.get(r)&&(o=en.get(r).tag),"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=o&&e.push(i)}return e}get images(){let e=[];if("\u5168\u3066"==this.selectTag)return this.getAllImage();for(let i of this.fileStorageService.images){let r=i.context.identifier;if(en.get(r)){let o=en.get(r).tag;this.selectTag==o&&e.push(i)}else""==this.selectTag&&e.push(i)}return e}get isSelected(){return null!=this.selectedFile}get selectedImageTag(){return this.isSelected?en.get(this.selectedFile.identifier)||en.create(this.selectedFile.identifier):null}get tagList(){let e=[];for(let r of this.fileStorageService.images){let s=en.get(r.context.identifier);s&&s.tag&&"\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"!=s.tag&&e.push(s.tag)}let i=Array.from(new Set(e));return i.unshift("\u5168\u3066"),i.unshift(""),i}resetBtn(){}onChange(e,i){en.get(e)||en.create(e),i?this.identifierList.indexOf(e)<0&&this.identifierList.push(e):this.identifierList.indexOf(e)>-1&&this.identifierList.splice(this.identifierList.indexOf(e),1)}get empty(){return Ot.Empty}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Qe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}onSelectedFile(e){Qe.call("SELECT_FILE",{fileIdentifier:e.identifier},$t.peerId),this.modalService.resolve(e.identifier)}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:6,vars:3,consts:[[1,"image-chg"],[4,"ngFor","ngForOf"],["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],["name","image-chg","type","radio",3,"value","ngModel","ngModelChange","change"],[4,"ngIf"],[1,"empty"],[3,"click"],[1,"image"],[2,"float","left"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(ee(0,"form")(1,"div",0),Se(2,xZ,4,4,"label",1),ce()(),ee(3,"div",2),Se(4,wZ,3,0,"span",3),Se(5,SZ,4,2,"span",4),ce()),2&e&&(W(2),oe("ngForOf",i.tagList),W(2),oe("ngIf",i.isAllowedEmpty),W(1),oe("ngForOf",i.images))},directives:[ps,gs,yo,oi,Xu,Fi,Ti,yi,Sn],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}.sticky-top[_ngcontent-%COMP%]{padding:5px;position:sticky;top:0;background-color:#f0dabdcc;border-top:1px dotted #666;border-bottom:1px dotted #666}.sticky-top[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 75px)}.image-chg[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.image-chg[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.image-chg[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}"],changeDetection:0}),n})(),DZ=(()=>{class n{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Ot.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Qe.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=xt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}createGameCharacter(){Bt.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=da.instance.viewTable;if(!e)return;let i=So.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){Ji.instance.parseXml(e)}openModal(){this.modalService.open(Uf)}}return n.\u0275fac=function(e){return new(e||n)(Be(us),Be(hi),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["game-character-generator"]],decls:15,vars:11,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(ee(0,"button",0),Re("click",function(){return i.openModal()}),we(1,"\u753b\u50cf\u3092\u9078\u3076"),ce(),ee(2,"div"),nt(3,"img",1),Ft(4,"safe"),ce(),ee(5,"input",2),Re("ngModelChange",function(o){return i.name=o}),ce(),ee(6,"div")(7,"div")(8,"input",3),Re("ngModelChange",function(o){return i.size=o}),ce(),we(9," Size : "),ee(10,"input",4),Re("ngModelChange",function(o){return i.size=o}),ce()(),ee(11,"button",0),Re("click",function(){return i.createGameCharacter()}),we(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),ce(),ee(13,"button",0),Re("click",function(){return i.createGameTableMask()}),we(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),ce()()),2&e&&(W(3),oe("src",Nt(4,8,i.tableBackgroundImage.url,"resourceUrl"),fn),W(2),oe("ngModel",i.name),W(3),sn("min",i.minSize),sn("max",i.maxSize),oe("ngModel",i.size),W(2),sn("min",i.minSize),sn("max",i.maxSize),oe("ngModel",i.size))},directives:[Fi,Ti,yi,oa,_s,Ju,Qu],pipes:[Ii],styles:[""]}),n})();function IZ(n,t){if(1&n&&(ee(0,"ng-option",10),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.identifier),W(1),ln("",e.name," ")}}function kZ(n,t){1&n&&(nt(0,"img",11),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().imageFile.url,"resourceUrl"),fn)}let MZ=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.shouldUpdateCharacterList=!0,this._gameCharacters=[]}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Bt).filter(e=>this.allowsChat(e))),this._gameCharacters}allowsChat(e){return"table"===e.location.name&&!e.nonTalkFlag}get imageFile(){let e=Xe.instance.get(this._sendFrom);return e instanceof Bt&&xt.instance.get(e.imageDataElement.children[0].value)||Ot.Empty}get selectCharacterTachieNum(){let e=Xe.instance.get(this._sendFrom);return e instanceof Bt?e.imageDataElement.children.length:0}importImages(){let e=Xe.instance.get(this._sendFrom);if(e instanceof Bt&&Bt){console.log(this.tabletopObject.name+"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c"),console.log(e.name+"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c");let o,i=this.tabletopObject.imageDataElement,r=e.imageDataElement;for(;i.children.length<r.children.length;)console.log("\u30a4\u30e1\u30fc\u30b8\u8ffd\u52a0"),i.appendChild(yt.create("imageIdentifier","",{type:"image"},""));for(;i.children.length>r.children.length&&i.children.length>=2;)console.log("\u30a4\u30e1\u30fc\u30b8\u524a\u9664"),i.children[i.children.length-1].destroy();for(o=0;o<r.children.length;o++){let g=i.children[o],w=r.children[o];g.currentValue=w.currentValue,g.name=w.name,g.value=w.value}let a=i.parent.getElementsByName("ICON");a&&(a[0].value=i.children.length-1,a[0].currentValue>a[0].value&&(a[0].currentValue=a[0].value))}}cancel(){this.panelService.close()}ngOnInit(){this._sendFrom=this.gameCharacters.length>=1?this.gameCharacters[0].identifier:""}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["import-character-img"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:5,consts:[[1,"table"],[1,"table-cell",2,"width","7em"],[2,"text-align","center"],[1,"table-cell"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[2,"width","9em",3,"click"],[2,"width","9em","margin-left","3em",3,"click"],[3,"value"],[1,"image",3,"src"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u8907\u88fd\u5143\uff1e "),ce()(),ee(4,"div",3)(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Se(6,IZ,2,2,"ng-option",5),ce()()(),ee(7,"div",0)(8,"div",6),Se(9,kZ,2,4,"img",7),ce(),ee(10,"div",3),we(11),ce()(),nt(12,"br"),ee(13,"div",0)(14,"button",8),Re("click",function(){return i.importImages()}),we(15,"\u30a4\u30f3\u30dd\u30fc\u30c8\u5b9f\u884c"),ce(),ee(16,"button",9),Re("click",function(){return i.cancel()}),we(17,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce()()),2&e&&(W(5),oe("ngModel",i.sendFrom)("clearable",!1),W(1),oe("ngForOf",i.gameCharacters),W(3),oe("ngIf",0<i.imageFile.url.length),W(2),ln(" \u767b\u9332\u679a\u6570:",i.selectCharacterTachieNum," "))},directives:[pg,Ti,yi,oi,xf,Sn],pipes:[Ii],styles:[".flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:100px;height:100px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{height:100%;vertical-align:bottom;object-fit:cover}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();function AZ(n,t){1&n&&gn(0)}function PZ(n,t){if(1&n){const e=ht();Je(0),Se(1,AZ,1,0,"ng-container",11),ee(2,"select",12),Re("change",function(r){return ze(e),_e(4).setElementType(r.target.value)}),ee(3,"option",13),we(4,"\u901a\u5e38"),ce(),ee(5,"option",14),we(6,"\u30ea\u30bd\u30fc\u30b9"),ce(),ee(7,"option",15),we(8,"\u30ce\u30fc\u30c8"),ce(),ee(9,"option",16),we(10,"\u30c1\u30a7\u30c3\u30af/\u8868"),ce(),ee(11,"option",17),we(12,"\u5358\u4e00\u30c1\u30a7\u30c3\u30af"),ce()(),et()}if(2&n){const e=_e(4),i=an(2);W(1),oe("ngTemplateOutlet",i),W(1),oe("ngModel",e.gameDataElement.type)}}function FZ(n,t){1&n&&gn(0)}function RZ(n,t){if(1&n&&(Je(0),Se(1,FZ,1,0,"ng-container",11),et()),2&n){_e(4);const e=an(4);W(1),oe("ngTemplateOutlet",e)}}function NZ(n,t){1&n&&gn(0)}function OZ(n,t){if(1&n&&(Je(0),Se(1,NZ,1,0,"ng-container",11),et()),2&n){_e(4);const e=an(6);W(1),oe("ngTemplateOutlet",e)}}function BZ(n,t){if(1&n&&(ee(0,"div",6),Se(1,PZ,13,2,"ng-container",0),Se(2,RZ,2,1,"ng-container",0),Se(3,OZ,2,1,"ng-container",0),ce()),2&n){const e=_e(3);W(1),oe("ngIf",!e.isImage),W(1),oe("ngIf",e.isImage&&e.indexNum>=1),W(1),oe("ngIf",e.isImage&&e.indexNum<1)}}function LZ(n,t){if(1&n&&(Je(0),ee(1,"div",18),we(2),ce(),et()),2&n){const e=_e(4);W(2),Ct(e.name)}}function zZ(n,t){if(1&n&&(Je(0),Se(1,LZ,3,1,"ng-container",0),et()),2&n){const e=_e(3);W(1),oe("ngIf",!e.isImage)}}function UZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",19),we(2),ce(),ee(3,"input",20),Re("ngModelChange",function(r){return ze(e),_e(4).name=r}),ce(),et()}if(2&n){const e=_e(4);W(2),Ct(e.name),W(1),oe("ngModel",e.name)}}function HZ(n,t){if(1&n&&(Je(0),Se(1,UZ,4,2,"ng-container",0),et()),2&n){const e=_e(3);W(1),oe("ngIf",!e.isImage)}}function VZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",21),Re("ngModelChange",function(r){return ze(e),_e(3).currentValue=r}),Ft(2,"safe"),ce(),nt(3,"br"),ee(4,"input",22),Re("ngModelChange",function(r){return ze(e),_e(3).currentValue=r}),ce(),we(5," / "),ee(6,"input",23),Re("ngModelChange",function(r){return ze(e),_e(3).value=r}),ce(),et()}if(2&n){const e=_e(3);W(1),vi(Nt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),oe("ngModel",e.currentValue),W(3),oe("ngModel",e.currentValue),W(2),oe("ngModel",e.value)}}const jZ=function(){return{stripPrefix:!1}};function GZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"span",24),we(2," \xa0\xa0URL\u7de8\u96c6:"),ee(3,"input",25),Re("change",function(){return ze(e),_e(3).changeChk()}),ce()(),ee(4,"textarea",26),Re("ngModelChange",function(r){return ze(e),_e(3).value=r})("focus",function(){ze(e);const r=_e(3);return r.textFocus(r.gameDataElement.myIdentifer+"_elm")}),we(5,"          "),ce(),ee(6,"div",27),nt(7,"span",28),Ft(8,"linky"),ce(),et()}if(2&n){const e=_e(3);W(1),oe("hidden",!e.isUrlText(e.value)),W(2),sn("id",e.gameDataElement.myIdentifer+"_elm"),W(1),oe("ngModel",e.value)("hidden",!e.isEditUrl(e.gameDataElement.myIdentifer+"_elm")&&e.isUrlText(e.gameDataElement.value)),W(2),oe("hidden",e.isEditUrl(e.gameDataElement.myIdentifer+"_elm")||!e.isUrlText(e.gameDataElement.value)),W(1),oe("innerHTML",Nt(8,6,e.escapeHtml(e.value),mr(9,jZ)),Bc)}}function qZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"span",29),we(2," \xa0\xa0\u5185\u5bb9\u7de8\u96c6:"),ee(3,"input",25),Re("change",function(){return ze(e),_e(3).changeChk()}),ce()(),ee(4,"textarea",30),Re("ngModelChange",function(r){return ze(e),_e(3).value=r})("focus",function(){ze(e);const r=_e(3);return r.textFocus(r.gameDataElement.myIdentifer+"_elm")}),we(5,"          "),ce(),ee(6,"div",27),nt(7,"div",31),ce(),et()}if(2&n){const e=_e(3);W(3),sn("id",e.gameDataElement.myIdentifer+"_elm"),W(1),oe("ngModel",e.value)("hidden",!e.isEditMarkDown(e.gameDataElement.myIdentifer+"_elm")),W(2),oe("hidden",e.isEditMarkDown(e.gameDataElement.myIdentifer+"_elm")),W(1),oe("innerHTML",e.escapeHtmlMarkDown(e.gameDataElement.value,e.gameDataElement.myIdentifer),Bc)}}function WZ(n,t){if(1&n){const e=ht();ee(0,"input",34),Re("click",function(){return ze(e),_e(4).gameDataElement.value=0}),ce()}}function ZZ(n,t){if(1&n){const e=ht();ee(0,"input",35),Re("click",function(){return ze(e),_e(4).gameDataElement.value=1}),ce()}}function YZ(n,t){if(1&n&&(Je(0),Se(1,WZ,1,0,"input",32),Se(2,ZZ,1,0,"input",33),et()),2&n){const e=_e(3);W(1),oe("ngIf",0!=e.gameDataElement.value),W(1),oe("ngIf",0==e.gameDataElement.value)}}function KZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",36),we(2),ce(),ee(3,"input",37),Re("ngModelChange",function(r){return ze(e),_e(4).value=r}),ce(),et()}if(2&n){const e=_e(4);W(2),Ct(e.value),W(1),oe("ngModel",e.value)}}function XZ(n,t){if(1&n&&(nt(0,"img",44),Ft(1,"safe")),2&n){const e=_e(5);oe("src",Nt(1,2,e.imageFileUrl,"resourceUrl"),fn)("alt",e.gameDataElement.value)}}function QZ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",38)(2,"div",39),Se(3,XZ,2,5,"img",40),ce(),ee(4,"div",41)(5,"span"),we(6),ce(),ee(7,"input",42),Re("ngModelChange",function(r){return ze(e),_e(4).currentValue=r}),ce(),ee(8,"button",43),Re("click",function(){return ze(e),_e(4).openModal("imageIdentifier",!0)}),we(9,"\u753b\u50cf\u5909\u66f4"),ce()()(),et()}if(2&n){const e=_e(4);W(3),oe("ngIf",e.imageFileUrl),W(3),ln("\u7acb\u3061\u7d75\u756a\u53f7",e.indexNum,": "),W(1),oe("ngModel",e.currentValue)}}function JZ(n,t){if(1&n&&(Je(0),Se(1,KZ,4,2,"ng-container",0),Se(2,QZ,10,3,"ng-container",0),et()),2&n){const e=_e(3);W(1),oe("ngIf",!e.isImage),W(1),oe("ngIf",e.isImage)}}function eY(n,t){if(1&n&&(Je(0),Se(1,BZ,4,3,"div",5),ee(2,"div",6),Se(3,zZ,2,1,"ng-container",0),Se(4,HZ,2,1,"ng-container",0),ce(),ee(5,"div",7),Je(6,8),Se(7,VZ,7,9,"ng-container",9),Se(8,GZ,9,10,"ng-container",9),Se(9,qZ,8,5,"ng-container",9),Se(10,YZ,3,2,"ng-container",9),Se(11,JZ,3,2,"ng-container",10),et(),ce(),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isEdit),W(2),oe("ngIf",e.isTagLocked),W(1),oe("ngIf",!e.isTagLocked),W(2),oe("ngSwitch",e.gameDataElement.type),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","note"),W(1),oe("ngSwitchCase","markdown"),W(1),oe("ngSwitchCase","check")}}function tY(n,t){1&n&&gn(0)}function nY(n,t){if(1&n&&(Je(0),Se(1,tY,1,0,"ng-container",11),et()),2&n){_e(4);const e=an(8);W(1),oe("ngTemplateOutlet",e)}}function iY(n,t){1&n&&gn(0)}function rY(n,t){if(1&n&&(Je(0),Se(1,iY,1,0,"ng-container",11),et()),2&n){_e(4);const e=an(2);W(1),oe("ngTemplateOutlet",e)}}function oY(n,t){if(1&n&&(ee(0,"div",50),Se(1,nY,2,1,"ng-container",0),Se(2,rY,2,1,"ng-container",0),ce()),2&n){const e=_e(3);W(1),oe("ngIf",e.isImage),W(1),oe("ngIf",!e.isImage)}}function sY(n,t){if(1&n&&(Je(0),ee(1,"div",51),we(2),ce(),et()),2&n){const e=_e(3);W(2),Ct(e.name)}}function aY(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",52),Re("ngModelChange",function(r){return ze(e),_e(3).name=r}),ce(),et()}if(2&n){const e=_e(3);W(1),oe("ngModel",e.name)}}function lY(n,t){if(1&n&&nt(0,"div",55),2&n){const e=t.$implicit,i=t.index,r=_e(4);oe("gameDataElement",e)("isEdit",r.isEdit)("isTagLocked",r.isTagLocked)("isImage",r.isImage)("indexNum",i)}}function cY(n,t){if(1&n&&(ee(0,"div",53),Se(1,lY,1,5,"div",54),ce()),2&n){const e=_e(3);W(1),oe("ngForOf",e.gameDataElement.children)}}function uY(n,t){if(1&n&&(Je(0),Se(1,oY,3,2,"div",45),nt(2,"div",46),ee(3,"div",47)(4,"div",48),Se(5,sY,3,1,"ng-container",0),Se(6,aY,2,1,"ng-container",0),ce(),Se(7,cY,2,1,"div",49),ce(),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isEdit),W(4),oe("ngIf",e.isTagLocked),W(1),oe("ngIf",!e.isTagLocked),W(1),oe("ngIf",0<e.gameDataElement.children.length)}}function dY(n,t){if(1&n&&(Je(0),Se(1,eY,12,8,"ng-container",0),Se(2,uY,8,4,"ng-container",0),et()),2&n){const e=_e();W(1),oe("ngIf",e.gameDataElement.children.length<1),W(1),oe("ngIf",0<e.gameDataElement.children.length)}}function fY(n,t){if(1&n){const e=ht();ee(0,"button",56),Re("click",function(){return ze(e),_e().addElement()}),ee(1,"i",57),we(2,"add_circle"),ce()(),ee(3,"button",56),Re("click",function(){return ze(e),_e().upElement()}),ee(4,"i",57),we(5,"arrow_upward"),ce()(),nt(6,"br"),ee(7,"button",56),Re("click",function(){return ze(e),_e().deleteElement()}),ee(8,"i",57),we(9,"remove_circle_outline"),ce()(),ee(10,"button",56),Re("click",function(){return ze(e),_e().downElement()}),ee(11,"i",57),we(12,"arrow_downward"),ce()()}}function hY(n,t){if(1&n){const e=ht();ee(0,"button",58)(1,"i",57),we(2,"remove_circle_outline"),ce()(),ee(3,"button",56),Re("click",function(){return ze(e),_e().upElement()}),ee(4,"i",57),we(5,"arrow_upward"),ce()(),nt(6,"br"),ee(7,"button",56),Re("click",function(){return ze(e),_e().deleteImageElement()}),ee(8,"i",57),we(9,"remove_circle_outline"),ce()(),ee(10,"button",56),Re("click",function(){return ze(e),_e().downElement()}),ee(11,"i",57),we(12,"arrow_downward"),ce()()}}function gY(n,t){if(1&n){const e=ht();ee(0,"button",58)(1,"i",57),we(2,"remove_circle_outline"),ce()(),ee(3,"button",56),Re("click",function(){return ze(e),_e().upElement()}),ee(4,"i",57),we(5,"arrow_upward"),ce()(),nt(6,"br"),ee(7,"button",58)(8,"i",57),we(9,"remove_circle_outline"),ce()(),ee(10,"button",56),Re("click",function(){return ze(e),_e().downElement()}),ee(11,"i",57),we(12,"arrow_downward"),ce()()}}function pY(n,t){if(1&n){const e=ht();ee(0,"button",56),Re("click",function(){return ze(e),_e().addImageElement()}),ee(1,"i",57),we(2,"add_circle"),ce()()}}let _Y=(()=>{class n{constructor(e,i,r,o){this.panelService=e,this.modalService=i,this.changeDetector=r,this.domSanitizer=o,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isImage=!1,this.indexNum=0,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}ngAfterViewInit(){}get imageFileUrl(){let e=xt.instance.get(this.gameDataElement.value);return e?e.url:""}openModal(e="",i=!1){this.modalService.open(Uf,{isAllowedEmpty:i}).then(r=>{if(!r)return;let o=this.gameDataElement;!o||(o.value=r)})}updateKomaIconMaxValue(e){let i=e.getFirstElementByName("image"),r=e.getElementsByName("ICON");r&&(r[0].value=i.children.length-1,r[0].currentValue>r[0].value&&(r[0].currentValue=r[0].value))}addImageElement(){this.gameDataElement.appendChild(yt.create("imageIdentifier","",{type:"image"})),this.updateKomaIconMaxValue(this.gameDataElement.parent)}addElement(){this.gameDataElement.appendChild(yt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}deleteImageElement(){const e=this.gameDataElement.parent.parent;this.gameDataElement.parent.children[0]!=this.gameDataElement&&(this.gameDataElement.destroy(),this.updateKomaIconMaxValue(e))}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(this.gameDataElement,i<e.children.length-2?e.children[i+2]:null)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}clickMarkDownBox(e){console.log("\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30af\u30ea\u30c3\u30af:"+e)}get markdown(){return Xe.instance.get("markdwon")}escapeHtmlMarkDown(e,i){let r=this.markdown.markDownCheckBox(e,i),o=this.markdown.markDownTable(r);return this.domSanitizer.bypassSecurityTrustHtml("<div>"+o+"</div>")}click(e){this.markdown&&(console.log("event.timeStamp:"+e.timeStamp),this.markdown.changeMarkDownCheckBox(e.target.id,e.timeStamp))}isEditMarkDown(e){let i=document.getElementById(e);return!!i&&i.checked}isEditUrl(e){let i=document.getElementById(e);return!!i&&i.checked}isUrlText(e){return!(!e.match(/^https:\/\//)&&!e.match(/^http:\/\//))}changeChk(){}textFocus(e){document.getElementById(e).checked=!0}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi),Be(bi),Be(Xv))},n.\u0275cmp=Xt({type:n,selectors:[["game-data-element"],["","game-data-element",""]],hostBindings:function(e,i){1&e&&Re("click",function(o){return i.click(o)})},inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isImage:"isImage",indexNum:"indexNum"},decls:9,vars:1,consts:[[4,"ngIf"],["editButtons",""],["editButtonsImageTop",""],["editButtonsImageMiddle",""],["editButtonsImageTitle",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","numberResource"],["value","note"],["value","markdown"],["value","check"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","max","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],[2,"font-size","0.8em",3,"hidden"],["type","checkbox",3,"id","change"],["placeholder","Note",1,"textarea-url","is-caret",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","hidden","ngModelChange","focus"],[2,"width","100%","max-width","200px","min-width","50px",3,"hidden"],[1,"textarea-url",2,"width","100%","min-width","50px","font-size","0.8em",3,"innerHTML"],[2,"font-size","0.8em"],["placeholder","Note",1,"textarea-markdown","is-caret",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","hidden","ngModelChange","focus"],[1,"textarea-markdown",2,"width","100%","min-width","50px","font-size","0.8em",3,"innerHTML"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[1,"table-2"],[1,"table-cell-2","sub-image-box"],["class","sub-image",3,"src","alt",4,"ngIf"],[1,"table-cell-2","sub-table"],["size","1","placeholder","\u7acb\u3061\u7d75\u540d",1,"is-caret",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[1,"tachie-button",2,"font-size","1.0em",3,"click"],[1,"sub-image",3,"src","alt"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked","isImage","indexNum",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked","isImage","indexNum"],[3,"click"],[1,"material-icons"],[1,"dummy",2,"visibility","hidden"]],template:function(e,i){1&e&&(Se(0,dY,3,2,"ng-container",0),Se(1,fY,13,0,"ng-template",null,1,zn),Se(3,hY,13,0,"ng-template",null,2,zn),Se(5,gY,13,0,"ng-template",null,3,zn),Se(7,pY,3,0,"ng-template",null,4,zn)),2&e&&oe("ngIf",i.gameDataElement)},directives:[Sn,Ra,tc,Ti,yi,nc,ic,Fi,ec,qu,oa,_s,gf,oi,n],pipes:[Ii,Rx],styles:[".tachie-button[_ngcontent-%COMP%]{background-color:#eee;color:#444;font-size:1em;margin:5px 0;padding:10px;box-sizing:border-box;width:6em}.tachie-button[_ngcontent-%COMP%]:hover{background-color:#ccc;color:#444}.sub-image[_ngcontent-%COMP%]{height:120px;display:inline-block;max-height:120px;vertical-align:top;text-align:center}.sub-image-box[_ngcontent-%COMP%]{width:120px;height:120px}.sub-table[_ngcontent-%COMP%]{width:calc(100% - 120px)}.table-cell-2[_ngcontent-%COMP%]{display:table-cell}.table-2[_ngcontent-%COMP%]{display:table;width:100%}.game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}.textarea-url[_ngcontent-%COMP%], .textarea-markdown[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;padding:2px;box-sizing:border-box;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();function mY(n,t){1&n&&gn(0)}function $Y(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",1),Re("click",function(){return ze(e),_e().openModal("front")}),we(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ce(),ee(3,"button",1),Re("click",function(){return ze(e),_e().openModal("back")}),we(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ce(),et()}}function vY(n,t){1&n&&gn(0)}function bY(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",1),Re("click",function(){return ze(e),_e().openModal("floor")}),we(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),ce(),ee(3,"button",1),Re("click",function(){return ze(e),_e().openModal("wall")}),we(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),ce(),et()}}function yY(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",7),Re("click",function(){ze(e);const r=_e();return r.openModal(r.tabletopObject.face)}),we(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),ce(),et()}if(2&n){const e=_e();W(1),oe("disabled",!e.tabletopObject.isVisible)}}function CY(n,t){1&n&&gn(0)}function xY(n,t){1&n&&gn(0)}function wY(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",1),Re("click",function(){return ze(e),_e().openModal("imageIdentifier",!0)}),we(2,"\u753b\u50cf\u5909\u66f4"),ce(),et()}}function EY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",8)(2,"div",9),we(3," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055\u3092\u6307\u5b9a "),ee(4,"input",10),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.specifyKomaImageFlag=r})("click",function(){return ze(e),_e().clickImageFlag()}),ce(),ee(5,"div"),we(6," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055 "),ee(7,"input",11),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.komaImageHeignt=r}),Ft(8,"safe"),ce(),ee(9,"input",12),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.komaImageHeignt=r})("change",function(r){return ze(e),_e().chkDiceKomaSize(r.target.value)}),ce()()()(),et()}if(2&n){const e=_e();W(4),oe("ngModel",e.tabletopObject.specifyKomaImageFlag),W(3),vi(Nt(8,7,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:1;","style")),oe("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag),W(2),oe("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag)}}function TY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",13)(2,"div"),we(3," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),ee(4,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r}),Ft(5,"safe"),ce(),ee(6,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r})("change",function(r){return ze(e),_e().chkPopWidth(r.target.value)}),ce()(),ee(7,"div"),we(8," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),ee(9,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r}),Ft(10,"safe"),ce(),ee(11,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r})("change",function(r){return ze(e),_e().chkPopMaxHeight(r.target.value)}),ce()()(),et()}if(2&n){const e=_e();W(4),vi(Nt(5,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewWidth),W(2),oe("ngModel",e.tabletopObject.overViewWidth),W(3),vi(Nt(10,11,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewMaxHeight),W(2),oe("ngModel",e.tabletopObject.overViewMaxHeight)}}function SY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",13)(2,"div"),we(3," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),ee(4,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r}),Ft(5,"safe"),ce(),ee(6,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r})("change",function(r){return ze(e),_e().chkPopWidth(r.target.value)}),ce()(),ee(7,"div"),we(8," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),ee(9,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r}),Ft(10,"safe"),ce(),ee(11,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r})("change",function(r){return ze(e),_e().chkPopMaxHeight(r.target.value)}),ce()()(),et()}if(2&n){const e=_e();W(4),vi(Nt(5,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewWidth),W(2),oe("ngModel",e.tabletopObject.overViewWidth),W(3),vi(Nt(10,11,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewMaxHeight),W(2),oe("ngModel",e.tabletopObject.overViewMaxHeight)}}function DY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",8),nt(2,"div",16),ee(3,"div",17),we(4," \u5e8a\u306b\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a "),ee(5,"input",18),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.isGrid=r})("click",function(){return ze(e),_e().clickGrid()}),ce(),nt(6,"br"),ce()(),et()}if(2&n){const e=_e();W(5),oe("ngModel",e.tabletopObject.isGrid)}}function IY(n,t){if(1&n){const e=ht();ee(0,"select",25),Re("change",function(r){return ze(e),_e(2).setLocation(r.target.value)}),ee(1,"option",26),we(2,"\u30c6\u30fc\u30d6\u30eb"),ce(),ee(3,"option",27),we(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ce(),ee(5,"option",28),we(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ce(),ee(7,"option",29),we(8,"\u5893\u5730"),ce()()}if(2&n){const e=_e(2);oe("ngModel",e.tabletopObject.location.name),W(5),sn("value",e.networkService.peerId)}}function kY(n,t){if(1&n){const e=ht();Je(0),Se(1,IY,9,2,"select",19),ee(2,"div",8)(3,"div",9)(4,"div"),we(5," \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u975e\u8868\u793a "),ee(6,"input",20),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.hideInventory=r})("click",function(){return ze(e),_e().clickHide()}),ce()(),ee(7,"div"),we(8," \u767a\u8a00\u3092\u3057\u306a\u3044 "),ee(9,"input",21),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.nonTalkFlag=r})("click",function(){return ze(e),_e().clickNoTalk()}),ce()(),ee(10,"div"),we(11," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),ee(12,"input",22),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r}),Ft(13,"safe"),ce(),ee(14,"input",23),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r})("change",function(r){return ze(e),_e().chkPopWidth(r.target.value)}),ce()(),ee(15,"div"),we(16," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),ee(17,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r}),Ft(18,"safe"),ce(),ee(19,"input",24),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r})("change",function(r){return ze(e),_e().chkPopMaxHeight(r.target.value)}),ce()()(),ee(20,"div",9),we(21," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055\u3092\u6307\u5b9a "),ee(22,"input",10),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.specifyKomaImageFlag=r})("click",function(){return ze(e),_e().clickImageFlag()}),ce(),ee(23,"div"),we(24," \u30b3\u30de\u753b\u50cf\u306e\u9ad8\u3055 "),ee(25,"input",11),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.komaImageHeignt=r}),Ft(26,"safe"),ce(),ee(27,"input",12),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.komaImageHeignt=r})("change",function(r){return ze(e),_e().chkKomaSize(r.target.value)}),ce()()()(),et()}if(2&n){const e=_e();W(1),oe("ngIf",e.tabletopObject),W(5),oe("ngModel",e.tabletopObject.hideInventory),W(3),oe("ngModel",e.tabletopObject.nonTalkFlag),W(3),vi(Nt(13,18,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewWidth),W(2),oe("ngModel",e.tabletopObject.overViewWidth),W(3),vi(Nt(18,21,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewMaxHeight),W(2),oe("ngModel",e.tabletopObject.overViewMaxHeight),W(3),oe("ngModel",e.tabletopObject.specifyKomaImageFlag),W(3),vi(Nt(26,24,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:1;","style")),oe("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag),W(2),oe("ngModel",e.tabletopObject.komaImageHeignt)("disabled",!e.tabletopObject.specifyKomaImageFlag)}}function MY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",13)(2,"div"),we(3," height\u8a2d\u5b9a\u5024\u306b\u9ad8\u3055\u3092\u5236\u9650 "),ee(4,"input",30),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.limitHeight=r})("click",function(){return ze(e),_e().clickLimitHeight()}),ce()(),ee(5,"div"),we(6," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u6a2a\u5e45 "),ee(7,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r}),Ft(8,"safe"),ce(),ee(9,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewWidth=r})("change",function(r){return ze(e),_e().chkPopWidth(r.target.value)}),ce()(),ee(10,"div"),we(11," \u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u7e26\u5e45\u6700\u5927 "),ee(12,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r}),Ft(13,"safe"),ce(),ee(14,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.overViewMaxHeight=r})("change",function(r){return ze(e),_e().chkPopMaxHeight(r.target.value)}),ce()()(),et()}if(2&n){const e=_e();W(4),oe("ngModel",e.tabletopObject.limitHeight),W(3),vi(Nt(8,9,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewWidth),W(2),oe("ngModel",e.tabletopObject.overViewWidth),W(3),vi(Nt(13,12,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tabletopObject.overViewMaxHeight),W(2),oe("ngModel",e.tabletopObject.overViewMaxHeight)}}function AY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div"),we(2," \u30ab\u30e9\u30fc "),ee(3,"input",31),Re("change",function(r){return ze(e),_e().changeMaskFillColor(r.target.value)}),ce(),we(4," \u66f4\u65b0\u90e8\u30ab\u30e9\u30fc "),ee(5,"input",32),Re("change",function(r){return ze(e),_e().changeMaskChangeColor(r.target.value)}),ce()(),nt(6,"br"),we(7," \u203bwidth\u3001height\u9805\u76ee\u306f\u6700\u592750 "),et()}if(2&n){const e=_e();W(3),sn("value",e.tabletopObject.color),W(2),sn("value",e.tabletopObject.changeColor)}}function PY(n,t){if(1&n){const e=ht();ee(0,"div"),we(1," \u56de\u8ee2\u89d2\u5ea6\u306e\u30b9\u30ca\u30c3\u30d7\u3092\u7d30\u304b\u304f\u3059\u308b:"),ee(2,"input",38),Re("ngModelChange",function(r){return ze(e),_e(2).tabletopObject.subDivisionSnapPolygonal=r})("click",function(){return ze(e),_e(2).subDivisionSnapPolygonal()}),ce()()}if(2&n){const e=_e(2);W(2),oe("ngModel",e.tabletopObject.subDivisionSnapPolygonal)}}function FY(n,t){1&n&&(ee(0,"div"),nt(1,"br"),we(2," \u203b\u3053\u306e\u5f62\u72b6\u306fwidth\u9805\u76ee\u306f\u4e0d\u4f7f\u7528 "),ce())}function RY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div"),we(2," \u5883\u754c\u7dda "),ee(3,"input",33),Re("change",function(r){return ze(e),_e().changeRangeColor(r.target.value)}),ce(),we(4," \u5857\u308a\u3064\u3076\u3057 "),ee(5,"input",34),Re("change",function(r){return ze(e),_e().changeGridColor(r.target.value)}),ce()(),Se(6,PY,3,1,"div",5),ee(7,"div"),we(8," \u8f2a\u90ed\u306b\u6cbf\u3063\u3066\u5857\u308b:"),ee(9,"input",35),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.fillOutLine=r})("click",function(){return ze(e),_e().fillOutLine()}),ce(),nt(10,"br"),we(11," \u30b9\u30af\u30a8\u30a2\u306e\u5857\u308a\u3092\u534a\u30de\u30b9\u305a\u3089\u305a \u6a2a:"),ee(12,"input",36),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.offSetX=r})("click",function(){return ze(e),_e().clickRangeOffSetX()}),ce(),we(13," \xa0\u7e26:"),ee(14,"input",37),Re("ngModelChange",function(r){return ze(e),_e().tabletopObject.offSetY=r})("click",function(){return ze(e),_e().clickRangeOffSetY()}),ce(),nt(15,"br"),Se(16,FY,3,0,"div",5),ce(),et()}if(2&n){const e=_e();W(3),sn("value",e.tabletopObject.rangeColor),W(2),sn("value",e.tabletopObject.gridColor),W(1),oe("ngIf","CIRCLE"!=e.tabletopObject.type),W(3),oe("ngModel",e.tabletopObject.fillOutLine),W(3),oe("ngModel",e.tabletopObject.offSetX),W(2),oe("ngModel",e.tabletopObject.offSetY),W(2),oe("ngIf","CIRCLE"==e.tabletopObject.type||"SQUARE"==e.tabletopObject.type||"DIAMOND"==e.tabletopObject.type)}}function NY(n,t){if(1&n&&(ee(0,"div",41),nt(1,"img",42),Ft(2,"safe"),ce()),2&n){const e=_e(2);W(1),oe("src",Nt(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),fn)("alt",e.tabletopObject.imageFile.name)}}function OY(n,t){if(1&n&&(Je(0),ee(1,"div",43)(2,"div",44),nt(3,"div",45),ce()(),et()),2&n){const e=_e(2);W(3),oe("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function BY(n,t){if(1&n&&(ee(0,"div",43)(1,"div",44),nt(2,"div",47),ce()()),2&n){const e=t.$implicit,i=_e(3);W(2),oe("gameDataElement",e)("isEdit",i.isEdit)}}function LY(n,t){if(1&n&&(Je(0),Se(1,BY,3,2,"div",46),et()),2&n){const e=_e(2);W(1),oe("ngForOf",e.tabletopObject.detailDataElement.children)}}function zY(n,t){1&n&&gn(0)}function UY(n,t){1&n&&gn(0)}function HY(n,t){1&n&&gn(0)}function VY(n,t){1&n&&gn(0)}function jY(n,t){1&n&&gn(0)}function GY(n,t){1&n&&gn(0)}function qY(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",49),Re("click",function(){return ze(e),_e(4).showImportImages()}),we(2,"\u753b\u50cf\u3092\u4ed6\u306e\u30b3\u30de\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8"),ce(),et()}}function WY(n,t){if(1&n&&(Je(0),ee(1,"div",43)(2,"div",44),nt(3,"div",48),ce(),Se(4,qY,3,0,"ng-container",5),ce(),et()),2&n){const e=_e(3);W(3),oe("gameDataElement",e.tabletopObject.imageDataElement)("isTagLocked",!0)("isEdit",e.isEdit)("isImage",!0),W(1),oe("ngIf","character"===e.tabletopObject.aliasName)}}function ZY(n,t){if(1&n&&(Je(0),Se(1,WY,5,5,"ng-container",5),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.tabletopObject.imageDataElement)}}function YY(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",43)(2,"button",50),Re("click",function(){return ze(e),_e(2).addDataElement()}),we(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),ce()(),et()}}function KY(n,t){if(1&n&&(ee(0,"div",39),Se(1,NY,3,5,"div",40),Se(2,OY,4,2,"ng-container",5),Se(3,LY,2,1,"ng-container",5),Je(4,2),Se(5,zY,1,0,"ng-container",3),Se(6,UY,1,0,"ng-container",3),Se(7,HY,1,0,"ng-container",3),Se(8,VY,1,0,"ng-container",3),Se(9,jY,1,0,"ng-container",3),Se(10,GY,1,0,"ng-container",3),Se(11,ZY,2,1,"ng-container",4),et(),Se(12,YY,4,0,"ng-container",5),ce()),2&n){const e=_e();W(1),oe("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),W(1),oe("ngIf",e.tabletopObject.commonDataElement),W(1),oe("ngIf",e.tabletopObject.detailDataElement),W(1),oe("ngSwitch",e.tabletopObject.aliasName),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","card"),W(1),oe("ngSwitchCase","card-stack"),W(1),oe("ngSwitchCase","terrain"),W(1),oe("ngSwitchCase","dice-symbol"),W(1),oe("ngSwitchCase","table-scratch-mask"),W(2),oe("ngIf",e.isEdit)}}let xl=(()=>{class n{constructor(e,i,r,o){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.tabletopObject=null,this.isEdit=!1,this.networkService=$t,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Qe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=yt.create("\u898b\u51fa\u3057","",{}),i=yt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":mt.play(ut.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,mt.play(ut.cardPut);break;case"text-note":e.toTopmost(),mt.play(ut.cardPut);break;case"dice-symbol":mt.play(ut.dicePut);default:mt.play(ut.piecePut)}}clickHide(){}clickNoTalk(){}clickImageFlag(){}clickGrid(){}showImportImages(){let e=this.pointerDeviceService.pointers[0],i={left:e.x-250,top:e.y-175,width:350,height:250};i.title=this.tabletopObject.name+"\u3078\u306e\u753b\u50cf\u8907\u88fd",this.panelService.open(MZ,i).tabletopObject=this.tabletopObject}clickRangeOffSetX(){}clickRangeOffSetY(){}fillOutLine(){}subDivisionSnapPolygonal(){}clickLimitHeight(){setTimeout(()=>{Qe.trigger("RESIZE_NOTE_OBJECT",{identifier:this.tabletopObject.identifier})},100)}chkKomaSize(e){e<50&&(e=50),e>750&&(e=750),this.tabletopObject.komaImageHeignt=e}chkDiceKomaSize(e){e<50&&(e=50),e>750&&(e=750),this.tabletopObject.komaImageHeignt=e}chkPopWidth(e){e<270&&(e=270),e>800&&(e=800),this.tabletopObject.overViewWidth=e}chkPopMaxHeight(e){e<250&&(e=250),e>1e3&&(e=1e3),this.tabletopObject.overViewMaxHeight=e}saveToXML(){var e=this;return(0,xn.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(Uf,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);!o||(o.value=r)})}changeMaskFillColor(e){this.tabletopObject&&(this.tabletopObject.color=e)}changeMaskChangeColor(e){this.tabletopObject&&(this.tabletopObject.changeColor=e)}changeGridColor(e){this.tabletopObject&&(this.tabletopObject.gridColor=e)}changeRangeColor(e){this.tabletopObject&&(this.tabletopObject.rangeColor=e)}}return n.\u0275fac=function(e){return new(e||n)(Be(ko),Be($n),Be(hi),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:25,vars:17,consts:[[1,"top-header"],[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[3,"disabled","click"],[1,"extra-setting",2,"display","table"],[1,"extra-setting",2,"width","50%","display","table-cell"],["type","checkbox","value","hideInventory","name","specifyKomaImageFlag",3,"ngModel","ngModelChange","click"],["type","range","min","50","max","750",3,"ngModel","disabled","ngModelChange"],["type","number","min","50","max","750","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","disabled","ngModelChange","change"],[1,"extra-setting",2,"width","400px"],["type","range","min","250","max","1000",3,"ngModel","ngModelChange"],["type","number","min","250","max","1000","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],[1,"extra-setting",2,"width","30%","display","table-cell","align","right"],[1,"extra-setting",2,"width","70%","display","table-cell","align","right"],["type","checkbox","value","isGrid","name","isGrid",3,"ngModel","ngModelChange","click"],[3,"ngModel","change",4,"ngIf"],["type","checkbox","value","hideInventory","name","hideInventory",3,"ngModel","ngModelChange","click"],["type","checkbox","value","hideInventory","name","nonTalkFlag",3,"ngModel","ngModelChange","click"],["type","range","min","270","max","1000",3,"ngModel","ngModelChange"],["type","number","min","270","max","1000","name","popWidth",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],["type","number","min","250","max","1000","name","popHeight",1,"is-caret",2,"color","#555",3,"ngModel","ngModelChange","change"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],["type","checkbox","value","limitHeight","name","limitHeight",3,"ngModel","ngModelChange","click"],["type","color","name","color11","list","color-list_11",3,"value","change"],["type","color","name","color12","list","color-list_12",3,"value","change"],["type","color","name","color01","list","color-list_01",3,"value","change"],["type","color","name","color02","list","color-list_02",3,"value","change"],["type","checkbox","value","fillOutLine","name","fillOutLine",3,"ngModel","ngModelChange","click"],["type","checkbox","value","offSetX","name","offSetX",3,"ngModel","ngModelChange","click"],["type","checkbox","value","offSetY","name","offSetY",3,"ngModel","ngModelChange","click"],["type","checkbox","value","noSnapPolygonal","name","subDivisionSnapPolygonal",3,"ngModel","ngModelChange","click"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked","isEdit","isImage"],[2,"width","300px","color","#555",3,"click"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"button",1),Re("click",function(){return i.toggleEditMode()}),we(2,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),ce(),Je(3,2),Se(4,mY,1,0,"ng-container",3),Se(5,$Y,5,0,"ng-container",3),Se(6,vY,1,0,"ng-container",3),Se(7,bY,5,0,"ng-container",3),Se(8,yY,3,1,"ng-container",3),Se(9,CY,1,0,"ng-container",3),Se(10,xY,1,0,"ng-container",3),Se(11,wY,3,0,"ng-container",4),et(),ee(12,"button",1),Re("click",function(){return i.clone()}),we(13,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),ce(),ee(14,"button",1),Re("click",function(){return i.saveToXML()}),we(15,"\u4fdd\u5b58"),ce(),Se(16,EY,10,10,"ng-container",5),Se(17,TY,12,14,"ng-container",5),Se(18,SY,12,14,"ng-container",5),Se(19,DY,7,1,"ng-container",5),Se(20,kY,28,27,"ng-container",5),Se(21,MY,15,15,"ng-container",5),Se(22,AY,8,2,"ng-container",5),Se(23,RY,17,7,"ng-container",5),ce(),Se(24,KY,13,11,"div",6)),2&e&&(W(3),oe("ngSwitch",i.tabletopObject.aliasName),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","card"),W(1),oe("ngSwitchCase","card-stack"),W(1),oe("ngSwitchCase","terrain"),W(1),oe("ngSwitchCase","dice-symbol"),W(1),oe("ngSwitchCase","range"),W(1),oe("ngSwitchCase","table-scratch-mask"),W(6),oe("ngIf","dice-symbol"===i.tabletopObject.aliasName),W(1),oe("ngIf","card-stack"===i.tabletopObject.aliasName),W(1),oe("ngIf","card"===i.tabletopObject.aliasName),W(1),oe("ngIf","terrain"===i.tabletopObject.aliasName),W(1),oe("ngIf","character"===i.tabletopObject.aliasName),W(1),oe("ngIf","text-note"===i.tabletopObject.aliasName),W(1),oe("ngIf","table-scratch-mask"===i.tabletopObject.aliasName),W(1),oe("ngIf","range"===i.tabletopObject.aliasName),W(1),oe("ngIf",i.tabletopObject))},directives:[ec,qu,gf,Sn,ra,Ti,yi,oa,Fi,Ju,Qu,_s,tc,nc,ic,_Y,oi],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.top-header[_ngcontent-%COMP%]{display:table;width:100%}.extra-setting[_ngcontent-%COMP%]{text-align:right}.table-cell[_ngcontent-%COMP%]{display:table-cell}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();const XY=["root"],QY=["chatInput"],JY=["chatPalette"];function eK(n,t){1&n&&nt(0,"badge",20),2&n&&oe("count",_e().$implicit.unreadLength)}function tK(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",18),Re("ngModelChange",function(r){return ze(e),_e().chatTabidentifier=r}),ce(),ee(2,"div"),we(3),Se(4,eK,1,1,"badge",19),ce()()}if(2&n){const e=t.$implicit,i=_e();W(1),sn("value",e.identifier),oe("ngModel",i.chatTabidentifier),W(2),Ct(e.name),W(1),oe("ngIf",e.hasUnread)}}function nK(n,t){1&n&&(ee(0,"div",21)(1,"i",22),we(2,"info_outline"),ce(),we(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),ce())}function iK(n,t){if(1&n&&(ee(0,"option",25),we(1),ce()),2&n){const e=t.$implicit;sn("value",e),W(1),Ct(e)}}function rK(n,t){if(1&n){const e=ht();Je(0),ee(1,"select",23),Re("input",function(r){ze(e);const o=_e();return o.selectAutoComplete(o.text,r.target.value)})("click",function(r){ze(e);const o=_e();return o.selectAutoComplete(o.text,r.target.value)}),Se(2,iK,2,2,"option",24),ce(),et()}if(2&n){const e=_e();W(1),ta("id","",e._timeId,"_complete"),W(1),oe("ngForOf",e.autoCompleteList())}}function oK(n,t){if(1&n&&(ee(0,"option",25),we(1),ce()),2&n){const e=t.$implicit;sn("value",e),W(1),Ct(e)}}function sK(n,t){if(1&n&&(Je(0),Se(1,oK,2,2,"option",24),et()),2&n){const e=_e();W(1),oe("ngForOf",e.palette.getPalette())}}function aK(n,t){1&n&&(ee(0,"span"),we(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),ce())}function lK(n,t){1&n&&(ee(0,"span"),we(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),ce())}let BP=(()=>{class n{constructor(e,i,r,o){this.contextMenuService=e,this.pointerDeviceService=i,this.chatMessageService=r,this.panelService=o,this.character=null,this._gameType="",this._paletteIndex=[],this._timeId="",this._autoCompleteEnable=!1,this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.isIndexOpen=!1,this.editPalette="",this.doubleClickTimer=null}get palette(){return this.character.chatPalette}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return or.diceBotInfos}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",this._timeId=Date.now()+"_chat-palette",Qe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")}).on("JUMP_INDEX",-1e3,e=>{this._timeId==e.data.targetId&&this.japmIndex(e.data.lineNo)})}ngOnDestroy(){Qe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Xe.instance.get(e);if(i instanceof Bt){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}resizeChatInput(){this.chatInputComponent.kickCalcFitHeight()}chatTabSwitchRelative(e){let o,i=this.chatMessageService.chatTabs,r=i.findIndex(s=>s.identifier==this.chatTabidentifier);r<0||(o=r==i.length-1&&1==e?0:0==r&&-1==e?i.length-1:r+e,this.chatTabidentifier=i[o].identifier)}autoCompleteSwitchRelative(e){console.log("selectAutoComplete :"+e);const i=document.getElementById(this._timeId+"_complete");if(!i)return;const r=i.length;let o=i.selectedIndex;o+=e,!(o<=-1)&&(o>=r&&(o=r-1),i.selectedIndex=o)}autoCompleteDoRelative(e){const i=document.getElementById(this._timeId+"_complete");e==i.selectedIndex&&this.selectAutoComplete(this.text,i.value)}selectPalette(e){let i=e.replace(/\\n/g,"\n");this.text=i;const r=document.getElementById(this._timeId+"_complete");r&&(r.selectedIndex=-1)}selectAutoComplete(e,i){const r=document.getElementById(this._timeId+"_complete");let o=this.palette.paletteMatchLine(e,r.selectedIndex);console.log(e+" "+i+" index:"+r.selectedIndex+" lineNo"+o),this.japmIndex(o),this.selectPalette(i)}completeIndex(){let e=document.getElementById(this._timeId+"_complete");return e?e.selectedIndex:-1}autoCompleteList(){let e=new Array;return this.text.length>1&&(e=this.palette.paletteMatch(this.text)),e}clickPalette(e){let i=e.replace(/\\n/g,"\n");this.doubleClickTimer&&this.text===i?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=i,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}targeted(e){return"table"==e.location.name&&e.targeted}targetedGameCharacterList(){let e=[];return e=Xe.instance.getObjects(Bt).filter(i=>this.targeted(i)),e}sendChat(e){if(this.chatTab){let i="",r=[],o=[];if(this.palette.checkTargetCharactor(e.text)){r=this.targetedGameCharacterList();let s=!0;0==r.length&&(i+="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059");for(let a of r){i+=s?"":"\n";let g=e.text,w="";w=s?g:or.deleteMyselfResourceBuff(g),i+=this.palette.evaluate(w,this.character.rootDataElement,a),i+=" ["+a.name+"]",s=!1;let G={text:"",object:null};G.text=this.palette.evaluate(w,this.character.rootDataElement,a),G.object=a,o.push(G)}}else{r=[],i=this.palette.evaluate(e.text,this.character.rootDataElement);let s={text:"",object:null};s.text=i,s.object=null,o.push(s)}this.chatMessageService.sendMessage(this.chatTab,i,e.gameSystem,e.sendFrom,e.sendTo,e.tachieNum,e.messColor,o)}}resetPaletteSelect(){!this.chatPaletteElementRef.nativeElement||(this.chatPaletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){if(this.isEdit=!this.isEdit,this.isEdit){const e=document.getElementById(this._timeId+"_select"),i=document.getElementById(this._timeId+"_text");console.log("selectObj.clientHeight:"+e.clientHeight),console.log("selectObj.scrollHeight:"+e.scrollHeight),console.log("selectObj.scrollTop:"+e.scrollTop),this.editPalette=this.palette.value+"";const r=e.scrollTop,o=e.scrollHeight;setTimeout(()=>{console.log("textObj.clientHeight:"+i.clientHeight),console.log("textObj.scrollHeight:"+i.scrollHeight),console.log("textObj.scrollTop:"+i.scrollTop),i.scrollTop=r*i.scrollHeight/o},10)}else this.palette.setPalette(this.editPalette)}moveTest(){const e=document.getElementById(this._timeId+"_text");e.focus(),setTimeout(()=>{e.setSelectionRange(600,600)},10)}japmIndex(e){console.log("JUMP_INDEX:"+e);let i=document.getElementById(this._timeId+"_select");i&&(i.scrollTop=i.scrollHeight,i.options[e].selected=!1,i.options[e].selected=!0)}indexBtn(){let i=this.rootElementRef.nativeElement.getBoundingClientRect(),r=this.pointerDeviceService.pointers[0];console.log(this.panelService.left+" "+this.panelService.top),r.x=i.left-8,r.y=i.top-8,this._paletteIndex=this.palette.paletteIndex;let o=new Array;for(let a of this._paletteIndex)o.push({name:a.name,line:a.line,id:this._timeId,action:()=>{}});this.contextMenuService.open(r,o,"\u30a4\u30f3\u30c7\u30c3\u30af\u30b9")}}return n.\u0275fac=function(e){return new(e||n)(Be(To),Be(Di),Be(Eo),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(Gn(XY,7),Gn(QY,7),Gn(JY,5)),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first),yn(r=Cn())&&(i.chatInputComponent=r.first),yn(r=Cn())&&(i.chatPaletteElementRef=r.first)}},inputs:{character:"character"},decls:26,vars:18,consts:[[1,"flex-container"],["root",""],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[1,"is-caret",3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","autoCompleteIndex","autoCompleteListLen","text","gameTypeChange","sendFromChange","textChange","chat","autoCompleteSwitch","autoCompleteDo","tabSwitch"],["chatInput",""],[2,"position","absolute","margin-top","-2em"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],["class","edit-info",4,"ngIf"],[1,"complete-box"],[4,"ngIf"],[2,"flex-grow","1","height","0","min-height","100px",3,"hidden"],["size","5",1,"palette",2,"overflow-y","auto",3,"id","input","click","focusout"],["chatPalette",""],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette","is-caret",2,"resize","none",3,"id","ngModel","ngModelChange"],["type","submit",3,"click"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],["size","5",1,"complete",2,"overflow-y","auto",3,"id","input","click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,i){1&e&&(ee(0,"div",0,1)(2,"div",2)(3,"form")(4,"div",3),Se(5,tK,5,4,"label",4),ce()(),ee(6,"chat-input",5,6),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)})("autoCompleteSwitch",function(o){return i.autoCompleteSwitchRelative(o)})("autoCompleteDo",function(o){return i.autoCompleteDoRelative(o)})("tabSwitch",function(o){return i.chatTabSwitchRelative(o)}),ce(),ee(8,"div",7)(9,"button",8),Re("click",function(){return i.indexBtn()}),we(10,"\uff1c"),ee(11,"i",9),we(12,"bookmarks"),ce()()(),Se(13,nK,4,0,"div",10),ee(14,"div",11),Se(15,rK,3,2,"ng-container",12),ce()(),ee(16,"div",13)(17,"select",14,15),Re("input",function(o){return i.selectPalette(o.target.value)})("click",function(o){return i.clickPalette(o.target.value)})("focusout",function(){return i.resizeChatInput()}),Se(19,sK,2,1,"ng-container",12),ce()(),ee(20,"div",13)(21,"textarea",16),Re("ngModelChange",function(o){return i.editPalette=o}),ce()(),ee(22,"div",2)(23,"button",17),Re("click",function(){return i.toggleEditMode()}),Se(24,aK,2,0,"span",12),Se(25,lK,2,0,"span",12),ce()()()),2&e&&(W(5),oe("ngForOf",i.chatMessageService.chatTabs),W(1),oe("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("autoCompleteIndex",i.completeIndex())("autoCompleteListLen",i.autoCompleteList().length)("text",i.text),W(7),oe("ngIf",i.isEdit),W(2),oe("ngIf",1==i.autoCompleteList().length&&i.autoCompleteList()[0]!=i.text||i.autoCompleteList().length>1),W(1),oe("hidden",i.isEdit),W(1),ta("id","",i._timeId,"_select"),W(2),oe("ngIf",i.palette),W(1),oe("hidden",!i.isEdit),W(1),ta("id","",i._timeId,"_text"),oe("ngModel",i.editPalette),W(3),oe("ngIf",!i.isEdit),W(1),oe("ngIf",i.isEdit))},directives:[ps,gs,yo,oi,Xu,Fi,Ti,yi,Sn,PP,RP,nc,ic],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.complete-box[_ngcontent-%COMP%]{position:relative;width:100%;height:0px}.complete[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:calc(100% - 155px);resize:none;position:absolute;top:-20px;left:60px;min-width:220px;z-index:10;opacity:.8}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function cK(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",14),we(2),ce(),ee(3,"input",15),Re("ngModelChange",function(r){return ze(e),_e(5).name=r}),ce(),et()}if(2&n){const e=_e(5);W(2),Ct(e.name),W(1),oe("ngModel",e.name)}}function uK(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",5)(2,"button",6),Re("click",function(){ze(e);const r=_e(4);return r.deletBuff(r.gameDataElement)}),we(3,"\u524a\u9664"),ce()(),ee(4,"div",7)(5,"div",8),Se(6,cK,4,2,"ng-container",0),ce(),ee(7,"div",9),we(8,"/"),ce(),ee(9,"div",10)(10,"input",11),Re("ngModelChange",function(r){return ze(e),_e(4).currentValue=r}),ce()(),ee(11,"div",9),we(12,"/"),ce(),ee(13,"div",12)(14,"input",13),Re("ngModelChange",function(r){return ze(e),_e(4).value=r}),ce()(),ee(15,"div",12),we(16,"R"),ce()(),et()}if(2&n){const e=_e(4);W(6),oe("ngIf",!e.isTagLocked),W(4),oe("ngModel",e.currentValue),W(4),oe("ngModel",e.value)}}function dK(n,t){if(1&n&&(Je(0),ee(1,"div",18),we(2),ce(),et()),2&n){const e=_e(5);W(2),Ct(e.gameDataElement.name)}}function fK(n,t){if(1&n&&(Je(0),ee(1,"div",16)(2,"div",17),Se(3,dK,3,1,"ng-container",0),ce()(),et()),2&n){const e=_e(4);W(3),oe("ngIf",!e.isTagLocked)}}function hK(n,t){if(1&n&&(Je(0)(1,2),Se(2,uK,17,3,"ng-container",3),Se(3,fK,4,1,"ng-container",4),et()()),2&n){const e=_e(3);W(1),oe("ngSwitch",e.gameDataElement.type),W(1),oe("ngSwitchCase","numberResource")}}function gK(n,t){if(1&n&&(Je(0),ee(1,"div",18),we(2),ce(),et()),2&n){const e=_e(4);W(2),Ct(e.gameDataElement.name)}}function pK(n,t){if(1&n&&nt(0,"div",22),2&n){const e=t.$implicit,i=_e(5);oe("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function _K(n,t){if(1&n&&(ee(0,"div",20),Se(1,pK,1,3,"div",21),ce()),2&n){const e=_e(4);W(1),oe("ngForOf",e.gameDataElement.children)}}function mK(n,t){if(1&n&&(Je(0),ee(1,"div",16)(2,"div",17),Se(3,gK,3,1,"ng-container",0),ce(),Se(4,_K,2,1,"div",19),ce(),et()),2&n){const e=_e(3);W(3),oe("ngIf",!e.isTagLocked),W(1),oe("ngIf",0<e.gameDataElement.children.length)}}function $K(n,t){if(1&n&&(Je(0),Se(1,hK,4,2,"ng-container",0),Se(2,mK,5,2,"ng-container",0),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.gameDataElement.children.length<1),W(1),oe("ngIf",0<e.gameDataElement.children.length)}}function vK(n,t){if(1&n&&(Je(0),Se(1,$K,3,2,"ng-container",0),et()),2&n){const e=_e();W(1),oe("ngIf",e.gameDataElement)}}function bK(n,t){if(1&n&&(Je(0),ee(1,"span",23),we(2),ce(),et()),2&n){const e=_e(3);W(2),bv(" ",e.gameDataElement.name," / ",e.gameDataElement.currentValue," / ",e.gameDataElement.value,"R ")}}function yK(n,t){if(1&n&&(Je(0)(1,2),Se(2,bK,3,3,"ng-container",3),et()()),2&n){const e=_e(2);W(1),oe("ngSwitch",e.gameDataElement.type),W(1),oe("ngSwitchCase","numberResource")}}function CK(n,t){if(1&n&&nt(0,"div",25),2&n){const e=t.$implicit,i=_e(3);oe("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isPieceMode",i.isPieceMode)}}function xK(n,t){if(1&n&&(Je(0),Se(1,CK,1,4,"div",24),et()),2&n){const e=_e(2);W(1),oe("ngForOf",e.gameDataElement.children)}}function wK(n,t){if(1&n&&(Je(0),Se(1,yK,3,2,"ng-container",0),Se(2,xK,2,1,"ng-container",0),et()),2&n){const e=_e();W(1),oe("ngIf",e.gameDataElement.children.length<1),W(1),oe("ngIf",0<e.gameDataElement.children.length)}}function EK(n,t){if(1&n){const e=ht();ee(0,"button",26),Re("click",function(){return ze(e),_e().addElement()}),ee(1,"i",27),we(2,"add_circle"),ce()(),ee(3,"button",26),Re("click",function(){return ze(e),_e().upElement()}),ee(4,"i",27),we(5,"arrow_upward"),ce()(),nt(6,"br"),ee(7,"button",26),Re("click",function(){return ze(e),_e().deleteElement()}),ee(8,"i",27),we(9,"remove_circle_outline"),ce()(),ee(10,"button",26),Re("click",function(){return ze(e),_e().downElement()}),ee(11,"i",27),we(12,"arrow_downward"),ce()()}}let LP=(()=>{class n{constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isPieceMode=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Qe.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(yt.create("TEST",8,{type:"numberResource",currentValue:"001"},"TEST"))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}deletBuff(e){e.destroy()}}return n.\u0275fac=function(e){return new(e||n)(Be(bi))},n.\u0275cmp=Xt({type:n,selectors:[["game-data-element-buff"],["","game-data-element-buff",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isPieceMode:"isPieceMode"},decls:4,vars:2,consts:[[4,"ngIf"],["editButtons",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"table-cell",2,"border-bottom","none"],[2,"width","5em",3,"click"],[1,"table","table-cell",2,"border-bottom","none"],[1,"table-cell",2,"width","60%"],[1,"table-cell",2,"width","0px"],[1,"table-cell",2,"width","30%"],["size","1","type","string","placeholder","Value",1,"is-caret",2,"width","100%",3,"ngModel","ngModelChange"],[1,"table-cell"],["size","1","type","number","placeholder","Value",1,"is-caret",2,"width","3em",3,"ngModel","ngModelChange"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",1,"is-caret",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[1,"table",2,"width","100%"],[1,"table-cell_inner-table-title"],[1,"inputLock"],["class","table",4,"ngIf"],[1,"table"],["game-data-element-buff","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[2,"font-family","Cambria, Georgia","font-size","12px"],["game-data-element-buff","","class","table-row",3,"gameDataElement","isEdit","isTagLocked","isPieceMode",4,"ngFor","ngForOf"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked","isPieceMode"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Se(0,vK,2,1,"ng-container",0),Se(1,wK,3,2,"ng-container",0),Se(2,EK,13,0,"ng-template",null,1,zn)),2&e&&(oe("ngIf",!i.isPieceMode),W(1),oe("ngIf",i.isPieceMode))},directives:[Sn,ec,qu,Fi,Ti,yi,_s,gf,oi,n],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell-2[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;padding:0}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}.inputLock[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box;width:100%;min-width:10px;font-weight:700}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function TK(n,t){if(1&n&&(ee(0,"div",4),nt(1,"div",5),ce()),2&n){const e=t.$implicit,i=_e(3);W(1),oe("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!1)}}function SK(n,t){if(1&n&&(Je(0),ee(1,"div",2),Se(2,TK,2,3,"div",3),ce(),et()),2&n){const e=_e(2);W(2),oe("ngForOf",e.character.buffDataElement.children)}}function DK(n,t){if(1&n&&(Je(0),ee(1,"div",1),Se(2,SK,3,1,"ng-container",0),ce(),et()),2&n){const e=_e();W(2),oe("ngIf",e.character.buffDataElement)}}let zP=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.character=null}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["game-character-buff-view"]],inputs:{character:"character"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"controller"],[1,"table"],["class","flex-item",4,"ngFor","ngForOf"],[1,"flex-item"],["game-data-element-buff","",1,"table-row",3,"gameDataElement","isEdit","isPieceMode"]],template:function(e,i){1&e&&Se(0,DK,3,1,"ng-container",0),2&e&&oe("ngIf",i.character)},directives:[Sn,oi,LP],styles:[".text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px}"]}),n})();const IK=["textArea"];function kK(n,t){1&n&&(nt(0,"img",22),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().imageFile.url,"resourceUrl"),fn)}function MK(n,t){if(1&n&&(ee(0,"ng-option",23),we(1),ce()),2&n){const e=_e();oe("value",null==e.myPeer?null:e.myPeer.identifier),W(1),ln("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function AK(n,t){if(1&n&&(ee(0,"ng-option",23),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.identifier),W(1),ln("",e.name," ")}}function PK(n,t){1&n&&(Je(0),we(1," \u5168\u89e3\u9664\u53e3\u2192 "),et())}function FK(n,t){1&n&&(Je(0),we(1," \u5168\u9078\u629e\u3006\u2192 "),et())}function RK(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",24),Re("ngModelChange",function(r){return ze(e),_e().tachieNum=r}),Ft(2,"safe"),ce(),we(3," 0/0 \u7acb\u3061\u7d75 "),et()}if(2&n){const e=_e();W(1),vi(Nt(2,3,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),oe("ngModel",e.tachieNum)}}function NK(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e(2);W(1),ln(" ",e.selectCharacterTachie.currentValue," ")}}function OK(n,t){1&n&&gn(0)}function BK(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",25),Re("ngModelChange",function(r){return ze(e),_e().tachieNum=r}),Ft(2,"safe"),ce(),we(3),Se(4,NK,2,1,"ng-container",13),Se(5,OK,1,0,"ng-container",13),et()}if(2&n){const e=_e();W(1),vi(Nt(2,8,"font-size: 0.8em; min-width: 1em; width:10em; --min: 0; --max: 0; --val:10;","style")),sn("max",e.selectCharacterTachieNum-1),oe("ngModel",e.tachieNum),W(2),na(" ",e.tachieNum,"/",e.selectCharacterTachieNum-1," \u7acb\u3061\u7d75 "),W(1),oe("ngIf",e.selectCharacterTachie.currentValue.length>0),W(1),oe("ngIf",e.selectCharacterTachie.currentValue.length<=0)}}const LK=function(n){return{"direct-message":n}},Gw=function(n,t,e){return{"background-color":n,border:t,"border-radius":e}},zK=function(){return{standalone:!0}};let UK=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Kt,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Kt,this._sendTo="",this.sendToChange=new Kt,this._text="",this.textChange=new Kt,this._selectNum=0,this.chat=new Kt,this.allBox=new Kt,this.hideChkEvent=new Kt,this.gameHelp="",this.colorSelectNo_=0,this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[],this.buffHideIsChk=!1}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get selectNum(){return this._selectNum}get tachieNum(){const e=Xe.instance.get(this.sendFrom);return e instanceof Bt?e.selectedTachieNum:0}set tachieNum(e){const i=Xe.instance.get(this.sendFrom);i instanceof Bt&&(i.selectedTachieNum=e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get colorSelectNo(){return this.colorSelectNo_}set colorSelectNo(e){this.colorSelectNo_=e<0?0:e>2?2:e}get colorSelectorBoxBorder_0(){return 0===this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_1(){return 1===this.colorSelectNo?"3px":"1px"}get colorSelectorBoxBorder_2(){return 2===this.colorSelectNo?"3px":"1px"}get colorSelectorRadius_0(){return 0===this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_1(){return 1===this.colorSelectNo?"9px":"0px"}get colorSelectorRadius_2(){return 2===this.colorSelectNo?"9px":"0px"}get selectChatColor(){return console.log("selectChatColor :"+this.charactorChatColor(this.colorSelectNo)),this.charactorChatColor(this.colorSelectNo)}get charactorChatColor_0(){return this.charactorChatColor(0)}get charactorChatColor_1(){return this.charactorChatColor(1)}get charactorChatColor_2(){return this.charactorChatColor(2)}get selectCharacterTachie(){const e=Xe.instance.get(this.sendFrom);return e instanceof Bt&&e.imageDataElement.children.length>this.tachieNum?e.imageDataElement.children[this.tachieNum]:null}get selectCharacterTachieNum(){const e=Xe.instance.get(this.sendFrom);return e instanceof Bt?e.imageDataElement.children.length:0}get imageFile(){if(this.selectCharacterTachie)return xt.instance.get(this.selectCharacterTachie.value)||Ot.Empty;const e=Xe.instance.get(this.sendFrom);let i=null;return e instanceof Bt?i=e.imageFile:e instanceof _t&&(i=e.image),i||Ot.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Bt).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return or.diceBotInfos}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}setColorNum(e){this.colorSelectNo=e}charactorChatColor(e){const i=Xe.instance.get(this.sendFrom);return i instanceof Bt?i.chatColorCode[e]:"#000000"}shoeColorSetting(){const e=Xe.instance.get(this.sendFrom);if(e instanceof Bt){const i=this.pointerDeviceService.pointers[0];let r="\u8272\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(jw,{title:r,left:i.x+50,top:i.y-150,width:300,height:120}).tabletopObject=e}}ngOnInit(){Qe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;const i=Xe.instance.get(e.data.messageIdentifier),r=Xe.instance.getObjects(_t).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(e.data.aliasName!==Bt.aliasName||(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom))return;const i=Xe.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{const i=Xe.instance.get(this.sendTo);i instanceof _t&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new cc(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.add(()=>this.ngZone.run(()=>{}),this))})}ngOnDestroy(){Qe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{const i=_t.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){const i=Xe.instance.get(this.sendTo);if(i instanceof _t){const r=zi.parse(i.peerId);r&&(e=r.peerId)}}Qe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){if(e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);const i={text:this.text,sendFrom:this.sendFrom,sendTo:this.sendTo,tachieNum:this.tachieNum,messColor:this.selectChatColor};or.loadGameSystemAsync(this.gameType).then(o=>{this.chat.emit({text:i.text,gameSystem:o,sendFrom:i.sendFrom,sendTo:i.sendTo,tachieNum:i.tachieNum,messColor:i.messColor})}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight()}allBoxCheck(){this.allBox.emit(this.selectNum>0?{check:!1}:{check:!0})}calcFitHeight(){const e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),or.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}buffHideChkChange(e){console.log("buffHideChkChange:"+e),this.hideChkEvent.emit(e),this.buffHideIsChk=e}allowsChat(e){switch(e.location.name){case"table":return!e.hideInventory;case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of $t.peerContexts)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Eo),Be(Fg),Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["controller-input"]],viewQuery:function(e,i){if(1&e&&Gn(IK,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"],_selectNum:["selectNum","_selectNum"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat",allBox:"allBox",hideChkEvent:"hideChkEvent"},decls:41,vars:33,consts:[[1,"table",3,"ngClass"],[1,"table"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[1,"ud-select",2,"width","10em",3,"ngModel","searchable","clearable","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"color",3,"ngStyle","click"],[1,"color-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em","text-align","right"],[1,"color-setting","small-font",2,"width","7em",3,"click"],[4,"ngIf"],[1,"tachie-tag"],[2,"width","100%"],[2,"float","right","text-align","right"],["name","buff_hide_chk","type","checkbox",3,"change"],[3,"hidden"],["placeholder","Enter\u3067\u9001\u4fe1",1,"controller-input",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"image",3,"src"],[3,"value"],["type","range","min","0","max","0",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2),Se(3,kK,2,4,"img",3),ce(),ee(4,"div",4)(5,"div",1)(6,"div",4)(7,"div")(8,"ng-select",5),Re("ngModelChange",function(o){return i.sendFrom=o}),Se(9,MK,2,2,"ng-option",6),Se(10,AK,2,2,"ng-option",7),ce()(),ee(11,"div")(12,"div",8),Re("click",function(){return i.setColorNum(0)}),ce(),ee(13,"div",8),Re("click",function(){return i.setColorNum(1)}),ce(),ee(14,"div",8),Re("click",function(){return i.setColorNum(2)}),ce(),ee(15,"button",9),Re("click",function(){return i.shoeColorSetting()}),ee(16,"i",10),we(17,"settings"),ce(),we(18,"\u8272\u8a2d\u5b9a"),ce()()(),ee(19,"div",4)(20,"div",11),we(21),nt(22,"br"),ee(23,"button",12),Re("click",function(){return i.allBoxCheck()}),Se(24,PK,2,0,"ng-container",13),Se(25,FK,2,0,"ng-container",13),ce()()()(),ee(26,"div",14),Se(27,RK,4,6,"ng-container",13),Se(28,BK,6,11,"ng-container",13),ce()()(),nt(29,"hr"),ee(30,"div",15),we(31,"\u30d0\u30d5/\u30c7\u30d0\u30c3\u30d5\u30a1\u30fc "),ee(32,"div",16),we(33,"\u96a0\u3059 "),ee(34,"input",17),Re("change",function(o){return i.buffHideChkChange(o.target.checked)}),ce()(),ee(35,"form")(36,"div",18)(37,"textarea",19,20),Re("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)}),ce(),ee(39,"button",21),Re("click",function(){return i.sendChat(null)}),we(40,"\u5b9f\u884c"),ce()()()()()),2&e&&(oe("ngClass",Rt(18,LK,i.isDirect)),W(3),oe("ngIf",0<i.imageFile.url.length),W(5),oe("ngModel",i.sendFrom)("searchable",!1)("clearable",!1),W(1),oe("ngIf",!i.onlyCharacters),W(1),oe("ngForOf",i.gameCharacters),W(2),oe("ngStyle",Wo(20,Gw,i.charactorChatColor_0,"solid "+i.colorSelectorBoxBorder_0+" #666666",i.colorSelectorRadius_0)),W(1),oe("ngStyle",Wo(24,Gw,i.charactorChatColor_1,"solid "+i.colorSelectorBoxBorder_1+" #666666",i.colorSelectorRadius_1)),W(1),oe("ngStyle",Wo(28,Gw,i.charactorChatColor_2,"solid "+i.colorSelectorBoxBorder_2+" #666666",i.colorSelectorRadius_2)),W(7),ln(" \u9078\u629e\u6570\uff1a",i.selectNum,""),W(3),oe("ngIf",0!=i.selectNum),W(1),oe("ngIf",0==i.selectNum),W(2),oe("ngIf",1>=i.selectCharacterTachieNum),W(1),oe("ngIf",1<i.selectCharacterTachieNum),W(8),oe("hidden",i.buffHideIsChk),W(1),oe("ngModel",i.text)("ngModelOptions",mr(32,zK)))},directives:[nr,Sn,pg,Ti,yi,xf,oi,bo,oa,Fi,ps,gs,yo],pipes:[Ii],styles:["div.color[_ngcontent-%COMP%]{display:inline-block;border:solid 1px #000;box-sizing:border-box;position:relative;top:4px;width:18px;height:18px;margin-left:2px;margin-right:2px;background-color:#888;cursor:pointer}button.color[_ngcontent-%COMP%]:focus{outline:none}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.controller-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}"]}),n})();const HK=["controllerInput"],VK=["chatPalette"];function jK(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",16),Re("ngModelChange",function(r){return ze(e),_e().chatTabidentifier=r}),ce(),ee(2,"div"),we(3),ce()()}if(2&n){const e=t.$implicit,i=_e();W(1),sn("value",e.identifier),oe("ngModel",i.chatTabidentifier),W(2),Ct(e.name)}}function GK(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e(2);W(1),ln("",e.errorMessageBuff," ")}}function qK(n,t){1&n&&(ee(0,"div",22)(1,"i",23),we(2,"info_outline"),ce(),we(3," \u30d0\u30d5\u7de8\u96c6\u4e2d\u3067\u3059"),ce())}const WK=function(){return{standalone:!0}};function ZK(n,t){if(1&n){const e=ht();Je(0),ee(1,"textarea",27,28),Re("ngModelChange",function(r){return ze(e),_e(3).text=r})("input",function(){return ze(e),_e(3).onInput()})("keydown.enter",function(r){return ze(e),_e(3).sendChat(r)}),ce(),ee(3,"button",29),Re("click",function(){return ze(e),_e(3).sendChat(null)}),we(4,"\u5b9f\u884c"),ce(),et()}if(2&n){const e=_e(3);W(1),oe("ngModel",e.text)("ngModelOptions",mr(2,WK))}}function YK(n,t){if(1&n&&(ee(0,"option",31),we(1),ce()),2&n){const e=t.$implicit;sn("value",e),W(1),Ct(e)}}function KK(n,t){if(1&n&&(Je(0),Se(1,YK,2,2,"option",30),et()),2&n){const e=_e(3);W(1),oe("ngForOf",e.palette.getPalette())}}function XK(n,t){if(1&n){const e=ht();ee(0,"div",24)(1,"select",25,26),Re("input",function(r){return ze(e),_e(2).selectPalette(r.target.value)})("click",function(r){return ze(e),_e(2).clickPalette(r.target.value)}),ee(3,"form"),Se(4,ZK,5,3,"ng-container",8),ce(),Se(5,KK,2,1,"ng-container",8),ce()()}if(2&n){const e=_e(2);W(4),oe("ngIf",!e.buffHideIsChk),W(1),oe("ngIf",e.palette)}}function QK(n,t){if(1&n){const e=ht();ee(0,"div",24)(1,"textarea",32),Re("ngModelChange",function(r){return ze(e),_e(2).editPalette=r}),ce()()}if(2&n){const e=_e(2);W(1),oe("ngModel",e.editPalette)}}function JK(n,t){1&n&&(ee(0,"span"),we(1,"\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6"),ce())}function eX(n,t){1&n&&(ee(0,"span"),we(1,"\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8\u78ba\u5b9a"),ce())}function tX(n,t){if(1&n){const e=ht();Je(0),Se(1,GK,2,1,"div",8),Se(2,qK,4,0,"div",17),Se(3,XK,6,2,"div",18),Se(4,QK,2,1,"div",18),ee(5,"div",19)(6,"button",20),Re("click",function(){return ze(e),_e().toggleEditMode()}),Se(7,JK,2,0,"span",8),Se(8,eX,2,0,"span",8),ce(),nt(9,"BR"),ee(10,"button",21),Re("click",function(){return ze(e),_e().decBuffRoundSelect()}),ee(11,"span"),we(12,"\u30d0\u30d5R\u6e1b\u5c11/\u9078\u629e"),ce()(),ee(13,"button",21),Re("click",function(){return ze(e),_e().decBuffRoundAll()}),ee(14,"span"),we(15,"\u30d0\u30d5R\u6e1b\u5c11/\u5168\u54e1"),ce()(),ee(16,"button",21),Re("click",function(){return ze(e),_e().deleteZeroRoundBuffSelect()}),ee(17,"span"),we(18,"0R\u4ee5\u4e0b\u6d88\u53bb/\u9078\u629e"),ce()(),ee(19,"button",21),Re("click",function(){return ze(e),_e().deleteZeroRoundBuffAll()}),ee(20,"span"),we(21,"0R\u4ee5\u4e0b\u6d88\u53bb/\u5168\u54e1"),ce()()(),et()}if(2&n){const e=_e();W(1),oe("ngIf",e.errorMessageBuff.length>0),W(1),oe("ngIf",e.isEdit),W(1),oe("ngIf",!e.isEdit),W(1),oe("ngIf",e.isEdit),W(3),oe("ngIf",!e.isEdit),W(1),oe("ngIf",e.isEdit)}}function nX(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e(2);W(1),ln("",e.errorMessageController," ")}}function iX(n,t){if(1&n){const e=ht();ee(0,"div")(1,"label")(2,"input",42),Re("click",function(){ze(e);const r=_e(2).$implicit;return _e(4).remoteSelect(r.name,"now",r.name+"\u73fe\u5728\u5024")}),ce(),ee(3,"div"),we(4),ce()(),ee(5,"label")(6,"input",42),Re("click",function(){ze(e);const r=_e(2).$implicit;return _e(4).remoteSelect(r.name,"max",r.name+"\u6700\u5927\u5024")}),ce(),ee(7,"div"),we(8),ce()()()}if(2&n){const e=_e(2).$implicit;W(2),sn("value",e.name+"\u73fe\u5728\u5024"),W(2),Ct(e.name+"\u73fe\u5728\u5024"),W(2),sn("value",e.name+"\u6700\u5927\u5024"),W(2),Ct(e.name+"\u6700\u5927\u5024")}}function rX(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",42),Re("click",function(){ze(e);const r=_e(2).$implicit;return _e(4).remoteSelect(r.name,"now",r.name)}),ce(),ee(2,"div"),we(3),ce()()}if(2&n){const e=_e(2).$implicit;W(1),sn("value",e.name),W(2),Ct(e.name)}}function oX(n,t){if(1&n&&(Je(0)(1,39),Se(2,iX,9,4,"div",40),Se(3,rX,4,2,"label",41),et()()),2&n){const e=_e().$implicit;W(1),oe("ngSwitch",e.attributes.type),W(1),oe("ngSwitchCase","numberResource")}}function sX(n,t){if(1&n&&(Je(0),Se(1,oX,4,2,"ng-container",8),et()),2&n){const e=t.$implicit,i=_e(4);W(1),oe("ngIf",e&&i.dataTags.includes(e.name))}}function aX(n,t){if(1&n&&(Je(0),Se(1,sX,2,1,"ng-container",5),et()),2&n){const e=t.$implicit;W(1),oe("ngForOf",e.children)}}function lX(n,t){if(1&n&&(ee(0,"div")(1,"div",38),Se(2,aX,2,1,"ng-container",5),ce()()),2&n){const e=_e(2);W(2),oe("ngForOf",e.character.detailDataElement.children)}}function cX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div"),we(2," \u5909\u66f4\u91cf "),ee(3,"input",33),Re("ngModelChange",function(r){return ze(e),_e().remoteNumber=r}),ce(),ee(4,"button",34),Re("click",function(){return ze(e),_e().reverseValue()}),ee(5,"span"),we(6," \xb1 "),ce()(),ee(7,"button",29),Re("click",function(){return ze(e),_e().remoteChangeValue()}),ee(8,"span"),we(9,"\u64cd\u4f5c"),ce()(),ee(10,"div",35),we(11," \u6700\u5927\u5236\u9650 "),ee(12,"input",36),Re("ngModelChange",function(r){return ze(e),_e().recoveryLimitFlag=r})("change",function(r){return ze(e),_e().recoveryLimitFlagChange(r.target.checked)}),ce(),nt(13,"br"),we(14," 0\u5236\u9650 "),ee(15,"input",37),Re("ngModelChange",function(r){return ze(e),_e().recoveryLimitFlagMin=r})("change",function(r){return ze(e),_e().recoveryLimitFlagChange(r.target.checked)}),ce()()(),Se(16,nX,2,1,"div",8),Se(17,lX,3,1,"div",8),et()}if(2&n){const e=_e();W(3),oe("ngModel",e.remoteNumber),W(9),oe("ngModel",e.recoveryLimitFlag),W(3),oe("ngModel",e.recoveryLimitFlagMin),W(1),oe("ngIf",e.errorMessageController.length>0),W(1),oe("ngIf",e.character.rootDataElement)}}function uX(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e();W(1),ln("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function dX(n,t){1&n&&gn(0)}const fX=function(){return{box:!0,selected:0}},hX=function(n){return{gameObject:n}};function gX(n,t){if(1&n&&(ee(0,"div",43),Se(1,dX,1,0,"ng-container",44),ce()),2&n){const e=t.$implicit;_e();const i=an(21);oe("ngClass",mr(3,fX)),W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(4,hX,e))}}function pX(n,t){1&n&&(nt(0,"img",55),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().gameObject.imageFile.url,"resourceUrl"),fn)}function _X(n,t){1&n&&gn(0)}const mX=function(n){return{dataElm:n}};function $X(n,t){if(1&n&&(Je(0),Se(1,_X,1,0,"ng-container",44),et()),2&n){const e=t.$implicit;_e(3);const i=an(23);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,mX,e))}}function vX(n,t){if(1&n&&(ee(0,"div"),Se(1,$X,2,4,"ng-container",56),ce()),2&n){const e=_e().gameObject,i=_e();W(1),oe("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function bX(n,t){if(1&n){const e=ht();ee(0,"div",45)(1,"div",46)(2,"div")(3,"span",47),we(4),ce(),ee(5,"button",48),Re("click",function(){const o=ze(e).gameObject;return _e().buffEdit(o)}),we(6,"\u30d0\u30d5\u7de8\u96c6"),ce()(),ee(7,"div",49)(8,"div",50),Re("click",function(){const o=ze(e).gameObject;return _e().targetBlockClick(o)}),ee(9,"div",51),Se(10,pX,2,4,"img",52),ce(),nt(11,"input",53),ce(),ee(12,"div",54),Se(13,vX,2,2,"div",8),ce()()()()}if(2&n){const e=t.gameObject,i=_e();W(4),Ct(e.name),W(6),oe("ngIf",e.imageFile.url),W(1),tg("id","",e.identifier,"_",i.initTimestamp,""),W(2),oe("ngIf",e.rootDataElement)}}function yX(n,t){1&n&&(Je(0),nt(1,"br"),et())}function CX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",59),we(2),ce(),ee(3,"div",60)(4,"div",61)(5,"div",62)(6,"div",63),we(7),ce(),ee(8,"div",63),we(9),ce(),ee(10,"div",49)(11,"div",64)(12,"div",65),we(13,"\xa0"),ce(),ee(14,"div",65),we(15,"/"),ce()(),ee(16,"div",54)(17,"input",66),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.currentValue=r}),ce(),ee(18,"input",66),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.value=r}),ce()()()()()(),et()}if(2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(5),ln("\xa0\xa0",e.value,""),W(2),ln("\xa0\xa0",e.currentValue,""),W(8),vi("color:"+e.nowValueColor+";"),oe("ngModel",e.currentValue),W(1),oe("ngModel",e.value)}}function xX(n,t){if(1&n){const e=ht();ee(0,"input",70),Re("click",function(){return ze(e),_e(3).dataElm.value=0}),ce()}}function wX(n,t){if(1&n){const e=ht();ee(0,"input",71),Re("click",function(){return ze(e),_e(3).dataElm.value=1}),ce()}}function EX(n,t){if(1&n&&(Je(0),ee(1,"div",59),we(2),ce(),ee(3,"div",67)(4,"div",61)(5,"div",62),Se(6,xX,1,0,"input",68),Se(7,wX,1,0,"input",69),ce()()(),et()),2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(4),oe("ngIf",0!=e.value),W(1),oe("ngIf",0==e.value)}}function TX(n,t){1&n&&gn(0)}function SX(n,t){1&n&&gn(0)}function DX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",59),we(2),ce(),ee(3,"div",60)(4,"div",61)(5,"div",62)(6,"div",63),we(7),ce(),ee(8,"input",66),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.value=r}),ce()()()(),et()}if(2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(5),Ct(e.value),W(1),oe("ngModel",e.value)}}function IX(n,t){if(1&n&&(ee(0,"div",58),Je(1,39),Se(2,CX,19,7,"ng-container",40),Se(3,EX,8,3,"ng-container",40),Se(4,TX,1,0,"ng-container",40),Se(5,SX,1,0,"ng-container",40),Se(6,DX,9,3,"ng-container",41),et(),ce()),2&n){const e=_e().dataElm;W(1),oe("ngSwitch",e.attributes.type),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","check"),W(1),oe("ngSwitchCase","note"),W(1),oe("ngSwitchCase","markdown")}}function kX(n,t){if(1&n&&(Se(0,yX,2,0,"ng-container",8),Se(1,IX,7,5,"div",57)),2&n){const e=t.dataElm,i=_e();oe("ngIf",(null==e?null:e.name)===i.newLineString),W(1),oe("ngIf",e&&e.name!==i.newLineString)}}let UP=(()=>{class n{constructor(e,i,r,o,s,a){this.chatMessageService=e,this.panelService=i,this.changeDetector=r,this.inventoryService=o,this.contextMenuService=s,this.pointerDeviceService=a,this.character=null,this.errorMessageBuff="",this.errorMessageController="",this._gameType="",this.initTimestamp=0,this.text="",this.buffAreaIsHide=!1,this.controllerAreaIsHide=!1,this.chatTabidentifier="",this.remoteNumber=0,this.recoveryLimitFlag=!1,this.recoveryLimitFlagMin=!1,this.disptimer=null,this.selectCharacter=null,this.remoteControllerSelect={name:"",nowOrMax:"",dispName:""},this.remoteControllerRadio="",this.remoteControlleridentifier=["test01","test02"],this.inputText="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null,this.charList=[],this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.initTimestamp=Date.now(),console.log("this.initTimestamp "+this.initTimestamp)}get palette(){return this.character.remoteController}get gameType(){return null==this._gameSystem?"":this._gameSystem.ID}set gameType(e){or.loadGameSystemAsync(e).then(i=>{this._gameSystem=i,this.character.remoteController&&(this.character.remoteController.dicebot=i.ID)})}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return or.diceBotInfos}get chatTab(){return Xe.instance.get(this.chatTabidentifier)}get myPeer(){return _t.myCursor}get otherPeers(){return Xe.instance.getObjects(_t)}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===pd.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}hideChkBoxEvent(e){this.buffAreaIsHide=e}controllerHideChkChange(e){this.controllerAreaIsHide=e}recoveryLimitFlagChange(e){}reverseValue(){this.remoteNumber=-this.remoteNumber}remoteSelect(e,i,r){this.remoteControllerSelect.name=e,this.remoteControllerSelect.nowOrMax=i,this.remoteControllerSelect.dispName=r}charListChange(e,i){i?this.charList.indexOf(e)<0&&this.charList.push(e):this.charList.indexOf(e)>-1&&this.charList.splice(this.charList.indexOf(e),1)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.remoteController?this.character.remoteController.dicebot:"",Qe.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")}),Qe.register(this).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{Xe.instance.get(e.data.identifier)instanceof Xr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("CHK_TARGET_CHANGE",-1e3,e=>{Xe.instance.get(e.data.identifier)instanceof Bt&&(this.targetSetChkBox(Xe.instance.get(e.data.identifier)),console.log("REC CHK_TARGET_CHANGE"))}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",$t.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=$t.peerId)}),this.inventoryTypes=["table","common",$t.peerId,"graveyard"],this.disptimer=setInterval(()=>{this.changeDetector.detectChanges();const e=this.getGameObjects(this.selectTab);for(const i of e)i instanceof Bt&&this.targetSetChkBox(i)},200)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null,this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30ea\u30e2\u30b3\u30f3"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();const i=Xe.instance.get(e);if(i instanceof Bt){this.character=i;const r=this.character.remoteController?this.character.remoteController.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.controllerInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}resetPaletteSelect(){!this.chatPaletteElementRef.nativeElement||(this.chatPaletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}ngAfterViewInit(){}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case $t.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case $t.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){if("table"===e){const i=[],r=this.inventoryService.tableInventory.tabletopObjects;for(const o of r)o.hideInventory||i.push(o);return i}}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}toggleEdit(){this.isEdit=!this.isEdit}selectGameObject(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName}),this.selectCharacter=e}getTargetCharacters(e){const i=new Array,r=this.getGameObjects(this.selectTab);for(const o of r)if(o instanceof Bt){if(o.hideInventory)continue;const s=document.getElementById(o.identifier+"_"+this.initTimestamp);s&&(s.checked||!e)&&i.push(o)}return i}remoteDecBuffRound(e){let i="";const r=this.getTargetCharacters(e);if(!(r.length<=0)&&this.chatTab&&r.length>0){for(const a of r)a.decreaseBuffRound(),i=i+"["+a.name+"]";this.chatMessageService.sendMessage(this.chatTab,"\u30d0\u30d5\u306eR\u3092\u6e1b\u5c11 "+i,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum)}}decBuffRoundSelect(){this.remoteDecBuffRound(!0)}decBuffRoundAll(){this.remoteDecBuffRound(!1)}remoteBuffDeleteZeroRound(e){let i="";const r=this.getTargetCharacters(e);if(r.length>0){for(const a of r)a.deleteZeroRoundBuff(),i=i+"["+a.name+"]";this.chatMessageService.sendMessage(this.chatTab,"0R\u4ee5\u4e0b\u306e\u30d0\u30d5\u3092\u6d88\u53bb "+i,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum)}}deleteZeroRoundBuffSelect(){this.remoteBuffDeleteZeroRound(!0)}deleteZeroRoundBuffAll(){this.remoteBuffDeleteZeroRound(!1)}remoteAddBuffRound(e,i,r,o){if(!(e.length<=0))for(const a of e)a.addBuffRound(i,r,o)}sendChat(e){let i="";const r=this.getTargetCharacters(!0),o=e.text.split(/\s+/);let s=null,a="",g="",w="";if(0!=o.length&&""!=o[0])if(g=o[0],w=o[0],o.length>1&&(a=o[1],w=w+"/"+o[1]),o.length>2?(s=parseInt(o[2]),Number.isNaN(s)&&(s=3)):s=3,w=w+"/"+s+"R",r.length>0){for(const me of r)i=i+"["+me.name+"]";this.remoteAddBuffRound(r,g,a,s),this.chatMessageService.sendMessage(this.chatTab,"\u30d0\u30d5\u3092\u4ed8\u4e0e "+w+" > "+i,this._gameSystem,this.sendFrom,"",e.tachieNum,e.messColor),this.errorMessageBuff=""}else this.errorMessageBuff="\u5bfe\u8c61\u304c\u672a\u9078\u629e\u3067\u3059"}remoteChangeValue(){let e="";const i=this.getTargetCharacters(!0);if(""!=this.remoteControllerSelect.name){for(const r of i)e+=r.changeStatusValue(this.remoteControllerSelect.name,this.remoteControllerSelect.nowOrMax,this.remoteNumber,this.recoveryLimitFlagMin,this.recoveryLimitFlag);if(""!=e){let r="+";this.remoteNumber<0&&(r=""),this.chatMessageService.sendMessage(this.chatTab,"["+this.remoteControllerSelect.dispName+"]\u5909\u66f4["+r+this.remoteNumber+"]\uff1e"+e,this._gameSystem,this.sendFrom,"",this.controllerInputComponent.tachieNum,this.controllerInputComponent.selectChatColor),this.errorMessageController=""}else this.errorMessageController="\u5bfe\u8c61\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u672a\u9078\u629e\u3067\u3059"}else this.errorMessageController="\u5909\u66f4\u9805\u76ee\u304c\u672a\u9078\u629e\u3067\u3059"}trackByGameObject(e,i){return i?i.identifier:e}buffEdit(e){const i=this.pointerDeviceService.pointers[0],r={left:i.x,top:i.y,width:420,height:300};r.title=e.name+"\u306e\u30d0\u30d5\u7de8\u96c6",this.panelService.open(zP,r).character=e}allBoxCheck(e){const i=this.getGameObjects(this.selectTab);for(const r of i)if(r instanceof Bt){const o=document.getElementById(r.identifier+"_"+this.initTimestamp);r.targeted=e.check,o&&(o.checked=r.targeted,Qe.trigger("CHK_TARGET_CHANGE",{identifier:r.identifier,className:r.aliasName}))}}targetSetChkBox(e){const i=document.getElementById(e.identifier+"_"+this.initTimestamp);i&&(i.checked=e.targeted)}targetBlockClick(e){console.log("targetBlockClick"),e.targeted=!e.targeted,this.targetSetChkBox(e),Qe.trigger("CHK_TARGET_CHANGE",{identifier:e.identifier,className:e.aliasName})}onChange(e){console.log("onChange"),this.targetBlockClick(e)}}return n.\u0275fac=function(e){return new(e||n)(Be(Eo),Be($n),Be(bi),Be(ab),Be(To),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["remote-controller"]],viewQuery:function(e,i){if(1&e&&(Gn(HK,7),Gn(VK,5)),2&e){let r;yn(r=Cn())&&(i.controllerInputComponent=r.first),yn(r=Cn())&&(i.chatPaletteElementRef=r.first)}},inputs:{character:"character"},decls:24,vars:12,consts:[[1,"remote-controller-wrapper"],[1,"sticky-top-left","is-caret"],[1,"flex-container","is-caret"],[1,"is-caret",2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","selectNum","gameTypeChange","sendFromChange","textChange","selectNumChange","allBox","chat","hideChkEvent"],["controllerInput",""],[4,"ngIf"],[2,"width","100%"],[2,"float","right","text-align","right"],["name","buff_hide_chk","type","checkbox",3,"change"],[1,"controller-right"],[3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["gameObjectTags",""],["dataElmTag",""],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],[2,"flex-grow","0"],["type","submit",2,"width","20em",3,"click"],["type","submit",2,"width","10em",3,"click"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPalette",""],["placeholder","Enter\u3067\u9001\u4fe1",1,"controller-input","is-caret",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30d0\u30d5\u30d1\u30ec\u30c3\u30c8",1,"palette","is-caret",2,"resize","none",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","3.0em","font-size","1.2em",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right","text-align","right","margin-top","5px"],["name","max_limit_chk","type","checkbox",3,"ngModel","ngModelChange","change"],["name","min_limit_chk","type","checkbox",3,"ngModel","ngModelChange","change"],[1,"controller"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["name","controller","type","radio","ng-control","options",3,"value","click"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"inventory-object"],[1,"object-tags-box"],[1,"object-name"],[1,"tab-setting","small-font",3,"click"],[1,"table"],[1,"table-cell","click-area",3,"click"],[1,"image-box"],[3,"src",4,"ngIf"],["name","target_chk","value","object.targeted","type","checkbox",1,"target_chk",3,"id"],[1,"table-cell"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],[1,"table-cell","tag-slash"],[2,"padding","2px"],["size","1","placeholder","",1,"input","tag-value","is-caret",3,"ngModel","ngModelChange"],[2,"text-align","center","margin","2px 0px 0px 0px"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form")(5,"div",4),Se(6,jK,4,3,"label",5),ce()(),ee(7,"controller-input",6,7),Re("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("selectNumChange",function(o){return i.getTargetCharacters(!0).length=o})("allBox",function(o){return i.allBoxCheck(o)})("chat",function(o){return i.sendChat(o)})("hideChkEvent",function(o){return i.hideChkBoxEvent(o)}),ce(),Se(9,tX,22,6,"ng-container",8),ce()(),nt(10,"hr"),ee(11,"div",9),we(12,"\u30ab\u30a6\u30f3\u30bf\u30fc\u30ea\u30e2\u30b3\u30f3 "),ee(13,"div",10),we(14,"\u96a0\u3059 "),ee(15,"input",11),Re("change",function(o){return i.controllerHideChkChange(o.target.checked)}),ce()()(),Se(16,cX,18,5,"ng-container",8),ce(),ee(17,"div",12),Se(18,uX,2,1,"div",8),Se(19,gX,2,6,"div",13),Se(20,bX,14,5,"ng-template",null,14,zn),Se(22,kX,2,2,"ng-template",null,15,zn),ce()()),2&e&&(W(6),oe("ngForOf",i.chatMessageService.chatTabs),W(1),oe("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text)("selectNum",i.getTargetCharacters(!0).length),W(2),oe("ngIf",!i.buffAreaIsHide),W(7),oe("ngIf",!i.controllerAreaIsHide),W(2),oe("ngIf",i.getGameObjects(i.selectTab).length<1),W(1),oe("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject))},directives:[ps,gs,yo,oi,Xu,Fi,Ti,yi,UK,Sn,nc,ic,_s,ra,ec,qu,gf,nr,Ra],pipes:[Ii],styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.remote-controller-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.controller[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.controller[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.controller[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table[_ngcontent-%COMP%]{display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.click-area[_ngcontent-%COMP%]{border:1px dotted #666}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;max-width:32px;max-height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-slash[_ngcontent-%COMP%]{font-size:1em;min-width:.1em;max-width:.1em;text-align:center;font-family:inherit}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.sticky-top-left[_ngcontent-%COMP%]{flex:1;max-width:21em;height:calc(100% - 11px);overflow-y:scroll;background-color:#f0dabdcc;border-top:1px dotted #666;padding:5px;margin-top:0}.controller-right[_ngcontent-%COMP%]{flex:1;height:100%;overflow-y:scroll}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function MX(n,t){1&n&&gn(0)}function AX(n,t){1&n&&gn(0)}function PX(n,t){1&n&&gn(0)}function FX(n,t){if(1&n&&(ee(0,"div"),we(1),ce()),2&n){const e=_e();W(1),ln("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function RX(n,t){1&n&&gn(0)}const NX=function(n){return{box:!0,selected:n}},OX=function(n){return{gameObject:n}};function BX(n,t){if(1&n){const e=ht();ee(0,"div",10),Re("contextmenu",function(r){const s=ze(e).$implicit;return _e().onContextMenu(r,s)})("click",function(){const o=ze(e).$implicit;return _e().selectGameObject(o)})("dblclick",function(r){const s=ze(e).$implicit;return _e().focusToObject(r,s)}),Se(1,RX,1,0,"ng-container",11),ce()}if(2&n){const e=t.$implicit,i=_e(),r=an(14);oe("ngClass",Rt(3,NX,i.selectedIdentifier===e.identifier)),W(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",Rt(5,OX,e))}}function LX(n,t){if(1&n){const e=ht();ee(0,"div",12)(1,"button",13),Re("click",function(){return ze(e),_e().cleanInventory()}),we(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),ce()()}if(2&n){const e=_e();W(1),Zt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function zX(n,t){if(1&n){const e=ht();ee(0,"label")(1,"input",17),Re("ngModelChange",function(r){return ze(e),_e(2).selectTab=r}),ce(),ee(2,"div"),we(3),ce()()}if(2&n){const e=t.$implicit,i=_e(2);W(1),sn("value",e),oe("ngModel",i.selectTab),W(2),na("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function UX(n,t){if(1&n&&(ee(0,"form",14)(1,"div",15),Se(2,zX,4,4,"label",16),ce()()),2&n){const e=_e();W(2),oe("ngForOf",e.inventoryTypes)}}function HX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div")(2,"div",18),we(3,"\u4e26\u3073\u9806\u7b2c1"),ce(),ee(4,"input",19),Re("ngModelChange",function(r){return ze(e),_e(2).sortTag=r}),ce(),ee(5,"select",20),Re("ngModelChange",function(r){return ze(e),_e(2).sortOrder=r}),ee(6,"option",21),we(7,"\u6607\u9806"),ce(),ee(8,"option",22),we(9,"\u964d\u9806"),ce()()(),ee(10,"div")(11,"div",18),we(12,"\u4e26\u3073\u9806\u7b2c2"),ce(),ee(13,"input",19),Re("ngModelChange",function(r){return ze(e),_e(2).sortTag2nd=r}),ce(),ee(14,"select",20),Re("ngModelChange",function(r){return ze(e),_e(2).sortOrder2nd=r}),ee(15,"option",21),we(16,"\u6607\u9806"),ce(),ee(17,"option",22),we(18,"\u964d\u9806"),ce()()(),ee(19,"div",23),we(20,"\u8868\u793a\u9805\u76ee"),ce(),ee(21,"input",24),Re("ngModelChange",function(r){return ze(e),_e(2).dataTag=r}),ce(),ee(22,"div",12)(23,"button",25),Re("click",function(){return ze(e),_e(2).toggleEdit()}),ee(24,"i",26),we(25,"settings"),ce(),we(26,"\u5b8c\u4e86"),ce()(),et()}if(2&n){const e=_e(2);W(4),oe("ngModel",e.sortTag),W(1),oe("ngModel",e.sortOrder),W(8),oe("ngModel",e.sortTag2nd),W(1),oe("ngModel",e.sortOrder2nd),W(7),oe("ngModel",e.dataTag)}}function VX(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e(3);W(1),na("",e.sortTag," (",e.sortOrderName,")")}}function jX(n,t){1&n&&(Je(0),we(1,"-"),et())}function GX(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e(3);W(1),na("",e.sortTag2nd," (",e.sortOrderName2nd,")")}}function qX(n,t){1&n&&(Je(0),we(1,"-"),et())}function WX(n,t){if(1&n){const e=ht();Je(0),ee(1,"table",27)(2,"tr")(3,"th",28),we(4,"\u4e26\u3073\u9806 \u7b2c1:"),ce(),ee(5,"td",28),Se(6,VX,2,2,"ng-container",2),Se(7,jX,2,0,"ng-container",2),ce(),ee(8,"th",28),we(9," \u7b2c2:"),ce(),ee(10,"td",28),Se(11,GX,2,2,"ng-container",2),Se(12,qX,2,0,"ng-container",2),ce(),ee(13,"td")(14,"button",25),Re("click",function(){return ze(e),_e(2).toggleEdit()}),ee(15,"i",26),we(16,"settings"),ce(),we(17,"\u8a2d\u5b9a"),ce()()()(),et()}if(2&n){const e=_e(2);W(6),oe("ngIf",0<e.sortTag.length),W(1),oe("ngIf",e.sortTag.length<1),W(4),oe("ngIf",0<e.sortTag2nd.length),W(1),oe("ngIf",e.sortTag2nd.length<1)}}function ZX(n,t){if(1&n&&(Se(0,HX,27,5,"ng-container",2),Se(1,WX,18,4,"ng-container",2)),2&n){const e=_e();oe("ngIf",e.isEdit),W(1),oe("ngIf",!e.isEdit)}}function YX(n,t){1&n&&(Je(0),we(1,"\u5168\u89e3\u9664\u53e3\u2193"),et())}function KX(n,t){1&n&&we(0,"\u5168\u9078\u629e\u3006\u2193")}function XX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",27)(2,"span",29),we(3,"\u4e00\u62ec\u79fb\u52d5:"),ce(),ee(4,"button",25),Re("click",function(){return ze(e),_e(2).allTabBoxCheck()}),Se(5,YX,2,0,"ng-container",30),Se(6,KX,1,0,"ng-template",null,31,zn),ce(),ee(8,"button",25),Re("click",function(){return ze(e),_e(2).onMultiMoveContextMenu()}),ee(9,"i",26),we(10,"settings"),ce(),we(11,"\u5b9f\u884c"),ce(),ee(12,"button",25),Re("click",function(){return ze(e),_e(2).toggleMultiMove()}),ee(13,"i",26),we(14,"settings"),ce(),we(15,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce()(),et()}if(2&n){const e=an(7),i=_e(2);W(5),oe("ngIf",i.existsMultiMoveSelectedInTab())("ngIfElse",e)}}function QX(n,t){if(1&n){const e=ht();Je(0),ee(1,"div")(2,"button",25),Re("click",function(){return ze(e),_e(2).toggleMultiMove()}),ee(3,"i",26),we(4,"settings"),ce(),we(5,"\u4e00\u62ec\u79fb\u52d5"),ce()(),et()}}function JX(n,t){if(1&n&&(Se(0,XX,16,2,"ng-container",2),Se(1,QX,6,0,"ng-container",2)),2&n){const e=_e();oe("ngIf",e.isMultiMove),W(1),oe("ngIf",!e.isMultiMove)}}function eQ(n,t){if(1&n){const e=ht();ee(0,"button",40),Re("click",function(r){ze(e);const o=_e().gameObject;return _e().onContextMenu(r,o)}),ee(1,"i",41),we(2,"settings"),ce()()}}function tQ(n,t){if(1&n){const e=ht();ee(0,"div",37)(1,"input",42),Re("change",function(r){ze(e);const o=_e().gameObject;return _e().toggleMultiMoveTarget(r,o)}),ce()()}if(2&n){const e=_e().gameObject,i=_e();W(1),oe("checked",i.multiMoveTargets.has(e.identifier))}}function nQ(n,t){1&n&&(nt(0,"img",43),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().gameObject.imageFile.url,"resourceUrl"),fn)}function iQ(n,t){1&n&&gn(0)}const rQ=function(n){return{dataElm:n}};function oQ(n,t){if(1&n&&(Je(0),Se(1,iQ,1,0,"ng-container",11),et()),2&n){const e=t.$implicit;_e(3);const i=an(16);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,rQ,e))}}function sQ(n,t){if(1&n&&(ee(0,"div"),Se(1,oQ,2,4,"ng-container",44),ce()),2&n){const e=_e().gameObject,i=_e();W(1),oe("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function aQ(n,t){if(1&n&&(ee(0,"div",32)(1,"div",33),we(2),Se(3,eQ,3,0,"button",34),ce(),ee(4,"div",35),Se(5,tQ,2,1,"div",36),ee(6,"div",37)(7,"div",38),Se(8,nQ,2,4,"img",39),ce()(),ee(9,"div",37),Se(10,sQ,2,2,"div",2),ce()()()),2&n){const e=t.gameObject,i=_e();W(2),ln("",e.name," "),W(1),oe("ngIf",i.selectedIdentifier===e.identifier),W(2),oe("ngIf",i.isMultiMove),W(3),oe("ngIf",e.imageFile.url),W(2),oe("ngIf",e.rootDataElement)}}function lQ(n,t){1&n&&(Je(0),nt(1,"br"),et())}function cQ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",50)(2,"div",51),we(3),ce(),ee(4,"input",52),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.currentValue=r}),ce()(),ee(5,"div",50)(6,"input",53),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.currentValue=r}),Ft(7,"safe"),ce()(),et()}if(2&n){const e=_e(2).dataElm;W(3),Ct(e.name),W(1),vi("color:"+e.nowValueColor+";"),oe("ngModel",e.currentValue),W(2),vi(Nt(7,8,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),oe("ngModel",e.currentValue)}}function uQ(n,t){if(1&n){const e=ht();ee(0,"input",60),Re("click",function(){return ze(e),_e(3).dataElm.value=0}),ce()}}function dQ(n,t){if(1&n){const e=ht();ee(0,"input",61),Re("click",function(){return ze(e),_e(3).dataElm.value=1}),ce()}}function fQ(n,t){if(1&n&&(Je(0),ee(1,"div",54),we(2),ce(),ee(3,"div",55)(4,"div",56)(5,"div",57),Se(6,uQ,1,0,"input",58),Se(7,dQ,1,0,"input",59),ce()()(),et()),2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(4),oe("ngIf",0!=e.value),W(1),oe("ngIf",0==e.value)}}function hQ(n,t){1&n&&gn(0)}function gQ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",54),we(2),ce(),ee(3,"div",62)(4,"div",56)(5,"div",57)(6,"div",63),we(7),ce(),ee(8,"input",64),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.value=r}),ce()()()(),et()}if(2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(5),Ct(e.value),W(1),oe("ngModel",e.value)}}function pQ(n,t){if(1&n&&(ee(0,"div",46),Je(1,47),Se(2,cQ,8,11,"ng-container",48),Se(3,fQ,8,3,"ng-container",48),Se(4,hQ,1,0,"ng-container",48),Se(5,gQ,9,3,"ng-container",49),et(),ce()),2&n){const e=_e().dataElm;W(1),oe("ngSwitch",e.attributes.type),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","check"),W(1),oe("ngSwitchCase","markdown")}}function _Q(n,t){if(1&n&&(Se(0,lQ,2,0,"ng-container",2),Se(1,pQ,6,4,"div",45)),2&n){const e=t.dataElm,i=_e();oe("ngIf",(null==e?null:e.name)===i.newLineString),W(1),oe("ngIf",e&&e.name!==i.newLineString)}}let mQ=(()=>{class n{constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.multiMoveTargets=new Set,this.isEdit=!1,this.isMultiMove=!1,this.disptimer=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get sortTag2nd(){return this.inventoryService.sortTag2nd}set sortTag2nd(e){this.inventoryService.sortTag2nd=e}get sortOrder2nd(){return this.inventoryService.sortOrder2nd}set sortOrder2nd(e){this.inventoryService.sortOrder2nd=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===pd.ASC?"\u6607\u9806":"\u964d\u9806"}get sortOrderName2nd(){return this.sortOrder2nd===pd.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Qe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Xe.instance.get(e.data.identifier)instanceof Xr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",$t.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=$t.peerId)}),this.inventoryTypes=["table","common",$t.peerId,"graveyard"]}ngAfterViewInit(){this.disptimer=setInterval(()=>{this.changeDetector.detectChanges()},200)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case $t.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case $t.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){if("table"===e){let i=[],r=this.inventoryService.tableInventory.tabletopObjects;for(let o of r)o.hideInventory||i.push(o);return i}return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&(o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push({name:"\u30ea\u30e2\u30b3\u30f3\u3092\u8868\u793a",action:()=>{this.showRemoteController(i)}})),o.push(xi);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:$t.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),mt.play(ut.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),mt.play(ut.sweep)}}),o.push(xi),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),mt.play(ut.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}toggleMultiMove(){this.isMultiMove&&this.multiMoveTargets.clear(),this.isMultiMove=!this.isMultiMove}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);mt.play(ut.sweep)}}existsMultiMoveSelectedInTab(){return this.getGameObjects(this.selectTab).some(e=>this.multiMoveTargets.has(e.identifier))}toggleMultiMoveTarget(e,i){e.target instanceof HTMLInputElement&&(e.target.checked?this.multiMoveTargets.add(i.identifier):this.multiMoveTargets.delete(i.identifier),console.log(`multimove selected ${[...this.multiMoveTargets]}`))}allTabBoxCheck(){this.existsMultiMoveSelectedInTab()?this.getGameObjects(this.selectTab).forEach(e=>this.multiMoveTargets.delete(e.identifier)):this.getGameObjects(this.selectTab).forEach(e=>this.multiMoveTargets.add(e.identifier))}onMultiMoveContextMenu(){if(!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0],i=[],r=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:$t.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let o of r)this.selectTab!==o.name&&i.push({name:o.alias,action:()=>{this.multiMove(o.name),this.toggleMultiMove(),mt.play(ut.piecePut)}});"graveyard"==this.selectTab&&i.push({name:"\u5893\u5834\u304b\u3089\u524a\u9664",action:()=>{this.multiDelete(),this.toggleMultiMove(),mt.play(ut.sweep)}}),this.contextMenuService.open(e,i,"\u4e00\u62ec\u79fb\u52d5")}multiMove(e){for(const i of this.multiMoveTargets){let r=Xe.instance.get(i);r instanceof Bt&&r.setLocation(e)}}multiDelete(){let e=new Set;for(const i of this.multiMoveTargets){let r=Xe.instance.get(i);r instanceof Bt&&"graveyard"==r.location.name&&e.add(r)}if(!(e.size<1)&&confirm(`\u9078\u629e\u3057\u305f\u3082\u306e\u306e\u3046\u3061\u5893\u5834\u306b\u5b58\u5728\u3059\u308b${e.size}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`))for(const i of e)this.deleteGameObject(i)}cloneGameObject(e){e.clone()}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(BP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}showRemoteController(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(UP,{left:i.x-250,top:i.y-175,width:700,height:600}).character=e}focusToObject(e,i){e.target instanceof HTMLElement&&(new Set(["input","button"]).has(e.target.tagName.toLowerCase())||"table"==i.location.name&&Qe.trigger("FOCUS_TO_TABLETOP_COORDINATE",{x:i.location.x,y:i.location.y}))}selectGameObject(e){this.isMultiMove&&(this.multiMoveTargets.has(e.identifier)?this.multiMoveTargets.delete(e.identifier):this.multiMoveTargets.add(e.identifier),console.log(`multimove selected ${[...this.multiMoveTargets]}`)),Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName}),Qe.trigger("HIGHTLIGHT_TABLETOP_OBJECT",{identifier:e.identifier})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(ab),Be(To),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["game-object-inventory"]],decls:17,vars:7,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["inventoryMultiMove",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click","dblclick"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"is-caret",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",1,"is-caret",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[2,"font-weight","bold"],[4,"ngIf","ngIfElse"],["selectAll",""],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],["class","table-cell",4,"ngIf"],[1,"table-cell"],[1,"image-box"],[3,"src",4,"ngIf"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],["type","checkbox",3,"checked","change"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value","is-caret",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"tag-name"],[2,"text-align","center","margin","2px 0px 0px 0px"],[2,"display","inline-block"],[1,"tag-value-box"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[2,"text-align","center"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value","is-caret",3,"ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(ee(0,"div",0),Se(1,MX,1,0,"ng-container",1),Se(2,AX,1,0,"ng-container",1),Se(3,PX,1,0,"ng-container",1),Se(4,FX,2,1,"div",2),Se(5,BX,2,7,"div",3),Se(6,LX,3,1,"div",4),ce(),Se(7,UX,3,1,"ng-template",null,5,zn),Se(9,ZX,2,2,"ng-template",null,6,zn),Se(11,JX,2,2,"ng-template",null,7,zn),Se(13,aQ,11,5,"ng-template",null,8,zn),Se(15,_Q,2,2,"ng-template",null,9,zn)),2&e){const r=an(8),o=an(10),s=an(12);W(1),oe("ngTemplateOutlet",r),W(1),oe("ngTemplateOutlet",o),W(1),oe("ngTemplateOutlet",s),W(1),oe("ngIf",i.getGameObjects(i.selectTab).length<1),W(1),oe("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),W(1),oe("ngIf","graveyard"===i.selectTab)}},directives:[Ra,Sn,oi,nr,ps,gs,yo,Xu,Fi,Ti,yi,tc,nc,ic,ec,qu,_s,oa,gf],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;max-width:32px;max-height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();const $Q=Ot.create("./assets/images/skeleton.png");let Ng=(()=>{class n{constructor(){}getSkeletonOr(e){let i=e instanceof Ot?e:xt.instance.get(e);return i&&!i.isEmpty?i:$Q}getEmptyOr(e){let i=e instanceof Ot?e:xt.instance.get(e);return i&&!i.isEmpty?i:Ot.Empty}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function vQ(n,t){if(1&n&&(ee(0,"option",8),we(1),ce()),2&n){const e=t.$implicit;sn("value",e.identifier),W(1),Ct(e.name)}}function bQ(n,t){if(1&n){const e=ht();ee(0,"div")(1,"button",29),Re("click",function(){return ze(e),_e(2).openDistanceViewImageModal()}),we(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),ce()()}}function yQ(n,t){if(1&n){const e=ht();ee(0,"div",2),Re("click",function(){return ze(e),_e(2).openDistanceViewImageModal()}),nt(1,"img",10),Ft(2,"safe"),ce()}if(2&n){const e=_e(2);W(1),oe("src",Nt(2,1,e.tableDistanceviewImage.url,"resourceUrl"),fn)}}function CQ(n,t){if(1&n&&(ee(0,"div",35),we(1),ce()),2&n){const e=_e(3);W(1),ln("",e.progresPercent,"%")}}const xQ=function(n){return{"is-hidden":n}};function wQ(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",30),Re("click",function(){return ze(e),_e(2).save()}),ee(2,"div",31)(3,"div",32),we(4,"\u4fdd\u5b58"),ce(),Se(5,CQ,2,1,"div",33),ce()(),ee(6,"button",34),Re("click",function(){return ze(e),_e(2).delete()}),we(7,"\u524a\u9664"),ce(),et()}if(2&n){const e=_e(2);W(1),oe("disabled",e.isSaveing),W(2),oe("ngClass",Rt(4,xQ,e.isSaveing)),W(2),oe("ngIf",e.isSaveing),W(1),Zt("disabled",e.getGameTables().length<=1?"":null)}}function EQ(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",2),Re("click",function(){return ze(e),_e(2).restore()}),we(2,"\u5143\u306b\u623b\u3059"),ce(),et()}}function TQ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",9)(2,"div"),we(3," \u753b\u50cf "),ee(4,"div",2),Re("click",function(){return ze(e),_e().openBgImageModal()}),nt(5,"img",10),Ft(6,"safe"),ce()(),ee(7,"div"),we(8," \u80cc\u666f "),Se(9,bQ,3,0,"div",6),Se(10,yQ,3,4,"div",11),ce()(),ee(11,"div"),we(12,"Name : "),ee(13,"input",12),Re("ngModelChange",function(r){return ze(e),_e().tableName=r}),ce()(),ee(14,"div")(15,"input",13),Re("ngModelChange",function(r){return ze(e),_e().tableWidth=r}),ce(),we(16," Width : "),ee(17,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tableWidth=r}),ce()(),ee(18,"div")(19,"input",15),Re("ngModelChange",function(r){return ze(e),_e().tableHeight=r}),ce(),we(20," Height : "),ee(21,"input",14),Re("ngModelChange",function(r){return ze(e),_e().tableHeight=r}),ce()(),ee(22,"div"),we(23," \u30b0\u30ea\u30c3\u30c9: "),ee(24,"select",16),Re("ngModelChange",function(r){return ze(e),_e().tableGridType=r}),ee(25,"option",17),we(26,"\u306a\u3057"),ce(),ee(27,"option",18),we(28,"\u30b9\u30af\u30a8\u30a2"),ce(),ee(29,"option",19),we(30,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),ce(),ee(31,"option",20),we(32,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),ce()(),we(33," \u30b0\u30ea\u30c3\u30c9\u8272: "),ee(34,"input",21),Re("ngModelChange",function(r){return ze(e),_e().tableGridColor=r}),ce()(),ee(35,"div"),we(36," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),ee(37,"select",22),Re("ngModelChange",function(r){return ze(e),_e().tableDistanceviewFilter=r}),ee(38,"option",23),we(39,"\u306a\u3057"),ce(),ee(40,"option",24),we(41,"\u30db\u30ef\u30a4\u30c8"),ce(),ee(42,"option",25),we(43,"\u30d6\u30e9\u30c3\u30af"),ce()()(),nt(44,"hr"),ee(45,"div")(46,"label"),we(47,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),ee(48,"input",26),Re("ngModelChange",function(r){return ze(e),_e().tableGridShow=r}),ce()(),ee(49,"label"),we(50,"\u30b9\u30ca\u30c3\u30d7: "),ee(51,"input",27),Re("ngModelChange",function(r){return ze(e),_e().tableGridSnap=r}),ce()(),nt(52,"hr"),ee(53,"label"),we(54,"\u5168\u54e1\u306e\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u6642\u5f37\u5236ON: "),ee(55,"input",28),Re("ngModelChange",function(r){return ze(e),_e().roomGridDispAlways=r}),ce(),nt(56,"br"),we(57," \u203b\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u8a2d\u5b9a\u3067\u306f\u306a\u304f\u90e8\u5c4b\u5168\u4f53\u306e\u8a2d\u5b9a\u3067\u3059\u3002 "),ce(),nt(58,"hr"),Se(59,wQ,8,6,"ng-container",6),Se(60,EQ,3,0,"ng-container",6),ce(),et()}if(2&n){const e=_e();W(5),oe("src",Nt(6,32,e.tableBackgroundImage.url,"resourceUrl"),fn),W(4),oe("ngIf",!e.tableDistanceviewImage.url),W(1),oe("ngIf",e.tableDistanceviewImage.url),W(3),oe("ngModel",e.tableName),Zt("disabled",e.isEditable?null:""),W(2),sn("min",e.minSize),sn("max",e.maxSize),oe("ngModel",e.tableWidth),Zt("disabled",e.isEditable?null:""),W(2),sn("min",e.minSize),sn("max",e.maxSize),oe("ngModel",e.tableWidth),Zt("disabled",e.isEditable?null:""),W(2),sn("min",e.minSize),sn("max",e.maxSize),oe("ngModel",e.tableHeight),Zt("disabled",e.isEditable?null:""),W(2),sn("min",e.minSize),sn("max",e.maxSize),oe("ngModel",e.tableHeight),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.tableGridType),Zt("disabled",e.isEditable?null:""),W(10),oe("ngModel",e.tableGridColor),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.tableDistanceviewFilter),Zt("disabled",e.isEditable?null:""),W(11),oe("ngModel",e.tableGridShow),W(3),oe("ngModel",e.tableGridSnap),W(4),oe("ngModel",e.roomGridDispAlways),W(4),oe("ngIf",!e.isDeleted),W(1),oe("ngIf",e.isDeleted)}}function SQ(n,t){1&n&&(Je(0),ee(1,"div",36),we(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ce(),et())}function DQ(n,t){if(1&n&&(ee(0,"ng-option",8),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.id),W(1),Ct(e.name)}}const IQ=function(){return{standalone:!0}};let HP=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this._gameType="",this.gameTypeChange=new Kt,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get gameType(){return this.config.defaultDiceBot}set gameType(e){this.config.defaultDiceBot=e}loadDiceBot(e){console.log("changeDiceBot ready"),or.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");this.tableGridDummy=!this.tableGridDummy,i&&(i.roomGridDispAlways=e)}get config(){return Xe.instance.get("Config")}get diceBotInfos(){return or.diceBotInfos}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableGridDummy(){return this.tableSelecter.tableGridDummy}set tableGridDummy(e){this.tableSelecter.tableGridDummy=e}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor.substring(0,7)}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e+"e6")}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,e&&(this.tableSelecter.viewTable.gridClipRect=null),Qe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return da.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Xe.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,Qe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Xe.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}selectGameTable(e){Qe.call("SELECT_GAME_TABLE",{identifier:e},$t.peerId),this.selectedTable=Xe.instance.get(e),this.selectedTableXml=""}getGameTables(){return Xe.instance.getObjects(Jr)}createGameTable(){let e=new Jr;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Ji.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(Uf).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(Uf,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be(ko),Be(Ng),Be($n))},n.\u0275cmp=Xt({type:n,selectors:[["game-table-setting"]],inputs:{_gameType:["gameType","_gameType"]},outputs:{gameTypeChange:"gameTypeChange"},decls:17,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[1,"ud-select","is-caret",2,"width","15em","margin-left",".1em",3,"ngModel","ngModelOptions","clearable","change","ngModelChange"],[3,"value"],[1,"images-select"],["height","120",3,"src"],[3,"click",4,"ngIf"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","min","max","ngModelChange"],["type","number",1,"is-caret",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","min","max","ngModelChange"],["name","tableGridType",3,"ngModel","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["type","color","name","tableGridColor","list","table-grid-color-list",3,"ngModel","ngModelChange"],["name","tableDistanceviewFilter",3,"ngModel","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],["type","checkbox","name","roomGridDispAlways",3,"ngModel","ngModelChange"],[2,"height","120px",3,"click"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createGameTable()}),we(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),ce()(),ee(5,"select",3),Re("change",function(o){return i.selectGameTable(o.target.value)}),Se(6,vQ,2,2,"option",4),ce()(),ee(7,"div",5),Se(8,TQ,61,35,"ng-container",6),ce()(),Se(9,SQ,3,0,"ng-container",6),ee(10,"div"),nt(11,"hr"),we(12," \u6a19\u6e96\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8(\u90e8\u5c4b\u63a5\u7d9a\u6642\u306b\u9078\u629e\u3055\u308c\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306b\u306a\u308a\u307e\u3059)\u3002"),nt(13,"br"),we(14," \u203b\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u8a2d\u5b9a\u3067\u306f\u306a\u304f\u90e8\u5c4b\u5168\u4f53\u306e\u8a2d\u5b9a\u3067\u3059\u3002 "),ee(15,"ng-select",7),Re("change",function(o){return i.loadDiceBot(o)})("ngModelChange",function(o){return i.gameType=o}),Se(16,DQ,2,2,"ng-option",4),ce()()),2&e&&(W(5),oe("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),W(1),oe("ngForOf",i.getGameTables()),W(2),oe("ngIf",!i.isEmpty||i.selectedTable),W(1),oe("ngIf",i.isEmpty),W(6),oe("ngModel",i.gameType)("ngModelOptions",mr(8,IQ))("clearable",!1),W(1),oe("ngForOf",i.diceBotInfos))},directives:[tc,Ti,yi,oi,nc,ic,Sn,Fi,oa,_s,Ju,Qu,ra,nr,pg,xf],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function kQ(n,t){if(1&n){const e=ht();ee(0,"button",5),Re("click",function(){ze(e);const r=_e().$implicit;return _e().play(r)}),we(1,"\u8a66\u8074/\u518d\u751f"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function MQ(n,t){if(1&n){const e=ht();ee(0,"button",5),Re("click",function(){return ze(e),_e(2).stop()}),we(1,"\u8a66\u8074/\u505c\u6b62"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function AQ(n,t){1&n&&(ee(0,"span"),we(1,"\u3010\u8a66\u8074\u4e2d\u3011"),ce())}function PQ(n,t){if(1&n){const e=ht();ee(0,"div",2)(1,"button",3),Re("click",function(){const o=ze(e).$implicit;return _e().selectBgm(o)}),we(2,"\u767b\u9332"),ce(),Se(3,kQ,2,1,"button",4),Se(4,MQ,2,1,"button",4),Se(5,AQ,2,0,"span",1),ee(6,"span"),we(7),ce()()}if(2&n){const e=t.$implicit,i=_e();W(3),oe("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),W(1),oe("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),W(1),oe("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),W(2),Ct(e.name)}}function FQ(n,t){1&n&&(ee(0,"div"),we(1,"\u97f3\u697d\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),ce())}let RQ=(()=>{class n{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new Qt,this.lazyUpdateTimer=null}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3BGM\u9078\u629e"),this.auditionPlayer.volumeType=Rf.AUDITION,Qe.register(this).on("*",e=>{})}ngOnDestroy(){Qe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}selectBgm(e){!e||(console.log("onSelectedFile",e),console.log("file.identifier"+e.identifier),console.log("file.name"+e.name),this.modalService.resolve(e.identifier))}handleFileSelect(e){let i=e.target.files;i.length&&yl.instance.load(i)}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-cut-in-bgm"]],decls:3,vars:2,consts:[["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"box"],[3,"click"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,i){1&e&&(ee(0,"div"),Se(1,PQ,8,4,"div",0),Se(2,FQ,2,0,"div",1),ce()),2&e&&(W(1),oe("ngForOf",i.audios),W(1),oe("ngIf",i.audios.length<1))},directives:[oi,Sn],styles:['.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),n})();const NQ=function(n){return{outer:n}};function OQ(n,t){if(1&n&&(ee(0,"div",5),we(1),ee(2,"span",6),we(3),ce(),we(4),ee(5,"span",7),we(6),ce()()),2&n){const e=_e();W(1),ln("",e.urlObj.protocol,"//"),W(1),oe("ngClass",Rt(6,NQ,e.isOuter)),W(1),Ct(e.urlObj.host),W(1),Ct(e.urlObj.pathname),W(2),na("",e.urlObj.search,"",e.urlObj.hash,"")}}function BQ(n,t){if(1&n&&(ee(0,"div",5),we(1),ce()),2&n){const e=_e();W(1),Ct(e.url)}}function LQ(n,t){1&n&&(ee(0,"div"),we(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),ce())}function zQ(n,t){1&n&&(ee(0,"div"),we(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),ce())}let UQ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return this.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Qe.register(this)}validUrl(e){if(!e)return!1;try{new URL(e.trim())}catch(i){return!1}return/^https?\:\/\//.test(e.trim())}ngOnDestroy(){Qe.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(ee(0,"div"),Se(1,OQ,7,8,"div",0),Se(2,BQ,2,1,"div",0),nt(3,"hr"),ee(4,"div",1),Se(5,LQ,2,0,"div",2),Se(6,zQ,2,0,"div",2),ce()(),ee(7,"button",3),Re("click",function(){return i.openUrl()}),we(8,"\u958b\u304f"),ce(),ee(9,"button",4),Re("click",function(){return i.cancel()}),we(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce()),2&e&&(W(1),oe("ngIf",i.isValid),W(1),oe("ngIf",!i.isValid),W(3),oe("ngIf",i.isValid),W(1),oe("ngIf",!i.isValid),W(1),oe("disabled",!i.isValid))},directives:[Sn,nr],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),n})();function HQ(n,t){if(1&n&&(ee(0,"option",7),we(1),ce()),2&n){const e=t.$implicit;sn("value",e.identifier),W(1),Ct(e.name)}}function VQ(n,t){1&n&&(ee(0,"span"),we(1,"\uff1aYouTube\u6709\u52b9"),ce())}function jQ(n,t){if(1&n&&(Je(0),Se(1,VQ,2,0,"span",6),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isYouTubeCutIn)}}function GQ(n,t){1&n&&(ee(0,"span"),we(1,"OK\uff1a"),ce())}function qQ(n,t){1&n&&(ee(0,"span"),we(1,"NG\uff1a"),ce())}function WQ(n,t){1&n&&(ee(0,"span"),we(1,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u304c\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),ce())}function ZQ(n,t){1&n&&(ee(0,"span"),we(1,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),ce())}function YQ(n,t){if(1&n&&(Je(0),Se(1,WQ,2,0,"span",6),Se(2,ZQ,2,0,"span",6),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.cutInAudioName.length>0),W(1),oe("ngIf",e.cutInAudioName.length<=0)}}function KQ(n,t){if(1&n&&(ee(0,"span"),we(1),ce()),2&n){const e=_e(3);W(1),Ct(e.cutInAudioName)}}function XQ(n,t){1&n&&nt(0,"span")}function QQ(n,t){if(1&n&&(Je(0),Se(1,KQ,2,1,"span",6),Se(2,XQ,1,0,"span",6),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isEditable),W(1),oe("ngIf",!e.isEditable)}}function JQ(n,t){1&n&&(ee(0,"span"),we(1,"\u6a19\u6e96\u30b5\u30a4\u30ba\u3067\u8868\u793a\uff1a"),ce())}function eJ(n,t){1&n&&(ee(0,"span"),we(1,"\u5143\u30b5\u30a4\u30ba\u3067\u8868\u793a\uff1a"),ce())}function tJ(n,t){if(1&n&&(Je(0),Se(1,JQ,2,0,"span",6),Se(2,eJ,2,0,"span",6),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.selectedCutIn.videoId),W(1),oe("ngIf",!e.selectedCutIn.videoId)}}function nJ(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",2),Re("click",function(){return ze(e),_e(2).save()}),we(2,"\u4fdd\u5b58"),ce(),ee(3,"button",28),Re("click",function(){return ze(e),_e(2).delete()}),we(4,"\u524a\u9664"),ce(),et()}if(2&n){const e=_e(2);W(3),Zt("disabled",e.getCutIns().length<=0?"":null)}}function iJ(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",8)(2,"div"),we(3," \u753b\u50cf "),Se(4,jQ,2,1,"ng-container",6),ee(5,"div",9),Re("click",function(){return ze(e),_e().openCutInImageModal()}),nt(6,"img",10),Ft(7,"safe"),ee(8,"i",11),we(9),ce()()()(),ee(10,"div"),we(11,"\u540d\u79f0 : "),ee(12,"input",12),Re("ngModelChange",function(r){return ze(e),_e().cutInName=r}),ce()(),ee(13,"div")(14,"button",13),Re("click",function(){return ze(e),_e().playCutIn()}),we(15,"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f"),ce(),ee(16,"button",13),Re("click",function(){return ze(e),_e().stopCutIn()}),we(17,"\u30ab\u30c3\u30c8\u30a4\u30f3\u505c\u6b62"),ce(),ee(18,"button",13),Re("click",function(){return ze(e),_e().previewCutIn()}),we(19,"\u81ea\u5206\u3060\u3051\u518d\u751f"),ce(),nt(20,"br"),ce(),ee(21,"div",14),we(22," \u97f3\u697d\u30c7\u30fc\u30bf : "),ee(23,"button",2),Re("click",function(){return ze(e),_e().openCutInBgmModal()}),we(24,"\u8a2d\u5b9a"),ce(),nt(25,"br"),we(26," LINK:"),Se(27,GQ,2,0,"span",6),Se(28,qQ,2,0,"span",6),nt(29,"br"),Se(30,YQ,3,2,"ng-container",6),Se(31,QQ,3,2,"ng-container",6),ce(),ee(32,"div"),Se(33,tJ,3,2,"ng-container",6),ee(34,"input",15),Re("ngModelChange",function(r){return ze(e),_e().cutInOriginalSize=r}),ce()(),ee(35,"div"),we(36," Width :"),ee(37,"input",16),Re("ngModelChange",function(r){return ze(e),_e().cutInWidth=r}),ce(),we(38," \u7e26\u6a2a\u6bd4\u3092\u7dad\u6301 :"),ee(39,"input",17),Re("ngModelChange",function(r){return ze(e),_e().keepImageAspect=r})("click",function(){return ze(e),_e().chkImageAspect()}),ce()(),ee(40,"div"),we(41," Height :"),ee(42,"input",16),Re("ngModelChange",function(r){return ze(e),_e().cutInHeight=r}),ce()(),ee(43,"div")(44,"input",18),Re("ngModelChange",function(r){return ze(e),_e().cutInX_Pos=r}),ce(),we(45," X\u4f4d\u7f6e :"),ee(46,"input",19),Re("ngModelChange",function(r){return ze(e),_e().cutInX_Pos=r}),ce()(),ee(47,"div")(48,"input",18),Re("ngModelChange",function(r){return ze(e),_e().cutInY_Pos=r}),ce(),we(49," Y\u4f4d\u7f6e :"),ee(50,"input",19),Re("ngModelChange",function(r){return ze(e),_e().cutInY_Pos=r}),ce()(),ee(51,"div"),we(52," \u30eb\u30fc\u30d7\u518d\u751f\uff1a"),ee(53,"input",20),Re("ngModelChange",function(r){return ze(e),_e().cutInIsLoop=r}),ce()(),ee(54,"div"),we(55," \u518d\u751f\u6642\u9593 :"),ee(56,"input",21),Re("ngModelChange",function(r){return ze(e),_e().cutInOutTime=r}),ce()(),ee(57,"div"),we(58," \u30bf\u30b0\u540d\u79f0 :"),ee(59,"input",22),Re("ngModelChange",function(r){return ze(e),_e().cutInTagName=r}),ce(),we(60," \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u767a\u52d5\uff1a"),ee(61,"input",23),Re("ngModelChange",function(r){return ze(e),_e().chatActivate=r}),ce()(),ee(62,"div"),we(63," YouTube\u518d\u751f :"),ee(64,"input",24),Re("ngModelChange",function(r){return ze(e),_e().cutInIsVideo=r})("change",function(){return ze(e),_e().changeYouTubeInfo()}),ce(),we(65," URL :"),ee(66,"input",25),Re("ngModelChange",function(r){return ze(e),_e().cutInVideoURL=r})("input",function(){return ze(e),_e().changeYouTubeInfo()}),ce(),nt(67,"br"),ee(68,"a",26),Re("click",function(){return ze(e),_e().openYouTubeTerms()}),we(69,"YouTube \u5229\u7528\u898f\u7d04"),ce(),we(70," :\u6a5f\u80fd\u4f7f\u7528\u524d\u306b\u78ba\u8a8d\u304f\u3060\u3055\u3044 "),ce(),ee(71,"div")(72,"p",27),we(73,"\u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6319\u52d5"),nt(74,"br"),we(75,"\n\u30bf\u30b0\u540d\u79f0\u304c\u540c\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5148\u306b\u518d\u751f\u3057\u3066\u3044\u308b\u3082\u306e\u3092\u505c\u6b62\u3057\u307e\u3059(\u30bf\u30b0\u7a7a\u6b04\u542b\u3080)"),nt(76,"br"),we(77,"\n\u30bf\u30b0\u540d\u79f0\u304c\u7a7a\u6b04\u3067\u97f3\u697d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306eBGM\u3092\u505c\u6b62\u3057\u307e\u3059"),nt(78,"br"),we(79,"\n\u307e\u305f\u3001\u305d\u306e\u3088\u3046\u306a\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u3067BGM\u3092\u518d\u751f\u3059\u308b\u3068\u505c\u6b62\u3057\u307e\u3059"),nt(80,"br"),we(81,"\n\u9283\u6483\u97f3\u306eSE\u7b49\u3001BGM\u3068\u540c\u6642\u518d\u751f\u3057\u305f\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044"),nt(82,"br"),ce()(),nt(83,"hr"),ee(84,"div"),Se(85,nJ,5,1,"ng-container",6),ce(),et()}if(2&n){const e=_e();W(4),oe("ngIf",e.isEditable),W(2),oe("src",Nt(7,43,e.cutInImageUrl,"resourceUrl"),fn),W(3),Ct(e.isYouTubeCutIn?"movie":""),W(3),oe("ngModel",e.cutInName),Zt("disabled",e.isEditable?null:""),W(15),oe("ngIf",e.isCutInBgmUploaded()),W(1),oe("ngIf",!e.isCutInBgmUploaded()),W(2),oe("ngIf",!e.isCutInBgmUploaded()),W(1),oe("ngIf",e.isCutInBgmUploaded()),W(2),oe("ngIf",e.isEditable),W(1),oe("ngModel",e.cutInOriginalSize),Zt("disabled",e.isEditable?null:""),W(3),sn("min",e.minSizeWidth),sn("max",e.maxSizeWidth),oe("ngModel",e.cutInWidth),Zt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),W(2),oe("ngModel",e.keepImageAspect),Zt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),W(3),sn("min",e.minSizeHeight),sn("max",e.maxSizeHeight),oe("ngModel",e.cutInHeight),Zt("disabled",!e.isEditable||e.cutInOriginalSize?"":null),W(2),oe("ngModel",e.cutInX_Pos),Zt("disabled",e.isEditable?null:""),W(2),oe("ngModel",e.cutInX_Pos),Zt("disabled",e.isEditable?null:""),W(2),oe("ngModel",e.cutInY_Pos),Zt("disabled",e.isEditable?null:""),W(2),oe("ngModel",e.cutInY_Pos),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.cutInIsLoop),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.cutInOutTime),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.cutInTagName),Zt("disabled",e.isEditable?null:""),W(2),oe("ngModel",e.chatActivate),Zt("disabled",e.isEditable?null:""),W(3),oe("ngModel",e.cutInIsVideo),Zt("disabled",e.isEditable?null:""),W(2),oe("ngModel",e.cutInVideoURL),Zt("disabled",e.isEditable?null:""),W(19),oe("ngIf",!e.isDeleted)}}function rJ(n,t){1&n&&(Je(0),ee(1,"div",29),we(2,"\u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ce(),et())}let oJ=(()=>{class n{constructor(e,i,r,o,s){this.pointerDeviceService=e,this.modalService=i,this.saveDataService=r,this.panelService=o,this.ngZone=s,this._minSizeWidth=10,this._maxSizeWidth=10,this._minSizeHeight=1200,this._maxSizeHeight=1200,this.lazyUpdateTimer=null,this.selectedCutIn=null,this.isYouTubeCutIn=!1,this.isSaveing=!1,this.progresPercent=0}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}get cutInName(){return this.isEditable?this.selectedCutIn.name:""}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e),this.keepImageAspect&&(this.selectedCutIn.height=this.isYouTubeCutIn?Math.floor(e*this.selectedCutIn.defVideoSizeHeight/this.selectedCutIn.defVideoSizeWidth):Math.floor(e*this.originalImgHeight()/this.originalImgWidth()),console.log(" this.keepImageAspect H"+this.selectedCutIn.height))}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e),this.keepImageAspect&&(this.selectedCutIn.width=this.isYouTubeCutIn?Math.floor(e*this.selectedCutIn.defVideoSizeWidth/this.selectedCutIn.defVideoSizeHeight):Math.floor(e*this.originalImgWidth()/this.originalImgHeight()),console.log(" this.keepImageAspect W"+this.selectedCutIn.width))}get cutInWidth(){if(!this.isEditable||!this.selectedCutIn)return 0;if(this.cutInOriginalSize)if(this.isYouTubeCutIn){const e=this.selectedCutIn.defVideoSizeWidth;this.selectedCutIn.width!=e&&(this.selectedCutIn.width=e,console.log(" setCutInYouTubeSize w:"+e))}else{const e=this.originalImgWidth();this.selectedCutIn.width!=e&&(this.selectedCutIn.width=e,console.log(" setCutInOriginalSize w"+e))}return this.selectedCutIn.width}get cutInHeight(){if(!this.isEditable||!this.selectedCutIn)return 0;if(this.cutInOriginalSize)if(this.isYouTubeCutIn){const e=this.selectedCutIn.defVideoSizeHeight;this.selectedCutIn.height!=e&&(this.selectedCutIn.height=e,console.log(" setCutInYouTubeSize h:"+e))}else{const e=this.originalImgHeight();this.selectedCutIn.height!=e&&(this.selectedCutIn.height=e,console.log(" setCutInOriginalSize h"+e))}return this.selectedCutIn.height}get keepImageAspect(){return!(!this.isEditable||!this.selectedCutIn)&&this.selectedCutIn.keepImageAspect}set keepImageAspect(e){!this.isEditable||!this.selectedCutIn||(this.selectedCutIn.keepImageAspect=e)}chkImageAspect(){if(!this.isEditable||!this.selectedCutIn)return 0;setTimeout(()=>{if(this.keepImageAspect){let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;i.src=e,console.log("img.height /  img.width "+i.height+" "+i.width),this.selectedCutIn.height=this.isYouTubeCutIn?Math.floor(this.selectedCutIn.width*this.selectedCutIn.defVideoSizeHeight/this.selectedCutIn.defVideoSizeWidth):Math.floor(this.selectedCutIn.width*i.height/i.width)}}})}get cutInX_Pos(){return this.isEditable?this.selectedCutIn.x_pos:0}set cutInX_Pos(e){this.isEditable&&(this.selectedCutIn.x_pos=e)}get cutInY_Pos(){return this.isEditable?this.selectedCutIn.y_pos:0}set cutInY_Pos(e){this.isEditable&&(this.selectedCutIn.y_pos=e)}get cutInOriginalSize(){return!!this.isEditable&&this.selectedCutIn.originalSize}set cutInOriginalSize(e){this.isEditable&&(this.selectedCutIn.originalSize=e)}get cutInIsLoop(){return!!this.isEditable&&this.selectedCutIn.isLoop}set cutInIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get chatActivate(){return!!this.isEditable&&this.selectedCutIn.chatActivate}set chatActivate(e){this.isEditable&&(this.selectedCutIn.chatActivate=e)}get cutInOutTime(){return this.isEditable?this.selectedCutIn.outTime:0}set cutInOutTime(e){this.isEditable&&(this.selectedCutIn.outTime=e)}get cutInIsVideo(){return!!this.isEditable&&this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.isEditable?this.selectedCutIn.videoUrl:""}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInTagName(){return this.isEditable?this.selectedCutIn.tagName:""}set cutInTagName(e){this.isEditable&&(this.selectedCutIn.tagName=e)}get cutInAudioName(){return this.isEditable?this.selectedCutIn.audioName:""}set cutInAudioName(e){this.isEditable&&(this.selectedCutIn.audioName=e)}get cutInAudioIdentifier(){return this.isEditable?this.selectedCutIn.audioIdentifier:""}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}get cutInImage(){return this.selectedCutIn&&xt.instance.get(this.selectedCutIn.imageIdentifier)||Ot.Empty}get isSelected(){return!!this.selectedCutIn}get isEditable(){return!this.isEmpty&&this.isSelected}get isEmpty(){return!1}get cutInImageUrl(){return this.selectedCutIn?this.selectedCutIn.videoId?`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:this.cutInImage.url:Ot.Empty.url}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30ea\u30b9\u30c8")}ngOnDestroy(){Qe.unregister(this)}selectCutIn(e){this.selectedCutIn=Xe.instance.get(e),this.isYouTubeCutIn=!!this.selectedCutIn.videoId}getCutIns(){return Xe.instance.getObjects(Zi)}createCutIn(){let e=new Zi;e.name="\u672a\u8a2d\u5b9a\u306e\u30ab\u30c3\u30c8\u30a4\u30f3",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectCutIn(e.identifier)}save(){var e=this;return(0,xn.Z)(function*(){if(!e.selectedCutIn)return;e.isSaveing=!0,e.progresPercent=0,e.selectedCutIn.selected=!0;let i="cut_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedCutIn&&(this.selectedCutIn.destroy(),this.selectedCutIn=null)}openCutInImageModal(){!this.isSelected||this.modalService.open(Uf).then(e=>{!this.selectedCutIn||!e||(this.selectedCutIn.imageIdentifier=e)})}openCutInBgmModal(){!this.isSelected||this.modalService.open(RQ).then(e=>{if(console.log("CUTIN "+e),!this.selectedCutIn||!e)return;this.cutInAudioIdentifier=e;let i=Jt.instance.get(e);i&&(this.cutInAudioName=i.name,console.log("cutInAudioName"+this.cutInAudioName))})}isCutInBgmUploaded(){return!!this.isSelected&&!!Jt.instance.get(this.cutInAudioIdentifier)}stoppreviewCutIn(){}originalImgWidth(){if(!this.isSelected||!this.selectedCutIn||!this.selectedCutIn.cutInImage)return 0;let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;return i.src=e,i.width}return 0}originalImgHeight(){if(!this.isSelected||!this.selectedCutIn||!this.selectedCutIn.cutInImage)return 0;let e=this.selectedCutIn.cutInImage.url;if(e.length>0){let i=new Image;return i.src=e,i.height}return 0}openYouTubeTerms(){return this.modalService.open(UQ,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}changeYouTubeInfo(){if(console.log("changeYouTubeInfo"),!this.selectedCutIn)return;const e=!!this.selectedCutIn.videoId;(!this.isYouTubeCutIn&&e||this.isYouTubeCutIn&&!e)&&this.setDefaultControl(e),this.isYouTubeCutIn=e}get minSizeWidth(){return this.selectedCutIn&&(this._minSizeWidth=this.selectedCutIn.minSizeWidth(this.isYouTubeCutIn)),this._minSizeWidth}get maxSizeWidth(){return this.selectedCutIn&&(this._maxSizeWidth=this.selectedCutIn.maxSizeWidth(this.isYouTubeCutIn)),this._maxSizeWidth}get minSizeHeight(){return this.selectedCutIn&&(this._minSizeHeight=this.selectedCutIn.minSizeHeight(this.isYouTubeCutIn)),this._minSizeHeight}get maxSizeHeight(){return this.selectedCutIn&&(this._maxSizeHeight=this.selectedCutIn.maxSizeHeight(this.isYouTubeCutIn)),this._maxSizeHeight}setDefaultControl(e){if(!this.isEditable||!this.selectedCutIn)return 0;console.log("setDefaultControl"),e?(console.log("setDefaultControl isVideo"),this.selectedCutIn.width=this.selectedCutIn.defVideoSizeWidth,this.selectedCutIn.height=this.selectedCutIn.defVideoSizeHeight):(console.log("setDefaultControl ! isVideo"),this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}previewCutIn(){if(this.selectedCutIn.originalSize){let e=this.selectedCutIn.cutInImage.url;e.length>0&&((new Image).src=e,this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}this.cutInLauncher.startCutInMySelf(this.selectedCutIn)}playCutIn(){if(this.selectedCutIn.originalSize){let e=this.selectedCutIn.cutInImage.url;e.length>0&&((new Image).src=e,this.selectedCutIn.width=this.originalImgWidth(),this.selectedCutIn.height=this.originalImgHeight())}this.isCutInBgmUploaded()&&""==this.cutInTagName&&this.jukebox.stop(),this.cutInLauncher.startCutIn(this.selectedCutIn)}stopCutIn(){!this.isSelected||this.cutInLauncher.stopCutIn(this.selectedCutIn)}}return n.\u0275fac=function(e){return new(e||n)(Be(Di),Be(hi),Be(ko),Be($n),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-cut-in-list"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","20",2,"width","15em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item",2,"width","380px"],[4,"ngIf"],[3,"value"],[1,"images-select"],[1,"grow",2,"height","120px",3,"click"],["height","120",3,"src"],[1,"material-icons",2,"font-size","32px","margin-left","-28px"],["placeholder","Name",1,"is-caret",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"margin-left","20px"],["type","checkbox","name","cutInOriginalSize",3,"ngModel","ngModelChange"],["type","number",1,"is-caret",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","checkbox","name","keepImageAspect",3,"ngModel","ngModelChange","click"],["type","range","min","0","max","100","name","cutInX_PosWidth",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["type","checkbox","name","cutInIsLoop",3,"ngModel","ngModelChange"],["type","number","min","0",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["placeholder","",1,"is-caret",2,"width","5em",3,"ngModel","ngModelChange"],["type","checkbox","name","chatActivate",3,"ngModel","ngModelChange"],["type","checkbox","name","cutInIsVideo",3,"ngModel","ngModelChange","change"],["placeholder","URL",1,"is-caret",3,"ngModel","ngModelChange","input"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"font-size","0.4em"],[1,"danger",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Re("click",function(){return i.createCutIn()}),we(4,"\u65b0\u3057\u3044\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u4f5c\u308b"),ce()(),ee(5,"select",3),Re("change",function(o){return i.selectCutIn(o.target.value)}),Se(6,HQ,2,2,"option",4),ce()(),ee(7,"div",5),Se(8,iJ,86,46,"ng-container",6),ce()(),Se(9,rJ,3,0,"ng-container",6)),2&e&&(W(5),oe("ngModel",null==i.selectedCutIn?null:i.selectedCutIn.identifier),W(1),oe("ngForOf",i.getCutIns()),W(2),oe("ngIf",!i.isEmpty||i.selectedCutIn),W(1),oe("ngIf",i.isEmpty))},directives:[tc,Ti,yi,oi,nc,ic,Sn,Fi,ra,_s,Ju,Qu,oa],pipes:[Ii],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function sJ(n,t){if(1&n){const e=ht();ee(0,"button",11),Re("click",function(){return ze(e),_e().openCutInList()}),we(1,"\u30ab\u30c3\u30c8\u30a4\u30f3\u7de8\u96c6"),ce()}2&n&&oe("disabled",0)}function aJ(n,t){if(1&n){const e=ht();ee(0,"button",11),Re("click",function(){ze(e);const r=_e().$implicit;return _e().play(r)}),we(1,"\u8a66\u8074/\u518d\u751f"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function lJ(n,t){if(1&n){const e=ht();ee(0,"button",11),Re("click",function(){return ze(e),_e(2).stop()}),we(1,"\u8a66\u8074/\u505c\u6b62"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function cJ(n,t){if(1&n){const e=ht();ee(0,"button",11),Re("click",function(){ze(e);const r=_e().$implicit;return _e().playBGM(r)}),we(1,"BGM/\u518d\u751f"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function uJ(n,t){if(1&n){const e=ht();ee(0,"button",11),Re("click",function(){ze(e);const r=_e().$implicit;return _e().stopBGM(r)}),we(1,"BGM/\u505c\u6b62"),ce()}2&n&&oe("disabled",!_e().$implicit.isReady)}function dJ(n,t){1&n&&(ee(0,"span"),we(1,"\u3010\u8a66\u8074\u4e2d\u3011"),ce())}function fJ(n,t){1&n&&(ee(0,"span"),we(1,"\u3010BGM\u3011"),ce())}function hJ(n,t){if(1&n&&(ee(0,"div",12),Se(1,aJ,2,1,"button",4),Se(2,lJ,2,1,"button",4),Se(3,cJ,2,1,"button",4),Se(4,uJ,2,1,"button",4),Se(5,dJ,2,0,"span",6),Se(6,fJ,2,0,"span",6),ee(7,"span"),we(8),ce(),nt(9,"br"),ce()),2&n){const e=t.$implicit,i=_e();W(1),oe("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),W(1),oe("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),W(1),oe("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),W(1),oe("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),W(1),oe("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),W(1),oe("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),W(2),Ct(e.name)}}function gJ(n,t){1&n&&(ee(0,"div"),we(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),ce())}let pJ=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.ngZone=o,this.roomVolumeChange=!1,this.auditionPlayer=new Qt,this.lazyUpdateTimer=null}get roomVolume(){let e=Xe.instance.get("Config");return e?e.roomVolume:1}set roomVolume(e){let i=Xe.instance.get("Config");i&&(i.roomVolume=e),this.jukebox.setNewVolume()}get volume(){return this.jukebox.volume}set volume(e){this.jukebox.volume=e,Qt.volume=e*this.roomVolume,Qe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get auditionVolume(){return this.jukebox.auditionVolume}set auditionVolume(e){this.jukebox.auditionVolume=e,Qt.auditionVolume=e*this.roomVolume,Qe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Xe.instance.get("Jukebox")}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Rf.AUDITION,Qe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Qe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.cutInLauncher.stopBlankTagCutIn(),this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&yl.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}openCutInList(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(oJ,{left:e.x+25,top:e.y+25,width:650,height:740})}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(Di),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-jukebox"]],decls:39,vars:8,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModel","ngModelChange"],["type","range","min","0","max","2","step","0.01",3,"ngModel","disabled","ngModelChange"],[2,"font-size","12px"],["type","checkbox","id","roomVolumeChange","value","roomVolumeChange",3,"ngModel","ngModelChange"],[3,"disabled","click",4,"ngIf"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[3,"disabled","click"],[1,"box"]],template:function(e,i){1&e&&(ee(0,"div"),we(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),ee(2,"input",0),Re("ngModelChange",function(o){return i.auditionVolume=o}),ce()(),ee(3,"div"),we(4,"BGM\u97f3\u91cf\uff1a"),ee(5,"input",0),Re("ngModelChange",function(o){return i.volume=o}),ce()(),nt(6,"hr"),ee(7,"div"),we(8,"\u5168\u4f53\u97f3\u91cf\uff1a"),ee(9,"input",1),Re("ngModelChange",function(o){return i.roomVolume=o}),ce(),nt(10,"br"),ee(11,"font",2),we(12,"\u203b\u5168\u30d7\u30ec\u30a4\u30e4\u30fc\u5171\u901a GM\u5236\u5fa1\u7528\uff1a\u5909\u66f4\u3092\u6709\u52b9\u306b\u3059\u308b"),ee(13,"input",3),Re("ngModelChange",function(o){return i.roomVolumeChange=o}),ce()()(),nt(14,"hr"),Se(15,sJ,2,1,"button",4),nt(16,"hr"),ee(17,"div"),Se(18,hJ,10,7,"div",5),Se(19,gJ,2,0,"div",6),ce(),ee(20,"label")(21,"div",7)(22,"div")(23,"i",8),we(24,"playlist_add"),ce()(),ee(25,"div"),we(26,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),ce(),ee(27,"div",9),we(28,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ce(),ee(29,"input",10),Re("change",function(o){return i.handleFileSelect(o)}),ce(),ee(30,"div",9),nt(31,"br"),we(32,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),ce()()(),ee(33,"div",2),we(34,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),ce(),ee(35,"div",2),we(36,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),ce(),ee(37,"div",2),we(38,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),ce()),2&e&&(W(2),oe("ngModel",i.auditionVolume),W(3),oe("ngModel",i.volume),W(4),sn("disabled",!i.roomVolumeChange),oe("ngModel",i.roomVolume),W(4),oe("ngModel",i.roomVolumeChange),W(2),oe("ngIf",1),W(3),oe("ngForOf",i.audios),W(1),oe("ngIf",i.audios.length<1))},directives:[oa,Fi,Ti,yi,ra,Sn,oi],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),n})();const _J=["content"],mJ=["*"];let $J=(()=>{class n{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return n.\u0275fac=function(e){return new(e||n)(Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&Gn(_J,7,us),2&e){let r;yn(r=Cn())&&(i.content=r.first)}},ngContentSelectors:mJ,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(V_(),ee(0,"div",0)(1,"div",1),Re("click",function(o){return i.clickBackground(o)}),ce(),ee(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Re("click",function(){return i.resolve()}),ee(6,"i",6),we(7,"close"),ce()()(),we(8),ce(),ee(9,"div",7),j_(10),nt(11,"div",null,8),ce()()()),2&e&&(W(1),oe("@bgInOut","in"),W(1),oe("@flyInOut","in"),W(6),ln(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;top:0;bottom:0;left:0;right:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Na("flyInOut",[Br("void => *",[Or("100ms ease-out",Ns([mn({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),mn({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Br("* => void",[Or(100,mn({transform:"scale(0, 0)"}))])]),Na("bgInOut",[ox("in",mn({"background-color":"rgba(30, 30, 30, 0.4)"})),Br("void => *",[mn({"background-color":"rgba(30, 30, 30, 0.0)"}),Or(200)]),Br("* => void",[Or(200,mn({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),n})();const vJ=["passwordInput"],bJ=function(){return{standalone:!0}};let yJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=zi.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return $t.peerId}get isConnected(){return!($t.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),Qe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Qe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&Gn(vJ,7),2&e){let r;yn(r=Cn())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",1,"is-caret",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(ee(0,"form",null,0)(2,"div"),we(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),ee(4,"input",1,2),Re("ngModelChange",function(o){return i.password=o})("input",function(o){return i.onInputChange(o.target.value)}),ce()(),ee(6,"button",3),Re("click",function(){return i.submit()}),we(7,"\u5165\u5ba4"),ce()(),ee(8,"div")(9,"span",4),we(10),ce()()),2&e&&(W(4),oe("ngModel",i.password)("ngModelOptions",mr(3,bJ)),W(6),Ct(i.help))},directives:[ps,gs,yo,Fi,Ti,yi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();function CJ(n,t){if(1&n&&(ee(0,"div")(1,"div",9),we(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ce(),ee(3,"div",9),we(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ce(),ee(5,"div",9),we(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ce()()),2&n){_e();const e=an(4);W(1),oe("hidden",!e.errors.required),W(2),oe("hidden",!e.errors.minlength),W(2),oe("hidden",!e.errors.maxlength)}}function xJ(n,t){if(1&n&&(ee(0,"div")(1,"div",9),we(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ce()()),2&n){_e();const e=an(8);W(1),oe("hidden",!e.errors.maxlength)}}function wJ(n,t){1&n&&(ee(0,"div"),we(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),ce())}function EJ(n,t){if(1&n){const e=ht();ee(0,"div")(1,"div"),we(2,"\u30eb\u30fc\u30e0\u540d : "),ee(3,"input",3,4),Re("input",function(r){ze(e);const o=_e();return o.calcPeerId(r.target.value,o.password)})("ngModelChange",function(r){return ze(e),_e().roomName=r}),ce()(),ee(5,"div"),we(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),ee(7,"input",5,6),Re("input",function(r){ze(e);const o=_e();return o.calcPeerId(o.roomName,r.target.value)})("ngModelChange",function(r){return ze(e),_e().password=r}),ce()(),nt(9,"hr"),Se(10,CJ,7,3,"div",7),Se(11,xJ,3,1,"div",7),Se(12,wJ,2,0,"div",7),ee(13,"div")(14,"button",8),Re("click",function(){return ze(e),_e().createRoom()}),we(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),ce()()()}if(2&n){const e=an(4),i=an(8),r=_e();W(3),oe("ngModel",r.roomName),W(4),oe("ngModel",r.password),W(3),oe("ngIf",e.errors&&(e.dirty||e.touched)),W(1),oe("ngIf",i.errors&&(i.dirty||i.touched)),W(1),oe("ngIf",!r.validateLength),W(2),oe("disabled",!e.valid||!i.valid||!r.validateLength)}}function TJ(n,t){1&n&&(ee(0,"span",1),we(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),nt(2,"br"),we(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),nt(4,"br"),we(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ce())}let SJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return $t.peerId}get isConnected(){return!($t.peerIds.length<=1)}get myPeer(){return _t.myCursor}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Qe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Qe.unregister(this)}calcPeerId(e,i){let r=$t.peerContext?$t.peerContext.userId:zi.generateId(),o=zi.create(r,zi.generateId("***"),e,i);this.validateLength=o.peerId.length<64,this.myPeer.reConnectPass=i}createRoom(){let e=$t.peerContext?$t.peerContext.userId:zi.generateId();$t.open(e,zi.generateId("***"),this.roomName,this.password),_t.myCursor.peerId=$t.peerId,this.myPeer.reConnectPass=this.password,this.modalService.resolve()}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Se(0,EJ,16,6,"div",0),ee(1,"div")(2,"span",1),we(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ce()(),Se(4,TJ,6,0,"ng-template",null,2,zn)),2&e){const r=an(5);oe("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[Sn,Fi,a1,ix,rx,Ti,yi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),n})();function DJ(n,t){1&n&&(ee(0,"td")(1,"i",11),we(2,"lock"),ce()())}function IJ(n,t){1&n&&(ee(0,"td"),we(1,"-"),ce())}function kJ(n,t){if(1&n){const e=ht();ee(0,"button",12),Re("click",function(){ze(e);const r=_e().$implicit;return _e(3).connect(r.peerContexts)}),we(1,"\u63a5\u7d9a"),ce()}if(2&n){const e=_e().$implicit,i=_e(3);oe("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function MJ(n,t){if(1&n&&(Je(0),ee(1,"tr")(2,"td",9),we(3),ce(),ee(4,"td",7),we(5),ce(),Se(6,DJ,3,0,"td",4),Se(7,IJ,2,0,"td",4),ee(8,"td"),we(9),ce(),ee(10,"td"),Se(11,kJ,2,1,"button",10),ce()(),et()),2&n){const e=t.$implicit;W(3),Ct(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),W(2),Ct(e.roomName),W(1),oe("ngIf",e.peerContexts[0].hasPassword),W(1),oe("ngIf",!e.peerContexts[0].hasPassword),W(2),ln("",e.peerContexts.length,"\u4eba"),W(2),oe("ngIf",0<e.alias.length)}}function AJ(n,t){if(1&n&&(Je(0),ee(1,"table",6)(2,"tr")(3,"th"),we(4,"\u30eb\u30fc\u30e0ID"),ce(),ee(5,"th",7),we(6,"\u30eb\u30fc\u30e0\u540d"),ce(),ee(7,"th"),we(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),ce(),ee(9,"th"),we(10,"\u53c2\u52a0\u8005"),ce(),nt(11,"th"),ce(),Se(12,MJ,12,6,"ng-container",8),ce(),et()),2&n){const e=_e(2);W(12),oe("ngForOf",e.rooms)}}function PJ(n,t){if(1&n&&(ee(0,"span",13),we(1),ce()),2&n){const e=_e(2);W(1),Ct(e.help)}}function FJ(n,t){if(1&n){const e=ht();ee(0,"div")(1,"button",2),Re("click",function(){return ze(e),_e().reload()}),we(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),ce(),ee(3,"button",3),Re("click",function(){return ze(e),_e().showRoomSetting()}),we(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),ce(),nt(5,"hr"),Se(6,AJ,13,1,"ng-container",4),Se(7,PJ,2,1,"span",5),ce()}if(2&n){const e=_e();W(1),oe("disabled",e.isReloading),W(5),oe("ngIf",e.rooms.length),W(1),oe("ngIf",e.rooms.length<1)}}function RJ(n,t){1&n&&(ee(0,"span",13),we(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),nt(2,"br"),we(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ce())}let NJ=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return $t.peerContext.roomId}get peerId(){return $t.peerId}get isConnected(){return!($t.peerIds.length<=1)}get myPeer(){return _t.myCursor}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Qe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",$t.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+$t.peerContext.roomName+"/"+$t.peerContext.roomId+"\uff1e")}ngOnDestroy(){Qe.unregister(this)}reload(){var e=this;return(0,xn.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield $t.listAllPeers();for(let o of r){let s=zi.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,xn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=yield i.modalService.open(yJ,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==o&&(o=""),i.myPeer.reConnectPass=o),!r.verifyPassword(o))return;let s=$t.peerContext?$t.peerContext.userId:zi.generateId();$t.open(s,r.roomId,r.roomName,o),_t.myCursor.peerId=$t.peerId;let a=[];Qe.register(a).on("OPEN_NETWORK",g=>{console.log("LobbyComponent OPEN_PEER",g.data.peerId),Qe.unregister(a),Xe.instance.clearDeleteHistory();for(let w of e)$t.connect(w.peerId);Qe.register(a).on("CONNECT_PEER",w=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",w.data.peerId),a.push(w.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",w=>{console.warn("\u63a5\u7d9a\u5931\u6557",w.data.peerId),a.push(w.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){$t.peerContexts.length<1&&($t.open(),_t.myCursor.peerId=$t.peerId)}closeIfConnected(){0<$t.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,xn.Z)(function*(){yield e.modalService.open(SJ,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Se(0,FJ,8,3,"div",0),Se(1,RJ,4,0,"ng-template",null,1,zn)),2&e){const r=an(2);oe("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[Sn,oi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),n})();function OJ(n,t){1&n&&(ee(0,"span",6),we(1,"STEP1"),ce())}function BJ(n,t){1&n&&(ee(0,"span",7),we(1,"STEP1"),ce())}function LJ(n,t){1&n&&(ee(0,"span",6),we(1,"STEP2"),ce())}function zJ(n,t){1&n&&(ee(0,"span",7),we(1,"STEP2"),ce())}let UJ=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.rooms=[],this.isReloading=!1,this.isDisconnect=!1,this.networkService=$t,this.roomName="",this.roomId=""}get myPeer(){return _t.myCursor}get currentRoom(){return $t.peerContext.roomId}get peerId(){return $t.peerId}get isConnected(){return!($t.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),this.networkService.peerContext.isRoom&&(this.roomName=this.networkService.peerContext.roomName,this.roomId=this.networkService.peerContext.roomId),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u518d\u63a5\u7d9a",this.modalService.title=this.panelService.title="\uff1c"+this.roomName+"/"+this.roomId+"\uff1e"}ngOnDestroy(){}reConnect(){this.disConnect(),this.deleteObject(),this.isDisconnect=!0}reConnect2(){if(this.isDisconnect){for(let e of this.rooms)if(e.alias==this.roomId+this.roomName)return this.connect(e.peerContexts),void console.log("\u518d\u63a5\u7d9a\u6210\u529f");console.log("\u518d\u63a5\u7d9a\u5931\u6557")}}reload(){var e=this;return(0,xn.Z)(function*(){console.log("async reload()"),e.isReloading=!0,e.rooms=[];let i={},r=yield $t.listAllPeers();for(let o of r){let s=zi.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.isReloading=!1})()}connect(e){var i=this;return(0,xn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=i.myPeer.reConnectPass,null==o&&(o="")),!r.verifyPassword(o))return;let s=$t.peerContext?$t.peerContext.userId:zi.generateId();$t.open(s,r.roomId,r.roomName,o),_t.myCursor.peerId=$t.peerId;let a=[];Qe.register(a).on("OPEN_NETWORK",g=>{console.log("LobbyComponent OPEN_PEER",g.data.peerId),Qe.unregister(a),Xe.instance.clearDeleteHistory();for(let w of e)$t.connect(w.peerId);Qe.register(a).on("CONNECT_PEER",w=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",w.data.peerId),a.push(w.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",w=>{console.warn("\u63a5\u7d9a\u5931\u6557",w.data.peerId),a.push(w.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Qe.unregister(a),i.closeIfConnected())})})})()}cancel(){this.modalService.resolve()}resetNetwork(){$t.peerContexts.length<1&&($t.open(),_t.myCursor.peerId=$t.peerId)}closeIfConnected(){0<$t.peerContexts.length&&this.modalService.resolve()}disConnect(){console.log("\u5207\u65ad"),console.log("\u63a5\u7d9a\u6570 A:"+this.networkService.peerIds.length),this.networkService.connectionClose(),console.log("\u63a5\u7d9a\u6570 B:"+this.networkService.peerIds.length),console.log("\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u72b6\u614b:"+this.networkService.isOpen),console.log("\u518d\u63a5\u7d9a\u6311\u6226:"+this.networkService.open()),console.log("\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u72b6\u614b:"+this.networkService.isOpen)}deleteObject(){console.log("\u5207\u65ad\u5143\u3068\u4e0d\u4e00\u81f4\u306b\u306a\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u524a\u9664");let e=Xe.instance.getObjects(Bt);for(let g of e)g.setLocation("graveyard"),this.deleteGameObject(g);let i=Xe.instance.getObjects(rr);for(let g of i)g.setLocation("graveyard"),this.deleteGameObject(g);let r=Xe.instance.getObjects(Xo);for(let g of r)g.setLocation("graveyard"),this.deleteGameObject(g);let o=Xe.instance.getObjects(zs);for(let g of o)g.setLocation("graveyard"),this.deleteGameObject(g);let s=Xe.instance.getObjects(So);for(let g of s)g.setLocation("graveyard"),this.deleteGameObject(g);let a=Xe.instance.getObjects(go);for(let g of a)g.setLocation("graveyard"),this.deleteGameObject(g);Xe.instance.clearDeleteHistory()}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}logCrear(){console.log("\u524a\u9664\u3057\u305f\u8a18\u9332\u3092\u6d88\u53bb"),Xe.instance.clearDeleteHistory()}deleteList(){console.log("\u524a\u9664\u3057\u305f\u8a18\u9332\u3092\u8868\u793a"),Xe.instance.dispGarbageMap()}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["re-connect"]],decls:40,vars:6,consts:[[3,"click"],["style","color: #bbb;",4,"ngIf"],["style","color: #000;",4,"ngIf"],[1,"danger",3,"disabled","click"],[2,"font-size","16px"],["color","red"],[2,"color","#bbb"],[2,"color","#000"]],template:function(e,i){1&e&&(ee(0,"div"),we(1," \u203b\u8a66\u9a13\u7684\u6a5f\u80fd\u3067\u3059"),nt(2,"br"),ee(3,"button",0),Re("click",function(){return i.cancel()}),we(4,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce(),we(5,"\xa0\xa0\xa0\xa0 "),Se(6,OJ,2,0,"span",1),Se(7,BJ,2,0,"span",2),ee(8,"button",3),Re("click",function(){return i.reConnect()}),we(9,"\u5207\u65ad\u5b9f\u884c"),ce(),we(10,"\uff1e "),Se(11,LJ,2,0,"span",1),Se(12,zJ,2,0,"span",2),ee(13,"button",3),Re("click",function(){return i.reConnect2()}),we(14,"\u518d\u63a5\u7d9a\u5b9f\u884c"),ce(),nt(15,"hr"),ce(),ee(16,"span",4),we(17,"\n\u753b\u50cf\u3084\u97f3\u697d\u306e\u518d\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u884c\u308f\u305a\u9ad8\u901f\u306b\u90e8\u5c4b\u306b\u518d\u63a5\u7d9a\u3057\u307e\u3059\u3002"),nt(18,"br"),we(19,"\n\u305f\u3060\u3057\u3001\u78ba\u5b9f\u306b\u6210\u529f\u3059\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002"),nt(20,"br"),we(21,"\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f\u3001\u5f93\u6765\u3069\u304a\u308a\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u6700\u521d\u304b\u3089\u306e\u63a5\u7d9a\u3092\u8a66\u307f\u3066\u304f\u3060\u3055\u3044\u3002"),nt(22,"br"),ee(23,"font",5),we(24,"\u6ce8\u610f\uff1a\u4ed6\u306b\u90e8\u5c4b\u30c7\u30fc\u30bf\u306e\u4fdd\u6301\u8005\u304c\u5c45\u306a\u3044\u5834\u5408\u3001\u30c7\u30fc\u30bf\u304c\u7834\u68c4\u3055\u308c\u305f\u4e0a\u306b\u5931\u6557\u3057\u307e\u3059\u3002"),nt(25,"br"),we(26,"\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u90e8\u5c4b\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u3092\u884c\u3063\u3066\u304b\u3089\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ce(),nt(27,"br")(28,"br"),we(29,"\nSTEP1\u30012\u306e\u9806\u3067\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),nt(30,"br")(31,"br"),we(32,"\nSTEP1\uff1a\u65e2\u5b58\u306e\u63a5\u7d9a\u3092\u5207\u65ad\u3057\u3001\u540c\u671f\u304c\u53d6\u308c\u306a\u304f\u306a\u3063\u305f\u53ef\u80fd\u6027\u306e\u3042\u308b\u8981\u7d20\u3092\u524a\u9664\u3057\u307e\u3059\u3002"),nt(33,"br"),we(34,"\nSTEP2\uff1a\u30eb\u30fc\u30e0\u306b\u518d\u5ea6\u63a5\u7d9a\u3057\u3001\u30c7\u30fc\u30bf\u540c\u671f\u306e\u56de\u5fa9\u3092\u8a66\u307f\u307e\u3059\u3002"),nt(35,"br")(36,"br"),we(37,"\nSTEP2\u306f1\u5ea6\u306e\u8a66\u307f\u3067\u6210\u529f\u3057\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002"),nt(38,"br"),we(39,"\nSTEP2\u3092\u8907\u6570\u56de\u8a66\u307f\u3066\u3082\u5fa9\u5e30\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3057\u3001\u90e8\u5c4b\u306b\u5165\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n"),ce()),2&e&&(W(6),oe("ngIf",i.isDisconnect),W(1),oe("ngIf",!i.isDisconnect),W(1),oe("disabled",i.isDisconnect),W(3),oe("ngIf",!i.isDisconnect),W(1),oe("ngIf",i.isDisconnect),W(1),oe("disabled",!i.isDisconnect))},directives:[Sn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),n})(),Zm=(()=>{class n{constructor(){}createGameCharacter(e){let i=Bt.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=So.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createGameTableScratchMask(e){let i=this.getViewTable();if(!i)return;let r=Do.create("\u30b9\u30af\u30e9\u30c3\u30c1\u30de\u30b9\u30af",10,10,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=xt.instance.get(i);r||(r=xt.instance.add(i),en.create(r.identifier).tag="\u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=go.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Xo.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=zs.create(i,r,1),a=null;return s.faces.forEach(g=>{let w=`./assets/images/dice/${o}/${o}[${g}].png`;a=xt.instance.get(w),a||(a=xt.instance.add(w)),s.imageDataElement.getFirstElementByName(g).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createRangeArea(e,i){let r;switch(i){case"LINE":r=rr.create("\u5c04\u7a0b\u7bc4\u56f2",1,10,100);break;case"CIRCLE":case"SQUARE":case"DIAMOND":r=rr.create("\u5c04\u7a0b\u7bc4\u56f2",6,6,100);break;default:r=rr.create("\u5c04\u7a0b\u7bc4\u56f2",5,5,100)}r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i;let o=r.commonDataElement.getFirstElementByName("opacity");return console.log("\u5c04\u7a0b\u7bc4\u56f2TEST"+o),o.currentValue=60,r}createTrump(e){let i=xr.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!xt.instance.get(r)){const a=xt.instance.add(r);en.create(a.identifier).tag="\u30c8\u30e9\u30f3\u30d7"}let o=["c","d","h","s"],s=[];for(let a of o)for(let g=1;g<=13;g++)s.push(a+("00"+g).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let g="./assets/images/trump/"+a+".gif";if(!xt.instance.get(g)){const G=xt.instance.add(g);en.create(G.identifier).tag="\u30c8\u30e9\u30f3\u30d7"}let w=Qr.create("\u30ab\u30fc\u30c9",g,r);i.putOnBottom(w)}return i}makeDefaultTable(){let e=new da("tableSelecter");e.initialize();let i=new Jr("gameTable"),r=null,o=Ot.createEmpty("testTableBackgroundImage_image").toContext();o.url="./assets/images/BG10a_80.jpg",r=xt.instance.add(o),en.create(r.identifier).tag="\u80cc\u666f",i.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",i.imageIdentifier=r.identifier,i.width=20,i.height=15,i.initialize(),e.viewTableIdentifier=i.identifier}addBuffRound(e,i,r,o){if(e.buffDataElement.children)for(let s of e.buffDataElement.children)return void s.appendChild(yt.create(i,o,{type:"numberResource",currentValue:r},i+"_"+e.identifier))}initAprilDiceImage(){let e=null,i=null;i=Ot.createEmpty("1d4_dice[00]").toContext(),i.url="./assets/images/april_dice/1d4_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d4_dice[01]").toContext(),i.url="./assets/images/april_dice/1d4_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d4_dice[02]").toContext(),i.url="./assets/images/april_dice/1d4_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d4_dice[03]").toContext(),i.url="./assets/images/april_dice/1d4_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d6_dice[00]").toContext(),i.url="./assets/images/april_dice/1d6_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d6_dice[01]").toContext(),i.url="./assets/images/april_dice/1d6_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d6_dice[02]").toContext(),i.url="./assets/images/april_dice/1d6_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d6_dice[03]").toContext(),i.url="./assets/images/april_dice/1d6_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("2d6_dice[00]").toContext(),i.url="./assets/images/april_dice/2d6_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("2d6_dice[01]").toContext(),i.url="./assets/images/april_dice/2d6_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("2d6_dice[02]").toContext(),i.url="./assets/images/april_dice/2d6_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("2d6_dice[03]").toContext(),i.url="./assets/images/april_dice/2d6_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d8_dice[00]").toContext(),i.url="./assets/images/april_dice/1d8_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d8_dice[01]").toContext(),i.url="./assets/images/april_dice/1d8_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d8_dice[02]").toContext(),i.url="./assets/images/april_dice/1d8_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d8_dice[03]").toContext(),i.url="./assets/images/april_dice/1d8_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d10_dice[00]").toContext(),i.url="./assets/images/april_dice/1d10_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d10_dice[01]").toContext(),i.url="./assets/images/april_dice/1d10_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d10_dice[02]").toContext(),i.url="./assets/images/april_dice/1d10_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d10_dice[03]").toContext(),i.url="./assets/images/april_dice/1d10_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d12_dice[00]").toContext(),i.url="./assets/images/april_dice/1d12_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d12_dice[01]").toContext(),i.url="./assets/images/april_dice/1d12_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d12_dice[02]").toContext(),i.url="./assets/images/april_dice/1d12_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d12_dice[03]").toContext(),i.url="./assets/images/april_dice/1d12_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d20_dice[00]").toContext(),i.url="./assets/images/april_dice/1d20_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d20_dice[01]").toContext(),i.url="./assets/images/april_dice/1d20_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d20_dice[02]").toContext(),i.url="./assets/images/april_dice/1d20_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d20_dice[03]").toContext(),i.url="./assets/images/april_dice/1d20_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d100_dice[00]").toContext(),i.url="./assets/images/april_dice/1d100_dice[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d100_dice[01]").toContext(),i.url="./assets/images/april_dice/1d100_dice[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d100_dice[02]").toContext(),i.url="./assets/images/april_dice/1d100_dice[02].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("1d100_dice[03]").toContext(),i.url="./assets/images/april_dice/1d100_dice[03].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("april[00]").toContext(),i.url="./assets/images/april/april[00].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04",i=Ot.createEmpty("april[01]").toContext(),i.url="./assets/images/april/april[01].png",e=xt.instance.add(i),en.create(e.identifier).tag="\u30b7\u30b9\u30c6\u30e0\u4e88\u7d04"}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Bt("testCharacter_1"),r=Ot.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=xt.instance.add(r),e.location.x=250,e.location.y=450,e.initialize(),en.create(i.identifier).tag="\u30e2\u30f3\u30b9\u30bf\u30fc",e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),this.addBuffRound(e,"\u30c6\u30b9\u30c8\u30d0\u30d51","\u9632+1",3),e=new Bt("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Bt("testCharacter_3"),r=Ot.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=xt.instance.add(r),e.location.x=200,e.location.y=100,e.initialize(),i=xt.instance.add(r),en.create(i.identifier).tag="\u30e2\u30f3\u30b9\u30bf\u30fc",e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Bt("testCharacter_4"),r=Ot.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=xt.instance.add(r),en.create(i.identifier).tag="",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),this.addBuffRound(e,"\u30c6\u30b9\u30c8\u30d0\u30d52","\u653b\u6483+10",1),e=new Bt("testCharacter_5"),r=Ot.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=xt.instance.add(r),e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),this.addBuffRound(e,"\u30c6\u30b9\u30c8\u30d0\u30d52","\u653b\u6483+10",1),e=new Bt("testCharacter_6"),r=Ot.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=xt.instance.add(r),en.create(i.identifier).tag="",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier),this.addBuffRound(e,"\u30c6\u30b9\u30c8\u30d0\u30d53","",3),e=new Bt("testCharacter_7"),r=Ot.createEmpty("testCharacter_7_image").toContext(),r.url="./assets/images/ninja.png",i=xt.instance.add(r),en.create(i.identifier).tag="",e.initialize(),e.location.x=500,e.location.y=250,e.createTestGameDataElementCheckTable("\u5fcd\u8005A",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),mt.play(ut.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),mt.play(ut.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),mt.play(ut.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),mt.play(ut.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),mt.play(ut.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"D4",diceName:"D4",type:ho.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:ho.D6,imagePathPrefix:"6_dice"},{menuName:"D8",diceName:"D8",type:ho.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:ho.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:ho.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:ho.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:ho.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),mt.play(ut.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u30b3\u30fc\u30f3",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),mt.play(ut.dicePut)}})}),{name:"\u5c04\u7a0b\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return da.instance.viewTable}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function HJ(n,t){if(1&n){const e=ht();ee(0,"div")(1,"button",11),Re("click",function(){return ze(e),_e().changeIcon()}),we(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),ce()()}}function VJ(n,t){if(1&n){const e=ht();ee(0,"div",13),Re("click",function(){return ze(e),_e(2).changeIcon()}),Ft(1,"safe"),ce()}2&n&&cn("background-image",Nt(1,2,"url("+_e(2).myPeer.image.url+")","style"))}function jJ(n,t){if(1&n&&(Je(0),Se(1,VJ,2,5,"div",12),et()),2&n){const e=_e();W(1),oe("ngIf",e.myPeer.image)}}function GJ(n,t){1&n&&(ee(0,"span"),we(1,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),ce())}function qJ(n,t){if(1&n&&(ee(0,"span",14),we(1),ce()),2&n){const e=_e();W(1),Ct(e.networkService.peerContext.userId)}}function WJ(n,t){1&n&&(ee(0,"span",14),we(1,"???"),ce())}function ZJ(n,t){if(1&n&&(ee(0,"span",14),we(1),ce()),2&n){const e=_e(2);W(1),na("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,"")}}function YJ(n,t){if(1&n&&(ee(0,"span",14),we(1),ce()),2&n){const e=_e(3);W(1),Ct(e.isPasswordVisible?e.networkService.peerContext.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function KJ(n,t){if(1&n){const e=ht();ee(0,"span"),Se(1,YJ,2,1,"span",5),ee(2,"button",15),Re("click",function(){return ze(e),_e(2).togglePasswordVisibility()}),ee(3,"span",16),we(4),ce()()()}if(2&n){const e=_e(2);W(1),oe("ngIf",e.networkService.isOpen),W(3),Ct(e.isPasswordVisible?"visibility":"visibility_off")}}function XJ(n,t){if(1&n){const e=ht();Je(0),ee(1,"button",17),Re("click",function(){return ze(e),_e(2).showReConnect()}),ee(2,"span"),we(3,"\u518d\u63a5\u7d9a"),ce()(),et()}}function QJ(n,t){if(1&n&&(Je(0),nt(1,"hr"),ee(2,"div")(3,"span"),we(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Se(5,ZJ,2,2,"span",5),ce()(),ee(6,"div")(7,"span"),we(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Se(9,KJ,5,2,"span",0),ce()(),ee(10,"div"),Se(11,XJ,4,0,"ng-container",0),ce(),et()),2&n){const e=_e();W(5),oe("ngIf",e.networkService.isOpen),W(4),oe("ngIf",e.networkService.peerContext.hasPassword),W(2),oe("ngIf",e.networkService.peerIds.length>1)}}function JJ(n,t){1&n&&(ee(0,"span"),we(1,"[\u63a5\u7d9a\u4e2d]"),ce())}function eee(n,t){1&n&&(ee(0,"span"),we(1,"\u63a5\u7d9a\u78ba\u8a8d\uff1a[-:--:--]"),ce())}function tee(n,t){if(1&n&&(ee(0,"span"),we(1),Ft(2,"date"),ce()),2&n){const e=_e().$implicit,i=_e();W(1),ln("\u63a5\u7d9a\u78ba\u8a8d\uff1a[",Nt(2,1,i.findPeerTimeReceive(e.peerId),"HH:mm:ss"),"]")}}function nee(n,t){if(1&n&&(ee(0,"span"),we(1),ce()),2&n){const e=_e(2).$implicit,i=_e();W(1),ln("\u5f80\u5fa9\u901a\u4fe1\u6642\u9593\uff1a",i.findPeerTimeLatency(e.peerId),"\u79d2")}}function iee(n,t){if(1&n&&(ee(0,"div"),Se(1,nee,2,1,"span",0),nt(2,"br"),ce()),2&n){const e=_e().$implicit,i=_e();W(1),oe("ngIf",i.findPeerTimeReceive(e.peerId)>0)}}function ree(n,t){if(1&n&&(ee(0,"div")(1,"span"),we(2),ce(),nt(3,"br"),ee(4,"span"),we(5),ce(),nt(6,"br"),ce()),2&n){const e=_e().$implicit,i=_e();W(2),na("\u4f1d\u9001\u6642\u9593+\u6642\u8a08\u8aa4\u5dee\u5408\u8a08\u3000\u53d7\u4fe1\uff1a",i.findPeerTimeDiffDown(e.peerId),"ms \u9001\u4fe1\uff1a",i.findPeerTimeDiffUp(e.peerId),"ms"),W(3),ln("\u76f8\u624b\u306e\u751f\u5b58\u4fe1\u53f7\u5230\u7740\u5272\u5408\uff1a",i.findPeerDegreeOfSuccess(e.peerId),"")}}function oee(n,t){if(1&n&&(ee(0,"div",18)(1,"div"),Se(2,JJ,2,0,"span",0),ee(3,"span"),we(4),ce(),Se(5,eee,2,0,"span",0),Se(6,tee,3,4,"span",0),nt(7,"br"),Se(8,iee,3,1,"div",0),Se(9,ree,7,3,"div",0),ce()()),2&n){const e=t.$implicit,i=_e();W(2),oe("ngIf",!e.isOpen),W(2),na("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"] "),W(1),oe("ngIf",i.findPeerTimeReceive(e.peerId)<=0),W(1),oe("ngIf",i.findPeerTimeReceive(e.peerId)>0),W(2),oe("ngIf",i.dispDetailFlag),W(1),oe("ngIf","\u5186\u67f1_"==i.myPeer.name)}}function see(n,t){if(1&n){const e=ht();Je(0),ee(1,"input",19),Re("ngModelChange",function(r){return ze(e),_e().targetUserId=r}),ce(),ee(2,"button",20),Re("click",function(){return ze(e),_e().connectPeer()}),we(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),ce(),nt(4,"br"),et()}if(2&n){const e=_e();W(1),oe("ngModel",e.targetUserId),W(1),oe("disabled",!e.networkService.isOpen)}}function aee(n,t){if(1&n){const e=ht();ee(0,"button",20),Re("click",function(){return ze(e),_e().showLobby()}),we(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),ce()}2&n&&oe("disabled",!_e().networkService.isOpen)}function lee(n,t){1&n&&(ee(0,"div",10),we(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ce())}function cee(n,t){1&n&&(ee(0,"div",10),we(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),ce())}function uee(n,t){if(1&n&&(Je(0),Se(1,lee,2,0,"div",21),Se(2,cee,2,0,"div",21),et()),2&n){const e=_e();W(1),oe("ngIf",e.networkService.peerContexts.length<1),W(1),oe("ngIf",e.networkService.peerContexts.length<1)}}function dee(n,t){1&n&&(Je(0),ee(1,"div",10),we(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),ce(),ee(3,"div",10)(4,"font",22),we(5,"\u203b\u63a5\u7d9a\u60c5\u5831\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\u30bf\u30d6\u306e\u5909\u66f4\u306f"),nt(6,"br"),we(7,"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u30bf\u30d6\u8a2d\u5b9a\u304b\u3089\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),ce()(),et())}let VP=(()=>{class n{constructor(e,i,r,o,s,a){this.tabletopActionService=e,this.changeDetector=i,this.ngZone=r,this.modalService=o,this.panelService=s,this.appConfigService=a,this.targetUserId="",this.networkService=$t,this.gameRoomService=Xe.instance,this.help="",this.isPasswordVisible=!1,this.disptimer=null,this.dispDetailFlag=!1,this.myTime=0}get myPeer(){return _t.myCursor}get tableSelecter(){return da.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){Qe.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})}),this.disptimer=setInterval(()=>{this.dispInfo()},1e3)}ngOnDestroy(){Qe.unregister(this),this.disptimer=null}changeIcon(){this.modalService.open(Uf).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=zi.create(e);i.isRoom||(Xe.instance.clearDeleteHistory(),$t.connect(i.peerId))}showLobby(){this.modalService.open(NJ,{width:700,height:400,left:0,top:400})}showReConnect(){this.modalService.open(UJ,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerTimeSend(e){const i=_t.findByPeerId(e);return i?i.timestampSend:0}findPeerTimeReceive(e){const i=_t.findByPeerId(e);return i?i.timestampReceive:0}findPeerTimeDiffUp(e){const i=_t.findByPeerId(e);return i?i.timeDiffUp:0}findPeerTimeDiffDown(e){const i=_t.findByPeerId(e);return i?i.timeDiffDown:0}findPeerTimeLatency(e){const i=_t.findByPeerId(e);return i?i?i.timeLatency/1e3:99999:"--"}findPeerDegreeOfSuccess(e){const i=_t.findByPeerId(e);return!i||i.firstTimeSignNo<0?"0/0":i.totalTimeSignNum+"/"+(i.lastTimeSignNo-i.firstTimeSignNo+1)}checkConnect(){console.log("\u81ea\u8eab\u306eUserid:"+this.networkService.peerContext.userId);for(let e of this.networkService.peerContexts)console.log("\u63a5\u7d9a\u5bfe\u8c61ID:"+e.peerId)}dispInfo(){this.myTime=Date.now()}}return n.\u0275fac=function(e){return new(e||n)(Be(Zm),Be(bi),Be(An),Be(hi),Be($n),Be(Mw))},n.\u0275cmp=Xt({type:n,selectors:[["peer-menu"]],decls:39,vars:19,consts:[[4,"ngIf"],[1,"user"],[1,"user_icon"],[1,"user_info"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",1,"is-caret",3,"ngModel","ngModelChange"],["style","font-weight: bold;",4,"ngIf"],["type","number","min","1","max","600",1,"is-caret",3,"ngModel","ngModelChange"],["type","checkbox","value","dispDetailFlag",3,"ngModel","ngModelChange"],["style","font-size: 15px;",4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],[1,"danger",3,"click"],[2,"font-size","15px"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",1,"is-caret",3,"ngModel","ngModelChange"],[3,"disabled","click"],["style","font-size: 12px;",4,"ngIf"],["color","#FF5555"]],template:function(e,i){1&e&&(Se(0,HJ,3,0,"div",0),ee(1,"div",1)(2,"div",2),Se(3,jJ,2,1,"ng-container",0),ce(),ee(4,"div",3),Se(5,GJ,2,0,"span",0),ee(6,"input",4),Re("ngModelChange",function(o){return i.myPeer.name=o}),ce(),nt(7,"br"),ee(8,"span"),we(9,"ID\uff1a"),ce(),Se(10,qJ,2,1,"span",5),Se(11,WJ,2,0,"span",5),nt(12,"br"),ee(13,"div")(14,"span"),we(15,"\u30d6\u30e9\u30a6\u30b6\u6642\u523b\uff1a"),ce(),ee(16,"span"),we(17),Ft(18,"date"),ce()()()(),Se(19,QJ,12,3,"ng-container",0),nt(20,"hr"),ee(21,"div")(22,"span")(23,"input",6),Re("ngModelChange",function(o){return i.myPeer.timeout=o}),ce(),we(24," \u79d2\u4ee5\u4e0a\u901a\u4fe1\u3067\u304d\u306a\u3044\u53c2\u52a0\u8005\u60c5\u5831\u3092\u30c1\u30e3\u30c3\u30c8\u306b\u8868\u793a"),ce(),nt(25,"br"),ee(26,"span"),we(27,"\u8a73\u7d30\u3092\u8868\u793a"),ee(28,"input",7),Re("ngModelChange",function(o){return i.dispDetailFlag=o}),ce()(),nt(29,"br"),ce(),Se(30,oee,10,7,"div",8),ee(31,"div"),Se(32,see,5,2,"ng-container",0),Se(33,aee,2,1,"button",9),ce(),ee(34,"div")(35,"span",10),we(36),ce()(),Se(37,uee,3,2,"ng-container",0),Se(38,dee,8,0,"ng-container",0)),2&e&&(oe("ngIf",i.myPeer),W(3),oe("ngIf",i.myPeer),W(2),oe("ngIf",i.myPeer),W(1),oe("ngModel",i.myPeer.name),W(4),oe("ngIf",i.networkService.isOpen),W(1),oe("ngIf",!i.networkService.isOpen),W(6),Ct(Nt(18,16,i.myTime,"yy/MM/dd HH:mm:ss")),W(2),oe("ngIf",i.networkService.peerContext.isRoom),W(4),oe("ngModel",i.myPeer.timeout),W(5),oe("ngModel",i.dispDetailFlag),W(2),oe("ngForOf",i.networkService.peerContexts),W(2),oe("ngIf",!i.networkService.peerContext.isRoom),W(1),oe("ngIf",i.networkService.peerIds.length<=1),W(3),Ct(i.help),W(1),oe("ngIf",!i.networkService.peerContext.isRoom),W(1),oe("ngIf",i.networkService.peerContext.isRoom))},directives:[Sn,Fi,Ti,yi,Ju,Qu,_s,ra,oi],pipes:[Ii,D2],styles:[".user[_ngcontent-%COMP%]{display:table}.user_icon[_ngcontent-%COMP%]{display:table-cell;vertical-align:top;width:160px}.user_info[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"]}),n})();class fa{constructor(t,e={capture:!1,passive:!1,always:!1}){this.target=t,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(t){let e={x:t.pageX,y:t.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(t))}onTouch(t){let e=t.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=t.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===t.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(t.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(t.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(t),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(t)}}onPointer(t){switch(t.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(t);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(t),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(t),this.cancel()}}onMenu(t){this.onContextMenu&&this.onContextMenu(t)}isSyntheticEvent(t,e=15){for(let i of this.lastPointers)if(i.identifier!==t.identifier&&(t.x-i.x)**2+(t.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let t={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,t)}removeEventListeners(){let t={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,t)}}let GP=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Kt,this.onmove=new Kt,this.onend=new Kt,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():e.stopPropagation()}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=g=>{g.cancelable&&g.preventDefault(),g.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();console.log("current x "+e.x+"  y"+e.y),console.log("correction x "+i.x+"  y"+i.y),this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:wr.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:wr.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(di))},n.\u0275dir=rn({type:n,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),n})();var ki=(()=>(function(n){n.N="n",n.E="e",n.W="w",n.S="s",n.NE="ne",n.NW="nw",n.SE="se",n.SW="sw"}(ki||(ki={})),ki))();class fee{constructor(t,e){this.target=t,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new fa(this.handle),this.target.appendChild(this.handle);let t=this.handle.style;switch(t.position="absolute",t.zIndex="1",t.backgroundColor="transparent",this.type){case ki.N:t.top=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`,t.cursor="ns-resize";break;case ki.E:t.top="0px",t.bottom="0px",t.right=3*-this.width/4+"px",t.width=`${this.width}px`,t.cursor="ew-resize";break;case ki.W:t.top="0px",t.bottom="0px",t.left=3*-this.width/4+"px",t.width=`${this.width}px`,t.cursor="ew-resize";break;case ki.S:t.bottom=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`,t.cursor="ns-resize";break;case ki.NE:t.top=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nesw-resize",t.zIndex="2";break;case ki.NW:t.top=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nwse-resize",t.zIndex="2";break;case ki.SE:t.bottom=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nwse-resize",t.zIndex="2";break;case ki.SW:t.bottom=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.cursor="nesw-resize",t.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let hee=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Kt,this.onmove=new Kt,this.onend=new Kt,this.handleMap=new Map,this.handleTypes=[ki.N,ki.E,ki.W,ki.S,ki.NE,ki.NW,ki.SE,ki.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new fee(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){return this.isDisable||1===e.button||2===e.button?this.cancel():(this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},void e.stopPropagation())}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case ki.N:case ki.S:r.width=0;break;case ki.E:case ki.W:r.height=0}switch(i.type){case ki.SW:r.left=r.width,r.width*=-1;break;case ki.NE:r.top=r.height,r.height*=-1;break;case ki.E:case ki.S:case ki.SE:break;case ki.N:case ki.W:case ki.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:wr.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:wr.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:wr.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:wr.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(di))},n.\u0275dir=rn({type:n,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),n})();const gee=["draggablePanel"],pee=["scrollablePanel"],_ee=["titleBar"],mee=["content"];function $ee(n,t){if(1&n){const e=ht();ee(0,"div",10)(1,"button",11),Re("click",function(){return ze(e),_e().toggleMinimize()}),ee(2,"i",12),we(3,"minimize"),ce()(),ee(4,"button",11),Re("click",function(){return ze(e),_e().toggleFullScreen()}),ee(5,"i",12),we(6,"fullscreen"),ce()(),ee(7,"button",13),Re("click",function(){return ze(e),_e().close()}),ee(8,"i",12),we(9,"close"),ce()()()}if(2&n){const e=_e();W(1),oe("disabled",e.isFullScreen),W(3),oe("disabled",e.isMinimized)}}function vee(n,t){if(1&n&&(Je(0),nt(1,"chat-tachie-img",14),et()),2&n){const e=_e();W(1),oe("chatTabidentifier",e.panelService.chatTab.identifier)("isTilteTop",1)("dispByMouse",e.tachieDispByMouse)}}function bee(n,t){if(1&n&&(Je(0),nt(1,"card-stack-list-img",15),et()),2&n){const e=_e();W(1),oe("cardStackidentifier",e.panelService.cardStack.identifier)}}const yee=function(n){return{"pointer-events-none":n}},Cee=function(n){return{padding:n}},xee=["*"];let qP=(()=>{class n{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1,this.isMinimized=!1,this.tachieDispByMouse=!0,this.timerCheckWindowSize=null}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging}showTachie(e){this.tachieDispByMouse=e}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement,this.timerCheckWindowSize=setInterval(()=>{this.chkeWindowMinSize()},500)}chkeWindowMinSize(){const e=this.panelService.cutInIdentifier;if(!e)return;const i=Xe.instance.get(e);if(!i||!i.videoId)return;let r=this.draggablePanel.nativeElement;console.log("chkeWindowMinSize:"+r.style.width+" H:"+r.style.height);const o=parseInt(r.style.width),s=parseInt(r.style.height);o<i.minSizeWidth(!0)&&(r.style.width=i.minSizeWidth(!0)+"px",console.log("\u30b5\u30a4\u30ba\u88dc\u6b63W")),s<i.minSizeHeight(!0)&&(r.style.height=i.minSizeHeight(!0)+"px",console.log("\u30b5\u30a4\u30ba\u88dc\u6b63H"));const a=window.innerWidth,g=window.innerHeight,w=r.offsetLeft,G=r.offsetTop,me=w+i.minSizeWidth(!0)-a;me>=0&&(r.style.left=(w-me<=0?0:w-me)+"px",console.log("\u306f\u307f\u51fa\u3057\u9632\u6b62\u51e6\u7406\u6a2a"));const ve=G+i.minSizeHeight(!0)-g;ve>=0&&(r.style.top=(G-ve<=0?0:G-ve)+"px",console.log("\u306f\u307f\u51fa\u3057\u9632\u6b62\u51e6\u7406\u7e26"))}toggleMinimize(){if(this.isFullScreen)return;const e=this.panelService.cutInIdentifier;if(e&&Xe.instance.get(e).videoId)return;let i=this.scrollablePanel.nativeElement,r=this.draggablePanel.nativeElement;this.isMinimized?(this.isMinimized=!1,i.style.display=null,this.height=this.preHeight):(this.preHeight=r.offsetHeight,this.isMinimized=!0,i.style.display="none",this.height=this.titleBar.nativeElement.offsetHeight)}toggleFullScreen(){if(this.isMinimized)return;let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}get padding_(){return this.panelService.isCutIn?"0px":"8px"}get isCutIn(){return this.panelService.isCutIn}close(){this.timerCheckWindowSize&&(clearTimeout(this.timerCheckWindowSize),this.timerCheckWindowSize=null),this.timerCheckWindowSize=null,this.panelService&&this.panelService.close()}backGroundSetting(e){return"background: linear-gradient(-30deg, rgba(240,218,189, 0.9), rgba(255, 244, 232, 0.9));"}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(Gn(gee,7),Gn(pee,7),Gn(_ee,7),Gn(mee,7,us)),2&e){let r;yn(r=Cn())&&(i.draggablePanel=r.first),yn(r=Cn())&&(i.scrollablePanel=r.first),yn(r=Cn())&&(i.titleBar=r.first),yn(r=Cn())&&(i.content=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[Ki([$n])],ngContentSelectors:xee,decls:13,vars:21,consts:[["appDraggable","","appResizable","",1,"draggable-panel","no-caret",3,"ngClass","resizable.disable","draggable.stack","mouseenter","mouseleave"],["draggablePanel",""],[1,"title","no-caret"],["titleBar",""],["class","title-button",4,"ngIf"],[4,"ngIf"],[1,"scrollable-panel","no-caret",3,"ngStyle"],["scrollablePanel",""],[1,"no-caret"],["content",""],[1,"title-button"],[3,"disabled","click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[3,"chatTabidentifier","isTilteTop","dispByMouse"],[3,"cardStackidentifier"]],template:function(e,i){1&e&&(V_(),ee(0,"div",0,1),Re("mouseenter",function(){return i.showTachie(!0)})("mouseleave",function(){return i.showTachie(!1)}),ee(2,"div",2,3),Se(4,$ee,10,2,"div",4),we(5),ce(),Se(6,vee,2,3,"ng-container",5),Se(7,bee,2,1,"ng-container",5),ee(8,"div",6,7),j_(10),nt(11,"div",8,9),ce()()),2&e&&(cn("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),oe("@flyInOut","in")("ngClass",Rt(17,yee,i.isPointerDragging))("resizable.disable",i.isMinimized||i.isFullScreen)("draggable.stack",".draggable-panel"),W(4),oe("ngIf","\u30e1\u30cb\u30e5\u30fc"!==i.title),W(1),ln(" ",i.panelService.title," "),W(1),oe("ngIf",i.panelService.chatTab),W(1),oe("ngIf",i.panelService.cardStack),W(1),oe("ngStyle",Rt(19,Cee,i.padding_)))},directives:[GP,hee,nr,Sn,AP,bo],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.cut-in--panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:0;overscroll-behavior:contain}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.title[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{opacity:.3}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.no-caret[_ngcontent-%COMP%]{caret-color:transparent}"],data:{animation:[Na("flyInOut",[Br("void => *",[Or("100ms ease-out",Ns([mn({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),mn({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Br("* => void",[Or(100,mn({transform:"scale(0, 0)"}))])])]}}),n})();const wee=["videoPlayerComponent"];function Eee(n,t){1&n&&(nt(0,"img",5),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e(2).cutIn.cutInImage.url,"resourceUrl"),fn)}const Tee=function(n,t,e,i){return{autoplay:1,controls:0,start:n,loop:t,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function See(n,t){if(1&n){const e=ht();ee(0,"div",1)(1,"youtube-player",2,3),Re("ready",function(r){return ze(e),_e().onPlayerReady(r)})("stateChange",function(r){return ze(e),_e().onPlayerStateChange(r)}),ce(),Se(3,Eee,2,4,"img",4),ce()}if(2&n){const e=_e();sn("id",e.cutInAreaId),W(1),cn("visibility",e.isVisible),oe("videoId",e.videoId)("width",e.youTubeWidth)("height",e.youTubeHeight)("playerVars",Fr(8,Tee,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId)),W(2),oe("ngIf",!e.videoId)}}let Dee=(()=>{class n{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.ngZone=o,this.left=0,this.top=0,this.width=200,this.height=150,this.lazyUpdateTimer=null,this.audioPlayer=new Qt,this.cutInTimeOut=null,this.timerCheckWindowSize=null,this._videoId="",this.videoStateTransition=!1,this.isTest=!1,this.cutIn=null,this.playListId="",this._naturalWidth=0,this._naturalHeight=0}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get cutInLauncher(){return Xe.instance.get("CutInLauncher")}get jukebox(){return Xe.instance.get("Jukebox")}get config(){return Xe.instance.get("Config")}getCutIns(){return Xe.instance.getObjects(Zi)}startCutIn(){if(!this.cutIn)return;console.log("CutInWin "+this.cutIn.name);let e=this.cutIn.audio;e&&(this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)),this.cutIn.outTime>0&&(console.log("outTime "+this.cutIn.outTime),this.cutInTimeOut=setTimeout(()=>{this.cutInTimeOut=null,this.panelService.close()},1e3*this.cutIn.outTime))}stopCutIn(){this.audioPlayer.stop()}ngOnInit(){Qe.register(this).on("START_CUT_IN",e=>{console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6>Event:START_CUT_IN "+this.cutIn.name),this.cutIn&&(this.cutIn.identifier==e.data.cutIn.identifier||this.cutIn.tagName==e.data.cutIn.tagName)&&this.panelService.close()}).on("STOP_CUT_IN_BY_BGM",e=>{if(this.cutIn){console.log(" 'STOP_CUT_IN_BY_BGM :"+this.cutIn);let i=Jt.instance.get(this.cutIn.audioIdentifier);""==this.cutIn.tagName&&i&&this.panelService.close()}}).on("STOP_CUT_IN",e=>{console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6>Event: "+this.cutIn.name),this.cutIn&&this.cutIn.identifier==e.data.cutIn.identifier&&this.panelService.close()})}ngAfterViewInit(){this.cutIn&&setTimeout(()=>{this.moveCutInPos()},0)}moveCutInPos(){if(this.cutIn){let e=this.cutIn.width,i=this.cutIn.height,r=window.innerWidth-e,o=window.innerHeight-i-25;r<0&&(r=0),o<0&&(o=0);let s=r*this.cutIn.x_pos/100,a=o*this.cutIn.y_pos/100;this.width=e,this.height=i+25,this.left=s,this.top=a}else console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u672a\u5b9a\u7fa9\u3067\u518d\u751f\u3055\u308c\u305f");this.panelService.width=this.width,this.panelService.height=this.height,this.panelService.left=this.left,this.panelService.top=this.top}chkeWindowMinSize(){this.videoId&&(console.log("chkeWindowMinSize 1:"+this.panelService.width),this.panelService.width<this.cutIn.minSizeWidth(!0)&&(this.panelService.width=this.cutIn.minSizeWidth(!0)),this.panelService.height<this.cutIn.minSizeHeight(!0)&&(this.panelService.height=this.cutIn.minSizeHeight(!0)),console.log("chkeWindowMinSize 2:"+this.panelService.width))}get videoId(){return this.cutIn?(""==this._videoId&&(this._videoId=this.cutIn.videoId),this._videoId):""}get videoVolume(){return(this.isTest?this.jukebox.auditionVolume:this.jukebox.volume)*this.config.roomVolume*100}get cutInAreaId(){return this.cutIn?this.cutIn.identifier+"_window":""}get youTubeWidth(){return document.getElementById(this.cutInAreaId)?document.getElementById(this.cutInAreaId).clientWidth:640}get youTubeHeight(){return document.getElementById(this.cutInAreaId)?document.getElementById(this.cutInAreaId).clientHeight:340}onPlayerReady(e){e.target.setVolume(this.videoVolume),console.log("ready"),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;console.log(e.data),1==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),0==i&&(this.cutInTimeOut=null,this.panelService.close())}onErrorFallback(){console.log("fallback")}ngOnDestroy(){this.cutInTimeOut&&(clearTimeout(this.cutInTimeOut),this.cutInTimeOut=null),this.stopCutIn(),Qe.unregister(this)}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(bi),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-cut-in-window"]],viewQuery:function(e,i){if(1&e&&Gn(wee,5),2&e){let r;yn(r=Cn())&&(i.videoPlayer=r.first)}},decls:1,vars:1,consts:[["class","cut-in",3,"id",4,"ngIf"],[1,"cut-in",3,"id"],["suggestedQuality","default",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],[3,"src",4,"ngIf"],[3,"src"]],template:function(e,i){1&e&&Se(0,See,4,13,"div",0),2&e&&oe("ngIf",i.cutIn)},directives:[Sn,Nk],pipes:[Ii],styles:[".cut-in[_ngcontent-%COMP%]{padding:0;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%}img[_ngcontent-%COMP%]{width:100%;height:100%}"]}),n})();function Iee(n,t){1&n&&gn(0)}function kee(n,t){1&n&&gn(0)}const Mee=function(){return{box:!0}},Aee=function(n){return{target:n}};function Pee(n,t){if(1&n&&(ee(0,"div",5),Se(1,kee,1,0,"ng-container",6),ce()),2&n){const e=t.$implicit;_e();const i=an(6);oe("ngClass",mr(3,Mee)),W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(4,Aee,e))}}function Fee(n,t){if(1&n){const e=ht();Je(0,11),ee(1,"button",12),Re("click",function(){const o=ze(e).$implicit;return _e(2).voteSend(o)}),we(2),ce(),et()}if(2&n){const e=t.$implicit,i=_e(2);W(1),sn("name",e),sn("id",e),Zt("disabled",i.isMyVoteEnd()?"":null),W(1),na(" ",e,":",i.vote.votedNumByChoice(e),"\u4eba")}}function Ree(n,t){if(1&n&&(ee(0,"form",7)(1,"div",8)(2,"div"),we(3),ce(),ee(4,"div"),we(5),ee(6,"span",9),we(7,"\u203b\u6295\u7968\u524d\u306b\u9589\u3058\u308b\u3068\u68c4\u6a29"),ce()(),ee(8,"div"),Se(9,Fee,3,5,"ng-container",10),ce()()()),2&n){const e=_e();W(3),ln(" ",e.vote.voteTitle," "),W(2),bv(" \u6295\u7968\u6570:",e.vote.votedTotalNum(),"/",e.vote.voteAnswer.length," (\u68c4\u6a29\uff1a",e.vote.votedNumByIndex(-2),")"),W(4),oe("ngForOf",e.vote.choices)}}function Nee(n,t){if(1&n&&(ee(0,"div",21),Ft(1,"safe"),ce()),2&n){const e=_e().target;cn("background-image",Nt(1,2,"url("+_e().findPeerImage(e).url+")","style"))}}function Oee(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e().target,i=_e();W(1),Ct(i.findPeerLastControlName(e))}}function Bee(n,t){1&n&&(Je(0),we(1,"\u64cd\u4f5c\u30ad\u30e3\u30e9\u306a\u3057"),et())}function Lee(n,t){if(1&n&&(ee(0,"div",21),Ft(1,"safe"),ce()),2&n){const e=_e().target;cn("background-image",Nt(1,2,"url("+_e().findPeerLastControlImage(e).url+")","style"))}}function zee(n,t){1&n&&nt(0,"div",22)}function Uee(n,t){1&n&&(Je(0),we(1,"\u672a\u6295\u7968"),et())}function Hee(n,t){1&n&&(Je(0),we(1,"\u68c4\u6a29"),et())}function Vee(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e().target,i=_e();W(1),Ct(i.vote.indexToChoice(i.vote.voteAnswerByPeerId(e)))}}function jee(n,t){if(1&n&&(ee(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),we(4),ce(),ee(5,"div",17),Se(6,Nee,2,5,"div",18),ce()(),ee(7,"div",15)(8,"div",16),Se(9,Oee,2,1,"ng-container",19),Se(10,Bee,2,0,"ng-container",19),ce(),ee(11,"div",17),Se(12,Lee,2,5,"div",18),Se(13,zee,1,0,"div",18),ce()(),ee(14,"div",20),Se(15,Uee,2,0,"ng-container",19),Se(16,Hee,2,0,"ng-container",19),Se(17,Vee,2,1,"ng-container",19),ce()()()),2&n){const e=t.target,i=_e();W(4),ln(" ",i.findPeerName(e)," "),W(2),oe("ngIf",i.findPeerImage(e)),W(3),oe("ngIf",i.findPeerLastControlName(e)),W(1),oe("ngIf",!i.findPeerLastControlName(e)),W(2),oe("ngIf",i.findPeerLastControlImage(e)),W(1),oe("ngIf",!i.findPeerLastControlImage(e)),W(2),oe("ngIf",-1==i.vote.voteAnswerByPeerId(e)),W(1),oe("ngIf",-2==i.vote.voteAnswerByPeerId(e)),W(1),oe("ngIf",i.vote.voteAnswerByPeerId(e)>=0)}}let Gee=(()=>{class n{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.chatMessageService=o,this.ngZone=s,this.timestamp=0,this.timestamp=this.vote.initTimeStamp}get vote(){return Xe.instance.get("Vote")}get answerList(){return this.vote.voteAnswer}numberOfVote(e){const i=this.answerList;let r=0;for(let o of i)o==e&&r++;return r}isMyVoteEnd(){return this.vote.isVoteEnd(_t.myCursor.peerId)}voteSend(e){this.vote.voting(e,_t.myCursor.peerId);let i=this.vote.isRollCall?"\u70b9\u547c\uff1a":"\u6295\u7968\uff1a";i+=e+"("+this.vote.votedTotalNum()+"/"+this.answerList.length+")",this.chatMessageService.sendSystemMessageLastSendCharactor(i)}ngOnInit(){Qe.register(this).on("END_OLD_VOTE",e=>{console.log("\u53e4\u3044\u6295\u7968\u3092\u7d42\u4e86"),this.timestamp!=this.vote.initTimeStamp&&this.panelService.close()})}ngAfterViewInit(){}findUserId(e){const i=_t.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=_t.findByPeerId(e);return i?i.name:""}findPeerLastControlName(e){const i=_t.findByPeerId(e);return i?i.lastControlCharacterName:""}findPeerImage(e){const i=_t.findByPeerId(e);return i?i.image:null}findPeerLastControlImage(e){const i=_t.findByPeerId(e);return i?i.lastControlImage:null}ngOnDestroy(){if(!this.isMyVoteEnd()&&this.timestamp==this.vote.initTimeStamp){this.vote.voting(null,_t.myCursor.peerId);let e=this.vote.isRollCall?"\u70b9\u547c\uff1a":"\u6295\u7968\uff1a";e+="\u68c4\u6a29\u3057\u307e\u3057\u305f("+this.vote.votedTotalNum()+"/"+this.answerList.length+")",this.chatMessageService.sendSystemMessageLastSendCharactor(e)}Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(bi),Be(Eo),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-vote-window"]],decls:7,vars:2,consts:[[1,"component"],[4,"ngTemplateOutlet"],["style","font-size: 15px;",3,"ngClass",4,"ngFor","ngForOf"],["voteTop",""],["voteAnswers",""],[2,"font-size","15px",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"is-sticky-top"],[1,"tab"],[2,"font-size","12px"],["style","font-size: 15px;",4,"ngFor","ngForOf"],[2,"font-size","15px"],[3,"name","id","click"],[1,"inventory-object"],[1,"object-tags-box"],[1,"table-cell"],[1,"object-name"],[1,"image-box"],["class","image cover",3,"background-image",4,"ngIf"],[4,"ngIf"],[1,"table-cell","message"],[1,"image","cover"],[1,"image","cover",3,"background-image"]],template:function(e,i){if(1&e&&(ee(0,"div",0),Se(1,Iee,1,0,"ng-container",1),Se(2,Pee,2,6,"div",2),ce(),Se(3,Ree,10,5,"ng-template",null,3,zn),Se(5,jee,18,9,"ng-template",null,4,zn)),2&e){const r=an(4);W(1),oe("ngTemplateOutlet",r),W(1),oe("ngForOf",i.vote.targetPeerId)}},directives:[Ra,oi,nr,ps,gs,yo,Sn],pipes:[Ii],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:20px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}"]}),n})();function qee(n,t){1&n&&gn(0)}function Wee(n,t){if(1&n&&(ee(0,"form",3)(1,"div",4)(2,"div"),we(3),ce(),ee(4,"div"),we(5),ce()()()),2&n){const e=_e();W(3),ln(" ",e.title," "),W(2),ln(" ",e.time,"\u79d2\u7d4c\u904e\u3057\u307e\u3057\u305f ")}}let Zee=(()=>{class n{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.changeDetectionRef=r,this.chatMessageService=o,this.ngZone=s,this.timestamp=0,this.timestamp=this.alarm.initTimeStamp}get alarm(){return Xe.instance.get("Alarm")}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(bi),Be(Eo),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-alarm-window"]],decls:4,vars:1,consts:[[1,"component"],[4,"ngTemplateOutlet"],["alarmTop",""],[1,"is-sticky-top"],[1,"tab"]],template:function(e,i){if(1&e&&(ee(0,"div",0),Se(1,qee,1,0,"ng-container",1),ce(),Se(2,Wee,6,2,"ng-template",null,2,zn)),2&e){const r=an(3);W(1),oe("ngTemplateOutlet",r)}},directives:[Ra,ps,gs,yo],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border:1px dotted #666}.message[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;vertical-align:middle}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin-left:20px;margin-top:-3px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;max-width:64px;max-height:64px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.image-cover[_ngcontent-%COMP%]{width:100%;height:100%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em;width:120px;overflow:hidden;white-space:nowrap}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}"]}),n})();class WP{constructor(t){this.canvasElement=t}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}render(t,e,i=50,r=$s.SQUARE,o="#000000e6",s=!1,a=0,g=0){this.canvasElement.width=t*i,this.canvasElement.height=e*i;let w=this.canvasElement.getContext("2d");if(r<0)return;let G=s?Math.floor(a/i)+1:0,me=s?Math.floor(g/i)+1:0,ve=this.generateCalcGridPositionFunc(r);this.makeBrush(w,i,o);for(let Ie=0;Ie<=e;Ie++)for(let Oe=0;Oe<=t;Oe++){let{gx:Ve,gy:We}=ve(Oe,Ie,i);this.strokeSquare(w,Ve,We,i);let Ye=0,Ge=0;s&&r==$s.HEX_VERTICAL&&(Ye=me%2==1&&(Oe+1+me)%2==1?-1:0),s&&r==$s.HEX_HORIZONTAL&&(Ge=G%2==1&&(Ie+1+G)%2==1?-1:0),w.fillText((Oe+1+me+Ge).toString()+"-"+(Ie+1+G+Ye).toString(),Ve+i/2,We+i/2)}}generateCalcGridPositionFunc(t){switch(t){case $s.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case $s.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(t,e,i,r){t.beginPath(),t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,o){let s=o===$s.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),g=e+r/2,w=i+r/2;t.beginPath();for(let G=0;G<6;G++){s+=60;let me=Math.PI/180*s,ve=Math.cos(me)*a+g,Ie=Math.sin(me)*a+w;t.lineTo(ve,Ie)}t.closePath(),t.stroke()}}var Hf=(()=>(function(n){n.DRAG="drag",n.ZOOM="zoom",n.ROTATE="rotate",n.KEYBOARD="keyboard"}(Hf||(Hf={})),Hf))(),Wa=(()=>(function(n){n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown"}(Wa||(Wa={})),Wa))();class Yee{constructor(t){this.targetElement=t,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new fa(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(t){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=t.button,this.onstart&&this.onstart(t)}onInputEnd(t){this.onend&&this.onend(t)}onInputMove(t){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,w=0,me=0,ve=Hf.DRAG;2===this.buttonCode?(ve=Hf.ROTATE,me=-r/5,w=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,w,0,me,ve,t)}onWheel(t){let e=0;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*t.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaY*window.innerHeight;break;default:e=t.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Hf.ZOOM,t)}onKeydown(t){let e=0,i=0,r=0,o=0,a=0,g=this.getKeyName(t);switch(g){case Wa.ArrowLeft:t.shiftKey?a=-2:e=10;break;case Wa.ArrowUp:t.shiftKey?o=-2:t.ctrlKey?r=150:i=10;break;case Wa.ArrowRight:t.shiftKey?a=2:e=-10;break;case Wa.ArrowDown:t.shiftKey?o=2:t.ctrlKey?r=-150:i=-10}null!=Wa[g]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Hf.KEYBOARD,t)}getKeyName(t){if(t.key)return t.key;switch(t.keyCode){case 37:return Wa.ArrowLeft;case 38:return Wa.ArrowUp;case 39:return Wa.ArrowRight;case 40:return Wa.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var $d=(()=>(function(n){n.PAN="pan",n.TAP_PINCH="tappinch",n.PINCH="pinch",n.ROTATE="rotate"}($d||($d={})),$d))();class Kee{constructor(t,e){this.targetElement=t,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let t=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([t,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",g=>{let w=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:g.center.x,clientY:g.center.y});this.ngZone.run(()=>g.srcEvent.target.dispatchEvent(w))}))}onHammer(t){t.isFirst?(this.deltaHammerScale=t.scale,this.deltaHammerRotation=t.rotation,this.deltaHammerDeltaX=t.deltaX,this.deltaHammerDeltaY=t.deltaY,this.onstart&&this.onstart(t.srcEvent)):t.isFinal?this.onend&&this.onend(t.srcEvent):(this.deltaHammerScale=t.scale-this.prevHammerScale,this.deltaHammerRotation=t.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=t.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=t.deltaY-this.prevHammerDeltaY),this.prevHammerScale=t.scale,this.prevHammerRotation=t.rotation,this.prevHammerDeltaX=t.deltaX,this.prevHammerDeltaY=t.deltaY,null!=this.tappedPanTimer&&t.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-t.center.x)**2+(this.tappedPanCenter.y-t.center.y)**2&&this.clearTappedPanTimer()}onTap(t){this.tappedPanCenter=t.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(t.srcEvent)}onTappedPanStart(t){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(t.srcEvent))}onTappedPanEnd(t){this.clearTappedPanTimer()}onTappedPanMove(t){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,$d.PAN,t.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,$d.TAP_PINCH,t.srcEvent)}}onPanMove(t){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,$d.ROTATE,t.srcEvent)}onPinchMove(t){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,$d.PINCH,t.srcEvent)}onRotateMove(t){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,$d.ROTATE,t.srcEvent)}clearTappedPanTimer(t=!0){clearTimeout(this.tappedPanTimer),t&&(this.tappedPanTimer=null)}}let vd=(()=>{class n{constructor(e,i,r,o,s){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=o,this.coordinateService=s,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isScratcOwner=!1,this.onstart=new Kt,this.ondragstart=new Kt,this.ondrag=new Kt,this.ondragend=new Kt,this.onend=new Kt,this._posX=0,this._posY=0,this._posZ=0,this.mathFloor=!0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=this.mathFloor?Math.floor(e):e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=this.mathFloor?Math.floor(e):e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=this.mathFloor?Math.floor(8*e)/8:e,this.setUpdateTimer()}get isGridSnap(){return da.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Qe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new fa(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}scratchObjectPosition(e){let i={x:this.input.pointer.x,y:this.input.pointer.y,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);o.x-=this.posX,o.y-=this.posY,Qe.trigger("SCRATCH_POINTER_XYZ",{x:o.x,y:o.y,z:o.z,identifier:this.tabletopObject.identifier,start:e})}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable&&!this.isScratcOwner||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.isScratcOwner&&this.scratchObjectPosition(!0),this.ratio=1}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable&&!this.isScratcOwner||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(o.x-=this.width/2,o.y-=this.height/2,this.posX===o.x&&this.posY===o.y&&this.posZ===o.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.isScratcOwner?this.scratchObjectPosition(!1):(this.posX=o.x,this.posY=o.y,this.posZ=o.z)}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&!this.isScratcOwner&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=this.mathFloor?Math.floor(e.location.x):e.location.x,this._posY=this.mathFloor?Math.floor(e.location.y):e.location.y,this._posZ=this.mathFloor?Math.floor(8*e.posZ)/8:e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&"none"!==getComputedStyle(o).pointerEvents&&this.collidableElements.push(o)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&this.findNestedCollidableElements(o)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){this.nativeElement.style.transform="translate3d("+this.posX+"px,"+this.posY+"px,"+this.posZ+"px) "+this.transformCssOffset}setCollidableLayer(e){let i=e;for(let r in n.layerHash)i=-1<this.colideLayers.indexOf(r)?!this.input.isGrabbing||e:!e,n.layerHash[r].forEach(o=>{o===this||o.input.isGrabbing||o.setPointerEvents(i)})}register(){this.layerName in n.layerHash||(n.layerHash[this.layerName]=[]),n.layerHash[this.layerName].indexOf(this)<0&&n.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in n.layerHash))return;let e=n.layerHash[this.layerName].indexOf(this);-1<e&&n.layerHash[this.layerName].splice(e,1)}}return n.layerHash={},n.\u0275fac=function(e){return new(e||n)(Be(An),Be(di),Be(Fg),Be(Di),Be(md))},n.\u0275dir=rn({type:n,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isScratcOwner:["movable.scratch_owner","isScratcOwner"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),n})(),Vf=(()=>{class n{constructor(e,i,r,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Kt,this.ondragstart=new Kt,this.ondrag=new Kt,this.ondragend=new Kt,this.onend=new Kt,this._rotate=0,this.valueChange=new Kt,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Qe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new fa(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1)}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.tabletopObject instanceof rr&&this.tabletopObject.subDivisionSnapPolygonal&&(e=240),this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return n.\u0275fac=function(e){return new(e||n)(Be(di),Be(Fg),Be(Di),Be(md))},n.\u0275dir=rn({type:n,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),n})();const Xee=["gridCanvas"],ZP=function(n){return{"blinking-animation":n}};function Qee(n,t){if(1&n&&(ee(0,"div",9),Ft(1,"safe"),ce()),2&n){const e=_e(2);cn("background-image",Nt(1,3,"url("+e.floorImage.url+")","style")),oe("ngClass",Rt(6,ZP,!e.isLocked))}}function Jee(n,t){if(1&n&&(Je(0),Se(1,Qee,2,8,"div",8),et()),2&n){const e=_e();W(1),oe("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const YP=function(n,t,e){return{"backface-visibility":n,transform:t,filter:e}};function ete(n,t){if(1&n&&(Je(0),ee(1,"div",10),Ft(2,"safe"),ce(),et()),2&n){const e=_e();W(1),cn("background-image",Nt(2,4,"url("+e.floorImage.url+")","style")),oe("ngClass",Rt(7,ZP,!e.isLocked))("ngStyle",Wo(9,YP,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const vb=function(n,t,e,i){return{"blinking-animation":n,"no-shadow":t,"is-slope":e,"is-inverse-slope":i}};function tte(n,t){if(1&n&&(ee(0,"div",12),Ft(1,"safe"),ce()),2&n){const e=_e(3);cn("background-image",Nt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Fr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function nte(n,t){if(1&n&&(Je(0),Se(1,tte,2,15,"div",11),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isVisibleWallTopBottom)}}function ite(n,t){if(1&n&&(ee(0,"div",14),Ft(1,"safe"),ce()),2&n){const e=_e(3);cn("background-image",Nt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Fr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function rte(n,t){if(1&n&&(Je(0),Se(1,ite,2,15,"div",13),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isVisibleWallTopBottom)}}function ote(n,t){if(1&n&&(ee(0,"div",16),Ft(1,"safe"),ce()),2&n){const e=_e(3);cn("background-image",Nt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Fr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function ste(n,t){if(1&n&&(Je(0),Se(1,ote,2,15,"div",15),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isVisibleWallLeftRight)}}function ate(n,t){if(1&n&&(ee(0,"div",18),Ft(1,"safe"),ce()),2&n){const e=_e(3);cn("background-image",Nt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Fr(10,vb,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function lte(n,t){if(1&n&&(Je(0),Se(1,ate,2,15,"div",17),et()),2&n){const e=_e(2);W(1),oe("ngIf",e.isVisibleWallLeftRight)}}function cte(n,t){if(1&n&&(Je(0),Se(1,nte,2,1,"ng-container",3),Se(2,rte,2,1,"ng-container",3),Se(3,ste,2,1,"ng-container",3),Se(4,lte,2,1,"ng-container",3),et()),2&n){const e=_e();W(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),W(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),W(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),W(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function ute(n,t){1&n&&(Je(0),nt(1,"div",19),ee(2,"div",20)(3,"i",21),we(4,"autorenew"),ce()(),ee(5,"div",22)(6,"i",21),we(7,"autorenew"),ce()(),ee(8,"div",23)(9,"i",21),we(10,"autorenew"),ce()(),ee(11,"div",24)(12,"i",21),we(13,"autorenew"),ce()(),et())}const KP=function(n){return{transform:n}};function dte(n,t){if(1&n&&(ee(0,"div",25)(1,"div",26),we(2),ce(),ee(3,"div",27),we(4),ce()()),2&n){const e=_e();cn("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),oe("ngStyle",Rt(5,KP,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(2),Ct(e.math.abs(e.terreinAltitude)),W(2),Ct(e.math.abs(e.terreinAltitude))}}const fte=function(n){return{"is-grab":n}},hte=function(n,t){return{"upright-transform":n,fall:t}};let gte=(()=>{class n{constructor(e,i,r,o,s,a,g,w,G,me){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=g,this.pointerDeviceService=w,this.coordinateService=G,this.tabletopService=me,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=ji,this.input=null,this.viewRotateZ=10}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=ji.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===ji.NONE?ji.BOTTOM:this.terrain.slopeDirection:ji.NONE}set slopeDirection(e){this.terrain.isSlope=e!=ji.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");i&&(i.roomGridDispAlways=e)}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.terrain||!i||((this.terrain===i||i instanceof Si&&this.terrain.contains(i))&&this.changeDetector.markForCheck(),(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier||e.data.identifier===this.terrain.identifier)&&this.setGameTableGrid(this.width,this.depth,this.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DISP_TERRAIN_GRID",e=>{let i=0;this.terrain.isGrid&&(i=1),this.gridCanvas.nativeElement.style.opacity=i+""}).on("DISP_TERRAIN_GRID_END",e=>{let i=0;this.terrain.isGrid&&(this.roomGridDispAlways&&(i=1),this.tableSelecter.gridShow&&(i=1)),this.gridCanvas.nativeElement.style.opacity=i+""}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setGameTableGrid(this.width,this.depth,this.gridSize,this.currentTable.gridType,this.currentTable.gridColor)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,mt.play(ut.sweep))},altitudeHande:this.terrain},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,mt.play(ut.lock)}},xi,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==ji.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=ji.NONE}},xi,{name:(this.slopeDirection==ji.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=ji.TOP}},{name:(this.slopeDirection==ji.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=ji.BOTTOM}},{name:(this.slopeDirection==ji.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=ji.LEFT}},{name:(this.slopeDirection==ji.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=ji.RIGHT}}]},this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=_d.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=_d.ALL}},this.isSurfaceShading?{name:"\u58c1\u306b\u9670\u5f71\u3092\u4ed8\u3051\u306a\u3044",action:()=>{this.isSurfaceShading=!1,mt.play(ut.sweep)}}:{name:"\u58c1\u306b\u9670\u5f71\u3092\u4ed8\u3051\u308b",action:()=>{this.isSurfaceShading=!0,mt.play(ut.sweep)}},this.isDropShadow?{name:"\u5f71\u3092\u975e\u8868\u793a",action:()=>{this.isDropShadow=!1,mt.play(ut.sweep)}}:{name:"\u5f71\u3092\u8868\u793a",action:()=>{this.isDropShadow=!0,mt.play(ut.sweep)}},xi,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.terrain.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(o),mt.play(ut.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),mt.play(ut.sweep)}},xi,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){mt.play(ut.blockPick)}onMoved(){mt.play(ut.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case ji.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case ji.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case ji.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case ji.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case ji.TOP:e=.4;break;case ji.BOTTOM:e=1;break;case ji.LEFT:e=.6;break;case ji.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-250,top:i.y-150,width:600,height:300}).tabletopObject=e}setGameTableGrid(e,i,r=50,o=$s.SQUARE,s="#000000e6"){new WP(this.gridCanvas.nativeElement).render(e,i,r,o,s,!0,this.terrain.location.y-i/2,this.terrain.location.x-e/2);let G=0;setTimeout(()=>{this.terrain.isGrid&&(this.roomGridDispAlways&&(G=1),this.tableSelecter.gridShow&&(G=1)),this.gridCanvas.nativeElement.style.opacity=G+""},0)}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Ng),Be(Zm),Be(To),Be(di),Be($n),Be(bi),Be(Di),Be(md),Be(qm))},n.\u0275cmp=Xt({type:n,selectors:[["terrain"]],viewQuery:function(e,i){if(1&e&&Gn(Xee,7),2&e){let r;yn(r=Cn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:11,vars:29,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],[1,"grid-canvas","is-fill",3,"ngStyle"],["gridCanvas",""],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible ","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"pedestal-grab","rotate-grab","is-3d","will-change"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d","will-change"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Se(3,Jee,2,1,"ng-container",3),ee(4,"div",4),Se(5,ete,3,13,"ng-container",3),nt(6,"canvas",5,6),Se(8,cte,5,4,"ng-container",3),Se(9,ute,14,0,"ng-container",3),ce()(),Se(10,dte,5,7,"div",7),ce()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),oe("movable.option",i.movableOption)("movable.disable",i.isLocked),W(1),oe("ngClass",Rt(18,fte,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),W(1),oe("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),W(1),oe("ngClass",fi(20,hte,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",Rt(23,KP,"translateZ("+i.altitude*i.gridSize+"px)")),W(1),oe("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),W(1),oe("ngStyle",Wo(25,YP,i.isSlope?"visible":"hidden","translateZ("+i.height/(i.isSlope?2:1)*i.gridSize+"px)"+i.floorModCss,"brightness("+i.floorBrightness+")")),W(2),oe("ngIf",i.hasWall&&0<(null==i.wallImage?null:i.wallImage.url.length)),W(1),oe("ngIf",!i.isLocked),W(1),oe("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},directives:[vd,Vf,nr,Sn,bo],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0px;left:0px;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0px;right:0px;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),n})();var pte=ye(7489);function _te(n,t){if(1&n&&(nt(0,"img",11),Ft(1,"safe")),2&n){const e=_e();cn("mix-blend-mode",1==e.blendType?null:"hard-light"),oe("src",Nt(1,3,e.imageFile.url,"resourceUrl"),fn)}}function mte(n,t){if(1&n&&(vu(),Je(0),nt(1,"rect",16)(2,"rect",17),et()),2&n){const e=_e().$implicit,i=_e(2);W(1),Zt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),W(1),Zt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10)}}function $te(n,t){if(1&n&&(vu(),Je(0),nt(1,"line",18)(2,"line",18)(3,"line",19)(4,"line",19),et()),2&n){const e=_e().$implicit,i=_e(2);W(1),Zt("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),W(1),Zt("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5)),W(1),Zt("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),W(1),Zt("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5))}}function vte(n,t){if(1&n&&(vu(),Je(0),nt(1,"rect",20)(2,"line",18)(3,"line",18)(4,"rect",21)(5,"line",22)(6,"line",22),et()),2&n){const e=_e().$implicit,i=_e(2);W(1),Zt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),W(1),Zt("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),W(1),Zt("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35),W(1),Zt("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),W(1),Zt("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),W(1),Zt("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35)}}function bte(n,t){if(1&n&&(vu(),ee(0,"g")(1,"desc"),we(2),ce(),Je(3,14),Se(4,mte,3,8,"ng-container",15),Se(5,$te,5,16,"ng-container",15),Se(6,vte,7,24,"ng-container",15),et(),ce()),2&n){const e=t.$implicit,i=_e(2);cn("transform-origin",(e.x+.5)*i.gridSize+"px "+(e.y+.5)*i.gridSize+"px"),oe("@rotateInOut",e.state),W(2),Ct(e.state),W(1),oe("ngSwitch",e.state),W(1),oe("ngSwitchCase","scrached"),W(1),oe("ngSwitchCase","scraching"),W(1),oe("ngSwitchCase","restore")}}function yte(n,t){if(1&n&&(vu(),ee(0,"svg",null,12),Se(2,bte,7,8,"g",13),ce()),2&n){const e=_e();oe("@fadeInOut",void 0),Zt("width",e.width*e.gridSize)("height",e.height*e.gridSize)("viewBox","0, 0, "+e.width*e.gridSize+", "+e.height*e.gridSize),W(2),oe("ngForOf",e.scratchingGridInfos)("ngForTrackBy",e.identify)}}function Cte(n,t){1&n&&(ee(0,"div",25)(1,"i",26),we(2,"lock"),ce()())}function xte(n,t){if(1&n&&(ee(0,"div",23),Se(1,Cte,3,0,"div",24),ce()),2&n){const e=_e();W(1),oe("ngIf",e.isLock&&e.dispLockMark)}}function wte(n,t){if(1&n){const e=ht();ee(0,"button",32),Re("pointerdown",function(r){return ze(e),_e(2).prevent(r)})("mousedown",function(r){return ze(e),_e(2).prevent(r)})("click",function(r){return ze(e),_e(2).scratchDone(r)}),ee(1,"i",33),we(2,"done"),ce()()}2&n&&oe("title",_e(2).gameTableMask.scratchingGrids?"\u78ba\u5b9a":"\u7d42\u4e86")}function Ete(n,t){if(1&n){const e=ht();ee(0,"button",34),Re("pointerdown",function(r){return ze(e),_e(2).prevent(r)})("mousedown",function(r){return ze(e),_e(2).prevent(r)})("click",function(r){return ze(e),_e(2).scratchCancel(r)}),ee(1,"i",33),we(2,"clear"),ce()()}}const Tte=function(n){return{"background-color":n}},Ste=function(n){return{"is-inverse":n}};function Dte(n,t){if(1&n&&(ee(0,"div",27)(1,"div",28)(2,"span",29)(3,"b"),we(4),ce(),we(5," \u304c\u64cd\u4f5c\u4e2d "),Se(6,wte,3,1,"button",30),Se(7,Ete,3,0,"button",31),ce()()()),2&n){const e=_e();W(1),oe("ngStyle",Rt(5,Tte,e.ownerColor+"E6")),W(1),oe("ngClass",Rt(7,Ste,e.isInverse)),W(2),Ct(e.ownerName),W(2),oe("ngIf",e.gameTableMask.isMine),W(1),oe("ngIf",e.gameTableMask.isMine)}}const Ite=function(n){return{transform:n}};function kte(n,t){if(1&n&&(ee(0,"div",35)(1,"div",36)(2,"span",37),we(3),ce(),ee(4,"span",38),we(5),ce()()()),2&n){const e=_e();cn("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),oe("ngStyle",Rt(5,Ite,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(3),Ct(e.math.abs(e.gameTableMaskAltitude)),W(2),Ct(e.gameTableMaskAltitude)}}const Mte=function(n,t){return{"is-grab":n,"is-scratching":t,"is-border":!0}},Ate=function(n){return{fall:n}},Pte=function(n){return{transform:n}},Fte=function(n,t,e,i){return{opacity:n,"background-color":t,"-webkit-mask":e,mask:i}},Rte=function(n){return{image:n}};let Nte=(()=>{class n{constructor(e,i,r,o,s,a,g,w,G){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=g,this.modalService=w,this.coordinateService=G,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null,this._scratchingGridX=-1,this._scratchingGridY=-1}get dispLockMark(){return this.gameTableMask.dispLockMark}set dispLockMark(e){this.gameTableMask.dispLockMark=e}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get isPreview(){return this.gameTableMask.isPreview}set isPreview(e){this.gameTableMask.isPreview=e}get isPreviewMode(){return!!this.gameTableMask&&this.isPreview&&this.gameTableMask.isMine}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get scratchedGrids(){return this.gameTableMask.scratchedGrids}set scratchedGrids(e){this.gameTableMask.scratchedGrids=e}get scratchingGrids(){return this.gameTableMask.scratchingGrids}set scratchingGrids(e){this.gameTableMask.scratchingGrids=e}get isNonScratched(){return!this.gameTableMask.scratchedGrids}get isNonScratching(){return!(this.gameTableMask.scratchingGrids||this._currentScratchingSet)}get masksCss(){if(!this.isPreviewMode&&this.isNonScratched)return"";const e=[],i=new Set(this.scratchedGrids.split(/,/g)),r=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g));for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const a=`${o}:${s}`;if(this.isPreviewMode){if(i.has(a)&&!r.has(a)||r.has(a)&&!i.has(a))continue}else if(i.has(a))continue;e.push(`radial-gradient(#000, #000) ${o*this.gridSize-1}px ${s*this.gridSize-1}px / ${this.gridSize+2}px ${this.gridSize+2}px no-repeat`)}return e.length?e.join(","):"radial-gradient(#000, #000) 0px 0px / 0px 0px no-repeat"}get scratchingGridInfos(){console.log("scratchingGridInfos");const e=[];if(!this.gameTableMask||this.isNonScratching&&this.isNonScratched)return e;const i=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g)),r=new Set(this.scratchedGrids.split(/,/g));for(let o=0;o<Math.ceil(this.width);o++)for(let s=0;s<Math.ceil(this.height);s++){const a=`${o}:${s}`;(i.has(a)||r.has(a))&&e.push({x:o,y:s,state:i.has(a)?r.has(a)?"restore":"scraching":"scrached"})}return e}get operateOpacity(){const e=this.opacity*(this.gameTableMask.isMine?.6:1);return e<.4&&this.isScratching?.4:e}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get isScratching(){return!!this.gameTableMask.owner}get hasOwner(){return this.gameTableMask.hasOwner}get ownerIsOnline(){return this.gameTableMask.ownerIsOnline}get ownerName(){return this.gameTableMask.ownerName}get ownerColor(){return this.gameTableMask.ownerColor}ngOnChanges(){var e,i,r;Qe.unregister(this),Qe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${null===(e=this.gameTableMask)||void 0===e?void 0:e.identifier}`,o=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${null===(i=this.gameTableMask)||void 0===i?void 0:i.identifier}`,o=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",o=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",o=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",o=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,o=>{this.ngZone.run(()=>{this.viewRotateZ=o.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${null===(r=this.gameTableMask)||void 0===r?void 0:r.identifier}`,o=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.10px)",colideLayers:["terrain"]},this.panelId=fd.generateUuid()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this),clearTimeout(this._scratchingTimerId)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.isScratching&&this.gameTableMask.isMine?!window.PointerEvent&&e.button<2&&e.buttons<2&&this.scratching(!0):this.input.cancel(),(this.isLock&&!this.isScratching||this.isScratching&&!this.gameTableMask.isMine)&&Qe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onInputStartPointer(e){!this.isScratching||!this.gameTableMask.isMine||e.button<2&&e.buttons<2&&this.scratching(!0,{offsetX:e.offsetX,offsetY:e.offsetY})}onInputMove(e){!window.PointerEvent&&this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&this.scratching(!1)}onInputMovePointer(e){this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&e.buttons<2&&this.scratching(!1,{offsetX:e.offsetX,offsetY:e.offsetY}),this.isScratching&&this.gameTableMask.isMine&&console.log("onInputMovePointer"),e.stopPropagation(),e.preventDefault()}scratching(e,i=null){if(!this.gameTableMask.isMine)return;const r=da.instance;let o,s;if(console.log("tableSelecter.gridShow"),r.gridShow||(r.viewTable.gridClipRect={top:0,right:0,bottom:0,left:0}),i)o=i.offsetX,s=i.offsetY;else{const G=this.coordinateService.calcTabletopLocalCoordinate(this.pointerDeviceService.pointers[0],this.elementRef.nativeElement);o=G.x-this.gameTableMask.location.x,s=G.y-this.gameTableMask.location.y}if(o<0||this.gameTableMask.width*this.gridSize<=o||s<0||this.gameTableMask.height*this.gridSize<=s)return;const a=Math.floor(o/this.gridSize),g=Math.floor(s/this.gridSize);if(!e&&this._scratchingGridX===a&&this._scratchingGridY===g)return;const w=`${a}:${g}`;this._scratchingGridX=a,this._scratchingGridY=g,this._currentScratchingSet||(this._currentScratchingSet=new Set(this.scratchingGrids.split(/,/g))),this._currentScratchingSet.has(w)?this._currentScratchingSet.delete(w):this._currentScratchingSet.add(w),clearTimeout(this._scratchingTimerId),this._scratchingTimerId=setTimeout(()=>{this.scratchingGrids=Array.from(this._currentScratchingSet).filter(G=>G&&/^\d+:\d+$/.test(G)).sort().join(","),this._currentScratchingSet=null},250)}scratched(){const e=this.scratchedGrids.split(/,/g);this._currentScratchingSet&&(clearTimeout(this._scratchingTimerId),this.scratchingGrids=Array.from(this._currentScratchingSet).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(","),this._currentScratchingSet=null);const i=this.scratchingGrids.split(/,/g);this.scratchedGrids=(0,pte.xor)(e,i).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(",")}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];o.push({name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,mt.play(ut.sweep))},altitudeHande:this.gameTableMask},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,this.dispLockMark=!0,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}}),this.isLock&&o.push(this.dispLockMark?{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u6d88\u53bb",action:()=>{this.dispLockMark=!1,mt.play(ut.lock)}}:{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u8868\u793a",action:()=>{this.dispLockMark=!0,mt.play(ut.lock)}}),o.push(this.gameTableMask.isMine?{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u78ba\u5b9a",action:()=>{this.scratchDone(),this.isPreview=!1,this.gameTableMask.owner=""}}:{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u958b\u59cb",action:()=>{""!=this.gameTableMask.owner&&(this.isPreview=!1,clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null),mt.play(ut.cardDraw),this.gameTableMask.owner=$t.peerContext.userId,this._scratchingGridX=-1,this._scratchingGridY=-1,mt.play(ut.lock)}}),this.gameTableMask.isMine&&o.push({name:"\u30b9\u30af\u30e9\u30c3\u30c1\u30ad\u30e3\u30f3\u30bb\u30eb",action:()=>{mt.play(ut.cardDraw),this.gameTableMask.owner=""}}),o.push(xi),o.push({name:"\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}}),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(s),mt.play(ut.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),mt.play(ut.sweep)}}),o.push(xi),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){mt.play(ut.cardPick)}onMoved(){mt.play(ut.cardPut)}scratchDone(e=null){return e&&(e.preventDefault(),e.stopPropagation()),this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,mt.play(ut.cardPut)),!1}scratchCancel(e=null){return e&&(e.preventDefault(),e.stopPropagation()),!this.gameTableMask.isMine&&this.ownerIsOnline||(this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,mt.play(ut.unlock)),!1}prevent(e){e.preventDefault(),e.stopPropagation()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Zm),Be(To),Be(di),Be($n),Be(bi),Be(Di),Be(hi),Be(md))},n.\u0275cmp=Xt({type:n,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("pointerdown",function(o){return i.onInputStartPointer(o)})("pointermove",function(o){return i.onInputMovePointer(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[vr],decls:11,vars:31,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-fit-full","is-3d",2,"pointer-events","none",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto","position","absolute","backface-visibility","hidden",3,"ngStyle","ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"is-fit-full","is-3d","scratching-area","border",2,"pointer-events","none","backface-visibility","hidden"],[4,"ngIf"],["style","pointer-events: none; z-index: 10; backface-visibility: hidden",4,"ngIf"],["class","scratching is-center is-3d","style","pointer-events: none; z-index: 10; top: -10px; left: 1px; backface-visibility: hidden",4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],["elementToDetach",""],[3,"transform-origin",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fill","none","stroke","#22222288","stroke-width","5","stroke-linejoin","round"],["fill","none","stroke","#ff3e3e","stroke-width","4","stroke-linejoin","round"],["stroke","#22222288","stroke-width","6","stroke-linecap","round"],["stroke","#ff3e3e","stroke-width","4","stroke-linecap","round"],["fill","none","stroke","#22222288","stroke-width","6","stroke-linejoin","round"],["fill","none","stroke","#8098ff","stroke-width","4","stroke-linejoin","round"],["stroke","#8098ff","stroke-width","4","stroke-linecap","round"],[2,"pointer-events","none","z-index","10","backface-visibility","hidden"],["class","lock-icon is-center is-3d",4,"ngIf"],[1,"lock-icon","is-center","is-3d"],[1,"material-icons",2,"pointer-events","none","backface-visibility","hidden"],[1,"scratching","is-center","is-3d",2,"pointer-events","none","z-index","10","top","-10px","left","1px","backface-visibility","hidden"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"],[2,"display","inline-block",3,"ngClass"],["class","edit-button",3,"title","pointerdown","mousedown","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"pointerdown","mousedown","click",4,"ngIf"],[1,"edit-button",3,"title","pointerdown","mousedown","click"],[1,"material-icons","small-font"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"pointerdown","mousedown","click"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2)(3,"div",3)(4,"div",4),Se(5,_te,2,6,"img",5),ce(),ee(6,"div",6),Se(7,yte,3,6,"svg",7),ce()(),Se(8,xte,2,1,"div",8),Se(9,Dte,8,9,"div",9),ce(),Se(10,kte,6,7,"div",10),ce()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),oe("ngClass",fi(17,Mte,!i.isLock&&!i.isScratching,i.isScratching&&i.gameTableMask.isMine))("movable.option",i.movableOption)("movable.disable",i.isLock||i.isScratching),W(1),oe("ngClass",Rt(20,Ate,0==i.altitude))("ngStyle",Rt(22,Pte,"translateZ("+i.altitude*i.gridSize+"px)")),W(2),oe("ngStyle",Fr(24,Fte,i.operateOpacity,i.imageFile.url.length<1?i.bgcolor:null,i.masksCss,i.masksCss))("ngClass",Rt(29,Rte,i.imageFile.url.length>=1)),W(1),oe("ngIf",i.imageFile.url.length>=1),W(2),oe("ngIf",i.isScratching),W(1),oe("ngIf",1),W(1),oe("ngIf",i.isScratching&&i.ownerIsOnline),W(1),oe("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},directives:[vd,nr,bo,Sn,oi,ec,qu],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-scratching[_ngcontent-%COMP%]{cursor:pointer}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.lock-icon[_ngcontent-%COMP%], .scratching[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{visibility:visible}.component[_ngcontent-%COMP%]:hover   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .draw-icon.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .draw-icon.is-mine[_ngcontent-%COMP%]{visibility:hidden}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-border[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{outline:2px solid #CCC!important;outline-offset:-2px}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.scratching-area[_ngcontent-%COMP%]{overflow:hidden}.name-tag[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;border-radius:24px;pointer-events:none;display:inline-block}.component[_ngcontent-%COMP%]:hover   .is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .is-mine[_ngcontent-%COMP%]{visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.name-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;display:inline-block;position:relative;vertical-align:text-bottom}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.edit-button[_ngcontent-%COMP%]{padding:0 4px;vertical-align:10%;margin:0 1px 0 0;pointer-events:auto}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;top:0;left:0;right:0;bottom:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],data:{animation:[Na("fadeInOut",[Br("void => *",[Or("132ms ease-out",Ns([mn({opacity:0,offset:0}),mn({opacity:1,offset:1})]))]),Br("* => void",[Or("132ms ease-in",Ns([mn({opacity:1,offset:0}),mn({opacity:0,offset:1})]))])]),Na("rotateInOut",[Br("scrached<=>restore",[Or("132ms ease-in-out",Ns([mn({transform:"rotateY(0deg)",offset:0}),mn({transform:"rotateY(-90deg)",offset:1})]))])])]},changeDetection:0}),n})();const Ote=["textArea"];function Bte(n,t){1&n&&(ee(0,"div",13)(1,"i",14),we(2,"lock"),ce()())}function Lte(n,t){if(1&n&&(ee(0,"div",11),we(1),Se(2,Bte,3,0,"div",12),ce()),2&n){const e=_e();W(1),ln(" ",e.title," "),W(1),oe("ngIf",e.isLock)}}const XP=function(n){return{transform:n}};function zte(n,t){if(1&n&&(Je(0),ee(1,"div",15)(2,"div",16)(3,"i",17),we(4,"autorenew"),ce()(),ee(5,"div",18)(6,"i",17),we(7,"autorenew"),ce()()(),et()),2&n){const e=_e();W(1),oe("ngStyle",Rt(1,XP,"translateZ("+e.altitude*e.gridSize+"px)"))}}const Ute=function(n){return{transform:n}};function Hte(n,t){if(1&n&&(ee(0,"div",19)(1,"div",20)(2,"span",21),we(3),ce(),ee(4,"span",22),we(5),ce()()()),2&n){const e=_e();cn("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),oe("ngStyle",Rt(5,Ute,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(3),Ct(e.math.abs(e.textNoteAltitude)),W(2),Ct(e.textNoteAltitude)}}const Vte=function(n,t){return{"is-transition":n,fall:t}};let jte=(()=>{class n{constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.textNote=null,this.is3D=!1,this.oldText="",this.oldFontSize=9,this.callbackOnMouseUp=g=>this.onMouseUp(g),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.input=null,this.viewRotateZ=10,this.oldScrollHeight=0,this.oldOffsetHeight=0}get title(){return this.textNote.title}get isLock(){return this.textNote.isLock}set isLock(e){this.textNote.isLock=e}get text(){return console.log("get text"),this.oldText!=this.textNote.text&&this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){console.log("set text"),this.calcFitHeightIfNeeded(),this.textNote.text=e,this.oldText=e}get fontSize(){return console.log("get fontSize"),this.oldFontSize!=this.textNote.fontSize&&this.calcFitHeightIfNeeded(),this.oldFontSize=this.textNote.fontSize,this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Qe.register(this).on("RESIZE_NOTE_OBJECT",-1e3,e=>{console.log("resize");let i=Xe.instance.get(e.data.identifier);!this.textNote||!i||this.textNote===i&&this.calcFitHeight()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Xe.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof Si&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(console.log("e.id onMouseDown:"+e.target.id),!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Qe.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(console.log("e.id onMouseUp:"+e.target.id),this.pointerDeviceService.isAllowedToOpenContextMenu){console.log("TEST");let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){console.log("e.id onRotateMouseDown:"+e.target.id),e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,mt.play(ut.sweep))},altitudeHande:this.textNote},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}},xi,this.isUpright?{name:"\u5bdd\u304b\u305b\u308b",action:()=>{this.transition=!0,this.isUpright=!1,mt.play(ut.sweep)}}:{name:"\u76f4\u7acb\u3055\u305b\u308b",action:()=>{this.transition=!0,this.isUpright=!0,mt.play(ut.sweep)}},xi,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),mt.play(ut.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),mt.play(ut.sweep)}}],this.title)}onMove(){mt.play(ut.cardPick)}onMoved(){mt.play(ut.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){console.log("calcFitHeight");let e=this.textAreaElementRef.nativeElement;if(e.style.height="0",this.textNote.limitHeight){let i=e.scrollHeight,r=this.height*this.gridSize-2;r<this.gridSize&&(r=this.gridSize-2),r-=this.title.length?32:2,i>r&&(i=r),e.style.height=i+"px"}else console.log("textArea.scrollHeight"+e.scrollHeight),console.log("textArea.offsetHeight"+e.offsetHeight),e.scrollHeight>e.offsetHeight&&(console.log("\u66f4\u65b0"),e.style.height=e.scrollHeight+"px",this.oldScrollHeight=e.scrollHeight,this.oldOffsetHeight=e.offsetHeight)}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(xl,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be(di),Be($n),Be(bi),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&Gn(Ote,7),2&e){let r;yn(r=Cn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:12,vars:28,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false","id","text-area",1,"textarea","is-caret",2,"overflow","hidden auto",3,"ngModel","input","ngModelChange"],["textArea",""],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-black-background","is-pointer-events-none"],["class","lock-icon is-right",4,"ngIf"],[1,"lock-icon","is-right"],[1,"material-icons",2,"display","inline"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),ee(3,"div",3)(4,"div",4)(5,"div",5),Ft(6,"safe"),Se(7,Lte,3,2,"div",6),ee(8,"textarea",7,8),Re("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),ce()()(),Se(10,zte,8,3,"ng-container",9),ce()(),Se(11,Hte,6,7,"div",10),ce()),2&e&&(oe("movable.option",i.movableOption),W(1),oe("movable.option",i.movableOption)("movable.disable",i.isSelected),W(1),oe("rotable.option",i.rotableOption),W(1),cn("width",i.width*i.gridSize,"px"),W(1),oe("ngClass",fi(23,Vte,i.transition,i.fall))("ngStyle",Rt(26,XP,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),W(1),cn("background-image",Nt(6,20,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),W(2),oe("ngIf",i.title.length),W(1),cn("font-size",i.fontSize+9,"px"),oe("ngModel",i.text),W(2),oe("ngIf",!i.isLock),W(1),oe("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},directives:[vd,Vf,nr,bo,Sn,Fi,Ti,yi],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-right[_ngcontent-%COMP%]{position:absolute;top:0px;right:0;margin:auto}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;z-index:1;text-align:center;padding:2px;background-color:#1e1e1ecc;border-radius:28px;color:#ccc;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],changeDetection:0}),n})();const Gte=["draggablePanel"];function qte(n,t){1&n&&gn(0)}function Wte(n,t){1&n&&gn(0)}const QP=function(n){return{card:n}};function Zte(n,t){if(1&n&&(Je(0),Se(1,Wte,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(13);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,QP,e.tabletopObject))}}function Yte(n,t){1&n&&gn(0)}function Kte(n,t){if(1&n&&(Je(0),Se(1,Yte,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(13);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,QP,e.tabletopObject))}}function Xte(n,t){1&n&&gn(0)}const Qte=function(n){return{note:n}};function Jte(n,t){if(1&n&&(Je(0),Se(1,Xte,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(15);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Qte,e.tabletopObject))}}function ene(n,t){1&n&&gn(0)}const JP=function(n){return{character:n}};function tne(n,t){if(1&n&&(Je(0),Se(1,ene,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(17);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,JP,e.tabletopObject))}}function nne(n,t){1&n&&gn(0)}const ine=function(n){return{dice:n}};function rne(n,t){if(1&n&&(Je(0),Se(1,nne,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(19);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,ine,e.tabletopObject))}}function one(n,t){1&n&&gn(0)}const sne=function(n){return{range:n}};function ane(n,t){if(1&n&&(Je(0),Se(1,one,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(21);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,sne,e.tabletopObject))}}function lne(n,t){1&n&&gn(0)}function cne(n,t){if(1&n&&(Je(0),Se(1,lne,1,0,"ng-container",13),et()),2&n){const e=_e(),i=an(17);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,JP,e.tabletopObject))}}function une(n,t){1&n&&gn(0)}function dne(n,t){if(1&n&&(Je(0),Se(1,une,1,0,"ng-container",14),et()),2&n){_e();const e=an(25);W(1),oe("ngTemplateOutlet",e)}}function fne(n,t){if(1&n&&(ee(0,"div",25)(1,"div",26),we(2),ce()()),2&n){const e=_e(2).card;W(2),Ct(e.ownerName)}}function hne(n,t){if(1&n){const e=ht();ee(0,"div",20),nt(1,"img",21),Ft(2,"safe"),ee(3,"button",22),Re("click",function(){return ze(e),_e(2).chanageImageView(!0)}),ee(4,"i",23),we(5,"zoom_in"),ce()(),Se(6,fne,3,1,"div",24),ce()}if(2&n){const e=_e().card,i=_e();W(1),oe("src",Nt(2,2,i.imageUrl,"resourceUrl"),fn),W(5),oe("ngIf",e.hasOwner&&0<e.ownerName.length)}}function gne(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e(2).card;W(1),Ct(e.name)}}function pne(n,t){1&n&&(Je(0),we(1,"\u30ab\u30fc\u30c9"),et())}const _ne=function(n){return{"with-button-marign":n}},eF=function(n){return{width:n}};function mne(n,t){if(1&n&&(ee(0,"div",27),Se(1,gne,2,1,"ng-container",5),Se(2,pne,2,0,"ng-container",5),ce()),2&n){const e=_e().card,i=_e();oe("ngClass",Rt(4,_ne,i.hasImage))("ngStyle",Rt(6,eF,i.overViewCardWidthNoMargin+"px")),W(1),oe("ngIf",null==e.isVisible||e.isVisible),W(1),oe("ngIf",null!=e.isVisible&&!e.isVisible)}}function $ne(n,t){1&n&&gn(0)}const Ym=function(n){return{dataElm:n}};function vne(n,t){if(1&n&&(Je(0),Se(1,$ne,1,0,"ng-container",13),et()),2&n){const e=t.$implicit;_e(3);const i=an(23);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Ym,e))}}const Km=function(n,t){return{width:n,"max-height":t}};function bne(n,t){if(1&n&&(ee(0,"div",28)(1,"div",29),Se(2,vne,2,4,"ng-container",30),ce()()),2&n){const e=_e(2);oe("ngStyle",fi(2,Km,e.overViewCardWidth+"px",e.overViewCardMaxHeight+"px")),W(2),oe("ngForOf",e.dataElms)}}const Us=function(n,t){return{"is-pointer-events-auto":n,"pointer-events-none":t}};function yne(n,t){if(1&n&&(ee(0,"div",15),Se(1,hne,7,5,"div",16),Se(2,mne,3,8,"div",17),ee(3,"div",18),Se(4,bne,3,5,"div",19),ce()()),2&n){const e=t.card,i=_e();oe("ngClass",fi(6,Us,!i.isPointerDragging,i.isPointerDragging))("ngStyle",Rt(9,eF,i.overViewCardWidth+"px")),W(1),oe("ngIf",i.hasImage),W(1),oe("ngIf",0<(null==e||null==e.name?null:e.name.length)),W(1),oe("ngStyle",fi(11,Km,i.overViewCardWidth+"px",i.overViewCardMaxHeight+"px")),W(1),oe("ngIf",i.hasDataElms&&e.isVisible)}}const Cne=function(n,t){return{"max-width":n,width:t}},xne=function(n){return{"max-width":n}};function wne(n,t){if(1&n){const e=ht();ee(0,"div",31)(1,"div",32),we(2),ce(),ee(3,"div",33)(4,"div",34)(5,"div",35)(6,"textarea",36),Re("ngModelChange",function(r){return ze(e).note.text=r}),ce()(),ee(7,"div",37),we(8),ce()()()()}if(2&n){const e=t.note,i=_e();oe("ngStyle",fi(7,Cne,"1000px",i.overViewNoteWidth+"px"))("ngClass",fi(10,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngStyle",Rt(13,xne,"1000px")),W(1),Ct(e.title),W(1),oe("ngStyle",fi(15,Km,i.overViewNoteWidth+"px",i.overViewNoteMaxHeight+"px")),W(3),oe("ngModel",e.text),W(2),Ct(e.text)}}function Ene(n,t){if(1&n&&(ee(0,"div",44),nt(1,"img",45),Ft(2,"safe"),ce()),2&n){const e=_e(2);oe("ngClass",fi(5,Us,!e.isPointerDragging,e.isPointerDragging)),W(1),oe("src",Nt(2,2,e.imageUrl,"resourceUrl"),fn)}}function Tne(n,t){1&n&&gn(0)}function Sne(n,t){if(1&n&&(Je(0),ee(1,"div",29),Se(2,Tne,1,0,"ng-container",13),ce(),et()),2&n){const e=_e().$implicit;_e(3);const i=an(23);W(2),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Ym,e))}}function Dne(n,t){if(1&n&&(Je(0),Se(1,Sne,3,4,"ng-container",5),et()),2&n){const e=t.$implicit,i=_e(3);W(1),oe("ngIf",e&&e.name!==i.newLineString)}}function Ine(n,t){if(1&n&&(ee(0,"div",28),Se(1,Dne,2,1,"ng-container",30),ce()),2&n){const e=_e(2);oe("ngStyle",fi(2,Km,e.overViewCharacterWidth+"px",e.overViewCharacterMaxHeight+"px")),W(1),oe("ngForOf",e.inventoryDataElms)}}function kne(n,t){if(1&n&&(ee(0,"div",38),nt(1,"div",39),Se(2,Ene,3,8,"div",40),ee(3,"div",41),we(4),ce(),nt(5,"div",42),ee(6,"div",43),Se(7,Ine,2,5,"div",19),ce()()),2&n){const e=t.character,i=_e();W(1),oe("ngClass",fi(6,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngIf",i.hasImage),W(1),oe("ngClass",fi(9,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),Ct(e.name),W(2),oe("ngClass",fi(12,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngIf",i.hasDataElms)}}function Mne(n,t){if(1&n&&(Je(0),we(1),et()),2&n){const e=_e().dice;W(1),Ct(e.face)}}function Ane(n,t){1&n&&(Je(0),we(1,"???"),et())}function Pne(n,t){if(1&n&&(ee(0,"div",48)(1,"div",26),we(2),ce()()),2&n){const e=_e().dice,i=_e();oe("ngClass",fi(2,Us,!i.isPointerDragging,i.isPointerDragging)),W(2),ln("",e.ownerName," ")}}const Fne=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function Rne(n,t){if(1&n&&(ee(0,"div",44),nt(1,"img",49),Ft(2,"safe"),ce()),2&n){const e=_e().dice,i=_e();oe("ngClass",fi(6,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngClass",fi(9,Fne,!e.isVisible,e.isMine))("src",Nt(2,3,i.imageUrl,"resourceUrl"),fn)}}function Nne(n,t){1&n&&gn(0)}function One(n,t){if(1&n&&(Je(0),Se(1,Nne,1,0,"ng-container",13),et()),2&n){const e=_e().$implicit;_e(3);const i=an(23);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Ym,e))}}function Bne(n,t){if(1&n&&(Je(0),Se(1,One,2,4,"ng-container",5),et()),2&n){const e=t.$implicit,i=_e(3);W(1),oe("ngIf",e&&e.name!==i.newLineString)}}function Lne(n,t){if(1&n&&(ee(0,"div",50)(1,"div",29),Se(2,Bne,2,1,"ng-container",30),ce()()),2&n){const e=_e(2);W(2),oe("ngForOf",e.dataElms)}}function zne(n,t){if(1&n&&(ee(0,"div",38),nt(1,"div",39),ee(2,"div",41),we(3),Se(4,Mne,2,1,"ng-container",5),Se(5,Ane,2,0,"ng-container",5),ce(),Se(6,Pne,3,5,"div",46),Se(7,Rne,3,12,"div",40),nt(8,"div",42),ee(9,"div",43),Se(10,Lne,3,1,"div",47),ce()()),2&n){const e=t.dice,i=_e();W(1),oe("ngClass",fi(9,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngClass",fi(12,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),ln(" ",e.name,": "),W(1),oe("ngIf",e.isVisible),W(1),oe("ngIf",!e.isVisible),W(1),oe("ngIf",e.hasOwner&&0<e.ownerName.length),W(1),oe("ngIf",i.hasImage),W(2),oe("ngClass",fi(15,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngIf",i.hasDataElms&&e.isVisible)}}function Une(n,t){1&n&&gn(0)}function Hne(n,t){if(1&n&&(Je(0),ee(1,"div",29),Se(2,Une,1,0,"ng-container",13),ce(),et()),2&n){const e=_e(2).$implicit;_e(3);const i=an(23);W(2),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Ym,e))}}function Vne(n,t){if(1&n&&(Je(0),Se(1,Hne,3,4,"ng-container",5),et()),2&n){const e=_e().$implicit,i=_e(2).range;W(1),oe("ngIf","CIRCLE"!==i.type&&"SQUARE"!==i.type&&"DIAMOND"!==i.type||"width"!==e.name)}}function jne(n,t){if(1&n&&(Je(0),Se(1,Vne,2,1,"ng-container",5),et()),2&n){const e=t.$implicit;W(1),oe("ngIf",e&&"name"!==e.name)}}function Gne(n,t){if(1&n&&(ee(0,"div",28),Se(1,jne,2,1,"ng-container",30),ce()),2&n){const e=_e(2);oe("ngStyle",fi(2,Km,e.overViewCharacterWidth+"px",e.overViewCharacterMaxHeight+"px")),W(1),oe("ngForOf",e.rangeElms)}}function qne(n,t){if(1&n&&(ee(0,"div",38),nt(1,"div",39),ee(2,"div",41),we(3),ce(),nt(4,"div",42),ee(5,"div",43),Se(6,Gne,2,5,"div",19),ce()()),2&n){const e=t.range,i=_e();W(1),oe("ngClass",fi(5,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngClass",fi(8,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),Ct(e.name),W(2),oe("ngClass",fi(11,Us,!i.isPointerDragging,i.isPointerDragging)),W(1),oe("ngIf",i.hasRangeElms)}}function Wne(n,t){1&n&&gn(0)}function Zne(n,t){if(1&n&&(ee(0,"div",57),we(1),ce()),2&n){const e=_e(2).dataElm;W(1),Ct(e.name)}}function Yne(n,t){1&n&&gn(0)}function Kne(n,t){if(1&n&&(Je(0),Se(1,Yne,1,0,"ng-container",13),et()),2&n){const e=t.$implicit;_e(3);const i=an(23);W(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",Rt(2,Ym,e))}}function Xne(n,t){if(1&n&&(ee(0,"div",54),Se(1,Zne,2,1,"div",55),ee(2,"div",56),Se(3,Kne,2,4,"ng-container",30),ce()()),2&n){const e=_e().dataElm;W(1),oe("ngIf",0<e.name.trim().length),W(2),oe("ngForOf",e.children)}}const Qne=function(){return{stripPrefix:!1}};function Jne(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",59)(2,"div"),we(3),ee(4,"span",60),we(5," \xa0\xa0URL\u7de8\u96c6:"),ee(6,"input",61),Re("change",function(){return ze(e),_e(3).changeChk()}),ce()()(),ee(7,"div",62)(8,"div",35)(9,"textarea",63),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.value=r})("focus",function(){ze(e);const r=_e(2).dataElm;return _e().textFocus(r.myIdentifer)}),ce(),nt(10,"span",64),Ft(11,"linky"),ce(),ee(12,"div",37),we(13),ce()()(),et()}if(2&n){const e=_e(2).dataElm,i=_e();W(3),ln("",e.name," "),W(1),oe("hidden",!i.isUrlText(e.value)),W(2),sn("id",e.myIdentifer),W(3),oe("ngModel",e.value)("hidden",!i.isEditUrl(e.myIdentifer)&&i.isUrlText(e.value)),W(1),oe("innerHTML",Nt(11,8,i.escapeHtml(e.value),mr(11,Qne)),Bc)("hidden",i.isEditUrl(e.myIdentifer)||!i.isUrlText(e.value)),W(3),Ct(e.value)}}function eie(n,t){if(1&n&&(Je(0),ee(1,"div",59)(2,"div"),we(3),ce(),ee(4,"div",62)(5,"div",35),nt(6,"span",65),ce(),nt(7,"div",66),ce()(),et()),2&n){const e=_e(2).dataElm,i=_e();W(3),ln("",e.name," "),W(3),oe("innerHTML",i.escapeHtmlMarkDown(e.value,e.myIdentifer),Bc),W(1),oe("innerHTML",i.escapeHtmlMarkDown(e.value,e.myIdentifer),Bc)}}function tie(n,t){if(1&n){const e=ht();ee(0,"input",71),Re("click",function(){return ze(e),_e(3).dataElm.value=0}),ce()}}function nie(n,t){if(1&n){const e=ht();ee(0,"input",72),Re("click",function(){return ze(e),_e(3).dataElm.value=1}),ce()}}function iie(n,t){if(1&n&&(Je(0),ee(1,"div",67),we(2),ce(),ee(3,"div",68),Se(4,tie,1,0,"input",69),Se(5,nie,1,0,"input",70),ce(),et()),2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(2),oe("ngIf",0!=e.value),W(1),oe("ngIf",0==e.value)}}function rie(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",67),we(2),ce(),ee(3,"div",68)(4,"div",73)(5,"div",74),we(6),ce(),ee(7,"input",75),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.currentValue=r}),ce()(),ee(8,"div",76),we(9),ce()(),ee(10,"div",77)(11,"input",78),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.currentValue=r}),Ft(12,"safe"),ce()(),et()}if(2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(4),Ct(e.currentValue),W(1),vi("color:"+e.nowValueColor+";"),oe("ngModel",e.currentValue),W(2),ln(" / ",e.value,""),W(2),vi(Nt(12,10,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),sn("max",e.value),oe("ngModel",e.currentValue)}}function oie(n,t){if(1&n){const e=ht();Je(0),ee(1,"div",67),we(2),ce(),ee(3,"div",68)(4,"div",79),we(5),ce(),ee(6,"input",80),Re("ngModelChange",function(r){return ze(e),_e(2).dataElm.value=r}),ce()(),et()}if(2&n){const e=_e(2).dataElm;W(2),Ct(e.name),W(3),Ct(e.value),W(1),oe("ngModel",e.value)}}function sie(n,t){1&n&&(Je(0,2),Se(1,Jne,14,12,"ng-container",3),Se(2,eie,8,3,"ng-container",3),Se(3,iie,6,3,"ng-container",3),Se(4,rie,13,13,"ng-container",3),Se(5,oie,7,3,"ng-container",4),et(),nt(6,"div",58)),2&n&&(oe("ngSwitch",_e().dataElm.type),W(1),oe("ngSwitchCase","note"),W(1),oe("ngSwitchCase","markdown"),W(1),oe("ngSwitchCase","check"),W(1),oe("ngSwitchCase","numberResource"))}function aie(n,t){if(1&n&&(Se(0,Wne,1,0,"ng-container",51),Se(1,Xne,4,2,"ng-template",null,52,zn),Se(3,sie,7,5,"ng-template",null,53,zn)),2&n){const e=t.dataElm,i=an(2),r=an(4);oe("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function lie(n,t){if(1&n){const e=ht();ee(0,"div",81),Re("click",function(){return ze(e),_e().chanageImageView(!1)}),ee(1,"div",82)(2,"i",23),we(3,"close"),ce()(),nt(4,"img",83),Ft(5,"safe"),ce()}if(2&n){const e=_e();oe("@fadeInOut","in"),W(4),oe("src",Nt(5,2,e.imageUrl,"resourceUrl"),fn)}}let cie=(()=>{class n{constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.domSanitizer=o,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get rangeElms(){return this.tabletopObject&&this.tabletopObject.commonDataElement?this.tabletopObject.commonDataElement.children:[]}get hasRangeElms(){return 0<this.rangeElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof Si)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Qe.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=this.tabletopObject.aliasName,r=250;"card"==i&&(r=this.overViewCardWidth),"card-stack"==i&&(r=this.overViewCardWidth),"text-note"==i&&(r=this.overViewNoteWidth),"character"==i&&(r=this.overViewCharacterWidth);let o=e.getBoundingClientRect(),s=0,a=0,g=Number(o.left),w=Number(o.left)+Number(r);window.innerWidth<w+s&&(s+=window.innerWidth-(w+s)),g+s<0&&(s+=0-(g+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),e.style.left=e.offsetLeft+s+"px",e.style.top=e.offsetTop+a+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}get overViewNoteWidth(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewWidth;return i<250&&(i=250),i>800&&(i=800),i}get overViewNoteMaxHeight(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewMaxHeight;return i<250&&(i=250),i>1e3&&(i=1e3),i}get overViewCharacterWidth(){let e=this.tabletopObject;if(!e)return 270;let i=e.overViewWidth;return i<270&&(i=270),i>800&&(i=800),i}get overViewCharacterMaxHeight(){let e=this.tabletopObject;if(!e)return 250;let i=e.overViewMaxHeight;return i<250&&(i=250),i>1e3&&(i=1e3),i}get overViewCardWidth(){let e=this.tabletopObject,i=this.tabletopObject,r=null;if(console.log("overViewCardWidth"),!e&&!i)return 250;e?(r=e,console.log("card")):i&&(console.log("cardStack"),r=i);let o=r.overViewWidth;return o<250&&(o=250),o>1e3&&(o=1e3),o}get overViewCardWidthNoMargin(){return this.hasImage?this.overViewCardWidth-60-12-2:this.overViewCardWidth-12-2}get overViewCardMaxHeight(){let e=this.tabletopObject,i=this.tabletopObject,r=null;if(!e&&!i)return 250;e?r=e:i&&(r=i);let o=r.overViewMaxHeight;return o<250&&(o=250),o>1e3&&(o=1e3),o}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}clickMarkDownBox(e){console.log("\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u30af\u30ea\u30c3\u30af:"+e)}get markdown(){return Xe.instance.get("markdwon")}escapeHtmlMarkDown(e,i){let r=this.markdown.markDownCheckBox(e,i),o=this.markdown.markDownTable(r);return this.domSanitizer.bypassSecurityTrustHtml(o.replace(/\n/g,"<br>"))}click(e){this.markdown&&(console.log("event.timeStamp:"+e.timeStamp),this.markdown.changeMarkDownCheckBox(e.target.id,e.timeStamp))}isEditUrl(e){let i=document.getElementById(e);return!!i&&i.checked}isUrlText(e){return!(!e.match(/^https:\/\//)&&!e.match(/^http:\/\//))}changeChk(){}textFocus(e){document.getElementById(e).checked=!0}}return n.\u0275fac=function(e){return new(e||n)(Be(ab),Be(bi),Be(Di),Be(Xv))},n.\u0275cmp=Xt({type:n,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&Gn(Gte,7),2&e){let r;yn(r=Cn())&&(i.draggablePanel=r.first)}},hostBindings:function(e,i){1&e&&Re("click",function(o){return i.click(o)})},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:26,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass","ngStyle"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass","ngStyle",4,"ngIf"],[1,"component-background",3,"ngStyle"],["class","grid-container-root",3,"ngStyle",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",4,"ngIf"],[1,"component-owner","position-right-bottom"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass","ngStyle"],[1,"grid-container-root",3,"ngStyle"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngStyle","ngClass"],[1,"component-title","title-background",3,"ngStyle"],[1,"component-background","text-note-container",3,"ngStyle"],[2,"position","relative","width","100%"],[1,"is-fill"],["spellcheck","false",1,"textarea","is-caret",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],["class","grid-container-root",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[1,"grid-container-root"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[3,"hidden"],["type","checkbox",3,"id","change"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","hidden","ngModelChange","focus"],[1,"textarea-url",3,"innerHTML","hidden"],[1,"textarea-markdown",3,"innerHTML"],[1,"textarea-spacer",3,"innerHTML"],[1,"tag"],[1,"value"],["type","checkbox","checked","",3,"click",4,"ngIf"],["type","checkbox",3,"click",4,"ngIf"],["type","checkbox","checked","",3,"click"],["type","checkbox",3,"click"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input","is-caret",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"hidden-spacer"],["size","1",1,"input","is-caret",3,"ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,i){1&e&&(ee(0,"div",0,1),Je(2,2),Se(3,qte,1,0,"ng-container",3),Se(4,Zte,2,4,"ng-container",3),Se(5,Kte,2,4,"ng-container",3),Se(6,Jte,2,4,"ng-container",3),Se(7,tne,2,4,"ng-container",3),Se(8,rne,2,4,"ng-container",3),Se(9,ane,2,4,"ng-container",3),Se(10,cne,2,4,"ng-container",4),et(),ce(),Se(11,dne,2,1,"ng-container",5),Se(12,yne,5,14,"ng-template",null,6,zn),Se(14,wne,9,18,"ng-template",null,7,zn),Se(16,kne,8,15,"ng-template",null,8,zn),Se(18,zne,11,18,"ng-template",null,9,zn),Se(20,qne,7,14,"ng-template",null,10,zn),Se(22,aie,5,3,"ng-template",null,11,zn),Se(24,lie,6,5,"ng-template",null,12,zn)),2&e&&(oe("@fadeInOut","in"),W(2),oe("ngSwitch",i.tabletopObject.aliasName),W(1),oe("ngSwitchCase","numberResource"),W(1),oe("ngSwitchCase","card"),W(1),oe("ngSwitchCase","card-stack"),W(1),oe("ngSwitchCase","text-note"),W(1),oe("ngSwitchCase","character"),W(1),oe("ngSwitchCase","dice-symbol"),W(1),oe("ngSwitchCase","range"),W(2),oe("ngIf",i.isOpenImageView))},directives:[GP,ec,qu,Ra,gf,Sn,nr,bo,oi,Fi,Ti,yi,_s,oa],pipes:[Ii,Rx],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.textarea-url[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.is-caret[_ngcontent-%COMP%]{caret-color:#000000f2}"],data:{animation:[Na("fadeInOut",[Br("void => *",[Or("100ms ease-out",Ns([mn({opacity:0,offset:0}),mn({opacity:1,offset:1})]))]),Br("* => void",[Or("100ms ease-in",Ns([mn({opacity:1,offset:0}),mn({opacity:0,offset:1})]))])])]},changeDetection:0}),n})(),qw=(()=>{class n{constructor(e,i,r,o){this.ngZone=e,this.viewContainerRef=i,this.componentFactoryResolver=r,this.pointerDeviceService=o,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=To.defaultParentViewContainerRef;const i=e.injector,r=this.componentFactoryResolver.resolveComponentFactory(cie);this.tooltipComponentRef=e.createComponent(r,e.length,i),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Qe.register(this).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Qe.unregister(this)}),n.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=n.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&n.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){n.activeTooltips.forEach(e=>e.destroy()),n.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return n.activeTooltips=[],n.\u0275fac=function(e){return new(e||n)(Be(An),Be(us),Be(Vu),Be(Di))},n.\u0275dir=rn({type:n,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),n})();function uie(n,t){if(1&n){const e=ht();ee(0,"div",2)(1,"div",3)(2,"div",4),Ft(3,"safe"),ce(),ee(4,"div",4),Ft(5,"safe"),ce()(),ee(6,"div",5)(7,"button",6),Re("click",function(){const o=ze(e).$implicit;return _e().drawCard(o)}),we(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),ce(),ee(9,"button",0),Re("click",function(){const o=ze(e).$implicit;return _e().showDetail(o)}),ee(10,"i",7),we(11,"settings"),ce(),we(12,"\u7de8\u96c6"),ce(),nt(13,"br"),ee(14,"button",0),Re("click",function(){const o=ze(e).$implicit;return _e().up(o)}),we(15,"\u2191"),ce(),ee(16,"button",0),Re("click",function(){const o=ze(e).$implicit;return _e().down(o)}),we(17,"\u2193"),ce(),nt(18,"br"),ce()()}if(2&n){const e=t.$implicit;W(1),oe("appTooltip",e),W(1),cn("background-image",Nt(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),W(2),cn("background-image",Nt(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let die=(()=>{class n{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=$t.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof Si&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Qe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),mt.play(ut.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Qe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),mt.play(ut.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be($n),Be(bi))},n.\u0275cmp=Xt({type:n,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(ee(0,"div")(1,"button",0),Re("click",function(){return i.close(!0)}),we(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),ce(),nt(3,"hr"),Se(4,uie,19,11,"div",1),ce()),2&e&&(W(4),oe("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[oi,qw],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),n})();const bb=function(n){return{transform:n}};function fie(n,t){if(1&n){const e=ht();ee(0,"div"),Re("@shuffle.start",function(r){return ze(e),_e().animationShuffleStarted(r)})("@shuffle.done",function(r){return ze(e),_e().animationShuffleDone(r)}),nt(1,"img",7),Ft(2,"safe"),ce()}if(2&n){const e=_e();oe("@shuffle",e.animeState),W(1),oe("ngStyle",Rt(6,bb,"rotateZ("+e.topCard.rotate+"deg)"))("src",Nt(2,3,e.imageFile.url,"resourceUrl"),fn)}}function hie(n,t){1&n&&(Je(0),ee(1,"div",8)(2,"i",9),we(3,"autorenew"),ce()(),ee(4,"div",10)(5,"i",9),we(6,"autorenew"),ce()(),ee(7,"div",11)(8,"i",9),we(9,"autorenew"),ce()(),ee(10,"div",12)(11,"i",9),we(12,"autorenew"),ce()(),et())}function gie(n,t){if(1&n&&(ee(0,"div",13)(1,"i",14),we(2,"lock"),ce()()),2&n){const e=_e();oe("ngStyle",Rt(1,bb,"translateY(0%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))}}function pie(n,t){if(1&n&&(ee(0,"div",15)(1,"span"),we(2),ce()()),2&n){const e=_e();oe("ngStyle",Rt(2,bb,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),ln("",e.cards.length,"\u679a")}}function _ie(n,t){if(1&n&&(ee(0,"div",16)(1,"span"),we(2),ce()()),2&n){const e=_e();oe("ngStyle",Rt(2,bb,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),ln("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}const mie=function(n){return{"is-empty":n}};let $ie=(()=>{class n{constructor(e,i,r,o,s,a,g){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=g,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get isLock(){return this.cardStack.isLock}set isLock(e){this.cardStack.isLock=e}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof Si&&this.cardStack.contains(i)||i instanceof _t&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Qr||e.detail instanceof xr))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Qr){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof xr){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&this.concatStack(i)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&(console.log("onDoubleClick !!!!"),null!=this.drawCard()&&mt.play(ut.cardDraw))}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{}),Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}},xi,{name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&mt.play(ut.cardDraw)}},xi,{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),mt.play(ut.cardDraw)}},{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),mt.play(ut.cardDraw)}},xi,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),mt.play(ut.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),mt.play(ut.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),mt.play(ut.cardDraw)}},xi,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),mt.play(ut.cardShuffle),Qe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}},xi,this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}},xi,{name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack($t.peerIds.length),mt.play(ut.cardDraw)}},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),mt.play(ut.cardShuffle)}},xi,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.toTopmost(),mt.play(ut.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),mt.play(ut.sweep)}}],this.name)}onMove(){mt.play(ut.cardPick)}onMoved(){mt.play(ut.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let g=xr.create(this.cardStack.name);g.location.x=this.cardStack.location.x+50-100*Math.random(),g.location.y=this.cardStack.location.y+50-100*Math.random(),g.posZ=this.cardStack.posZ,g.location.name=this.cardStack.location.name,g.rotate=this.rotate,g.toTopmost(),i.push(g)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=xr.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=$t.peerContext.userId,this.panelService.open(die,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be($n),Be(di),Be(bi),Be(Ng),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Re("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:8,vars:13,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","lock-icon-mark is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-top","is-3d","will-change"],[1,"lock-icon-mark","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"material-icons",2,"display","inline"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Se(3,fie,3,8,"div",3),Se(4,hie,13,0,"ng-container",3),Se(5,gie,3,3,"div",4),Se(6,pie,3,4,"div",5),Se(7,_ie,3,4,"div",6),ce()()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.size*i.gridSize,"px"),oe("ngClass",Rt(11,mie,i.isEmpty))("movable.option",i.movableOption),W(1),oe("rotable.option",i.rotableOption),W(1),oe("ngIf",i.topCard&&i.imageFile),W(1),oe("ngIf",!i.isIconHidden&&!i.isLock),W(1),oe("ngIf",i.isLock),W(1),oe("ngIf",i.isShowTotal),W(1),oe("ngIf",i.hasOwner))},directives:[vd,nr,Vf,Sn,bo],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;z-index:1;padding:2px;background-color:#444;border-radius:100%;color:#ccc;font-size:8px;top:5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Na("shuffle",[ox("active",mn({transform:""})),Br("* => active",[Or("800ms ease",Ns([mn({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),mn({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0}),n})();function vie(n,t){if(1&n&&(nt(0,"img",8),Ft(1,"safe")),2&n){const e=_e();oe("src",Nt(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),fn)}}const tF=function(n){return{transform:n}};function bie(n,t){if(1&n&&(ee(0,"div",9)(1,"span",10),we(2),ce()()),2&n){const e=_e();oe("ngStyle",Rt(2,tF,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),Ct(e.ownerName)}}function yie(n,t){1&n&&(nt(0,"img",11),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().frontImage.url,"resourceUrl"),fn)}function Cie(n,t){1&n&&(Je(0),ee(1,"div",12)(2,"i",13),we(3,"autorenew"),ce()(),ee(4,"div",14)(5,"i",13),we(6,"autorenew"),ce()(),ee(7,"div",15)(8,"i",13),we(9,"autorenew"),ce()(),ee(10,"div",16)(11,"i",13),we(12,"autorenew"),ce()(),nt(13,"div",17),et())}function xie(n,t){if(1&n&&(ee(0,"div",18)(1,"i",19),we(2,"lock"),ce()()),2&n){const e=_e();oe("ngStyle",Rt(1,tF,"translateY(0%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))}}let wie=(()=>{class n{constructor(e,i,r,o,s,a,g,w){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.imageService=g,this.pointerDeviceService=w,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get dispLockMark(){return this.card.dispLockMark}set dispLockMark(e){this.card.dispLockMark=e}get isLock(){return this.card.isLock}set isLock(e){this.card.isLock=e}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof Si&&this.card.contains(i)||i instanceof _t&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Qr||e.detail instanceof xr)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof xr)){let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?Yc.BACK:Yc.FRONT,this.owner="",mt.play(ut.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,this.dispLockMark=!0,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}}),this.isLock&&r.push(this.dispLockMark?{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u6d88\u53bb",action:()=>{this.dispLockMark=!1,mt.play(ut.lock)}}:{name:"\u56fa\u5b9a\u30de\u30fc\u30af\u8868\u793a",action:()=>{this.dispLockMark=!0,mt.play(ut.lock)}}),r.push(xi),r.push(!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),mt.play(ut.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),mt.play(ut.cardDraw)}}),r.push(this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),mt.play(ut.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{mt.play(ut.cardDraw),this.card.faceDown(),this.owner=$t.peerContext.userId}}),r.push(xi),r.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),mt.play(ut.cardPut)}}),r.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}}),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.card.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.toTopmost(),mt.play(ut.cardPut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),mt.play(ut.sweep)}}),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),mt.play(ut.cardPick)}onMoved(){mt.play(ut.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=xr.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be($n),Be(di),Be(bi),Be(qm),Be(Ng),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["card"]],hostBindings:function(e,i){1&e&&Re("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:10,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background will-change",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d will-change chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],["class","lock-icon-mark is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","will-change",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","will-change","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d","will-change"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-bottom","is-3d","will-change"],[1,"rotate-grab","of-right-top","is-3d","will-change"],[1,"border-bg","is-pointer-events-none","is-3d","will-change"],[1,"lock-icon-mark","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"material-icons",2,"display","inline"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Se(3,vie,2,4,"img",3),Se(4,bie,3,4,"div",4),Se(5,yie,2,4,"img",5),Se(6,Cie,14,0,"ng-container",6),Se(7,xie,3,3,"div",7),ce()()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.size*i.gridSize,"px"),oe("movable.option",i.movableOption),W(1),oe("rotable.option",i.rotableOption),W(1),oe("ngIf",i.imageFile),W(1),oe("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),W(1),oe("ngIf",i.isHand&&i.frontImage),W(1),oe("ngIf",!i.isIconHidden&&!i.isLock),W(1),oe("ngIf",i.isLock&&i.dispLockMark))},directives:[vd,Vf,Sn,bo],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.lock-icon-mark[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;z-index:1;padding:2px;background-color:#444;border-radius:100%;color:#ccc;font-size:8px;top:5px}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),n})();const Eie=["cursor"],Tie=["opacity"];function Sie(n,t){if(1&n&&(ee(0,"div",6)(1,"div",7),Ft(2,"safe"),ee(3,"div",8)(4,"span",9),we(5),ce()()()()),2&n){const e=t.$implicit,i=_e(2);oe("ngClass",e),W(1),cn("background-image",Nt(2,4,"url("+i.iconUrl+")","style")),W(4),Ct(i.name)}}const Die=function(){return["is-front","is-back"]};function Iie(n,t){1&n&&(Je(0),ee(1,"div",1,2)(3,"div",3,4),Se(5,Sie,6,7,"div",5),ce()(),et()),2&n&&(W(5),oe("ngForOf",mr(1,Die)))}let kie=(()=>{class n{constructor(e,i,r,o){this.batchService=e,this.coordinateService=i,this.chatMessageService=r,this.ngZone=o,this.cursor=_t.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.timestampInterval=null,this.timestampIntervalEnable=!1,this.callcack=s=>this.onMouseMove(s),this._x=0,this._y=0,this.networkService=$t,this.secdCounter=0,this.indexCounter=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get chatTabList(){return Xe.instance.get("ChatTabList")}get delayMs(){let e=16.6*$t.peerIds.length;return e<100?100:e}get delayMsHb(){let e=166*$t.peerIds.length;return e<1e3?1e3:e}ngOnInit(){this.isMine||Qe.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)}).on("HEART_BEAT",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.cursor.timestampSend=e.data[0],this.cursor.timestampReceive=Date.now(),this.cursor.timeDiffDown=this.cursor.timestampReceive-this.cursor.timestampSend+_t.myCursor.debugReceiveDelay;const i=e.data[1],r=e.data[2];this.cursor.lastTimeSignNo=e.data[3],this.cursor.firstTimeSignNo<0&&(this.cursor.firstTimeSignNo=e.data[3]),this.cursor.totalTimeSignNum++,i==_t.myCursor.peerId&&null!=r&&(this.cursor.timeDiffUp=r,this.cursor.timeLatency=r+this.cursor.timeDiffDown)},this)})}chkDisConnect(){const e=1e3*_t.myCursor.timeout,i=Date.now()-this.cursor.timestampReceive,o=Xe.instance.get("ChatTabList").systemMessageTab;e<=i?!this.cursor.isDisConnect&&(this.cursor.isDisConnect=!0,o)&&this.chatMessageService.sendSystemMessageOnePlayer(o,this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u304b\u3089\u3042\u306a\u305f\u3078\u306e\u63a5\u7d9a\u78ba\u8a8d\u4fe1\u53f7\u304c"+_t.myCursor.timeout+"\u79d2\u4ee5\u4e0a\u53d7\u4fe1\u3067\u304d\u307e\u305b\u3093\u3002\u901a\u4fe1\u969c\u5bb3\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002",_t.myCursor.identifier,"#006633"):(1==this.cursor.isDisConnect&&setTimeout(()=>{this.timestampInterval=null,o&&this.chatMessageService.sendSystemMessageOnePlayer(o,"\u3042\u306a\u305f\u3068"+this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u306e\u63a5\u7d9a\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002",_t.myCursor.identifier,"#006633")},1e3),this.cursor.isDisConnect=!1)}logoutMessage(){const i=Xe.instance.get("ChatTabList").systemMessageTab;i&&this.chatMessageService.sendSystemMessageOnePlayer(i,this.cursor.userId+"["+this.cursor.name+"] \u3055\u3093\u304c\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002",_t.myCursor.identifier,"#006633")}timestampLoop(){!this.timestampIntervalEnable||this.timestampInterval||(this.timestampInterval=setTimeout(()=>{if(this.timestampInterval=null,_t.myCursor.peerId==this.cursor.peerId){const e=this.networkService.peerContexts.length;if(e){e<=this.indexCounter&&(this.indexCounter=0);let i=Date.now()+_t.myCursor.debugTimeShift,r=null;this.networkService.peerContexts[this.indexCounter]&&(r=this.networkService.peerContexts[this.indexCounter]);let o="";r&&this.networkService.peerContexts[this.indexCounter].isOpen&&(o=this.networkService.peerContexts[this.indexCounter].peerId);const s=_t.findByPeerId(o);Qe.call("HEART_BEAT",[i,o,s?s.timeDiffDown:null,this.secdCounter]),this.indexCounter++,this.secdCounter++}}else this.chkDisConnect();this.timestampLoop()},this.delayMsHb))}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut()),this.timestampIntervalEnable=!0,this.timestampLoop()}ngOnDestroy(){this.logoutMessage(),document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Qe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear(),this.timestampIntervalEnable=!1}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),Qe.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new cc(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}}return n.\u0275fac=function(e){return new(e||n)(Be(Fg),Be(md),Be(Eo),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(Gn(Eie,5),Gn(Tie,5)),2&e){let r;yn(r=Cn())&&(i.cursorElementRef=r.first),yn(r=Cn())&&(i.opacityElementRef=r.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(e,i){1&e&&Se(0,Iie,6,2,"ng-container",0),2&e&&oe("ngIf",!i.isMine)},directives:[Sn,oi,nr],pipes:[Ii],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;will-change:transform;transform:translate(0) translateY(0px%) translateZ(0)}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),n})();function Mie(n,t){if(1&n&&(ee(0,"ng-option",10),we(1),ce()),2&n){const e=t.$implicit;oe("value",e.identifier),W(1),ln("",e.name," ")}}function Aie(n,t){1&n&&(nt(0,"img",11),Ft(1,"safe")),2&n&&oe("src",Nt(1,1,_e().imageFile.url,"resourceUrl"),fn)}let Pie=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.shouldUpdateCharacterList=!0,this._gameCharacters=[]}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Xe.instance.getObjects(Bt).filter(e=>this.allowsChat(e))),this._gameCharacters}allowsChat(e){return"table"===e.location.name&&!e.nonTalkFlag}get imageFile(){let e=Xe.instance.get(this._sendFrom);return e instanceof Bt&&xt.instance.get(e.imageDataElement.children[0].value)||Ot.Empty}get selectCharacterTachieNum(){let e=Xe.instance.get(this._sendFrom);return e instanceof Bt?e.imageDataElement.children.length:0}followring(){let e=Xe.instance.get(this._sendFrom);e instanceof Bt&&Bt&&(mt.play(ut.lock),this.tabletopObject.followingCharctorIdentifier=e.identifier,this.tabletopObject.following()),this.panelService.close()}cancel(){this.panelService.close()}ngOnInit(){this._sendFrom=this.gameCharacters.length>=1?this.gameCharacters[0].identifier:""}ngAfterViewInit(){}ngOnDestroy(){}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be($n),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["range-docking-character"]],inputs:{tabletopObject:"tabletopObject"},decls:16,vars:4,consts:[[1,"table"],[1,"table-cell",2,"width","7em"],[2,"text-align","center"],[1,"table-cell"],[1,"ud-select","is-caret",2,"width","12em",3,"ngModel","clearable","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[2,"width","9em",3,"click"],[2,"width","9em","margin-left","3em",3,"click"],[3,"value"],[1,"image",3,"src"]],template:function(e,i){1&e&&(ee(0,"div",0)(1,"div",1)(2,"div",2),we(3," \u63a5\u7d9a\u5148\uff1e "),ce()(),ee(4,"div",3)(5,"ng-select",4),Re("ngModelChange",function(o){return i.sendFrom=o}),Se(6,Mie,2,2,"ng-option",5),ce()()(),ee(7,"div",0)(8,"div",6),Se(9,Aie,2,4,"img",7),ce()(),nt(10,"br"),ee(11,"div",0)(12,"button",8),Re("click",function(){return i.followring()}),we(13,"\u63a5\u7d9a\u5b9f\u884c"),ce(),ee(14,"button",9),Re("click",function(){return i.cancel()}),we(15,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ce()()),2&e&&(W(5),oe("ngModel",i.sendFrom)("clearable",!1),W(1),oe("ngForOf",i.gameCharacters),W(3),oe("ngIf",0<i.imageFile.url.length))},directives:[pg,Ti,yi,oi,xf,Sn],pipes:[Ii],styles:[".flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:100px;height:100px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{height:100%;vertical-align:bottom;object-fit:cover}input[_ngcontent-%COMP%]{width:5em}"],changeDetection:0}),n})();class Fie{constructor(t,e){this.canvasElement=t,this.canvasElementRange=e}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}chkOuterProduct(t,e,i,r,o,s){return(i-t)*(s-e)-(r-e)*(o-t)>=-.01}chkInCircle(t,e,i){return t*t>=e*e+i*i}renderCircle(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=0,G=0,me=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.arc(i,r,t.range*e,0,2*Math.PI,!0),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let ve=0;ve<=t.areaHeight+1;ve++)for(let Ie=0;Ie<=t.areaWidth+1;Ie++){let{gx:Oe,gy:Ve}=me(Ie,ve,e);w=Oe+s+e/2-i,G=Ve+a+e/2-r,this.chkInCircle(t.range*e,w,G)&&this.fillSquare(g,Oe+s,Ve+a,e)}}this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.arc(i,r,t.range*e,0,2*Math.PI,!0),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill())}renderLine(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=Math.PI/180*t.degree,s=-t.centerX%e,a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),G=.5*t.width*e,ve=-.5*t.width*e,Ie=t.range*e,Oe=-.5*t.width*e,Ve=t.range*e,We=.5*t.width*e,Ye=0-1*e,Ge=G+1*e,ct=0-1*e,rt=ve-1*e,ft=Ie+1*e,Lt=Oe-1*e,wt=Ve+1*e,Ht=We+1*e,Dt=0*Math.cos(o)-G*Math.sin(o),At=0*Math.sin(o)+G*Math.cos(o),qt=0*Math.cos(o)-ve*Math.sin(o),li=0*Math.sin(o)+ve*Math.cos(o),Qn=Ie*Math.cos(o)-Oe*Math.sin(o),gi=Ie*Math.sin(o)+Oe*Math.cos(o),Ri=Ve*Math.cos(o)-We*Math.sin(o),Pt=Ve*Math.sin(o)+We*Math.cos(o),Wt={clip01x:Ye*Math.cos(o)-Ge*Math.sin(o),clip01y:Ye*Math.sin(o)+Ge*Math.cos(o),clip02x:ct*Math.cos(o)-rt*Math.sin(o),clip02y:ct*Math.sin(o)+rt*Math.cos(o),clip03x:ft*Math.cos(o)-Lt*Math.sin(o),clip03y:ft*Math.sin(o)+Lt*Math.cos(o),clip04x:wt*Math.cos(o)-Ht*Math.sin(o),clip04y:wt*Math.sin(o)+Ht*Math.cos(o)},tn=0,un=0,Wn=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(Dt+i,At+r),g.lineTo(qt+i,li+r),g.lineTo(Qn+i,gi+r),g.lineTo(Ri+i,Pt+r),g.lineTo(Dt+i,At+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let mi=0;mi<=t.areaHeight+1;mi++)for(let Mi=0;Mi<=t.areaWidth+1;Mi++){let{gx:sr,gy:$i}=Wn(Mi,mi,e);tn=sr+s+e/2-i,un=$i+a+e/2-r,this.chkOuterProduct(Dt,At,qt,li,tn,un)&&this.chkOuterProduct(qt,li,Qn,gi,tn,un)&&this.chkOuterProduct(Qn,gi,Ri,Pt,tn,un)&&this.chkOuterProduct(Ri,Pt,Dt,At,tn,un)&&this.fillSquare(g,sr+s,$i+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(Dt+i,At+r),g.lineTo(qt+i,li+r),g.lineTo(Qn+i,gi+r),g.lineTo(Ri+i,Pt+r),g.lineTo(Dt+i,At+r),g.stroke(),g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill(),Wt}renderSquare(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=-t.range*e,G=t.range*e,me=-t.range*e,ve=-t.range*e,Ie=t.range*e,Oe=-t.range*e,Ve=t.range*e,We=t.range*e,Dt={clip01x:w-1*e,clip01y:G+1*e,clip02x:me-1*e,clip02y:ve-1*e,clip03x:Ie+1*e,clip03y:Oe-1*e,clip04x:Ve+1*e,clip04y:We+1*e},At=0,qt=0,li=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(w+i,G+r),g.lineTo(me+i,ve+r),g.lineTo(Ie+i,Oe+r),g.lineTo(Ve+i,We+r),g.lineTo(w+i,G+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let Qn=0;Qn<=t.areaHeight+1;Qn++)for(let gi=0;gi<=t.areaWidth+1;gi++){let{gx:Ri,gy:Pt}=li(gi,Qn,e);At=Ri+s+e/2-i,qt=Pt+a+e/2-r,this.chkOuterProduct(w,G,me,ve,At,qt)&&this.chkOuterProduct(me,ve,Ie,Oe,At,qt)&&this.chkOuterProduct(Ie,Oe,Ve,We,At,qt)&&this.chkOuterProduct(Ve,We,w,G,At,qt)&&this.fillSquare(g,Ri+s,Pt+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(w+i,G+r),g.lineTo(me+i,ve+r),g.lineTo(Ie+i,Oe+r),g.lineTo(Ve+i,We+r),g.lineTo(w+i,G+r),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill()),Dt}renderDiamond(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=(Math,-t.centerX%e),a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),w=-t.range*e,ve=-t.range*e,Ie=t.range*e,We=t.range*e,Dt={clip01x:w-1.2*e,clip01y:0,clip02x:0,clip02y:ve-1.2*e,clip03x:Ie+1.2*e,clip03y:0,clip04x:0,clip04y:We+1.2*e},At=0,qt=0,li=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(g,e,t.gridColor),t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(w+i,0+r),g.lineTo(0+i,ve+r),g.lineTo(Ie+i,0+r),g.lineTo(0+i,We+r),g.lineTo(w+i,0+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let Qn=0;Qn<=t.areaHeight+1;Qn++)for(let gi=0;gi<=t.areaWidth+1;gi++){let{gx:Ri,gy:Pt}=li(gi,Qn,e);At=Ri+s+e/2-i,qt=Pt+a+e/2-r,this.chkOuterProduct(w,0,0,ve,At,qt)&&this.chkOuterProduct(0,ve,Ie,0,At,qt)&&this.chkOuterProduct(Ie,0,0,We,At,qt)&&this.chkOuterProduct(0,We,w,0,At,qt)&&this.fillSquare(g,Ri+s,Pt+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(w+i,0+r),g.lineTo(0+i,ve+r),g.lineTo(Ie+i,0+r),g.lineTo(0+i,We+r),g.lineTo(w+i,0+r),g.stroke(),t.isDocking?(g.beginPath(),g.strokeRect(i-6,r-6,12,12)):(g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill()),Dt}renderCorn(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=Math.PI/180*t.degree,s=-t.centerX%e,a=-t.centerY%e;s>0&&(s-=e),a>0&&(a-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let g=this.canvasElement.getContext("2d"),me=t.range*e,ve=-.5*t.width*e,Ie=t.range*e,Oe=.5*t.width*e,Ve=0-1.5*e,Ye=0-1*e,Ge=0-1*e,ct=me-1*e,rt=ve-1*e,ft=me,Lt=ve-1*e,wt=me+1*e,Ht=ve-1*e,Dt=wt,At=-Ht,qt=ft,li=-Lt,Qn=ct,gi=-rt,Ri=Ye,Pt=-Ge,un=me*Math.cos(o)-ve*Math.sin(o),Wn=me*Math.sin(o)+ve*Math.cos(o),mi=Ie*Math.cos(o)-Oe*Math.sin(o),Mi=Ie*Math.sin(o)+Oe*Math.cos(o),sr={clip01x:Ve*Math.cos(o)-0*Math.sin(o),clip01y:Ve*Math.sin(o)+0*Math.cos(o),clip02x:Ye*Math.cos(o)-Ge*Math.sin(o),clip02y:Ye*Math.sin(o)+Ge*Math.cos(o),clip03x:ct*Math.cos(o)-rt*Math.sin(o),clip03y:ct*Math.sin(o)+rt*Math.cos(o),clip04x:ft*Math.cos(o)-Lt*Math.sin(o),clip04y:ft*Math.sin(o)+Lt*Math.cos(o),clip05x:wt*Math.cos(o)-Ht*Math.sin(o),clip05y:wt*Math.sin(o)+Ht*Math.cos(o),clip06x:Dt*Math.cos(o)-At*Math.sin(o),clip06y:Dt*Math.sin(o)+At*Math.cos(o),clip07x:qt*Math.cos(o)-li*Math.sin(o),clip07y:qt*Math.sin(o)+li*Math.cos(o),clip08x:Qn*Math.cos(o)-gi*Math.sin(o),clip08y:Qn*Math.sin(o)+gi*Math.cos(o),clip09x:Ri*Math.cos(o)-Pt*Math.sin(o),clip09y:Ri*Math.sin(o)+Pt*Math.cos(o)},$i=0,Mt=0,Zw=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(t.fillOutLine)this.makeBrush(g,e,t.gridColor),g.beginPath(),g.moveTo(0+i,0+r),g.lineTo(un+i,Wn+r),g.lineTo(mi+i,Mi+r),g.lineTo(0+i,0+r),g.fill();else{this.makeBrush(g,e,t.gridColor);for(let to=0;to<=t.areaHeight+1;to++)for(let wl=0;wl<=t.areaWidth+1;wl++){let{gx:El,gy:mc}=Zw(wl,to,e);$i=El+s+e/2-i,Mt=mc+a+e/2-r,this.chkOuterProduct(0,0,un,Wn,$i,Mt)&&this.chkOuterProduct(un,Wn,mi,Mi,$i,Mt)&&this.chkOuterProduct(mi,Mi,0,0,$i,Mt)&&this.fillSquare(g,El+s,mc+a,e)}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,g=this.canvasElementRange.getContext("2d"),this.makeBrush(g,e,t.rangeColor),g.beginPath(),g.lineWidth=2,g.moveTo(0+i,0+r),g.lineTo(un+i,Wn+r),g.lineTo(mi+i,Mi+r),g.lineTo(0+i,0+r),g.stroke(),g.beginPath(),g.arc(i,i,5,0,2*Math.PI,!0),g.fill(),sr}generateCalcGridPositionFunc(t,e,i,r,o){switch(t){case $s.HEX_VERTICAL:return(s,a,g)=>(s+(e%(2*g)<g?1:0)+(r%4==0?1:0))%2==1?{gx:s*g,gy:a*g}:{gx:s*g,gy:a*g+g/2};case $s.HEX_HORIZONTAL:return(s,a,g)=>(a+(i%(2*g)<g?1:0)+(o%4==0?1:0))%2==1?{gx:s*g,gy:a*g}:{gx:s*g+g/2,gy:a*g};default:return(s,a,g)=>({gx:s*g,gy:a*g})}}fillSquare(t,e,i,r){t.beginPath(),t.fillRect(e,i,r,r)}strokeSquare(t,e,i,r){t.beginPath(),t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,o){let s=o===$s.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),g=e+r/2,w=i+r/2;t.beginPath();for(let G=0;G<6;G++){s+=60;let me=Math.PI/180*s,ve=Math.cos(me)*a+g,Ie=Math.sin(me)*a+w;t.lineTo(ve,Ie)}t.closePath(),t.stroke()}}const Rie=["gridCanvas"],Nie=["rangeCanvas"],Oie=["rotate"];function Bie(n,t){1&n&&(ee(0,"div",17)(1,"i",18),we(2,"lock"),ce()())}function Lie(n,t){if(1&n&&(Je(0),ee(1,"div",19)(2,"div",20)(3,"i",18),we(4,"autorenew"),ce()(),ee(5,"div",21)(6,"i",18),we(7,"autorenew"),ce()(),ee(8,"div",22)(9,"i",18),we(10,"autorenew"),ce()()(),et()),2&n){const e=_e();W(2),cn("left",1*e.range.length*e.gridSize,"px")}}const nF=function(n){return{transform:n}};function zie(n,t){if(1&n&&(ee(0,"div",23)(1,"div",24)(2,"span",25)(3,"i"),we(4),ce()(),ee(5,"span",26)(6,"i"),we(7),ce()()(),ee(8,"div",24)(9,"span",27),we(10),ce(),ee(11,"span",28),we(12),ce()(),ee(13,"div",29)(14,"span",25)(15,"i"),we(16),ce()(),ee(17,"span",26)(18,"i"),we(19),ce()()()()),2&n){const e=_e();cn("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-0,"px"),oe("ngStyle",Rt(40,nF,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(1),cn("visibility",e.altitude>0?"visible":"hidden"),W(1),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(2),Ct(e.elevation),W(1),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(2),Ct(e.elevation),W(2),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(1),Ct(e.math.abs(e.altitude)),W(1),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(1),Ct(e.math.abs(e.altitude)),W(1),cn("visibility",e.altitude<0?"visible":"hidden"),oe("ngStyle",Rt(42,nF,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),W(1),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(2),Ct(e.elevation),W(1),cn("color",e.range.rangeColor)("text-shadow",e.textShadowCss),W(2),Ct(e.elevation)}}const Uie=function(n){return{"is-grab":n}},Hie=function(n){return{fall:n}};let Vie=(()=>{class n{constructor(e,i,r,o,s,a,g,w,G){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=g,this.coordinateService=w,this.tabletopService=G,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.math=Math,this.viewRotateX=50,this.viewRotateZ=10,this.movableOption={},this.rotableOption={},this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get clipCircle(){return"circle("+(this.range.length+1.5)*this.gridSize+"px)"}get clipCorn(){let e="polygon("+this.clipAreaCorn.clip01x+"px "+this.clipAreaCorn.clip01y+"px, ";return e+=this.clipAreaCorn.clip02x+"px "+this.clipAreaCorn.clip02y+"px, ",e+=this.clipAreaCorn.clip03x+"px "+this.clipAreaCorn.clip03y+"px, ",e+=this.clipAreaCorn.clip04x+"px "+this.clipAreaCorn.clip04y+"px, ",e+=this.clipAreaCorn.clip05x+"px "+this.clipAreaCorn.clip05y+"px, ",e+=this.clipAreaCorn.clip06x+"px "+this.clipAreaCorn.clip06y+"px, ",e+=this.clipAreaCorn.clip07x+"px "+this.clipAreaCorn.clip07y+"px, ",e+=this.clipAreaCorn.clip08x+"px "+this.clipAreaCorn.clip08y+"px, ",e+=this.clipAreaCorn.clip09x+"px "+this.clipAreaCorn.clip09y+"px)",e}get clipLine(){let e="polygon("+this.clipAreaLine.clip01x+"px "+this.clipAreaLine.clip01y+"px, ";return e+=this.clipAreaLine.clip02x+"px "+this.clipAreaLine.clip02y+"px, ",e+=this.clipAreaLine.clip03x+"px "+this.clipAreaLine.clip03y+"px, ",e+=this.clipAreaLine.clip04x+"px "+this.clipAreaLine.clip04y+"px)",e}get clipSquare(){let e="polygon("+this.clipAreaSquare.clip01x+"px "+this.clipAreaSquare.clip01y+"px, ";return e+=this.clipAreaSquare.clip02x+"px "+this.clipAreaSquare.clip02y+"px, ",e+=this.clipAreaSquare.clip03x+"px "+this.clipAreaSquare.clip03y+"px, ",e+=this.clipAreaSquare.clip04x+"px "+this.clipAreaSquare.clip04y+"px)",e}get clipDiamond(){let e="polygon("+this.clipAreaDiamond.clip01x+"px "+this.clipAreaDiamond.clip01y+"px, ";return e+=this.clipAreaDiamond.clip02x+"px "+this.clipAreaDiamond.clip02y+"px, ",e+=this.clipAreaDiamond.clip03x+"px "+this.clipAreaDiamond.clip03y+"px, ",e+=this.clipAreaDiamond.clip04x+"px "+this.clipAreaDiamond.clip04y+"px)",e}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLock(){return this.range.isLock}set isLock(e){this.range.isLock=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.length<1?1:this.length;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Xe.instance.get(e.data.identifier);this.setRange(),this.range&&i&&((this.range===i||i instanceof Si&&this.range.contains(i))&&this.changeDetector.markForCheck(),i.identifier==this.range.followingCharctorIdentifier&&(console.log("\u8ffd\u5f93\u52d5\u4f5c"),this.range.following(),this.setRange()))}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange()}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];o.push({name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,mt.play(ut.sweep))},altitudeHande:this.range},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]}),o.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}}),("CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type)&&o.push(null!=Xe.instance.get(this.range.followingCharctorIdentifier)?{name:"\u8ffd\u5f93\u3092\u89e3\u9664",action:()=>{mt.play(ut.unlock),this.range.followingCharctorIdentifier=null}}:{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:()=>{this.dockingWindowOpen()}}),o.push(xi),o.push({name:"\u5c04\u7a0b\u7bc4\u56f2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.range)}}),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.range.parent&&this.range.parent.appendChild(s),mt.play(ut.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),mt.play(ut.sweep)}}),o.push(xi),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}dockingWindowOpen(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Pie,{left:e.x-250,top:e.y-175,width:350,height:200,title:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93"}).tabletopObject=this.range}onMove(){mt.play(ut.cardPick)}onMoved(){mt.play(ut.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}setRange(){let e=new Fie(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.length<1?1:this.length,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,fillOutLine:this.range.fillOutLine,gridType:this.currentTable.gridType,isDocking:!!Xe.instance.get(this.range.followingCharctorIdentifier)};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(Zm),Be(To),Be(di),Be($n),Be(bi),Be(Di),Be(md),Be(qm))},n.\u0275cmp=Xt({type:n,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(Gn(Rie,7),Gn(Nie,7),Gn(Oie,5)),2&e){let r;yn(r=Cn())&&(i.gridCanvas=r.first),yn(r=Cn())&&(i.rangeCanvas=r.first),yn(r=Cn())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{range:"range",is3D:"is3D"},decls:18,vars:33,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute","pointer-events","auto"],[2,"position","absolute"],[1,"image-box",3,"appTooltip"],[1,"is-fill"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[2,"position","absolute","width","28px"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),nt(6,"canvas",6,7)(8,"canvas",6,8),ce()(),ee(10,"div",9,10),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Se(12,Bie,3,0,"div",11),Se(13,Lie,11,2,"ng-container",12),ce()()(),Se(14,zie,20,44,"div",13),ee(15,"div",14),nt(16,"canvas",15,16),ce()()),2&e&&(oe("movable.option",i.movableOption),W(1),oe("ngClass",Rt(29,Uie,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),W(1),cn("transform","translateZ("+i.altitude*i.gridSize+"px)"),oe("ngClass",Rt(31,Hie,0==i.altitude)),W(1),cn("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),W(1),cn("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),W(1),oe("appTooltip",i.range),W(5),oe("rotable.option",i.rotableOption)("rotable.disable",i.isLock),W(2),oe("ngIf",i.isLock),W(1),oe("ngIf",!i.isLock&&"CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),W(1),oe("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),W(1),cn("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},directives:[vd,nr,qw,Vf,Sn,bo],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),n})();function jie(n,t){1&n&&(ee(0,"div",14)(1,"div",15)(2,"div",16),we(3,"autorenew"),ce(),ee(4,"div",17),we(5,"autorenew"),ce()()())}function Gie(n,t){if(1&n&&(Je(0),Se(1,jie,6,0,"div",13),et()),2&n){const e=_e();W(1),oe("ngIf",!e.isLock)}}function qie(n,t){if(1&n&&(ee(0,"span"),we(1),ce()),2&n){const e=_e(2);W(1),Ct(e.face)}}function Wie(n,t){1&n&&(ee(0,"span"),we(1,"???"),ce())}function Zie(n,t){1&n&&(Je(0),ee(1,"i",20),we(2,"lock"),ce(),et())}const Ww=function(n){return{transform:n}};function Yie(n,t){if(1&n&&(ee(0,"div",18)(1,"div",19),we(2),Se(3,qie,2,1,"span",6),Se(4,Wie,2,0,"span",6),Se(5,Zie,3,0,"ng-container",6),ce()()),2&n){const e=_e();oe("ngStyle",Rt(5,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),ln("",e.name,":"),W(1),oe("ngIf",e.isVisible),W(1),oe("ngIf",!e.isVisible),W(1),oe("ngIf",e.isLock)}}function Kie(n,t){if(1&n&&(ee(0,"span"),we(1),ce()),2&n){const e=_e(2);W(1),Ct(e.face)}}function Xie(n,t){1&n&&(ee(0,"span"),we(1,"???"),ce())}function Qie(n,t){1&n&&(Je(0),ee(1,"i",20),we(2,"lock"),ce(),et())}function Jie(n,t){if(1&n&&(ee(0,"div",18)(1,"div",19),we(2),Se(3,Kie,2,1,"span",6),Se(4,Xie,2,0,"span",6),Se(5,Qie,3,0,"ng-container",6),ce()()),2&n){const e=_e();oe("ngStyle",Rt(5,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),W(2),ln("",e.name,":"),W(1),oe("ngIf",e.isVisible),W(1),oe("ngIf",!e.isVisible),W(1),oe("ngIf",e.isLock)}}function ere(n,t){if(1&n&&(ee(0,"div",21)(1,"div",22),we(2),ce(),ee(3,"div",23),we(4),ce()()),2&n){const e=_e();oe("ngStyle",Rt(3,Ww,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),Ct(e.ownerName),W(2),Ct(e.ownerName)}}const tre=function(n,t){return{height:n,transform:t}},iF=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function nre(n,t){if(1&n&&(nt(0,"img",24),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",fi(6,tre,+e.imageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))("src",Nt(1,3,e.imageFile.url,"resourceUrl"),fn)("ngClass",fi(9,iF,!e.isVisible,e.isMine))}}const ire=function(){return{width:"100%"}};function rre(n,t){if(1&n&&(nt(0,"img",24),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",mr(6,ire))("src",Nt(1,3,e.imageFile.url,"resourceUrl"),fn)("ngClass",fi(7,iF,!e.isVisible,e.isMine))}}const ore=function(n){return{"is-gray-border":n}};let sre=(()=>{class n{constructor(e,i,r,o,s,a,g){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=g,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get imageHeignt(){return this.diceSymbol.komaImageHeignt}get specifyImageFlag(){return this.diceSymbol.specifyKomaImageFlag}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Qe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof Si&&this.diceSymbol.contains(i)||i instanceof _t&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=_t.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(this.isVisible&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()}}),r.length&&r.push(xi),(this.isMine||this.hasOwner)&&r.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",mt.play(ut.unlock)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=$t.peerContext.userId,mt.play(ut.lock)}}),this.isVisible){let o=[];this.faces.forEach(s=>{o.push({name:`${s}`,action:()=>{this.face=s,mt.play(ut.dicePut)}})}),r.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:o})}r.push(xi),r.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}}),r.push(xi),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.diceSymbol.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.update(),mt.play(ut.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),mt.play(ut.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){mt.play(ut.dicePick)}onMoved(){mt.play(ut.dicePut)}diceRoll(){return Qe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),mt.play(ut.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){Qe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be($n),Be(To),Be(di),Be(bi),Be(Ng),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:16,vars:22,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],["class","name-tag is-nowrap is-black-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background is-3d will-change",3,"ngStyle",4,"ngIf"],["class","image is-3d chrome-smooth-image-trick",3,"ngStyle","src","ngClass",4,"ngIf"],["class","pedestal-grab rotate-grab is-3d will-change",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d","will-change"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"is-3d"],[1,"material-icons","lock-icon",2,"display","inline"],[1,"owner-tag","is-nowrap","is-black-background","is-3d","will-change",3,"ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"ngStyle","src","ngClass"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),ee(2,"div",2)(3,"div",3),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),nt(4,"div",4)(5,"div",5),Se(6,Gie,2,1,"ng-container",6),ee(7,"div",2),Re("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),ee(8,"div",7)(9,"div",8)(10,"div",9),Se(11,Yie,6,7,"div",10),Se(12,Jie,6,7,"div",10),Se(13,ere,5,5,"div",11),Se(14,nre,2,12,"img",12),Se(15,rre,2,10,"img",12),ce()()()()()()()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("movable.option",i.movableOption),W(1),oe("@bounceInOut","in"),W(1),oe("rotable.option",i.rotableOption),W(1),oe("ngClass",Rt(20,ore,i.hasOwner)),W(2),oe("ngIf",!i.isIconHidden),W(1),oe("@diceRoll",i.animeState),W(2),cn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),W(2),oe("ngIf",0<i.name.length),W(1),oe("ngIf",0<i.name.length),W(1),oe("ngIf",i.hasOwner&&0<i.ownerName.length),W(1),oe("ngIf",0<i.imageFile.url.length&&i.specifyImageFlag),W(1),oe("ngIf",0<i.imageFile.url.length&&!i.specifyImageFlag))},directives:[vd,Vf,nr,Sn,bo],pipes:[Ii],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.backface-off[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.lock-icon[_ngcontent-%COMP%]{font-size:15px;vertical-align:middle}"],data:{animation:[Na("diceRoll",[Br("* => active",[Or("800ms ease",Ns([mn({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),mn({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),Na("bounceInOut",[Br("void => *",[Or("600ms ease",Ns([mn({transform:"scale3d(0, 0, 0)",offset:0}),mn({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Br("* => void",[Or(100,mn({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();const are=["root"],lre=function(){return{border:"solid 6px #FFCC80"}};function cre(n,t){1&n&&nt(0,"div",20),2&n&&vi(mr(2,lre))}const ure=function(){return{border:"solid 6px #A0E0FF"}};function dre(n,t){1&n&&nt(0,"div",20),2&n&&vi(mr(2,ure))}function fre(n,t){1&n&&(ee(0,"div",21)(1,"div",22)(2,"div",23),we(3,"autorenew"),ce(),ee(4,"div",24),we(5,"autorenew"),ce()()())}const rF=function(n,t){return{height:n,transform:t}};function hre(n,t){if(1&n&&(nt(0,"img",25),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",fi(5,rF,+e.gameCharacter.komaImageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) scaleY(0.5) translateY(-150%) translateY("+e.size*e.gridSize+"px)"))("src",Nt(1,2,e.imageFile.url,"resourceUrl"),fn)}}const gre=function(n){return{width:"100%",transform:n}};function pre(n,t){if(1&n&&(nt(0,"img",25),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",Rt(5,gre,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) scaleY(0.5) translateY(-150%) translateY("+e.size*e.gridSize+"px)"))("src",Nt(1,2,e.imageFile.url,"resourceUrl"),fn)}}function _re(n,t){if(1&n&&(ee(0,"div",35),nt(1,"div",37),ce()),2&n){const e=t.$implicit,i=_e(6);W(1),oe("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!0)}}const bd=function(n){return{transform:n}};function mre(n,t){if(1&n){const e=ht();ee(0,"div",29)(1,"div",30),nt(2,"img",15),ce(),ee(3,"div",13)(4,"div",31),Re("mousedown",function(){return ze(e),_e(5).foldingBuffFlag(!0)}),we(5,"\u25bc"),ce(),ee(6,"div",32),Se(7,_re,2,3,"div",33),ce()(),ee(8,"div",13)(9,"div",31),Re("mousedown",function(){return ze(e),_e(5).foldingBuffFlag(!1)}),we(10,"\u25b2"),ce(),ee(11,"div",34)(12,"div",35)(13,"div",36),we(14),ce()()()()()}if(2&n){const e=_e(5);oe("ngStyle",Rt(6,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(-100%)")),W(1),oe("hidden",!e.gameCharacter.targeted),W(2),oe("hidden",e.foldingBuff),W(4),oe("ngForOf",e.gameCharacter.buffDataElement.children),W(1),oe("hidden",!e.foldingBuff),W(6),ln("\u7c21\u6613\u8868\u793a\u4e2d/\u30d0\u30d5",e.buffNum,"\u500b")}}function $re(n,t){if(1&n&&(ee(0,"div",35),nt(1,"div",37),ce()),2&n){const e=t.$implicit,i=_e(6);W(1),oe("gameDataElement",e)("isEdit",i.isEdit)("isPieceMode",!0)}}const vre=function(){return{transform:"rotateY(180deg)"}};function bre(n,t){if(1&n){const e=ht();ee(0,"div",29)(1,"div",38),nt(2,"img",15),ce(),ee(3,"div",13)(4,"div",31),Re("mousedown",function(){return ze(e),_e(5).foldingBuffFlag(!0)}),we(5,"\u25bc"),ce(),ee(6,"div",34),Se(7,$re,2,3,"div",33),ce()(),ee(8,"div",13)(9,"div",31),Re("mousedown",function(){return ze(e),_e(5).foldingBuffFlag(!1)}),we(10,"\u25b2"),ce(),ee(11,"div",34)(12,"div",35)(13,"div",36),we(14),ce()()()()()}if(2&n){const e=_e(5);oe("ngStyle",Rt(7,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(-100%) rotateY(180deg)")),W(1),oe("hidden",!e.gameCharacter.targeted)("ngStyle",mr(9,vre)),W(2),oe("hidden",e.foldingBuff),W(4),oe("ngForOf",e.gameCharacter.buffDataElement.children),W(1),oe("hidden",!e.foldingBuff),W(6),ln("\u7c21\u6613\u8868\u793a\u4e2d/\u30d0\u30d5",e.buffNum,"\u500b")}}function yre(n,t){if(1&n&&(Je(0),Se(1,mre,15,8,"div",28),Se(2,bre,15,10,"div",28),et()),2&n){const e=_e(4);W(1),oe("ngIf",e.gameCharacter.buffDataElement),W(1),oe("ngIf",e.gameCharacter.buffDataElement)}}function Cre(n,t){if(1&n&&(Je(0),Se(1,yre,3,2,"ng-container",16),et()),2&n){const e=t.$implicit;W(1),oe("ngIf",e.children.length>0)}}function xre(n,t){if(1&n&&(Je(0),Se(1,Cre,2,1,"ng-container",27),et()),2&n){const e=_e(2);W(1),oe("ngForOf",e.gameCharacter.buffDataElement.children)}}function wre(n,t){if(1&n&&(ee(0,"div",26),Se(1,xre,2,1,"ng-container",16),ce()),2&n){const e=_e();W(1),oe("ngIf",1==e.gameCharacter.buffDataElement.children.length)}}function Ere(n,t){1&n&&(Je(0),ee(1,"i",42),we(2,"lock"),ce(),et())}const oF=function(n){return{transform:n,"background-color":"rgba(255,255,255, 0.6)",color:"#333",border:"solid 1px #555"}};function Tre(n,t){if(1&n&&(ee(0,"div",40)(1,"div",41),we(2),Se(3,Ere,3,0,"ng-container",16),ce()()),2&n){const e=_e(2);oe("ngStyle",Rt(3,oF,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),ln("",e.name," "),W(1),oe("ngIf",e.isLock)}}function Sre(n,t){1&n&&(Je(0),ee(1,"i",42),we(2,"lock"),ce(),et())}function Dre(n,t){if(1&n&&(ee(0,"div",40)(1,"div",41),we(2),Se(3,Sre,3,0,"ng-container",16),ce()()),2&n){const e=_e(2);oe("ngStyle",Rt(3,oF,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),W(2),ln("",e.name," "),W(1),oe("ngIf",e.isLock)}}function Ire(n,t){if(1&n&&(Je(0),Se(1,Tre,4,5,"div",39),Se(2,Dre,4,5,"div",39),et()),2&n){const e=_e();W(1),oe("ngIf",0<e.name.length),W(1),oe("ngIf",0<e.name.length)}}function kre(n,t){1&n&&(Je(0),ee(1,"i",42),we(2,"lock"),ce(),et())}function Mre(n,t){if(1&n&&(ee(0,"div",40)(1,"div",41),we(2),Se(3,kre,3,0,"ng-container",16),ce()()),2&n){const e=_e(2);oe("ngStyle",Rt(3,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(2),ln("",e.name," "),W(1),oe("ngIf",e.isLock)}}function Are(n,t){1&n&&(Je(0),ee(1,"i",42),we(2,"lock"),ce(),et())}function Pre(n,t){if(1&n&&(ee(0,"div",40)(1,"div",41),we(2),Se(3,Are,3,0,"ng-container",16),ce()()),2&n){const e=_e(2);oe("ngStyle",Rt(3,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateY(180deg)")),W(2),ln("",e.name," "),W(1),oe("ngIf",e.isLock)}}function Fre(n,t){if(1&n&&(Je(0),Se(1,Mre,4,5,"div",39),Se(2,Pre,4,5,"div",39),et()),2&n){const e=_e();W(1),oe("ngIf",0<e.name.length),W(1),oe("ngIf",0<e.name.length)}}function Rre(n,t){if(1&n&&(ee(0,"div",43)(1,"div",44)(2,"i",45),we(3,"autorenew"),ce()()()),2&n){const e=_e();W(1),oe("ngStyle",Rt(1,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY( -0px)"))}}function Nre(n,t){if(1&n&&(nt(0,"img",46),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",fi(5,rF,+e.gameCharacter.komaImageHeignt+"px","translateX(-50%) translateX("+e.size*e.gridSize/2+"px)"))("src",Nt(1,2,e.imageFile.url,"resourceUrl"),fn)}}const Ore=function(){return{width:"100%"}};function Bre(n,t){if(1&n&&(nt(0,"img",46),Ft(1,"safe")),2&n){const e=_e();oe("ngStyle",mr(5,Ore))("src",Nt(1,2,e.imageFile.url,"resourceUrl"),fn)}}function Lre(n,t){1&n&&(Je(0),ee(1,"i",45),we(2,"autorenew"),ce(),et())}function zre(n,t){if(1&n&&(ee(0,"div",48),Se(1,Lre,3,0,"ng-container",16),ce()),2&n){const e=_e(2);oe("ngStyle",Rt(2,bd,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px")),W(1),oe("ngIf",!e.isLock)}}function Ure(n,t){if(1&n&&(ee(0,"div",43),Se(1,zre,2,4,"div",47),ce()),2&n){const e=_e();W(1),oe("ngIf",!e.isLock)}}const sF=function(n){return{transform:n}};function Hre(n,t){if(1&n&&(ee(0,"div",49)(1,"div",26)(2,"span",50)(3,"i"),we(4),ce()(),ee(5,"span",51)(6,"i"),we(7),ce()()(),ee(8,"div",26)(9,"span",52),we(10),ce(),ee(11,"span",53),we(12),ce()(),ee(13,"div",54)(14,"span",50)(15,"i"),we(16),ce()(),ee(17,"span",51)(18,"i"),we(19),ce()()()()),2&n){const e=_e();cn("height",e.math.abs(e.altitude*e.gridSize)-0,"px"),oe("ngStyle",Rt(14,sF,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(1),cn("visibility",e.altitude>0?"visible":"hidden"),W(3),Ct(e.elevation),W(3),Ct(e.elevation),W(3),Ct(e.math.abs(e.altitude)),W(2),Ct(e.math.abs(e.altitude)),W(1),cn("visibility",e.altitude<0?"visible":"hidden"),oe("ngStyle",Rt(16,sF,"translateY("+(e.chatBubbleAltitude+4)+"px)")),W(3),Ct(e.elevation),W(3),Ct(e.elevation)}}let Vre=(()=>{class n{constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.gameCharacter=null,this.is3D=!1,this.foldingBuff=!1,this.gridSize=50,this.math=Math,this.viewRotateX=50,this.viewRotateZ=10,this.movableOption={},this.input=null,this.rotableOption={}}get isLock(){return this.gameCharacter.isLock}set isLock(e){this.gameCharacter.isLock=e}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get chatBubbleAltitude(){return 0}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Xe.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof Si&&this.gameCharacter.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CHK_TARGET_CHANGE",-1e3,e=>{Xe.instance.get(e.data.identifier)==this.gameCharacter&&this.changeDetector.detectChanges()}).on("HIGHTLIGHT_TABLETOP_OBJECT",e=>{this.gameCharacter.identifier===e.data.identifier&&"table"==this.gameCharacter.location.name&&(console.log(`recv focus event to ${this.gameCharacter.name}`),null==this.highlightTimer&&(this.rootElementRef.nativeElement.classList.contains("focused")&&(clearTimeout(this.unhighlightTimer),this.rootElementRef.nativeElement.classList.remove("focused")),this.highlightTimer=setTimeout(()=>{this.highlightTimer=null,this.rootElementRef.nativeElement.classList.add("focused")},0),this.unhighlightTimer=setTimeout(()=>{this.unhighlightTimer=null,this.rootElementRef.nativeElement.classList.remove("focused")},1010)))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new fa(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Qe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Qe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9ad8\u5ea6\u8a2d\u5b9a",action:null,subActions:[{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,mt.play(ut.sweep))},altitudeHande:this.gameCharacter},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,mt.play(ut.sweep),Qe.trigger("UPDATE_INVENTORY",null)}}]},xi,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30ea\u30e2\u30b3\u30f3\u3092\u8868\u793a",action:()=>{this.showRemoteController(this.gameCharacter)}},{name:"\u30d0\u30d5\u7de8\u96c6",action:()=>{this.showBuffEdit(this.gameCharacter)}},xi,{name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),mt.play(ut.piecePut)}},{name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation($t.peerId),mt.play(ut.piecePut)}},{name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),mt.play(ut.sweep)}},xi,this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,mt.play(ut.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,mt.play(ut.lock)}},xi,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),mt.play(ut.piecePut)}}],this.name)}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}onMove(){mt.play(ut.piecePick)}onMoved(){mt.play(ut.piecePut)}checkKey(e){let i=e||window.event,r=i.shiftKey,o=i.ctrlKey,s=i.altKey,a=i.metaKey;if(r&&console.log("shift\u30ad\u30fc"),o&&console.log("ctrl\u30ad\u30fc"),s&&(console.log("alt\u30ad\u30fc"),this.gameCharacter.targeted=!this.gameCharacter.targeted),a&&console.log("meta\u30ad\u30fc"),r&&s){console.log("shift+ALT\u30ad\u30fc");let g=Xe.instance.getObjects(Bt);for(let w of g)w.targeted=!1,Qe.trigger("CHK_TARGET_CHANGE",{identifier:w.identifier,className:w.aliasName})}}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(xl,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(BP,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}showRemoteController(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(UP,{left:i.x-250,top:i.y-175,width:700,height:600}).character=e}showBuffEdit(e){let i=this.pointerDeviceService.pointers[0],r={left:i.x,top:i.y,width:420,height:300};r.title=e.name+"\u306e\u30d0\u30d5\u7de8\u96c6",this.panelService.open(zP,r).character=e}foldingBuffFlag(e){console.log("private foldingBuffFlag"),this.foldingBuff=e}get buffNum(){return 0==this.gameCharacter.buffDataElement.children.length?0:this.gameCharacter.buffDataElement.children[0].children.length}}return n.\u0275fac=function(e){return new(e||n)(Be(An),Be(To),Be(di),Be($n),Be(bi),Be(Di))},n.\u0275cmp=Xt({type:n,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&Gn(are,5),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&Re("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:25,vars:34,consts:[["appMovable","",1,"dummy-will-change",3,"movable.option"],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend","mousedown"],["root",""],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","pedestal-inner is-3d",3,"style",4,"ngIf"],[1,"pedestal-outer"],["class","pedestal-grab rotate-grab will-change",4,"ngIf"],["class","image is-pointer-events-none chrome-smooth-image-trick","style","filter: brightness(0) opacity(0.7) blur(1px);",3,"ngStyle","src",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngStyle"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","is-3d",4,"ngIf"],[3,"hidden"],[1,"target-icon","scrolldown4",3,"hidden","ngStyle"],["src","./assets/images/target/target.png"],[4,"ngIf"],["class","grab-group is-3d",4,"ngIf"],["class","image is-3d chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"pedestal-inner","is-3d"],[1,"pedestal-grab","rotate-grab","will-change"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"image","is-pointer-events-none","chrome-smooth-image-trick",2,"filter","brightness(0) opacity(0.7) blur(1px)",3,"ngStyle","src"],[1,"is-3d"],[4,"ngFor","ngForOf"],["style","","class","buff-tag is-nowrap is-buff-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],[1,"buff-tag","is-nowrap","is-buff-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"target-icon-buff","scrolldown5",3,"hidden"],[1,"buff-folding-icon",3,"mousedown"],[1,"!table","is-3d"],["class","flex-item is-3d",4,"ngFor","ngForOf"],[1,"table","is-3d"],[1,"flex-item","is-3d"],[1,"table-row","fornt-tag","is-3d",2,"font-family","Cambria, Georgia","font-size","12px"],["game-data-element-buff","",1,"table-row","fornt-tag","is-3d",3,"gameDataElement","isEdit","isPieceMode"],[1,"target-icon-buff2","scrolldown5",3,"hidden","ngStyle"],["class","name-tag is-nowrap is-black-background is-3d will-change backface-off",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background","is-3d","will-change","backface-off",3,"ngStyle"],[1,"has-length-limit","is-3d"],[1,"material-icons","lock-icon",2,"display","inline"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d","will-change",3,"ngStyle"],[1,"material-icons","will-change"],[1,"image","is-3d","chrome-smooth-image-trick",3,"ngStyle","src"],["class","rotate-grab rotate-grab-icon of-bottom is-3d will-change",3,"ngStyle",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d","will-change",3,"ngStyle"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(nt(0,"div",0),ee(1,"div",1,2),Re("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()})("mousedown",function(o){return i.checkKey(o)}),ee(3,"div",3)(4,"div",4),Re("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Se(5,cre,1,3,"div",5),Se(6,dre,1,3,"div",5),nt(7,"div",6),Se(8,fre,6,0,"div",7),Se(9,hre,2,8,"img",8),Se(10,pre,2,7,"img",8),ee(11,"div",9)(12,"div",10),Re("rotable.valueChange",function(o){return i.roll=o})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),ee(13,"div",11),Se(14,wre,2,1,"div",12),ee(15,"div",13)(16,"div",14),nt(17,"img",15),ce()(),Se(18,Ire,3,2,"ng-container",16),Se(19,Fre,3,2,"ng-container",16),Se(20,Rre,4,3,"div",17),Se(21,Nre,2,8,"img",18),Se(22,Bre,2,6,"img",18),Se(23,Ure,2,1,"div",17),ce()()()(),Se(24,Hre,20,18,"div",19),ce()()),2&e&&(oe("movable.option",i.movableOption),W(1),cn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("movable.option",i.movableOption),W(2),oe("@bounceInOut","in"),W(1),oe("rotable.option",i.rotableOption),W(1),oe("ngIf",!i.gameCharacter.hideInventory),W(1),oe("ngIf",i.gameCharacter.hideInventory),W(2),oe("ngIf",!i.isLock),W(1),oe("ngIf",i.isDropShadow&&0<i.imageFile.url.length&&i.gameCharacter.specifyKomaImageFlag),W(1),oe("ngIf",i.isDropShadow&&0<i.imageFile.url.length&&!i.gameCharacter.specifyKomaImageFlag),W(1),oe("ngStyle",Rt(30,bd,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),W(1),cn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("rotable.value",i.roll),W(2),oe("ngIf",i.gameCharacter.buffDataElement),W(1),oe("hidden",0!=i.buffNum),W(1),oe("hidden",!i.gameCharacter.targeted)("ngStyle",Rt(32,bd,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px)")),W(2),oe("ngIf",i.gameCharacter.nonTalkFlag),W(1),oe("ngIf",!i.gameCharacter.nonTalkFlag),W(1),oe("ngIf",!i.isLock),W(1),oe("ngIf",0<i.imageFile.url.length&&i.gameCharacter.specifyKomaImageFlag),W(1),oe("ngIf",0<i.imageFile.url.length&&!i.gameCharacter.specifyKomaImageFlag),W(1),oe("ngIf",!i.isLock),W(1),oe("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},directives:[vd,Vf,Sn,bo,oi,LP],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.will-change[_ngcontent-%COMP%]{will-change:opacity}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.dummy-will-change[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;will-change:opacity}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;height:auto;vertical-align:bottom}.buff-tag[_ngcontent-%COMP%]{box-sizing:border-box;padding:3px 9px;border:1px #222 solid;border-radius:12px;position:absolute;margin:auto;top:-35px}.is-buff-background[_ngcontent-%COMP%]{color:#222;background-color:#f0e5d7cc}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.backface-off[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.component.focused[_ngcontent-%COMP%]{animation-name:focused;animation-timing-function:ease;animation-duration:1s}.lock-icon[_ngcontent-%COMP%]{font-size:15px;vertical-align:middle}@keyframes focused{0%{box-shadow:none}50%{box-shadow:0 0 10px 5px #ff0,inset 0 0 10px 5px #ff0}to{box-shadow:none}}.buff-folding-dummy[_ngcontent-%COMP%]{width:1px;height:1px}.buff-folding-icon[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle;text-align:center;margin-left:100%;position:absolute;width:20px;height:20px;left:-20px;top:-20px;background-color:#f0e5d7cc;box-sizing:border-box;border:1px #222 solid;border-radius:4px;cursor:pointer}.target-icon[_ngcontent-%COMP%]{width:30px;font-size:20px;left:6px;box-sizing:border-box;position:absolute}.scrolldown4[_ngcontent-%COMP%]{position:absolute;animation:arrowmove 1s ease-in-out infinite}@keyframes arrowmove{0%{top:-80px}to{top:-60px}}.scrolldown4[_ngcontent-%COMP%]:before{top:-60px}.scrolldown4[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-80px}.target-icon-buff[_ngcontent-%COMP%]{width:30px;font-size:20px;margin-left:50%;left:-10px;box-sizing:border-box;position:absolute;margin-top:}.target-icon-buff2[_ngcontent-%COMP%]{width:30px;font-size:20px;margin-left:50%;left:-20px;box-sizing:border-box;position:absolute;margin-top:}.scrolldown5[_ngcontent-%COMP%]{position:absolute;animation:arrowmove2 1s ease-in-out infinite}@keyframes arrowmove2{0%{top:-50px}to{top:-30px}}.scrolldown5[_ngcontent-%COMP%]:before{top:-30px}.scrolldown5[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-50px}'],data:{animation:[Na("bounceInOut",[Br("void => *",[Or("600ms ease",Ns([mn({transform:"scale3d(0, 0, 0)",offset:0}),mn({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),mn({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),mn({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),mn({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Br("* => void",[Or(100,mn({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();const jre=["root"],Gre=["gameTable"],qre=["gameObjects"],Wre=["gridCanvas"];function Zre(n,t){1&n&&nt(0,"terrain",21),2&n&&oe("terrain",t.$implicit)}function Yre(n,t){if(1&n&&(ee(0,"div",19),nt(1,"div",15),Se(2,Zre,1,1,"terrain",20),ce()),2&n){const e=_e();W(2),oe("ngForOf",e.terrains)("ngForTrackBy",e.trackByGameObject)}}function Kre(n,t){1&n&&nt(0,"game-table-mask",22),2&n&&oe("gameTableMask",t.$implicit)}function Xre(n,t){1&n&&nt(0,"game-table-scratch-mask",23),2&n&&oe("gameTableScratchMask",t.$implicit)}const Qre=function(n){return{"z-index":n}};function Jre(n,t){if(1&n&&nt(0,"text-note",25),2&n){const e=t.$implicit;oe("textNote",e)("appTooltip",e)("ngStyle",Rt(3,Qre,e.zindex))}}function eoe(n,t){if(1&n&&(ee(0,"div",19),nt(1,"div",15),Se(2,Jre,1,5,"text-note",24),ce()),2&n){const e=_e();W(2),oe("ngForOf",e.textNotes)("ngForTrackBy",e.trackByGameObject)}}const aF=function(n,t){return{"z-index":n,transform:t}};function toe(n,t){if(1&n&&nt(0,"card-stack",26),2&n){const e=t.$implicit;oe("cardStack",e)("appTooltip",e)("ngStyle",fi(3,aF,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function noe(n,t){if(1&n&&nt(0,"card",27),2&n){const e=t.$implicit;oe("card",e)("appTooltip",e)("ngStyle",fi(3,aF,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function ioe(n,t){1&n&&nt(0,"peer-cursor",28),2&n&&oe("cursor",t.$implicit)}function roe(n,t){1&n&&nt(0,"range",29),2&n&&oe("range",t.$implicit)}function ooe(n,t){if(1&n&&nt(0,"dice-symbol",31),2&n){const e=t.$implicit;oe("diceSymbol",e)("appTooltip",e)}}function soe(n,t){if(1&n&&(ee(0,"div",19),nt(1,"div",15),Se(2,ooe,1,2,"dice-symbol",30),ce()),2&n){const e=_e();W(2),oe("ngForOf",e.diceSymbols)("ngForTrackBy",e.trackByGameObject)}}function aoe(n,t){if(1&n&&nt(0,"game-character",33),2&n){const e=t.$implicit;oe("gameCharacter",e)("appTooltip",e)}}function loe(n,t){if(1&n&&(ee(0,"div",19),nt(1,"div",15),Se(2,aoe,1,2,"game-character",32),ce()),2&n){const e=_e();W(2),oe("ngForOf",e.characters)("ngForTrackBy",e.trackByGameObject)}}function coe(n,t){1&n&&nt(0,"peer-cursor",28),2&n&&oe("cursor",t.$implicit)}const uoe=function(n,t){return[n,t]},doe=function(n){return{"is-grabbing":n}};let foe=(()=>{class n{constructor(e,i,r,o,s,a,g,w,G){this.changeDetector=e,this.ngZone=i,this.contextMenuService=r,this.pointerDeviceService=o,this.coordinateService=s,this.imageService=a,this.tabletopService=g,this.tabletopActionService=w,this.modalService=G,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get roomGridDispAlways(){let e=Xe.instance.get("Config");return!!e&&e.roomGridDispAlways}set roomGridDispAlways(e){let i=Xe.instance.get("Config");i&&(i.roomGridDispAlways=e)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get tableScratchMasks(){return this.tabletopService.tableScratchMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}ngOnInit(){Qe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("RE_DRAW_TABLE",e=>{console.log("\u30c6\u30fc\u30d6\u30eb\u518d\u63cf\u753b"),this.changeDetector.detectChanges(),this.changeDetector.markForCheck()}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1;let i=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(i=1),this.gridCanvas.nativeElement.style.opacity=i+""}).on("FOCUS_TO_TABLETOP_COORDINATE",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.2s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=this.viewRotateZ/180*Math.PI,g=o*Math.cos(a)-s*Math.sin(a),w=o*Math.sin(a)+s*Math.cos(a),G=this.viewRotateX/180*Math.PI,me=w*Math.cos(G),ve=w*Math.sin(G);this.setTransform(100-g-this.viewPotisonX,-me-this.viewPotisonY,-ve-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects(),this.tabletopActionService.initAprilDiceImage()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Qe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new Kee(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new Yee(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,g,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let G=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=G,i*=G,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1",Qe.trigger("DISP_TERRAIN_GRID",{})),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput(),Qe.trigger("DISP_TERRAIN_GRID_END",{})}onTableMouseTransform(e,i,r,o,s,a,g,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let G=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=G,i*=G,r,o,s,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1;let e=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(e=1),this.gridCanvas.nativeElement.style.opacity=e+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(xi),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(HP)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,(0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{Qe.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=$s.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new WP(this.gridCanvas.nativeElement).render(e,i,r,o,s),setTimeout(()=>{let g=this.tableSelecter.gridShow?1:0;this.roomGridDispAlways&&(g=1),this.gridCanvas.nativeElement.style.opacity=g+"",console.log("\u30b0\u30ea\u30c3\u30c9\u63cf\u753b")},0)}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Be(bi),Be(An),Be(To),Be(Di),Be(md),Be(Ng),Be(qm),Be(Zm),Be(hi))},n.\u0275cmp=Xt({type:n,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(Gn(jre,7),Gn(Gre,7),Gn(qre,7),Gn(Wre,7)),2&e){let r;yn(r=Cn())&&(i.rootElementRef=r.first),yn(r=Cn())&&(i.gameTable=r.first),yn(r=Cn())&&(i.gameObjects=r.first),yn(r=Cn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Re("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,Ah)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,Ah)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,Ah)},decls:26,vars:35,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d-2"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d-2"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none"],["gridCanvas",""],["class","layer",4,"ngIf"],["class","is-3d will-change-transform",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"gameTableScratchMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"range"],[1,"dummy"],["class","is-3d will-change-transform",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d will-change-transform",3,"range",4,"ngFor","ngForOf","ngForTrackBy"],[1,"layer","cursor-layer"],[1,"layer"],["class","is-3d will-change-transform",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"terrain"],[1,"is-3d","will-change-transform",3,"gameTableMask"],[1,"is-3d","will-change-transform",3,"gameTableScratchMask"],["class","is-3d will-change-transform",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"textNote","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"card","appTooltip","ngStyle"],[1,"is-3d","will-change-transform",3,"cursor"],[1,"is-3d","will-change-transform",3,"range"],["class","is-3d will-change-transform",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"diceSymbol","appTooltip"],["class","is-3d will-change-transform",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d","will-change-transform",3,"gameCharacter","appTooltip"]],template:function(e,i){1&e&&(ee(0,"div",0),Ft(1,"safe"),ce(),ee(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Ft(8,"safe"),nt(9,"canvas",7,8),Se(11,Yre,3,2,"div",9),Se(12,Kre,1,1,"game-table-mask",10),Se(13,Xre,1,1,"game-table-scratch-mask",11),Se(14,eoe,3,2,"div",9),Se(15,toe,1,6,"card-stack",12),Se(16,noe,1,6,"card",13),ee(17,"div",14),nt(18,"div",15),Se(19,ioe,1,1,"peer-cursor",16),ce(),Se(20,roe,1,1,"range",17),Se(21,soe,3,2,"div",9),Se(22,loe,3,2,"div",9),ee(23,"div",18),nt(24,"div",15),Se(25,coe,1,1,"peer-cursor",16),ce()()()()),2&e&&(cn("background-image",Nt(1,24,"url("+i.backgroundImage.url+")","style")),oe("ngClass",fi(30,uoe,i.backgroundFilterType?"is-filter":"",i.backgroundFilterType)),W(2),oe("ngClass",Rt(33,doe,i.isPointerDragging)),W(4),cn("background-image",Nt(8,27,"url("+i.tableImage.url+")","style")),W(5),oe("ngIf",i.terrains.length>0),W(1),oe("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),W(1),oe("ngForOf",i.tableScratchMasks)("ngForTrackBy",i.trackByGameObject),W(1),oe("ngIf",i.textNotes.length>0),W(1),oe("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),W(1),oe("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),W(3),oe("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject),W(1),oe("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),W(1),oe("ngIf",i.diceSymbols.length>0),W(1),oe("ngIf",i.characters.length>0),W(3),oe("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[nr,Sn,oi,gte,Nte,jte,qw,bo,$ie,wie,kie,Vie,sre,Vre],pipes:[Ii],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:visible;backface-visibility:visible;position:absolute}.is-3d-2[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.will-change-transform[_ngcontent-%COMP%]{will-change:transform;-webkit-backface-visibility:visible;backface-visibility:visible}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.dummy[_ngcontent-%COMP%]{position:absolute;height:1px;width:1px;content:"";will-change:opacity;pointer-events:none;transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:translate(0)}.layer[_ngcontent-%COMP%]{transform-style:preserve-3d;position:absolute;pointer-events:none;top:0;left:0;bottom:0;right:0;margin:auto}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}']}),n})(),hoe=(()=>{class n{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Qe.register(this).on("*",i=>{this.needRepeat||$t.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Qe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Be(di))},n.\u0275cmp=Xt({type:n,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(ee(0,"div",0),nt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),ee(10,"div",10),we(11,"sync"),ce()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),n})();const goe=["modalLayer"];function poe(n,t){if(1&n){const e=ht();ee(0,"li",2),Re("click",function(){return ze(e),_e().save()}),ee(1,"a",3)(2,"div")(3,"i",5),we(4,"sd_storage"),ce()(),ee(5,"div"),we(6,"\u4fdd\u5b58"),ce()()()}}function _oe(n,t){if(1&n&&(ee(0,"li",11)(1,"a")(2,"div")(3,"i",12),we(4,"sd_storage"),ce()(),ee(5,"div"),we(6),ce()()()),2&n){const e=_e();W(6),ln("",e.progresPercent,"%")}}let moe=(()=>{class n{constructor(e,i,r,o,s,a,g,w){var G=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngSelectConfig=g,this.ngZone=w,this.networkService=$t,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.dispcounter=10,this.ngZone.runOutsideAngular(()=>{yl.instance.initialize(),Mg.instance.initialize(),kg.instance.initialize(),Ag.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),this.ngSelectConfig.appendTo="body",da.instance.initialize(),Ls.instance.initialize(),Of.instance.initialize(),ja.instance.initialize(),new or("DiceBot").initialize(),or.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new zf("Jukebox").initialize(),new Lw("markdwon").initialize(),new _c("CutInLauncher").initialize(),new Cl("Vote").initialize(),new Ga("Alarm").initialize(),new Bw("ReloadCheck").initialize(),new mt("SoundEffect").initialize(),Ls.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Ls.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let ct=Ot.createEmpty("none_icon").toContext();ct.url="./assets/images/ic_account_circle_black_24dp_2x.png";let rt=xt.instance.add(ct);Qt.resumeAudioContext(),ut.dicePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,ut.dicePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,ut.diceRoll1=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,ut.diceRoll2=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,ut.cardDraw=Jt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,ut.cardPick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,ut.cardPut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,ut.cardShuffle=Jt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,ut.piecePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,ut.piecePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,ut.blockPick=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,ut.blockPut=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,ut.lock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,ut.unlock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,ut.sweep=Jt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,ut.alarm=Jt.instance.add("./assets/sounds/alarm/alarm.mp3").identifier,Jt.instance.get(ut.dicePick).isHidden=!0,Jt.instance.get(ut.dicePut).isHidden=!0,Jt.instance.get(ut.diceRoll1).isHidden=!0,Jt.instance.get(ut.diceRoll2).isHidden=!0,Jt.instance.get(ut.cardDraw).isHidden=!0,Jt.instance.get(ut.cardPick).isHidden=!0,Jt.instance.get(ut.cardPut).isHidden=!0,Jt.instance.get(ut.cardShuffle).isHidden=!0,Jt.instance.get(ut.piecePick).isHidden=!0,Jt.instance.get(ut.piecePut).isHidden=!0,Jt.instance.get(ut.blockPick).isHidden=!0,Jt.instance.get(ut.blockPut).isHidden=!0,Jt.instance.get(ut.lock).isHidden=!0,Jt.instance.get(ut.unlock).isHidden=!0,Jt.instance.get(ut.sweep).isHidden=!0,Jt.instance.get(ut.alarm).isHidden=!0,_t.createMyCursor(),_t.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",_t.myCursor.imageIdentifier=rt.identifier,Qe.register(this).on("ALARM_TIMEUP_ORIGIN",ft=>{this.alarmTimeUpOrigin(ft.data.text)}).on("ALARM_POP",ft=>{this.alarmPop(ft.data.title,ft.data.time)}).on("START_VOTE",ft=>{this.startVote()}).on("FINISH_VOTE",ft=>{this.finishVote(ft.data.text)}).on("START_CUT_IN",ft=>{this.startCutIn(ft.data.cutIn)}).on("STOP_CUT_IN",ft=>{!ft.data.cutIn||console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a4\u30d9\u30f3\u30c8_\u30b9\u30c8\u30c3\u30d7"+ft.data.cutIn.name)}).on("UPDATE_GAME_OBJECT",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("DELETE_GAME_OBJECT",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",ft=>{ft.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",ft=>{ft.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",ft=>{console.log("LOAD_CONFIG !!!"),$t.setApiKey(ft.data.webrtc.key),$t.open()}).on("FILE_LOADED",ft=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",ft=>{console.log("OPEN_NETWORK",ft.data.peerId),_t.myCursor.peerId=$t.peerContext.peerId,_t.myCursor.userId=$t.peerContext.userId}).on("NETWORK_ERROR",ft=>{console.log("NETWORK_ERROR",ft.data.peerId);let Lt=ft.data.errorType,wt=ft.data.errorMessage;this.ngZone.run((0,xn.Z)(function*(){["peer-unavailable"].includes(Lt)||(yield G.modalService.open(Vw,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:wt}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(Lt)&&(yield G.modalService.open(Vw,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),$t.open()))}))}).on("CONNECT_PEER",ft=>{ft.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(ft.isSendFromSelf)}).on("DISCONNECT_PEER",ft=>{this.lazyNgZoneUpdate(ft.isSendFromSelf)})}get reloadCheck(){return Xe.instance.get("ReloadCheck")}ngAfterViewInit(){$n.defaultParentViewContainerRef=hi.defaultParentViewContainerRef=To.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(VP,{width:500,height:450,left:100}),this.panelService.open(NP,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){Qe.unregister(this)}alarmTimeUpOrigin(e){Xe.instance.get("Alarm"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}alarmTimeUpTarget(e){Xe.instance.get("Alarm"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}startVote(){if(console.log("\u70b9\u547c/\u6295\u7968\u30a4\u30d9\u30f3\u30c8_\u30b9\u30bf\u30fc\u30c8"),!Xe.instance.get("Vote").chkToMe())return;let i={left:0,top:0,width:450,height:400,title:"\u70b9\u547c/\u6295\u7968"},r=(window.innerWidth-i.width)/2,o=(window.innerHeight-i.height)/2;r<0&&(r=0),o<0&&(o=0),i.left=r,i.top=o,this.panelService.open(Gee,i)}finishVote(e){console.log("\u6295\u7968\u96c6\u8a08\u5b8c\u4e86"),this.chatMessageService.sendSystemMessageLastSendCharactor(e)}alarmPop(e,i){console.log("\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7_\u30b9\u30bf\u30fc\u30c8"+e);let s={width:200,height:100,left:300,top:100};s.title="\u30a2\u30e9\u30fc\u30e0 "+e,console.log("POP\u753b\u9762\u9818\u57df w:"+window.innerWidth+" h:"+window.innerHeight),console.log("POP\u30b5\u30a4\u30ba w:200 h:100");let a=window.innerWidth-200,g=window.innerHeight-100-25;a<0&&(a=0),g<0&&(g=0);let w=.5*a,G=.5*g;s.width=200,s.height=125,s.left=w,s.top=G;let me=this.panelService.open(Zee,s);me.title=e,me.time=i}startCutIn(e){if(!e)return;console.log("\u30ab\u30c3\u30c8\u30a4\u30f3\u30a4\u30d9\u30f3\u30c8_\u30b9\u30bf\u30fc\u30c8"+e.name);let i={width:200,height:100,left:300,top:100};i.title="\u30ab\u30c3\u30c8\u30a4\u30f3 : "+e.name,console.log("\u753b\u9762\u9818\u57df w:"+window.innerWidth+" h:"+window.innerHeight);let r=e.width,o=e.height;console.log("\u753b\u50cf\u30b5\u30a4\u30ba w:"+r+" h:"+o);let s=window.innerWidth-r,a=window.innerHeight-o-25;s<0&&(s=0),a<0&&(a=0);let g=s*e.x_pos/100,w=a*e.y_pos/100;i.width=r,i.height=o+25,i.left=g,i.top=w,i.isCutIn=!0,i.cutInIdentifier=e.identifier;let G=this.panelService.open(Dee,i);G.cutIn=e,G.startCutIn()}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=VP;break;case"ChatWindowComponent":i=NP,r.width=700;break;case"GameTableSettingComponent":i=HP,r={width:630,height:500,left:100};break;case"FileStorageComponent":i=bZ;break;case"GameCharacterSheetComponent":i=xl;break;case"JukeboxComponent":i=pJ;break;case"GameCharacterGeneratorComponent":i=DZ,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=mQ}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,xn.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=$t.peerContext&&0<$t.peerContext.roomName.length?$t.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;this.reloadCheck.reloadCheckStart(""!=this.networkService.peerContext.roomName),r.length&&yl.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}}return n.\u0275fac=function(e){return new(e||n)(Be(hi),Be($n),Be(Di),Be(Eo),Be(Mw),Be(ko),Be(Sk),Be(An))},n.\u0275cmp=Xt({type:n,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&Gn(goe,7,us),2&e){let r;yn(r=Cn())&&(i.modalLayerViewContainerRef=r.first)}},decls:61,vars:8,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(ee(0,"div",0),nt(1,"game-table"),ce(),ee(2,"ui-panel",1)(3,"nav")(4,"ul")(5,"li",2),Re("click",function(){return i.open("PeerMenuComponent")}),ee(6,"a",3)(7,"div")(8,"i",4),we(9,"people"),ce()(),ee(10,"div"),we(11,"\u63a5\u7d9a"),ce()()(),ee(12,"li",2),Re("click",function(){return i.open("ChatWindowComponent")}),ee(13,"a",3)(14,"div")(15,"i",4),we(16,"speaker_notes"),ce()(),ee(17,"div"),we(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),ce()()(),ee(19,"li",2),Re("click",function(){return i.open("GameTableSettingComponent")}),ee(20,"a",3)(21,"div")(22,"i",4),we(23,"layers"),ce()(),ee(24,"div"),we(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),ce()()(),ee(26,"li",2),Re("click",function(){return i.open("FileStorageComponent")}),ee(27,"a",3)(28,"div")(29,"i",4),we(30,"photo_library"),ce()(),ee(31,"div"),we(32,"\u753b\u50cf"),ce()()(),ee(33,"li",2),Re("click",function(){return i.open("JukeboxComponent")}),ee(34,"a",3)(35,"div")(36,"i",5),we(37,"queue_music"),ce()(),ee(38,"div"),we(39,"\u97f3\u697d"),ce()()(),ee(40,"li",2),Re("click",function(){return i.open("GameObjectInventoryComponent")}),ee(41,"a",3)(42,"div")(43,"i",4),we(44,"folder_shared"),ce()(),ee(45,"div"),we(46,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ce()()(),ee(47,"li")(48,"a",3)(49,"label")(50,"div")(51,"i",5),we(52,"open_in_browser"),ce()(),ee(53,"div"),we(54,"ZIP\u8aad\u8fbc"),ce(),ee(55,"input",6),Re("change",function(o){return i.handleFileSelect(o)}),ce()()()(),Se(56,poe,7,0,"li",7),Se(57,_oe,7,1,"li",8),ce()()(),nt(58,"div",null,9)(60,"network-indicator",10)),2&e&&(W(2),oe("top",0)("left",0)("width",105)("height",475)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),W(54),oe("ngIf",!i.isSaveing),W(1),oe("ngIf",i.isSaveing))},directives:[foe,qP,Sn,hoe],styles:["img[_ngcontent-%COMP%]{height:5px;width:5px}.dummydisp[_ngcontent-%COMP%]{position:absolute;color:#1e1e1e00;font-size:10px;max-height:5px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0px;left:0px;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]}),n})();$n.UIPanelComponentClass=qP,To.ContextMenuComponentClass=fZ,hi.ModalComponentClass=$J;let $oe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ts({type:n,bootstrap:[moe]}),n.\u0275inj=es({providers:[Mw,Eo,To,hi,ab,$n,Di,qm],imports:[[aD,gL,M2,_8,WL,G9,y9]]}),n})();(function QR(){wS=!1})(),nO().bootstrapModule($oe).catch(n=>console.error(n))},5904:(E,de,ye)=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0}),ye(8827),ye(4748),ye(9202),ye(8465);var f=ye(3583),T=ye(3693),ne=function(){function v(S,L){this.internal=null!=L?L:f.BCDice.Base.$new(S)}return v.eval=function(S){var L=f.BCDice.Base.$eval(S);return T.parseResult(L)},Object.defineProperty(v.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),v.prototype.eval=function(){var S=this.internal.$eval();return T.parseResult(S)},v}();de.default=ne},8827:(E,de,ye)=>{ye(9993),Opal.queue(function(f){var Z,H,Y,k,N,le,q,K,T=f.module,ne=f.ensure_kwargs,v=f.truthy,S=f.thrower,L=f.def,D=[],J=f.nil,j=f.$$$;return Z=D,H=K=[T(D[0],"BCDice")].concat(Z),q=[le=T(K[0],"ArithmeticEvaluator")].concat(H),k=[Y=f.get_singleton_class(le)].concat(q),N=f.$r(k),L(Y,"$eval",function(U,I){try{S("eval_return");var y,R=J;return null==(y=(I=ne(I)).$$smap.round_type)&&(y=j(N("RoundType"),"FLOOR")),v(U)&&v(R=N("Arithmetic").$eval(U,y))?R:0}catch(z){if(z===f.t_eval_return)return z.$v;throw z}},-2)})},9202:(E,de,ye)=>{ye(9993),Opal.modules.json=function(f){var q,le,T=f.module,ne=f.klass,v=f.send,S=f.Object,L=f.hash2,D=f.eqeqeq,J=f.defs,j=f.truthy,F=f.def,Z=f.return_val,X=[],K=f.nil,P=f.$$$;return function(H,le){var Y,q=T(H,"JSON"),Q=[q].concat(le),k=f.$r(Q);ne(Q[0],k("StandardError"),"JSONError"),ne(Q[0],k("JSONError"),"ParserError");var N=f.hasOwnProperty;function te(I){try{return JSON.parse(I)}catch(A){q.$raise(P(k("JSON"),"ParserError"),A.message)}}function U(I,A){var y,R,z,ie,M,ge;switch(typeof I){case"string":case"number":return I;case"boolean":return!!I;case"undefined":return K;case"object":if(!I)return K;if(I.$$is_array){for(R=A.array_class.$new(),ie=0,M=I.length;ie<M;ie++)R.$push(U(I[ie],A));return R}for(ge in z=A.object_class.$new(),I)N.call(I,ge)&&(Y=[ge,U(I[ge],A)],v(z,"[]=",Y));return A.parse||(y=z["$[]"](k("JSON").$create_id()))==K?z:S.$const_get(y).$json_create(z)}}f.get_singleton_class(q).$attr_accessor("create_id"),q["$create_id="]("json_class"),J(q,"$[]",function(A,y){return null==y&&(y=L([],{})),D(k("String"),A)?this.$parse(A,y):this.$generate(A,y)},-2),J(q,"$parse",function(A,y){return null==y&&(y=L([],{})),this.$from_object(te(A),y.$merge(L(["parse"],{parse:!0})))},-2),J(q,"$parse!",function(A,y){return null==y&&(y=L([],{})),this.$parse(A,y)},-2),J(q,"$load",function(A,y){return null==y&&(y=L([],{})),this.$from_object(te(A),y)},-2),J(q,"$from_object",function(A,y){return null==y&&(y=L([],{})),j(y["$[]"]("object_class"))||y["$[]="]("object_class",k("Hash")),j(y["$[]"]("array_class"))||y["$[]="]("array_class",k("Array")),U(A,y.$$smap)},-2),J(q,"$generate",function(A,y){return null==y&&(y=L([],{})),A.$to_json(y)},-2),J(q,"$dump",function(A,y,R){var ie;return null==y&&(y=K),null==R&&(R=K),ie=this.$generate(A),j(y)?(j(y["$responds_to?"]("to_io"))&&(y=y.$to_io()),y.$write(ie),y):ie},-2)}(X[0],X),q=ne(X[0],null,"Object"),F(q,"$to_json",function(){return this.$to_s().$to_json()}),le=T(X[0],"Enumerable"),F(le,"$to_json",function(){return this.$to_a().$to_json()}),function(H,le){var q=ne(H,null,"Array");F(q,"$to_json",function(){for(var k=[],N=0,te=this.length;N<te;N++)k.push(this[N].$to_json());return"["+k.join(",")+"]"})}(X[0]),function(H,le){var q=ne(H,null,"Boolean");F(q,"$to_json",function(){return 1==this?"true":"false"})}(X[0]),function(H,le){var q=ne(H,null,"Hash");F(q,"$to_json",function(){for(var I,A,k=[],N=0,te=this.$$keys,U=te.length;N<U;N++)(I=te[N]).$$is_string?A=this.$$smap[I]:(A=I.value,I=I.key),k.push(I.$to_s().$to_json()+":"+A.$to_json());return"{"+k.join(",")+"}"})}(X[0]),function(H,le){var q=ne(H,null,"NilClass");F(q,"$to_json",Z("null"))}(X[0]),function(H,le){var q=ne(H,null,"Numeric");F(q,"$to_json",function(){return this.toString()})}(X[0]),function(H,le){var q=ne(H,null,"String");F(q,"$to_json",function(){return JSON.stringify(this)})}(X[0]),function(H,le){var q=ne(H,null,"Time");F(q,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()})}(X[0]),function(H,le){var q=ne(H,null,"Date");return F(q,"$to_json",function(){return this.$to_s().$to_json()}),F(q,"$as_json",function(){return this.$to_s()})}(X[0])},Opal.modules.i18n=function(f){var N,I,y,R,te,U,T=f.module,ne=f.class_variable_set,v=f.class_variable_get,S=f.def,L=f.truthy,D=f.hash2,J=f.send,j=f.ensure_kwargs,F=f.kwrestargs,Z=f.to_a,K=f.alias,P=f.klass,H=f.return_val,q=[],Y=f.nil,Q=f.$$$;return f.top.$require("json"),N=q,U=[te=T(q[0],"I18n")].concat(N),I=f.get_singleton_class(te),y=[I].concat(U),R=f.$r(y),ne(y[1],"@@load_path",[]),ne(y[1],"@@table",Y),S(I,"$load_path",function(){return v(y[1],"@@load_path",!1)}),S(I,"$default_locale",function(){return v(y[1],"@@default_locale",!1)}),S(I,"$default_locale=",function(ie){return ne(y[1],"@@default_locale",ie)}),S(I,"$fallbacks",function(){return Q(Q(R("I18n"),"Locale"),"Fallbacks").$new()}),S(I,"$load_default_translation",function(){return L(v(y[1],"@@table",!1)["$nil?"]())?(ne(y[1],"@@table",D([],{})),this.$load_translation(JSON.stringify(ye(6884)))):Y}),S(I,"$load_translation",function(ie){var ge;return this.$load_default_translation(),ge=R("JSON").$parse(ie,D(["symbolize_names"],{symbolize_names:!0})),ne(y[1],"@@table",J(v(y[1],"@@table",!1),"merge",[ge],function(O,_,l){return null==O&&(O=Y),null==_&&(_=Y),null==l&&(l=Y),_.$merge(l)}))}),S(I,"$clear_translate_table",function(){return ne(y[1],"@@table",Y)}),S(I,"$translate",function(ie,M){var ge,B,_,l,c=Y,h=Y,d=Y;null==(ge=(M=j(M)).$$smap.locale)&&(ge=Y),B=F(M,{locale:!0}),this.$load_default_translation(),_=J(ie.$split("."),"map",[],"to_sym".$to_proc()),l=v(y[1],"@@table",!1),c=v(y[1],"@@default_locale",!1),h=L(d=J(l,"dig",[ge].concat(Z(_))))?d:J(l,"dig",[c].concat(Z(_)));try{L(h["$is_a?"](R("String")))&&(h=this.$format(h,f.to_hash(B)))}catch(p){if(!f.rescue(p,[R("ArgumentError"),R("KeyError")]))throw p;f.pop_exception()}return L(d=h)?d:B["$[]"]("default")},-2),K(I,"t","translate"),function(I,A){var ie,M,ge,R=[T(I,"Locale")].concat(A),z=f.$r(R);ie=R[0],M=z("Hash"),ge=P(ie,M,"Fallbacks"),S(ge,"$defaults=",H(Y))}(U[0],U),function(I,A){var R=[T(I,"Backend")].concat(A);T(R[0],"Simple")}(U[0],U),function(I,A){var z,y=T(I,"Thread");return[y].concat(A),z=f.get_singleton_class(y),S(z,"$current",function(){return D(["i18n_fallbacks"],{i18n_fallbacks:Y})})}(U[0],U)},Opal.modules["i18n/backend/fallbacks"]=function(f){var Q,te,I,A,k,N,T=f.module,ne=f.class_variable_set,v=f.truthy,S=f.class_variable_get,L=f.def,D=f.send,J=f.send2,j=f.find_super,F=f.hash2,Z=f.find_block_super,X=f.neqeq,K=f.thrower,P=f.return_val,H=[],le=f.nil,q=f.$$$;return Q=H,N=[k=T(H[0],"I18n")].concat(Q),ne(N[0],"@@fallbacks",le),te=f.get_singleton_class(k),I=[te].concat(N),A=f.$r(I),L(te,"$fallbacks",function(){var z=le;return ne(I[1],"@@fallbacks",v(null!=I[1].$$cvars["@@fallbacks"]?"class variable":le)&&v(z=S(I[1],"@@fallbacks",!1))?z:q(q(A("I18n"),"Locale"),"Fallbacks").$new()),v(z=A("Thread").$current()["$[]"]("i18n_fallbacks"))?z:S(I[1],"@@fallbacks",!1)}),L(te,"$fallbacks=",function(R){var z;return ne(I[1],"@@fallbacks",v(R["$is_a?"](A("Array")))?q(q(A("I18n"),"Locale"),"Fallbacks").$new(R):R),z=["i18n_fallbacks",S(I[1],"@@fallbacks",!1)],D(A("Thread").$current(),"[]=",z),z[z.length-1]}),function(te,U){var R,z,ie,M,A=[T(te,"Backend")].concat(U);return R=A,ie=[z=T(A[0],"Fallbacks")].concat(R),M=f.$r(ie),L(z,"$translate",function ge(B,O,_){try{var l=K("return"),c=ge.$$p||le,h=this,d=le,p=le;return ge.$$p=null,null==_&&(_=M("EMPTY_HASH")),v(_.$fetch("fallback",!0))?v(_["$[]"]("fallback_in_progress"))?J(h,j(h,"translate",ge,!1,!0),"translate",[B,O,_],c):(v(_["$[]"]("default"))&&(d=h["$extract_non_symbol_default!"](_)),p=_.$merge(F(["fallback_in_progress"],{fallback_in_progress:!0})),D(M("I18n").$fallbacks()["$[]"](B),"each",[],function m(x){var $=null==m.$$s?this:m.$$s;null==x&&(x=le);try{return D($,"catch",["exception"],function re(){var se=null==re.$$s?this:re.$$s,De=le;if(De=J(se,Z(se,"translate",re.$$def||m.$$def||ge,!1,!1),"translate",[x,O,p],null),v(De["$nil?"]()))return le;X(B.$to_s(),x.$to_s())&&se.$on_fallback(B,x,O,_),l.$throw(De)},{$$s:$,$$ret:l})}catch(re){if(!f.rescue(re,[q(M("I18n"),"InvalidLocale")]))throw re;try{return le}finally{f.pop_exception()}}},{$$s:h}),v(_["$key?"]("default"))&&v(_["$[]"]("default")["$nil?"]())?le:v(d)?J(h,j(h,"translate",ge,!1,!0),"translate",[B,le,_.$merge(F(["default"],{default:d}))],null):h.$throw("exception",q(M("I18n"),"MissingTranslation").$new(B,O,_))):J(h,j(h,"translate",ge,!1,!0),"translate",[B,O,_],c)}catch(m){if(m===l)return m.$v;throw m}},-3),L(z,"$extract_non_symbol_default!",function(B){var _,O=le;return O=[B["$[]"]("default")].$flatten(),_=D(O,"detect",[],function(c){return null==c&&(c=le),c["$is_a?"](M("Symbol"))["$!"]()}),v(_)&&B["$[]="]("default",O["$[]"](0,O.$index(_))),_}),L(z,"$exists?",function ge(B,O,_){try{var l=K("return"),c=ge.$$p||le,h=this;return ge.$$p=null,null==_&&(_=M("EMPTY_HASH")),v(_.$fetch("fallback",!0))?(D(M("I18n").$fallbacks()["$[]"](B),"each",[],function d(p){var m=null==d.$$s?this:d.$$s;null==p&&(p=le);try{if(!v(J(m,Z(m,"exists?",d.$$def||ge,!1,!1),"exists?",[p,O],null)))return le;l.$throw(!0)}catch(x){if(!f.rescue(x,[q(M("I18n"),"InvalidLocale")]))throw x;try{return le}finally{f.pop_exception()}}},{$$s:h,$$ret:l}),!1):J(h,j(h,"exists?",ge,!1,!0),"exists?",[B,O,_],c)}catch(d){if(d===l)return d.$v;throw d}},-3),z.$private(),L(z,"$on_fallback",P(le))}(N[0],N)},Opal.modules["bcdice/randomizer"]=function(f){var k,y,R,z,ie,M,te,U,ne=f.klass,v=f.const_set,S=f.def,L=f.truthy,D=f.rb_gt,J=f.rb_plus,j=f.rb_le,F=f.send,Z=f.rb_minus,X=f.eqeq,K=f.rb_times,P=f.eqeqeq,H=f.rb_ge,le=[],q=f.nil,Y=f.$$$;return k=le,te=[(0,f.module)(le[0],"BCDice")].concat(k),U=f.$r(te),y=te,z=[R=ne(te[0],null,"Randomizer")].concat(y),ie=f.$r(z),(M=R.$$prototype).rand_results=M.detailed_rand_results=q,v(z[0],"UPPER_LIMIT_DICE_TIMES",200),v(z[0],"UPPER_LIMIT_DICE_SIDES",1e4),v(z[0],"UPPER_LIMIT_RANDS",1e4),S(R,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),R.$attr_reader("rand_results"),R.$attr_reader("detailed_rand_results"),v(z[0],"DetailedRandResult",ie("Struct").$new("kind","sides","value")),S(R,"$roll_barabara",function(B,O){var _=this;return L(D(J(_.rand_results.$size(),B),ie("UPPER_LIMIT_RANDS")))&&_.$raise(ie("TooManyRandsError")),L(j(B,0))||L(D(B,ie("UPPER_LIMIT_DICE_TIMES")))?[]:F(ie("Array"),"new",[B],function l(){return(null==l.$$s?this:l.$$s).$roll_once(O)},{$$s:_})}),S(R,"$roll_sum",function(B,O){return this.$roll_barabara(B,O).$sum()}),S(R,"$roll_once",function(B){var _=q;return L(j(B,0))||L(D(B,ie("UPPER_LIMIT_DICE_SIDES")))?0:(_=this.$rand_inner(B),this.$push_to_detail("normal",B,_),_)}),S(R,"$roll_index",function(B){return Z(this.$roll_once(B),1)}),S(R,"$roll_tens_d10",function(){var _,O=q;return O=this.$rand_inner(10),X(O,10)&&(O=0),_=K(O,10),this.$push_to_detail("tens_d10",10,_),_}),S(R,"$roll_d9",function(){var O;return O=Z(this.$rand_inner(10),1),this.$push_to_detail("d9",10,O),O}),S(R,"$roll_d66",function(B){var l,_=q;return _=F(ie("Array"),"new",[2],function c(){return(null==c.$$s?this:c.$$s).$roll_once(6)},{$$s:this}),P(Y(ie("D66SortType"),"ASC"),l=B)?_["$sort!"]():P(Y(ie("D66SortType"),"DESC"),l)&&_["$sort!"]()["$reverse!"](),J(K(_["$[]"](0),10),_["$[]"](1))}),R.$private(),S(R,"$rand_inner",function(B){var _,O=this;return L(H(O.rand_results.$size(),ie("UPPER_LIMIT_RANDS")))&&O.$raise(ie("TooManyRandsError")),_=O.$random(B),O.rand_results["$<<"]([_,B]),_}),S(R,"$random",function(B){return J(ie("Kernel").$rand(B),1)}),S(R,"$push_to_detail",function(B,O,_){var c;return c=ie("DetailedRandResult").$new(B,O,_),this.detailed_rand_results.$push(c)}),ne(te[0],U("StandardError"),"TooManyRandsError"),q},Opal.modules["bcdice/dice_table/roll_result"]=function(f){var F,P,Q,k,N,te,U,le,X,T=f.module,ne=f.klass,v=f.def,S=f.truthy,L=f.return_val,D=[],J=f.nil;return F=D,P=X=[T(D[0],"BCDice")].concat(F),Q=le=[T(X[0],"DiceTable")].concat(P),N=[k=ne(le[0],null,"RollResult")].concat(Q),te=f.$r(N),(U=k.$$prototype).table_name=U.value=U.body=J,v(k,"$initialize",function(A,y,R){var z=this;return z.table_name=A,z.value=y,z.body=R}),k.$attr_reader("table_name"),k.$attr_reader("value"),k.$attr_reader("body"),v(k,"$to_s",function(){var A=this;return A.table_name+"("+A.value+") \uff1e "+A.body}),v(k,"$last_body",function(){var A=this;return S(A.body["$is_a?"](te("RollResult")))?A.body.$last_body():A.body}),v(k,"$empty?",L(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(f){var F,P,Q,k,N,te,U,le,X,T=f.module,ne=f.klass,v=f.truthy,S=f.def,L=f.rb_minus,D=[],J=f.nil;return F=D,P=X=[T(D[0],"BCDice")].concat(F),Q=le=[T(X[0],"DiceTable")].concat(P),N=[k=ne(le[0],null,"ChainTable")].concat(Q),te=f.$r(N),(U=k.$$prototype).times=U.sides=U.items=U.name=J,S(k,"$initialize",function(A,y,R){var z=this,ie=J;return z.name=A,z.items=R.$freeze(),ie=/(\d+)D(\d+)/i.$match(y),v(ie)||z.$raise(te("ArgumentError"),"Unexpected table type: "+y),z.times=ie["$[]"](1).$to_i(),z.sides=ie["$[]"](2).$to_i()}),S(k,"$roll",function(A){var R,z,y=this,ie=J;return R=A.$roll_sum(y.times,y.sides),z=L(R,y.times),ie=y.items["$[]"](z),v(ie["$respond_to?"]("roll"))&&(ie=ie.$roll(A)),te("RollResult").$new(y.name,R,ie)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(f){var K,q,te,U,I,A,y,Q,H,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.def,D=f.rb_plus,J=f.rb_times,j=f.rb_minus,F=[],Z=f.nil;return K=F,q=H=[T(F[0],"BCDice")].concat(K),te=Q=[T(H[0],"DiceTable")].concat(q),I=[U=ne(Q[0],null,"D66GridTable")].concat(te),A=f.$r(I),(y=U.$$prototype).name=y.items=Z,S(U,"$from_i18n",function(z,ie){var ge=Z;return ge=A("I18n").$t(z,v(["locale","raise"],{locale:ie,raise:!0})),this.$new(ge["$[]"]("name"),ge["$[]"]("items"))}),L(U,"$initialize",function(z,ie){return this.name=z,this.items=ie.$freeze()}),L(U,"$roll",function(z){var M,ge,B,O,_;return M=z.$roll_once(6),ge=z.$roll_once(6),B=D(J(M,10),ge),O=j(M,1),_=j(ge,1),A("RollResult").$new(this.name,B,this.items["$[]"](O)["$[]"](_))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(f){var Z,H,N,te,U,I,q,Y,K,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.def,J=[],j=f.nil;return f.top.$require("bcdice/dice_table/d66_grid_table"),Z=J,H=K=[T(J[0],"BCDice")].concat(Z),q=[T(K[0],"DiceTable")].concat(H),Y=f.$r(q),N=q,U=[te=ne(q[0],Y("D66GridTable"),"D66HalfGridTable")].concat(N),I=f.$r(U),S(te,"$from_i18n",function(y,R){var ie=j;return ie=I("I18n").$t(y,v(["locale","raise"],{locale:R,raise:!0})),this.$new(ie["$[]"]("name"),ie["$[]"]("items_1_2_3"),ie["$[]"]("items_4_5_6"))}),L(te,"$initialize",function(y,R,z){return this.name=y,this.items=[R,R,R,z,z,z].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(f){var Z,H,N,te,U,I,q,Y,K,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.def,J=[],j=f.nil;return f.top.$require("bcdice/dice_table/d66_grid_table"),Z=J,H=K=[T(J[0],"BCDice")].concat(Z),q=[T(K[0],"DiceTable")].concat(H),Y=f.$r(q),N=q,U=[te=ne(q[0],Y("D66GridTable"),"D66OneThirdTable")].concat(N),I=f.$r(U),S(te,"$from_i18n",function(y,R){var ie=j;return ie=I("I18n").$t(y,v(["locale","raise"],{locale:R,raise:!0})),this.$new(ie["$[]"]("name"),ie["$[]"]("items_1_2"),ie["$[]"]("items_3_4"),ie["$[]"]("items_5_6"))}),L(te,"$initialize",function(y,R,z,ie){return this.name=y,this.items=[R,R,z,z,ie,ie].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(f){var H,Q,I,A,y,R,z,N,q,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.def,D=f.eqeqeq,J=f.rb_plus,j=f.rb_times,F=f.truthy,Z=[],X=f.nil,K=f.$$$;return H=Z,Q=q=[T(Z[0],"BCDice")].concat(H),I=N=[T(q[0],"DiceTable")].concat(Q),y=[A=ne(N[0],null,"D66Table")].concat(I),R=f.$r(y),(z=A.$$prototype).sort_type=z.items=z.name=X,S(A,"$from_i18n",function(M,ge){var _,O=X;return O=R("I18n").$t(M,v(["locale"],{locale:ge})),_=R("D66SortType").$const_get(O["$[]"]("d66_sort_type")),this.$new(O["$[]"]("name"),_,O["$[]"]("items"))}),L(A,"$initialize",function(M,ge,B){var O=this;return O.name=M,O.sort_type=ge,O.items=B.$freeze()}),L(A,"$roll",function(M){var B=X,O=X,_=X,l=X;return B=M.$roll_barabara(2,6),D(K(R("D66SortType"),"ASC"),O=this.sort_type)?B["$sort!"]():D(K(R("D66SortType"),"DESC"),O)&&B["$sort!"]()["$reverse!"](),_=J(j(B["$[]"](0),10),B["$[]"](1)),l=F(O=this.items["$[]"](_))?O:this.items["$[]"](_.$to_s()),F(l["$respond_to?"]("roll"))&&(l=l.$roll(M)),R("RollResult").$new(this.name,_,l)}),L(A,"$choice",function(M){return R("RollResult").$new(this.name,M,this.items["$[]"](M))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(f){var le,k,te,U,Y,T=f.module,ne=f.klass,v=f.hash2,S=f.send,L=f.to_ary,D=f.rb_plus,J=f.rb_times,j=f.send2,F=f.find_super,Z=f.def,K=[],P=f.nil;return f.top.$require("bcdice/dice_table/d66_table"),le=K,k=Y=[T(K[0],"BCDice")].concat(le),te=[T(Y[0],"DiceTable")].concat(k),U=f.$r(te),Z(ne(te[0],U("D66Table"),"D66LeftRangeTable"),"$initialize",function R(z,ie,M){var O;return R.$$p=null,O=v([],{}),S(M,"each",[],function(l){var c,p;return null==l&&(l=P),c=L(l),p=null==c[1]?P:c[1],S(null==c[0]?P:c[0],"each",[],function(x){return null==x&&(x=P),S(p,"each_with_index",[],function(re,se){var De,Ae;return null==re&&(re=P),null==se&&(se=P),Ae=D(J(x,10),D(se,1)),S(O,"[]=",De=[Ae,re]),De[De.length-1]})})}),j(this,F(this,"initialize",R,!1,!0),"initialize",[z,ie,O],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(f){var P,Y,U,I,A,y,R,k,le,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.def,D=f.truthy,J=f.rb_minus,j=f.rb_plus,F=f.rb_times,Z=[],X=f.nil;return P=Z,Y=le=[T(Z[0],"BCDice")].concat(P),U=k=[T(le[0],"DiceTable")].concat(Y),A=[I=ne(k[0],null,"D66ParityTable")].concat(U),y=f.$r(A),(R=I.$$prototype).odd=R.even=R.name=X,S(I,"$from_i18n",function(ie,M){var B=X;return B=y("I18n").$t(ie,v(["locale","raise"],{locale:M,raise:!0})),this.$new(B["$[]"]("name"),B["$[]"]("odd"),B["$[]"]("even"))}),L(I,"$initialize",function(ie,M,ge){var B=this;return B.name=ie,B.odd=M.$freeze(),B.even=ge.$freeze()}),L(I,"$roll",function(ie){var B,_,l,M=this,ge=X;return ge=ie.$roll_once(6),B=ie.$roll_once(6),_=(D(ge["$odd?"]())?M.odd:M.even)["$[]"](J(B,1)),l=j(F(ge,10),B),y("RollResult").$new(M.name,l,_)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(f){var Z,H,k,N,te,U,I,q,K,T=f.module,ne=f.klass,v=f.def,S=f.rb_plus,L=f.rb_times,D=f.send,J=[],j=f.nil;return Z=J,H=K=[T(J[0],"BCDice")].concat(Z),k=q=[T(K[0],"DiceTable")].concat(H),te=[N=ne(q[0],null,"D66RangeTable")].concat(k),U=f.$r(te),(I=N.$$prototype).items=I.name=j,v(N,"$initialize",function(y,R){return this.name=y,this.items=R.$freeze()}),v(N,"$roll",function(y){var z,ie,M,ge=j;return z=y.$roll_once(6),ie=y.$roll_once(6),M=S(L(z,10),ie),ge=D(this.items,"find",[],function(O){return null==O&&(O=j),O["$[]"](0)["$include?"](M)}),U("RollResult").$new(this.name,M,ge["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(f){var P,Y,U,I,A,y,R,k,le,T=f.module,ne=f.klass,v=f.const_set,S=f.send,L=f.truthy,D=f.def,J=f.eqeqeq,j=f.rb_times,F=f.rb_plus,Z=[],X=f.nil;return P=Z,Y=le=[T(Z[0],"BCDice")].concat(P),U=k=[T(le[0],"DiceTable")].concat(Y),A=[I=ne(k[0],null,"RangeTable")].concat(U),y=f.$r(A),(R=I.$$prototype).name=R.items=R.num_of_dice=R.num_of_sides=R.formatter=X,v(A[0],"RollResult",S(y("Struct"),"new",["sum","values","content","formatted"],function z(){return(null==z.$$s?this:z.$$s).$alias_method("to_s","formatted")},{$$s:I})),v(A[0],"Item",y("Struct").$new("range","content")),v(A[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),v(A[0],"DEFAULT_FORMATTER",S(I,"lambda",[],function(ie,M){return null==ie&&(ie=X),null==M&&(M=X),ie.$name()+"("+M.$sum()+") \uff1e "+M.$content()})),I.$attr_reader("name"),I.$attr_reader("num_of_dice"),I.$attr_reader("num_of_sides"),D(I,"$initialize",function z(ie,M,ge){var _,B=z.$$p||X,O=this,l=X;return z.$$p=null,O.name=ie.$freeze(),O.formatter=L(_=B)?_:y("DEFAULT_FORMATTER"),l=y("DICE_ROLL_METHOD_RE").$match(M),L(l)||O.$raise(y("ArgumentError"),O.name+": invalid dice roll method: "+M),O.num_of_dice=l["$[]"](1).$to_i(),O.num_of_sides=l["$[]"](2).$to_i(),O.$store(ge)}),D(I,"$fetch",function(ie){var ge,M=this;return ge=S(M.items,"find",[],function(O){return null==O&&(O=X),O.$range()["$include?"](ie)}),L(ge)||M.$raise(y("RangeError"),M.name+": value is out of range: "+ie),ge}),D(I,"$roll",function(ie){var B,M=this,ge=X,O=X;return B=(ge=ie.$roll_barabara(M.num_of_dice,M.num_of_sides)).$sum(),(O=y("RollResult").$new(B,ge,M.$fetch(B).$content()))["$formatted="](M.formatter["$[]"](M,O)),O}),I.$private(),D(I,"$store",function(ie){var ge,B,M=this;return ge=S(ie,"map",[],function O(_,l){return null==_&&(_=X),null==l&&(l=X),[(null==O.$$s?this:O.$$s).$coerce_to_int_range(_),l]},{$$s:M}),B=S(ge,"sort_by",[],function(_,l){return null==_&&(_=X),null==l&&(l=X),_.$min()}),M.$assert_min_sum_is_covered(B),M.$assert_max_sum_is_covered(B),M.$assert_no_gap_or_overlap_in_ranges(B),M.items=S(B,"map",[],function(_,l){return null==_&&(_=X),null==l&&(l=X),y("Item").$new(_,l.$freeze()).$freeze()}).$freeze(),M}),D(I,"$coerce_to_int_range",function(ie){var ge;return J(y("Integer"),ge=ie)?y("Range").$new(ie,ie):J(y("Range"),ge)&&L(ie.$begin()["$is_a?"](y("Integer")))&&L(ie.$end()["$is_a?"](y("Integer")))?ie:this.$raise(y("TypeError"),this.name+": "+ie+" ("+ie.$class()+") must be an Integer or a Range with Integers ")}),D(I,"$assert_min_sum_is_covered",function(ie){var ge,M=this,B=X;return ge=M.num_of_dice,B=ie.$first()["$[]"](0),L(B["$include?"](ge))||M.$raise(y("RangeError"),M.name+": min value ("+ge+") is not covered: "+B),M}),D(I,"$assert_max_sum_is_covered",function(ie){var ge,M=this,B=X;return ge=j(M.num_of_dice,M.num_of_sides),B=ie.$last()["$[]"](0),L(B["$include?"](ge))||M.$raise(y("RangeError"),M.name+": max value ("+ge+") is not covered: "+B),M}),D(I,"$assert_no_gap_or_overlap_in_ranges",function(ie){return S(ie,"each_cons",[2],function ge(B,O){var h,d,_=null==ge.$$s?this:ge.$$s,l=X,c=X;return null==_.name&&(_.name=X),null==B&&(B=X),null==O&&(O=X),l=B["$[]"](0),c=O["$[]"](0),h=l.$max(),d=F(h,1),L(c["$include?"](h))&&_.$raise(y("RangeError"),_.name+": Range overlap: "+l+" and "+c),L(c["$include?"](d))?X:_.$raise(y("RangeError"),_.name+": Range gap: "+l+" and "+c)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(f){var X,le,N,y,R,z,ie,U,Y,P,T=f.module,ne=f.klass,v=f.send,S=f.def,L=f.rb_minus,D=f.return_ivar,J=[],j=f.nil,F=f.$$$;return X=J,le=P=[T(J[0],"BCDice")].concat(X),N=Y=[T(P[0],"DiceTable")].concat(le),y=U=[ne(Y[0],null,"SaiFicSkillTable")].concat(N),z=[R=ne(U[0],null,"Category")].concat(y),ie=f.$r(z),S(R,"$initialize",function(ge,B,O,_){var l=this;return l.name=ge,l.skills=v(B.$map(),"with_index",[2],function(h,d){return null==h&&(h=j),null==d&&(d=j),F(ie("SaiFicSkillTable"),"Skill").$new(ge,h,O,d,_)}),l.dice=O}),S(R,"$roll",function(ge){return this.$skills()["$[]"](L(ge.$roll_sum(2,6),2))}),S(R,"$to_s",D("name")),R.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(f){var j,K,Y,U,I,k,H,Z,T=f.module,ne=f.klass,v=f.def,S=f.hash2,L=[],D=f.nil;return j=L,K=Z=[T(L[0],"BCDice")].concat(j),Y=H=[T(Z[0],"DiceTable")].concat(K),k=[ne(H[0],null,"SaiFicSkillTable")].concat(Y),(I=(U=ne(k[0],null,"Skill")).$$prototype).s_format=I.category_dice=I.row_dice=I.category_name=I.name=D,v(U,"$initialize",function(y,R,z,ie,M){var ge=this;return ge.category_name=y,ge.name=R,ge.category_dice=z,ge.row_dice=ie,ge.s_format=M}),v(U,"$to_s",function(){var y=this;return y.$format(y.s_format,S(["category_dice","row_dice","category_name","skill_name"],{category_dice:y.category_dice,row_dice:y.row_dice,category_name:y.category_name,skill_name:y.name}))}),U.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(f){var k,I,ie,M,ge,B,O,y,te,T=f.module,ne=f.klass,v=f.ensure_kwargs,S=f.hash2,L=f.send,J=f.defs,j=f.const_set,F=f.to_ary,Z=f.def,X=f.truthy,K=f.rb_minus,P=f.rb_plus,H=f.top,le=[],q=f.nil,Y=f.$$$;return H.$require("bcdice/dice_table/sai_fic_skill_table/category"),H.$require("bcdice/dice_table/sai_fic_skill_table/skill"),k=le,I=te=[T(le[0],"BCDice")].concat(k),ie=y=[T(te[0],"DiceTable")].concat(I),ge=[M=ne(y[0],null,"SaiFicSkillTable")].concat(ie),B=f.$r(ge),(O=M.$$prototype).rtt=O.rtt_format=O.rct=O.rct_format=O.rttn=O.rttn_format=O.categories=q,J(M,"$from_i18n",function(l,c,h){var d,p,m,se,re=q;return null==(d=(h=v(h)).$$smap.rtt)&&(d=q),null==(p=h.$$smap.rct)&&(p=q),null==(m=h.$$smap.rttn)&&(m=q),se=(re=B("I18n").$t("RTT",S(["locale","raise","default"],{locale:c,raise:!1,default:S([],{})})).$merge(B("I18n").$t(l,S(["locale","raise"],{locale:c,raise:!0}))))["$[]"]("items"),re=L(re,"select",[],function(Ae,fe){return null==Ae&&(Ae=q),null==fe&&(fe=q),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Ae)}),this.$new(se,f.to_hash(re).$merge(S(["rtt","rct","rttn"],{rtt:d,rct:p,rttn:m})))},-3),j(ge[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),j(ge[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),j(ge[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),j(ge[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),Z(M,"$initialize",function(l,c){var h,d,p,m,x,$,re,se=this;return null==(h=(c=v(c)).$$smap.rtt)&&(h=q),null==(d=c.$$smap.rct)&&(d=q),null==(p=c.$$smap.rttn)&&(p=q),null==(m=c.$$smap.rtt_format)&&(m=B("DEFAULT_RTT")),null==(x=c.$$smap.rct_format)&&(x=B("DEFAULT_RCT")),null==($=c.$$smap.rttn_format)&&($=B("DEFAULT_RTTN")),null==(re=c.$$smap.s_format)&&(re=B("DEFAULT_S")),se.categories=L(l.$map(),"with_index",[1],function(Ae,fe){var Pe,xe,pe;return null==Ae&&(Ae=q),null==fe&&(fe=q),xe=null==(Pe=F(Ae))[0]?q:Pe[0],pe=null==Pe[1]?q:Pe[1],Y(B("SaiFicSkillTable"),"Category").$new(xe,pe,fe,re)},{$$has_top_level_mlhs_arg:!0}),se.rtt=h,se.rct=d,se.rttn=p.$to_a(),se.rtt_format=m,se.rct_format=x,se.rttn_format=$},-2),j(ge[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),M.$attr_reader("categories"),Z(M,"$roll_command",function(l,c){var d,h=this,p=q,m=q;return X(["RTT",h.rtt]["$include?"](d=c))?h.$format_skill(h.rtt_format,h.$roll_skill(l)):X(["RCT",h.rct]["$include?"](d))?(p=h.$roll_category(l),h.$format(h.rct_format,S(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):X(m=B("RTTN").$index(d))||X(m=h.rttn.$index(d))?h.$format_skill(h.rttn_format,h.categories["$[]"](m).$roll(l)):q}),Z(M,"$roll_category",function(l){return this.categories["$[]"](K(l.$roll_once(6),1))}),Z(M,"$roll_skill",function(l){return this.$roll_category(l).$roll(l)}),Z(M,"$prefixes",function(){var l=this;return P(["RTT[1-6]?","RCT",l.rtt,l.rct],l.rttn).$compact()}),M.$private(),Z(M,"$format_skill",function(l,c){return this.$format(l,S(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:c.$category_dice(),row_dice:c.$row_dice(),category_name:c.$category_name(),skill_name:c.$name(),text:c.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(f){var X,le,N,te,U,I,A,Y,P,T=f.module,ne=f.klass,v=f.hash2,S=f.defs,L=f.truthy,D=f.def,J=f.rb_minus,j=[],F=f.nil;return X=j,le=P=[T(j[0],"BCDice")].concat(X),N=Y=[T(P[0],"DiceTable")].concat(le),U=[te=ne(Y[0],null,"Table")].concat(N),I=f.$r(U),(A=te.$$prototype).times=A.sides=A.name=A.items=F,S(te,"$from_i18n",function(R,z){var M=F;return M=I("I18n").$t(R,v(["locale"],{locale:z})),this.$new(M["$[]"]("name"),M["$[]"]("type"),M["$[]"]("items"))}),D(te,"$initialize",function(R,z,ie){var M=this,ge=F;return M.name=R,M.items=ie.$freeze(),ge=/(\d+)D(\d+)/i.$match(z),L(ge)||M.$raise(I("ArgumentError"),"Unexpected table type: "+z),M.times=ge["$[]"](1).$to_i(),M.sides=ge["$[]"](2).$to_i()}),D(te,"$roll",function(R){var ie,z=this;return ie=R.$roll_sum(z.times,z.sides),z.$choice(ie)}),D(te,"$choice",function(R){var ie,z=this;return ie=J(R,z.times),I("RollResult").$new(z.name,R,z.items["$[]"](ie))})},Opal.modules["bcdice/dice_table"]=function(f){var T=f.top;return T.$require("bcdice/dice_table/roll_result"),T.$require("bcdice/dice_table/chain_table"),T.$require("bcdice/dice_table/d66_grid_table"),T.$require("bcdice/dice_table/d66_half_grid_table"),T.$require("bcdice/dice_table/d66_one_third_table"),T.$require("bcdice/dice_table/d66_left_range_table"),T.$require("bcdice/dice_table/d66_parity_table"),T.$require("bcdice/dice_table/d66_range_table"),T.$require("bcdice/dice_table/d66_table"),T.$require("bcdice/dice_table/range_table"),T.$require("bcdice/dice_table/sai_fic_skill_table"),T.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(f){var D,Z,K,j,T=f.module,ne=f.const_set,v=[];return D=v,Z=j=[T(v[0],"BCDice")].concat(D),K=[T(j[0],"D66SortType")].concat(Z),ne(K[0],"NO_SORT","no_sort"),ne(K[0],"ASC","asc"),ne(K[0],"DESC","desc"),function(F,Z){var K=[T(F,"RoundType")].concat(Z);return ne(K[0],"CEIL","ceil"),ne(K[0],"FLOOR","floor"),ne(K[0],"ROUND","round")}(j[0],j)},Opal.modules["bcdice/translate"]=function(f){var Z,H,le,q,Y,K,T=f.module,ne=f.ensure_kwargs,v=f.kwrestargs,L=f.hash2,D=f.def,J=[],j=f.nil;return Z=J,H=K=[T(J[0],"BCDice")].concat(Z),q=[le=T(K[0],"Translate")].concat(H),Y=f.$r(q),D(le,"$translate",function(k,N){var te,U=this;return null==U.locale&&(U.locale=j),N=ne(N),te=v(N,{}),Y("I18n").$translate(k,L(["locale","raise"],{locale:U.locale,raise:!0}).$merge(f.to_hash(te)))},-2)},Opal.modules["bcdice/result"]=function(f){var le,Q,q,Z,K,ne=f.klass,v=f.send,S=f.def,L=f.return_val,D=f.return_ivar,J=[],j=f.nil;return Z=J,le=K=[(0,f.module)(J[0],"BCDice")].concat(Z),[q=ne(K[0],null,"Result")].concat(le),S(Q=f.get_singleton_class(q),"$success",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),v(A,"success=",y=[!0]),y[y.length-1]})}),S(Q,"$failure",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),v(A,"failure=",y=[!0]),y[y.length-1]})}),S(Q,"$critical",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),A["$critical="](!0),v(A,"success=",y=[!0]),y[y.length-1]})}),S(Q,"$fumble",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),A["$fumble="](!0),v(A,"failure=",y=[!0]),y[y.length-1]})}),S(Q,"$nothing",L("nothing")),S(q,"$initialize",function(k){var N=this;return null==k&&(k=j),N.text=k,N.rands=j,N.detailed_rands=j,N.secret=!1,N.success=!1,N.failure=!1,N.critical=!1,N.fumble=!1},-1),q.$attr_accessor("text","rands","detailed_rands"),q.$attr_writer("secret","success","failure","critical","fumble"),S(q,"$secret?",D("secret")),S(q,"$success?",D("success")),S(q,"$failure?",D("failure")),S(q,"$critical?",D("critical")),S(q,"$fumble?",D("fumble")),S(q,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()})},Opal.modules["racc/parser"]=function(f){var R,ie,M,T=f.module,ne=f.klass,v=f.truthy,S=f.const_set,L=f.defs,D=f.gvars,J=f.rb_lt,j=f.def,F=f.to_ary,Z=f.send,X=f.neqeq,K=f.rb_plus,P=f.eqeq,H=f.rb_ge,le=f.rb_gt,q=f.rb_minus,Y=f.rb_le,Q=f.rb_times,k=f.assign_ivar_val,te=[],U=f.$r(te),I=f.nil,A=f.$$$;return R=te,ie=[T(te[0],"Racc")].concat(R),M=f.$r(ie),ne(ie[0],M("StandardError"),"ParseError"),v(A("::","ParseError","skip_raise")?"constant":I)||S(te[0],"ParseError",A(U("Racc"),"ParseError")),function(y,R){var _,l,c,h,d,M=[T(y,"Racc")].concat(R),ge=f.$r(M);return v(ge("Racc_No_Extensions","skip_raise")?"constant":I)||S(M[0],"Racc_No_Extensions",!1),_=M,c=[l=ne(M[0],null,"Parser")].concat(_),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=I,S(c[0],"Racc_Runtime_Version","1.4.6"),S(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),S(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),S(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),S(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),S(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),S(c[0],"Racc_Runtime_Type","ruby"),L(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),j(l,"$_racc_setup",function(){var m,x,$=this,re=I,se=I;return null==D.stderr&&(D.stderr=I),v(A($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(m=$.yydebug)&&m!==I?"instance-variable":I)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==I?"instance-variable":I)||($.racc_debug_out=D.stderr),$.racc_debug_out=v(re=$.racc_debug_out)?re:D.stderr),se=A($.$class(),"Racc_arg"),v(J(se.$size(),14))&&se["$[]="](13,!0),se}),j(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=I,m.racc_val=I,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),j(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),j(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),j(l,"$_racc_do_parse_rb",function(m,x){var $,De=I,Ae=I,fe=I,Pe=I,xe=I,pe=I,Me=I,Ce=I;return $=F(m),De=null==$[0]?I:$[0],Ae=null==$[1]?I:$[1],fe=null==$[2]?I:$[2],Pe=null==$[3]?I:$[3],xe=null==$[10]?I:$[10],this.$_racc_init_sysvars(),pe=Me=Ce=I,Z(this,"catch",["racc_end_parse"],function ae(){var he,Ee,C=null==ae.$$s?this:ae.$$s,V=I;for(null==C.racc_state&&(C.racc_state=I),null==C.racc_read_next&&(C.racc_read_next=I),null==C.racc_t&&(C.racc_t=I),null==C.yydebug&&(C.yydebug=I),null==C.racc_val&&(C.racc_val=I);v(!0);)for(v(Ce=Pe["$[]"](C.racc_state["$[]"](-1)))?(v(C.racc_read_next)&&X(C.racc_t,0)&&(Ee=C.$next_token(),he=F(Ee),pe=null==he[0]?I:he[0],C.racc_val=null==he[1]?I:he[1],C.racc_t=v(pe)?v(V=xe["$[]"](pe))?V:1:0,v(C.yydebug)&&C.$racc_read_token(C.racc_t,pe,C.racc_val),C.racc_read_next=!1),Ce=K(Ce,C.racc_t),v(H(Ce,0))&&v(Me=De["$[]"](Ce))&&P(Ae["$[]"](Ce),C.racc_state["$[]"](-1))||(Me=fe["$[]"](C.racc_state["$[]"](-1)))):Me=fe["$[]"](C.racc_state["$[]"](-1));v(Me=C.$_racc_evalact(Me,m)););},{$$s:this})}),j(l,"$yyparse",function(m,x){return this.$__send__(h("Racc_YY_Parse_Method"),m,x,this.$_racc_setup(),!0)}),j(l,"$_racc_yyparse_rb",function(m,x,$,re){var se,fe=I,Pe=I,be=I,xe=I,Me=I,Ce=I,ae=I;return se=F($),fe=null==se[0]?I:se[0],Pe=null==se[1]?I:se[1],be=null==se[2]?I:se[2],xe=null==se[3]?I:se[3],Me=null==se[10]?I:se[10],this.$_racc_init_sysvars(),Ce=I,ae=I,Z(this,"catch",["racc_end_parse"],function he(){var Ee=null==he.$$s?this:he.$$s;for(null==Ee.racc_state&&(Ee.racc_state=I);!v(ae=xe["$[]"](Ee.racc_state["$[]"](-1)));)for(;v(Ce=Ee.$_racc_evalact(be["$[]"](Ee.racc_state["$[]"](-1)),$)););return Z(m,"__send__",[x],function C(V,$e){var Te=null==C.$$s?this:C.$$s,Fe=I,Ue=I;for(null==Te.racc_t&&(Te.racc_t=I),null==Te.racc_state&&(Te.racc_state=I),null==Te.racc_read_next&&(Te.racc_read_next=I),null==V&&(V=I),null==$e&&($e=I),Te.racc_t=v(V)?v(Fe=Me["$[]"](V))?Fe:1:0,Te.racc_val=$e,Te.racc_read_next=!1,ae=K(ae,Te.racc_t),v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););for(;v(v(Fe=v(Ue=(ae=xe["$[]"](Te.racc_state["$[]"](-1)))["$!"]())?Ue:Te.racc_read_next["$!"]())?Fe:Te.racc_t["$=="](0));)for(v(ae)&&v(ae=K(ae,Te.racc_t))&&v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););},{$$s:Ee})},{$$s:this})}),j(l,"$_racc_evalact",function(m,x){var $,be,se=this,De=I,Ae=I,Pe=I,xe=I,pe=I,Me=I;if(De=null==($=F(x))[0]?I:$[0],Ae=null==$[1]?I:$[1],Pe=null==$[3]?I:$[3],be=null==$[11]?I:$[11],xe=null==$[12]?I:$[12],v(le(m,0))&&v(J(m,be)))v(le(se.racc_error_status,0))&&(P(se.racc_t,1)||(se.racc_error_status=q(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,v(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(v(J(m,0))&&v(le(m,xe["$-@"]()))){if(pe=Z(se,"catch",["racc_jump"],function Ce(){var ae=null==Ce.$$s?this:Ce.$$s;return null==ae.racc_state&&(ae.racc_state=I),ae.racc_state.$push(ae.$_racc_do_reduce(x,m)),!1},{$$s:se}),v(pe))switch(pe){case 1:return se.racc_user_yyerror=!0,xe["$-@"]();case 2:return be;default:se.$raise("[Racc Bug] unknown jump code")}}else if(P(m,be))v(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(P(m,xe["$-@"]())){switch(se.racc_error_status){case 0:v(x["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:P(se.racc_t,0)&&se.$throw("racc_end_parse",I),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;v(!0)&&!(v(Me=Pe["$[]"](se.racc_state["$[]"](-1)))&&(Me=K(Me,1),v(H(Me,0))&&v(m=De["$[]"](Me))&&P(Ae["$[]"](Me),se.racc_state["$[]"](-1))));)v(Y(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",I),se.racc_state.$pop(),se.racc_vstack.$pop(),v(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return v(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),I}),j(l,"$_racc_do_reduce",function(m,x){var $,xe,Me,V,$e,Te,Ze,se=this,Ae=I,fe=I,Pe=I,be=I,pe=I,Ce=I,ae=I,he=I,Ee=I,C=I,Fe=I,Ue=I,lt=I;return Ae=null==($=F(m))[4]?I:$[4],fe=null==$[5]?I:$[5],Pe=null==$[6]?I:$[6],be=null==$[7]?I:$[7],xe=null==$[8]?I:$[8],pe=null==$[9]?I:$[9],Me=null==$[13]?I:$[13],Ce=se.racc_state,ae=se.racc_vstack,he=se.racc_tstack,Ee=Q(x,-3),C=pe["$[]"](Ee),V=pe["$[]"](K(Ee,1)),$e=pe["$[]"](K(Ee,2)),Te=[],v(se.yydebug)&&(Fe=he["$[]"](C["$-@"](),C)),Ue=ae["$[]"](C["$-@"](),C),v(se.yydebug)&&he["$[]="](C["$-@"](),C,Te),ae["$[]="](C["$-@"](),C,Te),Ce["$[]="](C["$-@"](),C,Te),v(Me)?ae.$push(se.$__send__($e,Ue,ae,Ue["$[]"](0))):ae.$push(se.$__send__($e,Ue,ae)),he.$push(V),v(se.yydebug)&&se.$racc_reduce(Fe,V,he,ae),Ze=q(V,xe),v(Ee=be["$[]"](Ze))&&(Ee=K(Ee,Ce["$[]"](-1)),v(H(Ee,0))&&v(lt=Ae["$[]"](Ee))&&P(fe["$[]"](Ee),Ze))?lt:Pe["$[]"](Ze)}),j(l,"$on_error",function(m,x,$){var se;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(se=this.$token_to_str(m))?se:"?"))}),j(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),j(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),j(l,"$yyerrok",k("racc_error_status",0)),j(l,"$racc_read_token",function(m,x,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(x.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),j(l,"$racc_shift",function(m,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_reduce",function(m,x,$,re){var se=this,De=I;return(De=se.racc_debug_out).$print("reduce "),v(m["$empty?"]())?De.$print(" <none>"):Z(m,"each",[],function Ae(fe){return null==fe&&(fe=I),De.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(fe))},{$$s:se}),De.$puts(" --\x3e "+se.$racc_token2str(x)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),j(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),j(l,"$racc_e_pop",function(m,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_next_state",function(m,x){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(x),$.racc_debug_out.$puts()}),j(l,"$racc_print_stacks",function(m,x){var re=I;return(re=this.racc_debug_out).$print("        ["),Z(m,"each_index",[],function se(De){return null==De&&(De=I),re.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(m["$[]"](De))," ",x["$[]"](De).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),j(l,"$racc_print_states",function(m){var $=I;return($=this.racc_debug_out).$print("        ["),Z(m,"each",[],function(se){return null==se&&(se=I),$.$print(" ",se)}),$.$puts(" ]")}),j(l,"$racc_token2str",function(m){var $;return v($=A(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),j(l,"$token_to_str",function(m){return A(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(te[0],te)},Opal.modules["bcdice/arithmetic/node"]=function(f){var k,I,z,_,l,M,ge,y,te,T=f.module,ne=f.klass,v=f.def,S=f.thrower,L=f.return_ivar,D=f.send2,J=f.find_super,j=f.eqeq,F=f.const_set,Z=f.eqeqeq,X=f.rb_divide,K=f.truthy,P=f.assign_ivar,H=f.alias,le=[],q=f.nil,Y=f.$$$;return k=le,I=te=[T(le[0],"BCDice")].concat(k),z=y=[T(te[0],"Arithmetic")].concat(I),M=[T(y[0],"Node")].concat(z),ge=f.$r(M),(l=(_=ne(M[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=q,v(_,"$initialize",function(h,d,p){var m=this;return m.lhs=h,m.op=d,m.rhs=p}),v(_,"$eval",function(h){try{S("eval_return");var x,p=this,m=q;return m=p.lhs.$eval(h),x=p.rhs.$eval(h),m.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(_,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(_,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(_,"$op_for_s_exp",L("op")),function(B,O,_){var l=ne(B,O,"DivideBase"),c=[l].concat(_),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=q,v(l,"$initialize",function p(m,x){return p.$$p=null,D(this,J(this,"initialize",p,!1,!0),"initialize",[m,"/",x],null)}),v(l,"$eval",function(m){try{S("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),j(se,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),v(l,"$output",function p(){var m=p.$$p||q,x=this;return p.$$p=null,""+D(x,J(x,"output",p,!1,!0),"output",[],m)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(m,x,$){return this.$raise(h("NotImplementedError"))})}(M[0],ge("BinaryOp"),M),function(B,O,_){var l=ne(B,O,"DivideWithGameSystemDefault"),c=[l].concat(_),h=f.$r(c);F(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,m,x){var $,re=q;return Z(Y(h("RoundType"),"CEIL"),$=x)?X(p.$to_f(),m).$ceil():Z(Y(h("RoundType"),"ROUND"),$)?(re=X(p.$to_f(),m),K(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):X(p,m).$floor()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithCeil"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d.$to_f(),p).$ceil()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithRound"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,m){var x=q;return x=X(d.$to_f(),p),K(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithFloor"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d,p).$floor()})}(M[0],ge("DivideBase"),M),function(B,O){var _=ne(B,null,"Negative");_.$$prototype.body=q,v(_,"$initialize",P("body")),v(_,"$eval",function(h){try{return S("eval_return"),this.body.$eval(h)["$-@"]()}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"-"+this.body.$output()}),v(_,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Parenthesis");_.$$prototype.expr=q,v(_,"$initialize",P("expr")),v(_,"$eval",function(h){try{return S("eval_return"),this.expr.$eval(h)}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"("+this.expr.$output()+")"}),v(_,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Number");return _.$$prototype.value=q,v(_,"$initialize",P("value")),v(_,"$eval",L("value")),v(_,"$output",function(){return this.value.$to_s()}),H(_,"s_exp","output")}(M[0])},Opal.modules.strscan=function(f){var P,H,le,q,Y,ne=f.def,v=f.truthy,S=f.eqeqeq,L=f.Opal,D=f.return_ivar,J=f.send,j=f.alias,F=[],Z=f.nil;return P=F,le=[H=(0,f.klass)(F[0],null,"StringScanner")].concat(P),q=f.$r(le),(Y=H.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=Z,H.$attr_reader("pos","matched"),ne(H,"$initialize",function(k){var N=this;return N.string=k,N.pos=0,N.matched=Z,N.working=k,N.match=[]}),H.$attr_reader("string"),ne(H,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),ne(H,"$scan",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?N.matched=Z:(N.prev_pos=N.pos,N.pos+=te[0].length,N.working=N.working.substring(te[0].length),N.matched=te[0],N.match=te,te[0])}),ne(H,"$scan_until",function(k){var N=this;k=N.$anchor(k);for(var te=N.working,U=0;te.length!=U;++U){var I=k.exec(te.substr(U));if(null!==I){var A=U+I[0].length,y=te.substr(0,A);return N.matched=I[0],N.match=I,N.prev_pos=N.pos+U,N.pos+=A,N.working=te.substr(A),y}}return N.matched=Z}),ne(H,"$[]",function(k){var te;if(v(this.match["$empty?"]()))return Z;S(q("Symbol"),te=k)?k=k.$to_s():S(q("String"),te)||(k=L["$coerce_to!"](k,q("Integer"),"to_int"));var U=this.match;return k<0&&(k+=U.length),k<0||k>=U.length||null==U[k]?Z:U[k]}),ne(H,"$check",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return N.matched=null==te?Z:te[0]}),ne(H,"$check_until",function(k){var N=this,te=N.prev_pos,U=N.pos,I=N.working,A=N.$scan_until(k);return N.prev_pos=te,N.pos=U,N.working=I,A}),ne(H,"$peek",function(k){return this.working.substring(0,k)}),ne(H,"$eos?",function(){return 0===this.working.length}),ne(H,"$exist?",function(k){var te=k.exec(this.working);return null==te?Z:0==te.index?0:te.index+1}),ne(H,"$skip",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);if(null==te)return N.match=[],N.matched=Z;var U=te[0],I=U.length;return N.matched=U,N.match=te,N.prev_pos=N.pos,N.pos+=I,N.working=N.working.substring(I),I}),ne(H,"$skip_until",function(k){var te=this.$scan_until(k);return te===Z?Z:(this.matched=te.substr(-1),te.length)}),ne(H,"$get_byte",function(){var k=this,N=Z;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,N=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=Z,N}),ne(H,"$match?",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?Z:(N.prev_pos=N.pos,te[0].length)}),ne(H,"$pos=",function(k){var N=this;return k<0&&(k+=N.string.$length()),N.pos=k,N.working=N.string.slice(k)}),ne(H,"$matched_size",function(){return this.matched===Z?Z:this.matched.length}),ne(H,"$post_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(k.pos)}),ne(H,"$pre_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(0,k.prev_pos)}),ne(H,"$reset",function(){var k=this;return k.working=k.string,k.matched=Z,k.pos=0}),ne(H,"$rest",D("working")),ne(H,"$rest?",function(){return 0!==this.working.length}),ne(H,"$rest_size",function(){return this.$rest().$size()}),ne(H,"$terminate",function(){var k,N=this;return N.match=Z,k=[N.string.$length()],J(N,"pos=",k),k[k.length-1]}),ne(H,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=Z,k.match=Z,k}),j(H,"bol?","beginning_of_line?"),j(H,"getch","get_byte"),H.$private(),ne(H,"$anchor",function(k){var N=k.toString().match(/\/([^\/]+)$/);return N=N?N[1]:void 0,new RegExp("^(?:"+k.source+")",N)})},Opal.modules["bcdice/normalize"]=function(f){var j,K,Z,T=f.module,ne=f.eqeqeq,v=f.def,S=f.eqeq,L=[],D=f.nil;return j=L,Z=[T(L[0],"BCDice")].concat(j),(K=T(Z[0],"Normalize")).$module_function(),v(K,"$comparison_operator",function(H){var le;return ne(/<=|=</,le=H)?"<=":ne(/>=|=>/,le)?">=":ne(/<>|!=|=!/,le)?"!=":ne(/</,le)?"<":ne(/>/,le)?">":ne(/=/,le)?"==":D}),v(K,"$target_number",function(H){return S(H,"?")?H:H.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(f){var P,Y,U,I,A,y,R,k,le,T=f.module,ne=f.klass,v=f.const_set,S=f.hash2,L=f.truthy,D=f.send,J=f.def,j=f.thrower,F=f.top,Z=[],X=f.nil;return F.$require("strscan"),F.$require("bcdice/normalize"),P=Z,Y=le=[T(Z[0],"BCDice")].concat(P),U=k=[T(le[0],"Command")].concat(Y),A=[I=ne(k[0],null,"Lexer")].concat(U),y=f.$r(A),(R=I.$$prototype).scanner=R.notations=X,v(A[0],"SYMBOLS",S(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),J(I,"$initialize",function(ie,M){var ge,B,_;return ie=L(_=(ge=(B=ie)===X||null==B?X:B.$split(" ",2))===X||null==ge?X:ge.$first())?_:"",this.scanner=y("StringScanner").$new(ie),this.notations=D(M,"map",[],function(c){return null==c&&(c=X),L(c["$is_a?"](y("String")))?y("Regexp").$new(c):c})}),J(I,"$next_token",function(){try{var ie=j("return"),M=this,ge=X,B=X,_=X,l=X;return L(M.scanner["$eos?"]())?[!1,"$"]:(D(M.notations,"each",[],function c(h){var p,d=null==c.$$s?this:c.$$s;if(null==d.scanner&&(d.scanner=X),null==h&&(h=X),p=d.scanner.$scan(h),!L(p))return X;ie.$throw(["NOTATION",p])},{$$s:M,$$ret:ie}),L(ge=M.scanner.$scan(/\d+/))?["NUMBER",ge.$to_i()]:L(B=M.scanner.$scan(/[<>!=]+/))?(B=y("Normalize").$comparison_operator(B),[L(B)?"CMP_OP":"ILLEGAL",B]):(_=M.scanner.$getch().$upcase(),[L(l=y("SYMBOLS")["$[]"](_))?l:_.$to_sym(),_]))}catch(c){if(c===ie)return c.$v;throw c}}),J(I,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(f){var F,P,Q,k,N,te,U,le,X,T=f.module,ne=f.klass,v=f.def,S=f.return_ivar,L=f.truthy,D=[],J=f.nil;return F=D,P=X=[T(D[0],"BCDice")].concat(F),Q=le=[T(X[0],"Command")].concat(P),N=[k=ne(le[0],null,"Parsed")].concat(Q),te=f.$r(N),(U=k.$$prototype).critical=U.fumble=U.dollar=U.modify_number=U.question_target=U.target_number=U.prefix_number=U.command=U.suffix_number=U.cmp_op=J,k.$attr_accessor("command"),k.$attr_accessor("prefix_number"),k.$attr_accessor("suffix_number"),k.$attr_accessor("critical"),k.$attr_accessor("fumble"),k.$attr_accessor("dollar"),k.$attr_accessor("modify_number"),k.$attr_accessor("cmp_op"),k.$attr_accessor("target_number"),k.$attr_writer("question_target"),v(k,"$initialize",function(){var A=this;return A.prefix_number=J,A.suffix_number=J,A.critical=J,A.fumble=J,A.dollar=J,A.cmp_op=J,A.target_number=J,A.question_target=!1}),v(k,"$question_target?",S("question_target")),v(k,"$to_s",function(A){var y=this,R=J,z=J,ie=J,M=J,ge=J;switch(null==A&&(A="after_command"),R=L(y.critical)?"@"+y.critical:J,z=L(y.fumble)?"#"+y.fumble:J,ie=L(y.dollar)?"$"+y.dollar:J,M=te("Format").$modifier(y.modify_number),ge=L(y.question_target)?"?":y.target_number,A){case"after_command":return[y.prefix_number,y.command,y.suffix_number,R,z,ie,M,y.cmp_op,ge].$join();case"after_modify_number":return[y.prefix_number,y.command,y.suffix_number,M,R,z,ie,y.cmp_op,ge].$join();case"after_target_number":return[y.prefix_number,y.command,y.suffix_number,M,y.cmp_op,ge,R,z,ie].$join();default:return J}},-1)},Opal.modules["bcdice/command/parser"]=function(f){var A,ie,l,p,m,x,$,re,se,De,Ae,fe,xe,c,h,d,Ce,ge,B,R,T=f.klass,ne=f.module,v=f.slice,S=f.extract_kwargs,L=f.ensure_kwargs,D=f.get_kwarg,J=f.send2,j=f.find_super,F=f.def,Z=f.send,X=f.eqeq,K=f.thrower,P=f.hash,H=f.const_set,le=f.truthy,q=f.to_ary,Y=f.hash2,Q=f.top,k=[],N=f.$r(k),te=f.nil,U=f.$$$;return Q.$require("racc/parser.rb"),Q.$require("bcdice/arithmetic/node"),Q.$require("bcdice/command/lexer"),Q.$require("bcdice/command/parsed"),T(U(N("BCDice"),"Command"),U(N("Racc"),"Parser"),"Parser"),A=k,ie=R=[ne(k[0],"BCDice")].concat(A),ge=[ne(R[0],"Command")].concat(ie),B=f.$r(ge),l=ge,h=[c=T(ge[0],U(B("Racc"),"Parser"),"Parser")].concat(l),d=f.$r(h),(Ce=c.$$prototype).notations=Ce.lexer=Ce.modifier=Ce.suffix_number=Ce.prefix_number=Ce.need_suffix_number=Ce.need_prefix_number=Ce.critical=Ce.fumble=Ce.dollar=Ce.allowed_cmp_op=Ce.question_target=te,F(c,"$initialize",function ae(he,Ee){var C,V,$e,Te,Ue=this;return ae.$$p=null,C=v(arguments),V=S(C),V=L(V),$e=C,Te=D(V,"round_type"),J(Ue,j(Ue,"initialize",ae,!1,!0),"initialize",[],null),Ue.notations=$e,Ue.round_type=Te,Ue.prefix_number=!1,Ue.suffix_number=!1,Ue.need_prefix_number=!1,Ue.need_suffix_number=!1,Ue.modifier=!0,Ue.critical=!1,Ue.fumble=!1,Ue.dollar=!1,Ue.allowed_cmp_op=[te,">=",">","<=","<","==","!="],Ue.question_target=!1},-2),F(c,"$disable_modifier",function(){return this.modifier=!1,this}),F(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),F(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),F(c,"$has_prefix_number",function(){return this.prefix_number=!0,this.need_prefix_number=!0,this}),F(c,"$has_suffix_number",function(){return this.suffix_number=!0,this.need_suffix_number=!0,this}),F(c,"$enable_critical",function(){return this.critical=!0,this}),F(c,"$enable_fumble",function(){return this.fumble=!0,this}),F(c,"$enable_dollar",function(){return this.dollar=!0,this}),F(c,"$restrict_cmp_op_to",function(he){var Ee,V=this;return Ee=v(arguments),V.allowed_cmp_op=Ee,V},-1),F(c,"$enable_question_target",function(){return this.question_target=!0,this}),F(c,"$parse",function(he){try{return this.lexer=d("Lexer").$new(he,this.notations),this.$do_parse()}catch(C){if(!f.rescue(C,[d("ParseError"),d("ZeroDivisionError")]))throw C;try{return te}finally{f.pop_exception()}}}),c.$private(),F(c,"$parsed",function(he,Ee,C,V){try{return K("eval_return"),Z(d("Parsed").$new(),"tap",[],function Fe(Ue){var Ze,lt,Et,It,hn,nn,Bn,Ln=null==Fe.$$s?this:Fe.$$s;return null==Ln.round_type&&(Ln.round_type=te),null==Ue&&(Ue=te),Ue["$command="](he["$[]"]("command")),Ue["$prefix_number="]((Ze=he["$[]"]("prefix"))===te||null==Ze?te:Ze.$eval(Ln.round_type)),Ue["$suffix_number="]((lt=he["$[]"]("suffix"))===te||null==lt?te:lt.$eval(Ln.round_type)),Ue["$critical="]((Et=Ee["$[]"]("critical"))===te||null==Et?te:Et.$eval(Ln.round_type)),Ue["$fumble="]((It=Ee["$[]"]("fumble"))===te||null==It?te:It.$eval(Ln.round_type)),Ue["$dollar="]((hn=Ee["$[]"]("dollar"))===te||null==hn?te:hn.$eval(Ln.round_type)),Ue["$modify_number="](C.$eval(Ln.round_type)),Ue["$cmp_op="](V["$[]"]("cmp_op")),X(V["$[]"]("target"),"?")?(Ue["$question_target="](!0),Z(Ue,"target_number=",nn=[0]),nn[nn.length-1]):(Ue["$question_target="](!1),nn=[(Bn=V["$[]"]("target"),Bn===te||null==Bn?te:Bn.$eval(Ln.round_type))],Z(Ue,"target_number=",nn),nn[nn.length-1])},{$$s:this})}catch(Fe){if(Fe===f.t_eval_return)return Fe.$v;throw Fe}}),F(c,"$next_token",function(){return this.lexer.$next_token()}),p=f.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),m=f.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),x=f.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),$=f.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),re=f.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),se=f.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),De=[te,6,13,3,9,-1,27,-15,-10,-1,-38],Ae=[te,te,te,te,te,te,19,16,15,te,te],fe=f.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),xe=P(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),H(h[0],"Racc_arg",[p,m,$,x,re,se,Ae,De,19,fe,xe,58,35,!0]),H(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),H(h[0],"Racc_debug_parser",!1),F(c,"$_reduce_1",function(he,Ee,C){var V;return le(this.modifier)||this.$raise(d("ParseError")),V=q(he),this.$parsed(null==V[0]?te:V[0],null==V[1]?te:V[1],null==V[2]?te:V[2],null==V[3]?te:V[3])}),F(c,"$_reduce_2",function(he,Ee,C){var V;return le(this.modifier)||this.$raise(d("ParseError")),V=q(he),this.$parsed(null==V[0]?te:V[0],null==V[2]?te:V[2],null==V[1]?te:V[1],null==V[3]?te:V[3])}),F(c,"$_reduce_3",function(he,Ee,C){var V,Ze;return Ze=null==(V=q(he))[2]?te:V[2],this.$parsed(null==V[0]?te:V[0],null==V[1]?te:V[1],U(U(d("Arithmetic"),"Node"),"Number").$new(0),Ze)}),F(c,"$_reduce_4",function(he,Ee,C){var V=this;return le(V.prefix_number)&&le(V.suffix_number)||V.$raise(d("ParseError")),Y(["command","prefix","suffix"],{command:he["$[]"](1),prefix:he["$[]"](0),suffix:he["$[]"](2)})}),F(c,"$_reduce_5",function(he,Ee,C){var V=this;return le(V.prefix_number)||V.$raise(d("ParseError")),le(V.need_suffix_number)&&V.$raise(d("ParseError")),Y(["command","prefix"],{command:he["$[]"](1),prefix:he["$[]"](0)})}),F(c,"$_reduce_6",function(he,Ee,C){var V=this;return le(V.suffix_number)||V.$raise(d("ParseError")),le(V.need_prefix_number)&&V.$raise(d("ParseError")),Y(["command","suffix"],{command:he["$[]"](0),suffix:he["$[]"](1)})}),F(c,"$_reduce_7",function(he,Ee,C){var V=this;return(le(V.need_prefix_number)||le(V.need_suffix_number))&&V.$raise(d("ParseError")),Y(["command"],{command:he["$[]"](0)})}),F(c,"$_reduce_8",function(he,Ee,C){return Y([],{})}),F(c,"$_reduce_9",function(he,Ee,C){var V,Ze,Fe=te;return Fe=null==(V=q(he))[0]?te:V[0],Ze=null==V[2]?te:V[2],le(this.critical)&&le(Fe["$[]"]("critical")["$nil?"]())||this.$raise(d("ParseError")),Fe["$[]="]("critical",Ze),Fe}),F(c,"$_reduce_10",function(he,Ee,C){var V,Ze,Fe=te;return Fe=null==(V=q(he))[0]?te:V[0],Ze=null==V[2]?te:V[2],le(this.fumble)&&le(Fe["$[]"]("fumble")["$nil?"]())||this.$raise(d("ParseError")),Fe["$[]="]("fumble",Ze),Fe}),F(c,"$_reduce_11",function(he,Ee,C){var V,Ze,Fe=te;return Fe=null==(V=q(he))[0]?te:V[0],Ze=null==V[2]?te:V[2],le(this.dollar)&&le(Fe["$[]"]("dollar")["$nil?"]())||this.$raise(d("ParseError")),Fe["$[]="]("dollar",Ze),Fe}),F(c,"$_reduce_12",function(he,Ee,C){return he["$[]"](1)}),F(c,"$_reduce_13",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),F(c,"$_reduce_14",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),F(c,"$_reduce_15",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),F(c,"$_reduce_16",function(he,Ee,C){return le(this.allowed_cmp_op["$include?"](te))||this.$raise(d("ParseError")),Y([],{})}),F(c,"$_reduce_17",function(he,Ee,C){var V,Fe,Ue;return Ue=null==(V=q(he))[1]?te:V[1],le(this.allowed_cmp_op["$include?"](Fe=null==V[0]?te:V[0]))||this.$raise(d("ParseError")),Y(["cmp_op","target"],{cmp_op:Fe,target:Ue})}),F(c,"$_reduce_18",function(he,Ee,C){var $e,V=this;return $e=he["$[]"](0),le(V.question_target)||V.$raise(d("ParseError")),le(V.allowed_cmp_op["$include?"]($e))||V.$raise(d("ParseError")),Y(["cmp_op","target"],{cmp_op:$e,target:"?"})}),F(c,"$_reduce_19",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),F(c,"$_reduce_20",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),F(c,"$_reduce_22",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),F(c,"$_reduce_23",function(he,Ee,C){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),F(c,"$_reduce_25",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),F(c,"$_reduce_26",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"DivideWithCeil")}),F(c,"$_reduce_27",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"DivideWithCeil")}),F(c,"$_reduce_28",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"DivideWithRound")}),F(c,"$_reduce_29",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"DivideWithFloor")}),F(c,"$_reduce_30",function(he,Ee,C){return he["$[]"](1)}),F(c,"$_reduce_31",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),F(c,"$_reduce_33",function(he,Ee,C){return he["$[]"](1)}),F(c,"$_reduce_34",function(he,Ee,C){return U(U(d("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),F(c,"$_reduce_none",function(he,Ee,C){return he["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(f){var Z,H,Q,k,N,te,q,K,T=f.module,ne=f.send,v=f.eqeqeq,S=f.truthy,L=f.def,D=f.return_val,J=[],j=f.nil;return Z=J,H=K=[T(J[0],"BCDice")].concat(Z),Q=q=[T(K[0],"Deprecated")].concat(H),N=[k=T(q[0],"Checker")].concat(Q),te=f.$r(N),k.$private(),L(k,"$check_result_legacy",function(I,A,y,R){var ge,z=this,ie=j,M=j,B=j,O=j;return ie=ne(A,"map",[],"sides".$to_proc()),ge=(M=ne(A,"map",[],"value".$to_proc())).$sum(),B=v([100],O=ie)?z.$check_1D100(I,ge,y,R):v([20],O)?z.$check_1D20(I,ge,y,R):v([6,6],O)?z.$check_2D6(I,ge,M,y,R):j,(S(B["$nil?"]())||S(B["$empty?"]()))&&(B=v([10],O=ie.$uniq())?z.$check_nD10(I,ge,M,y,R):v([6],O)?z.$check_nD6(I,ge,M,y,R):j,S(B["$nil?"]())||S(B["$empty?"]()))?j:te("Result").$new(B.$delete_prefix(" \uff1e "))}),L(k,"$check_1D100",D(j)),L(k,"$check_1D20",D(j)),L(k,"$check_nD10",D(j)),L(k,"$check_2D6",D(j)),L(k,"$check_nD6",D(j))},Opal.queue(function(f){var N,z,O,d,m,x,_,l,c,h,M,T=f.module,ne=f.klass,v=f.slice,S=f.rb_plus,L=f.truthy,D=f.def,J=f.regexp,j=f.send,F=f.thrower,Z=f.return_ivar,X=f.assign_ivar_val,K=f.eqeqeq,P=f.eqeq,H=f.return_val,le=f.range,q=f.rb_minus,Y=f.rb_divide,Q=f.rb_times,k=f.rb_ge,te=f.top,U=[],I=f.$r(U),A=f.nil,y=f.$$$;return te.$require("i18n"),te.$require("i18n/backend/fallbacks"),te.$require("bcdice/randomizer"),te.$require("bcdice/dice_table"),te.$require("bcdice/enum"),te.$require("bcdice/translate"),te.$require("bcdice/result"),te.$require("bcdice/command/parser"),te.$require("bcdice/deprecated/checker"),z=U,O=M=[T(U[0],"BCDice")].concat(z),l=[_=ne(M[0],null,"Base")].concat(O),c=f.$r(l),(h=_.$$prototype).raw_input=h.randomizer=h.enabled_upcase_input=h.debug=A,m=[d=f.get_singleton_class(_)].concat(l),x=f.$r(m),d.$attr_reader("prefixes"),D(d,"$register_prefix",function(re){var De,Ae=this,fe=A;return null==Ae.prefixes&&(Ae.prefixes=A),De=v(arguments),Ae.prefixes=S(L(fe=Ae.prefixes)?fe:[],De.$flatten())},-1),D(d,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),D(d,"$prefixes_pattern",function(){var re=this,se=A;return null==re.prefixes_pattern&&(re.prefixes_pattern=A),null==re.prefixes&&(re.prefixes=A),re.prefixes_pattern=L(se=re.prefixes_pattern)?se:A,L(re.prefixes_pattern)?re.prefixes_pattern:(re.prefixes=L(se=re.prefixes)?se:[],re.prefixes.$freeze(),re.prefixes_pattern=(L(re.prefixes["$empty?"]())?/(?!)/:J(["^(S)?(",re.prefixes.$join("|"),")"],"i")).$freeze())}),D(d,"$command_pattern",function(){var re=this,se=A,De=A;return null==re.command_pattern&&(re.command_pattern=A),null==re.prefixes&&(re.prefixes=A),re.command_pattern=L(se=re.command_pattern)?se:A,L(re.command_pattern)?re.command_pattern:(re.prefixes=L(se=re.prefixes)?se:[],re.prefixes.$freeze(),De=S(j(y(x("CommonCommand"),"COMMANDS"),"map",[],function(fe){return null==fe&&(fe=A),y(fe,"PREFIX_PATTERN").$source()}),re.prefixes),re.command_pattern=J(["^S?(",De.$join("|"),")"],"i").$freeze())}),D(d,"$eval",function(re){try{return F("eval_return"),this.$new(re).$eval()}catch(Ae){if(Ae===f.t_eval_return)return Ae.$v;throw Ae}}),_.$include(c("Translate")),_.$include(y(c("Deprecated"),"Checker")),D(_,"$initialize",function(p){var m=this;return m.raw_input=p,m.sort_add_dice=!1,m.sort_barabara_dice=!1,m.d66_sort_type=y(c("D66SortType"),"NO_SORT"),m.enabled_d9=!1,m.round_type=y(c("RoundType"),"FLOOR"),m.sides_implicit_d=6,m.upper_dice_reroll_threshold=A,m.reroll_dice_reroll_threshold=A,m.default_cmp_op=A,m.default_target_number=A,m.enabled_upcase_input=!0,m.locale="ja_jp",m.randomizer=y(c("BCDice"),"Randomizer").$new(),m.debug=!1}),_.$attr_accessor("randomizer"),_.$attr_reader("d66_sort_type"),_.$attr_reader("round_type"),_.$attr_reader("sides_implicit_d"),_.$attr_reader("upper_dice_reroll_threshold"),_.$attr_reader("reroll_dice_reroll_threshold"),_.$attr_reader("default_cmp_op"),_.$attr_reader("default_target_number"),D(_,"$sort_add_dice?",Z("sort_add_dice")),D(_,"$sort_barabara_dice?",Z("sort_barabara_dice")),D(_,"$enabled_d9?",Z("enabled_d9")),D(_,"$enable_debug",X("debug",!0)),D(_,"$eval",function(){var m,$,p=this,x=A;return m=y(c("BCDice"),"Preprocessor").$process(p.raw_input,p),x=L($=p.$dice_command(m))?$:p.$eval_common_command(p.raw_input),L(x)?(x["$rands="](p.randomizer.$rand_results()),x["$detailed_rands="](p.randomizer.$detailed_rand_results()),x):A}),D(_,"$change_text",function(p){return p}),D(_,"$check_result",function(p,m,x,$){var re=this,se=A,De=A,Ae=A,fe=A,Pe=A;return se=re.$check_result_legacy(p,m,x,$),L(se)?se:(De=j(m,"map",[],"sides".$to_proc()),fe=(Ae=j(m,"map",[],"value".$to_proc())).$sum(),se=K([100],Pe=De)?re.$result_1d100(p,fe,x,$):K([20],Pe)?re.$result_1d20(p,fe,x,$):K([6,6],Pe)?re.$result_2d6(p,fe,Ae,x,$):A,P(se,c("Result").$nothing())?A:L(se)?se:(se=K([10],Pe=De.$uniq())?re.$result_nd10(p,fe,Ae,x,$):K([6],Pe)?re.$result_nd6(p,fe,Ae,x,$):A,P(se,c("Result").$nothing())?A:L(se)?se:re.$result_ndx(p,x,$)))}),D(_,"$grich_text",H(A)),_.$private(),D(_,"$eval_common_command",function(p){try{F("eval_return");var x=F("return");return p=this.$change_text(p),j(y(c("CommonCommand"),"COMMANDS"),"each",[],function re(se){var Ae,De=null==re.$$s?this:re.$$s;if(null==De.randomizer&&(De.randomizer=A),null==se&&(se=A),Ae=se.$eval(p,De,De.randomizer),!L(Ae))return A;x.$throw(Ae)},{$$s:this,$$ret:x}),A}catch(re){if(re===f.t_eval_return||re===x)return re.$v;throw re}}),D(_,"$dice_command",function(p){var m=this,x=A,$=A,re=A,se=A;return L(m.enabled_upcase_input)&&(p=p.$upcase()),x=m.$class().$prefixes_pattern().$match(p),L(x)?($=x["$[]"](1)["$nil?"]()["$!"](),L($)&&(p=p["$[]"](le(1,-1,!1))),re=m.$eval_game_system_specific_command(p),L(re["$is_a?"](c("Result")))?(re["$secret="](L(se=re["$secret?"]())?se:$),re):L(re["$nil?"]())||L(re["$empty?"]())||P(re,"1")?A:j(c("Result").$new(),"tap",[],function(Ae){var fe;return null==Ae&&(Ae=A),Ae["$text="](re.$to_s()),j(Ae,"secret=",fe=[$]),fe[fe.length-1]})):A}),D(_,"$eval_game_system_specific_command",H(A)),D(_,"$result_ndx",function(p,m,x){return L(x["$is_a?"](c("String")))?A:L(p.$send(m,x))?c("Result").$success(this.$translate("success")):c("Result").$failure(this.$translate("failure"))}),D(_,"$result_1d100",H(A)),D(_,"$result_1d20",H(A)),D(_,"$result_nd10",H(A)),D(_,"$result_2d6",H(A)),D(_,"$result_nd6",H(A)),D(_,"$get_table_by_2d6",function(p){return this.$get_table_by_nD6(p,2)}),D(_,"$get_table_by_1d6",function(p){return this.$get_table_by_nD6(p,1)}),D(_,"$get_table_by_nD6",function(p,m){return this.$get_table_by_nDx(p,m,6)}),D(_,"$get_table_by_nDx",function(p,m,x){var re,se=A;return re=this.randomizer.$roll_sum(m,x),se=this.$get_table_value(p["$[]"](q(re,m))),L(se["$nil?"]())?["1",0]:[se,re]}),D(_,"$get_table_by_1d3",function(p){var $,re,m=this,se=A;return m.$debug("get_table_by_1d3"),$=m.randomizer.$roll_sum(1,6),m.$debug("num",$),re=Y(q($,1),2).$to_i(),m.$debug("index",re),se=p["$[]"](re),L(se["$nil?"]())?["1",0]:[se,$]}),D(_,"$get_table_by_d66_swap",function(p){var x;return x=this.randomizer.$roll_d66(y(c("D66SortType"),"ASC")),[this.$get_table_by_number(x,p),x]}),D(_,"$get_table_by_d66",function(p){var x,$,re,De,se=A;return x=this.randomizer.$roll_once(6),$=this.randomizer.$roll_once(6),re=S(Q(q(x,1),6),q($,1)),se=p["$[]"](re),De=""+x+$,L(se["$nil?"]())?["1",De]:[se,De]}),D(_,"$get_table_by_number",function(p,m,x){try{var $=F("return");return null==x&&(x="1"),j(m,"each",[],function se(De){var fe,Ae=null==se.$$s?this:se.$$s;if(null==De&&(De=A),fe=De["$[]"](0),!L(k(fe,p)))return A;$.$throw(Ae.$get_table_value(De["$[]"](1)))},{$$s:this,$$ret:$}),this.$get_table_value(x)}catch(se){if(se===$)return se.$v;throw se}},-3),D(_,"$get_table_value",function(p){return L(p["$is_a?"](c("Proc")))?p.$call():p}),D(_,"$roll_tables",function(p,m){var $=A;return $=m["$[]"](p),L($)?$.$roll(this.randomizer).$to_s():A}),D(_,"$debug",function(p,m){var $,re=this,se=A,De=A;return $=v(arguments,1),L(re.debug)?(se=L(p["$is_a?"](c("String")))?p:p.$inspect(),L($["$empty?"]())?re.$warn(se):(De=j($,"map",[],function(fe){return null==fe&&(fe=A),L(fe["$is_a?"](c("String")))?'"'+fe+'"':fe.$inspect()}),re.$warn(se+": "+De.$join(", ")))):A},-2),y(y(I("I18n"),"Backend"),"Simple").$include(y(y(I("I18n"),"Backend"),"Fallbacks")),I("I18n").$load_path()["$<<"](I("Dir")["$[]"](I("File").$join("bcdice","../../i18n/**/*.yml"))),I("I18n")["$default_locale="]("ja_jp"),N=[["ja_jp"]],j(I("I18n").$fallbacks(),"defaults=",N),N[N.length-1]})},4748:(E,de,ye)=>{ye(9993),Opal.modules["bcdice/normalize"]=function(f){var j,K,Z,T=f.module,ne=f.eqeqeq,v=f.def,S=f.eqeq,L=[],D=f.nil;return j=L,Z=[T(L[0],"BCDice")].concat(j),(K=T(Z[0],"Normalize")).$module_function(),v(K,"$comparison_operator",function(H){var le;return ne(/<=|=</,le=H)?"<=":ne(/>=|=>/,le)?">=":ne(/<>|!=|=!/,le)?"!=":ne(/</,le)?"<":ne(/>/,le)?">":ne(/=/,le)?"==":D}),v(K,"$target_number",function(H){return S(H,"?")?H:H.$to_i()})},Opal.modules["racc/parser"]=function(f){var R,ie,M,T=f.module,ne=f.klass,v=f.truthy,S=f.const_set,L=f.defs,D=f.gvars,J=f.rb_lt,j=f.def,F=f.to_ary,Z=f.send,X=f.neqeq,K=f.rb_plus,P=f.eqeq,H=f.rb_ge,le=f.rb_gt,q=f.rb_minus,Y=f.rb_le,Q=f.rb_times,k=f.assign_ivar_val,te=[],U=f.$r(te),I=f.nil,A=f.$$$;return R=te,ie=[T(te[0],"Racc")].concat(R),M=f.$r(ie),ne(ie[0],M("StandardError"),"ParseError"),v(A("::","ParseError","skip_raise")?"constant":I)||S(te[0],"ParseError",A(U("Racc"),"ParseError")),function(y,R){var _,l,c,h,d,M=[T(y,"Racc")].concat(R),ge=f.$r(M);return v(ge("Racc_No_Extensions","skip_raise")?"constant":I)||S(M[0],"Racc_No_Extensions",!1),_=M,c=[l=ne(M[0],null,"Parser")].concat(_),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=I,S(c[0],"Racc_Runtime_Version","1.4.6"),S(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),S(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),S(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),S(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),S(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),S(c[0],"Racc_Runtime_Type","ruby"),L(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),j(l,"$_racc_setup",function(){var m,x,$=this,re=I,se=I;return null==D.stderr&&(D.stderr=I),v(A($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(m=$.yydebug)&&m!==I?"instance-variable":I)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==I?"instance-variable":I)||($.racc_debug_out=D.stderr),$.racc_debug_out=v(re=$.racc_debug_out)?re:D.stderr),se=A($.$class(),"Racc_arg"),v(J(se.$size(),14))&&se["$[]="](13,!0),se}),j(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=I,m.racc_val=I,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),j(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),j(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),j(l,"$_racc_do_parse_rb",function(m,x){var $,De=I,Ae=I,fe=I,Pe=I,xe=I,pe=I,Me=I,Ce=I;return $=F(m),De=null==$[0]?I:$[0],Ae=null==$[1]?I:$[1],fe=null==$[2]?I:$[2],Pe=null==$[3]?I:$[3],xe=null==$[10]?I:$[10],this.$_racc_init_sysvars(),pe=Me=Ce=I,Z(this,"catch",["racc_end_parse"],function ae(){var he,Ee,C=null==ae.$$s?this:ae.$$s,V=I;for(null==C.racc_state&&(C.racc_state=I),null==C.racc_read_next&&(C.racc_read_next=I),null==C.racc_t&&(C.racc_t=I),null==C.yydebug&&(C.yydebug=I),null==C.racc_val&&(C.racc_val=I);v(!0);)for(v(Ce=Pe["$[]"](C.racc_state["$[]"](-1)))?(v(C.racc_read_next)&&X(C.racc_t,0)&&(Ee=C.$next_token(),he=F(Ee),pe=null==he[0]?I:he[0],C.racc_val=null==he[1]?I:he[1],C.racc_t=v(pe)?v(V=xe["$[]"](pe))?V:1:0,v(C.yydebug)&&C.$racc_read_token(C.racc_t,pe,C.racc_val),C.racc_read_next=!1),Ce=K(Ce,C.racc_t),v(H(Ce,0))&&v(Me=De["$[]"](Ce))&&P(Ae["$[]"](Ce),C.racc_state["$[]"](-1))||(Me=fe["$[]"](C.racc_state["$[]"](-1)))):Me=fe["$[]"](C.racc_state["$[]"](-1));v(Me=C.$_racc_evalact(Me,m)););},{$$s:this})}),j(l,"$yyparse",function(m,x){return this.$__send__(h("Racc_YY_Parse_Method"),m,x,this.$_racc_setup(),!0)}),j(l,"$_racc_yyparse_rb",function(m,x,$,re){var se,fe=I,Pe=I,be=I,xe=I,Me=I,Ce=I,ae=I;return se=F($),fe=null==se[0]?I:se[0],Pe=null==se[1]?I:se[1],be=null==se[2]?I:se[2],xe=null==se[3]?I:se[3],Me=null==se[10]?I:se[10],this.$_racc_init_sysvars(),Ce=I,ae=I,Z(this,"catch",["racc_end_parse"],function he(){var Ee=null==he.$$s?this:he.$$s;for(null==Ee.racc_state&&(Ee.racc_state=I);!v(ae=xe["$[]"](Ee.racc_state["$[]"](-1)));)for(;v(Ce=Ee.$_racc_evalact(be["$[]"](Ee.racc_state["$[]"](-1)),$)););return Z(m,"__send__",[x],function C(V,$e){var Te=null==C.$$s?this:C.$$s,Fe=I,Ue=I;for(null==Te.racc_t&&(Te.racc_t=I),null==Te.racc_state&&(Te.racc_state=I),null==Te.racc_read_next&&(Te.racc_read_next=I),null==V&&(V=I),null==$e&&($e=I),Te.racc_t=v(V)?v(Fe=Me["$[]"](V))?Fe:1:0,Te.racc_val=$e,Te.racc_read_next=!1,ae=K(ae,Te.racc_t),v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););for(;v(v(Fe=v(Ue=(ae=xe["$[]"](Te.racc_state["$[]"](-1)))["$!"]())?Ue:Te.racc_read_next["$!"]())?Fe:Te.racc_t["$=="](0));)for(v(ae)&&v(ae=K(ae,Te.racc_t))&&v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););},{$$s:Ee})},{$$s:this})}),j(l,"$_racc_evalact",function(m,x){var $,be,se=this,De=I,Ae=I,Pe=I,xe=I,pe=I,Me=I;if(De=null==($=F(x))[0]?I:$[0],Ae=null==$[1]?I:$[1],Pe=null==$[3]?I:$[3],be=null==$[11]?I:$[11],xe=null==$[12]?I:$[12],v(le(m,0))&&v(J(m,be)))v(le(se.racc_error_status,0))&&(P(se.racc_t,1)||(se.racc_error_status=q(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,v(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(v(J(m,0))&&v(le(m,xe["$-@"]()))){if(pe=Z(se,"catch",["racc_jump"],function Ce(){var ae=null==Ce.$$s?this:Ce.$$s;return null==ae.racc_state&&(ae.racc_state=I),ae.racc_state.$push(ae.$_racc_do_reduce(x,m)),!1},{$$s:se}),v(pe))switch(pe){case 1:return se.racc_user_yyerror=!0,xe["$-@"]();case 2:return be;default:se.$raise("[Racc Bug] unknown jump code")}}else if(P(m,be))v(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(P(m,xe["$-@"]())){switch(se.racc_error_status){case 0:v(x["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:P(se.racc_t,0)&&se.$throw("racc_end_parse",I),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;v(!0)&&!(v(Me=Pe["$[]"](se.racc_state["$[]"](-1)))&&(Me=K(Me,1),v(H(Me,0))&&v(m=De["$[]"](Me))&&P(Ae["$[]"](Me),se.racc_state["$[]"](-1))));)v(Y(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",I),se.racc_state.$pop(),se.racc_vstack.$pop(),v(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return v(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),I}),j(l,"$_racc_do_reduce",function(m,x){var $,xe,Me,V,$e,Te,Ze,se=this,Ae=I,fe=I,Pe=I,be=I,pe=I,Ce=I,ae=I,he=I,Ee=I,C=I,Fe=I,Ue=I,lt=I;return Ae=null==($=F(m))[4]?I:$[4],fe=null==$[5]?I:$[5],Pe=null==$[6]?I:$[6],be=null==$[7]?I:$[7],xe=null==$[8]?I:$[8],pe=null==$[9]?I:$[9],Me=null==$[13]?I:$[13],Ce=se.racc_state,ae=se.racc_vstack,he=se.racc_tstack,Ee=Q(x,-3),C=pe["$[]"](Ee),V=pe["$[]"](K(Ee,1)),$e=pe["$[]"](K(Ee,2)),Te=[],v(se.yydebug)&&(Fe=he["$[]"](C["$-@"](),C)),Ue=ae["$[]"](C["$-@"](),C),v(se.yydebug)&&he["$[]="](C["$-@"](),C,Te),ae["$[]="](C["$-@"](),C,Te),Ce["$[]="](C["$-@"](),C,Te),v(Me)?ae.$push(se.$__send__($e,Ue,ae,Ue["$[]"](0))):ae.$push(se.$__send__($e,Ue,ae)),he.$push(V),v(se.yydebug)&&se.$racc_reduce(Fe,V,he,ae),Ze=q(V,xe),v(Ee=be["$[]"](Ze))&&(Ee=K(Ee,Ce["$[]"](-1)),v(H(Ee,0))&&v(lt=Ae["$[]"](Ee))&&P(fe["$[]"](Ee),Ze))?lt:Pe["$[]"](Ze)}),j(l,"$on_error",function(m,x,$){var se;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(se=this.$token_to_str(m))?se:"?"))}),j(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),j(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),j(l,"$yyerrok",k("racc_error_status",0)),j(l,"$racc_read_token",function(m,x,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(x.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),j(l,"$racc_shift",function(m,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_reduce",function(m,x,$,re){var se=this,De=I;return(De=se.racc_debug_out).$print("reduce "),v(m["$empty?"]())?De.$print(" <none>"):Z(m,"each",[],function Ae(fe){return null==fe&&(fe=I),De.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(fe))},{$$s:se}),De.$puts(" --\x3e "+se.$racc_token2str(x)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),j(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),j(l,"$racc_e_pop",function(m,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_next_state",function(m,x){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(x),$.racc_debug_out.$puts()}),j(l,"$racc_print_stacks",function(m,x){var re=I;return(re=this.racc_debug_out).$print("        ["),Z(m,"each_index",[],function se(De){return null==De&&(De=I),re.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(m["$[]"](De))," ",x["$[]"](De).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),j(l,"$racc_print_states",function(m){var $=I;return($=this.racc_debug_out).$print("        ["),Z(m,"each",[],function(se){return null==se&&(se=I),$.$print(" ",se)}),$.$puts(" ]")}),j(l,"$racc_token2str",function(m){var $;return v($=A(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),j(l,"$token_to_str",function(m){return A(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(te[0],te)},Opal.modules.strscan=function(f){var P,H,le,q,Y,ne=f.def,v=f.truthy,S=f.eqeqeq,L=f.Opal,D=f.return_ivar,J=f.send,j=f.alias,F=[],Z=f.nil;return P=F,le=[H=(0,f.klass)(F[0],null,"StringScanner")].concat(P),q=f.$r(le),(Y=H.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=Z,H.$attr_reader("pos","matched"),ne(H,"$initialize",function(k){var N=this;return N.string=k,N.pos=0,N.matched=Z,N.working=k,N.match=[]}),H.$attr_reader("string"),ne(H,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),ne(H,"$scan",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?N.matched=Z:(N.prev_pos=N.pos,N.pos+=te[0].length,N.working=N.working.substring(te[0].length),N.matched=te[0],N.match=te,te[0])}),ne(H,"$scan_until",function(k){var N=this;k=N.$anchor(k);for(var te=N.working,U=0;te.length!=U;++U){var I=k.exec(te.substr(U));if(null!==I){var A=U+I[0].length,y=te.substr(0,A);return N.matched=I[0],N.match=I,N.prev_pos=N.pos+U,N.pos+=A,N.working=te.substr(A),y}}return N.matched=Z}),ne(H,"$[]",function(k){var te;if(v(this.match["$empty?"]()))return Z;S(q("Symbol"),te=k)?k=k.$to_s():S(q("String"),te)||(k=L["$coerce_to!"](k,q("Integer"),"to_int"));var U=this.match;return k<0&&(k+=U.length),k<0||k>=U.length||null==U[k]?Z:U[k]}),ne(H,"$check",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return N.matched=null==te?Z:te[0]}),ne(H,"$check_until",function(k){var N=this,te=N.prev_pos,U=N.pos,I=N.working,A=N.$scan_until(k);return N.prev_pos=te,N.pos=U,N.working=I,A}),ne(H,"$peek",function(k){return this.working.substring(0,k)}),ne(H,"$eos?",function(){return 0===this.working.length}),ne(H,"$exist?",function(k){var te=k.exec(this.working);return null==te?Z:0==te.index?0:te.index+1}),ne(H,"$skip",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);if(null==te)return N.match=[],N.matched=Z;var U=te[0],I=U.length;return N.matched=U,N.match=te,N.prev_pos=N.pos,N.pos+=I,N.working=N.working.substring(I),I}),ne(H,"$skip_until",function(k){var te=this.$scan_until(k);return te===Z?Z:(this.matched=te.substr(-1),te.length)}),ne(H,"$get_byte",function(){var k=this,N=Z;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,N=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=Z,N}),ne(H,"$match?",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?Z:(N.prev_pos=N.pos,te[0].length)}),ne(H,"$pos=",function(k){var N=this;return k<0&&(k+=N.string.$length()),N.pos=k,N.working=N.string.slice(k)}),ne(H,"$matched_size",function(){return this.matched===Z?Z:this.matched.length}),ne(H,"$post_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(k.pos)}),ne(H,"$pre_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(0,k.prev_pos)}),ne(H,"$reset",function(){var k=this;return k.working=k.string,k.matched=Z,k.pos=0}),ne(H,"$rest",D("working")),ne(H,"$rest?",function(){return 0!==this.working.length}),ne(H,"$rest_size",function(){return this.$rest().$size()}),ne(H,"$terminate",function(){var k,N=this;return N.match=Z,k=[N.string.$length()],J(N,"pos=",k),k[k.length-1]}),ne(H,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=Z,k.match=Z,k}),j(H,"bol?","beginning_of_line?"),j(H,"getch","get_byte"),H.$private(),ne(H,"$anchor",function(k){var N=k.toString().match(/\/([^\/]+)$/);return N=N?N[1]:void 0,new RegExp("^(?:"+k.source+")",N)})},Opal.modules["bcdice/common_command/lexer"]=function(f){var X,le,N,te,U,I,Y,P,T=f.module,ne=f.klass,v=f.const_set,S=f.hash2,L=f.truthy,D=f.def,J=f.top,j=[],F=f.nil;return J.$require("strscan"),J.$require("bcdice/normalize"),X=j,le=P=[T(j[0],"BCDice")].concat(X),N=Y=[T(P[0],"CommonCommand")].concat(le),U=[te=ne(Y[0],null,"Lexer")].concat(N),I=f.$r(U),te.$$prototype.scanner=F,v(U[0],"SYMBOLS",S(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),D(te,"$initialize",function(R){var ie;return R=L(ie=R.$split(" ",2).$first())?ie:"",this.scanner=I("StringScanner").$new(R)}),D(te,"$next_token",function(){var R=this,z=F,ie=F,M=F,B=F;return L(R.scanner["$eos?"]())?[!1,"$"]:L(z=R.scanner.$scan(/\d+/))?["NUMBER",z.$to_i()]:L(ie=R.scanner.$scan(/[<>!=]+/))?["CMP_OP",I("Normalize").$comparison_operator(ie)]:(M=R.scanner.$getch().$upcase(),[L(B=I("SYMBOLS")["$[]"](M))?B:M.$to_sym(),M])}),D(te,"$source",function(){return this.scanner.$string()})},Opal.modules.singleton=function(f){var X,q,Y,Q,k,K,P,H,T=f.module,ne=f.def,v=f.send2,S=f.find_super,L=f.send,D=f.truthy,J=f.defs,j=[],F=f.nil;return X=j,P=[K=T(j[0],"Singleton")].concat(X),H=f.$r(P),ne(K,"$clone",function(){return this.$raise(H("TypeError"),"can't clone instance of singleton "+this.$class())}),ne(K,"$dup",function(){return this.$raise(H("TypeError"),"can't dup instance of singleton "+this.$class())}),q=P,Q=[Y=T(P[0],"SingletonClassMethods")].concat(q),k=f.$r(Q),ne(Y,"$clone",function N(){var te=N.$$p||F;return N.$$p=null,k("Singleton").$__init__(v(this,S(this,"clone",N,!1,!0),"clone",[],te))}),ne(Y,"$inherited",function N(te){var U=N.$$p||F;return N.$$p=null,v(this,S(this,"inherited",N,!1,!0),"inherited",[te],U),k("Singleton").$__init__(te)}),function(le,q){var Y=[le].concat(q),Q=f.$r(Y);return ne(le,"$__init__",function(N){return L(N,"instance_eval",[],function U(){return(null==U.$$s?this:U.$$s).singleton__instance__=F},{$$s:this}),J(N,"$instance",function(){var I=this;return null==I.singleton__instance__&&(I.singleton__instance__=F),D(I.singleton__instance__)?I.singleton__instance__:I.singleton__instance__=I.$new()}),N}),ne(le,"$included",function k(N){var te=k.$$p||F;return k.$$p=null,v(this,S(this,"included",k,!1,!0),"included",[N],te),N.$extend(Q("SingletonClassMethods")),Q("Singleton").$__init__(N)})}(f.get_singleton_class(H("Singleton")),P)},Opal.modules["bcdice/common_command/add_dice/node"]=function(f){var y,M,_,d,se,De,Ae,fe,Pe,m,x,c,B,z,T=f.module,ne=f.klass,v=f.def,S=f.rb_plus,L=f.thrower,D=f.truthy,J=f.rb_le,j=f.send,F=f.return_val,Z=f.alias,X=f.return_ivar,K=f.send2,P=f.find_super,H=f.const_set,le=f.eqeqeq,q=f.rb_divide,Y=f.assign_ivar,Q=f.not,k=f.neqeq,te=[],U=f.nil,I=f.$$$;return f.top.$require("singleton"),y=te,M=z=[T(te[0],"BCDice")].concat(y),_=B=[T(z[0],"CommonCommand")].concat(M),d=c=[T(B[0],"AddDice")].concat(_),m=[T(c[0],"Node")].concat(d),x=f.$r(m),se=m,Ae=[De=ne(m[0],null,"Command")].concat(se),fe=f.$r(Ae),(Pe=De.$$prototype).lhs=Pe.rhs=Pe.cmp_op=U,De.$attr_reader("lhs"),De.$attr_reader("cmp_op"),De.$attr_reader("rhs"),v(De,"$initialize",function(xe,pe,Me,Ce){return null==Me&&(Me=U),null==Ce&&(Ce=U),this.secret=xe,this.lhs=pe,this.cmp_op=Me,this.rhs=Ce},-3),v(De,"$expr",function(xe){try{var Me;return L("eval_return"),S(S(this.lhs.$expr(xe),this.$cmp_op_text()),(Me=this.rhs,Me===U||null==Me?U:Me.$eval(xe,U)).$to_s())}catch(ae){if(ae===f.t_eval_return)return ae.$v;throw ae}}),v(De,"$s_exp",function(){var xe=this;return D(xe.cmp_op)?"(Command ("+xe.cmp_op+" "+xe.lhs.$s_exp()+" "+xe.rhs.$s_exp()+"))":"(Command "+xe.lhs.$s_exp()+")"}),v(De,"$eval",function(xe,pe){try{L("eval_return");var Ce,$e,ae=this,he=U,Ee=U,C=U,V=U,Te=U;return pe=fe("Randomizer").$new(pe,xe),he=ae.lhs.$eval(xe,pe),Ee=D(J(pe.$rand_results().$size(),1))&&D(ae.lhs["$is_a?"](I(fe("Node"),"DiceRoll")))?U:ae.lhs.$output(),C=D(ae.cmp_op)?(V=ae.rhs.$eval(xe,U),xe.$check_result(he,pe.$rand_results(),ae.cmp_op,V)):U,C=D($e=C)?$e:fe("Result").$new(),Te=["("+ae.$expr(xe)+")",Ee,he,(Ce=C,Ce===U||null==Ce?U:Ce.$text())].$compact(),j(C,"tap",[],function Fe(Ue){var Ze,lt=null==Fe.$$s?this:Fe.$$s;return null==lt.secret&&(lt.secret=U),null==Ue&&(Ue=U),Ue["$secret="](lt.secret),Ze=[Te.$join(" \uff1e ")],j(Ue,"text=",Ze),Ze[Ze.length-1]},{$$s:ae})}catch(Fe){if(Fe===f.t_eval_return)return Fe.$v;throw Fe}}),De.$private(),v(De,"$cmp_op_text",function(){switch(this.cmp_op){case"!=":return"<>";case"==":return"=";default:return this.cmp_op.$to_s()}}),function($,re,se){var De=ne($,null,"UndecidedTarget"),Ae=[De].concat(se),fe=f.$r(Ae);De.$include(fe("Singleton")),v(De,"$eval",F("?")),v(De,"$include_dice?",F(!1)),v(De,"$expr",F("?")),v(De,"$output",F("?")),Z(De,"s_exp","output")}(m[0],0,m),function($,re){var se=ne($,null,"BinaryOp"),De=se.$$prototype;De.lhs=De.rhs=De.op=U,v(se,"$initialize",function(fe,Pe,be){return this.lhs=fe,this.op=Pe,this.rhs=be}),v(se,"$eval",function(fe,Pe){try{var pe,Me;return L("eval_return"),pe=this.lhs.$eval(fe,Pe),Me=this.rhs.$eval(fe,Pe),this.$calc(pe,Me,fe.$round_type()).$to_i()}catch(Ce){if(Ce===f.t_eval_return)return Ce.$v;throw Ce}}),v(se,"$include_dice?",function(){var Pe;return D(Pe=this.lhs["$include_dice?"]())?Pe:this.rhs["$include_dice?"]()}),v(se,"$expr",function(fe){var be,xe;return be=this.lhs.$expr(fe),xe=this.rhs.$expr(fe),""+be+this.op+xe}),v(se,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()}),v(se,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"}),se.$private(),v(se,"$calc",function(fe,Pe,be){return fe.$send(this.op,Pe).$to_i()}),v(se,"$op_for_s_exp",X("op"))}(m[0]),function($,re,se){var De=ne($,re,"DivideBase"),Ae=[De].concat(se),fe=f.$r(Ae);De.$$prototype.op=U,v(De,"$initialize",function be(xe,pe){return be.$$p=null,K(this,P(this,"initialize",be,!1,!0),"initialize",[xe,"/",pe],null)}),v(De,"$expr",function be(xe){return be.$$p=null,""+K(this,P(this,"expr",be,!1,!0),"expr",[xe],null)+this.$rounding_method()}),v(De,"$output",function be(){var xe=be.$$p||U;return be.$$p=null,""+K(this,P(this,"output",be,!1,!0),"output",[],xe)+this.$rounding_method()}),De.$private(),v(De,"$rounding_method",function(){return I(this.$class(),"ROUNDING_METHOD")}),v(De,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(De,"$calc",function(xe,pe,Me){return D(pe["$zero?"]())?1:this.$divide_and_round(xe,pe,Me).$to_i()}),v(De,"$divide_and_round",function(xe,pe,Me){return this.$raise(fe("NotImplementedError"))})}(m[0],x("BinaryOp"),m),function($,re,se){var De=ne($,re,"DivideWithGameSystemDefault"),Ae=[De].concat(se),fe=f.$r(Ae);H(Ae[0],"ROUNDING_METHOD",""),De.$private(),v(De,"$divide_and_round",function(be,xe,pe){var Me,Ce=U;return le(I(fe("RoundType"),"CEIL"),Me=pe)?q(be.$to_f(),xe).$ceil():le(I(fe("RoundType"),"ROUND"),Me)?(Ce=q(be.$to_f(),xe),D(Ce["$negative?"]())?Ce.$abs().$round()["$-@"]():Ce.$round()):q(be,xe).$floor()})}(m[0],x("DivideBase"),m),function($,re,se){var De=ne($,re,"DivideWithRoundingUp"),Ae=[De].concat(se);H(Ae[0],"ROUNDING_METHOD","U"),De.$private(),v(De,"$divide_and_round",function(Pe,be,xe){return q(Pe.$to_f(),be).$ceil()})}(m[0],x("DivideBase"),m),function($,re,se){var De=ne($,re,"DivideWithRoundingOff"),Ae=[De].concat(se);H(Ae[0],"ROUNDING_METHOD","R"),De.$private(),v(De,"$divide_and_round",function(Pe,be,xe){var pe=U;return pe=q(Pe.$to_f(),be),D(pe["$negative?"]())?pe.$abs().$round()["$-@"]():pe.$round()})}(m[0],x("DivideBase"),m),function($,re,se){var De=ne($,re,"DivideWithRoundingDown"),Ae=[De].concat(se);H(Ae[0],"ROUNDING_METHOD","F"),De.$private(),v(De,"$divide_and_round",function(Pe,be,xe){return q(Pe,be).$floor()})}(m[0],x("DivideBase"),m),function($,re){var se=ne($,null,"Negate");se.$$prototype.body=U,se.$attr_reader("body"),v(se,"$initialize",Y("body")),v(se,"$eval",function(fe,Pe){try{return L("eval_return"),this.body.$eval(fe,Pe).$to_i()["$-@"]()}catch(pe){if(pe===f.t_eval_return)return pe.$v;throw pe}}),v(se,"$include_dice?",function(){return this.body["$include_dice?"]()}),v(se,"$expr",function(fe){return"-"+this.body.$expr(fe)}),v(se,"$output",function(){return"-"+this.body.$output()}),v(se,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(m[0]),function($,re){var se=ne($,null,"DiceRoll"),De=se.$$prototype;De.times=De.sides=U,v(se,"$initialize",function(fe,Pe){return this.times=fe,this.sides=Pe,this.text=U}),v(se,"$eval",function(fe,Pe){try{L("eval_return");var pe,Me,Ce=U,ae=U;return pe=this.times.$eval(fe,U),Me=this.$eval_sides(fe),ae=(Ce=Pe.$roll(pe,Me)).$sum(),this.text=ae+"["+Ce.$join(",")+"]",ae.$to_i()}catch(he){if(he===f.t_eval_return)return he.$v;throw he}}),v(se,"$include_dice?",F(!0)),v(se,"$expr",function(fe){try{return L("eval_return"),this.times.$eval(fe,U)+"D"+this.$eval_sides(fe)}catch(Me){if(Me===f.t_eval_return)return Me.$v;throw Me}}),v(se,"$output",X("text")),v(se,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"}),se.$private(),v(se,"$eval_sides",function(fe){try{return L("eval_return"),this.sides.$eval(fe,U)}catch(xe){if(xe===f.t_eval_return)return xe.$v;throw xe}})}(m[0]),function($,re){var se=ne($,re,"ImplicitSidesDiceRoll");se.$$prototype.times=U,v(se,"$initialize",function(fe){return this.times=fe,this.text=U}),v(se,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"}),se.$private(),v(se,"$eval_sides",function(fe){return fe.$sides_implicit_d()})}(m[0],x("DiceRoll")),function($,re,se){var De=ne($,null,"DiceRollWithFilter"),Ae=[De].concat(se),fe=f.$r(Ae),Pe=De.$$prototype;Pe.times=Pe.n_filtering=Pe.filter=Pe.sides=U,H(Ae[0],"Filter",fe("Struct").$new("abbr","apply")),H(Ae[0],"KEEP_HIGHEST",fe("Filter").$new("KH",j(De,"lambda",[],function(xe,pe){return null==xe&&(xe=U),null==pe&&(pe=U),xe.$reverse().$take(pe)})).$freeze()),H(Ae[0],"KEEP_LOWEST",fe("Filter").$new("KL",j(De,"lambda",[],function(xe,pe){return null==xe&&(xe=U),null==pe&&(pe=U),xe.$take(pe)})).$freeze()),H(Ae[0],"DROP_HIGHEST",fe("Filter").$new("DH",j(De,"lambda",[],function(xe,pe){return null==xe&&(xe=U),null==pe&&(pe=U),xe.$reverse().$drop(pe)})).$freeze()),H(Ae[0],"DROP_LOWEST",fe("Filter").$new("DL",j(De,"lambda",[],function(xe,pe){return null==xe&&(xe=U),null==pe&&(pe=U),xe.$drop(pe)})).$freeze()),v(De,"$initialize",function(xe,pe,Me,Ce){var ae=this;return k(pe,"implicit")&&Q(pe["$respond_to?"]("eval"))&&ae.$raise(fe("TypeError"),"sides must be a Node or :implicit ("+pe.$inspect()+")"),ae.times=xe,ae.sides=pe,ae.n_filtering=Me,ae.filter=Ce,ae.text=U}),v(De,"$eval",function(xe,pe){try{L("eval_return");var ae,he,Ee,Ce=this,C=U,V=U;return ae=Ce.times.$eval(xe,U),he=Ce.$eval_sides(xe),Ee=Ce.n_filtering.$eval(xe,U),C=pe.$roll(ae,he).$sort(),V=Ce.filter.$apply()["$[]"](C,Ee).$sum(),Ce.text=V+"["+C.$join(",")+"]",V.$to_i()}catch($e){if($e===f.t_eval_return)return $e.$v;throw $e}}),v(De,"$include_dice?",F(!0)),v(De,"$implicit_sides?",function(){return this.sides["$=="]("implicit")}),v(De,"$expr",function(xe){try{var Ce,ae,he;return L("eval_return"),Ce=this.times.$eval(xe,U),ae=this.$eval_sides(xe),he=this.n_filtering.$eval(xe,U),Ce+"D"+ae+this.filter.$abbr()+he}catch(Ee){if(Ee===f.t_eval_return)return Ee.$v;throw Ee}}),v(De,"$output",X("text")),v(De,"$s_exp",function(){var pe,xe=this;return pe=D(xe["$implicit_sides?"]())?xe.sides.$inspect():xe.sides.$s_exp(),"(DiceRollWithFilter "+xe.times.$s_exp()+" "+pe+" "+xe.filter.$abbr().$inspect()+" "+xe.n_filtering.$s_exp()+")"}),De.$private(),v(De,"$eval_sides",function(xe){try{return L("eval_return"),D(this["$implicit_sides?"]())?xe.$sides_implicit_d():this.sides.$eval(xe,U)}catch(Ce){if(Ce===f.t_eval_return)return Ce.$v;throw Ce}})}(m[0],0,m),function($,re){var se=ne($,null,"Parenthesis");se.$$prototype.expr=U,v(se,"$initialize",Y("expr")),v(se,"$eval",function(fe,Pe){try{return L("eval_return"),this.expr.$eval(fe,Pe).$to_i()}catch(pe){if(pe===f.t_eval_return)return pe.$v;throw pe}}),v(se,"$include_dice?",function(){return this.expr["$include_dice?"]()}),v(se,"$expr",function(fe){return"("+this.expr.$expr(fe)+")"}),v(se,"$output",function(){return"("+this.expr.$output()+")"}),v(se,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(m[0]),function($,re,se){var De=ne($,null,"Number"),Ae=[De].concat(se),fe=f.$r(Ae);return De.$$prototype.literal=U,De.$attr_reader("literal"),v(De,"$initialize",function(xe){return this.literal=xe.$to_i()}),v(De,"$negate",function(){return fe("Number").$new(this.literal["$-@"]())}),v(De,"$eval",function(xe,pe){return this.literal.$to_i()}),v(De,"$include_dice?",F(!1)),v(De,"$expr",function(xe){return this.literal.$to_s()}),v(De,"$output",function(){return this.literal.$to_s()}),Z(De,"s_exp","output")}(m[0],0,m)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(f){var k,I,z,_,d,p,m,x,$,re,se,De,Ae,be,l,c,h,M,ge,y,te,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.truthy,D=f.eqeq,J=f.hash,j=f.const_set,F=f.to_ary,Z=f.not,X=f.return_val,K=f.neqeq,P=f.hash2,H=f.top,le=[],q=f.nil,Y=f.$$$;return H.$require("racc/parser.rb"),H.$require("bcdice/common_command/lexer"),H.$require("bcdice/common_command/add_dice/node"),k=le,I=te=[T(le[0],"BCDice")].concat(k),z=y=[T(te[0],"CommonCommand")].concat(I),M=[T(y[0],"AddDice")].concat(z),ge=f.$r(M),_=M,c=[l=ne(M[0],Y(ge("Racc"),"Parser"),"Parser")].concat(_),h=f.$r(c),l.$$prototype.lexer=q,v(l,"$parse",function(ae){return this.$new().$parse(ae)}),S(l,"$parse",function(ae){try{return this.lexer=h("Lexer").$new(ae),this.$do_parse()}catch(Ee){if(!f.rescue(Ee,[h("ParseError")]))throw Ee;try{return q}finally{f.pop_exception()}}}),l.$private(),S(l,"$next_token",function(){return this.lexer.$next_token()}),S(l,"$expand_negate",function(ae,he){if(L(he["$is_a?"](Y(h("Node"),"Negate")))){if(D(ae,"+"))return["-",he.$body()];if(D(ae,"-"))return["+",he.$body()]}return[ae,he]}),d=f.large_array_unpack("14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,,13,,8,9,8,9,13,14,13,,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,,42,13,,17,18,40,39,13,,38,-28,-28,40,39,-28,,38,45,47,44,46,52,53,54,55"),p=f.large_array_unpack("16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,,13,,17,17,18,18,17,20,18,,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,,25,20,,5,5,24,24,23,,24,33,33,34,34,33,,34,32,32,32,32,39,39,40,40"),m=f.large_array_unpack("7,19,5,,34,61,-15,,7,13,,32,-1,28,,,-2,34,36,43,55,,,61,76,53,,-5,,22,48,,79,81,83,,6,,-8,90,92,,,,,,,,,,29,31,,,,,,"),x=f.large_array_unpack("-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32"),$=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,q,q,q,q,q,q,49],re=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,q,q,q,q,q,q,9],se=[q,7,8,-1,-7,-13,-6,-22,q,-12,-6,-18,q,q,q],De=[q,q,q,q,q,6,7,q,10,11,q,q,36,37,41],Ae=f.large_array_unpack("0,0,racc_error,2,26,_reduce_1,4,26,_reduce_2,0,27,_reduce_3,1,27,_reduce_4,1,29,_reduce_none,1,29,_reduce_6,3,28,_reduce_7,3,28,_reduce_8,1,28,_reduce_none,3,30,_reduce_10,4,30,_reduce_11,1,30,_reduce_none,0,32,_reduce_13,1,32,_reduce_14,1,32,_reduce_15,1,32,_reduce_16,1,32,_reduce_17,2,31,_reduce_18,2,31,_reduce_19,1,31,_reduce_none,3,33,_reduce_21,2,33,_reduce_22,4,33,_reduce_23,2,33,_reduce_24,3,33,_reduce_25,1,33,_reduce_none,0,35,_reduce_27,1,35,_reduce_28,2,36,_reduce_29,1,36,_reduce_30,3,39,_reduce_31,3,39,_reduce_32,2,37,_reduce_33,2,37,_reduce_34,2,37,_reduce_35,2,37,_reduce_36,1,38,_reduce_none,1,38,_reduce_none,3,34,_reduce_39,1,34,_reduce_40"),be=J(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),j(c[0],"Racc_arg",[d,p,x,m,$,re,De,se,25,Ae,be,58,41,!0]),j(c[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,CMP_OP,S,D,K,H,L,M,A,X,I,N,U,R,F,C,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,QUESTION,$start,command,secret,add,target,mul,unary,round_type,dice,term,explicit_or_implicit_sides,filter,filter_type,filter_type_with_shorthand,filter_shorthand")),j(c[0],"Racc_debug_parser",!1),S(l,"$_reduce_1",function(ae,he,Ee){var C,Te,Fe=q;return Te=null==(C=F(ae))[0]?q:C[0],L((Fe=null==C[1]?q:C[1])["$include_dice?"]())||this.$raise(h("ParseError")),Y(h("Node"),"Command").$new(Te,Fe)}),S(l,"$_reduce_2",function(ae,he,Ee){var C,Te,Fe=q,Ue=q,Ze=q;return Te=null==(C=F(ae))[0]?q:C[0],Ue=null==C[2]?q:C[2],Ze=null==C[3]?q:C[3],(Z((Fe=null==C[1]?q:C[1])["$include_dice?"]())||L(Ze["$include_dice?"]())||L(Ue["$nil?"]()))&&this.$raise(h("ParseError")),Y(h("Node"),"Command").$new(Te,Fe,Ue,Ze)}),S(l,"$_reduce_3",X(!1)),S(l,"$_reduce_4",X(!0)),S(l,"$_reduce_6",function(ae,he,Ee){return Y(h("Node"),"UndecidedTarget").$instance()}),S(l,"$_reduce_7",function(ae,he,Ee){var C,V,Te,Fe,Ue;return Te=ae["$[]"](0),V=this.$expand_negate("+",ae["$[]"](2)),Fe=null==(C=F(V))[0]?q:C[0],Ue=null==C[1]?q:C[1],Y(h("Node"),"BinaryOp").$new(Te,Fe,Ue)}),S(l,"$_reduce_8",function(ae,he,Ee){var C,V,Te,Fe,Ue;return Te=ae["$[]"](0),V=this.$expand_negate("-",ae["$[]"](2)),Fe=null==(C=F(V))[0]?q:C[0],Ue=null==C[1]?q:C[1],Y(h("Node"),"BinaryOp").$new(Te,Fe,Ue)}),S(l,"$_reduce_10",function(ae,he,Ee){var C,V;return C=ae["$[]"](0),V=ae["$[]"](2),Y(h("Node"),"BinaryOp").$new(C,"*",V)}),S(l,"$_reduce_11",function(ae,he,Ee){var C,V;return C=ae["$[]"](0),V=ae["$[]"](2),ae["$[]"](3).$new(C,V)}),S(l,"$_reduce_13",function(ae,he,Ee){return Y(h("Node"),"DivideWithGameSystemDefault")}),S(l,"$_reduce_14",function(ae,he,Ee){return Y(h("Node"),"DivideWithRoundingDown")}),S(l,"$_reduce_15",function(ae,he,Ee){return Y(h("Node"),"DivideWithRoundingUp")}),S(l,"$_reduce_16",function(ae,he,Ee){return Y(h("Node"),"DivideWithRoundingUp")}),S(l,"$_reduce_17",function(ae,he,Ee){return Y(h("Node"),"DivideWithRoundingOff")}),S(l,"$_reduce_18",function(ae,he,Ee){return ae["$[]"](1)}),S(l,"$_reduce_19",function(ae,he,Ee){var C=q;return C=ae["$[]"](1),L(C["$is_a?"](Y(h("Node"),"Negate")))?C.$body():Y(h("Node"),"Negate").$new(C)}),S(l,"$_reduce_21",function(ae,he,Ee){var V=q,$e=q;return V=ae["$[]"](0),$e=ae["$[]"](2),(L(V["$include_dice?"]())||L($e["$include_dice?"]()))&&this.$raise(h("ParseError")),Y(h("Node"),"DiceRoll").$new(V,$e)}),S(l,"$_reduce_22",function(ae,he,Ee){var V=q;return V=ae["$[]"](0),L(V["$include_dice?"]())&&this.$raise(h("ParseError")),Y(h("Node"),"ImplicitSidesDiceRoll").$new(V)}),S(l,"$_reduce_23",function(ae,he,Ee){var Te,V=q,$e=q,Fe=q;return V=ae["$[]"](0),$e=ae["$[]"](2),Te=ae["$[]"](3)["$[]"]("filter"),Fe=ae["$[]"](3)["$[]"]("n_filtering"),K($e,"implicit")&&L($e["$include_dice?"]())&&this.$raise(h("ParseError")),(L(V["$include_dice?"]())||L(Fe["$include_dice?"]()))&&this.$raise(h("ParseError")),Y(h("Node"),"DiceRollWithFilter").$new(V,$e,Fe,Te)}),S(l,"$_reduce_24",function(ae,he,Ee){var V,$e=q;return V=Y(h("Node"),"Number").$new(1),$e=ae["$[]"](1),L($e["$include_dice?"]())&&this.$raise(h("ParseError")),L($e["$instance_of?"](Y(h("Node"),"Number")))&&D($e.$literal(),66)&&this.$raise(h("ParseError")),Y(h("Node"),"DiceRoll").$new(V,$e)}),S(l,"$_reduce_25",function(ae,he,Ee){var V,Te,C=this,$e=q,Fe=q;return V=Y(h("Node"),"Number").$new(1),$e=ae["$[]"](1),Te=ae["$[]"](2)["$[]"]("filter"),Fe=ae["$[]"](2)["$[]"]("n_filtering"),K($e,"implicit")&&L($e["$include_dice?"]())&&C.$raise(h("ParseError")),L(Fe["$include_dice?"]())&&C.$raise(h("ParseError")),L($e["$instance_of?"](Y(h("Node"),"Number")))&&D($e.$literal(),66)&&C.$raise(h("ParseError")),Y(h("Node"),"DiceRollWithFilter").$new(V,$e,Fe,Te)}),S(l,"$_reduce_27",X("implicit")),S(l,"$_reduce_28",function(ae,he,Ee){return ae["$[]"](0)}),S(l,"$_reduce_29",function(ae,he,Ee){return P(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:ae["$[]"](1)})}),S(l,"$_reduce_30",function(ae,he,Ee){return P(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:Y(h("Node"),"Number").$new(1)})}),S(l,"$_reduce_31",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),S(l,"$_reduce_32",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),S(l,"$_reduce_33",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),S(l,"$_reduce_34",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),S(l,"$_reduce_35",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")}),S(l,"$_reduce_36",function(ae,he,Ee){return Y(Y(h("Node"),"DiceRollWithFilter"),"DROP_LOWEST")}),S(l,"$_reduce_39",function(ae,he,Ee){return Y(h("Node"),"Parenthesis").$new(ae["$[]"](1))}),S(l,"$_reduce_40",function(ae,he,Ee){return Y(h("Node"),"Number").$new(ae["$[]"](0))}),S(l,"$_reduce_none",function(ae,he,Ee){return ae["$[]"](0)})},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(f){var X,le,k,A,y,R,z,ie,te,Y,P,T=f.module,ne=f.klass,v=f.const_set,S=f.def,L=f.eqeq,D=f.send,J=f.truthy,j=[],F=f.nil;return X=j,le=P=[T(j[0],"BCDice")].concat(X),k=Y=[T(P[0],"CommonCommand")].concat(le),A=te=[T(Y[0],"AddDice")].concat(k),R=[y=ne(te[0],null,"Randomizer")].concat(A),z=f.$r(R),(ie=y.$$prototype).game_system=ie.rand_source=ie.rand_results=F,y.$attr_reader("rand_results"),v(R[0],"RandResult",z("Struct").$new("sides","value")),S(y,"$initialize",function(ge,B){var O=this;return O.rand_source=ge,O.game_system=B,O.rand_results=[]}),S(y,"$roll",function(ge,B){var l,O=this,_=F;return _=L(B,66)?D(z("Array"),"new",[ge],function c(){var h=null==c.$$s?this:c.$$s;return null==h.rand_source&&(h.rand_source=F),null==h.game_system&&(h.game_system=F),h.rand_source.$roll_d66(h.game_system.$d66_sort_type())},{$$s:O}):L(B,9)&&J(O.game_system["$enabled_d9?"]())?D(z("Array"),"new",[ge],function c(){var h=null==c.$$s?this:c.$$s;return null==h.rand_source&&(h.rand_source=F),h.rand_source.$roll_d9()},{$$s:O}):O.rand_source.$roll_barabara(ge,B),J(O.game_system["$sort_add_dice?"]())&&_["$sort!"](),l=D(_,"map",[],function(h){return null==h&&(h=F),z("RandResult").$new(B,h)}),O.rand_results.$concat(l),_})},Opal.modules["bcdice/common_command/add_dice"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,L=f.top,D=[],J=f.nil;return L.$require("bcdice/normalize"),L.$require("bcdice/common_command/add_dice/parser"),L.$require("bcdice/common_command/add_dice/randomizer"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"AddDice")].concat(Y))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R,z)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(f){var Q,U,R,ge,c,h,d,p,m,O,ie,A,N,T=f.module,ne=f.klass,v=f.ensure_kwargs,S=f.get_kwarg,L=f.def,D=f.truthy,J=f.send,j=f.thrower,F=f.rb_lt,Z=f.rb_plus,X=f.rb_gt,K=f.eqeq,P=f.rb_le,H=f.rb_ge,le=[],q=f.nil;return Q=le,U=N=[T(le[0],"BCDice")].concat(Q),R=A=[T(N[0],"CommonCommand")].concat(U),ge=ie=[T(A[0],"RerollDice")].concat(R),c=O=[T(ie[0],"Node")].concat(ge),d=[h=ne(O[0],null,"Command")].concat(c),p=f.$r(d),(m=h.$$prototype).cmp_op=m.reroll_cmp_op=m.target_number_node=m.reroll_threshold_node=m.notations=m.source=q,L(h,"$initialize",function($){var re,se,De,Ae,fe,Pe,be,xe=this;return $=v($),re=S($,"secret"),se=S($,"notations"),De=S($,"source"),null==(Ae=$.$$smap.cmp_op)&&(Ae=q),null==(fe=$.$$smap.target_number)&&(fe=q),null==(Pe=$.$$smap.reroll_cmp_op)&&(Pe=q),null==(be=$.$$smap.reroll_threshold)&&(be=q),xe.secret=re,xe.notations=se,xe.cmp_op=Ae,xe.target_number_node=fe,xe.reroll_cmp_op=Pe,xe.reroll_threshold_node=be,xe.source=De}),L(h,"$eval",function($,re){try{j("eval_return");var De,Ae,Pe,be,pe,Ce,ae,Ee,fe=this,xe=q,Me=q,he=q,C=q,V=q,$e=q,Te=q,Fe=q;return Pe=$.$round_type(),be=D(xe=fe.cmp_op)?xe:$.$default_cmp_op(),pe=D(xe=D(Me=fe.reroll_cmp_op)?Me:be)?xe:">=",Ce=D(xe=(De=fe.target_number_node)===q||null==De?q:De.$eval(Pe))?xe:$.$default_target_number(),ae=D(xe=D(Me=(Ae=fe.reroll_threshold_node)===q||null==Ae?q:Ae.$eval(Pe))?Me:$.$reroll_dice_reroll_threshold())?xe:Ce,he=p("RerollCondition").$new(pe,ae),Ee=J(fe.notations,"map",[],function(Ze){return null==Ze&&(Ze=q),Ze.$to_dice(Pe)}),D(J(Ee,"all?",[],function(Ze){return null==Ze&&(Ze=q),he["$valid?"](Ze.$sides())}))?(V=(C=fe.$roll(Ee,re,he,$["$sort_barabara_dice?"]())).$flatten(),$e=C.$take(fe.notations.$size()).$flatten().$count(1),Te=D(be)?J(V,"count",[],function(Ze){return null==Ze&&(Ze=q),Ze.$send(be,Ce)}):0,Fe=[fe.$expr(Pe,he,be,Ce),J(C,"map",[],function(Ze){return null==Ze&&(Ze=q),Ze.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+Te,$.$grich_text($e,V.$size(),Te)].$compact(),fe.$result_with_text(Fe.$join(" \uff1e "))):fe.$result_with_text(fe.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(Ue){if(Ue===f.t_eval_return)return Ue.$v;throw Ue}}),h.$private(),L(h,"$roll",function($,re,se,De){var Ae=q,fe=q,Pe=q,be=q,xe=q,pe=q;for(Ae=[],fe=0;D(D(Pe=$["$empty?"]()["$!"]())?F(fe,p("REROLL_LIMIT")):Pe);)be=$.$shift(),fe=Z(fe,1),xe=be.$roll(re),D(De)&&xe["$sort!"](),Ae.$push(xe),pe=J(xe,"count",[],function(Ce){return null==Ce&&(Ce=q),se["$reroll?"](Ce)}),D(X(pe,0))&&$.$push(p("Dice").$new(pe,be.$sides()));return Ae}),L(h,"$expr",function($,re,se,De){var fe,Pe,be;return fe=J(this.notations,"map",[],function(pe){return null==pe&&(pe=q),pe.$to_dice($)}).$join("+"),Pe=K(re.$cmp_op(),se)?"":p("Format").$comparison_operator(re.$cmp_op()),be=p("Format").$comparison_operator(se),"("+fe+"["+Pe+re.$threshold()+"]"+be+De+")"}),L(h,"$result_with_text",function($){return J(p("Result").$new(),"tap",[],function se(De){var Ae,fe=null==se.$$s?this:se.$$s;return null==fe.secret&&(fe.secret=q),null==De&&(De=q),De["$secret="](fe.secret),J(De,"text=",Ae=[$]),Ae[Ae.length-1]},{$$s:this})}),function(_,l){var c=ne(_,null,"RerollCondition"),h=c.$$prototype;h.threshold=h.cmp_op=q,c.$attr_reader("cmp_op"),c.$attr_reader("threshold"),L(c,"$initialize",function(p,m){return this.cmp_op=p,this.threshold=m}),L(c,"$valid?",function(p){var m=this;if(!D(m.threshold))return!1;switch(m.cmp_op){case"<=":return F(m.threshold,p);case"<":return P(m.threshold,p);case">=":return X(m.threshold,1);case">":return H(m.threshold,1);case"!=":return f.Range.$new(1,p,!1)["$include?"](m.threshold);default:return!0}}),L(c,"$reroll?",function(p){return p.$send(this.cmp_op,this.threshold)})}(O[0]),function(_,l,c){var h=ne(_,null,"Notation"),d=[h].concat(c),p=f.$r(d),m=h.$$prototype;m.times=m.sides=q,L(h,"$initialize",function($,re){return this.times=$,this.sides=re}),L(h,"$to_dice",function($){try{var De,Ae;return j("eval_return"),De=this.times.$eval($),Ae=this.sides.$eval($),p("Dice").$new(De,Ae)}catch(fe){if(fe===f.t_eval_return)return fe.$v;throw fe}})}(O[0],0,O),function(_,l){var c=ne(_,null,"Dice");return c.$attr_reader("times","sides"),L(c,"$initialize",function(d,p){return this.times=d,this.sides=p}),L(c,"$roll",function(d){return d.$roll_barabara(this.$times(),this.$sides())}),L(c,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(O[0])},Opal.modules["bcdice/arithmetic/node"]=function(f){var k,I,z,_,l,M,ge,y,te,T=f.module,ne=f.klass,v=f.def,S=f.thrower,L=f.return_ivar,D=f.send2,J=f.find_super,j=f.eqeq,F=f.const_set,Z=f.eqeqeq,X=f.rb_divide,K=f.truthy,P=f.assign_ivar,H=f.alias,le=[],q=f.nil,Y=f.$$$;return k=le,I=te=[T(le[0],"BCDice")].concat(k),z=y=[T(te[0],"Arithmetic")].concat(I),M=[T(y[0],"Node")].concat(z),ge=f.$r(M),(l=(_=ne(M[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=q,v(_,"$initialize",function(h,d,p){var m=this;return m.lhs=h,m.op=d,m.rhs=p}),v(_,"$eval",function(h){try{S("eval_return");var x,p=this,m=q;return m=p.lhs.$eval(h),x=p.rhs.$eval(h),m.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(_,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(_,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(_,"$op_for_s_exp",L("op")),function(B,O,_){var l=ne(B,O,"DivideBase"),c=[l].concat(_),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=q,v(l,"$initialize",function p(m,x){return p.$$p=null,D(this,J(this,"initialize",p,!1,!0),"initialize",[m,"/",x],null)}),v(l,"$eval",function(m){try{S("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),j(se,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),v(l,"$output",function p(){var m=p.$$p||q,x=this;return p.$$p=null,""+D(x,J(x,"output",p,!1,!0),"output",[],m)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(m,x,$){return this.$raise(h("NotImplementedError"))})}(M[0],ge("BinaryOp"),M),function(B,O,_){var l=ne(B,O,"DivideWithGameSystemDefault"),c=[l].concat(_),h=f.$r(c);F(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,m,x){var $,re=q;return Z(Y(h("RoundType"),"CEIL"),$=x)?X(p.$to_f(),m).$ceil():Z(Y(h("RoundType"),"ROUND"),$)?(re=X(p.$to_f(),m),K(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):X(p,m).$floor()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithCeil"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d.$to_f(),p).$ceil()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithRound"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,m){var x=q;return x=X(d.$to_f(),p),K(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithFloor"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d,p).$floor()})}(M[0],ge("DivideBase"),M),function(B,O){var _=ne(B,null,"Negative");_.$$prototype.body=q,v(_,"$initialize",P("body")),v(_,"$eval",function(h){try{return S("eval_return"),this.body.$eval(h)["$-@"]()}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"-"+this.body.$output()}),v(_,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Parenthesis");_.$$prototype.expr=q,v(_,"$initialize",P("expr")),v(_,"$eval",function(h){try{return S("eval_return"),this.expr.$eval(h)}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"("+this.expr.$output()+")"}),v(_,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Number");return _.$$prototype.value=q,v(_,"$initialize",P("value")),v(_,"$eval",L("value")),v(_,"$output",function(){return this.value.$to_s()}),H(_,"s_exp","output")}(M[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(f){var q,N,A,ge,l,c,h,d,p,m,x,$,re,Ae,B,O,_,R,z,U,Q,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.hash2,j=f.return_val,F=f.to_ary,Z=f.truthy,X=f.top,K=[],P=f.nil,H=f.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/common_command/lexer"),X.$require("bcdice/common_command/reroll_dice/node"),X.$require("bcdice/arithmetic/node"),q=K,N=Q=[T(K[0],"BCDice")].concat(q),A=U=[T(Q[0],"CommonCommand")].concat(N),R=[T(U[0],"BarabaraDice")].concat(A),z=f.$r(R),ge=R,O=[B=ne(R[0],H(z("Racc"),"Parser"),"Parser")].concat(ge),_=f.$r(O),B.$$prototype.lexer=P,v(B,"$parse",function(pe){return this.$new().$parse(pe)}),S(B,"$parse",function(pe){try{return this.lexer=_("Lexer").$new(pe),this.$do_parse()}catch(Ce){if(!f.rescue(Ce,[_("ParseError")]))throw Ce;try{return P}finally{f.pop_exception()}}}),B.$private(),S(B,"$next_token",function(){return this.lexer.$next_token()}),l=f.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),c=f.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),h=f.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),d=f.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),p=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],m=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],x=[P,1,4,8,11,-5,0,-2,-16,-13,-17],$=[P,P,P,P,P,P,P,20,16,17,P],re=f.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),Ae=L(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),D(O[0],"Racc_arg",[l,c,d,h,p,m,$,x,23,re,Ae,40,25,!0]),D(O[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),D(O[0],"Racc_debug_parser",!1),S(B,"$_reduce_1",function(pe,Me,Ce){return H(_("Node"),"Command").$new(J(["secret","notations","cmp_op","target_number"],{secret:pe["$[]"](0),notations:pe["$[]"](1),cmp_op:pe["$[]"](2)["$[]"]("cmp_op"),target_number:pe["$[]"](2)["$[]"]("target")}))}),S(B,"$_reduce_2",j(!1)),S(B,"$_reduce_3",j(!0)),S(B,"$_reduce_4",function(pe,Me,Ce){return J([],{})}),S(B,"$_reduce_5",function(pe,Me,Ce){var ae,C,V;return V=null==(ae=F(pe))[1]?P:ae[1],Z(C=null==ae[0]?P:ae[0])||this.$raise(_("ParseError")),J(["cmp_op","target"],{cmp_op:C,target:V})}),S(B,"$_reduce_6",function(pe,Me,Ce){var ae=P;return(ae=pe["$[]"](0)).$push(pe["$[]"](2)),ae}),S(B,"$_reduce_7",function(pe,Me,Ce){return[pe["$[]"](0)]}),S(B,"$_reduce_8",function(pe,Me,Ce){var ae,he;return ae=pe["$[]"](0),he=pe["$[]"](2),H(_("Node"),"Notation").$new(ae,he)}),S(B,"$_reduce_9",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"+",pe["$[]"](2))}),S(B,"$_reduce_10",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"-",pe["$[]"](2))}),S(B,"$_reduce_12",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"*",pe["$[]"](2))}),S(B,"$_reduce_13",function(pe,Me,Ce){return pe["$[]"](3).$new(pe["$[]"](0),pe["$[]"](2))}),S(B,"$_reduce_15",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(B,"$_reduce_16",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_17",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_18",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithRound")}),S(B,"$_reduce_19",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithFloor")}),S(B,"$_reduce_20",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_21",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Negative").$new(pe["$[]"](1))}),S(B,"$_reduce_23",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_24",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Number").$new(pe["$[]"](0))}),S(B,"$_reduce_none",function(pe,Me,Ce){return pe["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,D=[],J=f.nil;return f.top.$require("bcdice/common_command/barabara_dice/parser"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"BarabaraDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R,z)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/result"]=function(f){var le,Q,q,Z,K,ne=f.klass,v=f.send,S=f.def,L=f.return_val,D=f.return_ivar,J=[],j=f.nil;return Z=J,le=K=[(0,f.module)(J[0],"BCDice")].concat(Z),[q=ne(K[0],null,"Result")].concat(le),S(Q=f.get_singleton_class(q),"$success",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),v(A,"success=",y=[!0]),y[y.length-1]})}),S(Q,"$failure",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),v(A,"failure=",y=[!0]),y[y.length-1]})}),S(Q,"$critical",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),A["$critical="](!0),v(A,"success=",y=[!0]),y[y.length-1]})}),S(Q,"$fumble",function(te){return v(this.$new(),"tap",[],function(A){var y;return null==A&&(A=j),A["$text="](te),A["$fumble="](!0),v(A,"failure=",y=[!0]),y[y.length-1]})}),S(Q,"$nothing",L("nothing")),S(q,"$initialize",function(k){var N=this;return null==k&&(k=j),N.text=k,N.rands=j,N.detailed_rands=j,N.secret=!1,N.success=!1,N.failure=!1,N.critical=!1,N.fumble=!1},-1),q.$attr_accessor("text","rands","detailed_rands"),q.$attr_writer("secret","success","failure","critical","fumble"),S(q,"$secret?",D("secret")),S(q,"$success?",D("success")),S(q,"$failure?",D("failure")),S(q,"$critical?",D("critical")),S(q,"$fumble?",D("fumble")),S(q,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()})},Opal.modules["bcdice/common_command/tally_dice/node"]=function(f){var k,I,z,B,h,d,p,m,_,M,y,te,T=f.module,ne=f.klass,v=f.const_set,S=f.ensure_kwargs,L=f.get_kwarg,D=f.def,J=f.truthy,j=f.rb_gt,F=f.send,Z=f.not,X=f.eqeq,K=f.hash2,P=f.thrower,H=f.alias,q=[],Y=f.nil;return f.top.$require("bcdice/result"),k=q,I=te=[T(q[0],"BCDice")].concat(k),z=y=[T(te[0],"CommonCommand")].concat(I),B=M=[T(y[0],"TallyDice")].concat(z),h=_=[T(M[0],"Node")].concat(B),p=[d=ne(_[0],null,"Command")].concat(h),m=f.$r(p),d.$$prototype.notation=Y,v(p[0],"MAX_SIDES",20),D(d,"$initialize",function(re){var se,De;return re=S(re),se=L(re,"secret"),De=L(re,"notation"),this.secret=se,this.notation=De}),D(d,"$eval",function(re,se){var Ae=Y,fe=Y,Pe=Y,be=Y,xe=Y,pe=Y;return Ae=this.notation.$to_dice(re.$round_type()),J(Ae["$valid?"]())?J(j(Ae.$sides(),m("MAX_SIDES")))?m("Result").$new("("+Ae+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+m("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(fe=Ae.$roll(se),Pe=(J(re["$sort_barabara_dice?"]())?fe.$sort():fe).$join(","),be=F(F(fe,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),xe=F(f.Range.$new(1,Ae.$sides(),!1),"map",[],function(Ce){var ae;return null==Ce&&(Ce=Y),ae=be.$fetch(Ce,0),X(ae,0)&&Z(Ae["$show_zeros?"]())?Y:"["+Ce+"]\xd7"+be.$fetch(Ce,0)}),pe=["("+Ae+")",Pe,xe.$compact().$join(", ")].$compact(),F(m("Result").$new(),"tap",[],function Me(Ce){var ae,he=null==Me.$$s?this:Me.$$s;return null==he.secret&&(he.secret=Y),null==Ce&&(Ce=Y),Ce["$secret="](he.secret),ae=[pe.$join(" \uff1e ")],F(Ce,"text=",ae),ae[ae.length-1]},{$$s:this})):Y}),function(l,c,h){var d=ne(l,null,"Notation"),p=[d].concat(h),m=f.$r(p),x=d.$$prototype;x.times=x.sides=x.show_zeros=Y,d.$attr_reader("times"),d.$attr_reader("sides"),d.$attr_reader("show_zeros"),D(d,"$initialize",function(re){var se,De,Ae;return re=S(re),se=L(re,"times"),De=L(re,"sides"),Ae=L(re,"show_zeros"),this.times=se,this.sides=De,this.show_zeros=Ae}),D(d,"$to_dice",function(re){try{var Ae,fe;return P("eval_return"),Ae=this.times.$eval(re),fe=this.sides.$eval(re),m("Dice").$new(K(["times","sides","show_zeros"],{times:Ae,sides:fe,show_zeros:this.show_zeros}))}catch(Pe){if(Pe===f.t_eval_return)return Pe.$v;throw Pe}})}(_[0],0,_),function(l,c){var h=ne(l,null,"Dice"),d=h.$$prototype;return d.times=d.sides=d.show_zeros=Y,h.$attr_reader("times"),h.$attr_reader("sides"),h.$attr_reader("show_zeros"),H(h,"show_zeros?","show_zeros"),D(h,"$initialize",function(m){var x,$,re;return m=S(m),x=L(m,"times"),$=L(m,"sides"),re=L(m,"show_zeros"),this.times=x,this.sides=$,this.show_zeros=re}),D(h,"$valid?",function(){var x;return J(x=j(this.times,0))?j(this.sides,0):x}),D(h,"$roll",function(m){return m.$roll_barabara(this.times,this.sides)}),D(h,"$to_s",function(){var x,m=this;return x=J(m.show_zeros)?"Z":"Y",m.times+"T"+x+m.sides})}(_[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(f){var H,Q,U,ie,O,_,l,c,h,d,p,m,x,se,M,ge,B,A,y,N,q,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.hash2,j=f.return_val,F=f.top,Z=[],X=f.nil,K=f.$$$;return F.$require("racc/parser.rb"),F.$require("bcdice/common_command/lexer"),F.$require("bcdice/common_command/tally_dice/node"),F.$require("bcdice/arithmetic/node"),H=Z,Q=q=[T(Z[0],"BCDice")].concat(H),U=N=[T(q[0],"CommonCommand")].concat(Q),A=[T(N[0],"TallyDice")].concat(U),y=f.$r(A),ie=A,ge=[M=ne(A[0],K(y("Racc"),"Parser"),"Parser")].concat(ie),B=f.$r(ge),M.$$prototype.lexer=X,v(M,"$parse",function(be){return this.$new().$parse(be)}),S(M,"$parse",function(be){try{return this.lexer=B("Lexer").$new(be),this.$do_parse()}catch(pe){if(!f.rescue(pe,[B("ParseError")]))throw pe;try{return X}finally{f.pop_exception()}}}),M.$private(),S(M,"$next_token",function(){return this.lexer.$next_token()}),O=f.large_array_unpack("8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10"),_=f.large_array_unpack("2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6"),l=f.large_array_unpack("2,23,-2,,30,,47,-1,,,-2,-7,27,,4,6,,5,,,20,22,,27,34,,,,30,34,,19,,,,,"),c=f.large_array_unpack("-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17"),h=[6,25,26,12,1,2,5,17,11,32,30,31,X,X,X,27,28,29],d=[4,8,8,7,1,2,3,5,6,9,8,8,X,X,X,4,7,7],p=[X,4,5,4,-2,-3,1,-4,-13,-22],m=[X,X,X,X,16,X,X,X,13,X],x=f.large_array_unpack("0,0,racc_error,2,18,_reduce_1,0,19,_reduce_2,1,19,_reduce_3,4,20,_reduce_4,1,22,_reduce_5,1,22,_reduce_6,3,23,_reduce_7,3,23,_reduce_8,1,23,_reduce_none,3,24,_reduce_10,4,24,_reduce_11,1,24,_reduce_none,0,26,_reduce_13,1,26,_reduce_14,1,26,_reduce_15,1,26,_reduce_16,1,26,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,1,25,_reduce_none,3,21,_reduce_21,1,21,_reduce_22"),se=L(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),D(ge[0],"Racc_arg",[O,_,c,l,h,d,m,p,17,x,se,37,23,!0]),D(ge[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),D(ge[0],"Racc_debug_parser",!1),S(M,"$_reduce_1",function(be,xe,pe){return K(B("Node"),"Command").$new(J(["secret","notation"],{secret:be["$[]"](0),notation:be["$[]"](1)}))}),S(M,"$_reduce_2",j(!1)),S(M,"$_reduce_3",j(!0)),S(M,"$_reduce_4",function(be,xe,pe){return K(B("Node"),"Notation").$new(J(["times","sides","show_zeros"],{times:be["$[]"](0),sides:be["$[]"](3),show_zeros:be["$[]"](2)}))}),S(M,"$_reduce_5",j(!1)),S(M,"$_reduce_6",j(!0)),S(M,"$_reduce_7",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"+",be["$[]"](2))}),S(M,"$_reduce_8",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"-",be["$[]"](2))}),S(M,"$_reduce_10",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"*",be["$[]"](2))}),S(M,"$_reduce_11",function(be,xe,pe){return be["$[]"](3).$new(be["$[]"](0),be["$[]"](2))}),S(M,"$_reduce_13",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(M,"$_reduce_14",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithCeil")}),S(M,"$_reduce_15",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithCeil")}),S(M,"$_reduce_16",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithRound")}),S(M,"$_reduce_17",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithFloor")}),S(M,"$_reduce_18",function(be,xe,pe){return be["$[]"](1)}),S(M,"$_reduce_19",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"Negative").$new(be["$[]"](1))}),S(M,"$_reduce_21",function(be,xe,pe){return be["$[]"](1)}),S(M,"$_reduce_22",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"Number").$new(be["$[]"](0))}),S(M,"$_reduce_none",function(be,xe,pe){return be["$[]"](0)})},Opal.modules["bcdice/common_command/tally_dice"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,D=[],J=f.nil;return f.top.$require("bcdice/common_command/tally_dice/parser"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"TallyDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R,z)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/calc/node"]=function(f){var H,Q,U,R,B,O,_,l,ie,A,N,q,T=f.module,ne=f.klass,v=f.ensure_kwargs,S=f.get_kwarg,L=f.def,D=f.truthy,J=f.send,j=f.thrower,Z=[],X=f.nil,K=f.$$$;return f.top.$require("bcdice/arithmetic/node"),H=Z,Q=q=[T(Z[0],"BCDice")].concat(H),U=N=[T(q[0],"CommonCommand")].concat(Q),R=A=[T(N[0],"Calc")].concat(U),B=ie=[T(A[0],"Node")].concat(R),_=[O=ne(ie[0],null,"Command")].concat(B),l=f.$r(_),O.$$prototype.expr=X,L(O,"$initialize",function(d){var p,m;return d=v(d),p=S(d,"secret"),m=S(d,"expr"),this.secret=p,this.expr=m}),L(O,"$eval",function(d){try{j("eval_return");var x,$,m=this;return x=function(){try{return m.expr.$eval(d).$to_i()}catch(re){if(!f.rescue(re,[l("ZeroDivisionError")]))throw re;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{f.pop_exception()}}}(),$=D(m.expr["$is_a?"](K(K(l("Arithmetic"),"Node"),"Parenthesis")))?m.expr.$output():"("+m.expr.$output()+")",J(l("Result").$new(),"tap",[],function re(se){var De,Ae=null==re.$$s?this:re.$$s;return null==Ae.secret&&(Ae.secret=X),null==se&&(se=X),se["$secret="](Ae.secret),J(se,"text=",De=["c"+$+" \uff1e "+x]),De[De.length-1]},{$$s:m})}catch(re){if(re===f.t_eval_return)return re.$v;throw re}})},Opal.modules["bcdice/common_command/calc/parser"]=function(f){var H,Q,U,ie,O,_,l,c,h,d,p,m,x,se,M,ge,B,A,y,N,q,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.hash2,j=f.return_val,F=f.top,Z=[],X=f.nil,K=f.$$$;return F.$require("racc/parser.rb"),F.$require("bcdice/common_command/lexer"),F.$require("bcdice/common_command/calc/node"),F.$require("bcdice/arithmetic/node"),H=Z,Q=q=[T(Z[0],"BCDice")].concat(H),U=N=[T(q[0],"CommonCommand")].concat(Q),A=[T(N[0],"Calc")].concat(U),y=f.$r(A),ie=A,ge=[M=ne(A[0],K(y("Racc"),"Parser"),"Parser")].concat(ie),B=f.$r(ge),M.$$prototype.lexer=X,v(M,"$parse",function(be){return this.$new().$parse(be)}),S(M,"$parse",function(be){try{return this.lexer=B("Lexer").$new(be),this.$do_parse()}catch(pe){if(!f.rescue(pe,[B("ParseError")]))throw pe;try{return X}finally{f.pop_exception()}}}),M.$private(),S(M,"$next_token",function(){return this.lexer.$next_token()}),O=f.large_array_unpack("14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,,10,11,10,11,13,,13,15,16,,,,26,30,28,29,31"),_=f.large_array_unpack("5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,,17,17,18,18,17,,18,21,21,,,,21,25,25,25,25"),l=[-6,5,11,X,27,-2,X,-5,4,X,0,9,X,11,X,20,22,31,33,X,X,38,15,26,X,49,X,X,X,X,X,X],c=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],h=[7,1,19,20,22,23,2,27,21,24,25],d=[3,1,5,5,4,4,2,6,3,5,5],p=[X,1,6,-5,-11,-8,-18,X],m=[X,X,X,X,8,9,X,12],x=f.large_array_unpack("0,0,racc_error,3,15,_reduce_1,0,16,_reduce_2,1,16,_reduce_3,3,17,_reduce_4,3,17,_reduce_5,1,17,_reduce_none,3,18,_reduce_7,4,18,_reduce_8,1,18,_reduce_none,0,20,_reduce_10,1,20,_reduce_11,1,20,_reduce_12,1,20,_reduce_13,1,20,_reduce_14,2,19,_reduce_15,2,19,_reduce_16,1,19,_reduce_none,3,21,_reduce_18,1,21,_reduce_19"),se=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),D(ge[0],"Racc_arg",[O,_,c,l,h,d,m,p,14,x,se,32,20,!0]),D(ge[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),D(ge[0],"Racc_debug_parser",!1),S(M,"$_reduce_1",function(be,xe,pe){return K(B("Node"),"Command").$new(J(["secret","expr"],{secret:be["$[]"](0),expr:be["$[]"](2)}))}),S(M,"$_reduce_2",j(!1)),S(M,"$_reduce_3",j(!0)),S(M,"$_reduce_4",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"+",be["$[]"](2))}),S(M,"$_reduce_5",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"-",be["$[]"](2))}),S(M,"$_reduce_7",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"BinaryOp").$new(be["$[]"](0),"*",be["$[]"](2))}),S(M,"$_reduce_8",function(be,xe,pe){return be["$[]"](3).$new(be["$[]"](0),be["$[]"](2))}),S(M,"$_reduce_10",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(M,"$_reduce_11",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithCeil")}),S(M,"$_reduce_12",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithCeil")}),S(M,"$_reduce_13",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithRound")}),S(M,"$_reduce_14",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"DivideWithFloor")}),S(M,"$_reduce_15",function(be,xe,pe){return be["$[]"](1)}),S(M,"$_reduce_16",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"Negative").$new(be["$[]"](1))}),S(M,"$_reduce_18",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"Parenthesis").$new(be["$[]"](1))}),S(M,"$_reduce_19",function(be,xe,pe){return K(K(B("Arithmetic"),"Node"),"Number").$new(be["$[]"](0))}),S(M,"$_reduce_none",function(be,xe,pe){return be["$[]"](0)})},Opal.modules["bcdice/common_command/calc"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,D=[],J=f.nil;return f.top.$require("bcdice/common_command/calc/parser"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"Calc")].concat(Y))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R.$round_type())}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/choice"]=function(f){var N,A,M,c,d,ge,B,O,_,R,U,T=f.module,ne=f.klass,v=f.const_set,S=f.hash2,L=f.def,D=f.truthy,J=f.eqeq,j=f.eqeqeq,F=f.send,Z=f.rb_lt,X=f.thrower,K=f.rb_gt,P=f.ensure_kwargs,H=f.get_kwarg,q=[],Y=f.nil,Q=f.$$$;return f.top.$require("strscan"),N=q,A=U=[T(q[0],"BCDice")].concat(N),M=R=[T(U[0],"CommonCommand")].concat(A),B=[ge=ne(R[0],null,"Choice")].concat(M),O=f.$r(B),(_=ge.$$prototype).items=_.takes=_.block_delimiter=Y,v(B[0],"PREFIX_PATTERN",/choice/.$freeze()),c=B,v((d=[T(B[0],"BlockDelimiter")].concat(c))[0],"BRACKET","bracket"),v(d[0],"PAREN","paren"),v(d[0],"SPACE","space"),v(B[0],"DELIMITER",S(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),v(B[0],"DELIMITER_CHAR",S(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),v(B[0],"TERMINATION",S(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),v(B[0],"SUFFIX",S(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(l,c){var h=[l].concat(c),d=f.$r(h);L(l,"$eval",function(m,x,$){var re;return(re=this.$parse(m))===Y||null==re?Y:re.$roll($)}),l.$private(),L(l,"$parse",function(m){try{var $,De,Pe,be,xe,x=X("return"),se=Y,Ae=Y,fe=Y,pe=Y,Me=Y,Ce=Y;if((se=d("StringScanner").$new(m)).$skip(/\s+/),De=se.$scan(/S/i)["$nil?"]()["$!"](),!D(se.$scan(/choice/i))||(Ae=D(fe=($=se.$scan(/\d+/))===Y||null==$?Y:$.$to_i())?fe:1,J(Ae,0)))return Y;for(Pe=j("[",fe=se.$scan(/\(|\[|\s+/))?Q(d("BlockDelimiter"),"BRACKET"):j("(",fe)?Q(d("BlockDelimiter"),"PAREN"):j(d("String"),fe)?Q(d("BlockDelimiter"),"SPACE"):void x.$throw(),be=d("DELIMITER")["$[]"](Pe),xe=d("TERMINATION")["$[]"](Pe),pe=[];D(Me=se.$scan_until(be));)pe.$push(Me.$delete_suffix(","));return Ce=se.$scan_until(xe),!D(Ce)||(pe.$push(Ce.$delete_suffix(d("SUFFIX")["$[]"](Pe))),pe=F(F(pe,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),J(pe.$size(),1)&&(pe=this.$parse_multi_item_shorthand(pe.$first())),D(pe["$empty?"]())||D(Z(pe.$size(),Ae)))?Y:this.$new(S(["secret","block_delimiter","takes","items"],{secret:De,block_delimiter:Pe,takes:Ae,items:pe}))}catch(ae){if(ae===x)return ae.$v;throw ae}}),L(l,"$parse_multi_item_shorthand",function(m){var $,re;return D($=D(re=this.$parse_multi_nums_shorthand(m))?re:this.$parse_multi_chars_shorthand(m))?$:[]}),L(l,"$parse_multi_nums_shorthand",function(m){var x=Y,$=Y,re=Y;return x=/^(\d+)-(\d+)$/.$match(m),!D(x)||($=x["$[]"](1).$to_i(),re=x["$[]"](2).$to_i(),D(K($,re)))?Y:$.$upto(re).$to_a()}),L(l,"$parse_multi_chars_shorthand",function(m){var $,x=Y,re=Y,se=Y;return x=D($=/^([a-z])-([a-z])$/.$match(m))?$:/^([A-Z])-([A-Z])$/.$match(m),!D(x)||(re=x["$[]"](1),se=x["$[]"](2),D(K(re,se)))?Y:re.$upto(se).$to_a()})}(f.get_singleton_class(ge),B),L(ge,"$initialize",function(c){var h,d,p,m,x=this;return c=P(c),h=H(c,"secret"),d=H(c,"block_delimiter"),p=H(c,"takes"),m=H(c,"items"),x.secret=h,x.block_delimiter=d,x.takes=p,x.items=m}),L(ge,"$roll",function(c){var h=this,d=Y,p=Y;return D(K(h.items.$size(),100))?O("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(d=h.items.$dup(),p=[],F(h.takes,"times",[],function(){var x;return x=c.$roll_index(d.$size()),p["$<<"](d.$delete_at(x))}),F(O("Result").$new(),"tap",[],function m(x){var $,se,re=null==m.$$s?this:m.$$s;return null==re.block_delimiter&&(re.block_delimiter=Y),null==re.secret&&(re.secret=Y),null==x&&(x=Y),se=p.$join(O("DELIMITER_CHAR")["$[]"](re.block_delimiter)),x["$secret="](re.secret),$=["("+re.$expr()+") \uff1e "+se],F(x,"text=",$),$[$.length-1]},{$$s:h}))}),L(ge,"$expr",function(){var h,d,c=this;return h=J(c.takes,1)?Y:c.takes,j(Q(O("BlockDelimiter"),"SPACE"),d=c.block_delimiter)?"choice"+h+" "+c.items.$join(" "):j(Q(O("BlockDelimiter"),"BRACKET"),d)?"choice"+h+"["+c.items.$join(",")+"]":j(Q(O("BlockDelimiter"),"PAREN"),d)?"choice"+h+"("+c.items.$join(",")+")":Y})},Opal.modules["bcdice/common_command/d66_dice"]=function(f){var Q,U,z,O,l,c,ie,M,ge,A,N,T=f.module,ne=f.klass,v=f.const_set,S=f.thrower,L=f.def,D=f.truthy,J=f.hash2,j=f.ensure_kwargs,F=f.get_kwarg,Z=f.send,X=f.eqeqeq,K=f.rb_plus,P=f.rb_times,H=[],le=f.nil,q=f.$$$;return Q=H,U=N=[T(H[0],"BCDice")].concat(Q),z=A=[T(N[0],"CommonCommand")].concat(U),M=[ie=ne(A[0],null,"D66Dice")].concat(z),ge=f.$r(M),ie.$$prototype.sort_type=le,v(M[0],"PREFIX_PATTERN",/D66/.$freeze()),l=[O=f.get_singleton_class(ie)].concat(M),c=f.$r(l),L(O,"$eval",function(d,p,m){try{var $;return S("eval_return"),($=this.$parse(d,p))===le||null==$?le:$.$eval(m)}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),O.$private(),L(O,"$parse",function(d,p){var x=le,$=le;return d=d.$split(" ",2).$first(),x=/^(S)?D66([ANSD])?$/i.$match(d.$upcase()),D(x)?this.$new(J(["secret","sort_type","suffix"],{secret:x["$[]"](1)["$nil?"]()["$!"](),sort_type:D($=this.$sort_type_from_suffix(x["$[]"](2)))?$:p.$d66_sort_type(),suffix:x["$[]"](2)})):le}),L(O,"$sort_type_from_suffix",function(d){switch(d){case"A":case"S":return q(c("D66SortType"),"ASC");case"D":return q(c("D66SortType"),"DESC");case"N":return q(c("D66SortType"),"NO_SORT");default:return le}}),L(ie,"$initialize",function(_){var l,c,h,d=this;return _=j(_),l=F(_,"secret"),c=F(_,"sort_type"),h=F(_,"suffix"),d.secret=l,d.sort_type=c,d.suffix=h}),L(ie,"$eval",function(_){var c;return c=this.$roll(_),Z(ge("Result").$new(),"tap",[],function h(d){var p,m=null==h.$$s?this:h.$$s;return null==m.secret&&(m.secret=le),null==m.suffix&&(m.suffix=le),null==d&&(d=le),d["$secret="](m.secret),Z(d,"text=",p=["(D66"+m.suffix+") \uff1e "+c]),p[p.length-1]},{$$s:this})}),ie.$private(),L(ie,"$roll",function(_){var h,c=le;return c=Z(ge("Array"),"new",[2],function(){return _.$roll_once(6)}),X(q(ge("D66SortType"),"ASC"),h=this.sort_type)?c["$sort!"]():X(q(ge("D66SortType"),"DESC"),h)&&c["$sort!"]()["$reverse!"](),K(P(c["$[]"](0),10),c["$[]"](1))})},Opal.modules["bcdice/common_command/repeat"]=function(f){var Y,te,R,B,_,l,z,ie,M,ge,I,k,T=f.module,ne=f.klass,v=f.const_set,S=f.def,L=f.truthy,D=f.hash2,J=f.ensure_kwargs,j=f.get_kwarg,F=f.send,Z=f.eqeq,X=f.thrower,K=f.rb_lt,H=[],le=f.nil;return f.top.$require("strscan"),Y=H,te=k=[T(H[0],"BCDice")].concat(Y),R=I=[T(k[0],"CommonCommand")].concat(te),ie=[z=ne(I[0],null,"Repeat")].concat(R),M=f.$r(ie),(ge=z.$$prototype).times=ge.trailer=ge.secret=le,v(ie[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),v(ie[0],"REPEAT_LIMIT",100),_=[B=f.get_singleton_class(z)].concat(ie),l=f.$r(_),S(B,"$eval",function(h,d,p){var m;return(m=this.$parse(h))===le||null==m?le:m.$roll(d,p)}),B.$private(),S(B,"$parse",function(h){var d,x,m=le,$=le,re=le,se=le,De=le;return x=(m=l("StringScanner").$new(h)).$scan(/s/i)["$nil?"]()["$!"](),$=m.$scan(/repeat|rep|x/i),re=(d=m.$scan(/\d+/))===le||null==d?le:d.$to_i(),se=m.$scan(/\s+/),L($["$nil?"]())||L(re["$nil?"]())||L(se["$nil?"]())||(De=m.$post_match(),L(De["$nil?"]())||L(De["$empty?"]()))?le:this.$new(D(["secret","times","trailer"],{secret:x,times:re,trailer:De}))}),S(z,"$initialize",function(O){var _,l,c,h=this;return O=J(O),_=j(O,"secret"),l=j(O,"times"),c=j(O,"trailer"),h.secret=_,h.times=l,h.trailer=c}),S(z,"$roll",function(O,_){try{X("eval_return");var h,c=this,d=le,p=le,m=le,x=le;return h=c.$validate(),L(h)?h:(d=F(M("Array"),"new",[c.times],function $(){var re=null==$.$$s?this:$.$$s,se=le;return null==re.trailer&&(re.trailer=le),(se=O.$class().$new(re.trailer))["$randomizer="](_),se.$eval()},{$$s:c}),Z(F(d,"count",[],function(re){return null==re&&(re=le),re["$=="](le)}),c.times)?c.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+c.trailer+")"):(p=F(d.$map(),"with_index",[1],function(re,se){return null==re&&(re=le),null==se&&(se=le),"#"+se+"\n"+re.$text()}).$join("\n\n"),m=L(x=c.secret)?x:F(d,"any?",[],"secret?".$to_proc()),F(M("Result").$new(),"tap",[],function(re){var se;return null==re&&(re=le),re["$secret="](m),F(re,"text=",se=[p]),se[se.length-1]})))}catch($){if($===f.t_eval_return)return $.$v;throw $}}),z.$private(),S(z,"$validate",function(){var O=this;return L(/^(repeat|rep|x)\d+/["$match?"](O.trailer))?O.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):L(K(O.times,1))||L(K(M("REPEAT_LIMIT"),O.times))?O.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+M("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):le}),S(z,"$result_with_text",function(O){return F(M("Result").$new(),"tap",[],function l(c){var h,d=null==l.$$s?this:l.$$s;return null==d.secret&&(d.secret=le),null==c&&(c=le),c["$secret="](d.secret),F(c,"text=",h=[O]),h[h.length-1]},{$$s:this})})},Opal.modules["bcdice/format"]=function(f){var Z,H,le,q,Y,K,T=f.module,ne=f.eqeqeq,v=f.def,S=f.truthy,L=f.eqeq,D=f.rb_gt,J=[],j=f.nil;return Z=J,H=K=[T(J[0],"BCDice")].concat(Z),q=[le=T(K[0],"Format")].concat(H),Y=f.$r(q),le.$module_function(),v(le,"$comparison_operator",function(k){var N;return ne("==",N=k)?"=":ne("!=",N)?"<>":ne(Y("Symbol"),N)?k.$to_s():j}),v(le,"$modifier",function(k){return S(k["$nil?"]())?j:L(k,0)?"":S(D(k,0))?"+"+k:k.$to_s()})},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(f){var X,le,k,A,Y,P,T=f.module,ne=f.klass,v=f.send2,S=f.find_super,L=f.def,J=[],j=f.nil,F=f.$$$;return f.top.$require("bcdice/result"),X=J,le=P=[T(J[0],"BCDice")].concat(X),k=Y=[T(P[0],"CommonCommand")].concat(le),(A=ne([T(Y[0],"BarabaraDice")].concat(k)[0],F(F("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),A.$attr_accessor("last_dice_list"),A.$attr_accessor("success_num"),L(A,"$initialize",function y(R){var ie=this;return y.$$p=null,null==R&&(R=j),v(ie,S(ie,"initialize",y,!1,!0),"initialize",[R],null),ie.last_dice_list_list=[],ie.last_dice_list=[],ie.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(f){var P,Y,te,y,ge,B,O,_,l,z,I,k,le,T=f.module,ne=f.klass,v=f.ensure_kwargs,S=f.get_kwarg,L=f.def,D=f.send,J=f.truthy,j=f.thrower,F=f.top,Z=[],X=f.nil;return F.$require("bcdice/format"),F.$require("bcdice/common_command/barabara_dice/result"),P=Z,Y=le=[T(Z[0],"BCDice")].concat(P),te=k=[T(le[0],"CommonCommand")].concat(Y),y=I=[T(k[0],"BarabaraDice")].concat(te),ge=z=[T(I[0],"Node")].concat(y),O=[B=ne(z[0],null,"Command")].concat(ge),_=f.$r(O),(l=B.$$prototype).notations=l.cmp_op=l.target_number=X,L(B,"$initialize",function(h){var d,p,m,x,$=this;return h=v(h),d=S(h,"secret"),p=S(h,"notations"),m=S(h,"cmp_op"),x=S(h,"target_number"),$.secret=d,$.notations=p,$.cmp_op=m,$.target_number=x}),L(B,"$eval",function(h,d){try{j("eval_return");var m,$,se,Ae,be,xe,x=this,re=X,De=X,fe=X,Pe=X,pe=X,Me=X;return $=h.$round_type(),re=D(x.notations,"map",[],function(ae){return null==ae&&(ae=X),ae.$to_dice($)}),se=J(De=x.cmp_op)?De:h.$default_cmp_op(),Ae=J(De=(m=x.target_number)===X||null==m?X:m.$eval($))?De:h.$default_target_number(),fe=D(re,"map",[],function(ae){return null==ae&&(ae=X),ae.$roll(d)}),J(h["$sort_barabara_dice?"]())&&D(fe,"map!",[],"sort".$to_proc()),be=(Pe=fe.$flatten()).$count(1),xe=J(se)?D(Pe,"count",[],function(ae){return null==ae&&(ae=X),ae.$send(se,Ae)}):0,J(se)&&(pe="\u6210\u529f\u6570"+xe),Me=["("+re.$join("+")+_("Format").$comparison_operator(se)+Ae+")",Pe.$join(","),pe,h.$grich_text(be,Pe.$size(),xe)].$compact(),D(_("Result").$new(),"tap",[],function Ce(ae){var he,Ee=null==Ce.$$s?this:Ce.$$s;return null==Ee.secret&&(Ee.secret=X),null==ae&&(ae=X),ae["$secret="](Ee.secret),ae["$text="](Me.$join(" \uff1e ")),ae["$last_dice_list_list="](fe),ae["$last_dice_list="](Pe),D(ae,"success_num=",he=[xe]),he[he.length-1]},{$$s:x})}catch(Ce){if(Ce===f.t_eval_return)return Ce.$v;throw Ce}}),function(ie,M,ge){var B=ne(ie,null,"Notation"),O=[B].concat(ge),_=f.$r(O),l=B.$$prototype;l.times=l.sides=X,L(B,"$initialize",function(h,d){return this.times=h,this.sides=d}),L(B,"$to_dice",function(h){try{var m,x;return j("eval_return"),m=this.times.$eval(h),x=this.sides.$eval(h),_("Dice").$new(m,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}})}(z[0],0,z),function(ie,M){var ge=ne(ie,null,"Dice"),B=ge.$$prototype;return B.times=B.sides=X,L(ge,"$initialize",function(_,l){return this.times=_,this.sides=l}),L(ge,"$roll",function(_){return _.$roll_barabara(this.times,this.sides)}),L(ge,"$to_s",function(){return this.times+"B"+this.sides})}(z[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(f){var q,N,A,ge,l,c,h,d,p,m,x,$,re,Ae,B,O,_,R,z,U,Q,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.hash2,j=f.return_val,F=f.to_ary,Z=f.truthy,X=f.top,K=[],P=f.nil,H=f.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/common_command/lexer"),X.$require("bcdice/common_command/barabara_dice/node"),X.$require("bcdice/arithmetic/node"),q=K,N=Q=[T(K[0],"BCDice")].concat(q),A=U=[T(Q[0],"CommonCommand")].concat(N),R=[T(U[0],"RerollDice")].concat(A),z=f.$r(R),ge=R,O=[B=ne(R[0],H(z("Racc"),"Parser"),"Parser")].concat(ge),_=f.$r(O),B.$$prototype.lexer=P,v(B,"$parse",function(pe){return this.$new().$parse(pe)}),S(B,"$parse",function(pe){try{return this.lexer=_("Lexer").$new(pe),this.$do_parse()}catch(Ce){if(!f.rescue(Ce,[_("ParseError")]))throw Ce;try{return P}finally{f.pop_exception()}}}),B.$private(),S(B,"$next_token",function(){return this.lexer.$next_token()}),l=f.large_array_unpack("9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,,8,34,35,9,20,21,31,32,8,20,21,9,,8,,31,32,20,21,31,32,8,40,,,,47,51,49,50,52"),c=f.large_array_unpack("14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,,32,43,43,35,34,34,46,46,34,35,35,39,,35,,27,27,39,39,41,41,39,27,,,,41,45,45,45,45"),h=f.large_array_unpack("-6,17,1,,20,-3,,30,14,,,18,30,22,-2,2,13,19,30,,27,35,,,0,,37,72,40,,,48,53,,61,66,,,45,74,,76,48,56,,89,63,,,,,,"),d=f.large_array_unpack("-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25"),p=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,P,P,P,P,P,P,P,46],m=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,P,P,P,P,P,P,P,7],x=[P,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],$=[P,P,P,P,P,P,P,P,P,22,18,19,P],re=f.large_array_unpack("0,0,racc_error,3,23,_reduce_1,4,23,_reduce_2,4,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,2,26,_reduce_7,3,27,_reduce_8,4,27,_reduce_9,2,28,_reduce_10,3,28,_reduce_11,3,25,_reduce_12,1,25,_reduce_13,3,30,_reduce_14,3,29,_reduce_15,3,29,_reduce_16,1,29,_reduce_none,3,32,_reduce_18,4,32,_reduce_19,1,32,_reduce_none,0,34,_reduce_21,1,34,_reduce_22,1,34,_reduce_23,1,34,_reduce_24,1,34,_reduce_25,2,33,_reduce_26,2,33,_reduce_27,1,33,_reduce_none,3,31,_reduce_29,1,31,_reduce_30"),Ae=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),D(O[0],"Racc_arg",[l,c,d,h,p,m,$,x,22,re,Ae,53,31,!0]),D(O[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,bracket,at,add,dice,term,mul,unary,round_type")),D(O[0],"Racc_debug_parser",!1),S(B,"$_reduce_1",function(pe,Me,Ce){return H(_("Node"),"Command").$new(J(["secret","notations","cmp_op","target_number","source"],{secret:pe["$[]"](0),notations:pe["$[]"](1),cmp_op:pe["$[]"](2)["$[]"]("cmp_op"),target_number:pe["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))}),S(B,"$_reduce_2",function(pe,Me,Ce){var he=P,Ee=P;return he=pe["$[]"](3),Ee=pe["$[]"](2),H(_("Node"),"Command").$new(J(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:pe["$[]"](0),notations:pe["$[]"](1),cmp_op:he["$[]"]("cmp_op"),target_number:he["$[]"]("target"),reroll_cmp_op:Ee["$[]"]("cmp_op"),reroll_threshold:Ee["$[]"]("threshold"),source:this.lexer.$source()}))}),S(B,"$_reduce_3",function(pe,Me,Ce){var he=P,Ee=P;return he=pe["$[]"](2),Ee=pe["$[]"](3),H(_("Node"),"Command").$new(J(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:pe["$[]"](0),notations:pe["$[]"](1),cmp_op:he["$[]"]("cmp_op"),target_number:he["$[]"]("target"),reroll_cmp_op:Ee["$[]"]("cmp_op"),reroll_threshold:Ee["$[]"]("threshold"),source:this.lexer.$source()}))}),S(B,"$_reduce_4",j(!1)),S(B,"$_reduce_5",j(!0)),S(B,"$_reduce_6",function(pe,Me,Ce){return J([],{})}),S(B,"$_reduce_7",function(pe,Me,Ce){var ae,C,V;return V=null==(ae=F(pe))[1]?P:ae[1],Z(C=null==ae[0]?P:ae[0])||this.$raise(_("ParseError")),J(["cmp_op","target"],{cmp_op:C,target:V})}),S(B,"$_reduce_8",function(pe,Me,Ce){return J(["threshold"],{threshold:pe["$[]"](1)})}),S(B,"$_reduce_9",function(pe,Me,Ce){var he,Ee;return he=pe["$[]"](1),Ee=pe["$[]"](2),Z(he)||this.$raise(_("ParseError")),J(["cmp_op","threshold"],{cmp_op:he,threshold:Ee})}),S(B,"$_reduce_10",function(pe,Me,Ce){return J(["threshold"],{threshold:pe["$[]"](1)})}),S(B,"$_reduce_11",function(pe,Me,Ce){var he,Ee;return he=pe["$[]"](1),Ee=pe["$[]"](2),Z(he)||this.$raise(_("ParseError")),J(["cmp_op","threshold"],{cmp_op:he,threshold:Ee})}),S(B,"$_reduce_12",function(pe,Me,Ce){var ae=P;return(ae=pe["$[]"](0)).$push(pe["$[]"](2)),ae}),S(B,"$_reduce_13",function(pe,Me,Ce){return[pe["$[]"](0)]}),S(B,"$_reduce_14",function(pe,Me,Ce){var ae,he;return ae=pe["$[]"](0),he=pe["$[]"](2),H(_("Node"),"Notation").$new(ae,he)}),S(B,"$_reduce_15",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"+",pe["$[]"](2))}),S(B,"$_reduce_16",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"-",pe["$[]"](2))}),S(B,"$_reduce_18",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"*",pe["$[]"](2))}),S(B,"$_reduce_19",function(pe,Me,Ce){return pe["$[]"](3).$new(pe["$[]"](0),pe["$[]"](2))}),S(B,"$_reduce_21",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(B,"$_reduce_22",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_23",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_24",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithRound")}),S(B,"$_reduce_25",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithFloor")}),S(B,"$_reduce_26",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_27",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Negative").$new(pe["$[]"](1))}),S(B,"$_reduce_29",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_30",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Number").$new(pe["$[]"](0))}),S(B,"$_reduce_none",function(pe,Me,Ce){return pe["$[]"](0)})},Opal.modules["bcdice/common_command/reroll_dice"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,L=f.top,D=[],J=f.nil;return L.$require("bcdice/normalize"),L.$require("bcdice/format"),L.$require("bcdice/common_command/reroll_dice/parser"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"RerollDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),ne(k[0],"REROLL_LIMIT",1e4),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R,z)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/upper_dice/node"]=function(f){var Y,te,y,M,l,c,h,d,p,B,z,I,k,T=f.module,ne=f.klass,v=f.ensure_kwargs,S=f.get_kwarg,L=f.def,D=f.send,J=f.truthy,j=f.rb_le,F=f.thrower,Z=f.rb_plus,X=f.eqeq,K=f.hash2,P=f.rb_lt,H=[],le=f.nil;return Y=H,te=k=[T(H[0],"BCDice")].concat(Y),y=I=[T(k[0],"CommonCommand")].concat(te),M=z=[T(I[0],"UpperDice")].concat(y),l=B=[T(z[0],"Node")].concat(M),h=[c=ne(B[0],null,"Command")].concat(l),d=f.$r(h),(p=c.$$prototype).notations=p.reroll_threshold=p.modifier=p.target_number=p.cmp_op=le,L(c,"$initialize",function(x){var $,re,se,De,Ae,fe,Pe=this;return x=v(x),$=S(x,"secret"),re=S(x,"notations"),se=S(x,"modifier"),De=S(x,"cmp_op"),Ae=S(x,"target_number"),null==(fe=x.$$smap.reroll_threshold)&&(fe=le),Pe.secret=$,Pe.notations=re,Pe.modifier=se,Pe.cmp_op=De,Pe.target_number=Ae,Pe.reroll_threshold=fe}),L(c,"$eval",function(x,$){try{F("eval_return");var se,De,Ae,Pe,be,xe,Ce,he,Me,ae,fe=this,pe=le,Ee=le,C=le,V=le;return Pe=x.$round_type(),be=D(fe.notations,"map",[],function(Te){return null==Te&&(Te=le),Te.$to_dice(Pe)}),xe=J(pe=J(Me=(se=fe.reroll_threshold)===le||null==se?le:se.$eval(Pe))?Me:x.$upper_dice_reroll_threshold())?pe:0,Ce=J(pe=(De=fe.modifier)===le||null==De?le:De.$eval(Pe))?pe:0,ae=(Ae=fe.target_number)===le||null==Ae?le:Ae.$eval(Pe),he=fe.$expr(be,xe,Ce,ae),J(j(xe,1))?fe.$result_with_text("("+he+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):(Ee=D(be,"map",[],function(Te){return null==Te&&(Te=le),Te.$roll($,xe,x["$sort_barabara_dice?"]())}).$reduce([],"concat"),C=J(fe.cmp_op)?fe.$result_success_count(Ee,Ce,ae):fe.$result_max_sum(Ee,Ce),V=["("+he+")",fe.$interlim_expr(Ee,Ce),C],fe.$result_with_text(V.$join(" \uff1e ")))}catch($e){if($e===f.t_eval_return)return $e.$v;throw $e}}),c.$private(),L(c,"$result_success_count",function(x,$,re){return"\u6210\u529f\u6570"+D(x,"count",[],function Ae(fe){var Pe=null==Ae.$$s?this:Ae.$$s;return null==Pe.cmp_op&&(Pe.cmp_op=le),null==fe&&(fe=le),Z(fe["$[]"]("sum"),$).$send(Pe.cmp_op,re)},{$$s:this})}),L(c,"$result_max_sum",function(x,$){var se,re=le;return re=D(x,"map",[],function(fe){return null==fe&&(fe=le),fe["$[]"]("sum")}),se=Z(re.$sum(),$),D(re,"map",[],function(fe){return null==fe&&(fe=le),Z(fe,$)}).$max()+"/"+se+"(\u6700\u5927/\u5408\u8a08)"}),L(c,"$interlim_expr",function(x,$){var re;return re=D(x,"map",[],function(De){return null==De&&(De=le),X(De["$[]"]("list").$size(),1)?De["$[]"]("sum"):De["$[]"]("sum")+"["+De["$[]"]("list").$join(",")+"]"}).$join(","),Z(re,d("Format").$modifier($))}),L(c,"$expr",function(x,$,re,se){var Ae,fe;return Ae=d("Format").$comparison_operator(this.cmp_op),fe=d("Format").$modifier(re),x.$join("+")+"["+$+"]"+fe+Ae+se}),L(c,"$result_with_text",function(x){return D(d("Result").$new(),"tap",[],function re(se){var De,Ae=null==re.$$s?this:re.$$s;return null==Ae.secret&&(Ae.secret=le),null==se&&(se=le),se["$secret="](Ae.secret),D(se,"text=",De=[x]),De[De.length-1]},{$$s:this})}),function(O,_,l){var c=ne(O,null,"Notation"),h=[c].concat(l),d=f.$r(h),p=c.$$prototype;p.roll_times=p.sides=le,L(c,"$initialize",function(x,$){return this.roll_times=x,this.sides=$}),L(c,"$to_dice",function(x){try{var se,De;return F("eval_return"),se=this.roll_times.$eval(x),De=this.sides.$eval(x),d("Dice").$new(se,De)}catch(Ae){if(Ae===f.t_eval_return)return Ae.$v;throw Ae}})}(B[0],0,B),function(O,_,l){var c=ne(O,null,"Dice"),h=[c].concat(l),d=f.$r(h),p=c.$$prototype;return p.roll_times=p.sides=le,L(c,"$initialize",function(x,$){return this.roll_times=x,this.sides=$}),L(c,"$roll",function(x,$,re){var De=le;return De=D(d("Array"),"new",[this.roll_times],function Ae(){var Pe=le;return Pe=(null==Ae.$$s?this:Ae.$$s).$roll_ones(x,$),K(["sum","list"],{sum:Pe.$sum(),list:Pe})},{$$s:this}),J(re)&&(De=D(De,"sort_by",[],function(fe){return null==fe&&(fe=le),fe["$[]"]("sum")})),De}),L(c,"$to_s",function(){return this.roll_times+"U"+this.sides}),c.$private(),L(c,"$roll_ones",function(x,$){var re=this,se=le;return se=[],function(){try{var De=F("break");D(re,"loop",[],function Ae(){var Pe,fe=null==Ae.$$s?this:Ae.$$s;if(null==fe.sides&&(fe.sides=le),Pe=x.$roll_once(fe.sides),se.$push(Pe),!J(P(Pe,$)))return le;De.$throw()},{$$s:re})}catch(Ae){if(Ae===De)return Ae.$v;throw Ae}}(),se})}(B[0],0,B)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(f){var q,N,A,ge,l,c,h,d,p,m,x,$,re,Ae,B,O,_,R,z,U,Q,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.hash2,j=f.return_val,F=f.to_ary,Z=f.truthy,X=f.top,K=[],P=f.nil,H=f.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/common_command/lexer"),X.$require("bcdice/common_command/upper_dice/node"),X.$require("bcdice/arithmetic/node"),q=K,N=Q=[T(K[0],"BCDice")].concat(q),A=U=[T(Q[0],"CommonCommand")].concat(N),R=[T(U[0],"UpperDice")].concat(A),z=f.$r(R),ge=R,O=[B=ne(R[0],H(z("Racc"),"Parser"),"Parser")].concat(ge),_=f.$r(O),B.$$prototype.lexer=P,v(B,"$parse",function(pe){return this.$new().$parse(pe)}),S(B,"$parse",function(pe){try{return this.lexer=_("Lexer").$new(pe),this.$do_parse()}catch(Ce){if(!f.rescue(Ce,[_("ParseError")]))throw Ce;try{return P}finally{f.pop_exception()}}}),B.$private(),S(B,"$next_token",function(){return this.lexer.$next_token()}),l=f.large_array_unpack("9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,,8,39,40,,21,22,39,40,8,58,56,57,59,36,37"),c=f.large_array_unpack("2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,,40,50,50,,44,44,51,51,44,53,53,53,53,54,54"),h=f.large_array_unpack("-3,22,-2,,28,9,,32,-1,,,20,35,40,4,12,17,3,22,46,,25,30,,34,38,46,43,51,56,51,,76,59,-6,,64,69,,77,82,,,,90,66,,72,77,,85,90,,100,99,,,,,"),d=f.large_array_unpack("-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29"),p=f.large_array_unpack("18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,,,,,,,,54"),m=f.large_array_unpack("10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,,,,,,,,10"),x=[P,7,9,8,7,-6,6,2,P,-13,-8,4,11,-18,-26],$=[P,P,P,P,P,P,P,P,13,19,P,P,23,20,P],re=f.large_array_unpack("0,0,racc_error,4,23,_reduce_1,5,23,_reduce_2,5,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,1,26,_reduce_7,2,30,_reduce_8,2,30,_reduce_9,3,30,_reduce_10,3,30,_reduce_11,0,27,_reduce_12,2,27,_reduce_13,3,28,_reduce_14,2,29,_reduce_15,3,25,_reduce_16,1,25,_reduce_17,3,33,_reduce_18,3,32,_reduce_19,3,32,_reduce_20,1,32,_reduce_none,3,31,_reduce_22,4,31,_reduce_23,1,31,_reduce_none,0,36,_reduce_25,1,36,_reduce_26,1,36,_reduce_27,1,36,_reduce_28,1,36,_reduce_29,2,35,_reduce_30,2,35,_reduce_31,1,35,_reduce_none,3,34,_reduce_33,1,34,_reduce_34"),Ae=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),D(O[0],"Racc_arg",[l,c,d,h,p,m,$,x,22,re,Ae,60,35,!0]),D(O[0],"Racc_token_to_s_table",f.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,modifier,target,bracket,at,modifier_expr,mul,add,dice,term,unary,round_type")),D(O[0],"Racc_debug_parser",!1),S(B,"$_reduce_1",function(pe,Me,Ce){return H(H(_("UpperDice"),"Node"),"Command").$new(J(["secret","notations","modifier","cmp_op","target_number"],{secret:pe["$[]"](0),notations:pe["$[]"](1),modifier:pe["$[]"](2),cmp_op:pe["$[]"](3)["$[]"]("cmp_op"),target_number:pe["$[]"](3)["$[]"]("target")}))}),S(B,"$_reduce_2",function(pe,Me,Ce){return H(H(_("UpperDice"),"Node"),"Command").$new(J(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:pe["$[]"](0),notations:pe["$[]"](1),modifier:pe["$[]"](3),cmp_op:pe["$[]"](4)["$[]"]("cmp_op"),target_number:pe["$[]"](4)["$[]"]("target"),reroll_threshold:pe["$[]"](2)}))}),S(B,"$_reduce_3",function(pe,Me,Ce){return H(H(_("UpperDice"),"Node"),"Command").$new(J(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:pe["$[]"](0),notations:pe["$[]"](1),modifier:pe["$[]"](2),cmp_op:pe["$[]"](3)["$[]"]("cmp_op"),target_number:pe["$[]"](3)["$[]"]("target"),reroll_threshold:pe["$[]"](4)}))}),S(B,"$_reduce_4",j(!1)),S(B,"$_reduce_5",j(!0)),S(B,"$_reduce_6",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Number").$new(0)}),S(B,"$_reduce_7",function(pe,Me,Ce){return pe["$[]"](0)}),S(B,"$_reduce_8",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_9",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Negative").$new(pe["$[]"](1))}),S(B,"$_reduce_10",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"+",pe["$[]"](2))}),S(B,"$_reduce_11",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"-",pe["$[]"](2))}),S(B,"$_reduce_12",function(pe,Me,Ce){return J([],{})}),S(B,"$_reduce_13",function(pe,Me,Ce){var ae,C,V;return V=null==(ae=F(pe))[1]?P:ae[1],Z(C=null==ae[0]?P:ae[0])||this.$raise(_("ParseError")),J(["cmp_op","target"],{cmp_op:C,target:V})}),S(B,"$_reduce_14",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_15",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_16",function(pe,Me,Ce){var ae=P;return(ae=pe["$[]"](0)).$push(pe["$[]"](2)),ae}),S(B,"$_reduce_17",function(pe,Me,Ce){return[pe["$[]"](0)]}),S(B,"$_reduce_18",function(pe,Me,Ce){var ae,he;return ae=pe["$[]"](0),he=pe["$[]"](2),H(H(_("UpperDice"),"Node"),"Notation").$new(ae,he)}),S(B,"$_reduce_19",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"+",pe["$[]"](2))}),S(B,"$_reduce_20",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"-",pe["$[]"](2))}),S(B,"$_reduce_22",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"BinaryOp").$new(pe["$[]"](0),"*",pe["$[]"](2))}),S(B,"$_reduce_23",function(pe,Me,Ce){return pe["$[]"](3).$new(pe["$[]"](0),pe["$[]"](2))}),S(B,"$_reduce_25",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(B,"$_reduce_26",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_27",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithCeil")}),S(B,"$_reduce_28",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithRound")}),S(B,"$_reduce_29",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"DivideWithFloor")}),S(B,"$_reduce_30",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_31",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Negative").$new(pe["$[]"](1))}),S(B,"$_reduce_33",function(pe,Me,Ce){return pe["$[]"](1)}),S(B,"$_reduce_34",function(pe,Me,Ce){return H(H(_("Arithmetic"),"Node"),"Number").$new(pe["$[]"](0))}),S(B,"$_reduce_none",function(pe,Me,Ce){return pe["$[]"](0)})},Opal.modules["bcdice/common_command/upper_dice"]=function(f){var F,P,Y,N,U,I,Q,k,le,X,T=f.module,ne=f.const_set,v=f.thrower,S=f.def,D=[],J=f.nil;return f.top.$require("bcdice/common_command/upper_dice/parser"),F=D,P=X=[T(D[0],"BCDice")].concat(F),Y=le=[T(X[0],"CommonCommand")].concat(P),ne((k=[Q=T(le[0],"UpperDice")].concat(Y))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),U=[N=f.get_singleton_class(Q)].concat(k),I=f.$r(U),S(N,"$eval",function(y,R,z){try{var M;return v("eval_return"),(M=I("Parser").$parse(y))===J||null==M?J:M.$eval(R,z)}catch(B){if(B===f.t_eval_return)return B.$v;throw B}})},Opal.modules["bcdice/common_command/version"]=function(f){var Z,H,Q,te,I,A,k,N,q,K,T=f.module,ne=f.const_set,v=f.truthy,S=f.send,L=f.def,D=[],J=f.nil,j=f.$$$;return Z=D,H=K=[T(D[0],"BCDice")].concat(Z),Q=q=[T(K[0],"CommonCommand")].concat(H),ne((N=[k=T(q[0],"Version")].concat(Q))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),I=[te=f.get_singleton_class(k)].concat(N),A=f.$r(I),L(te,"$eval",function(R,z,ie){return R=R.$split(" ",2).$first(),v(R["$match?"](/^BCDiceVersion$/i))?S(A("Result").$new(),"tap",[],function(ge){var B;return null==ge&&(ge=J),B=["BCDice "+j(A("BCDice"),"VERSION")],S(ge,"text=",B),B[B.length-1]}):J})},Opal.queue(function(f){var J,X,P,H,F,T=f.module,ne=f.const_set,v=f.top,S=[];return v.$require("bcdice/common_command/add_dice"),v.$require("bcdice/common_command/barabara_dice"),v.$require("bcdice/common_command/tally_dice"),v.$require("bcdice/common_command/calc"),v.$require("bcdice/common_command/choice"),v.$require("bcdice/common_command/d66_dice"),v.$require("bcdice/common_command/repeat"),v.$require("bcdice/common_command/reroll_dice"),v.$require("bcdice/common_command/upper_dice"),v.$require("bcdice/common_command/version"),J=S,X=F=[T(S[0],"BCDice")].concat(J),P=[T(F[0],"CommonCommand")].concat(X),H=f.$r(P),ne(P[0],"COMMANDS",[H("AddDice"),H("BarabaraDice"),H("TallyDice"),H("Calc"),H("Choice"),H("D66Dice"),H("Repeat"),H("RerollDice"),H("UpperDice"),H("Version")].$freeze())})},9993:function(){(function(E){"use strict";var de;if("undefined"!=typeof globalThis?E=globalThis:"undefined"!=typeof global?E=global:"undefined"!=typeof window&&(E=window),null==E.console&&(E.console={}),"log"in(de="object"==typeof E.console?E.console:{})||(de.log=function(){}),"warn"in de||(de.warn=de.log),void 0!==E.Opal)return de.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),E.Opal;var ye,f,T,ne,v,S,L,D=E.Opal={};D.global=E,D.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var J=Function.prototype.call,j=Function.prototype.bind,F=Object.hasOwn||J.bind(Object.prototype.hasOwnProperty),Z=Object.setPrototypeOf,X=J.bind(Array.prototype.slice),K=J.bind(Array.prototype.splice),H=4;function le(){return H+=2}D.uid=le,D.id=function(C){return C.$$is_number?2*C+1:(null==C.$$id&&Q(C,"$$id",le()),C.$$id)};var q=D.gvars={};function Y(C,V){if(C||(C=D.Exception||Error),!L||!L.$raise)throw C.$new?C.$new(V):new C(V);arguments.length>2?L.$raise(C.$new.apply(C,X(arguments,1))):L.$raise(C,V)}function Q(C,V,$e){"string"==typeof C?C[V]=$e:Object.defineProperty(C,V,{value:$e,enumerable:!1,configurable:!0,writable:!0})}D.exit=function(C){q.DEBUG&&de.log("Exited with status "+C)},D.exceptions=[],D.pop_exception=function(){var C=D.exceptions.pop();C?(q["!"]=C,q["@"]=C.$backtrace()):q["!"]=q["@"]=ye},D.prop=Q,D.defineProperty=D.prop,D.slice=X;var k=D.truthy=function(C){return!(!1===C||ye===C||null==C||C instanceof Boolean&&!0!==C.valueOf())};function N(C){var V,$e,Te;for(V=0,$e=D.tracers_for_class.length;V<$e;V++)(Te=D.tracers_for_class[V]).trace_object=C,Te.block.$call(Te)}function te(C,V){if(C.$$autoload[V].loaded){if(C.$$autoload[V].loaded&&!C.$$autoload[V].required&&C.$$autoload[V].exception)throw C.$$autoload[V].exception}else{C.$$autoload[V].loaded=!0;try{D.Kernel.$require(C.$$autoload[V].path)}catch($e){throw C.$$autoload[V].exception=$e,$e}if(C.$$autoload[V].required=!0,null!=C.$$const[V])return C.$$autoload[V].success=!0,C.$$const[V]}}function U(C,V){if(C){if(null!=C.$$const[V])return C.$$const[V];if(C.$$autoload&&C.$$autoload[V])return te(C,V)}}function A(C,V){var $e,Te,Fe;if(null!=C)for($e=0,Te=(Fe=se(C)).length;$e<Te;$e++){if(Fe[$e].$$const&&F(Fe[$e].$$const,V))return Fe[$e].$$const[V];if(Fe[$e].$$autoload&&Fe[$e].$$autoload[V])return te(Fe[$e],V)}}function R(C,V){return(C||T).$const_missing(V)}function z(C,V,$e){var Te=!0;return(null==C||"::"===C)&&(C=T),$e.$$is_a_module&&((null==$e.$$name||$e.$$name===ye)&&($e.$$name=V),null==$e.$$base_module&&($e.$$base_module=C)),C.$$const=C.$$const||Object.create(null),(V in C.$$const||"$$autoload"in C&&V in C.$$autoload)&&(Te=!1),C.$$const[V]=$e,C.$$=C.$$const,D.const_cache_version++,C===T&&(D[V]=$e),Q(C,V,$e),Te&&C.$const_added&&!C.$const_added.$$pristine&&C.$const_added(V),$e}function ie(C,V,$e){var Te;if(Te=null!=V&&V.$$bridge?function(){var lt=X(arguments),Et=new(j.apply(V.$$constructor,[null].concat(lt)));return Z(Et,Te.$$prototype),Et}:function(){},C&&C!==ye&&Q(Te,"displayName","::"+C),Q(Te,"$$name",C),Q(Te,"$$constructor",Te),Q(Te,"$$prototype",Te.prototype),Q(Te,"$$const",{}),Q(Te,"$$is_class",!0),Q(Te,"$$is_a_module",!0),Q(Te,"$$super",V),Q(Te,"$$cvars",{}),Q(Te,"$$own_included_modules",[]),Q(Te,"$$own_prepended_modules",[]),Q(Te,"$$ancestors",[]),Q(Te,"$$ancestors_cache_version",null),Q(Te,"$$subclasses",[]),Q(Te.$$prototype,"$$class",Te),D.Class&&Z(Te,D.Class.prototype),null!=V){if(Z(Te.$$prototype,V.$$prototype),!0!==$e)if("undefined"!=typeof WeakRef){var Fe,Ue,Ze=[];for(Fe=0;Fe<V.$$subclasses.length;Fe++)void 0!==(Ue=V.$$subclasses[Fe]).deref()&&Ze.push(Ue);Ze.push(new WeakRef(Te)),V.$$subclasses=Ze}else V.$$subclasses.push(Te);V.$$meta&&D.build_class_singleton_class(Te)}return Te}function B(C){var V=function(){},$e=V;return C&&Q(V,"displayName",C+".constructor"),Q($e,"$$name",C),Q($e,"$$prototype",V.prototype),Q($e,"$$const",{}),Q($e,"$$is_module",!0),Q($e,"$$is_a_module",!0),Q($e,"$$cvars",{}),Q($e,"$$iclasses",[]),Q($e,"$$own_included_modules",[]),Q($e,"$$own_prepended_modules",[]),Q($e,"$$ancestors",[$e]),Q($e,"$$ancestors_cache_version",null),Z($e,D.Module.prototype),$e}function _(C,V){C.hasOwnProperty("$$meta")?C.$$meta=V:Q(C,"$$meta",V),C.$$frozen?C.$$meta.$freeze():Z(C,V.$$prototype)}function l(C){return C.hasOwnProperty("$$iclass")&&C.hasOwnProperty("$$root")}function p(C){var V=m(C);return C.$$is_module&&C.$$iclasses.push(V),V}function m(C){var V={},$e=C.$$prototype;$e.hasOwnProperty("$$dummy")&&($e=$e.$$define_methods_on);var Ue,Te=Object.getOwnPropertyNames($e),Fe=Te.length;for(Ue=0;Ue<Fe;Ue++){var Ze=Te[Ue];Q(V,Ze,$e[Ze])}return Q(V,"$$iclass",!0),Q(V,"$$module",C),V}function x(C){var V=C.length,$e=C[0];if(Q($e,"$$root",!0),1===V)return{first:$e,last:$e};for(var Te=$e,Fe=1;Fe<V;Fe++){var Ue=C[Fe];Z(Te,Ue),Te=Ue}return{first:C[0],last:C[V-1]}}function $(C){if(!C.hasOwnProperty("$$dummy")){if(C.hasOwnProperty("$$iclass"))return C.$$module;if(C.hasOwnProperty("$$class"))return C.$$class}}function se(C){if(!C)return[];if(C.$$ancestors_cache_version===D.const_cache_version)return C.$$ancestors;var $e,Te,Fe,V=[];for($e=0,Te=function re(C){return C.$$own_prepended_modules.concat([C]).concat(C.$$own_included_modules)}(C),Fe=Te.length;$e<Fe;$e++)V.push(Te[$e]);if(C.$$super)for($e=0,Fe=(Te=se(C.$$super)).length;$e<Fe;$e++)V.push(Te[$e]);return C.$$ancestors_cache_version=D.const_cache_version,C.$$ancestors=V,V}function De(C){return C.hasOwnProperty("$$meta")&&null!==C.$$meta?se(C.$$meta):se(C.$$class)}function Ae(C,V){"number"==typeof V?C.$$arity=V:"object"==typeof V&&Object.assign(C,V)}D.falsy=function(C){return!k(C)},D.type_error=function(C,V,$e,Te){C=C.$$class,Y(D.TypeError,Te&&$e?"can't convert "+C+" into "+V+" ("+C+"#"+$e+" gives "+(Te=Te.$$class)+")":"no implicit conversion of "+C+" into "+V)},D.coerce_to=function(C,V,$e,Te){var Fe;return"to_int"===$e&&V===D.Integer&&C.$$is_number?C<0?Math.ceil(C):Math.floor(C):"to_str"===$e&&V===D.String&&C.$$is_string||D.is_a(C,V)?C:C["$respond_to?"].$$pristine&&C.$method_missing.$$pristine?((null==(Fe=C[Pe($e)])||Fe.$$stub)&&D.type_error(C,V),Fe.apply(C,Te)):(C["$respond_to?"]($e)||D.type_error(C,V),null==Te&&(Te=[]),D.send(C,$e,Te))},D.respond_to=function(C,V,$e){if(null==C||!C.$$class)return!1;$e=!!$e;var Te=C[V];return C["$respond_to?"].$$pristine?"function"==typeof Te&&!Te.$$stub||(C["$respond_to_missing?"].$$pristine?void 0:D.send(C,C["$respond_to_missing?"],[V.substr(1),$e])):D.send(C,C["$respond_to?"],[V.substr(1),$e])},D.trace_class=!1,D.tracers_for_class=[],D.const_get_local=function(C,V,$e){var Te;if(null!=C)return"::"===C&&(C=T),!C.$$is_module&&!C.$$is_class&&Y(D.TypeError,C.toString()+" is not a class/module"),null!=(Te=U(C,V))||$e?Te:R(C,V)},D.const_get_qualified=function(C,V,$e){var Te,Fe,Ue,Ze=D.const_cache_version;return null==V?null!=(Te=U(T,C))?Te:D.const_get_qualified(T,C,$e):null!=C?("::"===C&&(C=T),!C.$$is_module&&!C.$$is_class&&Y(D.TypeError,C.toString()+" is not a class/module"),null==(Fe=C.$$const_cache)&&(Q(C,"$$const_cache",Object.create(null)),Fe=C.$$const_cache),null==(Ue=Fe[V])||Ue[0]!==Ze?(null!=(Te=U(C,V))||(Te=A(C,V)),Fe[V]=[Ze,Te]):Te=Ue[1],null!=Te||$e?Te:R(C,V)):void 0},D.const_cache_version=1,D.const_get_relative=function(C,V,$e){var Fe,Ze,lt,Te=C[0],Ue=D.const_cache_version;return null==(Ze=C.$$const_cache)&&(Q(C,"$$const_cache",Object.create(null)),Ze=C.$$const_cache),null==(lt=Ze[V])||lt[0]!==Ue?(null!=(Fe=U(Te,V))||null!=(Fe=function I(C,V){var $e,Te,Fe;if(0!==C.length)for($e=0,Te=C.length;$e<Te;$e++){if(null!=(Fe=C[$e].$$const[V]))return Fe;if(C[$e].$$autoload&&C[$e].$$autoload[V])return te(C[$e],V)}}(C,V))||null!=(Fe=A(Te,V))||(Fe=function y(C,V){if(null==C||C.$$is_module)return A(T,V)}(Te,V)),Ze[V]=[Ue,Fe]):Fe=lt[1],null!=Fe||$e?Fe:R(Te,V)},D.const_set=z,D.constants=function(C,V){null==V&&(V=!0);var $e,Fe,Ue,lt,Te=[C],Ze={};for(V&&(Te=Te.concat(se(C))),V&&C.$$is_module&&(Te=Te.concat([D.Object]).concat(se(D.Object))),Fe=0,Ue=Te.length;Fe<Ue&&($e=Te[Fe],C===T||$e!=T);Fe++){for(lt in $e.$$const)Ze[lt]=!0;if($e.$$autoload)for(lt in $e.$$autoload)Ze[lt]=!0}return Object.keys(Ze)},D.const_remove=function(C,V){if(D.const_cache_version++,null!=C.$$const[V]){var $e=C.$$const[V];return delete C.$$const[V],$e}if(C.$$autoload&&C.$$autoload[V])return delete C.$$autoload[V],ye;Y(D.NameError,"constant "+C+"::"+C.$name()+" not defined")},D.const_get_relative_factory=function(C){return function(V,$e){return D.$$(C,V,$e)}},D.$$=D.const_get_relative,D.$$$=D.const_get_qualified,D.$r=D.const_get_relative_factory,D.allocate_class=ie,D.klass=function(C,V,$e){var Te;null==C||"::"==C?C=T:!C.$$is_class&&!C.$$is_module&&(C=C.$$class),null!=V&&(!V.hasOwnProperty||V.hasOwnProperty&&!V.hasOwnProperty("$$is_class"))&&(V.constructor&&"Function"==V.constructor.name?(Te=V,V=T):Y(D.TypeError,"superclass must be a Class ("+(V.constructor&&(V.constructor.name||V.constructor.$$name)||typeof V)+" given)"));var Fe=function M(C,V){var $e=U(C,V);if($e)return $e.$$is_class||Y(D.TypeError,V+" is not a class"),$e}(C,$e);return null!=Fe?V&&function ge(C,V){C.$$super!==V&&Y(D.TypeError,"superclass mismatch for class "+C.$$name)}(Fe,V):(null==V&&(V=T),z(C,$e,Fe=ie($e,V)),V.$inherited&&V.$inherited(Fe),Te&&D.bridge(Te,Fe)),D.trace_class&&N(Fe),Fe},D.allocate_module=B,D.module=function(C,V){var $e;return null==C||"::"==C?C=T:!C.$$is_class&&!C.$$is_module&&(C=C.$$class),$e=function O(C,V){var $e=U(C,V);return null==$e&&C===T&&($e=A(T,V)),$e&&!$e.$$is_module&&$e!==T&&Y(D.TypeError,V+" is not a module"),$e}(C,V),null==$e&&z(C,V,$e=B(V)),D.trace_class&&N($e),$e},D.get_singleton_class=function(C){return C.$$meta?C.$$meta:C.hasOwnProperty("$$is_class")?D.build_class_singleton_class(C):C.hasOwnProperty("$$is_module")?D.build_module_singleton_class(C):D.build_object_singleton_class(C)},D.build_class_singleton_class=function(C){if(C.$$meta)return C.$$meta;var $e=ie(null,C===f?v:D.get_singleton_class(C.$$super),!0);return Q($e,"$$is_singleton",!0),Q($e,"$$singleton_of",C),_(C,$e),Q(C,"$$class",D.Class),$e},D.build_module_singleton_class=function(C){if(C.$$meta)return C.$$meta;var V=ie(null,D.Module,!0);return Q(V,"$$is_singleton",!0),Q(V,"$$singleton_of",C),_(C,V),Q(C,"$$class",D.Module),V},D.build_object_singleton_class=function(C){var $e=ie(ye,C.$$class,!0);return Q($e,"$$is_singleton",!0),Q($e,"$$singleton_of",C),delete $e.$$prototype.$$class,_(C,$e),$e},D.is_method=function(C){return"$"===C[0]&&"$"!==C[1]},D.instance_methods=function(C){for(var V=[],$e=[],Te=se(C),Fe=0,Ue=Te.length;Fe<Ue;Fe++){var lt=Te[Fe].$$prototype;lt.hasOwnProperty("$$dummy")&&(lt=lt.$$define_methods_on);for(var Et=Object.getOwnPropertyNames(lt),It=0,hn=Et.length;It<hn;It++){var nn=Et[It];if(D.is_method(nn)){var Bn=nn.slice(1),Ln=lt[nn];Ln.$$stub&&-1===V.indexOf(Bn)&&V.push(Bn),!Ln.$$stub&&-1===$e.indexOf(Bn)&&-1===V.indexOf(Bn)&&$e.push(Bn)}}}return $e},D.own_instance_methods=function(C){var V=[],$e=C.$$prototype;$e.hasOwnProperty("$$dummy")&&($e=$e.$$define_methods_on);for(var Te=Object.getOwnPropertyNames($e),Fe=0,Ue=Te.length;Fe<Ue;Fe++){var Ze=Te[Fe];if(D.is_method(Ze)&&!$e[Ze].$$stub){var Et=Ze.slice(1);V.push(Et)}}return V},D.methods=function(C){return D.instance_methods(C.$$meta||C.$$class)},D.own_methods=function(C){return C.$$meta?D.own_instance_methods(C.$$meta):[]},D.receiver_methods=function(C){var V=D.get_singleton_class(C),$e=D.own_instance_methods(V),Te=D.own_instance_methods(V.$$super);return $e.concat(Te)},D.class_variables=function(C){var $e,V=se(C),Fe={};for($e=V.length-1;$e>=0;$e--){var Ue=V[$e];for(var Ze in Ue.$$cvars)Fe[Ze]=Ue.$$cvars[Ze]}return Fe},D.class_variable_set=function(C,V,$e){var Fe,Te=se(C);for(Fe=Te.length-2;Fe>=0;Fe--){var Ze=Te[Fe];if(F(Ze.$$cvars,V))return Ze.$$cvars[V]=$e,$e}return C.$$cvars[V]=$e,$e},D.class_variable_get=function(C,V,$e){if(F(C.$$cvars,V))return C.$$cvars[V];var Fe,Te=se(C),Ue=Te.length;for(Fe=0;Fe<Ue;Fe++){var Ze=Te[Fe];if(F(Ze.$$cvars,V))return Ze.$$cvars[V]}return $e||Y(D.NameError,"uninitialized class variable "+V+" in "+C.$name()),ye},D.append_features=function(C,V){var $e=se(C),Te=[];-1!==$e.indexOf(V)&&Y(D.ArgumentError,"cyclic include detected");for(var Fe=0,Ue=$e.length;Fe<Ue;Fe++){var lt=p($e[Fe]);Q(lt,"$$included",!0),Te.push(lt)}var hn,nn,Et=se(V),It=x(Te);if(-1===Et.indexOf(C))hn=V.$$prototype,nn=Object.getPrototypeOf(V.$$prototype);else{for(var Bn=V.$$prototype,Ln=Object.getPrototypeOf(Bn);null!=Ln&&(Ln.$$module!==C||!l(Ln));)Bn=Ln,Ln=Object.getPrototypeOf(Ln);if(Ln){for(var ar=Object.getPrototypeOf(Ln);ar.hasOwnProperty("$$iclass")&&!l(ar);)ar=Object.getPrototypeOf(ar);hn=Bn,nn=ar}else hn=V.$$prototype,nn=Object.getPrototypeOf(V.$$prototype)}Z(hn,It.first),Z(It.last,nn),V.$$own_included_modules=function c(C){for(var $e,V=[],Te=Object.getPrototypeOf(C.$$prototype);Te&&!Te.hasOwnProperty("$$class");)($e=$(Te))&&V.push($e),Te=Object.getPrototypeOf(Te);return V}(V),D.const_cache_version++},D.prepend_features=function(C,V){var $e=se(C),Te=[];-1!==$e.indexOf(V)&&Y(D.ArgumentError,"cyclic prepend detected");for(var Fe=0,Ue=$e.length;Fe<Ue;Fe++){var lt=p($e[Fe]);Q(lt,"$$prepended",!0),Te.push(lt)}var nn,Bn,Ln,Et=x(Te),It=V.$$prototype,hn=Object.getPrototypeOf(It);if(It.hasOwnProperty("$$dummy")?nn=It.$$define_methods_on:(nn=m(V),function d(C){for(var V=C.$$prototype,$e=Object.getOwnPropertyNames(V),Te=0;Te<$e.length;Te++){var Fe=$e[Te];D.is_method(Fe)&&delete V[Fe]}}(V),Q(It,"$$dummy",!0),Q(It,"$$define_methods_on",nn),Z(It,nn),Z(nn,hn)),-1===se(V).indexOf(C))for(Bn=It,Ln=Object.getPrototypeOf(It);null!=Ln&&!Ln.hasOwnProperty("$$root")&&Ln!==nn&&Ln.hasOwnProperty("$$iclass");)Ln=Object.getPrototypeOf(Ln);else Y(D.RuntimeError,"Prepending a module multiple times is not supported");Z(Bn,Et.first),Z(Et.last,Ln),V.$$own_prepended_modules=function h(C){var $e,V=[],Te=Object.getPrototypeOf(C.$$prototype);if(C.$$prototype.hasOwnProperty("$$dummy"))for(;Te&&Te!==C.$$prototype.$$define_methods_on;)($e=$(Te))&&V.push($e),Te=Object.getPrototypeOf(Te);return V}(V),D.const_cache_version++},D.bridge=function(C,V){C.hasOwnProperty("$$bridge")&&Y(D.ArgumentError,"already bridged"),Q(C,"$$bridge",V),Z(C.prototype,(V.$$super||D.Object).$$prototype),Q(V,"$$prototype",C.prototype),Q(V.$$prototype,"$$class",V),Q(V,"$$constructor",C),Q(V,"$$bridge",!0)},D.ancestors=se,D.included_modules=function(C){for(var V=[],$e=null,Te=Object.getPrototypeOf(C.$$prototype);Te&&Object.getPrototypeOf(Te);Te=Object.getPrototypeOf(Te))($e=$(Te))&&$e.$$is_module&&Te.$$iclass&&Te.$$included&&V.push($e);return V},D.add_stubs=function(C){for(var $e,Te,V=D.BasicObject.$$prototype,Fe=0,Ue=(C=C.split(",")).length;Fe<Ue;Fe++)(null==(Te=V[$e=Pe(C[Fe])])||Te.$$stub)&&D.add_stub_for(V,$e)},D.add_stub_for=function(C,V){Q(C,V,D.stub_for(V))},D.stub_for=function(C){function V(){this.$method_missing.$$p=V.$$p,V.$$p=null;for(var $e=new Array(arguments.length),Te=0,Fe=$e.length;Te<Fe;Te++)$e[Te]=arguments[Te];return this.$method_missing.apply(this,[C.slice(1)].concat($e))}return V.$$stub=!0,V},D.ac=function(C,V,$e,Te){var Fe="";Fe+=$e.$$is_a_module?$e.$$name+".":$e.$$class.$$name+"#",Y(D.ArgumentError,"["+(Fe+=Te)+"] wrong number of arguments (given "+C+", expected "+V+")")},D.block_ac=function(C,V,$e){Y(D.ArgumentError,"`block in "+$e+"': wrong number of arguments (given "+C+", expected "+V+")")},D.find_super=function(C,V,$e,Te,Fe){for(var Ze,lt,Ue=Pe(V),It=(Ze=De(C)).indexOf($e.$$owner)+1;It<Ze.length;It++){var nn=Ze[It].$$prototype;if(nn.hasOwnProperty("$$dummy")&&(nn=nn.$$define_methods_on),nn.hasOwnProperty(Ue)){lt=nn[Ue];break}}return!Te&&lt&&lt.$$stub&&C.$method_missing.$$pristine&&Y(D.NoMethodError,"super: no superclass method `"+V+"' for "+C,V),lt.$$stub&&!Fe?null:lt},D.find_block_super=function(C,V,$e,Te,Fe){var Ue=V;return $e||Y(D.RuntimeError,"super called outside of method"),Fe&&$e.$$define_meth&&Y(D.RuntimeError,"implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly"),$e.$$def&&(Ue=$e.$$jsid),D.find_super(C,Ue,$e,Te)},D.find_super_dispatcher=D.find_super,D.find_iter_super_dispatcher=D.find_block_super,D.yield1=function(C,V){"function"!=typeof C&&Y(D.LocalJumpError,"no block given");var Te=C.$$has_trailing_comma_in_args;return(C.length>1||(C.$$has_top_level_mlhs_arg||Te)&&1===C.length)&&(V=D.to_ary(V)),(C.length>1||Te&&1===C.length)&&V.$$is_array?C.apply(null,V):C(V)},D.yieldX=function(C,V){if("function"!=typeof C&&Y(D.LocalJumpError,"no block given"),C.length>1&&1===V.length&&V[0].$$is_array)return C.apply(null,V[0]);if(!V.$$is_array){for(var $e=new Array(V.length),Te=0,Fe=$e.length;Te<Fe;Te++)$e[Te]=V[Te];return C.apply(null,$e)}return C.apply(null,V)},D.rescue=function(C,V){for(var $e=0;$e<V.length;$e++){var Te=V[$e];if(Te.$$is_array){var Fe=D.rescue(C,Te);if(Fe)return Fe}else if(Te===D.JS.Error||Te["$==="](C))return Te}return null},D.is_a=function(C,V){return null!=V&&C.$$meta===V||C.$$class===V||(C.$$is_number&&V.$$is_number_class?!V.$$is_integer_class||C%1==0:-1!==se(C.$$is_class?D.get_singleton_class(C):C.$$meta||C.$$class).indexOf(V))},D.to_hash=function(C){if(C.$$is_hash)return C;if(C["$respond_to?"]("to_hash",!0)){var V=C.$to_hash();if(V.$$is_hash)return V;Y(D.TypeError,"Can't convert "+C.$$class+" to Hash ("+C.$$class+"#to_hash gives "+V.$$class+")")}else Y(D.TypeError,"no implicit conversion of "+C.$$class+" into Hash")},D.to_ary=function(C){if(C.$$is_array)return C;if(!C["$respond_to?"]("to_ary",!0))return[C];var V=C.$to_ary();return V===ye?[C]:V.$$is_array?V:void Y(D.TypeError,"Can't convert "+C.$$class+" to Array ("+C.$$class+"#to_ary gives "+V.$$class+")")},D.to_a=function(C){if(C.$$is_array)return C.slice();if(!C["$respond_to?"]("to_a",!0))return[C];var V=C.$to_a();return V===ye?[C]:V.$$is_array?V:void Y(D.TypeError,"Can't convert "+C.$$class+" to Array ("+C.$$class+"#to_a gives "+V.$$class+")")},D.extract_kwargs=function(C){var V=C[C.length-1];if(null!=V&&D.respond_to(V,"$to_hash",!0))return K(C,C.length-1),V},D.kwrestargs=function(C,V){var Fe,$e=[],Te={},Ue=C.$$smap;for(Fe in Ue)V[Fe]||($e.push(Fe),Te[Fe]=Ue[Fe]);return D.hash2($e,Te)};var fe={};function Pe(C){return fe[C]||(fe[C]="$"+C)}function be(C){return"function"==typeof C&&!C.$$stub}D.jsid=Pe,D.send=function(C,V,$e,Te,Fe){var Ue;return"function"==typeof V?(Ue=V,V=null):"string"==typeof V?Ue=C[Pe(V)]:Y(D.NameError,"Passed method should be a string or a function"),D.send2(C,Ue,V,$e,Te,Fe)},D.send2=function(C,V,$e,Te,Fe,Ue){return null==V&&null!=$e&&C.$method_missing&&(V=C.$method_missing,Te=[$e].concat(Te)),Ae(Fe,Ue),"function"==typeof Fe&&(V.$$p=Fe),V.apply(C,Te)},D.refined_send=function(C,V,$e,Te,Fe,Ue){var Ze,lt,Et,It,hn,nn,Bn,Ln,ar,Hs;for(It=De(V),Ze=0;Ze<It.length;Ze++)for(hn=D.id(It[Ze]),lt=0;lt<C.length;lt++)for(Et=(nn=C[lt]).length-1;Et>=0;Et--)if(void 0!==(Bn=nn[Et]).$$refine_modules&&void 0!==(Ln=Bn.$$refine_modules)[hn]&&void 0!==(ar=Ln[hn]).$$prototype[Pe($e)])return Hs=ar.$$prototype[Pe($e)],D.send2(V,Hs,$e,Te,Fe,Ue);return D.send(V,$e,Te,Fe,Ue)},D.lambda=function(C,V){return C.$$is_lambda=!0,Ae(C,V),C},D.def=function(C,V,$e,Te){return Ae($e,Te),C===D.top?D.defn(D.Object,V,$e):!C.$$eval&&C.$$is_a_module?D.defn(C,V,$e):D.defs(C,V,$e)},D.defn=function(C,V,$e){pe(C),$e.displayName=V,$e.$$owner=C;var Te=V.substr(1),Fe=C.$$prototype;if(Fe.hasOwnProperty("$$dummy")&&(Fe=Fe.$$define_methods_on),Q(Fe,V,$e),C.$$is_module){C.$$module_function&&D.defs(C,V,$e);for(var Ue=0,Ze=C.$$iclasses,lt=Ze.length;Ue<lt;Ue++)Q(Ze[Ue],V,$e)}var It=C.$$singleton_of;return!C.$method_added||C.$method_added.$$stub||It?It&&It.$singleton_method_added&&!It.$singleton_method_added.$$stub&&It.$singleton_method_added(Te):C.$method_added(Te),Te},D.defs=function(C,V,$e,Te){return Ae($e,Te),(C.$$is_string||C.$$is_number)&&Y(D.TypeError,"can't define singleton"),D.defn(D.get_singleton_class(C),V,$e)},D.rdef=function(C,V){F(C.$$prototype,V)||Y(D.NameError,"method '"+V.substr(1)+"' not defined in "+C.$name()),delete C.$$prototype[V],C.$$is_singleton?C.$$prototype.$singleton_method_removed&&!C.$$prototype.$singleton_method_removed.$$stub&&C.$$prototype.$singleton_method_removed(V.substr(1)):C.$method_removed&&!C.$method_removed.$$stub&&C.$method_removed(V.substr(1))},D.udef=function(C,V){(!C.$$prototype[V]||C.$$prototype[V].$$stub)&&Y(D.NameError,"method '"+V.substr(1)+"' not defined in "+C.$name()),D.add_stub_for(C.$$prototype,V),C.$$is_singleton?C.$$prototype.$singleton_method_undefined&&!C.$$prototype.$singleton_method_undefined.$$stub&&C.$$prototype.$singleton_method_undefined(V.substr(1)):C.$method_undefined&&!C.$method_undefined.$$stub&&C.$method_undefined(V.substr(1))},D.alias=function(C,V,$e){var Ue,Ze,Te=Pe(V),Fe=Pe($e);if(void 0===C.$$prototype&&(C=D.Object),Ue=C.$$prototype[Fe],C.$$eval)return D.alias(D.get_singleton_class(C),V,$e);if(!be(Ue)){for(var lt=C.$$super;"function"!=typeof Ue&&lt;)Ue=lt[Fe],lt=lt.$$super;!be(Ue)&&C.$$is_module&&(Ue=D.Object.$$prototype[Fe]),be(Ue)||Y(D.NameError,"undefined method `"+$e+"' for class `"+C.$name()+"'")}Ue.$$alias_of&&(Ue=Ue.$$alias_of),Ze=function(){var It,hn,nn,Et=Ze.$$p;for(It=new Array(arguments.length),hn=0,nn=arguments.length;hn<nn;hn++)It[hn]=arguments[hn];return Ze.$$p=null,D.send(this,Ue,It,Et)};try{Object.defineProperty(Ze,"length",{value:Ue.length})}catch(Et){}return Ze.displayName=V,Ze.$$arity=null==Ue.$$arity?Ue.length:Ue.$$arity,Ze.$$parameters=Ue.$$parameters,Ze.$$source_location=Ue.$$source_location,Ze.$$alias_of=Ue,Ze.$$alias_name=V,D.defn(C,Te,Ze),C},D.alias_gvar=function(C,V){return Object.defineProperty(q,C,{configurable:!0,enumerable:!0,get:function(){return q[V]},set:function($e){q[V]=$e}}),ye},D.alias_native=function(C,V,$e){var Te=Pe(V),Fe=C.$$prototype[$e];return("function"!=typeof Fe||Fe.$$stub)&&Y(D.NameError,"undefined native method `"+$e+"' for class `"+C.$name()+"'"),D.defn(C,Te,Fe),C},D.hash_init=function(C){C.$$smap=Object.create(null),C.$$map=Object.create(null),C.$$keys=[]},D.hash_clone=function(C,V){V.$$none=C.$$none,V.$$proc=C.$$proc;for(var Ze,lt,$e=0,Te=C.$$keys,Fe=C.$$smap,Ue=Te.length;$e<Ue;$e++)(Ze=Te[$e]).$$is_string?lt=Fe[Ze]:(lt=Ze.value,Ze=Ze.key),D.hash_put(V,Ze,lt)},D.hash_put=function(C,V,$e){if(V.$$is_string)return F(C.$$smap,V)||C.$$keys.push(V),void(C.$$smap[V]=$e);var Te,Fe,Ue;if(Te=C.$$by_identity?D.id(V):V.$hash(),!F(C.$$map,Te))return C.$$keys.push(Fe={key:V,key_hash:Te,value:$e}),void(C.$$map[Te]=Fe);for(Fe=C.$$map[Te];Fe;){if(V===Fe.key||V["$eql?"](Fe.key)){Ue=void 0,Fe.value=$e;break}Ue=Fe,Fe=Fe.next}Ue&&(C.$$keys.push(Fe={key:V,key_hash:Te,value:$e}),Ue.next=Fe)},D.hash_get=function(C,V){if(V.$$is_string)return F(C.$$smap,V)?C.$$smap[V]:void 0;var $e,Te;if($e=C.$$by_identity?D.id(V):V.$hash(),F(C.$$map,$e))for(Te=C.$$map[$e];Te;){if(V===Te.key||V["$eql?"](Te.key))return Te.value;Te=Te.next}},D.hash_delete=function(C,V){var $e,Ue,Ze,Te=C.$$keys,Fe=Te.length;if(V.$$is_string){if("string"!=typeof V&&(V=V.valueOf()),!F(C.$$smap,V))return;for($e=0;$e<Fe;$e++)if((Ze=Te[$e]).$$is_string&&"string"!=typeof Ze&&(Ze=Ze.valueOf()),Ze===V){Te.splice($e,1);break}return Ue=C.$$smap[V],delete C.$$smap[V],Ue}var lt=V.$hash();if(F(C.$$map,lt))for(var It,Et=C.$$map[lt];Et;){if(V===Et.key||V["$eql?"](Et.key)){for(Ue=Et.value,$e=0;$e<Fe;$e++)if(Te[$e]===Et){Te.splice($e,1);break}return It&&Et.next?It.next=Et.next:It?delete It.next:Et.next?C.$$map[lt]=Et.next:delete C.$$map[lt],Ue}It=Et,Et=Et.next}},D.hash_rehash=function(C){for(var Te,Fe,Ue,V=0,$e=C.$$keys.length;V<$e;V++)if(!C.$$keys[V].$$is_string&&(Te=C.$$keys[V].key.$hash())!==C.$$keys[V].key_hash){for(Fe=C.$$map[C.$$keys[V].key_hash],Ue=void 0;Fe;){if(Fe===C.$$keys[V]){Ue&&Fe.next?Ue.next=Fe.next:Ue?delete Ue.next:Fe.next?C.$$map[C.$$keys[V].key_hash]=Fe.next:delete C.$$map[C.$$keys[V].key_hash];break}Ue=Fe,Fe=Fe.next}if(C.$$keys[V].key_hash=Te,!F(C.$$map,Te)){C.$$map[Te]=C.$$keys[V];continue}for(Fe=C.$$map[Te],Ue=void 0;Fe;){if(Fe===C.$$keys[V]){Ue=void 0;break}Ue=Fe,Fe=Fe.next}Ue&&(Ue.next=C.$$keys[V])}},D.hash=function(){var V,$e,Te,Fe,Ue,C=arguments.length;if(1===C&&arguments[0].$$is_hash)return arguments[0];if($e=new D.Hash,D.hash_init($e),1===C){if(V=arguments[0],arguments[0].$$is_array){for(Fe=V.length,Te=0;Te<Fe;Te++)2!==V[Te].length&&Y(D.ArgumentError,"value not of length 2: "+V[Te].$inspect()),D.hash_put($e,Ue=V[Te][0],V[Te][1]);return $e}for(Ue in V=arguments[0])F(V,Ue)&&D.hash_put($e,Ue,V[Ue]);return $e}for(C%2!=0&&Y(D.ArgumentError,"odd number of arguments for Hash"),Te=0;Te<C;Te+=2)D.hash_put($e,Ue=arguments[Te],arguments[Te+1]);return $e},D.hash2=function(C,V){var $e=new D.Hash;return $e.$$smap=V,$e.$$map=Object.create(null),$e.$$keys=C,$e},D.range=function(C,V,$e){var Te=new D.Range;return Te.begin=C,Te.end=V,Te.excl=$e,Te};var xe=["constructor","displayName","__count__","__noSuchMethod__","__parent__","__proto__","hasOwnProperty","valueOf"];function pe(C){C.$$frozen&&Y(D.FrozenError,"can't modify frozen "+C.$class()+": "+C,D.hash2(["receiver"],{receiver:C}))}function Me(C,V){return"number"==typeof C&&"number"==typeof V}function Ce(C,V){return"number"==typeof C&&"number"==typeof V||"string"==typeof C&&"string"==typeof V}function he(C){return function(){return C}}D.ivar=function(C){return-1!==xe.indexOf(C)&&(C+="$"),C},D.deny_frozen_access=pe,D.freeze=function(C){return Q(C,"$$frozen",!0),C.hasOwnProperty("$$id")||Q(C,"$$id",le()),C.hasOwnProperty("$$meta")?C.$$meta.$freeze():Q(C,"$$meta",null),C.hasOwnProperty("$$comparable")||Q(C,"$$comparable",null),Object.seal(C),C},D.freeze_props=function(C){var V,$e,Te;for(V in C)("string"!=($e=typeof V)&&"object"!==$e||"$"!==V[0])&&(Te=Object.getOwnPropertyDescriptor(C,V))&&Te.enumerable&&Te.writable&&function(){var Fe=C[V];Object.defineProperty(C,V,{get:function(){return Fe},set:function(Ue){pe(C)},enumerable:!0})}()},D.escape_regexp=function(C){return C.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},D.global_regexp=function(C){return C.global?C:(null==C.$$g?C.$$g=new RegExp(C.source,(C.multiline?"gm":"g")+(C.ignoreCase?"i":"")):C.$$g.lastIndex=null,C.$$g)},D.global_multiline_regexp=function(C){var V,$e;return C.global&&C.multiline?C:($e="gm"+(C.ignoreCase?"i":""),C.multiline?(null==C.$$g&&(C.$$g=new RegExp(C.source,$e)),V=C.$$g):(null==C.$$gm&&(C.$$gm=new RegExp(C.source,$e)),V=C.$$gm),V.lastIndex=null,V)},D.regexp=function(C,V){for(var $e,Te=void 0!==V&&V&&V.indexOf("i")>=0,Fe=0,Ue=C.length;Fe<Ue;Fe++)($e=C[Fe])instanceof RegExp&&($e.ignoreCase!==Te&&D.Kernel.$warn("ignore case doesn't match for "+$e.source.$inspect(),D.hash({uplevel:1})),$e=$e.source),""===$e&&($e="(?:"+$e+")"),C[Fe]=$e;return V?new RegExp(C.join(""),V):new RegExp(C.join(""))},D.modules={},D.loaded_features=["corelib/runtime"],D.current_dir=".",D.require_table={"corelib/runtime":!0},D.normalize=function(C){var V,$e,Te=[];"."!==D.current_dir&&(C=D.current_dir.replace(/\/*$/,"/")+C);for(var Ue=0,Ze=(V=(C=(C=C.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;Ue<Ze;Ue++)""!==($e=V[Ue])&&(".."===$e?Te.pop():Te.push($e));return Te.join("/")},D.loaded=function(C){var V,$e,Te;for(V=0,$e=C.length;V<$e;V++)Te=D.normalize(C[V]),!D.require_table[Te]&&(D.loaded_features.push(Te),D.require_table[Te]=!0)},D.load_normalized=function(C){D.loaded([C]);var V=D.modules[C];if(V){var $e=V(D);if("undefined"!=typeof Promise&&$e instanceof Promise)return $e.then(he(!0))}else{var Te=D.config.missing_require_severity,Fe="cannot load such file -- "+C;"error"===Te?Y(D.LoadError,Fe):"warning"===Te&&de.warn("WARNING: LoadError: "+Fe)}return!0},D.load=function(C){return C=D.normalize(C),D.load_normalized(C)},D.require=function(C){return C=D.normalize(C),!D.require_table[C]&&D.load_normalized(C)},D.encodings=Object.create(null),D.set_encoding=function(C,V,$e){void 0===$e&&($e="encoding"),("string"==typeof C||!0===C.$$frozen)&&Y(D.FrozenError,"can't modify frozen String");var Te=D.find_encoding(V);return Te===C[$e]||(C[$e]=Te),C},D.find_encoding=function(C){var V=D.encodings,$e=V[C]||V[C.toUpperCase()];return $e||Y(D.ArgumentError,"unknown encoding name - "+C),$e},D.enc=function(C,V){var $e=new String(C);return($e=D.set_encoding($e,V)).internal_encoding=$e.encoding,$e},D.binary=function(C){var V=new String(C);return D.set_encoding(V,"binary","internal_encoding")},D.last_promise=null,D.promise_unhandled_exception=!1,D.queue=function(C){if(D.last_promise)return D.last_promise=D.last_promise.then(function(){if(!D.promise_unhandled_exception)return C(D)}).catch(function($e){D.respond_to($e,"$full_message")&&($e=$e.$full_message()),de.error($e),D.promise_unhandled_exception=!0,D.exit(1)}),D.last_promise;var V=C(D);return"function"==typeof Promise&&"object"==typeof V&&V instanceof Promise&&(D.last_promise=V),V},D.rb_plus=function(C,V){return Me(C,V)?C+V:C["$+"](V)},D.rb_minus=function(C,V){return Me(C,V)?C-V:C["$-"](V)},D.rb_times=function(C,V){return Me(C,V)?C*V:C["$*"](V)},D.rb_divide=function(C,V){return Me(C,V)?C/V:C["$/"](V)},D.rb_lt=function(C,V){return Me(C,V)?C<V:C["$<"](V)},D.rb_gt=function(C,V){return Me(C,V)?C>V:C["$>"](V)},D.rb_le=function(C,V){return Me(C,V)?C<=V:C["$<="](V)},D.rb_ge=function(C,V){return Me(C,V)?C>=V:C["$>="](V)},D.eqeq=function ae(C,V){return Ce(C,V)?C===V:k(C["$=="](V))},D.eqeqeq=function(C,V){return Ce(C,V)?C===V:k(C["$==="](V))},D.neqeq=function(C,V){return Ce(C,V)?C!==V:k(C["$!="](V))},D.not=function(C){return null==C||!1===C||ye===C||!0!==C&&!C["$!"].$$pristine&&k(C["$!"]())},D.return_val=he,D.return_self=function(){return this},D.return_ivar=function(C){return function(){return null==this[C]?ye:this[C]}},D.assign_ivar=function(C){return function(V){return pe(this),this[C]=V}},D.assign_ivar_val=function(C,V){return function(){return pe(this),this[C]=V}},D.ensure_kwargs=function(C){return null==C?D.hash2([],{}):C.$$is_hash?C:void Y(D.ArgumentError,"expected kwargs")},D.get_kwarg=function(C,V){return F(C.$$smap,V)||Y(D.ArgumentError,"missing keyword: "+V),C.$$smap[V]},D.large_array_unpack=function(C){var Te,V=C.split(","),$e=V.length;for(Te=0;Te<$e;Te++)switch(V[Te][0]){case void 0:V[Te]=ye;break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":V[Te]=+V[Te]}return V},D.BasicObject=f=ie("BasicObject",null),D.Object=T=ie("Object",D.BasicObject),D.Module=ne=ie("Module",D.Object),D.Class=v=ie("Class",D.Module),D.Opal=S=B("Opal"),D.Kernel=L=B("Kernel"),Z(D.BasicObject,D.Class.$$prototype),Z(D.Object,D.Class.$$prototype),Z(D.Module,D.Class.$$prototype),Z(D.Class,D.Class.$$prototype),f.$$const.BasicObject=f,z(T,"BasicObject",f),z(T,"Object",T),z(T,"Module",ne),z(T,"Class",v),z(T,"Opal",S),z(T,"Kernel",L),f.$$class=v,T.$$class=v,ne.$$class=v,v.$$class=v,S.$$class=ne,L.$$class=ne,Q(T.$$prototype,"toString",function(){var C=this.$to_s();return C.$$is_string&&"object"==typeof C?C.valueOf():C}),Q(T.$$prototype,"$require",D.require),D.top=new T,D.top.$to_s=D.top.$inspect=he("main"),D.top.$define_method=function Ee(){var C=X(arguments),V=Ee.$$p;return Ee.$$p=null,D.send(T,"define_method",C,V)},D.NilClass=ie("NilClass",D.Object),z(T,"NilClass",D.NilClass),(ye=D.nil=new D.NilClass).$$id=4,ye.call=ye.apply=function(){Y(D.LocalJumpError,"no block given")},ye.$$frozen=!0,ye.$$comparable=!1,Object.seal(ye),D.thrower=function(C){var V=new Error("unexpected "+C);return V.$thrower_type=C,V.$throw=function($e){throw null==$e&&($e=ye),V.$v=$e,V},V},D.t_eval_return=D.thrower("return"),TypeError.$$super=Error,D.file_sources={}}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(E){var de=E.type_error,ye=E.coerce_to,f=E.module,T=E.defs,ne=E.slice,v=E.eqeqeq,S=E.Kernel,L=E.truthy,D=E.Opal,J=E.nil,j=E.$$$;return function(F){var Z=f("::","Opal");T(Z,"$bridge",function(P,H){return E.bridge(P,H)}),T(Z,"$coerce_to!",function(P,H,le,q){var Y,k=J;return Y=ne(arguments,3),k=ye(P,H,le,Y),v(H,k)||S.$raise(de(P,H,le,k)),k},-4),T(Z,"$coerce_to?",function(P,H,le,q){var Q,k=J;return Q=ne(arguments,3),!L(P["$respond_to?"](le))||(k=ye(P,H,le,Q),L(k["$nil?"]()))?J:(v(H,k)||S.$raise(de(P,H,le,k)),k)},-4),T(Z,"$try_convert",function(P,H,le){return v(H,P)?P:L(P["$respond_to?"](le))?P.$__send__(le):J}),T(Z,"$compare",function(P,H){var le;return le=P["$<=>"](H),L(le===J)&&S.$raise(j("ArgumentError"),"comparison of "+P.$class()+" with "+H.$class()+" failed"),le}),T(Z,"$destructure",function(P){if(1==P.length)return P[0];if(P.$$is_array)return P;for(var H=new Array(P.length),le=0,q=H.length;le<q;le++)H[le]=P[le];return H}),T(Z,"$respond_to?",function(P,H,le){return null==le&&(le=!1),!(null==P||!P.$$class)&&P["$respond_to?"](H,le)},-3),T(Z,"$instance_variable_name!",function(P){return P=D["$coerce_to!"](P,j("String"),"to_str"),L(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(P))||S.$raise(j("NameError").$new("'"+P+"' is not allowed as an instance variable name",P)),P}),T(Z,"$class_variable_name!",function(P){return P=D["$coerce_to!"](P,j("String"),"to_str"),L(P.length<3||"@@"!==P.slice(0,2))&&S.$raise(j("NameError").$new("`"+P+"' is not allowed as a class variable name",P)),P}),T(Z,"$const_name?",function(P){return"string"!=typeof P&&(P=D["$coerce_to!"](P,j("String"),"to_str")),P[0]===P[0].toUpperCase()}),T(Z,"$const_name!",function(P){return L(j("::","String","skip_raise")?"constant":J)&&(P=D["$coerce_to!"](P,j("String"),"to_str")),(!P||P[0]!=P[0].toUpperCase())&&this.$raise(j("NameError"),"wrong constant name "+P),P}),T(Z,"$pristine",function(P,H){for(var q,Q,k=(q=ne(arguments,1)).length-1;k>=0;k--)(Q=P.$$prototype[E.jsid(q[k])])&&!Q.$$stub&&(Q.$$pristine=!0);return J},-2);var X=[];return T(Z,"$inspect",function(P){var le=!1;return function(){try{try{return null===P?"null":void 0===P?"undefined":void 0===P.$$class?Object.prototype.toString.apply(P):"function"!=typeof P.$inspect||P.$inspect.$$stub||-1!==X.indexOf(P.$__id__())?"#<"+P.$$class+":0x"+P.$__id__().$to_s(16)+">":(X.push(P.$__id__()),le=!0,P.$inspect())}catch(q){if(!E.rescue(q,[j("Exception")]))throw q;try{return"#<"+P.$$class+":0x"+P.$__id__().$to_s(16)+">"}finally{E.pop_exception()}}}finally{le&&X.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(E){var l,c,h,d,de=E.truthy,ye=E.coerce_to,f=E.const_set,T=E.Object,ne=E.return_ivar,v=E.assign_ivar,S=E.ivar,L=E.deny_frozen_access,D=E.freeze,J=E.prop,j=E.jsid,F=E.klass,Z=E.defs,X=E.send,K=E.def,P=E.eqeqeq,H=E.Module,le=E.Kernel,q=E.rb_lt,Y=E.rb_gt,Q=E.slice,k=E.to_a,N=E.hash2,te=E.Opal,U=E.return_val,I=E.eqeq,A=E.lambda,y=E.range,R=E.send2,z=E.find_super,ie=E.alias,ge=E.nil,B=E.$$$;return l=[],c=F("::",null,"Module"),h=[c].concat(l),d=E.$r(h),Z(c,"$allocate",function(){var x=E.allocate_module(ge,function(){});return this!==E.Module&&Object.setPrototypeOf(x,this.$$prototype),x}),K(c,"$initialize",function p(){var m=p.$$p||ge;return p.$$p=null,m!==ge?X(this,"module_eval",[],m.$to_proc()):ge}),K(c,"$===",function(m){return!de(null==m)&&E.is_a(m,this)}),K(c,"$<",function(m){var re,se,De,x=this;if(P(H,m)||le.$raise(B("TypeError"),"compared with non class/module"),x===m)return!1;for(se=0,De=(re=E.ancestors(x)).length;se<De;se++)if(re[se]===m)return!0;for(se=0,De=(re=E.ancestors(m)).length;se<De;se++)if(re[se]===x)return!1;return ge}),K(c,"$<=",function(m){var $;return de($=this["$equal?"](m))?$:q(this,m)}),K(c,"$>",function(m){return P(H,m)||le.$raise(B("TypeError"),"compared with non class/module"),q(m,this)}),K(c,"$>=",function(m){var $;return de($=this["$equal?"](m))?$:Y(this,m)}),K(c,"$<=>",function(m){var $=ge;return this===m?0:!P(H,m)||($=q(this,m),de($["$nil?"]()))?ge:de($)?-1:1}),K(c,"$alias_method",function(m,x){var $=this;return L($),m=ye(m,B("String"),"to_str"),x=ye(x,B("String"),"to_str"),E.alias($,m,x),$}),K(c,"$alias_native",function(m,x){var $=this;return null==x&&(x=m),L($),E.alias_native($,m,x),$},-2),K(c,"$ancestors",function(){return E.ancestors(this)}),K(c,"$append_features",function(m){return L(m),E.append_features(this,m),this}),K(c,"$attr_accessor",function(m){var x,$,re=this;return x=Q(arguments),X(re,"attr_reader",k($=x)),X(re,"attr_writer",k($))},-1),K(c,"$attr",function(m){var $,re=this;return 2!=($=Q(arguments)).length||!0!==$[1]&&!1!==$[1]?X(re,"attr_reader",k($)):(re.$warn("optional boolean argument is obsoleted",N(["uplevel"],{uplevel:1})),$[1]?re.$attr_accessor($[0]):re.$attr_reader($[0]),ge)},-1),K(c,"$attr_reader",function(m){var $,re=this;$=Q(arguments),L(re);for(var se=re.$$prototype,De=$.length-1;De>=0;De--){var Ae=$[De],fe=j(Ae),Pe=S(Ae),be=ne(Pe);E.prop(se,Pe,ge),be.$$parameters=[],be.$$arity=0,E.defn(re,fe,be)}return ge},-1),K(c,"$attr_writer",function(m){var $,re=this;$=Q(arguments),L(re);for(var se=re.$$prototype,De=$.length-1;De>=0;De--){var Ae=$[De],fe=j(Ae+"="),Pe=S(Ae),be=v(Pe);be.$$parameters=[["req"]],be.$$arity=1,E.prop(se,Pe,ge),E.defn(re,fe,be)}return ge},-1),K(c,"$autoload",function(m,x){var $=this;return L($),d("Opal")["$const_name?"](m)||le.$raise(B("NameError"),"autoload must be constant name: "+m),""==x&&le.$raise(B("ArgumentError"),"empty file name"),$.$$const.hasOwnProperty(m)||($.$$autoload||($.$$autoload={}),E.const_cache_version++,$.$$autoload[m]={path:x,loaded:!1,required:!1,success:!1,exception:!1},$.$const_added&&!$.$const_added.$$pristine&&$.$const_added(m)),ge}),K(c,"$autoload?",function(m){var x=this;if(x.$$autoload&&x.$$autoload[m]&&!x.$$autoload[m].required&&!x.$$autoload[m].success)return x.$$autoload[m].path;for(var $=x.$ancestors(),re=0,se=$.length;re<se;re++)if($[re].$$autoload&&$[re].$$autoload[m]&&!$[re].$$autoload[m].required&&!$[re].$$autoload[m].success)return $[re].$$autoload[m].path;return ge}),K(c,"$class_variables",function(){return Object.keys(E.class_variables(this))}),K(c,"$class_variable_get",function(m){return m=te["$class_variable_name!"](m),E.class_variable_get(this,m,!1)}),K(c,"$class_variable_set",function(m,x){return L(this),m=te["$class_variable_name!"](m),E.class_variable_set(this,m,x)}),K(c,"$class_variable_defined?",function(m){return m=te["$class_variable_name!"](m),E.class_variables(this).hasOwnProperty(m)}),K(c,"$const_added",U(ge)),te.$pristine(c,"const_added"),K(c,"$remove_class_variable",function(m){var x=this;if(L(x),m=te["$class_variable_name!"](m),E.hasOwnProperty.call(x.$$cvars,m)){var $=x.$$cvars[m];return delete x.$$cvars[m],$}le.$raise(B("NameError"),"cannot remove "+m+" for "+x)}),K(c,"$constants",function(m){return null==m&&(m=!0),E.constants(this,m)},-1),Z(c,"$constants",function(m){if(null==m){var re,De,Ae,$=(this.$$nesting||[]).concat(T),se={};for(De=0,Ae=$.length;De<Ae;De++)for(re in $[De].$$const)se[re]=!0;return Object.keys(se)}return E.constants(this,m)},-1),Z(c,"$nesting",function(){return this.$$nesting||[]}),K(c,"$const_defined?",function(m,x){var $=this;null==x&&(x=!0),m=d("Opal")["$const_name!"](m),de(m["$=~"](B(te,"CONST_NAME_REGEXP")))||le.$raise(B("NameError").$new("wrong constant name "+m,m));var re,Ae,fe,se=[$];for(x&&(se=se.concat(E.ancestors($)),$.$$is_module&&(se=se.concat([T]).concat(E.ancestors(T)))),Ae=0,fe=se.length;Ae<fe;Ae++)if(null!=(re=se[Ae]).$$const[m]||re.$$autoload&&re.$$autoload[m]&&!re.$$autoload[m].required&&!re.$$autoload[m].success)return!0;return!1},-2),K(c,"$const_get",function(m,x){var $=this;return null==x&&(x=!0),0===(m=d("Opal")["$const_name!"](m)).indexOf("::")&&"::"!==m&&(m=m.slice(2)),de(-1!=m.indexOf("::")&&"::"!=m)?X(m.$split("::"),"inject",[$],function(se,De){return null==se&&(se=ge),null==De&&(De=ge),se.$const_get(De)}):(de(m["$=~"](B(te,"CONST_NAME_REGEXP")))||le.$raise(B("NameError").$new("wrong constant name "+m,m)),x?E.$$([$],m):E.const_get_local($,m))},-2),K(c,"$const_missing",function(m){var $;return $=I(this,T)?m:this+"::"+m,le.$raise(B("NameError").$new("uninitialized constant "+$,m))}),K(c,"$const_set",function(m,x){return L(this),m=te["$const_name!"](m),(de(m["$!~"](B(te,"CONST_NAME_REGEXP")))||de(m["$start_with?"]("::")))&&le.$raise(B("NameError").$new("wrong constant name "+m,m)),f(this,m,x),x}),K(c,"$public_constant",U(ge)),K(c,"$define_method",function p(m,x){var se,$=p.$$p||ge,De=ge;return p.$$p=null,L(this),void 0===x&&$===ge&&le.$raise(B("ArgumentError"),"tried to create a Proc object without a block"),$=de(se=$)?se:P(B("Proc"),De=x)?x:P(B("Method"),De)?x.$to_proc().$$unbound:P(B("UnboundMethod"),De)?A(function fe(Pe){var xe,pe=null==fe.$$s?this:fe.$$s,Me=ge;return xe=Q(arguments),Me=x.$bind(pe),X(Me,"call",k(xe))},{$$arity:-1,$$s:this}):le.$raise(B("TypeError"),"wrong argument type "+$.$class()+" (expected Proc/Method)"),"undefined"!=typeof Proxy&&($.$$proxy_target=$,$=new Proxy($,{apply:function(fe,Pe,be){var xe=fe.$$jsid;fe.$$jsid=m;try{return fe.apply(Pe,be)}catch(pe){if(pe===fe.$$brk||pe===fe.$$ret)return pe.$v;throw pe}finally{fe.$$jsid=xe}}})),$.$$jsid=m,$.$$s=null,$.$$def=$,$.$$define_meth=!0,E.defn(this,j(m),$)},-2),K(c,"$freeze",function(){var m=this;return de(m["$frozen?"]())?m:(m.hasOwnProperty("$$base_module")||J(m,"$$base_module",null),D(m))}),K(c,"$remove_method",function(m){var $,re=this;$=Q(arguments);for(var se=0;se<$.length;se++){var De=$[se];"string"==typeof De||De.$$is_string||re.$raise(B("TypeError"),re.$name()+" is not a symbol nor a string"),L(re),E.rdef(re,"$"+De)}return re},-1),K(c,"$singleton_class?",function(){return!!this.$$is_singleton}),K(c,"$include",function(m){for(var $,re=this,se=($=Q(arguments)).length-1;se>=0;se--){var De=$[se];De.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+De.$class()+" (expected Module)"),De.$append_features(re),De.$included(re)}return re},-1),K(c,"$included_modules",function(){return E.included_modules(this)}),K(c,"$include?",function(m){m.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+m.$class()+" (expected Module)");var $,re,se,De=E.ancestors(this);for($=0,re=De.length;$<re;$++)if((se=De[$])===m&&se!==this)return!0;return!1}),K(c,"$instance_method",function(m){var x=this,$=x.$$prototype[j(m)];return(!$||$.$$stub)&&le.$raise(B("NameError").$new("undefined method `"+m+"' for class `"+x.$name()+"'",m)),B("UnboundMethod").$new(x,$.$$owner||x,$,m)}),K(c,"$instance_methods",function(m){return null==m&&(m=!0),de(m)?E.instance_methods(this):E.own_instance_methods(this)},-1),K(c,"$included",U(ge)),K(c,"$extended",U(ge)),K(c,"$extend_object",function(m){return L(m),ge}),K(c,"$method_added",function(m){return Q(arguments),ge},-1),K(c,"$method_removed",function(m){return Q(arguments),ge},-1),K(c,"$method_undefined",function(m){return Q(arguments),ge},-1),K(c,"$module_eval",function p(m){var re,se,x=p.$$p||ge,De=this,Ae=ge,be=ge,xe=ge,pe=ge,Me=ge;p.$$p=null,re=Q(arguments),de(x["$nil?"]())&&de(!!E.compile)?(de(y(1,3,!1)["$cover?"](re.$size()))||le.$raise(B("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Ae=null==(se=[].concat(k(re)))[0]?ge:se[0],be=N(["file","eval"],{file:de(xe=null==se[1]?ge:se[1])?xe:"(eval)",eval:!0}),pe=E.hash({arity_check:!1}).$merge(be),Me=te.$compile(Ae,pe),x=X(le,"proc",[],function he(){var Ee=null==he.$$s?this:he.$$s;return new Function("Opal,self","return "+Me)(E,Ee)},{$$s:De})):de(re["$any?"]())&&le.$raise(B("ArgumentError"),"wrong number of arguments ("+re.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var ae,Ce=x.$$s;return x.$$s=null,ae=x.apply(De,[De]),x.$$s=Ce,ae},-1),K(c,"$module_exec",function p(m){var re,x=p.$$p||ge,se=this;p.$$p=null,re=Q(arguments),x===ge&&le.$raise(B("LocalJumpError"),"no block given");var Ae,De=x.$$s;return x.$$s=null,Ae=x.apply(se,re),x.$$s=De,Ae},-1),K(c,"$method_defined?",function(m){var $=this.$$prototype[j(m)];return!!$&&!$.$$stub}),K(c,"$module_function",function(m){var $,re=this;if($=Q(arguments),L(re),0===$.length)return re.$$module_function=!0,ge;for(var se=0,De=$.length;se<De;se++){var Ae=$[se],fe=j(Ae),Pe=re.$$prototype[fe];E.defs(re,fe,Pe)}return 1===$.length?$[0]:$},-1),K(c,"$name",function(){var m=this;if(m.$$full_name)return m.$$full_name;for(var x=[],$=m;$;){if($.$$name===ge||null==$.$$name)return ge;if(x.unshift($.$$name),($=$.$$base_module)===T)break}return 0===x.length?ge:m.$$full_name=x.join("::")}),K(c,"$prepend",function(m){var $,re=this;0===($=Q(arguments)).length&&le.$raise(B("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var se=$.length-1;se>=0;se--){var De=$[se];De.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+De.$class()+" (expected Module)"),De.$prepend_features(re),De.$prepended(re)}return re},-1),K(c,"$prepend_features",function(m){var x=this;return L(m),x.$$is_module||le.$raise(B("TypeError"),"wrong argument type "+x.$class()+" (expected Module)"),E.prepend_features(x,m),x}),K(c,"$prepended",U(ge)),K(c,"$remove_const",function(m){return L(this),E.const_remove(this,m)}),K(c,"$to_s",function(){var x,m=this;return de(x=E.Module.$name.call(m))?x:"#<"+(m.$$is_module?"Module":"Class")+":0x"+m.$__id__().$to_s(16)+">"}),K(c,"$undef_method",function(m){var $,re=this;$=Q(arguments);for(var se=0;se<$.length;se++){var De=$[se];"string"==typeof De||De.$$is_string||re.$raise(B("TypeError"),re.$name()+" is not a symbol nor a string"),L(re),E.udef(re,"$"+$[se])}return re},-1),K(c,"$instance_variables",function(){var m=this,x=ge;E.Module.$$nesting=h,x=m.$constants();var $=[];for(var re in m)m.hasOwnProperty(re)&&"$"!==re.charAt(0)&&"constructor"!==re&&!x["$include?"](re)&&$.push("@"+re);return $}),K(c,"$dup",function p(){var m=p.$$p||ge,x=this,$=ge;return p.$$p=null,($=R(x,z(x,"dup",p,!1,!0),"dup",[],m)).$copy_class_variables(x),$.$copy_constants(x),$}),K(c,"$copy_class_variables",function(m){for(var $ in m.$$cvars)this.$$cvars[$]=m.$$cvars[$]}),K(c,"$copy_constants",function(m){var $,re=m.$$const;for($ in re)f(this,$,re[$])}),K(c,"$refine",function p(m){var $,se,Ae,x=p.$$p||ge,re=this,De=ge;return p.$$p=null,se=($=[re,ge,ge])[0],De=$[1],Ae=E.id(m),void 0===re.$$refine_modules&&(re.$$refine_modules=Object.create(null)),(De=void 0===re.$$refine_modules[Ae]?re.$$refine_modules[Ae]=B("Refinement").$new():re.$$refine_modules[Ae]).refinement_module=se,De.refined_class=m,X(De,"class_exec",[],x.$to_proc()),De}),K(c,"$refinements",function(){var x=this.$$refine_modules,$=N([],{});if(void 0===x)return $;for(var re in x)$["$[]="](x[re].refined_class,x[re]);return $}),K(c,"$using",function(m){return le.$raise("Module#using is not permitted in methods")}),ie(c,"class_eval","module_eval"),ie(c,"class_exec","module_exec"),ie(c,"inspect","to_s"),function(O,_){var l=F("::",_,"Refinement"),c=l.$$prototype;return c.refinement_module=c.refined_class=ge,l.$attr_reader("refined_class"),K(l,"$inspect",function h(){var d=h.$$p||ge,p=this;return h.$$p=null,de(p.refinement_module)?"#<refinement:"+p.refined_class.$inspect()+"@"+p.refinement_module.$inspect()+">":R(p,z(p,"inspect",h,!1,!0),"inspect",[],d)})}(0,H)},Opal.modules["corelib/class"]=function(E){var le,q,Y,Q,de=E.klass,ye=E.send,f=E.defs,T=E.def,ne=E.rb_plus,v=E.return_val,S=E.slice,L=E.send2,D=E.find_super,J=E.Kernel,j=E.alias,X=E.nil,K=E.$$$;return E.top.$require("corelib/module"),le=[],Y=[q=de("::",null,"Class")].concat(le),Q=E.$r(Y),f(q,"$new",function k(N){var te=k.$$p||X;if(k.$$p=null,null==N&&(N=Q("Object")),!N.$$is_class)throw E.TypeError.$new("superclass must be a Class");var U=E.allocate_class(X,N);return N.$inherited(U),te!==X&&ye(U,"class_eval",[],te.$to_proc()),U},-1),T(q,"$allocate",function(){var te=new this.$$constructor;return te.$$id=E.uid(),te}),T(q,"$descendants",function(){return ne(this.$subclasses(),ye(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())}),T(q,"$inherited",v(X)),T(q,"$initialize_dup",function(N){this.$initialize_copy(N),this.$$name=null,this.$$full_name=null}),T(q,"$new",function k(N){var I,te=k.$$p||X,A=this;k.$$p=null,I=S(arguments);var y=A.$allocate();return E.send(y,y.$initialize,I,te),y},-1),T(q,"$subclasses",function(){var N=this;if("undefined"!=typeof WeakRef){var te,U,I=[];for(te=0;te<N.$$subclasses.length;te++)void 0!==(U=N.$$subclasses[te].deref())&&I.push(U);return I}return N.$$subclasses}),T(q,"$superclass",function(){return this.$$super||X}),T(q,"$to_s",function k(){k.$$p=null;var U=this.$$singleton_of;return U&&U.$$is_a_module?"#<Class:"+U.$name()+">":U?"#<Class:#<"+U.$$class.$name()+":0x"+E.id(U).$to_s(16)+">>":L(this,D(this,"to_s",k,!1,!0),"to_s",[],null)}),T(q,"$attached_object",function(){var N=this;if(null!=N.$$singleton_of)return N.$$singleton_of;J.$raise(K("TypeError"),"`"+N+"' is not a singleton class")}),j(q,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(E){"use strict";var q,ye=E.slice,f=E.def,T=E.alias,ne=E.return_val,v=E.Opal,S=E.truthy,L=E.range,D=E.Kernel,J=E.to_a,j=E.hash2,F=E.send,Z=E.eqeq,X=E.rb_ge,K=E.nil,P=E.$$$;return f(q=(0,E.klass)("::",null,"BasicObject"),"$initialize",function(Q){return ye(arguments),K},-1),f(q,"$==",function(Q){return this===Q}),f(q,"$eql?",function(Q){return this["$=="](Q)}),T(q,"equal?","=="),f(q,"$__id__",function(){var Q=this;return null!=Q.$$id||E.prop(Q,"$$id",E.uid()),Q.$$id}),f(q,"$__send__",function Y(Q,k){var U,N=Y.$$p||K,I=this;Y.$$p=null,U=ye(arguments,1),Q.$$is_string||I.$raise(P("TypeError"),I.$inspect()+" is not a symbol nor a string");var A=I[E.jsid(Q)];return A?(N!==K&&(A.$$p=N),A.apply(I,U)):(N!==K&&(I.$method_missing.$$p=N),I.$method_missing.apply(I,[Q].concat(U)))},-2),f(q,"$!",ne(!1)),v.$pristine("!"),f(q,"$!=",function(Q){return this["$=="](Q)["$!"]()}),f(q,"$instance_eval",function Y(Q){var te,U,k=Y.$$p||K,I=this,A=K,z=K,ie=K,M=K,ge=K;if(Y.$$p=null,te=ye(arguments),S(k["$nil?"]())&&S(!!E.compile))S(L(1,3,!1)["$cover?"](te.$size()))||D.$raise(P("ArgumentError"),"wrong number of arguments (0 for 1..3)"),A=null==(U=[].concat(J(te)))[0]?K:U[0],z=j(["file","eval"],{file:S(ie=null==U[1]?K:U[1])?ie:"(eval)",eval:!0}),M=E.hash({arity_check:!1}).$merge(z),ge=v.$compile(A,M),k=F(D,"proc",[],function _(){var l=null==_.$$s?this:_.$$s;return new Function("Opal,self","return "+ge)(E,l)},{$$s:I});else{if(S(k["$nil?"]())&&S(X(te.$length(),1))&&Z(te.$first()["$[]"](0),"@"))return I.$instance_variable_get(te.$first());S(te["$any?"]())&&D.$raise(P("ArgumentError"),"wrong number of arguments ("+te.$size()+" for 0)")}var O,B=k.$$s;if(k.$$s=null,I.$$is_a_module){I.$$eval=!0;try{O=k.call(I,I)}finally{I.$$eval=!1}}else O=k.call(I,I);return k.$$s=B,O},-1),f(q,"$instance_exec",function Y(Q){var te,k=Y.$$p||K,U=this;Y.$$p=null,te=ye(arguments),S(k)||D.$raise(P("ArgumentError"),"no block given");var A,I=k.$$s;if(k.$$s=null,U.$$is_a_module){U.$$eval=!0;try{A=k.apply(U,te)}finally{U.$$eval=!1}}else A=k.apply(U,te);return k.$$s=I,A},-1),f(q,"$singleton_method_added",function(Q){return ye(arguments),K},-1),f(q,"$singleton_method_removed",function(Q){return ye(arguments),K},-1),f(q,"$singleton_method_undefined",function(Q){return ye(arguments),K},-1),f(q,"$method_missing",function Y(Q,k){var U,I=this,A=K;return Y.$$p=null,U=ye(arguments,1),A=v.$inspect(I),D.$raise(P("NoMethodError").$new("undefined method `"+Q+"' for "+A,Q,U),K,D.$caller(1))},-2),v.$pristine(q,"method_missing"),f(q,"$respond_to_missing?",function(Q,k){return null==k&&(k=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(E){"use strict";var B,de=E.truthy,ye=E.coerce_to,f=E.respond_to,T=E.Opal,ne=E.deny_frozen_access,v=E.freeze,S=E.freeze_props,L=E.jsid,D=E.module,J=E.return_val,j=E.def,F=E.Kernel,Z=E.gvars,X=E.slice,K=E.send,P=E.to_a,H=E.ensure_kwargs,le=E.eqeq,q=E.hash2,Y=E.rb_plus,Q=E.eqeqeq,k=E.return_self,N=E.rb_le,te=E.extract_kwargs,U=E.rb_lt,I=E.Object,A=E.alias,y=E.klass,z=E.nil,ie=E.$$$;return function(M,ge){var B=D("::","Kernel"),O=[B].concat([]),_=E.$r(O);j(B,"$=~",J(!1)),j(B,"$!~",function(h){return this["$=~"](h)["$!"]()}),j(B,"$===",function(h){var p;return de(p=this.$object_id()["$=="](h.$object_id()))?p:this["$=="](h)}),j(B,"$<=>",function(h){this.$$comparable=!0;var p=this["$=="](h);return p&&p!==z?0:z}),j(B,"$method",function(h){var d=this,p=d[L(h)];return(!p||p.$$stub)&&F.$raise(ie("NameError").$new("undefined method `"+h+"' for class `"+d.$class()+"'",h)),ie("Method").$new(d,p.$$owner||d.$class(),p,h)}),j(B,"$methods",function(h){return null==h&&(h=!0),de(h)?E.methods(this):E.own_methods(this)},-1),j(B,"$public_methods",function(h){return null==h&&(h=!0),de(h)?E.methods(this):E.receiver_methods(this)},-1),j(B,"$Array",function(h){var d;return h===z?[]:h.$$is_array?h:(d=T["$coerce_to?"](h,ie("Array"),"to_ary"))!==z||(d=T["$coerce_to?"](h,ie("Array"),"to_a"))!==z?d:[h]}),j(B,"$at_exit",function c(){var d,h=c.$$p||z;return null==Z.__at_exit__&&(Z.__at_exit__=z),c.$$p=null,Z.__at_exit__=de(d=Z.__at_exit__)?d:[],Z.__at_exit__["$<<"](h),h}),j(B,"$caller",function(h,d){var p,m;null==h&&(h=1),null==d&&(d=z),m=[];for(var x=h+1,$=(p=(new Error).$backtrace()).length;x<$;x++)p[x].match(/runtime\.js/)||m.push(p[x]);return d!=z&&(m=m.slice(0,d)),m},-1),j(B,"$caller_locations",function(h){var d,m=this;return d=X(arguments),K(K(m,"caller",P(d)),"map",[],function($){return null==$&&($=z),ie(ie(ie("Thread"),"Backtrace"),"Location").$new($)})},-1),j(B,"$class",function(){return this.$$class}),j(B,"$copy_instance_variables",function(h){var m,x,$,p=Object.keys(h);for(m=0,x=p.length;m<x;m++)"$"!==($=p[m]).charAt(0)&&h.hasOwnProperty($)&&(this[$]=h[$])}),j(B,"$copy_singleton_methods",function(h){var p,m,x,$;if(h.hasOwnProperty("$$meta")&&null!==h.$$meta){var re=E.get_singleton_class(h),se=E.get_singleton_class(this);for(p=0,$=(x=Object.getOwnPropertyNames(re.$$prototype)).length;p<$;p++)E.is_method(m=x[p])&&(se.$$prototype[m]=re.$$prototype[m]);se.$$const=Object.assign({},re.$$const),Object.setPrototypeOf(se.$$prototype,Object.getPrototypeOf(re.$$prototype))}for(p=0,$=(x=Object.getOwnPropertyNames(h)).length;p<$;p++)"$"===(m=x[p]).charAt(0)&&"$"!==m.charAt(1)&&h.hasOwnProperty(m)&&(this[m]=h[m])}),j(B,"$clone",function(h){var d,p=this,m=z;return null==(d=(h=H(h)).$$smap.freeze)&&(d=z),de(d["$nil?"]())||le(d,!0)||le(d,!1)||p.$raise(_("ArgumentError"),"unexpected value for freeze: "+d.$class()),(m=p.$class().$allocate()).$copy_instance_variables(p),m.$copy_singleton_methods(p),m.$initialize_clone(p,q(["freeze"],{freeze:d})),(le(d,!0)||de(d["$nil?"]())&&de(p["$frozen?"]()))&&m.$freeze(),m},-1),j(B,"$initialize_clone",function(h,d){return d=H(d),this.$initialize_copy(h),this},-2),j(B,"$define_singleton_method",function c(h,d){var p=c.$$p||z;return c.$$p=null,K(this.$singleton_class(),"define_method",[h,d],p.$to_proc())},-2),j(B,"$dup",function(){var h=this,d=z;return(d=h.$class().$allocate()).$copy_instance_variables(h),d.$initialize_dup(h),d}),j(B,"$initialize_dup",function(h){return this.$initialize_copy(h)}),j(B,"$enum_for",function c(h,d){var m,x,$,p=c.$$p||z,re=this;return c.$$p=null,(m=X(arguments)).length>0&&(x=m.shift()),null==x&&(x="each"),$=m,K(ie("Enumerator"),"for",[re,x].concat(P($)),p.$to_proc())},-1),j(B,"$equal?",function(h){return this===h}),j(B,"$exit",function(h){var d;for(null==Z.__at_exit__&&(Z.__at_exit__=z),null==h&&(h=!0),Z.__at_exit__=de(d=Z.__at_exit__)?d:[];!de(Z.__at_exit__["$empty?"]());)Z.__at_exit__.$pop().$call();return h=h.$$is_boolean?h?0:1:ye(h,ie("Integer"),"to_int"),E.exit(h),z},-1),j(B,"$extend",function(h){var p,m=this;0==(p=X(arguments)).length&&m.$raise(ie("ArgumentError"),"wrong number of arguments (given 0, expected 1+)"),ne(m);for(var x=m.$singleton_class(),$=p.length-1;$>=0;$--){var re=p[$];re.$$is_module||F.$raise(ie("TypeError"),"wrong argument type "+re.$class()+" (expected Module)"),re.$append_features(x),re.$extend_object(m),re.$extended(m)}return m},-1),j(B,"$freeze",function(){var h=this;return de(h["$frozen?"]())?h:"object"==typeof h?(S(h),v(h)):h}),j(B,"$frozen?",function(){switch(typeof this){case"string":case"symbol":case"number":case"boolean":return!0;case"object":return this.$$frozen||!1;default:return!1}}),j(B,"$gets",function(h){var d;return null==Z.stdin&&(Z.stdin=z),d=X(arguments),K(Z.stdin,"gets",P(d))},-1),j(B,"$hash",function(){return this.$__id__()}),j(B,"$initialize_copy",J(z));var l=[];j(B,"$inspect",function(){var h=this,d=z,p=z,m=z;return function(){try{try{return d="",p=h.$__id__(),de(l["$include?"](p))?d=" ...":(l["$<<"](p),m=!0,K(h.$instance_variables(),"each",[],function $(re){var De,Ae;return null==re&&(re=z),De=(null==$.$$s?this:$.$$s).$instance_variable_get(re),Ae=_("Opal").$inspect(De),d=Y(d," "+re+"="+Ae)},{$$s:h})),"#<"+h.$class()+":0x"+p.$to_s(16)+d+">"}catch($){if(!E.rescue($,[_("StandardError")]))throw $;try{return"#<"+h.$class()+":0x"+p.$to_s(16)+">"}finally{E.pop_exception()}}}finally{de(m)&&l.$pop()}}()}),j(B,"$instance_of?",function(h){return!h.$$is_class&&!h.$$is_module&&F.$raise(ie("TypeError"),"class or module required"),this.$$class===h}),j(B,"$instance_variable_defined?",function(h){return h=T["$instance_variable_name!"](h),E.hasOwnProperty.call(this,h.substr(1))}),j(B,"$instance_variable_get",function(h){h=T["$instance_variable_name!"](h);var p=this[E.ivar(h.substr(1))];return null==p?z:p}),j(B,"$instance_variable_set",function(h,d){return ne(this),h=T["$instance_variable_name!"](h),this[E.ivar(h.substr(1))]=d}),j(B,"$remove_instance_variable",function(h){var d=this;h=T["$instance_variable_name!"](h);var m,p=E.ivar(h.substr(1));return d.hasOwnProperty(p)?(m=d[p],delete d[p],m):F.$raise(ie("NameError"),"instance variable "+h+" not defined")}),j(B,"$instance_variables",function(){var p,d=[];for(var m in this)this.hasOwnProperty(m)&&"$"!==m.charAt(0)&&(p="$"===m.substr(-1)?m.slice(0,m.length-1):m,d.push("@"+p));return d}),j(B,"$Integer",function(h,d){var p,m,x;return h.$$is_string?"0"===h?0:(void 0===d?d=0:(1===(d=ye(d,ie("Integer"),"to_int"))||d<0||d>36)&&F.$raise(ie("ArgumentError"),"invalid radix "+d),m=(m=(m=h.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function($,re,se){switch(se){case"0b":if(0===d||2===d)return d=2,re;case"0":case"0o":if(0===d||8===d)return d=8,re;case"0d":if(0===d||10===d)return d=10,re;case"0x":if(0===d||16===d)return d=16,re}F.$raise(ie("ArgumentError"),'invalid value for Integer(): "'+h+'"')}),x="0-"+((d=0===d?10:d)<=10?d-1:"9a-"+String.fromCharCode(d-11+97)),new RegExp("^\\s*[+-]?["+x+"]+\\s*$").test(m)||F.$raise(ie("ArgumentError"),'invalid value for Integer(): "'+h+'"'),p=parseInt(m,d),isNaN(p)&&F.$raise(ie("ArgumentError"),'invalid value for Integer(): "'+h+'"'),p):(void 0!==d&&F.$raise(ie("ArgumentError"),"base specified for non string value"),h===z&&F.$raise(ie("TypeError"),"can't convert nil into Integer"),h.$$is_number?((h===1/0||h===-1/0||isNaN(h))&&F.$raise(ie("FloatDomainError"),h),Math.floor(h)):h["$respond_to?"]("to_int")&&(p=h.$to_int())!==z?p:T["$coerce_to!"](h,ie("Integer"),"to_i"))},-2),j(B,"$Float",function(h){var d;return h===z&&F.$raise(ie("TypeError"),"can't convert nil into Float"),h.$$is_string?(d=(d=h.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(d)?F.$Integer(d):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(d)||F.$raise(ie("ArgumentError"),'invalid value for Float(): "'+h+'"'),parseFloat(d))):T["$coerce_to!"](h,ie("Float"),"to_f")}),j(B,"$Hash",function(h){return de(h["$nil?"]())||le(h,[])?q([],{}):Q(ie("Hash"),h)?h:T["$coerce_to!"](h,ie("Hash"),"to_hash")}),j(B,"$is_a?",function(h){return!h.$$is_class&&!h.$$is_module&&F.$raise(ie("TypeError"),"class or module required"),E.is_a(this,h)}),j(B,"$itself",k),j(B,"$lambda",function c(){var h=c.$$p||z;return c.$$p=null,E.lambda(h)}),j(B,"$load",function(h){return h=T["$coerce_to!"](h,ie("String"),"to_str"),E.load(h)}),j(B,"$loop",function c(){var h=c.$$p||z,p=z;if(c.$$p=null,h===z)return K(this,"enum_for",["loop"],function(){return ie(ie("Float"),"INFINITY")});for(;de(!0);)try{E.yieldX(h,[])}catch(m){if(!E.rescue(m,[ie("StopIteration")]))throw m;p=m;try{return p.$result()}finally{E.pop_exception()}}return this}),j(B,"$nil?",J(!1)),j(B,"$printf",function(h){var d,p,m=this;return d=X(arguments),de((p=d)["$any?"]())&&m.$print(K(m,"format",P(p))),z},-1),j(B,"$proc",function c(){var h=c.$$p||z;return c.$$p=null,de(h)||F.$raise(ie("ArgumentError"),"tried to create Proc object without a block"),h.$$is_lambda=!1,h}),j(B,"$puts",function(h){var d;return null==Z.stdout&&(Z.stdout=z),d=X(arguments),K(Z.stdout,"puts",P(d))},-1),j(B,"$p",function(h){var d,p;return d=X(arguments),K(p=d,"each",[],function(x){return null==Z.stdout&&(Z.stdout=z),null==x&&(x=z),Z.stdout.$puts(x.$inspect())}),de(N(p.$length(),1))?p["$[]"](0):p},-1),j(B,"$print",function(h){var d;return null==Z.stdout&&(Z.stdout=z),d=X(arguments),K(Z.stdout,"print",P(d))},-1),j(B,"$readline",function(h){var d;return null==Z.stdin&&(Z.stdin=z),d=X(arguments),K(Z.stdin,"readline",P(d))},-1),j(B,"$warn",function(h,d){var p,m,x,$,re,se,De=this,Ae=z;return null==Z.VERBOSE&&(Z.VERBOSE=z),null==Z.stderr&&(Z.stderr=z),p=X(arguments),m=te(p),x=p,null==($=(m=H(m)).$$smap.uplevel)&&($=z),de($)&&($=T["$coerce_to!"]($,ie("Integer"),"to_str"),de(U($,0))&&F.$raise(ie("ArgumentError"),"negative level ("+$+")"),re=(se=De.$caller(Y($,1),1).$first())===z||null==se?z:se.$split(":in `"),Ae=re===z||null==re?z:re.$first(),de(Ae)&&(Ae+=": "),x=K(x,"map",[],function(Pe){return null==Pe&&(Pe=z),Ae+"warning: "+Pe})),de(Z.VERBOSE["$nil?"]())||de(x["$empty?"]())?z:K(Z.stderr,"puts",P(x))},-1),j(B,"$raise",function(h,d,p){throw null==Z["!"]&&(Z["!"]=z),null==Z["@"]&&(Z["@"]=z),null==d&&(d=z),null==p&&(p=z),null==h&&Z["!"]!==z?Z["!"]:(null==h?h=ie("RuntimeError").$new(""):f(h,"$to_str")?h=ie("RuntimeError").$new(h.$to_str()):h.$$is_class&&f(h,"$exception")?h=h.$exception(d):h.$$is_exception||(h=ie("TypeError").$new("exception class/object expected")),p!==z&&h.$set_backtrace(p),Z["!"]!==z&&E.exceptions.push(Z["!"]),Z["!"]=h,Z["@"]=h.$backtrace(),h)},-1),j(B,"$rand",function(h){return void 0===h?ie(ie("Random"),"DEFAULT").$rand():(h.$$is_number&&(h<0&&(h=Math.abs(h)),h%1!=0&&(h=h.$to_i()),0===h&&(h=void 0)),ie(ie("Random"),"DEFAULT").$rand(h))},-1),j(B,"$respond_to?",function(h,d){var p=this;null==d&&(d=!1);var m=p[L(h)];return"function"==typeof m&&!m.$$stub||!0!==p["$respond_to_missing?"].$$pristine&&p["$respond_to_missing?"](h,d)},-2),j(B,"$respond_to_missing?",function(h,d){return null==d&&(d=!1),!1},-2),T.$pristine(B,"respond_to?","respond_to_missing?"),j(B,"$require",function(h){return"string"!=typeof h&&E.String&&E.Array&&(h=T["$coerce_to!"](h,ie("String"),"to_str")),E.require(h)}),j(B,"$require_relative",function(h){return T["$try_convert!"](h,ie("String"),"to_str"),h=ie("File").$expand_path(ie("File").$join(E.current_file,"..",h)),E.require(h)}),j(B,"$require_tree",function(h,d){var p;null==(p=(d=H(d)).$$smap.autoload)&&(p=!1);var m=[];for(var x in h=ie("File").$expand_path(h),"."===(h=E.normalize(h))&&(h=""),E.modules)x["$start_with?"](h)&&m.push(p?[x,!0]:[x,E.require(x)]);return m},-2),j(B,"$singleton_class",function(){return E.get_singleton_class(this)}),j(B,"$sleep",function(h){null==h&&(h=z),h===z&&F.$raise(ie("TypeError"),"can't convert NilClass into time interval"),h.$$is_number||F.$raise(ie("TypeError"),"can't convert "+h.$class()+" into time interval"),h<0&&F.$raise(ie("ArgumentError"),"time interval must be positive");for(var d=E.global.performance?function(){return performance.now()}:function(){return new Date},p=d();d()-p<=1e3*h;);return Math.round(h)},-1),j(B,"$srand",function(h){return null==h&&(h=_("Random").$new_seed()),ie("Random").$srand(h)},-1),j(B,"$String",function(h){var d;return de(d=T["$coerce_to?"](h,ie("String"),"to_str"))?d:T["$coerce_to!"](h,ie("String"),"to_s")}),j(B,"$tap",function c(){var h=c.$$p||z;return c.$$p=null,E.yield1(h,this),this}),j(B,"$to_proc",k),j(B,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"}),j(B,"$catch",function c(h){var d=c.$$p||z,p=z,m=z;c.$$p=null,null==h&&(h=z);try{return h=de(p=h)?p:I.$new(),E.yield1(d,h)}catch(x){if(!E.rescue(x,[ie("UncaughtThrowError")]))throw x;m=x;try{return le(m.$tag(),h)?m.$value():F.$raise()}finally{E.pop_exception()}}},-1),j(B,"$throw",function(h,d){return null==d&&(d=z),F.$raise(ie("UncaughtThrowError").$new(h,d))},-2),j(B,"$open",function c(h){var m,d=c.$$p||z;return c.$$p=null,m=X(arguments),K(ie("File"),"open",P(m),d.$to_proc())},-1),j(B,"$yield_self",function c(){var h=c.$$p||z;return c.$$p=null,h===z?K(this,"enum_for",["yield_self"],J(1)):E.yield1(h,this)}),A(B,"fail","raise"),A(B,"kind_of?","is_a?"),A(B,"object_id","__id__"),A(B,"public_send","__send__"),A(B,"send","__send__"),A(B,"then","yield_self"),A(B,"to_enum","enum_for")}(),B=y("::",null,"Object"),delete I.$$prototype.$require,B.$include(F)},Opal.modules["corelib/main"]=function(E){var D,de=E.return_val,ye=E.def,f=E.Object,T=E.slice,ne=E.Kernel;return ye(D=E.get_singleton_class(E.top),"$to_s",de("main")),ye(D,"$include",function(F){return f.$include(F)}),ye(D,"$autoload",function(F){var Z;return Z=T(arguments),E.Object.$autoload.apply(E.Object,Z)},-1),ye(D,"$using",function(F){return ne.$raise("main.using is permitted only at toplevel")})},Opal.modules["corelib/error/errno"]=function(E){var F,Z,X,de=E.module,ye=E.truthy,f=E.rb_plus,T=E.send2,ne=E.find_super,v=E.def,S=E.klass,L=[],D=E.nil,J=E.$$$;return function(j,F){var K,H,Z=de("::","Errno"),P=([Z].concat(F),D);for(K=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["ESPIPE","Illegal seek",29],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2],["ENAMETOOLONG","File name too long",36]],P=D,H=0;H<K.length;H++)!function(){var Q,q=K[H][1],Y=K[H][2];(P=E.klass(Z,E.SystemCallError,K[H][0])).errno=Y,Q=E.get_singleton_class(P),v(Q,"$new",function N(te){var A=D;return N.$$p=null,null==te&&(te=D),A=q,ye(te)&&(A=f(A," - "+te)),T(this,ne(this,"new",N,!1,!0),"new",[A],null)},-1)}()}(0,L),F=J("StandardError"),Z=L,[X=S("::",F,"SystemCallError")].concat(Z),v(X,"$errno",function(){return this.$class().$errno()}),E.get_singleton_class(X).$attr_reader("errno")},Opal.modules["corelib/error"]=function(E){var N,te,de=E.klass,ye=E.slice,f=E.gvars,T=E.defs,ne=E.send,v=E.to_a,S=E.def,L=E.truthy,D=E.hash2,J=E.Kernel,j=E.not,F=E.rb_plus,Z=E.eqeq,X=E.Object,K=E.ensure_kwargs,P=E.send2,H=E.find_super,le=E.module,q=[],Y=E.nil,Q=E.$$$;return function(k,N,te){var R,U=de("::",N,"Exception"),I=[U].concat(te),A=E.$r(I);function z(ie){for(var ge,M=[],B=0;B<ie.length;B++){var O=ie[B];!O||!O.$$is_string||((ge=O.match(/^    at (.*?) \((.*?)\)$/))?M.push(ge[2]+":in `"+ge[1]+"'"):(ge=O.match(/^    at (.*?)$/))?M.push(ge[1]+":in `undefined'"):(ge=O.match(/^  from (.*?)$/))?M.push(ge[1]):(ge=O.match(/^(.*?)@(.*?)$/))&&M.push(ge[2]+":in `"+ge[1]+"'"))}return M}U.$$prototype.message=Y,E.prop(U.$$prototype,"$$is_exception",!0),Error.stackTraceLimit=100,T(U,"$new",function(M){var B,O=this;null==f["!"]&&(f["!"]=Y);var _=(B=ye(arguments)).length>0?B[0]:Y,l=new O.$$constructor(_);return l.name=O.$$name,l.message=_,l.cause=f["!"],E.send(l,l.$initialize,B),E.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,R),l},-1),R=U.$new,T(U,"$exception",function(M){var ge,O=this;return ge=ye(arguments),ne(O,"new",v(ge))},-1),S(U,"$initialize",function(M){var ge,B,O=this;return ge=ye(arguments),O.message=(B=ge).length>0?B[0]:Y},-1),S(U,"$backtrace",function(){var M=this;if(M.backtrace)return M.backtrace;var ge=M.stack;return void 0!==ge&&ge.$$is_string?M.backtrace=z(ge.split("\n")):ge?M.backtrace=z(ge):[]}),S(U,"$backtrace_locations",function(){var M;return this.backtrace_locations||(this.backtrace_locations=(M=this.$backtrace())===Y||null==M?Y:ne(M,"map",[],function(O){return null==O&&(O=Y),Q(Q(Q("Thread"),"Backtrace"),"Location").$new(O)})),this.backtrace_locations}),S(U,"$cause",function(){return this.cause||Y}),S(U,"$exception",function(M){var ge=this;if(null==M&&(M=Y),M===Y||ge===M)return ge;var B=ge.$clone();return B.message=M,ge.backtrace&&(B.backtrace=ge.backtrace.$dup()),B.stack=ge.stack,B.cause=ge.cause,B},-1),S(U,"$message",function(){return this.$to_s()}),S(U,"$full_message",function(M){var B,O=this,_=Y,l=Y,c=Y,h=Y,d=Y,p=Y,m=Y,x=Y,$=Y;return null==f.stderr&&(f.stderr=Y),null==M&&(M=Y),L(A("Hash","skip_raise")?"constant":Y)?(c=(B=[(M=D(["highlight","order"],{highlight:f.stderr["$tty?"](),order:"top"}).$merge(L(_=M)?_:D([],{})))["$[]"]("highlight"),M["$[]"]("order")])[1],L([!0,!1]["$include?"](l=B[0]))||J.$raise(Q("ArgumentError"),"expected true or false as highlight: "+l),L(["top","bottom"]["$include?"](c))||J.$raise(Q("ArgumentError"),"expected :top or :bottom as order: "+c),L(l)?(h="\x1b[1;4m",d="\x1b[1m",p="\x1b[m"):h=d=p="",m=O.$backtrace().$dup(),(j(m)||L(m["$empty?"]()))&&(m=O.$caller()),x=m.$shift(),$=F($=x+": ",""+d+O.$to_s()+" ("+h+O.$class()+p+d+")"+p+"\n"),$=F($,ne(m,"map",[],function(se){return null==se&&(se=Y),"\tfrom "+se+"\n"}).$join()),L(O.$cause())&&($=F($,O.$cause().$full_message(D(["highlight"],{highlight:l})))),Z(c,"bottom")&&($=$.$split("\n").$reverse().$join("\n"),$=F(d+"Traceback"+p+" (most recent call last):\n",$)),$):O.message+"\n"+O.stack},-1),S(U,"$inspect",function(){var M=this,ge=Y;return ge=M.$to_s(),L(ge["$empty?"]())?M.$class().$to_s():"#<"+M.$class().$to_s()+": "+M.$to_s()+">"}),S(U,"$set_backtrace",function(M){var O,_,ge=this,B=!0;if(M===Y)ge.backtrace=Y,ge.stack="";else if(M.$$is_string)ge.backtrace=[M],ge.stack="  from "+M;else{if(M.$$is_array){for(O=0,_=M.length;O<_;O++)if(!M[O].$$is_string){B=!1;break}}else B=!1;!1===B&&J.$raise(Q("TypeError"),"backtrace must be Array of String"),ge.backtrace=M,ge.stack=ne(M,"map",[],function(c){return null==c&&(c=Y),F("  from ",c)}).join("\n")}return M}),S(U,"$to_s",function(){var ge,B,M=this;return L(ge=L(B=M.message)?M.message.$to_s():B)?ge:M.$class().$to_s()})}(0,Error,q),de("::",Q("Exception"),"ScriptError"),de("::",Q("ScriptError"),"SyntaxError"),de("::",Q("ScriptError"),"LoadError"),de("::",Q("ScriptError"),"NotImplementedError"),de("::",Q("Exception"),"SystemExit"),de("::",Q("Exception"),"NoMemoryError"),de("::",Q("Exception"),"SignalException"),de("::",Q("SignalException"),"Interrupt"),de("::",Q("Exception"),"SecurityError"),de("::",Q("Exception"),"SystemStackError"),de("::",Q("Exception"),"StandardError"),de("::",Q("StandardError"),"EncodingError"),de("::",Q("StandardError"),"ZeroDivisionError"),de("::",Q("StandardError"),"NameError"),de("::",Q("NameError"),"NoMethodError"),de("::",Q("StandardError"),"RuntimeError"),de("::",Q("RuntimeError"),"FrozenError"),de("::",Q("StandardError"),"LocalJumpError"),de("::",Q("StandardError"),"TypeError"),de("::",Q("StandardError"),"ArgumentError"),de("::",Q("ArgumentError"),"UncaughtThrowError"),de("::",Q("StandardError"),"IndexError"),de("::",Q("IndexError"),"StopIteration"),de("::",Q("StopIteration"),"ClosedQueueError"),de("::",Q("IndexError"),"KeyError"),de("::",Q("StandardError"),"RangeError"),de("::",Q("RangeError"),"FloatDomainError"),de("::",Q("StandardError"),"IOError"),de("::",Q("IOError"),"EOFError"),de("::",Q("StandardError"),"SystemCallError"),de("::",Q("StandardError"),"RegexpError"),de("::",Q("StandardError"),"ThreadError"),de("::",Q("StandardError"),"FiberError"),X.$autoload("Errno","corelib/error/errno"),N=Q("RuntimeError"),(te=de("::",N,"FrozenError")).$attr_reader("receiver"),S(te,"$initialize",function U(I,A){var y,z=this;return U.$$p=null,null==(y=(A=K(A)).$$smap.receiver)&&(y=Y),P(z,H(z,"initialize",U,!1,!0),"initialize",[I],null),z.receiver=y},-2),function(k,N){var te=de("::",N,"UncaughtThrowError");te.$$prototype.tag=Y,te.$attr_reader("tag","value"),S(te,"$initialize",function I(A,y){var z=this;return I.$$p=null,null==y&&(y=Y),z.tag=A,z.value=y,P(z,H(z,"initialize",I,!1,!0),"initialize",["uncaught throw "+z.tag.$inspect()],null)},-2)}(0,Q("ArgumentError")),function(k,N){var te=de("::",null,"NameError");te.$attr_reader("name"),S(te,"$initialize",function U(I,A){var R=this;return U.$$p=null,null==A&&(A=Y),P(R,H(R,"initialize",U,!1,!0),"initialize",[I],null),R.name=A},-2)}(),function(k,N){var te=de("::",null,"NoMethodError");te.$attr_reader("args"),S(te,"$initialize",function U(I,A,y){var z=this;return U.$$p=null,null==A&&(A=Y),null==y&&(y=[]),P(z,H(z,"initialize",U,!1,!0),"initialize",[I,A],null),z.args=y},-2)}(),de("::",null,"StopIteration").$attr_reader("result"),function(k,N){var te=de("::",null,"KeyError"),U=te.$$prototype;U.receiver=U.key=Y,S(te,"$initialize",function I(A,y){var R,z,M=this;return I.$$p=null,null==(R=(y=K(y)).$$smap.receiver)&&(R=Y),null==(z=y.$$smap.key)&&(z=Y),P(M,H(M,"initialize",I,!1,!0),"initialize",[A],null),M.receiver=R,M.key=z},-2),S(te,"$receiver",function(){var y;return L(y=this.receiver)?y:J.$raise(Q("ArgumentError"),"no receiver is available")}),S(te,"$key",function(){var y;return L(y=this.key)?y:J.$raise(Q("ArgumentError"),"no key is available")})}(),function(k,N){var U=[le("::","JS")].concat(N);return de(U[0],null,"Error"),Y}(0,q)},Opal.modules["corelib/constants"]=function(E){var de=E.const_set,f=E.$$$;return de("::","RUBY_PLATFORM","opal"),de("::","RUBY_ENGINE","opal"),de("::","RUBY_VERSION","3.2.0"),de("::","RUBY_ENGINE_VERSION","1.7.1"),de("::","RUBY_RELEASE_DATE","2023-01-06"),de("::","RUBY_PATCHLEVEL",0),de("::","RUBY_REVISION","0"),de("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2022 Adam Beynon and the Opal contributors"),de("::","RUBY_DESCRIPTION","opal "+f("RUBY_ENGINE_VERSION")+" ("+f("RUBY_RELEASE_DATE")+" revision "+f("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(E){var de=E.Object;return de.$require("corelib/runtime"),de.$require("corelib/helpers"),de.$require("corelib/module"),de.$require("corelib/class"),de.$require("corelib/basic_object"),de.$require("corelib/kernel"),de.$require("corelib/main"),de.$require("corelib/error"),de.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(E){var q,H,ye=E.Kernel,f=E.def,T=E.return_val,ne=E.ensure_kwargs,v=E.NilClass,S=E.slice,L=E.truthy,D=E.rb_gt,J=E.alias,F=E.nil,Z=E.$$$;return[H=(0,E.klass)("::",null,"NilClass")].concat([]),H.$$prototype.$$meta=H,q=E.get_singleton_class(H),f(q,"$allocate",function(){return ye.$raise(Z("TypeError"),"allocator undefined for "+this.$name())}),E.udef(q,"$new"),f(H,"$!",T(!0)),f(H,"$&",T(!1)),f(H,"$|",function(Y){return!1!==Y&&Y!==F}),f(H,"$^",function(Y){return!1!==Y&&Y!==F}),f(H,"$==",function(Y){return Y===F}),f(H,"$dup",T(F)),f(H,"$clone",function(Y){return Y=ne(Y),F},-1),f(H,"$inspect",T("nil")),f(H,"$nil?",T(!0)),f(H,"$singleton_class",function(){return v}),f(H,"$to_a",function(){return[]}),f(H,"$to_h",function(){return E.hash()}),f(H,"$to_i",T(0)),f(H,"$to_s",T("")),f(H,"$to_c",function(){return Z("Complex").$new(0,0)}),f(H,"$rationalize",function(Y){var Q;return Q=S(arguments),L(D(Q.$length(),1))&&ye.$raise(Z("ArgumentError")),ye.$Rational(0,1)},-1),f(H,"$to_r",function(){return ye.$Rational(0,1)}),f(H,"$instance_variables",function(){return[]}),J(H,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(E){"use strict";var de=E.klass,ye=E.Kernel,f=E.def,T=E.return_self,ne=E.ensure_kwargs,v=E.slice,S=E.truthy,L=E.send2,D=E.find_super,J=E.to_a,j=E.alias,Z=E.nil,X=E.$$$;return function(K,P,H){var k,le=de("::",P,"Boolean");[le].concat([]),E.prop(le.$$prototype,"$$is_boolean",!0);for(var Y=["$$class","$$meta"],Q=0;Q<Y.length;Q++)Object.defineProperty(le.$$prototype,Y[Q],{configurable:!0,enumerable:!1,get:function(){return 1==this?E.TrueClass:0==this?E.FalseClass:E.Boolean}});Object.defineProperty(le.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:Z}}),k=E.get_singleton_class(le),f(k,"$allocate",function(){return ye.$raise(X("TypeError"),"allocator undefined for "+this.$name())}),E.udef(k,"$new"),f(le,"$__id__",function(){return this.valueOf()?2:0}),f(le,"$!",function(){return 1!=this}),f(le,"$&",function(N){return 1==this&&!1!==N&&N!==Z}),f(le,"$|",function(N){return 1==this||!1!==N&&N!==Z}),f(le,"$^",function(N){return 1==this?!1===N||N===Z:!1!==N&&N!==Z}),f(le,"$==",function(N){return 1==this===N.valueOf()}),f(le,"$singleton_class",function(){return this.$$meta}),f(le,"$to_s",function(){return 1==this?"true":"false"}),f(le,"$dup",T),f(le,"$clone",function(N){return N=ne(N),this},-1),f(le,"$method_missing",function k(N,te){var A,U=k.$$p||Z,y=this;k.$$p=null,A=v(arguments,1);var R=y.$$class.$$prototype[E.jsid(N)];return S(void 0!==R&&!R.$$stub)||L(y,D(y,"method_missing",k,!1,!0),"method_missing",[N].concat(J(A)),U),E.send(y,R,A,U)},-2),f(le,"$respond_to_missing?",function(N,te){null==te&&(te=!1);var I=this.$$class.$$prototype[E.jsid(N)];return void 0!==I&&!I.$$stub},-2),j(le,"eql?","=="),j(le,"equal?","=="),j(le,"inspect","to_s"),j(le,"object_id","__id__")}(0,Boolean),de("::",X("Boolean"),"TrueClass"),de("::",X("Boolean"),"FalseClass"),Z},Opal.modules["corelib/comparable"]=function(E){var de=E.truthy,ye=E.module,f=E.rb_gt,T=E.rb_lt,ne=E.eqeqeq,v=E.Kernel,S=E.def,L=E.nil,D=E.$$$;return function(J){var j=ye("::","Comparable"),F=L;function Z(P){return E.is_a(P,E.Integer)?P:f(P,0)?1:T(P,0)?-1:0}function K(P,H){var le=P["$<=>"](H);return de(le)||function X(P,H){var le;le=ne(L,F=H)||ne(!0,F)||ne(!1,F)||ne(D("Integer"),F)||ne(D("Float"),F)?H.$inspect():H.$$class,v.$raise(D("ArgumentError"),"comparison of "+P.$class()+" with "+le+" failed")}(P,H),Z(le)}return S(j,"$==",function(H){var le=this,q=L;return!!de(le["$equal?"](H))||le["$<=>"]!=E.Kernel["$<=>"]&&(le.$$comparable?(le.$$comparable=!1,!1):!!de(q=le["$<=>"](H))&&0==Z(q))}),S(j,"$>",function(H){return K(this,H)>0}),S(j,"$>=",function(H){return K(this,H)>=0}),S(j,"$<",function(H){return K(this,H)<0}),S(j,"$<=",function(H){return K(this,H)<=0}),S(j,"$between?",function(H,le){return!(T(this,H)||f(this,le))}),S(j,"$clamp",function(H,le){var Y,Q,q=this;if(null==le&&(le=L),le===L&&(E.is_a(H,E.Range)||v.$raise(D("TypeError"),"wrong argument type "+H.$class()+" (expected Range)"),Q=H.excl,le=H.end,H=H.begin,le!==L&&Q&&v.$raise(D("ArgumentError"),"cannot clamp with an exclusive range")),H!==L&&le!==L&&K(H,le)>0&&v.$raise(D("ArgumentError"),"min argument must be smaller than max argument"),H!==L){if(0==(Y=K(q,H)))return q;if(Y<0)return H}return le!==L&&(Y=K(q,le))>0?le:q},-2)}()},Opal.modules["corelib/regexp"]=function(E){var y,R,ge,O,_,z,ie,M,de=E.coerce_to,ye=E.prop,f=E.freeze,T=E.klass,ne=E.const_set,v=E.send2,S=E.find_super,L=E.def,D=E.truthy,J=E.gvars,j=E.slice,F=E.Kernel,Z=E.Opal,X=E.alias,K=E.send,P=E.hash2,H=E.rb_plus,le=E.ensure_kwargs,q=E.rb_ge,Y=E.to_a,Q=E.eqeqeq,k=E.rb_minus,N=E.return_ivar,te=[],U=E.nil,I=E.$$$;return T("::",I("StandardError"),"RegexpError"),y=RegExp,R=te,ie=[z=T("::",y,"Regexp")].concat(R),M=E.$r(ie),ne(z,"IGNORECASE",1),ne(z,"EXTENDED",2),ne(z,"MULTILINE",4),E.prop(z.$$prototype,"$$is_regexp",!0),O=[ge=E.get_singleton_class(z)].concat(ie),_=E.$r(O),L(ge,"$allocate",function l(){var c=l.$$p||U,d=U;return l.$$p=null,(d=v(this,S(this,"allocate",l,!1,!0),"allocate",[],c)).uninitialized=!0,d}),L(ge,"$escape",function(c){return E.escape_regexp(c)}),L(ge,"$last_match",function(c){return null==J["~"]&&(J["~"]=U),null==c&&(c=U),D(c["$nil?"]())?J["~"]:D(J["~"])?J["~"]["$[]"](c):U},-1),L(ge,"$union",function(c){var d,m,x,$,re,se,p=this;if(0==(d=j(arguments)).length)return/(?!)/;if(1==d.length&&d[0].$$is_regexp)return d[0];m=d[0].$$is_array,d.length>1&&m&&F.$raise(I("TypeError"),"no implicit conversion of Array into String"),m&&(d=d[0]),re=void 0,x=[];for(var De=0;De<d.length;De++)($=d[De]).$$is_string?x.push(p.$escape($)):$.$$is_regexp?(se=$.$options(),null!=re&&re!=se&&F.$raise(I("TypeError"),"All expressions must use the same options"),re=se,x.push("("+$.source+")")):x.push(p.$escape($.$to_str()));return p.$new(x.$join("|"),re)},-1),L(ge,"$new",function(c,h){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=Z["$coerce_to!"](c,I("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&F.$raise(I("RegexpError"),"too short escape sequence: /"+c+"/"),c=c.replace("\\A","^").replace("\\z","$"),void 0===h||h["$!"]())return new RegExp(c);if(h.$$is_number){var d="";_("IGNORECASE")&h&&(d+="i"),_("MULTILINE")&h&&(d+="m"),h=d}else h="i";return new RegExp(c,h)},-2),X(ge,"compile","new"),X(ge,"quote","escape"),L(z,"$==",function(B){return B instanceof RegExp&&this.toString()===B.toString()}),L(z,"$===",function(B){return this.$match(Z["$coerce_to?"](B,I("String"),"to_str"))!==U}),L(z,"$=~",function(B){var _;return null==J["~"]&&(J["~"]=U),D(_=this.$match(B))?J["~"].$begin(0):_}),L(z,"$freeze",function(){var B=this;return D(B["$frozen?"]())?B:(B.hasOwnProperty("$$g")||ye(B,"$$g",null),B.hasOwnProperty("$$gm")||ye(B,"$$gm",null),f(B))}),L(z,"$inspect",function(){var _=this.toString(),l=/^\/(.*)\/([^\/]*)$/.exec(_);if(l){for(var h=l[2],d=l[1].split(""),p=d.length,m=!1,x="",$=0;$<p;$++){var re=d[$];!m&&"/"==re&&(x=x.concat("\\")),x=x.concat(re),m="\\"==re&&!m}return"/"+x+"/"+h}return _}),L(z,"$match",function ge(B,O){var _=ge.$$p||U,l=this;if(null==J["~"]&&(J["~"]=U),ge.$$p=null,l.uninitialized&&F.$raise(I("TypeError"),"uninitialized Regexp"),void 0===O){if(B===U)return J["~"]=U;var c=l.exec(de(B,I("String"),"to_str"));return c?(J["~"]=I("MatchData").$new(l,c),_===U?J["~"]:E.yield1(_,J["~"])):J["~"]=U}if(O=de(O,I("Integer"),"to_int"),B===U||(B=de(B,I("String"),"to_str"),O<0&&(O+=B.length)<0))return J["~"]=U;for(var h,d=E.global_regexp(l);;){if(null===(h=d.exec(B)))return J["~"]=U;if(h.index>=O)return J["~"]=I("MatchData").$new(d,h),_===U?J["~"]:E.yield1(_,J["~"]);d.lastIndex=h.index+1}},-2),L(z,"$match?",function(B,O){var l,_=this;return _.uninitialized&&F.$raise(I("TypeError"),"uninitialized Regexp"),void 0===O?B!==U&&_.test(de(B,I("String"),"to_str")):(O=de(O,I("Integer"),"to_int"),!(B===U||(B=de(B,I("String"),"to_str"),O<0&&(O+=B.length)<0)||null===(l=E.global_regexp(_).exec(B))||l.index<O))},-2),L(z,"$names",function(){return K(this.$source().$scan(/\(?<(\w+)>/,P(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()}),L(z,"$named_captures",function(){return K(K(K(this.$source().$scan(/\(?<(\w+)>/,P(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(_){return null==_&&(_=U),K(_,"map",[],function(c){return null==c&&(c=U),H(c.$last(),1)})})}),L(z,"$~",function(){return null==J._&&(J._=U),this["$=~"](J._)}),L(z,"$source",function(){return this.source}),L(z,"$options",function(){var B=this;B.uninitialized&&F.$raise(I("TypeError"),"uninitialized Regexp");var O=0;return B.multiline&&(O|=M("MULTILINE")),B.ignoreCase&&(O|=M("IGNORECASE")),O}),L(z,"$casefold?",function(){return this.ignoreCase}),X(z,"eql?","=="),X(z,"to_s","source"),function(A,y,R){var z=T(A,null,"MatchData"),ie=[z].concat(R),M=E.$r(ie);return z.$$prototype.matches=U,z.$attr_reader("post_match","pre_match","regexp","string"),L(z,"$initialize",function(O,_,l){var c,h=this;null==(c=(l=le(l)).$$smap.no_matchdata)&&(c=!1),D(c)||(J["~"]=h),h.regexp=O,h.begin=_.index,h.string=_.input,h.pre_match=_.input.slice(0,_.index),h.post_match=_.input.slice(_.index+_[0].length),h.matches=[];for(var d=0,p=_.length;d<p;d++){var m=_[d];h.matches.push(null==m?U:m)}},-3),L(z,"$match",function(O){var l;return D(l=this["$[]"](O))?l:D(O["$is_a?"](M("Integer")))&&D(q(O,this.$length()))?F.$raise(I("IndexError"),"index "+O+" out of matches"):U}),L(z,"$match_length",function(O){var _;return(_=this.$match(O))===U||null==_?U:_.$length()}),L(z,"$[]",function(O){var l,c=this;return(l=j(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](l["$[]"](0))["$!"]()&&F.$raise(I("IndexError"),"undefined group name reference: "+l["$[]"](0)),c.$named_captures()["$[]"](l["$[]"](0))):K(c.matches,"[]",Y(l))},-1),L(z,"$offset",function(O){var _=this;return 0!==O&&F.$raise(I("ArgumentError"),"MatchData#offset only supports 0th element"),[_.begin,_.begin+_.matches[O].length]}),L(z,"$==",function(O){var _=this,l=U,c=U,h=U,d=U;return!!Q(I("MatchData"),O)&&(D(l=D(c=D(h=D(d=_.string==O.string)?_.regexp.toString()==O.regexp.toString():d)?_.pre_match==O.pre_match:h)?_.post_match==O.post_match:c)?_.begin==O.begin:l)}),L(z,"$begin",function(O){return 0!==O&&F.$raise(I("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin}),L(z,"$end",function(O){return 0!==O&&F.$raise(I("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[O].length}),L(z,"$captures",function(){return this.matches.slice(1)}),L(z,"$named_captures",function(){var _=U;return _=this.$captures(),K(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=U),_["$[]"](k(c.$last(),1))})}),L(z,"$names",function(){return this.$regexp().$names()}),L(z,"$inspect",function(){var O=this,_="#<MatchData "+O.matches[0].$inspect();if(O.$regexp().$names()["$empty?"]())for(var l=1,c=O.matches.length;l<c;l++)_+=" "+l+":"+O.matches[l].$inspect();else K(O.$named_captures(),"each",[],function(d,p){return null==d&&(d=U),null==p&&(p=U),_+=" "+d+":"+p.$inspect()});return _+">"}),L(z,"$length",function(){return this.matches.length}),L(z,"$to_a",N("matches")),L(z,"$to_s",function(){return this.matches[0]}),L(z,"$values_at",function(O){var l,c=this;l=j(arguments);var h,d,p,m=[];for(h=0;h<l.length;h++)l[h].$$is_range&&((d=l[h].$to_a()).unshift(h,1),Array.prototype.splice.apply(l,d)),(p=Z["$coerce_to!"](l[h],I("Integer"),"to_int"))<0&&(p+=c.matches.length)<0?m.push(U):m.push(c.matches[p]);return m},-1),X(z,"eql?","=="),X(z,"size","length")}(te[0],0,te)},Opal.modules["corelib/string"]=function(E){var de=E.coerce_to,ye=E.respond_to,f=E.global_multiline_regexp,T=E.prop,ne=E.klass,v=E.def,S=E.Opal,L=E.defs,D=E.slice,J=E.send,j=E.to_a,F=E.extract_kwargs,Z=E.ensure_kwargs,X=E.eqeqeq,K=E.Kernel,P=E.truthy,H=E.gvars,le=E.rb_divide,q=E.rb_plus,Y=E.eqeq,Q=E.hash2,k=E.alias,N=E.const_set,te=E.top,U=[],I=E.$r(U),A=E.nil,y=E.$$$;return te.$require("corelib/comparable"),te.$require("corelib/regexp"),function(R,z,ie){var M=ne("::",String,"String"),ge=[M].concat(ie),B=E.$r(ge);function O(_){function l(De){var fe,be,xe,pe,Me,Ce,Ae="",Pe=De.length;for(fe=0;fe<Pe;fe++)if("-"===(be=De.charAt(fe))&&fe>0&&fe<Pe-1&&!xe){for((pe=De.charCodeAt(fe-1))>(Me=De.charCodeAt(fe+1))&&K.$raise(y("ArgumentError"),'invalid range "'+pe+"-"+Me+'" in string transliteration'),Ce=pe+1;Ce<Me+1;Ce++)Ae+=String.fromCharCode(Ce);xe=!0,fe++}else xe="\\"===be,Ae+=be;return Ae}function c(De,Ae){if(0===De.length)return Ae;var Pe,xe,fe="",be=De.length;for(Pe=0;Pe<be;Pe++)xe=De.charAt(Pe),-1!==Ae.indexOf(xe)&&(fe+=xe);return fe}var h,d,p,m,x,$,re="",se="";for(h=0,d=_.length;h<d;h++)m="^"===(p=de(_[h],y("String"),"to_str")).charAt(0)&&p.length>1,p=l(m?p.slice(1):p),m?se=c(se,p):re=c(re,p);if(re.length>0&&se.length>0){for($="",h=0,d=re.length;h<d;h++)x=re.charAt(h),-1===se.indexOf(x)&&($+=x);re=$,se=""}return re.length>0?"["+y("Regexp").$escape(re)+"]":se.length>0?"[^"+y("Regexp").$escape(se)+"]":null}M.$include(y("Comparable")),E.prop(M.$$prototype,"$$is_string",!0),v(M,"$__id__",function(){return this.toString()}),L(M,"$try_convert",function(l){return S["$coerce_to?"](l,y("String"),"to_str")}),L(M,"$new",function(l){var h,d=this,p=(h=D(arguments))[0]||"",m=h[h.length-1];return p=de(p,y("String"),"to_str"),m&&m.$$is_hash&&m.$$smap.encoding&&(p=p.$force_encoding(m.$$smap.encoding)),(p=new d.$$constructor(p)).$initialize.$$pristine||J(p,"initialize",j(h)),p},-1),v(M,"$initialize",function(l,c){var h,d;return h=D(arguments),d=F(h),d=Z(d),h.length>0&&h.shift(),A},-1),v(M,"$%",function(l){var c=this;return X(y("Array"),l)?J(c,"format",[c].concat(j(l))):c.$format(c,l)}),v(M,"$*",function(l){if((l=de(l,y("Integer"),"to_int"))<0&&K.$raise(y("ArgumentError"),"negative argument"),0===l)return"";var h="",d=this.toString();for(d.length*l>=1<<28&&K.$raise(y("RangeError"),"multiply count must not overflow maximum string size");1==(1&l)&&(h+=d),0!=(l>>>=1);)d+=d;return h}),v(M,"$+",function(l){var c=this;if(""==(l=de(l,y("String"),"to_str"))&&c.$$class===E.String)return c;if(""==c&&l.$$class===E.String)return l;var h=c+l;return c.encoding===h.encoding&&l.encoding===h.encoding||"UTF-8"===c.encoding.name||"UTF-8"===l.encoding.name?h:E.enc(h,c.encoding)}),v(M,"$<=>",function(l){var c=this;if(P(l["$respond_to?"]("to_str")))return c>(l=l.$to_str().$to_s())?1:c<l?-1:0;var h=l["$<=>"](c);return h===A?A:h>0?-1:h<0?1:0}),v(M,"$==",function(l){return l.$$is_string?this.toString()===l.toString():!!ye(l,"$to_str")&&l["$=="](this)}),v(M,"$=~",function(l){return l.$$is_string&&K.$raise(y("TypeError"),"type mismatch: String given"),l["$=~"](this)}),v(M,"$[]",function(l,c){var p,m,h=this,d=h.length;if(l.$$is_range)return p=l.excl,m=l,c=l.end===A?-1:de(l.end,y("Integer"),"to_int"),l=l.begin===A?0:de(l.begin,y("Integer"),"to_int"),Math.abs(l)>d?A:(l<0&&(l+=d),c<0&&(c+=d),(!p||m.end===A)&&(c+=1),(c-=l)<0&&(c=0),h.substr(l,c));if(l.$$is_string)return null!=c&&K.$raise(y("TypeError")),-1!==h.indexOf(l)?l:A;if(l.$$is_regexp){var x=h.match(l);return null===x?(H["~"]=A,A):(H["~"]=y("MatchData").$new(l,x),null==c?x[0]:(c=de(c,y("Integer"),"to_int"))<0&&-c<x.length?x[c+=x.length]:c>=0&&c<x.length?x[c]:A)}return(l=de(l,y("Integer"),"to_int"))<0&&(l+=d),null==c?l>=d||l<0?A:h.substr(l,1):(c=de(c,y("Integer"),"to_int"))<0||l>d||l<0?A:h.substr(l,c)},-2),v(M,"$b",function(){return new String(this).$force_encoding("binary")}),v(M,"$capitalize",function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),v(M,"$casecmp",function(l){var c=this;if(!P(l["$respond_to?"]("to_str")))return A;l=de(l,y("String"),"to_str").$to_s();var h=/^[\x00-\x7F]*$/;return h.test(c)&&h.test(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c["$<=>"](l)}),v(M,"$casecmp?",function(l){var h=this.$casecmp(l);return h===A?A:0===h}),v(M,"$center",function(l,c){var h=this;if(null==c&&(c=" "),l=de(l,y("Integer"),"to_int"),c=de(c,y("String"),"to_str").$to_s(),P(c["$empty?"]())&&K.$raise(y("ArgumentError"),"zero width padding"),P(l<=h.length))return h;var d=h.$ljust(le(q(l,h.length),2).$ceil(),c);return h.$rjust(le(q(l,h.length),2).$floor(),c)+d.slice(h.length)},-2),v(M,"$chomp",function(l){var h,c=this;return null==H["/"]&&(H["/"]=A),null==l&&(l=H["/"]),P(l===A||0===c.length)?c:("\n"===(l=S["$coerce_to!"](l,y("String"),"to_str").$to_s())?h=c.replace(/\r?\n?$/,""):""===l?h=c.replace(/(\r?\n)+$/,""):c.length>=l.length&&c.substr(c.length-l.length,l.length)===l&&(h=c.substr(0,c.length-l.length)),null!=h?h:c)},-1),v(M,"$chop",function(){var l=this,c=l.length;return c<=1?"":"\n"===l.charAt(c-1)&&"\r"===l.charAt(c-2)?l.substr(0,c-2):l.substr(0,c-1)}),v(M,"$chr",function(){return this.charAt(0)}),v(M,"$clone",function(l){var c,h=this,d=A;return null==(c=(l=Z(l)).$$smap.freeze)&&(c=A),P(c["$nil?"]())||Y(c,!0)||Y(c,!1)||h.$raise(B("ArgumentError"),"unexpected value for freeze: "+c.$class()),(d=new String(h)).$copy_singleton_methods(h),d.$initialize_clone(h,Q(["freeze"],{freeze:c})),Y(c,!0)?d.$$frozen||(d.$$frozen=!0):P(c["$nil?"]())&&h.$$frozen&&(d.$$frozen=!0),d},-1),v(M,"$dup",function(){var c=A;return(c=new String(this)).$initialize_dup(this),c}),v(M,"$count",function(l){var h,d=this;0===(h=D(arguments)).length&&K.$raise(y("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=O(h);return null===p?0:d.length-d.replace(new RegExp(p,"g"),"").length},-1),v(M,"$delete",function(l){var h,d=this;0===(h=D(arguments)).length&&K.$raise(y("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=O(h);return null===p?d:d.replace(new RegExp(p,"g"),"")},-1),v(M,"$delete_prefix",function(l){var c=this;return l.$$is_string||(l=de(l,y("String"),"to_str")),c.slice(0,l.length)===l?c.slice(l.length):c}),v(M,"$delete_suffix",function(l){var c=this;return l.$$is_string||(l=de(l,y("String"),"to_str")),c.slice(c.length-l.length)===l?c.slice(0,c.length-l.length):c}),v(M,"$downcase",function(){return this.toLowerCase()}),v(M,"$each_line",function _(l,c){var d,p,m,x,re,se,De,Ae,fe,Pe,be,xe,h=_.$$p||A,$=this;if(null==H["/"]&&(H["/"]=A),_.$$p=null,d=D(arguments),p=F(d),p=Z(p),d.length>0&&(m=d.shift()),null==m&&(m=H["/"]),null==(x=p.$$smap.chomp)&&(x=!1),h===A)return $.$enum_for("each_line",m,Q(["chomp"],{chomp:x}));if(m===A)return E.yield1(h,$),$;if(0===(m=de(m,y("String"),"to_str")).length){for(se=0,De=(re=$.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;se<De;se+=2)(re[se]||re[se+1])&&(xe=(re[se]||"")+(re[se+1]||""),x&&(xe=xe.$chomp("\n")),E.yield1(h,xe));return $}for(fe=$.$chomp(m),Pe=$.length!=fe.length,se=0,Ae=(be=fe.split(m)).length;se<Ae;se++)xe=be[se],(se<Ae-1||Pe)&&(xe+=m),x&&(xe=xe.$chomp(m)),E.yield1(h,xe);return $},-1),v(M,"$empty?",function(){return 0===this.length}),v(M,"$end_with?",function(l){for(var h,d=this,p=0,m=(h=D(arguments)).length;p<m;p++){var x=de(h[p],y("String"),"to_str").$to_s();if(d.length>=x.length&&d.substr(d.length-x.length,x.length)==x)return!0}return!1},-1),v(M,"$gsub",function _(l,c){var h=_.$$p||A,d=this;if(_.$$p=null,void 0===c&&h===A)return d.$enum_for("gsub",l);var $,re,se,p="",m=A,x=0;for(l.$$is_regexp?l=f(l):(l=de(l,y("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===($=l.exec(d))){H["~"]=A,p+=d.slice(x);break}m=y("MatchData").$new(l,$),void 0===c?(se=l.lastIndex,re=h($[0]),l.lastIndex=se):c.$$is_hash?re=c["$[]"]($[0]).$to_s():(c.$$is_string||(c=de(c,y("String"),"to_str")),re=c.replace(/([\\]+)([0-9+&`'])/g,function(De,Ae,fe){if(Ae.length%2==0)return De;switch(fe){case"+":for(var Pe=$.length-1;Pe>0;Pe--)if(void 0!==$[Pe])return Ae.slice(1)+$[Pe];return"";case"&":return Ae.slice(1)+$[0];case"`":return Ae.slice(1)+d.slice(0,$.index);case"'":return Ae.slice(1)+d.slice($.index+$[0].length);default:return Ae.slice(1)+($[fe]||"")}}).replace(/\\\\/g,"\\")),l.lastIndex===$.index?(p+=d.slice(x,$.index)+re+(d[$.index]||""),l.lastIndex+=1):p+=d.slice(x,$.index)+re,x=l.lastIndex}return H["~"]=m,p},-2),v(M,"$hash",function(){return this.toString()}),v(M,"$hex",function(){return this.$to_i(16)}),v(M,"$include?",function(l){return l.$$is_string||(l=de(l,y("String"),"to_str")),-1!==this.indexOf(l)}),v(M,"$index",function(l,c){var d,p,m,h=this;if(void 0===c)c=0;else if((c=de(c,y("Integer"),"to_int"))<0&&(c+=h.length)<0)return A;if(l.$$is_regexp)for(m=f(l);;){if(null===(p=m.exec(h))){H["~"]=A,d=-1;break}if(p.index>=c){H["~"]=y("MatchData").$new(m,p),d=p.index;break}m.lastIndex=p.index+1}else d=0===(l=de(l,y("String"),"to_str")).length&&c>h.length?-1:h.indexOf(l,c);return-1===d?A:d},-2),v(M,"$inspect",function(){var l=this,h={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+l.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(p){return h[p]?h[p]:(p=p.charCodeAt(0))<=255&&(l.encoding["$binary?"]()||l.internal_encoding["$binary?"]())?"\\x"+("00"+p.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+p.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'}),v(M,"$intern",function(){return this.toString()}),v(M,"$length",function(){return this.length}),k(M,"size","length"),v(M,"$lines",function _(l,c){var d,p,m,x,h=_.$$p||A,$=this,re=A;return null==H["/"]&&(H["/"]=A),_.$$p=null,d=D(arguments),p=F(d),p=Z(p),d.length>0&&(m=d.shift()),null==m&&(m=H["/"]),null==(x=p.$$smap.chomp)&&(x=!1),re=J($,"each_line",[m,Q(["chomp"],{chomp:x})],h.$to_proc()),P(h)?$:re.$to_a()},-1),v(M,"$ljust",function(l,c){var h=this;if(null==c&&(c=" "),l=de(l,y("Integer"),"to_int"),c=de(c,y("String"),"to_str").$to_s(),P(c["$empty?"]())&&K.$raise(y("ArgumentError"),"zero width padding"),P(l<=h.length))return h;var d=-1,p="";for(l-=h.length;++d<l;)p+=c;return h+p.slice(0,l)},-2),v(M,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")}),v(M,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)}),v(M,"$match",function _(l,c){var h=_.$$p||A;return _.$$p=null,(X(B("String"),l)||P(l["$respond_to?"]("to_str")))&&(l=y("Regexp").$new(l.$to_str())),X(y("Regexp"),l)||K.$raise(y("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),J(l,"match",[this,c],h.$to_proc())},-2),v(M,"$match?",function(l,c){return(X(B("String"),l)||P(l["$respond_to?"]("to_str")))&&(l=y("Regexp").$new(l.$to_str())),X(y("Regexp"),l)||K.$raise(y("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),l["$match?"](this,c)},-2),v(M,"$next",function(){var l=this,c=l.length;if(0===c)return"";for(var m,h=l,d=l.search(/[a-zA-Z0-9]/),p=!1;c--;){if((m=l.charCodeAt(c))>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122)switch(m){case 57:p=!0,m=48;break;case 90:p=!0,m=65;break;case 122:p=!0,m=97;break;default:p=!1,m+=1}else-1===d?255===m?(p=!0,m=0):(p=!1,m+=1):p=!0;if(h=h.slice(0,c)+String.fromCharCode(m)+h.slice(c+1),p&&(0===c||c===d)){switch(m){case 65:case 97:break;default:m+=1}h=0===c?String.fromCharCode(m)+h:h.slice(0,c)+String.fromCharCode(m)+h.slice(c),p=!1}if(!p)break}return h}),v(M,"$oct",function(){var c,h=this,d=8;return/^\s*_/.test(h)?0:(h=h.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(p,m,x,$){switch($.charAt(0)){case"+":case"-":return p;case"0":if("x"===$.charAt(1)&&"0x"===x)return p}switch(x){case"0b":d=2;break;case"0":case"0o":d=8;break;case"0d":d=10;break;case"0x":d=16}return m+$}),c=parseInt(h.replace(/_(?!_)/g,""),d),isNaN(c)?0:c)}),v(M,"$ord",function(){var l=this;return"function"==typeof l.codePointAt?l.codePointAt(0):l.charCodeAt(0)}),v(M,"$partition",function(l){var h,d,c=this;return l.$$is_regexp?null===(d=l.exec(c))?h=-1:(y("MatchData").$new(l,d),l=d[0],h=d.index):(l=de(l,y("String"),"to_str"),h=c.indexOf(l)),-1===h?[c,"",""]:[c.slice(0,h),c.slice(h,h+l.length),c.slice(h+l.length)]}),v(M,"$reverse",function(){return this.split("").reverse().join("")}),v(M,"$rindex",function(l,c){var d,p,m,x,h=this;if(void 0===c)c=h.length;else if((c=de(c,y("Integer"),"to_int"))<0&&(c+=h.length)<0)return A;if(l.$$is_regexp){for(p=null,m=f(l);!(null===(x=m.exec(h))||x.index>c);)m.lastIndex=(p=x).index+1;null===p?(H["~"]=A,d=-1):(y("MatchData").$new(m,p),d=p.index)}else l=de(l,y("String"),"to_str"),d=h.lastIndexOf(l,c);return-1===d?A:d},-2),v(M,"$rjust",function(l,c){var h=this;if(null==c&&(c=" "),l=de(l,y("Integer"),"to_int"),c=de(c,y("String"),"to_str").$to_s(),P(c["$empty?"]())&&K.$raise(y("ArgumentError"),"zero width padding"),P(l<=h.length))return h;var d=Math.floor(l-h.length),p=Math.floor(d/c.length),m=Array(p+1).join(c);return m+c.slice(0,d-m.length)+h},-2),v(M,"$rpartition",function(l){var h,d,p,m,c=this;if(l.$$is_regexp){for(d=null,p=f(l);null!==(m=p.exec(c));)p.lastIndex=(d=m).index+1;null===d?h=-1:(y("MatchData").$new(p,d),l=d[0],h=d.index)}else l=de(l,y("String"),"to_str"),h=c.lastIndexOf(l);return-1===h?["","",c]:[c.slice(0,h),c.slice(h,h+l.length),c.slice(h+l.length)]}),v(M,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")}),v(M,"$scan",function _(l,c){var d,h=_.$$p||A;_.$$p=null,null==(d=(c=Z(c)).$$smap.no_matchdata)&&(d=!1);var $,m=[],x=A;for(l.$$is_regexp?l=f(l):(l=de(l,y("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=($=l.exec(this));)x=y("MatchData").$new(l,$,Q(["no_matchdata"],{no_matchdata:d})),h===A?m.push(1==$.length?$[0]:x.$captures()):E.yield1(h,1==$.length?$[0]:x.$captures()),l.lastIndex===$.index&&(l.lastIndex+=1);return d||(H["~"]=x),h!==A?this:m},-2),v(M,"$singleton_class",function(){return E.get_singleton_class(this)}),v(M,"$split",function(l,c){var h=this,d=A;if(null==H[";"]&&(H[";"]=A),0===h.length)return[];if(void 0===c)c=0;else if(1===(c=S["$coerce_to!"](c,y("Integer"),"to_int")))return[h];(void 0===l||l===A)&&(l=P(d=H[";"])?d:" ");var $,re,se,p=[],m=h.toString(),x=0;if(l.$$is_regexp?l=f(l):" "===(l=de(l,y("String"),"to_str").$to_s())?(l=/\s+/gm,m=m.replace(/^\s+/,"")):l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(p=m.split(l)).length&&p[0]===m)return[p[0]];for(;-1!==(re=p.indexOf(void 0));)p.splice(re,1);if(0===c){for(;""===p[p.length-1];)p.length-=1;return p}if($=l.exec(m),c<0){if(null!==$&&""===$[0]&&-1===l.source.indexOf("(?="))for(re=0,se=$.length;re<se;re++)p.push("");return p}if(null!==$&&""===$[0])return p.splice(c-1,p.length-1,p.slice(c-1).join("")),p;if(c>=p.length)return p;for(re=0;null!==$&&(re++,x=l.lastIndex,re+1!==c);)$=l.exec(m);return p.splice(c-1,p.length-1,m.slice(x)),p},-1),v(M,"$squeeze",function(l){var h,d=this;if(0===(h=D(arguments)).length)return d.replace(/(.)\1+/g,"$1");var p=O(h);return null===p?d:d.replace(new RegExp("("+p+")\\1+","g"),"$1")},-1),v(M,"$start_with?",function(l){for(var h,d=this,p=0,m=(h=D(arguments)).length;p<m;p++)if(h[p].$$is_regexp){var x=h[p],$=x.exec(d);if(null!=$&&0===$.index)return H["~"]=y("MatchData").$new(x,$),!0;H["~"]=A}else{var re=de(h[p],y("String"),"to_str").$to_s();if(0===d.indexOf(re))return!0}return!1},-1),v(M,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")}),v(M,"$sub",function _(l,c){var h=_.$$p||A,d=this;_.$$p=null,l.$$is_regexp||(l=de(l,y("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var p,m=l.exec(d);return null===m?(H["~"]=A,p=d.toString()):(y("MatchData").$new(l,m),void 0===c?(h===A&&K.$raise(y("ArgumentError"),"wrong number of arguments (1 for 2)"),p=d.slice(0,m.index)+h(m[0])+d.slice(m.index+m[0].length)):c.$$is_hash?p=d.slice(0,m.index)+c["$[]"](m[0]).$to_s()+d.slice(m.index+m[0].length):(c=(c=de(c,y("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(x,$,re){if($.length%2==0)return x;switch(re){case"+":for(var se=m.length-1;se>0;se--)if(void 0!==m[se])return $.slice(1)+m[se];return"";case"&":return $.slice(1)+m[0];case"`":return $.slice(1)+d.slice(0,m.index);case"'":return $.slice(1)+d.slice(m.index+m[0].length);default:return $.slice(1)+(m[re]||"")}}).replace(/\\\\/g,"\\"),p=d.slice(0,m.index)+c+d.slice(m.index+m[0].length))),p},-2),v(M,"$sum",function(l){null==l&&(l=16),l=de(l,y("Integer"),"to_int");for(var h=0,d=this.length,p=0;p<d;p++)h+=this.charCodeAt(p);return l<=0?h:h&Math.pow(2,l)-1},-1),v(M,"$swapcase",function(){return this.replace(/([a-z]+)|([A-Z]+)/g,function(h,d,p){return d?h.toUpperCase():h.toLowerCase()})}),v(M,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c}),v(M,"$to_i",function(l){null==l&&(l=10);var h,d=this.toLowerCase(),p=de(l,y("Integer"),"to_int");return(1===p||p<0||p>36)&&K.$raise(y("ArgumentError"),"invalid radix "+p),/^\s*_/.test(d)?0:(d=d.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(m,x,$,re){switch(re.charAt(0)){case"+":case"-":return m;case"0":if("x"===re.charAt(1)&&"0x"===$&&(0===p||16===p))return m}switch($){case"0b":if(0===p||2===p)return p=2,x+re;break;case"0":case"0o":if(0===p||8===p)return p=8,x+re;break;case"0d":if(0===p||10===p)return p=10,x+re;break;case"0x":if(0===p||16===p)return p=16,x+re}return m}),h=parseInt(d.replace(/_(?!_)/g,""),p),isNaN(h)?0:h)},-1),v(M,"$to_proc",function _(){var h,d,p=A;return _.$$p=null,h=this.valueOf(),d=E.jsid(h),p=J(K,"proc",[],function m(x){var se,$=m.$$p||A;m.$$p=null,0===(se=D(arguments)).length&&K.$raise(y("ArgumentError"),"no receiver given");var De=se[0];null==De&&(De=A);var Ae=De[d];return Ae?se=se.slice(1):(Ae=De.$method_missing,se[0]=h),"function"==typeof $&&(Ae.$$p=$),0===se.length?Ae.call(De):Ae.apply(De,se)},-1),p.$$source_location=A,p}),v(M,"$to_s",function(){return this.toString()}),v(M,"$tr",function(l,c){var h=this;if(l=de(l,y("String"),"to_str").$to_s(),c=de(c,y("String"),"to_str").$to_s(),0==l.length||l===c)return h;var d,p,m,x,$,re,se,De={},Ae=l.split(""),fe=Ae.length,Pe=c.split(""),be=Pe.length,xe=!1,pe=null;"^"===Ae[0]&&Ae.length>1&&(xe=!0,Ae.shift(),pe=Pe[be-1],fe-=1);var Me=[],Ce=null;for(p=!1,d=0;d<fe;d++)if(x=Ae[d],null==Ce)Ce=x,Me.push(x);else if("-"===x)"-"===Ce?(Me.push("-"),Me.push("-")):d==fe-1?Me.push("-"):p=!0;else if(p){for(($=Ce.charCodeAt(0))>(re=x.charCodeAt(0))&&K.$raise(y("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)Me.push(String.fromCharCode(m));Me.push(x),p=null,Ce=null}else Me.push(x);if(fe=(Ae=Me).length,xe)for(d=0;d<fe;d++)De[Ae[d]]=!0;else{if(be>0){var ae=[],he=null;for(p=!1,d=0;d<be;d++)if(x=Pe[d],null==he)he=x,ae.push(x);else if("-"===x)"-"===he?(ae.push("-"),ae.push("-")):d==be-1?ae.push("-"):p=!0;else if(p){for(($=he.charCodeAt(0))>(re=x.charCodeAt(0))&&K.$raise(y("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)ae.push(String.fromCharCode(m));ae.push(x),p=null,he=null}else ae.push(x);be=(Pe=ae).length}var Ee=fe-be;if(Ee>0){var C=be>0?Pe[be-1]:"";for(d=0;d<Ee;d++)Pe.push(C)}for(d=0;d<fe;d++)De[Ae[d]]=Pe[d]}var V="";for(d=0,se=h.length;d<se;d++){var $e=De[x=h.charAt(d)];V+=xe?null==$e?pe:x:null!=$e?$e:x}return V}),v(M,"$tr_s",function(l,c){var h=this;if(l=de(l,y("String"),"to_str").$to_s(),c=de(c,y("String"),"to_str").$to_s(),0==l.length)return h;var d,p,m,x,$,re,se,De={},Ae=l.split(""),fe=Ae.length,Pe=c.split(""),be=Pe.length,xe=!1,pe=null;"^"===Ae[0]&&Ae.length>1&&(xe=!0,Ae.shift(),pe=Pe[be-1],fe-=1);var Me=[],Ce=null;for(p=!1,d=0;d<fe;d++)if(x=Ae[d],null==Ce)Ce=x,Me.push(x);else if("-"===x)"-"===Ce?(Me.push("-"),Me.push("-")):d==fe-1?Me.push("-"):p=!0;else if(p){for(($=Ce.charCodeAt(0))>(re=x.charCodeAt(0))&&K.$raise(y("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)Me.push(String.fromCharCode(m));Me.push(x),p=null,Ce=null}else Me.push(x);if(fe=(Ae=Me).length,xe)for(d=0;d<fe;d++)De[Ae[d]]=!0;else{if(be>0){var ae=[];for(p=!1,d=0;d<be;d++)if(x=Pe[d],null==Ce)Ce=x,ae.push(x);else if("-"===x)d==be-1?ae.push("-"):p=!0;else if(p){for(($=Ce.charCodeAt(0))>(re=x.charCodeAt(0))&&K.$raise(y("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)ae.push(String.fromCharCode(m));ae.push(x),p=null,Ce=null}else ae.push(x);be=(Pe=ae).length}var Ee=fe-be;if(Ee>0){var C=be>0?Pe[be-1]:"";for(d=0;d<Ee;d++)Pe.push(C)}for(d=0;d<fe;d++)De[Ae[d]]=Pe[d]}var V="",$e=null;for(d=0,se=h.length;d<se;d++){var Te=De[x=h.charAt(d)];xe?null==Te?null==$e&&(V+=pe,$e=!0):(V+=x,$e=null):null!=Te?(null==$e||$e!==Te)&&(V+=Te,$e=Te):(V+=x,$e=null)}return V}),v(M,"$upcase",function(){return this.toUpperCase()}),v(M,"$upto",function _(l,c){var h=_.$$p||A,d=this;if(_.$$p=null,null==c&&(c=!1),h===A)return d.$enum_for("upto",l,c);var p,m,x=d.toString();if(l=de(l,y("String"),"to_str"),1===x.length&&1===l.length)for(p=x.charCodeAt(0),m=l.charCodeAt(0);p<=m&&(!c||p!==m);)h(String.fromCharCode(p)),p+=1;else if(parseInt(x,10).toString()===x&&parseInt(l,10).toString()===l)for(p=parseInt(x,10),m=parseInt(l,10);p<=m&&(!c||p!==m);)h(p.toString()),p+=1;else for(;x.length<=l.length&&x<=l&&(!c||x!==l);)h(x),x=x.$succ();return d},-2),v(M,"$instance_variables",function(){return[]}),L(M,"$_load",function(l){var c,d=this;return c=D(arguments),J(d,"new",j(c))},-1),v(M,"$unicode_normalize",function(l){return null==l&&(l="nfc"),P(["nfc","nfd","nfkc","nfkd"]["$include?"](l))||K.$raise(y("ArgumentError"),"Invalid normalization form "+l),this.normalize(l.$upcase())},-1),v(M,"$unicode_normalized?",function(l){return null==l&&(l="nfc"),this.$unicode_normalize(l)["$=="](this)},-1),v(M,"$unpack",function(l){return K.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")}),v(M,"$unpack1",function(l){return K.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")}),v(M,"$freeze",function(){var l=this;return"string"==typeof l||T(l,"$$frozen",!0),l}),v(M,"$-@",function(){var l=this;return"string"==typeof l||l.$$frozen?l:"UTF-8"==l.encoding.name&&"UTF-8"==l.internal_encoding.name?l.toString():l.$dup().$freeze()}),v(M,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen}),k(M,"+@","dup"),k(M,"===","=="),k(M,"byteslice","[]"),k(M,"eql?","=="),k(M,"equal?","==="),k(M,"object_id","__id__"),k(M,"slice","[]"),k(M,"succ","next"),k(M,"to_str","to_s"),k(M,"to_sym","intern"),S.$pristine(M,"initialize")}(0,0,U),N(U[0],"Symbol",I("String"))},Opal.modules["corelib/enumerable"]=function(E){var de=E.truthy,ye=E.coerce_to,f=E.yield1,T=E.yieldX,ne=E.deny_frozen_access,v=E.module,S=E.send,L=E.slice,D=E.to_a,J=E.Opal,j=E.thrower,F=E.def,Z=E.Kernel,X=E.return_val,K=E.rb_gt,P=E.rb_times,H=E.rb_lt,le=E.eqeq,q=E.rb_plus,Y=E.rb_minus,Q=E.rb_divide,k=E.rb_le,N=E.hash2,te=E.lambda,U=E.not,I=E.alias,y=E.nil,R=E.$$$;return function(z,ie){var M=v("::","Enumerable"),ge=[M].concat([]),B=E.$r(ge);function O(_){return 0===_.length&&(_=[y]),_.length>1&&(_=[_]),_}return F(M,"$all?",function _(l){try{var c=j("return"),h=_.$$p||y;return _.$$p=null,de(void 0!==l)?S(this,"each",[],function(m){var re=y;if(re=O(L(arguments)),de(S(l,"public_send",["==="].concat(D(re)))))return y;c.$throw(!1)},{$$arity:-1,$$ret:c}):S(this,"each",[],h!==y?function(m){var x;if(x=L(arguments),de(E.yieldX(h,D(x))))return y;c.$throw(!1)}:function(m){var x;if(x=L(arguments),de(J.$destructure(x)))return y;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),F(M,"$any?",function _(l){try{var c=j("return"),h=_.$$p||y;return _.$$p=null,de(void 0!==l)?S(this,"each",[],function(m){var re=y;if(re=O(L(arguments)),!de(S(l,"public_send",["==="].concat(D(re)))))return y;c.$throw(!0)},{$$arity:-1,$$ret:c}):S(this,"each",[],h!==y?function(m){var x;if(x=L(arguments),!de(E.yieldX(h,D(x))))return y;c.$throw(!0)}:function(m){var x;if(x=L(arguments),!de(J.$destructure(x)))return y;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(p){if(p===c)return p.$v;throw p}},-1),F(M,"$chunk",function _(){var l=_.$$p||y,c=this;return _.$$p=null,l===y?S(c,"to_enum",["chunk"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):S(R("Enumerator"),"new",[],function h(d){var p=null==h.$$s?this:h.$$s;null==d&&(d=y);var m=y,x=[];function $(){x.length>0&&d.$yield(m,x)}p.$each.$$p=function(re){var se=f(l,re);se===y?($(),x=[],m=y):(m===y||m===se?x.push(re):($(),x=[re]),m=se)},p.$each(),$()},{$$s:c})}),F(M,"$chunk_while",function _(){var l=_.$$p||y;return _.$$p=null,l===y&&Z.$raise(R("ArgumentError"),"no block given"),S(this,"slice_when",[],function(d,p){return null==d&&(d=y),null==p&&(p=y),E.yieldX(l,[d,p])["$!"]()})}),F(M,"$collect",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return S(c,"enum_for",["collect"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=T(l,arguments);h.push(d)},c.$each(),h}),F(M,"$collect_concat",function _(){var l=_.$$p||y,c=this;return _.$$p=null,l===y?S(c,"enum_for",["collect_concat"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):S(c,"map",[],l.$to_proc()).$flatten(1)}),F(M,"$compact",function(){return this.$to_a().$compact()}),F(M,"$count",function _(l){var c=_.$$p||y,d=y;return _.$$p=null,d=0,null!=l&&c!==y&&this.$warn("warning: given block not used"),de(null!=l)?c=S(Z,"proc",[],function(m){var x;return x=L(arguments),J.$destructure(x)["$=="](l)},-1):de(c["$nil?"]())&&(c=S(Z,"proc",[],X(!0))),S(this,"each",[],function(m){var x;return x=L(arguments),de(T(c,x))?d++:y},-1),d},-1),F(M,"$cycle",function _(l){var c=_.$$p||y,h=this;if(_.$$p=null,null==l&&(l=y),c===y)return S(h,"enum_for",["cycle",l],function $(){var re=null==$.$$s?this:$.$$s;return de(l["$nil?"]())?de(re["$respond_to?"]("size"))?R(R("Float"),"INFINITY"):y:(l=J["$coerce_to!"](l,R("Integer"),"to_int"),de(K(l,0))?P(re.$enumerator_size(),l):0)},{$$s:h});if(!de(l["$nil?"]())&&(l=J["$coerce_to!"](l,R("Integer"),"to_int"),de(l<=0)))return y;var p,m,d=[];if(h.$each.$$p=function(){var $=J.$destructure(arguments);f(c,$),d.push($)},h.$each(),0===d.length)return y;if(l===y)for(;;)for(p=0,m=d.length;p<m;p++)f(c,d[p]);else for(;l>1;){for(p=0,m=d.length;p<m;p++)f(c,d[p]);l--}},-1),F(M,"$detect",function _(l){try{var c=j("return"),h=_.$$p||y;return _.$$p=null,h===y?this.$enum_for("detect",l):(S(this,"each",[],function(m){var x,re=y;if(x=L(arguments),re=J.$destructure(x),!de(E.yield1(h,re)))return y;c.$throw(re)},{$$arity:-1,$$ret:c}),void 0!==l?"function"==typeof l?l():l:y)}catch(p){if(p===c)return p.$v;throw p}},-1),F(M,"$drop",function(l){l=ye(l,R("Integer"),"to_int"),de(l<0)&&Z.$raise(R("ArgumentError"),"attempt to drop negative size");var h=[],d=0;return this.$each.$$p=function(){l<=d&&h.push(J.$destructure(arguments)),d++},this.$each(),h}),F(M,"$drop_while",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return c.$enum_for("drop_while");var h=[],d=!0;return c.$each.$$p=function(){var p=J.$destructure(arguments);if(d){var m=f(l,p);de(m)||(d=!1,h.push(p))}else h.push(p)},c.$each(),h}),F(M,"$each_cons",function _(l){var c=_.$$p||y,h=this;if(_.$$p=null,de(1!=arguments.length)&&Z.$raise(R("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),l=J.$try_convert(l,R("Integer"),"to_int"),de(l<=0)&&Z.$raise(R("ArgumentError"),"invalid size"),c===y)return S(h,"enum_for",["each_cons",l],function p(){var x=y;return x=(null==p.$$s?this:p.$$s).$enumerator_size(),de(x["$nil?"]())?y:le(x,0)||de(H(x,l))?0:q(Y(x,l),1)},{$$s:h});var d=[];return h.$each.$$p=function(){var p=J.$destructure(arguments);d.push(p),d.length>l&&d.shift(),d.length==l&&f(c,d.slice(0,l))},h.$each(),h}),F(M,"$each_entry",function _(l){var d,c=_.$$p||y,p=this;return _.$$p=null,d=L(arguments),c===y?S(p,"to_enum",["each_entry"].concat(D(d)),function m(){return(null==m.$$s?this:m.$$s).$enumerator_size()},{$$s:p}):(p.$each.$$p=function(){var m=J.$destructure(arguments);f(c,m)},p.$each.apply(p,d),p)},-1),F(M,"$each_slice",function _(l){var c=_.$$p||y,h=this;if(_.$$p=null,l=ye(l,R("Integer"),"to_int"),de(l<=0)&&Z.$raise(R("ArgumentError"),"invalid slice size"),c===y)return S(h,"enum_for",["each_slice",l],function p(){var m=null==p.$$s?this:p.$$s;return de(m["$respond_to?"]("size"))?Q(m.$size(),l).$ceil():y},{$$s:h});var d=[];return h.$each.$$p=function(){var p=J.$destructure(arguments);d.push(p),d.length===l&&(f(c,d),d=[])},h.$each(),d.length>0&&f(c,d),h}),F(M,"$each_with_index",function _(l){var d,c=_.$$p||y,p=this;if(_.$$p=null,d=L(arguments),c===y)return S(p,"enum_for",["each_with_index"].concat(D(d)),function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:p});var m=0;return p.$each.$$p=function(){var x=J.$destructure(arguments);c(x,m),m++},p.$each.apply(p,d),p},-1),F(M,"$each_with_object",function _(l){var c=_.$$p||y,h=this;return _.$$p=null,c===y?S(h,"enum_for",["each_with_object",l],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:h}):(h.$each.$$p=function(){var d=J.$destructure(arguments);c(d,l)},h.$each(),l)}),F(M,"$entries",function(l){var h,d=this;h=L(arguments);var p=[];return d.$each.$$p=function(){p.push(J.$destructure(arguments))},d.$each.apply(d,h),p},-1),F(M,"$filter_map",function _(){var l=_.$$p||y,c=this;return _.$$p=null,l===y?S(c,"enum_for",["filter_map"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$s:c}):S(S(c,"map",[],l.$to_proc()),"select",[],"itself".$to_proc())}),F(M,"$find_all",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return S(c,"enum_for",["find_all"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=J.$destructure(arguments),p=f(l,d);de(p)&&h.push(d)},c.$each(),h}),F(M,"$find_index",function _(l){try{var c=j("return"),h=_.$$p||y,d=this,p=y;return _.$$p=null,de(void 0===l&&h===y)?d.$enum_for("find_index"):(null!=l&&h!==y&&d.$warn("warning: given block not used"),p=0,de(null!=l)?S(d,"each",[],function(x){var $;return $=L(arguments),le(J.$destructure($),l)&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}):S(d,"each",[],function(x){var $;return $=L(arguments),de(E.yieldX(h,D($)))&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}),y)}catch(m){if(m===c)return m.$v;throw m}},-1),F(M,"$first",function(l){try{var c=j("return"),d=y,p=y;return de(void 0===l)?S(this,"each",[],function(x){null==x&&(x=y),c.$throw(x)},{$$ret:c}):(d=[],l=ye(l,R("Integer"),"to_int"),de(l<0)&&Z.$raise(R("ArgumentError"),"attempt to take negative size"),de(0==l)?[]:(p=0,S(this,"each",[],function(x){var $;if($=L(arguments),d.push(J.$destructure($)),!de(l<=++p))return y;c.$throw(d)},{$$arity:-1,$$ret:c}),d))}catch(m){if(m===c)return m.$v;throw m}},-1),F(M,"$grep",function _(l){var c=_.$$p||y,d=y;return _.$$p=null,d=[],S(this,"each",[],function(m){var $,re=y;return re=O($=L(arguments)),de(S(l,"__send__",["==="].concat(D(re))))?(c!==y?(de(K($.$length(),1))&&($=[$]),$=E.yieldX(c,D($))):de(k($.$length(),1))&&($=$["$[]"](0)),d.$push($)):y},-1),d}),F(M,"$grep_v",function _(l){var c=_.$$p||y,d=y;return _.$$p=null,d=[],S(this,"each",[],function(m){var $,re=y;return re=O($=L(arguments)),de(S(l,"__send__",["==="].concat(D(re))))?y:(c!==y?(de(K($.$length(),1))&&($=[$]),$=E.yieldX(c,D($))):de(k($.$length(),1))&&($=$["$[]"](0)),d.$push($))},-1),d}),F(M,"$group_by",function _(){var c,l=_.$$p||y,h=this,d=y,p=y;return _.$$p=null,l===y?S(h,"enum_for",["group_by"],function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:h}):(d=N([],{}),h.$each.$$p=function(){var x=J.$destructure(arguments),$=f(l,x);(de(p=d["$[]"]($))?p:(c=[$,[]],S(d,"[]=",c),c[c.length-1]))["$<<"](x)},h.$each(),d)}),F(M,"$include?",function(l){try{var c=j("return");return S(this,"each",[],function(p){var m;if(m=L(arguments),!le(J.$destructure(m),l))return y;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(d){if(d===c)return d.$v;throw d}}),F(M,"$inject",function _(l,c){var h=_.$$p||y,d=this;_.$$p=null;var p=l;return h!==y&&void 0===c?d.$each.$$p=function(){var m=J.$destructure(arguments);void 0!==p?(m=T(h,[p,m]),p=m):p=m}:(void 0===c&&(R("Symbol")["$==="](l)||Z.$raise(R("TypeError"),l.$inspect()+" is not a Symbol"),c=l,p=void 0),d.$each.$$p=function(){var m=J.$destructure(arguments);p=void 0!==p?p.$__send__(c,m):m}),d.$each(),null==p?y:p},-1),F(M,"$lazy",function(){return S(R(R("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(h,d){var p;return null==h&&(h=y),p=L(arguments,1),S(h,"yield",D(p))},-2)}),F(M,"$enumerator_size",function(){return de(this["$respond_to?"]("size"))?this.$size():y}),F(M,"$max",function _(l){var d,p,c=_.$$p||y,h=this;return _.$$p=null,void 0===l||l===y?(h.$each.$$p=function(){var m=J.$destructure(arguments);void 0!==d?((p=c!==y?T(c,[m,d]):m["$<=>"](d))===y&&Z.$raise(R("ArgumentError"),"comparison failed"),p>0&&(d=m)):d=m},h.$each(),void 0===d?y:d):(l=ye(l,R("Integer"),"to_int"),S(h,"sort",[],c.$to_proc()).$reverse().$first(l))},-1),F(M,"$max_by",function _(l){var d,p,c=_.$$p||y,h=this;return _.$$p=null,null==l&&(l=y),de(c)?de(l["$nil?"]())?(h.$each.$$p=function(){var m=J.$destructure(arguments),x=f(c,m);if(void 0===d)return d=m,void(p=x);x["$<=>"](p)>0&&(d=m,p=x)},h.$each(),void 0===d?y:d):S(h,"sort_by",[],c.$to_proc()).$reverse().$take(l):S(h,"enum_for",["max_by",l],function m(){return(null==m.$$s?this:m.$$s).$enumerator_size()},{$$s:h})},-1),F(M,"$min",function _(l){var d,c=_.$$p||y,h=this;return _.$$p=null,null==l&&(l=y),de(l["$nil?"]())?(h.$each.$$p=c!==y?function(){var p=J.$destructure(arguments);if(void 0!==d){var m=c(p,d);m===y&&Z.$raise(R("ArgumentError"),"comparison failed"),m<0&&(d=p)}else d=p}:function(){var p=J.$destructure(arguments);void 0!==d?J.$compare(p,d)<0&&(d=p):d=p},h.$each(),void 0===d?y:d):c!==y?S(h,"sort",[],function(m,x){return null==m&&(m=y),null==x&&(x=y),E.yieldX(c,[m,x])}).$take(l):h.$sort().$take(l)},-1),F(M,"$min_by",function _(l){var d,p,c=_.$$p||y,h=this;return _.$$p=null,null==l&&(l=y),de(c)?de(l["$nil?"]())?(h.$each.$$p=function(){var m=J.$destructure(arguments),x=f(c,m);if(void 0===d)return d=m,void(p=x);x["$<=>"](p)<0&&(d=m,p=x)},h.$each(),void 0===d?y:d):S(h,"sort_by",[],c.$to_proc()).$take(l):S(h,"enum_for",["min_by",l],function m(){return(null==m.$$s?this:m.$$s).$enumerator_size()},{$$s:h})},-1),F(M,"$minmax",function _(){var h,l=_.$$p||y;_.$$p=null,l=de(h=l)?h:S(Z,"proc",[],function($,re){return null==$&&($=y),null==re&&(re=y),$["$<=>"](re)});var d=y,p=y,m=!0;return this.$each.$$p=function(){var x=J.$destructure(arguments);if(m)d=p=x,m=!1;else{var $=l.$call(d,x);$===y?Z.$raise(R("ArgumentError"),"comparison failed"):$>0&&(d=x);var re=l.$call(p,x);re===y?Z.$raise(R("ArgumentError"),"comparison failed"):re<0&&(p=x)}},this.$each(),[d,p]}),F(M,"$minmax_by",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,!de(l))return S(c,"enum_for",["minmax_by"],function x(){return(null==x.$$s?this:x.$$s).$enumerator_size()},{$$s:c});var p,m,h=y,d=y;return c.$each.$$p=function(){var x=J.$destructure(arguments),$=f(l,x);(void 0===p||$["$<=>"](p)<0)&&(h=x,p=$),(void 0===m||$["$<=>"](m)>0)&&(d=x,m=$)},c.$each(),[h,d]}),F(M,"$none?",function _(l){try{var c=j("return"),h=_.$$p||y;return _.$$p=null,de(void 0!==l)?S(this,"each",[],function(m){var re=y;if(re=O(L(arguments)),!de(S(l,"public_send",["==="].concat(D(re)))))return y;c.$throw(!1)},{$$arity:-1,$$ret:c}):S(this,"each",[],h!==y?function(m){var x;if(x=L(arguments),!de(E.yieldX(h,D(x))))return y;c.$throw(!1)}:function(m){var x,re=y;if(x=L(arguments),re=J.$destructure(x),!de(re))return y;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),F(M,"$one?",function _(l){try{var c=j("return"),h=_.$$p||y,p=y;return _.$$p=null,p=0,de(void 0!==l)?S(this,"each",[],function(x){var se=y;return se=O(L(arguments)),de(S(l,"public_send",["==="].concat(D(se))))?(p=q(p,1),de(K(p,1))?void c.$throw(!1):y):y},{$$arity:-1,$$ret:c}):S(this,"each",[],h!==y?function(x){var $;return $=L(arguments),de(E.yieldX(h,D($)))?(p=q(p,1),de(K(p,1))?void c.$throw(!1):y):y}:function(x){var $;return $=L(arguments),de(J.$destructure($))?(p=q(p,1),de(K(p,1))?void c.$throw(!1):y):y},{$$arity:-1,$$ret:c}),p["$=="](1)}catch(m){if(m===c)return m.$v;throw m}},-1),F(M,"$partition",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return S(c,"enum_for",["partition"],function m(){return(null==m.$$s?this:m.$$s).$enumerator_size()},{$$s:c});var h=[],d=[];return c.$each.$$p=function(){var m=J.$destructure(arguments),x=f(l,m);de(x)?h.push(m):d.push(m)},c.$each(),[h,d]}),F(M,"$reject",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return S(c,"enum_for",["reject"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c});var h=[];return c.$each.$$p=function(){var d=J.$destructure(arguments),p=f(l,d);de(p)||h.push(d)},c.$each(),h}),F(M,"$reverse_each",function _(){var l=_.$$p||y,c=this;if(_.$$p=null,l===y)return S(c,"enum_for",["reverse_each"],function p(){return(null==p.$$s?this:p.$$s).$enumerator_size()},{$$s:c});var h=[];c.$each.$$p=function(){h.push(arguments)},c.$each();for(var d=h.length-1;d>=0;d--)T(l,h[d]);return h}),F(M,"$slice_before",function _(l){var c=_.$$p||y,h=this;return _.$$p=null,de(void 0===l&&c===y)&&Z.$raise(R("ArgumentError"),"both pattern and block are given"),de(void 0!==l&&c!==y||arguments.length>1)&&Z.$raise(R("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),S(R("Enumerator"),"new",[],function d(p){var m=null==d.$$s?this:d.$$s;null==p&&(p=y);var x=[];m.$each.$$p=c!==y?void 0===l?function(){var $=J.$destructure(arguments),re=f(c,$);de(re)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)}:function(){var $=J.$destructure(arguments),re=c($,l.$dup());de(re)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)}:function(){var $=J.$destructure(arguments),re=l["$==="]($);de(re)&&x.length>0&&(p["$<<"](x),x=[]),x.push($)},m.$each(),x.length>0&&p["$<<"](x)},{$$s:h})},-1),F(M,"$slice_after",function _(l){var c=_.$$p||y,h=this;return _.$$p=null,de(void 0===l&&c===y)&&Z.$raise(R("ArgumentError"),"both pattern and block are given"),de(void 0!==l&&c!==y||arguments.length>1)&&Z.$raise(R("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),de(void 0!==l)&&(c=S(Z,"proc",[],function(p){return null==p&&(p=y),l["$==="](p)})),S(R("Enumerator"),"new",[],function d(p){var x,m=null==d.$$s?this:d.$$s;null==p&&(p=y),m.$each.$$p=function(){var $=J.$destructure(arguments),re=f(c,$);null==x&&(x=[]),de(re)?(x.push($),p.$yield(x),x=null):x.push($)},m.$each(),null!=x&&p.$yield(x)},{$$s:h})},-1),F(M,"$slice_when",function _(){var l=_.$$p||y;return _.$$p=null,l===y&&Z.$raise(R("ArgumentError"),"wrong number of arguments (0 for 1)"),S(R("Enumerator"),"new",[],function h(d){var p=null==h.$$s?this:h.$$s;null==d&&(d=y);var m=y,x=y;p.$each_cons.$$p=function(){var $=J.$destructure(arguments),re=$[0],se=$[1],De=T(l,[re,se]);x=se,m===y&&(m=[]),de(De)?(m.push(re),d.$yield(m),m=[]):m.push(re)},p.$each_cons(2),m!==y&&(m.push(x),d.$yield(m))},{$$s:this})}),F(M,"$sort",function _(){var h,l=_.$$p||y;return _.$$p=null,h=this.$to_a(),l===y&&(l=te(function(p,m){return null==p&&(p=y),null==m&&(m=y),p["$<=>"](m)})),S(h,"sort",[],l.$to_proc())}),F(M,"$sort_by",function _(){var l=_.$$p||y,c=this,h=y;return _.$$p=null,l===y?S(c,"enum_for",["sort_by"],function d(){return(null==d.$$s?this:d.$$s).$enumerator_size()},{$$s:c}):(h=S(c,"map",[],function(){var p=y;return p=J.$destructure(arguments),[E.yield1(l,p),p]}),S(h,"sort!",[],function(p,m){return null==p&&(p=y),null==m&&(m=y),p[0]["$<=>"](m[0])}),S(h,"map!",[],function(p){return null==p&&(p=y),p[1]}))}),F(M,"$sum",function _(l){var c=_.$$p||y,d=y,p=y;return _.$$p=null,null==l&&(l=0),d=l,p=0,S(this,"each",[],function(x){var re,se=y,De=y,Ae=y;return re=L(arguments),se=c!==y?E.yieldX(c,D(re)):J.$destructure(re),U([R(R("Float"),"INFINITY"),R(R("Float"),"INFINITY")["$-@"]()]["$include?"](se))&&de(se["$respond_to?"]("-"))?(De=Y(se,p),Ae=q(d,De),p=Y(Y(Ae,d),De),d=Ae):d=q(d,se)},-1),d},-1),F(M,"$take",function(l){return this.$first(l)}),F(M,"$take_while",function _(){try{var l=j("return"),c=_.$$p||y,d=y;return _.$$p=null,de(c)?(d=[],S(this,"each",[],function(m){var x,re=y;return x=L(arguments),re=J.$destructure(x),de(E.yield1(c,re))||l.$throw(d),d.push(re)},{$$arity:-1,$$ret:l})):this.$enum_for("take_while")}catch(p){if(p===l)return p.$v;throw p}}),F(M,"$uniq",function _(){var l=_.$$p||y,h=y;return _.$$p=null,h=N([],{}),S(this,"each",[],function(p){var m,$,re=y,se=y;return m=L(arguments),re=J.$destructure(m),se=l!==y?E.yield1(l,re):re,de(h["$key?"](se))?y:(S(h,"[]=",$=[se,re]),$[$.length-1])},-1),h.$values()}),F(M,"$tally",function(l){var h;return l&&l!==y&&ne(l),h=S(S(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),de(l)?(S(h,"each",[],function(p,m){var x;return null==p&&(p=y),null==m&&(m=y),x=[p,q(l.$fetch(p,0),m)],S(l,"[]=",x),x[x.length-1]}),l):h},-1),F(M,"$to_h",function _(l){var d,c=_.$$p||y,p=this;if(_.$$p=null,d=L(arguments),c!==y)return S(S(p,"map",[],c.$to_proc()),"to_h",D(d));var m=N([],{});return p.$each.$$p=function(){var x=J.$destructure(arguments),$=J["$coerce_to?"](x,R("Array"),"to_ary");$.$$is_array||Z.$raise(R("TypeError"),"wrong element type "+$.$class()+" (expected array)"),2!==$.length&&Z.$raise(R("ArgumentError"),"wrong array length (expected 2, was "+$.$length()+")"),E.hash_put(m,$[0],$[1])},p.$each.apply(p,d),m},-1),F(M,"$to_set",function _(l,c){var d,p,h=_.$$p||y,x=this;return _.$$p=null,(d=L(arguments)).length>0&&(p=d.shift()),null==p&&(p=B("Set")),S(p,"new",[x].concat(D(d)),h.$to_proc())},-1),F(M,"$zip",function _(l){var d,p=this;return _.$$p=null,d=L(arguments),S(p.$to_a(),"zip",D(d))},-1),I(M,"find","detect"),I(M,"filter","find_all"),I(M,"flat_map","collect_concat"),I(M,"map","collect"),I(M,"member?","include?"),I(M,"reduce","inject"),I(M,"select","find_all"),I(M,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(E){var N,te,U,de=E.klass,ye=E.truthy,f=E.to_a,T=E.eqeq,ne=E.Kernel,v=E.def,S=E.rb_gt,L=E.rb_lt,D=E.rb_le,J=E.rb_ge,j=E.rb_plus,F=E.rb_minus,Z=E.eqeqeq,X=E.not,K=E.rb_times,P=E.rb_divide,H=E.alias,q=E.nil,Y=E.$$$;return N=[],U=[te=de("::",null,"Enumerator")].concat(N),function(I,A,y){var R=de(I,A,"ArithmeticSequence"),z=[R].concat(y),ie=E.$r(z),M=R.$$prototype;M.step_arg2=M.receiver_num=M.step_arg1=M.step=M.range=M.topfx=M.bypfx=M.creation_method=M.skipped_arg=q,E.prop(R.$$prototype,"$$is_arithmetic_seq",!0);var ge=1/0;return v(R,"$initialize",function(O,_,l){var c,h=this,d=q;return null==l&&(l="step"),h.creation_method=l,ye(O["$is_a?"](Y("Array")))?(c=[].concat(f(O)),h.step_arg1=null==c[0]?q:c[0],h.step_arg2=null==c[1]?q:c[1],h.topfx=null==c[2]?q:c[2],h.bypfx=null==c[3]?q:c[3],h.receiver_num=_,h.step=1,h.range=ye(h.step_arg2)?(h.step=h.step_arg2,E.Range.$new(h.receiver_num,h.step_arg1,!1)):ye(h.step_arg1)?E.Range.$new(h.receiver_num,h.step_arg1,!1):E.Range.$new(h.receiver_num,q,!1)):(ye(_)||(h.skipped_arg=!0),c=[O,ye(d=_)?d:1],h.range=c[0],h.step=c[1]),h.object=h,T(h.step,0)&&ne.$raise(ie("ArgumentError"),"step can't be 0"),ye(h.step["$respond_to?"]("to_int"))?q:ne.$raise(ie("ArgumentError"),"no implicit conversion of "+h.step.$class()+" into Integer")},-2),R.$attr_reader("step"),v(R,"$begin",function(){return this.range.$begin()}),v(R,"$end",function(){return this.range.$end()}),v(R,"$exclude_end?",function(){return this.range["$exclude_end?"]()}),v(R,"$_lesser_than_end?",function(O){var l,c,_=this;return l=ye(c=_.$end())?c:ge,ye(S(_.$step(),0))?ye(_["$exclude_end?"]())?L(O,l):D(O,l):ye(_["$exclude_end?"]())?S(O,l):J(O,l)}),v(R,"$_greater_than_begin?",function(O){var l,c;return l=ye(c=this.$begin())?c:ge["$-@"](),ye(S(this.$step(),0))?S(O,l):L(O,l)}),v(R,"$first",function(O){var _=this,l=q,c=q,h=q;if(l=ye(c=_.$begin())?c:ge["$-@"](),!ye(O))return ye(_["$_lesser_than_end?"](l))?l:q;for(h=[];ye(ye(c=_["$_lesser_than_end?"](l))?S(O,0):c);)h["$<<"](l),l=j(l,_.$step()),O=F(O,1);return h},-1),v(R,"$each",function B(){var l,O=B.$$p||q,_=this,c=q;if(B.$$p=null,O===q)return _;for(Z(q,_.$begin())&&ne.$raise(ie("TypeError"),"nil can't be coerced into Integer"),c=ye(l=_.$begin())?l:ge["$-@"]();ye(_["$_lesser_than_end?"](c));)E.yield1(O,c),c=j(c,_.$step());return _}),v(R,"$last",function(O){var _=this,l=q,c=q,h=q;if(Z(ge,l=_.$end())||Z(ge["$-@"](),l)?ne.$raise(Y("FloatDomainError"),_.$end()):Z(q,l)&&ne.$raise(Y("RangeError"),"cannot get the last element of endless arithmetic sequence"),c=F(_.$end(),F(_.$end(),_.$begin())["$%"](_.$step())),ye(_["$_lesser_than_end?"](c))||(c=F(c,_.$step())),!ye(O))return ye(_["$_greater_than_begin?"](c))?c:q;for(h=[];ye(ye(l=_["$_greater_than_begin?"](c))?S(O,0):l);)h["$<<"](c),c=F(c,_.$step()),O=F(O,1);return h.$reverse()},-1),v(R,"$size",function(){var _,O=this,l=q;return _=ye(S(O.$step(),0))?1:-1,X(O["$_lesser_than_end?"](O.$begin()))?0:ye([ge["$-@"](),ge]["$include?"](O.$step()))?1:ye([K(ge["$-@"](),_),q]["$include?"](O.$begin()))||ye([K(ge,_),q]["$include?"](O.$end()))?ge:(l=F(O.$end(),F(O.$end(),O.$begin())["$%"](O.$step())),ye(O["$_lesser_than_end?"](l))||(l=F(l,O.$step())),j(P(F(l,O.$begin()),O.$step()).$abs().$to_i(),1))}),v(R,"$==",function(O){var l,c,h,d,_=this;return ye(l=ye(c=ye(h=ye(d=_.$class()["$=="](O.$class()))?_.$begin()["$=="](O.$begin()):d)?_.$end()["$=="](O.$end()):h)?_.$step()["$=="](O.$step()):c)?_["$exclude_end?"]()["$=="](O["$exclude_end?"]()):l}),v(R,"$hash",function(){var O=this;return[O.$begin(),O.$end(),O.$step(),O["$exclude_end?"]()].$hash()}),v(R,"$inspect",function(){var O=this,_=q;return ye(O.receiver_num)?(_=ye(O.step_arg2)?"("+O.topfx+O.step_arg1.$inspect()+", "+O.bypfx+O.step_arg2.$inspect()+")":ye(O.step_arg1)?"("+O.topfx+O.step_arg1.$inspect()+")":q,"("+O.receiver_num.$inspect()+"."+O.creation_method+_+")"):(_=ye(O.skipped_arg)?q:"("+O.step+")","(("+O.range.$inspect()+")."+O.creation_method+_+")")}),H(R,"===","=="),H(R,"eql?","==")}(te,te,U)},Opal.modules["corelib/enumerator/chain"]=function(E){var H,le,X,de=E.deny_frozen_access,ye=E.klass,f=E.slice,T=E.def,ne=E.send,v=E.to_a,S=E.truthy,L=E.rb_plus,D=E.thrower,J=E.nil,j=E.$$$;return X=ye("::",null,"Enumerator"),(le=(H=ye(X,X,"Chain")).$$prototype).enums=le.iterated=J,T(H,"$initialize",function(Y){var k,N=this;return k=f(arguments),de(N),N.enums=k,N.iterated=[],N.object=N},-1),T(H,"$each",function q(Y){var k,N,Q=q.$$p||J,te=this;return q.$$p=null,k=f(arguments),N=k,Q===J?ne(te,"to_enum",["each"].concat(v(N)),function U(){return(null==U.$$s?this:U.$$s).$size()},{$$s:te}):(ne(te.enums,"each",[],function U(I){var A=null==U.$$s?this:U.$$s;return null==A.iterated&&(A.iterated=J),null==I&&(I=J),A.iterated["$<<"](I),ne(I,"each",v(N),Q.$to_proc())},{$$s:te}),te)},-1),T(H,"$size",function(Y){try{var k,N,Q=D("return"),te=this,U=J;return k=f(arguments),N=k,U=0,ne(te.enums,"each",[],function(A){var y;return null==A&&(A=J),y=ne(A,"size",v(N)),S([J,j(j("Float"),"INFINITY")]["$include?"](y))&&Q.$throw(y),U=L(U,y)},{$$ret:Q}),U}catch(I){if(I===Q)return I.$v;throw I}},-1),T(H,"$rewind",function(){var Y=this;return ne(Y.iterated,"reverse_each",[],function(k){return null==k&&(k=J),S(k["$respond_to?"]("rewind"))?k.$rewind():J}),Y.iterated=[],Y}),T(H,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"})},Opal.modules["corelib/enumerator/generator"]=function(E){var Z,le,q,Y,Q,K,de=E.deny_frozen_access,ye=E.klass,f=E.truthy,T=E.Kernel,ne=E.def,v=E.slice,S=E.send,L=[],D=E.nil,J=E.$$$;return Z=L,le=K=[ye(L[0],null,"Enumerator")].concat(Z),Y=[q=ye(K[0],null,"Generator")].concat(le),Q=E.$r(Y),q.$$prototype.block=D,q.$include(J("Enumerable")),ne(q,"$initialize",function N(){var te=N.$$p||D;return N.$$p=null,de(this),f(te)||T.$raise(J("LocalJumpError"),"no block given"),this.block=te}),ne(q,"$each",function N(te){var A,U=N.$$p||D,y=this,R=D;N.$$p=null,A=v(arguments),R=S(Q("Yielder"),"new",[],U.$to_proc());try{A.unshift(R),E.yieldX(y.block,A)}catch(z){if(z&&"breaker"==z.$thrower_type)return z.$v;throw z}return y},-1)},Opal.modules["corelib/enumerator/lazy"]=function(E){var I,ie,M,ge,B,A,de=E.truthy,ye=E.coerce_to,f=E.yield1,T=E.yieldX,ne=E.deny_frozen_access,v=E.klass,S=E.slice,L=E.send2,D=E.find_super,J=E.to_a,j=E.defs,F=E.Kernel,Z=E.send,X=E.def,K=E.return_self,P=E.Opal,H=E.rb_lt,le=E.eqeqeq,q=E.rb_plus,Y=E.alias,k=E.nil,N=E.$$$;return I=[],ie=[A=v("::",null,"Enumerator")].concat(I),ge=[M=v(A,A,"Lazy")].concat(ie),B=E.$r(ge),M.$$prototype.enumerator=k,v(M,N("Exception"),"StopLazyError"),j(M,"$for",function _(l,c){var d,p=_.$$p||k,m=this,x=k;return _.$$p=null,d=S(arguments,1),(x=L(m,D(m,"for",_,!1,!0),"for",[l].concat(J(d)),p)).enumerator=l,x},-2),X(M,"$initialize",function _(l,c){var h=_.$$p||k,d=this;return _.$$p=null,null==c&&(c=k),ne(d),h===k&&F.$raise(N("ArgumentError"),"tried to call lazy new without a block"),d.enumerator=l,L(d,D(d,"initialize",_,!1,!0),"initialize",[c],function(m,x){var re;null==m&&(m=k),re=S(arguments,1);try{return Z(l,"each",J(re),function(De){var fe;(fe=S(arguments)).unshift(m),T(h,fe)},-1)}catch(se){if(!E.rescue(se,[B("StopLazyError")]))throw se;try{return k}finally{E.pop_exception()}}},-2)},-2),X(M,"$lazy",K),X(M,"$collect",function _(){var l=_.$$p||k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy map without a block"),Z(B("Lazy"),"new",[this,this.$enumerator_size()],function(d,p){var m;null==d&&(d=k),m=S(arguments,1);var $=T(l,m);d.$yield($)},-2)}),X(M,"$collect_concat",function _(){var l=_.$$p||k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy map without a block"),Z(B("Lazy"),"new",[this,k],function(d,p){var m;null==d&&(d=k),m=S(arguments,1);var $=T(l,m);if($["$respond_to?"]("force")&&$["$respond_to?"]("each"))Z($,"each",[],function(De){return null==De&&(De=k),d.$yield(De)});else{var re=P.$try_convert($,N("Array"),"to_ary");re===k?d.$yield($):Z($,"each",[],function(De){return null==De&&(De=k),d.$yield(De)})}},-2)}),X(M,"$drop",function(l){var h,d,p=k;return l=ye(l,N("Integer"),"to_int"),de(H(l,0))&&F.$raise(N("ArgumentError"),"attempt to drop negative size"),h=this.$enumerator_size(),d=le(N("Integer"),h)&&de(H(l,h))?l:h,p=0,Z(B("Lazy"),"new",[this,d],function(x,$){var se;return null==x&&(x=k),se=S(arguments,1),de(H(p,l))?p=q(p,1):Z(x,"yield",J(se))},-2)}),X(M,"$drop_while",function _(){var l=_.$$p||k,h=k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy drop_while without a block"),h=!0,Z(B("Lazy"),"new",[this,k],function(p,m){var $;if(null==p&&(p=k),$=S(arguments,1),!de(h))return Z(p,"yield",J($));var re=T(l,$);de(re)||(h=!1,Z(p,"yield",J($)))},-2)}),X(M,"$enum_for",function _(l,c){var d,p,m,h=_.$$p||k,x=this;return _.$$p=null,(d=S(arguments)).length>0&&(p=d.shift()),null==p&&(p="each"),m=d,Z(x.$class(),"for",[x,p].concat(J(m)),h.$to_proc())},-1),X(M,"$find_all",function _(){var l=_.$$p||k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy select without a block"),Z(B("Lazy"),"new",[this,k],function(d,p){var m,x;null==d&&(d=k),m=S(arguments,1);var $=T(l,x=m);de($)&&Z(d,"yield",J(x))},-2)}),X(M,"$grep",function _(l){var c=_.$$p||k;return _.$$p=null,de(c)?Z(B("Lazy"),"new",[this,k],function(p,m){var x;null==p&&(p=k),x=S(arguments,1);var re=P.$destructure(x),se=l["$==="](re);de(se)&&(se=f(c,re),p.$yield(f(c,re)))},-2):Z(B("Lazy"),"new",[this,k],function(p,m){var x;null==p&&(p=k),x=S(arguments,1);var re=P.$destructure(x),se=l["$==="](re);de(se)&&p.$yield(re)},-2)}),X(M,"$reject",function _(){var l=_.$$p||k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy reject without a block"),Z(B("Lazy"),"new",[this,k],function(d,p){var m,x;null==d&&(d=k),m=S(arguments,1);var $=T(l,x=m);de($)||Z(d,"yield",J(x))},-2)}),X(M,"$take",function(l){var h,d,p=k;return l=ye(l,N("Integer"),"to_int"),de(H(l,0))&&F.$raise(N("ArgumentError"),"attempt to take negative size"),h=this.$enumerator_size(),d=le(N("Integer"),h)&&de(H(l,h))?l:h,p=0,Z(B("Lazy"),"new",[this,d],function(x,$){var se;return null==x&&(x=k),se=S(arguments,1),de(H(p,l))?(Z(x,"yield",J(se)),p=q(p,1)):F.$raise(B("StopLazyError"))},-2)}),X(M,"$take_while",function _(){var l=_.$$p||k;return _.$$p=null,de(l)||F.$raise(N("ArgumentError"),"tried to call lazy take_while without a block"),Z(B("Lazy"),"new",[this,k],function(d,p){var m,x;null==d&&(d=k),m=S(arguments,1);var $=T(l,x=m);de($)?Z(d,"yield",J(x)):F.$raise(B("StopLazyError"))},-2)}),X(M,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"}),Y(M,"force","to_a"),Y(M,"filter","find_all"),Y(M,"flat_map","collect_concat"),Y(M,"map","collect"),Y(M,"select","find_all"),Y(M,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(E){var J,K,F,de=E.klass,ye=E.def,f=E.slice,T=E.send,ne=E.to_a,v=[],S=E.nil;return J=v,F=[de(v[0],null,"Enumerator")].concat(J),(K=de(F[0],null,"Yielder")).$$prototype.block=S,ye(K,"$initialize",function H(){var le=H.$$p||S;return H.$$p=null,this.block=le,this}),ye(K,"$yield",function(le){var q,Q=this;q=f(arguments);var k=E.yieldX(Q.block,q);if(k&&"break"==k.$thrower_type)throw k;return k},-1),ye(K,"$<<",function(le){return this.$yield(le),this}),ye(K,"$to_proc",function(){return T(this,"proc",[],function q(Y){var Q,N=null==q.$$s?this:q.$$s;return Q=f(arguments),T(N,"yield",ne(Q))},{$$arity:-1,$$s:this})})},Opal.modules["corelib/enumerator"]=function(E){var U,I,A,y,R,de=E.slice,ye=E.coerce_to,f=E.deny_frozen_access,T=E.klass,ne=E.defs,v=E.truthy,S=E.send,L=E.not,D=E.def,J=E.rb_plus,j=E.to_a,F=E.Opal,Z=E.send2,X=E.find_super,K=E.rb_ge,P=E.Kernel,H=E.rb_le,le=E.alias,Q=E.nil,k=E.$$$;return E.top.$require("corelib/enumerable"),U=[],A=[I=T("::",null,"Enumerator")].concat(U),y=E.$r(A),(R=I.$$prototype).size=R.args=R.object=R.method=R.values=R.cursor=Q,I.$include(k("Enumerable")),I.$$prototype.$$is_enumerator=!0,ne(I,"$for",function z(ie,M,ge){var O,_,l,B=z.$$p||Q,c=this;z.$$p=null,(O=de(arguments,1)).length>0&&(_=O.shift()),null==_&&(_="each"),l=O;var h=c.$allocate();return h.object=ie,h.size=B,h.method=_,h.args=l,h.cursor=0,h},-2),D(I,"$initialize",function z(ie){var M=z.$$p||Q,O=this;return z.$$p=null,de(arguments),f(O),O.cursor=0,v(M)?(O.object=S(y("Generator"),"new",[],M.$to_proc()),O.method="each",O.args=[],O.size=arguments[0]||Q,v(O.size)&&L(O.size["$respond_to?"]("call"))?O.size=ye(O.size,k("Integer"),"to_int"):Q):(O.object=arguments[0],O.method=arguments[1]||"each",O.args=de(arguments,2),O.size=Q)},-1),D(I,"$each",function z(ie){var B,M=z.$$p||Q,O=this;return z.$$p=null,B=de(arguments),v(M["$nil?"]())&&v(B["$empty?"]())?O:(B=J(O.args,B),v(M["$nil?"]())?S(O.$class(),"new",[O.object,O.method].concat(j(B))):S(O.object,"__send__",[O.method].concat(j(B)),M.$to_proc()))},-1),D(I,"$size",function(){return v(this.size["$respond_to?"]("call"))?S(this.size,"call",j(this.args)):this.size}),D(I,"$with_index",function z(ie){var M=z.$$p||Q;if(z.$$p=null,null==ie&&(ie=0),ie=v(ie)?ye(ie,k("Integer"),"to_int"):0,!v(M))return S(this,"enum_for",["with_index",ie],function _(){return(null==_.$$s?this:_.$$s).$size()},{$$s:this});var O=ie;return this.$each.$$p=function(){var _=F.$destructure(arguments),l=M(_,O);return O++,l},this.$each()},-1),D(I,"$each_with_index",function z(){var ie=z.$$p||Q,M=this;return z.$$p=null,ie===Q?S(M,"enum_for",["each_with_index"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:M}):(Z(M,X(M,"each_with_index",z,!1,!0),"each_with_index",[],ie),M.object)}),D(I,"$rewind",function(){return this.cursor=0,this}),D(I,"$peek_values",function(){var M,ie=this;return ie.values=v(M=ie.values)?M:S(ie,"map",[],function(B){return de(arguments)},-1),v(K(ie.cursor,ie.values.$length()))&&P.$raise(k("StopIteration"),"iteration reached an end"),ie.values["$[]"](ie.cursor)}),D(I,"$peek",function(){var M=Q;return M=this.$peek_values(),v(H(M.$length(),1))?M["$[]"](0):M}),D(I,"$next_values",function(){var M;return M=this.$peek_values(),this.cursor=J(this.cursor,1),M}),D(I,"$next",function(){var M=Q;return M=this.$next_values(),v(H(M.$length(),1))?M["$[]"](0):M}),D(I,"$feed",function(ie){return this.$raise(y("NotImplementedError"),"Opal doesn't support Enumerator#feed")}),D(I,"$+",function(ie){return k(k("Enumerator"),"Chain").$new(this,ie)}),D(I,"$inspect",function(){var ie=this,M=Q;return M="#<"+ie.$class()+": "+ie.object.$inspect()+":"+ie.method,v(ie.args["$any?"]())&&(M=J(M,"("+ie.args.$inspect()["$[]"](k("Range").$new(1,-2))+")")),J(M,">")}),le(I,"with_object","each_with_object"),I.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),I.$autoload("Chain","corelib/enumerator/chain"),I.$autoload("Generator","corelib/enumerator/generator"),I.$autoload("Lazy","corelib/enumerator/lazy"),I.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(E){var R,de=E.klass,ye=E.truthy,f=E.Kernel,T=E.def,ne=E.to_ary,v=E.return_self,S=E.rb_minus,L=E.rb_times,D=E.rb_lt,J=E.eqeq,j=E.rb_divide,F=E.return_val,Z=E.Opal,X=E.slice,K=E.extract_kwargs,P=E.ensure_kwargs,H=E.not,le=E.send,q=E.rb_ge,Y=E.rb_le,Q=E.rb_plus,k=E.rb_gt,N=E.alias,U=E.nil,I=E.$$$;return E.top.$require("corelib/comparable"),(R=de("::",null,"Numeric")).$include(I("Comparable")),T(R,"$coerce",function(ie){var M=this;return ye(ie["$instance_of?"](M.$class()))?[ie,M]:[f.$Float(ie),f.$Float(M)]}),T(R,"$__coerced__",function(ie,M){var ge,B;if(ye(M["$respond_to?"]("coerce")))return B=M.$coerce(this),(null==(ge=ne(B))[0]?U:ge[0]).$__send__(ie,null==ge[1]?U:ge[1]);switch(ie){case"+":case"-":case"*":case"/":case"%":case"&":case"|":case"^":case"**":return f.$raise(I("TypeError"),M.$class()+" can't be coerced into Numeric");case">":case">=":case"<":case"<=":case"<=>":return f.$raise(I("ArgumentError"),"comparison of "+this.$class()+" with "+M.$class()+" failed");default:return U}}),T(R,"$<=>",function(ie){return ye(this["$equal?"](ie))?0:U}),T(R,"$+@",v),T(R,"$-@",function(){return S(0,this)}),T(R,"$%",function(ie){return S(this,L(ie,this.$div(ie)))}),T(R,"$abs",function(){return D(this,0)?this["$-@"]():this}),T(R,"$abs2",function(){return L(this,this)}),T(R,"$angle",function(){return D(this,0)?I(I("Math"),"PI"):0}),T(R,"$ceil",function(ie){return null==ie&&(ie=0),this.$to_f().$ceil(ie)},-1),T(R,"$conj",v),T(R,"$denominator",function(){return this.$to_r().$denominator()}),T(R,"$div",function(ie){return J(ie,0)&&f.$raise(I("ZeroDivisionError"),"divided by o"),j(this,ie).$floor()}),T(R,"$divmod",function(ie){return[this.$div(ie),this["$%"](ie)]}),T(R,"$fdiv",function(ie){return j(this.$to_f(),ie)}),T(R,"$floor",function(ie){return null==ie&&(ie=0),this.$to_f().$floor(ie)},-1),T(R,"$i",function(){return f.$Complex(0,this)}),T(R,"$imag",F(0)),T(R,"$integer?",F(!1)),T(R,"$nonzero?",function(){return ye(this["$zero?"]())?U:this}),T(R,"$numerator",function(){return this.$to_r().$numerator()}),T(R,"$polar",function(){return[this.$abs(),this.$arg()]}),T(R,"$quo",function(ie){return j(Z["$coerce_to!"](this,I("Rational"),"to_r"),ie)}),T(R,"$real",v),T(R,"$real?",F(!0)),T(R,"$rect",function(){return[this,0]}),T(R,"$round",function(ie){return this.$to_f().$round(ie)},-1),T(R,"$step",function z(ie,M,ge){var O,_,l,c,h,d,B=z.$$p||U,p=this,m=U;function x(){c===U&&f.$raise(I("TypeError"),"step must be numeric"),null!=c&&c["$=="](0)&&f.$raise(I("ArgumentError"),"step can't be 0"),(c===U||null==c)&&(c=1);var pe=c["$<=>"](0);pe===U&&f.$raise(I("ArgumentError"),"0 can't be coerced into "+c.$class()),(l===U||null==l)&&(l=pe>0?I(I("Float"),"INFINITY"):I(I("Float"),"INFINITY")["$-@"]()),Z.$compare(p,l)}function $(){if(c>0&&p>l||c<0&&p<l)return 0;if(c===1/0||c===-1/0)return 1;var pe=Math.abs,Me=Math.floor,Ce=(pe(p)+pe(l)+pe(l-p))/pe(c)*I(I("Float"),"EPSILON");return Ce===1/0||Ce===-1/0?0:(Ce>.5&&(Ce=.5),Me((l-p)/c+Ce)+1)}function re(){if(x(),0===c)return 1/0;if(c%1!=0)return $();if(c>0&&p>l||c<0&&p<l)return 0;var pe=Math.ceil,Me=Math.abs;return pe((Me(p-l)+1)/Me(c))}if(z.$$p=null,O=X(arguments),_=K(O),_=P(_),O.length>0&&(l=O.shift()),O.length>0&&(c=O.shift()),h=_.$$smap.to,d=_.$$smap.by,void 0!==l&&void 0!==h&&f.$raise(I("ArgumentError"),"to is given twice"),void 0!==c&&void 0!==d&&f.$raise(I("ArgumentError"),"step is given twice"),void 0!==h&&(l=h),void 0!==d&&(c=d),void 0===l&&(l=U),B===U)return(H(l)||ye(l["$is_a?"](I("Numeric"))))&&(H(c)||ye(c["$is_a?"](I("Numeric"))))?I(I("Enumerator"),"ArithmeticSequence").$new([l,c,ye(h)?"to: ":U,ye(d)?"by: ":U],p):le(p,"enum_for",["step",l,c],re.$to_proc());x();var se=c["$negative?"](),De=c["$=="](0)||l===1/0&&!se||l===-1/0&&se;if(p.$$is_number&&c.$$is_number&&l.$$is_number){if(p%1!=0||!De&&l%1!=0||c%1!=0){var fe=p.$to_f().valueOf();c=c.$to_f().valueOf(),l=l.$to_f().valueOf();var Pe=$();if(isFinite(c))if(0===c)for(;;)B(fe);else for(var be=0;be<Pe;be++){var xe=be*c+p;(c>=0?l<xe:l>xe)&&(xe=l),B(xe)}else 0!==Pe&&B(fe);return p}var Ae=p;if(De)for(;;Ae+=c)B(Ae);else if(se)for(;Ae>=l;Ae+=c)B(Ae);else for(;Ae<=l;Ae+=c)B(Ae);return p}for(m=p;ye(se?q(m,l):Y(m,l));)E.yield1(B,m),m=Q(m,c)},-1),T(R,"$to_c",function(){return f.$Complex(this,0)}),T(R,"$to_int",function(){return this.$to_i()}),T(R,"$truncate",function(ie){return null==ie&&(ie=0),this.$to_f().$truncate(ie)},-1),T(R,"$zero?",function(){return this["$=="](0)}),T(R,"$positive?",function(){return k(this,0)}),T(R,"$negative?",function(){return D(this,0)}),T(R,"$dup",v),T(R,"$clone",function(ie){return ie=P(ie),this},-1),T(R,"$finite?",F(!0)),T(R,"$infinite?",F(U)),N(R,"arg","angle"),N(R,"conjugate","conj"),N(R,"imaginary","imag"),N(R,"magnitude","abs"),N(R,"modulo","%"),N(R,"phase","arg"),N(R,"rectangular","rect")},Opal.modules["corelib/array"]=function(E){var de=E.truthy,ye=E.falsy,f=E.hash_ids,T=E.yield1,ne=E.hash_get,v=E.hash_put,S=E.hash_delete,L=E.coerce_to,D=E.respond_to,J=E.deny_frozen_access,j=E.freeze,F=E.klass,Z=E.slice,X=E.defs,K=E.Kernel,P=E.def,H=E.Opal,le=E.eqeqeq,q=E.hash2,Y=E.send2,Q=E.find_super,k=E.send,N=E.rb_gt,te=E.rb_times,U=E.eqeq,I=E.rb_minus,A=E.to_a,y=E.to_ary,R=E.gvars,z=E.rb_ge,ie=E.assign_ivar,M=E.rb_lt,ge=E.return_self,B=E.neqeq,O=E.alias,_=E.top,c=E.nil,h=E.$$$;return _.$require("corelib/enumerable"),_.$require("corelib/numeric"),function(d,p,m){var x=F("::",Array,"Array"),$=[x].concat([]),re=E.$r($);function De(Ce,ae){return ae.$$name===E.Array?Ce:ae.$allocate().$replace(Ce.$to_a())}function Ae(Ce,ae,he){for(var Ee,C=null,V=new Array(Ce.length),$e=0,Te=0,Fe=Ce.length;$e<Fe;$e++){if(!C)try{Ee=T(he,Ce[$e])}catch(Ue){C=Ue}(C||ae(Ee))&&(V[Te]=Ce[$e],Te+=1)}if(Te!==$e&&(Ce.splice.apply(Ce,[0,V.length].concat(V)),Ce.splice(Te,V.length)),C)throw C}function fe(Ce,ae){var Ee,C,V,he=Ce.length;return Ee=ae.excl,C=ae.begin===c?0:L(ae.begin,E.Integer,"to_int"),V=ae.end===c?-1:L(ae.end,E.Integer,"to_int"),C<0&&(C+=he)<0||(ae.excl_rev&&ae.begin!==c&&(C+=1),C>he)?c:V<0&&(V+=he)<0?[]:((!Ee||ae.end===c)&&(V+=1),Ce.slice(C,V))}function xe(Ce,ae){return Ce===ae||0===ae?1:ae>0&&Ce>ae?xe(Ce-1,ae-1)+xe(Ce-1,ae):0}x.$include(h("Enumerable")),E.prop(x.$$prototype,"$$is_array",!0),X(x,"$[]",function(ae){var C=this;return De(Z(arguments),C)},-1),P(x,"$initialize",function Ce(ae,he){var V,$e,Ee=Ce.$$p||c,C=this;if(Ce.$$p=null,null==ae&&(ae=c),null==he&&(he=c),J(C),he!==c&&Ee!==c&&K.$warn("warning: block supersedes default value argument"),ae>h(h("Integer"),"MAX")&&K.$raise(h("ArgumentError"),"array size too big"),arguments.length>2&&K.$raise(h("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return C.splice(0,C.length),C;if(1===arguments.length){if(ae.$$is_array)return C.$replace(ae.$to_a()),C;if(ae["$respond_to?"]("to_ary"))return C.$replace(ae.$to_ary()),C}if((ae=L(ae,h("Integer"),"to_int"))<0&&K.$raise(h("ArgumentError"),"negative array size"),C.splice(0,C.length),Ee===c)for(V=0;V<ae;V++)C.push(he);else for(V=0;V<ae;V++)$e=Ee(V),C[V]=$e;return C},-1),X(x,"$try_convert",function(ae){return H["$coerce_to?"](ae,h("Array"),"to_ary")}),P(x,"$&",function(ae){ae=le(h("Array"),ae)?ae.$to_a():L(ae,h("Array"),"to_ary").$to_a();var V,$e,Te,Ee=[],C=q([],{});for(V=0,$e=ae.length;V<$e;V++)v(C,ae[V],!0);for(V=0,$e=this.length;V<$e;V++)void 0!==S(C,Te=this[V])&&Ee.push(Te);return Ee}),P(x,"$|",function(ae){ae=le(h("Array"),ae)?ae.$to_a():L(ae,h("Array"),"to_ary").$to_a();var C,V,Ee=q([],{});for(C=0,V=this.length;C<V;C++)v(Ee,this[C],!0);for(C=0,V=ae.length;C<V;C++)v(Ee,ae[C],!0);return Ee.$keys()}),P(x,"$*",function(ae){if(de(ae["$respond_to?"]("to_str")))return this.$join(ae.$to_str());ae=L(ae,h("Integer"),"to_int"),de(ae<0)&&K.$raise(h("ArgumentError"),"negative argument");for(var Ee=[],C=this.$to_a(),V=0;V<ae;V++)Ee=Ee.concat(C);return Ee}),P(x,"$+",function(ae){return ae=le(h("Array"),ae)?ae.$to_a():L(ae,h("Array"),"to_ary").$to_a(),this.concat(ae)}),P(x,"$-",function(ae){if(ae=le(h("Array"),ae)?ae.$to_a():L(ae,h("Array"),"to_ary").$to_a(),de(0===this.length))return[];if(de(0===ae.length))return this.slice();var V,$e,Te,Ee=[],C=q([],{});for(V=0,$e=ae.length;V<$e;V++)v(C,ae[V],!0);for(V=0,$e=this.length;V<$e;V++)void 0===ne(C,Te=this[V])&&Ee.push(Te);return Ee}),P(x,"$<<",function(ae){return J(this),this.push(ae),this}),P(x,"$<=>",function(ae){if(le(h("Array"),ae))ae=ae.$to_a();else{if(!de(ae["$respond_to?"]("to_ary")))return c;ae=ae.$to_ary().$to_a()}if(this.$hash()===ae.$hash())return 0;for(var Ee=Math.min(this.length,ae.length),C=0;C<Ee;C++){var V=this[C]["$<=>"](ae[C]);if(0!==V)return V}return this.length["$<=>"](ae.length)}),P(x,"$==",function(ae){var Ee={};return function C(V,$e){var Te,Fe,Ue,Ze;if(V===$e)return!0;if(!$e.$$is_array)return!!D($e,"$to_ary")&&$e["$=="](V);if(V.$$constructor!==Array&&(V=V.$to_a()),$e.$$constructor!==Array&&($e=$e.$to_a()),V.length!==$e.length)return!1;for(Ee[V.$object_id()]=!0,Te=0,Fe=V.length;Te<Fe;Te++)if(Ze=$e[Te],(Ue=V[Te]).$$is_array){if(Ze.$$is_array&&Ze.length!==Ue.length||!Ee.hasOwnProperty(Ue.$object_id())&&!C(Ue,Ze))return!1}else if(!Ue["$=="](Ze))return!1;return!0}(this,ae)}),P(x,"$[]",function(ae,he){return ae.$$is_range?fe(this,ae):ae.$$is_arithmetic_seq?function Pe(Ce,ae){var he,Ee=[],C=0;for(he=ae.step<0?fe(Ce,{begin:ae.range.end,end:ae.range.begin,excl:!1,excl_rev:ae.range.excl}).$reverse():fe(Ce,ae.range);C<he.length;)Ee.push(he[C]),C+=Math.abs(ae.step);return Ee}(this,ae):function be(Ce,ae,he){var Ee=Ce.length;return(ae=L(ae,E.Integer,"to_int"))<0&&(ae+=Ee)<0?c:void 0===he?ae>=Ee||ae<0?c:Ce[ae]:(he=L(he,E.Integer,"to_int"))<0||ae>Ee||ae<0?c:Ce.slice(ae,ae+he)}(this,ae,he)},-2),P(x,"$[]=",function(ae,he,Ee){var C=this,V=c,$e=c;J(C),V=c;var Te,Et,Fe=C.length;if(ae.$$is_range){V=he.$$is_array?he.$to_a():he["$respond_to?"]("to_ary")?he.$to_ary().$to_a():[he];var Ue=ae.excl,Ze=ae.begin===c?0:L(ae.begin,E.Integer,"to_int"),lt=ae.end===c?-1:L(ae.end,E.Integer,"to_int");if(Ze<0&&(Ze+=Fe)<0&&K.$raise(h("RangeError"),ae.$inspect()+" out of range"),lt<0&&(lt+=Fe),(!Ue||ae.end===c)&&(lt+=1),Ze>Fe)for(Te=Fe;Te<Ze;Te++)C[Te]=c;return C.splice.apply(C,lt<0?[Ze,0].concat(V):[Ze,lt-Ze].concat(V)),he}if(void 0===Ee?$e=1:($e=he,V=(he=Ee).$$is_array?he.$to_a():he["$respond_to?"]("to_ary")?he.$to_ary().$to_a():[he]),ae=L(ae,h("Integer"),"to_int"),$e=L($e,h("Integer"),"to_int"),ae<0&&(Et=ae,(ae+=Fe)<0&&K.$raise(h("IndexError"),"index "+Et+" too small for array; minimum "+-C.length)),$e<0&&K.$raise(h("IndexError"),"negative length ("+$e+")"),ae>Fe)for(Te=Fe;Te<ae;Te++)C[Te]=c;return void 0===Ee?C[ae]=he:C.splice.apply(C,[ae,$e].concat(V)),he},-3),P(x,"$any?",function Ce(ae){var he=Ce.$$p||c;return Ce.$$p=null,0!==this.length&&Y(this,Q(this,"any?",Ce,!1,!0),"any?",[ae],he)},-1),P(x,"$assoc",function(ae){for(var V,Ee=0,C=this.length;Ee<C;Ee++)if((V=this[Ee]).length&&V[0]["$=="](ae))return V;return c}),P(x,"$at",function(ae){return(ae=L(ae,h("Integer"),"to_int"))<0&&(ae+=this.length),ae<0||ae>=this.length?c:this[ae]}),P(x,"$bsearch_index",function Ce(){var ae=Ce.$$p||c;if(Ce.$$p=null,ae===c)return this.$enum_for("bsearch_index");for(var V,Te,Ee=0,C=this.length,Fe=!1,Ue=c;Ee<C;){if(V=Ee+Math.floor((C-Ee)/2),!0===(Te=T(ae,this[V])))Ue=V,Fe=!0;else if(!1===Te||Te===c)Fe=!1;else if(Te.$$is_number){if(0===Te)return V;Fe=Te<0}else K.$raise(h("TypeError"),"wrong argument type "+Te.$class()+" (must be numeric, true, false or nil)");Fe?C=V:Ee=V+1}return Ue}),P(x,"$bsearch",function Ce(){var ae=Ce.$$p||c,Ee=c;return Ce.$$p=null,ae===c?this.$enum_for("bsearch"):null!=(Ee=k(this,"bsearch_index",[],ae.$to_proc()))&&Ee.$$is_number?this[Ee]:Ee}),P(x,"$cycle",function Ce(ae){var C,V,he=Ce.$$p||c,Ee=this;if(Ce.$$p=null,null==ae&&(ae=c),he===c)return k(Ee,"enum_for",["cycle",ae],function Te(){var Fe=null==Te.$$s?this:Te.$$s;return de(ae["$nil?"]())?h(h("Float"),"INFINITY"):(ae=H["$coerce_to!"](ae,h("Integer"),"to_int"),de(N(ae,0))?te(Fe.$enumerator_size(),ae):0)},{$$s:Ee});if(de(Ee["$empty?"]())||U(ae,0))return c;if(ae===c)for(;;)for(C=0,V=Ee.length;C<V;C++)T(he,Ee[C]);else{if((ae=H["$coerce_to!"](ae,h("Integer"),"to_int"))<=0)return Ee;for(;ae>0;){for(C=0,V=Ee.length;C<V;C++)T(he,Ee[C]);ae--}}return Ee},-1),P(x,"$clear",function(){return J(this),this.splice(0,this.length),this}),P(x,"$count",function Ce(ae){var he=Ce.$$p||c;return Ce.$$p=null,de(void 0!==ae)||de(he)?Y(this,Q(this,"count",Ce,!1,!0),"count",[ae],he):this.$size()},-1),P(x,"$initialize_copy",function(ae){return this.$replace(ae)}),P(x,"$collect",function Ce(){var ae=Ce.$$p||c;if(Ce.$$p=null,ae===c)return k(this,"enum_for",["collect"],function Te(){return(null==Te.$$s?this:Te.$$s).$size()},{$$s:this});for(var Ee=[],C=0,V=this.length;C<V;C++){var $e=T(ae,this[C]);Ee.push($e)}return Ee}),P(x,"$collect!",function Ce(){var ae=Ce.$$p||c,he=this;if(Ce.$$p=null,ae===c)return k(he,"enum_for",["collect!"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$s:he});J(he);for(var Ee=0,C=he.length;Ee<C;Ee++){var V=T(ae,he[Ee]);he[Ee]=V}return he}),P(x,"$combination",function Ce(ae){var C,V,$e,Te,Fe,Ue,Ze,lt,he=Ce.$$p||c,Ee=this;if(Ce.$$p=null,C=H["$coerce_to!"](ae,h("Integer"),"to_int"),he===c)return k(Ee,"enum_for",["combination",C],function Et(){return xe((null==Et.$$s?this:Et.$$s).length,C)},{$$s:Ee});if(0===C)E.yield1(he,[]);else if(1===C)for(V=0,$e=Ee.length;V<$e;V++)E.yield1(he,[Ee[V]]);else if(C===Ee.length)E.yield1(he,Ee.slice());else if(C>=0&&C<Ee.length){for(Te=[],V=0;V<=C+1;V++)Te.push(0);for(Fe=[],Ue=0,Ze=!1,Te[0]=-1;!Ze;){for(Fe[Ue]=Ee[Te[Ue+1]];Ue<C-1;)lt=Te[1+ ++Ue]=Te[Ue]+1,Fe[Ue]=Ee[lt];E.yield1(he,Fe.slice()),Ue++;do{Ze=0===Ue,Te[Ue]++,Ue--}while(Te[Ue+1]+C===Ee.length+Ue+1)}}return Ee}),P(x,"$repeated_combination",function Ce(ae){var C,he=Ce.$$p||c;return Ce.$$p=null,C=H["$coerce_to!"](ae,h("Integer"),"to_int"),he===c?k(this,"enum_for",["repeated_combination",C],function $e(){return xe((null==$e.$$s?this:$e.$$s).length+C-1,C)},{$$s:this}):(C>=0&&function V($e,Te,Fe,Ue){if(Fe.length!=$e)for(var lt=Te;lt<Ue.length;lt++)Fe.push(Ue[lt]),V($e,lt,Fe,Ue),Fe.pop();else{var Ze=Fe.slice();E.yield1(he,Ze)}}(C,0,[],this),this)}),P(x,"$compact",function(){for(var V,he=[],Ee=0,C=this.length;Ee<C;Ee++)(V=this[Ee])!==c&&he.push(V);return he}),P(x,"$compact!",function(){var ae=this;J(ae);for(var he=ae.length,Ee=0,C=ae.length;Ee<C;Ee++)ae[Ee]===c&&(ae.splice(Ee,1),C--,Ee--);return ae.length===he?c:ae}),P(x,"$concat",function(ae){var Ee,C=this;return Ee=Z(arguments),J(C),Ee=k(Ee,"map",[],function V($e){var Te=null==V.$$s?this:V.$$s;return null==$e&&($e=c),$e=le(h("Array"),$e)?$e.$to_a():L($e,h("Array"),"to_ary").$to_a(),de($e["$equal?"](Te))&&($e=$e.$dup()),$e},{$$s:C}),k(Ee,"each",[],function V($e){var Te=null==V.$$s?this:V.$$s;null==$e&&($e=c);for(var Fe=0,Ue=$e.length;Fe<Ue;Fe++)Te.push($e[Fe])},{$$s:C}),C},-1),P(x,"$delete",function Ce(ae){var he=Ce.$$p||c,Ee=this;Ce.$$p=null;for(var C=Ee.length,V=0,$e=C;V<$e;V++)Ee[V]["$=="](ae)&&(J(Ee),Ee.splice(V,1),$e--,V--);return Ee.length===C?he!==c?E.yieldX(he,[]):c:ae}),P(x,"$delete_at",function(ae){var he=this;if(J(he),(ae=L(ae,h("Integer"),"to_int"))<0&&(ae+=he.length),ae<0||ae>=he.length)return c;var Ee=he[ae];return he.splice(ae,1),Ee}),P(x,"$delete_if",function Ce(){var ae=Ce.$$p||c,he=this;return Ce.$$p=null,ae===c?k(he,"enum_for",["delete_if"],function Ee(){return(null==Ee.$$s?this:Ee.$$s).$size()},{$$s:he}):(J(he),Ae(he,ye,ae),he)}),P(x,"$difference",function(ae){var he,C=this;return he=Z(arguments),k(he,"reduce",[C.$to_a().$dup()],function($e,Te){return null==$e&&($e=c),null==Te&&(Te=c),I($e,Te)})},-1),P(x,"$dig",function(ae,he){var C,V=this,$e=c;return C=Z(arguments,1),($e=V["$[]"](ae))===c||0===C.length?$e:(de($e["$respond_to?"]("dig"))||K.$raise(h("TypeError"),$e.$class()+" does not have #dig method"),k($e,"dig",A(C)))},-2),P(x,"$drop",function(ae){return(ae=L(ae,h("Integer"),"to_int"))<0&&K.$raise(h("ArgumentError")),this.slice(ae)}),P(x,"$dup",function Ce(){var ae=Ce.$$p||c,he=this;return Ce.$$p=null,he.$$class===E.Array&&he.$$class.$allocate.$$pristine&&he.$copy_instance_variables.$$pristine&&he.$initialize_dup.$$pristine?he.slice(0):Y(he,Q(he,"dup",Ce,!1,!0),"dup",[],ae)}),P(x,"$each",function Ce(){var ae=Ce.$$p||c,he=this;if(Ce.$$p=null,ae===c)return k(he,"enum_for",["each"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$s:he});for(var Ee=0,C=he.length;Ee<C;Ee++)T(ae,he[Ee]);return he}),P(x,"$each_index",function Ce(){var ae=Ce.$$p||c;if(Ce.$$p=null,ae===c)return k(this,"enum_for",["each_index"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$s:this});for(var Ee=0,C=this.length;Ee<C;Ee++)T(ae,Ee);return this}),P(x,"$empty?",function(){return 0===this.length}),P(x,"$eql?",function(ae){var Ee={};return function C(V,$e){var Te,Fe,Ue,Ze;if(!$e.$$is_array||($e=$e.$to_a(),V.length!==$e.length))return!1;for(Ee[V.$object_id()]=!0,Te=0,Fe=V.length;Te<Fe;Te++)if(Ze=$e[Te],(Ue=V[Te]).$$is_array){if(Ze.$$is_array&&Ze.length!==Ue.length||!Ee.hasOwnProperty(Ue.$object_id())&&!C(Ue,Ze))return!1}else if(!Ue["$eql?"](Ze))return!1;return!0}(this,ae)}),P(x,"$fetch",function Ce(ae,he){var Ee=Ce.$$p||c,C=this;Ce.$$p=null;var V=ae;return(ae=L(ae,h("Integer"),"to_int"))<0&&(ae+=C.length),ae>=0&&ae<C.length?C[ae]:(Ee!==c&&null!=he&&C.$warn("warning: block supersedes default value argument"),Ee!==c?Ee(V):null!=he?he:void K.$raise(h("IndexError"),0===C.length?"index "+V+" outside of array bounds: 0...0":"index "+V+" outside of array bounds: -"+C.length+"..."+C.length))},-2),P(x,"$fill",function Ce(ae){var C,V,It,nn,he=Ce.$$p||c,Te=this,Fe=c,Ue=c,Ze=c,lt=c,Et=c;if(Ce.$$p=null,C=Z(arguments),J(Te),de(he)?(de(C.length>2)&&K.$raise(h("ArgumentError"),"wrong number of arguments ("+C.$length()+" for 0..2)"),Fe=null==(V=y(C))[0]?c:V[0],Ue=null==V[1]?c:V[1]):(de(0==C.length)?K.$raise(h("ArgumentError"),"wrong number of arguments (0 for 1..3)"):de(C.length>3)&&K.$raise(h("ArgumentError"),"wrong number of arguments ("+C.$length()+" for 1..3)"),Ze=null==(V=y(C))[0]?c:V[0],Fe=null==V[1]?c:V[1],Ue=null==V[2]?c:V[2]),le(h("Range"),Fe)){if(de(Ue)&&K.$raise(h("TypeError"),"length invalid with range"),lt=Fe.begin===c?0:L(Fe.begin,h("Integer"),"to_int"),de(lt<0)&&(lt+=this.length),de(lt<0)&&K.$raise(h("RangeError"),Fe.$inspect()+" out of range"),Et=Fe.end===c?-1:L(Fe.end,h("Integer"),"to_int"),de(Et<0)&&(Et+=this.length),de(Fe["$exclude_end?"]())||(Et+=1),de(Et<=lt))return Te}else if(de(Fe))if(lt=L(Fe,h("Integer"),"to_int"),de(lt<0)&&(lt+=this.length),de(lt<0)&&(lt=0),de(Ue)){if(Et=L(Ue,h("Integer"),"to_int"),de(0==Et))return Te;Et+=lt}else Et=this.length;else lt=0,Et=this.length;if(de(lt>this.length))for(It=this.length;It<Et;It++)Te[It]=c;if(de(Et>this.length)&&(this.length=Et),de(he))for(;lt<Et;lt++)nn=he(lt),Te[lt]=nn;else for(;lt<Et;lt++)Te[lt]=Ze;return Te},-1),P(x,"$first",function(ae){return null==ae?0===this.length?c:this[0]:((ae=L(ae,h("Integer"),"to_int"))<0&&K.$raise(h("ArgumentError"),"negative array size"),this.slice(0,ae))},-1),P(x,"$flatten",function(ae){var he=this;return void 0!==ae&&(ae=L(ae,h("Integer"),"to_int")),function Ee(C,V){var Te,Fe,Ue,Ze,$e=[];for(Te=0,Fe=(C=C.$to_a()).length;Te<Fe;Te++)if(D(Ue=C[Te],"$to_ary",!0))if((Ze=Ue.$to_ary())!==c)switch(Ze.$$is_array||K.$raise(h("TypeError")),Ze===he&&K.$raise(h("ArgumentError")),V){case void 0:$e=$e.concat(Ee(Ze));break;case 0:$e.push(Ze);break;default:$e.push.apply($e,Ee(Ze,V-1))}else $e.push(Ue);else $e.push(Ue);return $e}(he,ae)},-1),P(x,"$flatten!",function(ae){var he=this;J(he);var Ee=he.$flatten(ae);if(he.length==Ee.length){for(var C=0,V=he.length;C<V&&he[C]===Ee[C];C++);if(C==V)return c}return he.$replace(Ee),he},-1),P(x,"$freeze",function(){return de(this["$frozen?"]())?this:j(this)}),P(x,"$hash",function(){var $e,Te,ae=this,he=void 0===f,Ee=["A"],C=ae.$object_id();try{if(he&&(f=Object.create(null)),f[C])return"self";for(Te in f)if(ae["$eql?"](f[Te]))return"self";for(f[C]=ae,$e=0;$e<ae.length;$e++)Ee.push(ae[$e].$hash());return Ee.join(",")}finally{he&&(f=void 0)}}),P(x,"$include?",function(ae){for(var Ee=0,C=this.length;Ee<C;Ee++)if(this[Ee]["$=="](ae))return!0;return!1}),P(x,"$index",function Ce(ae){var C,V,$e,he=Ce.$$p||c,Ee=this;if(Ce.$$p=null,null!=ae&&he!==c&&Ee.$warn("warning: given block not used"),null!=ae){for(C=0,V=Ee.length;C<V;C++)if(Ee[C]["$=="](ae))return C}else{if(he===c)return Ee.$enum_for("index");for(C=0,V=Ee.length;C<V;C++)if(!1!==($e=he(Ee[C]))&&$e!==c)return C}return c},-1),P(x,"$insert",function(ae,he){var C,V=this;if(C=Z(arguments,1),J(V),ae=L(ae,h("Integer"),"to_int"),C.length>0){if(ae<0&&(ae+=V.length+1)<0&&K.$raise(h("IndexError"),ae+" is out of bounds"),ae>V.length)for(var $e=V.length;$e<ae;$e++)V.push(c);V.splice.apply(V,[ae,0].concat(C))}return V},-2);var he,pe=[];return P(x,"$inspect",function(){var ae=this,he=[],Ee=ae.$__id__(),C=!0;return function(){try{if(-1!==pe.indexOf(Ee))return C=!1,"[...]";pe.push(Ee);for(var V=0,$e=ae.length;V<$e;V++){var Te=ae["$[]"](V);he.push(re("Opal").$inspect(Te))}return"["+he.join(", ")+"]"}finally{C&&pe.pop()}}()}),P(x,"$intersection",function(ae){var he,C=this;return he=Z(arguments),k(he,"reduce",[C.$to_a().$dup()],function($e,Te){return null==$e&&($e=c),null==Te&&(Te=c),$e["$&"](Te)})},-1),P(x,"$intersect?",function(ae){return this.$intersection(ae)["$empty?"]()["$!"]()}),P(x,"$join",function(ae){var he=this;if(null==R[","]&&(R[","]=c),null==ae&&(ae=c),de(0===he.length))return"";de(ae===c)&&(ae=R[","]);var C,V,$e,Te,Ee=[];for(C=0,V=he.length;C<V;C++)D($e=he[C],"$to_str")&&(Te=$e.$to_str())!==c?Ee.push(Te.$to_s()):D($e,"$to_ary")&&((Te=$e.$to_ary())===he&&K.$raise(h("ArgumentError")),Te!==c)?Ee.push(Te.$join(ae)):D($e,"$to_s")&&(Te=$e.$to_s())!==c?Ee.push(Te):K.$raise(h("NoMethodError").$new(re("Opal").$inspect(he.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return Ee.join(ae===c?"":H["$coerce_to!"](ae,h("String"),"to_str").$to_s())},-1),P(x,"$keep_if",function Ce(){var ae=Ce.$$p||c,he=this;return Ce.$$p=null,ae===c?k(he,"enum_for",["keep_if"],function Ee(){return(null==Ee.$$s?this:Ee.$$s).$size()},{$$s:he}):(J(he),Ae(he,de,ae),he)}),P(x,"$last",function(ae){var he=this;return null==ae?0===he.length?c:he[he.length-1]:((ae=L(ae,h("Integer"),"to_int"))<0&&K.$raise(h("ArgumentError"),"negative array size"),ae>he.length&&(ae=he.length),he.slice(he.length-ae,he.length))},-1),P(x,"$length",function(){return this.length}),P(x,"$max",function Ce(ae){var he=Ce.$$p||c;return Ce.$$p=null,k(this.$each(),"max",[ae],he.$to_proc())},-1),P(x,"$min",function Ce(){var ae=Ce.$$p||c;return Ce.$$p=null,k(this.$each(),"min",[],ae.$to_proc())}),P(x,"$permutation",function Ce(ae){var $e,Te,Fe,he=Ce.$$p||c,Ee=this,C=c,V=c;if(Ce.$$p=null,he===c)return k(Ee,"enum_for",["permutation",ae],function Ze(){var lt=null==Ze.$$s?this:Ze.$$s;return function Me(Ce,ae){for(var he=ae>=0?1:0;ae;)he*=Ce,Ce--,ae--;return he}(lt.length,void 0===ae?lt.length:ae)},{$$s:Ee});if(!((ae=void 0===ae?Ee.length:L(ae,h("Integer"),"to_int"))<0||Ee.length<ae))if(0===ae)E.yield1(he,[]);else if(1===ae)for(var Ue=0;Ue<Ee.length;Ue++)E.yield1(he,[Ee[Ue]]);else C=re("Array").$new(ae),V=re("Array").$new(Ee.length,!1),$e=function(Ze,lt,Et,It,hn){Ee=this;for(var nn=0;nn<Ee.length;nn++)if(It["$[]"](nn)["$!"]())if(lt[Et]=nn,Et<Ze-1)It[nn]=!0,$e.call(Ee,Ze,lt,Et+1,It,hn),It[nn]=!1;else{Fe=[];for(var Bn=0;Bn<lt.length;Bn++)Fe.push(Ee[lt[Bn]]);T(hn,Fe)}},he!==c?(Te=Ee.slice(),$e.call(Te,ae,C,0,V,he)):$e.call(Ee,ae,C,0,V,he);return Ee},-1),P(x,"$repeated_permutation",function Ce(ae){var C,he=Ce.$$p||c;return Ce.$$p=null,C=H["$coerce_to!"](ae,h("Integer"),"to_int"),he===c?k(this,"enum_for",["repeated_permutation",C],function $e(){var Te=null==$e.$$s?this:$e.$$s;return de(z(C,0))?Te.$size()["$**"](C):0},{$$s:this}):(function V($e,Te,Fe){if(Te.length!=$e)for(var Ze=0;Ze<Fe.length;Ze++)Te.push(Fe[Ze]),V($e,Te,Fe),Te.pop();else{var Ue=Te.slice();E.yield1(he,Ue)}}(C,[],this.slice()),this)}),P(x,"$pop",function(ae){var he=this;return J(he),de(void 0===ae)?de(0===he.length)?c:he.pop():(ae=L(ae,h("Integer"),"to_int"),de(ae<0)&&K.$raise(h("ArgumentError"),"negative array size"),de(0===he.length)?[]:de(1===ae)?[he.pop()]:de(ae>he.length)?he.splice(0,he.length):he.splice(he.length-ae,he.length))},-1),P(x,"$product",function Ce(ae){var Ee,C,he=Ce.$$p||c,V=this;Ce.$$p=null,Ee=Z(arguments);var lt,Et,It,hn,$e=he!==c?null:[],Te=(C=Ee).length+1,Fe=new Array(Te),Ue=new Array(Te),Ze=new Array(Te),nn=1;for(Ze[0]=V,lt=1;lt<Te;lt++)Ze[lt]=L(C[lt-1],h("Array"),"to_ary");for(lt=0;lt<Te;lt++){if(0===(hn=Ze[lt].length))return $e||V;(nn*=hn)>2147483647&&K.$raise(h("RangeError"),"too big to product"),Ue[lt]=hn,Fe[lt]=0}e:for(;;){for(It=[],lt=0;lt<Te;lt++)It.push(Ze[lt][Fe[lt]]);for($e?$e.push(It):E.yield1(he,It),Fe[Et=Te-1]++;Fe[Et]===Ue[Et];){if(Fe[Et]=0,--Et<0)break e;Fe[Et]++}}return $e||V},-1),P(x,"$push",function(ae){var Ee,C=this;Ee=Z(arguments),J(C);for(var V=0,$e=Ee.length;V<$e;V++)C.push(Ee[V]);return C},-1),P(x,"$rassoc",function(ae){for(var V,Ee=0,C=this.length;Ee<C;Ee++)if((V=this[Ee]).length&&void 0!==V[1]&&V[1]["$=="](ae))return V;return c}),P(x,"$reject",function Ce(){var ae=Ce.$$p||c,he=this;if(Ce.$$p=null,ae===c)return k(he,"enum_for",["reject"],function Te(){return(null==Te.$$s?this:Te.$$s).$size()},{$$s:he});for(var $e,Ee=[],C=0,V=he.length;C<V;C++)(!1===($e=ae(he[C]))||$e===c)&&Ee.push(he[C]);return Ee}),P(x,"$reject!",function Ce(){var ae=Ce.$$p||c,he=this,Ee=c;return Ce.$$p=null,ae===c?k(he,"enum_for",["reject!"],function C(){return(null==C.$$s?this:C.$$s).$size()},{$$s:he}):(J(he),Ee=he.$length(),k(he,"delete_if",[],ae.$to_proc()),U(he.$length(),Ee)?c:he)}),P(x,"$replace",function(ae){var he=this;return J(he),ae=le(h("Array"),ae)?ae.$to_a():L(ae,h("Array"),"to_ary").$to_a(),he.splice(0,he.length),he.push.apply(he,ae),he}),P(x,"$reverse",function(){return this.slice(0).reverse()}),P(x,"$reverse!",function(){return J(this),this.reverse()}),P(x,"$reverse_each",function Ce(){var ae=Ce.$$p||c;return Ce.$$p=null,ae===c?k(this,"enum_for",["reverse_each"],function Ee(){return(null==Ee.$$s?this:Ee.$$s).$size()},{$$s:this}):(k(this.$reverse(),"each",[],ae.$to_proc()),this)}),P(x,"$rindex",function Ce(ae){var C,V,he=Ce.$$p||c,Ee=this;if(Ce.$$p=null,null!=ae&&he!==c&&Ee.$warn("warning: given block not used"),null!=ae){for(C=Ee.length-1;C>=0&&!(C>=Ee.length);C--)if(Ee[C]["$=="](ae))return C}else if(he!==c){for(C=Ee.length-1;C>=0&&!(C>=Ee.length);C--)if(!1!==(V=he(Ee[C]))&&V!==c)return C}else if(null==ae)return Ee.$enum_for("rindex");return c},-1),P(x,"$rotate",function(ae){var Ee,C,V,$e;return null==ae&&(ae=1),ae=L(ae,h("Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(V=(Ee=this.slice()).slice(C=ae%Ee.length),$e=Ee.slice(0,C),V.concat($e))},-1),P(x,"$rotate!",function(ae){var he=this,Ee=c;return null==ae&&(ae=1),J(he),0===he.length||1===he.length?he:(ae=L(ae,h("Integer"),"to_int"),Ee=he.$rotate(ae),he.$replace(Ee))},-1),(he=F(x,null,"SampleRandom")).$$prototype.rng=c,P(he,"$initialize",ie("rng")),P(he,"$rand",function(V){var Te;return Te=L(this.rng.$rand(V),h("Integer"),"to_int"),de(Te<0)&&K.$raise(h("RangeError"),"random value must be >= 0"),de(Te<V)||K.$raise(h("RangeError"),"random value must be less than Array size"),Te}),P(x,"$sample",function(ae,he){var $e,Te,Fe,Ue,Ze,lt,Et,It,Ee=this,C=c,V=c;if(de(void 0===ae))return Ee.$at(K.$rand(Ee.length));if(de(void 0===he)?de(C=H["$coerce_to?"](ae,h("Hash"),"to_hash"))?(he=C,ae=c):(he=c,ae=L(ae,h("Integer"),"to_int")):(ae=L(ae,h("Integer"),"to_int"),he=L(he,h("Hash"),"to_hash")),de(ae)&&de(ae<0)&&K.$raise(h("ArgumentError"),"count must be greater than 0"),de(he)&&(V=he["$[]"]("random")),V=de(V)&&de(V["$respond_to?"]("rand"))?re("SampleRandom").$new(V):K,!de(ae))return Ee[V.$rand(Ee.length)];switch(ae>Ee.length&&(ae=Ee.length),ae){case 0:return[];case 1:return[Ee[V.$rand(Ee.length)]];case 2:return(Ue=V.$rand(Ee.length))===(Ze=V.$rand(Ee.length))&&(Ze=0===Ue?Ue+1:Ue-1),[Ee[Ue],Ee[Ze]];default:if(Ee.length/ae>3){for($e=!1,Te=0,Ue=1,(Fe=re("Array").$new(ae))[0]=V.$rand(Ee.length);Ue<ae;){for(lt=V.$rand(Ee.length),Ze=0;Ze<Ue;){for(;lt===Fe[Ze];){if(++Te>100){$e=!0;break}lt=V.$rand(Ee.length)}if($e)break;Ze++}if($e)break;Fe[Ue]=lt,Ue++}if(!$e){for(Ue=0;Ue<ae;)Fe[Ue]=Ee[Fe[Ue]],Ue++;return Fe}}Fe=Ee.slice();for(var hn=0;hn<ae;hn++)Et=V.$rand(Ee.length),It=Fe[hn],Fe[hn]=Fe[Et],Fe[Et]=It;return ae===Ee.length?Fe:Fe["$[]"](0,ae)}},-1),P(x,"$select",function Ce(){var ae=Ce.$$p||c;if(Ce.$$p=null,ae===c)return k(this,"enum_for",["select"],function Fe(){return(null==Fe.$$s?this:Fe.$$s).$size()},{$$s:this});for(var $e,Te,Ee=[],C=0,V=this.length;C<V;C++)Te=T(ae,$e=this[C]),de(Te)&&Ee.push($e);return Ee}),P(x,"$select!",function Ce(){var ae=Ce.$$p||c,he=this;if(Ce.$$p=null,ae===c)return k(he,"enum_for",["select!"],function C(){return(null==C.$$s?this:C.$$s).$size()},{$$s:he});J(he);var Ee=he.length;return k(he,"keep_if",[],ae.$to_proc()),he.length===Ee?c:he}),P(x,"$shift",function(ae){var he=this;return J(he),de(void 0===ae)?de(0===he.length)?c:function se(Ce){for(var ae=Ce[0],he=1,Ee=Ce.length;he<Ee;he++)Ce[he-1]=Ce[he];return Ce.pop(),ae}(he):(ae=L(ae,h("Integer"),"to_int"),de(ae<0)&&K.$raise(h("ArgumentError"),"negative array size"),de(0===he.length)?[]:he.splice(0,ae))},-1),P(x,"$shuffle",function(ae){return this.$dup().$to_a()["$shuffle!"](ae)},-1),P(x,"$shuffle!",function(ae){var he=this;J(he);var Ee,V,$e,C=he.length;for(void 0!==ae&&(ae=H["$coerce_to?"](ae,h("Hash"),"to_hash"))!==c&&(ae=ae["$[]"]("random"))!==c&&ae["$respond_to?"]("rand")&&(Ee=ae);C;)Ee?((V=Ee.$rand(C).$to_int())<0&&K.$raise(h("RangeError"),"random number too small "+V),V>=C&&K.$raise(h("RangeError"),"random number too big "+V)):V=he.$rand(C),$e=he[--C],he[C]=he[V],he[V]=$e;return he},-1),P(x,"$slice!",function(ae,he){var Ee=this,C=c,V=c,$e=c,Te=c,Fe=c;if(J(Ee),C=c,de(void 0===he))if(le(h("Range"),ae)){C=Ee["$[]"](V=ae),$e=V.begin===c?0:L(V.begin,h("Integer"),"to_int"),Te=V.end===c?-1:L(V.end,h("Integer"),"to_int"),$e<0&&($e+=Ee.length),Te<0?Te+=Ee.length:Te>=Ee.length&&(Te=Ee.length-1,V.excl&&(Te+=1));var Ue=Te-$e;V.excl&&V.end!==c?Te-=1:Ue+=1,$e<Ee.length&&$e>=0&&Te<Ee.length&&Te>=0&&Ue>0&&Ee.splice($e,Ue)}else{if((Fe=L(ae,h("Integer"),"to_int"))<0&&(Fe+=Ee.length),Fe<0||Fe>=Ee.length)return c;C=Ee[Fe],0===Fe?Ee.shift():Ee.splice(Fe,1)}else{if(Fe=L(ae,h("Integer"),"to_int"),(he=L(he,h("Integer"),"to_int"))<0)return c;C=Ee["$[]"](Fe,he),Fe<0&&(Fe+=Ee.length),Fe+he>Ee.length&&(he=Ee.length-Fe),Fe<Ee.length&&Fe>=0&&Ee.splice(Fe,he)}return C},-2),P(x,"$sort",function Ce(){var ae=Ce.$$p||c;return Ce.$$p=null,de(this.length>1)?(ae===c&&(ae=function(Ee,C){return Ee["$<=>"](C)}),this.slice().sort(function(Ee,C){var V=ae(Ee,C);return V===c&&K.$raise(h("ArgumentError"),"comparison of "+Ee.$inspect()+" with "+C.$inspect()+" failed"),N(V,0)?1:M(V,0)?-1:0})):this}),P(x,"$sort!",function Ce(){var Ee,ae=Ce.$$p||c,he=this;Ce.$$p=null,J(he),Ee=ae!==c?k(he.slice(),"sort",[],ae.$to_proc()):he.slice().$sort(),he.length=0;for(var C=0,V=Ee.length;C<V;C++)he.push(Ee[C]);return he}),P(x,"$sort_by!",function Ce(){var ae=Ce.$$p||c,he=this;return Ce.$$p=null,ae===c?k(he,"enum_for",["sort_by!"],function Ee(){return(null==Ee.$$s?this:Ee.$$s).$size()},{$$s:he}):(J(he),he.$replace(k(he,"sort_by",[],ae.$to_proc())))}),P(x,"$take",function(ae){return ae<0&&K.$raise(h("ArgumentError")),this.slice(0,ae)}),P(x,"$take_while",function Ce(){var ae=Ce.$$p||c;Ce.$$p=null;for(var $e,Te,Ee=[],C=0,V=this.length;C<V;C++){if(!1===(Te=ae($e=this[C]))||Te===c)return Ee;Ee.push($e)}return Ee}),P(x,"$to_a",function(){return this.$$class===E.Array?this:E.Array.$new(this)}),P(x,"$to_ary",ge),P(x,"$to_h",function Ce(){var ae=Ce.$$p||c,Ee=c;Ce.$$p=null,Ee=this,ae!==c&&(Ee=k(Ee,"map",[],ae.$to_proc()));var C,$e,V=Ee.length,Ue=q([],{});for(C=0;C<V;C++)($e=H["$coerce_to?"](Ee[C],h("Array"),"to_ary")).$$is_array||K.$raise(h("TypeError"),"wrong element type "+$e.$class()+" at "+C+" (expected array)"),2!==$e.length&&K.$raise(h("ArgumentError"),"wrong array length at "+C+" (expected 2, was "+$e.$length()+")"),v(Ue,$e[0],$e[1]);return Ue}),P(x,"$transpose",function(){var he=c,Ee=c;return de(this["$empty?"]())?[]:(he=[],Ee=c,k(this,"each",[],function(V){var $e=c;return null==V&&(V=c),V=le(h("Array"),V)?V.$to_a():L(V,h("Array"),"to_ary").$to_a(),Ee=de($e=Ee)?$e:V.length,B(V.length,Ee)&&K.$raise(h("IndexError"),"element size differs ("+V.length+" should be "+Ee+")"),k(V.length,"times",[],function(Fe){var Ue;return null==Fe&&(Fe=c),(de($e=he["$[]"](Fe))?$e:(k(he,"[]=",Ue=[Fe,[]]),Ue[Ue.length-1]))["$<<"](V.$at(Fe))})}),he)}),P(x,"$union",function(ae){var he,C=this;return he=Z(arguments),k(he,"reduce",[C.$uniq()],function($e,Te){return null==$e&&($e=c),null==Te&&(Te=c),$e["$|"](Te)})},-1),P(x,"$uniq",function Ce(){var ae=Ce.$$p||c;Ce.$$p=null;var C,V,$e,Te,Ee=q([],{});if(ae===c)for(C=0,V=this.length;C<V;C++)void 0===ne(Ee,$e=this[C])&&v(Ee,$e,$e);else for(C=0,V=this.length;C<V;C++)Te=T(ae,$e=this[C]),void 0===ne(Ee,Te)&&v(Ee,Te,$e);return Ee.$values()}),P(x,"$uniq!",function Ce(){var ae=Ce.$$p||c,he=this;Ce.$$p=null,J(he);var V,$e,Te,Fe,Ee=he.length,C=q([],{});for(V=0,$e=Ee;V<$e;V++)Te=he[V],Fe=ae===c?Te:T(ae,Te),void 0!==ne(C,Fe)?(he.splice(V,1),$e--,V--):v(C,Fe,Te);return he.length===Ee?c:he}),P(x,"$unshift",function(ae){var Ee,C=this;Ee=Z(arguments),J(C);var V=C.length,$e=Ee.length;if(0==$e)return C;for(var Te=V-$e,Fe=0;Fe<$e;Fe++)C.push(C[Te+Fe]);for(var Ue=V-1;Ue-$e>=0;)C[Ue]=C[Ue-$e],Ue--;for(var Ze=0;Ze<$e;Ze++)C[Ze]=Ee[Ze];return C},-1),P(x,"$values_at",function(ae){var he,C=this,V=c;return he=Z(arguments),V=[],k(he,"each",[],function $e(Te){var Fe=null==$e.$$s?this:$e.$$s,Ue=c,Ze=c,lt=c;return null==Te&&(Te=c),de(Te["$is_a?"](h("Range")))?(Ue=Te.$end()===c?-1:L(Te.$end(),h("Integer"),"to_int"),(Ze=Te.$begin()===c?0:L(Te.$begin(),h("Integer"),"to_int"))<0?(Ze+=Fe.length,c):(Ue<0&&(Ue+=Fe.length),Te["$exclude_end?"]()&&Te.$end()!==c&&Ue--,Ue<Ze?c:k(Ze,"upto",[Ue],function Et(It){return null==It&&(It=c),V["$<<"]((null==Et.$$s?this:Et.$$s).$at(It))},{$$s:Fe}))):(lt=L(Te,h("Integer"),"to_int"),V["$<<"](Fe.$at(lt)))},{$$s:C}),V},-1),P(x,"$zip",function Ce(ae){var Ee,C,he=Ce.$$p||c,V=this,$e=c;Ce.$$p=null,Ee=Z(arguments);var Ue,Ze,lt,Et,It,Te=[],Fe=V.length;for(Et=0,It=(C=Ee).length;Et<It;Et++)if(!(Ze=C[Et]).$$is_array){if(Ze.$$is_range||Ze.$$is_enumerator){C[Et]=Ze.$take(Fe);continue}C[Et]=(de($e=H["$coerce_to?"](Ze,h("Array"),"to_ary"))?$e:H["$coerce_to!"](Ze,h("Enumerator"),"to_enum","each")).$to_a()}for(lt=0;lt<Fe;lt++){for(Ue=[V[lt]],Et=0,It=C.length;Et<It;Et++)null==(Ze=C[Et][lt])&&(Ze=c),Ue[Et+1]=Ze;Te[lt]=Ue}if(he!==c){for(lt=0;lt<Fe;lt++)E.yield1(he,Te[lt]);return c}return Te},-1),X(x,"$inherited",function(ae){ae.$$prototype.$to_a=function(){return this.slice(0,this.length)}}),P(x,"$instance_variables",function Ce(){var ae=Ce.$$p||c;return Ce.$$p=null,k(Y(this,Q(this,"instance_variables",Ce,!1,!0),"instance_variables",[],ae),"reject",[],function(C){var V;return null==C&&(C=c),de(V=/^@\d+$/.test(C))?V:C["$=="]("@length")})}),P(x,"$pack",function(ae){return Z(arguments),K.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),O(x,"append","push"),O(x,"filter","select"),O(x,"filter!","select!"),O(x,"map","collect"),O(x,"map!","collect!"),O(x,"prepend","unshift"),O(x,"size","length"),O(x,"slice","[]"),O(x,"to_s","inspect"),H.$pristine(x.$singleton_class(),"allocate"),H.$pristine(x,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(E){var R,ge,z,ie,M,de=E.yield1,ye=E.hash,f=E.hash_init,T=E.hash_get,ne=E.hash_put,v=E.hash_delete,S=E.deny_frozen_access,L=E.freeze,D=E.klass,J=E.slice,j=E.Opal,F=E.Kernel,Z=E.defs,X=E.def,K=E.send,P=E.rb_ge,H=E.rb_gt,le=E.hash2,q=E.truthy,Y=E.to_a,Q=E.return_self,k=E.alias,U=E.nil,I=E.$$$;return E.top.$require("corelib/enumerable"),R=[],ie=[z=D("::",null,"Hash")].concat(R),M=E.$r(ie),z.$include(I("Enumerable")),z.$$prototype.$$is_hash=!0,Z(z,"$[]",function(O){var l,h,p,c=this,d=(l=J(arguments)).length;if(1===d){if((h=j["$coerce_to?"](l["$[]"](0),I("Hash"),"to_hash"))!==U)return c.$allocate()["$merge!"](h);for((l=j["$coerce_to?"](l["$[]"](0),I("Array"),"to_ary"))===U&&F.$raise(I("ArgumentError"),"odd number of arguments for Hash"),d=l.length,h=c.$allocate(),p=0;p<d;p++)if(l[p].$$is_array)switch(l[p].length){case 1:h.$store(l[p][0],U);break;case 2:h.$store(l[p][0],l[p][1]);break;default:F.$raise(I("ArgumentError"),"invalid number of elements ("+l[p].length+" for 1..2)")}return h}for(d%2!=0&&F.$raise(I("ArgumentError"),"odd number of arguments for Hash"),h=c.$allocate(),p=0;p<d;p+=2)h.$store(l[p],l[p+1]);return h},-1),Z(z,"$allocate",function(){var _=new this.$$constructor;return f(_),_.$$none=U,_.$$proc=U,_}),Z(z,"$try_convert",function(O){return j["$coerce_to?"](O,I("Hash"),"to_hash")}),X(z,"$initialize",function B(O){var _=B.$$p||U,l=this;return B.$$p=null,S(l),void 0!==O&&_!==U&&F.$raise(I("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===O?U:O,l.$$proc=_,l},-1),X(z,"$==",function(O){var _=this;if(_===O)return!0;if(!O.$$is_hash||_.$$keys.length!==O.$$keys.length)return!1;for(var d,p,m,l=0,c=_.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?(p=_.$$smap[d],m=O.$$smap[d]):(p=d.value,m=T(O,d.key)),void 0===m||!p["$eql?"](m))return!1;return!0}),X(z,"$>=",function(O){var l=U;return O=j["$coerce_to!"](O,I("Hash"),"to_hash"),!(this.$$keys.length<O.$$keys.length)&&(l=!0,K(O,"each",[],function c(h,d){var m;null==h&&(h=U),null==d&&(d=U),null!=(m=(null==c.$$s?this:c.$$s).$fetch(h,null))&&m===d||(l=!1)},{$$s:this}),l)}),X(z,"$>",function(O){return O=j["$coerce_to!"](O,I("Hash"),"to_hash"),!(this.$$keys.length<=O.$$keys.length)&&P(this,O)}),X(z,"$<",function(O){return O=j["$coerce_to!"](O,I("Hash"),"to_hash"),H(O,this)}),X(z,"$<=",function(O){return O=j["$coerce_to!"](O,I("Hash"),"to_hash"),P(O,this)}),X(z,"$[]",function(O){var l=T(this,O);return void 0!==l?l:this.$default(O)}),X(z,"$[]=",function(O,_){return S(this),ne(this,O,_),_}),X(z,"$assoc",function(O){for(var d,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string){if(d["$=="](O))return[d,this.$$smap[d]]}else if(d.key["$=="](O))return[d.key,d.value];return U}),X(z,"$clear",function(){var O=this;return S(O),f(O),O}),X(z,"$clone",function(){var _=new this.$$class;return f(_),E.hash_clone(this,_),_}),X(z,"$compact",function(){for(var d,p,_=ye(),l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p!==U&&ne(_,d,p);return _}),X(z,"$compact!",function(){var O=this;S(O);for(var d,p,_=!1,l=0,c=O.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=O.$$smap[d]:(p=d.value,d=d.key),p===U&&void 0!==v(O,d)&&(_=!0,h--,l--);return _?O:U}),X(z,"$compare_by_identity",function(){var O=this;S(O);var _,l,c,d,h=O.$$keys;if(O.$$by_identity)return O;if(0===O.$$keys.length)return O.$$by_identity=!0,O;for(d=le([],{}).$compare_by_identity(),_=0,l=h.length;_<l;_++)(c=h[_]).$$is_string||(c=c.key),ne(d,c,T(O,c));return O.$$by_identity=!0,O.$$map=d.$$map,O.$$smap=d.$$smap,O}),X(z,"$compare_by_identity?",function(){return!0===this.$$by_identity}),X(z,"$default",function(O){var _=this;return void 0!==O&&_.$$proc!==U&&void 0!==_.$$proc?_.$$proc.$call(_,O):void 0===_.$$none?U:_.$$none},-1),X(z,"$default=",function(O){var _=this;return S(_),_.$$proc=U,_.$$none=O,O}),X(z,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:U}),X(z,"$default_proc=",function(O){var _=this;S(_);var l=O;return l!==U&&(l=j["$coerce_to!"](l,I("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&F.$raise(I("TypeError"),"default_proc takes two arguments"),_.$$none=U,_.$$proc=l,O}),X(z,"$delete",function B(O){var _=B.$$p||U;B.$$p=null,S(this);var c=v(this,O);return void 0!==c?c:_!==U?E.yield1(_,O):U}),X(z,"$delete_if",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["delete_if"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:_});S(_);for(var d,p,m,l=0,c=_.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=_.$$smap[d]:(p=d.value,d=d.key),!1!==(m=O(d,p))&&m!==U&&void 0!==v(_,d)&&(h--,l--);return _}),X(z,"$dig",function(O,_){var c,h=this,d=U;return c=J(arguments,1),(d=h["$[]"](O))===U||0===c.length?d:(q(d["$respond_to?"]("dig"))||F.$raise(I("TypeError"),d.$class()+" does not have #dig method"),K(d,"dig",Y(c)))},-2),X(z,"$each",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["each"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:_});for(var d,p,l=0,c=_.$$keys.slice(),h=c.length;l<h;l++)(d=c[l]).$$is_string?p=_.$$smap[d]:(p=d.value,d=d.key),de(O,[d,p]);return _}),X(z,"$each_key",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["each_key"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:_});for(var d,l=0,c=_.$$keys.slice(),h=c.length;l<h;l++)O((d=c[l]).$$is_string?d:d.key);return _}),X(z,"$each_value",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["each_value"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:_});for(var d,l=0,c=_.$$keys.slice(),h=c.length;l<h;l++)O((d=c[l]).$$is_string?_.$$smap[d]:d.value);return _}),X(z,"$empty?",function(){return 0===this.$$keys.length}),X(z,"$except",function(O){var l,c=this;return l=J(arguments),K(c.$dup(),"except!",Y(l))},-1),X(z,"$except!",function(O){var _,c=this;return _=J(arguments),K(_,"each",[],function h(d){return null==d&&(d=U),(null==h.$$s?this:h.$$s).$delete(d)},{$$s:c}),c},-1),X(z,"$fetch",function B(O,_){var l=B.$$p||U;B.$$p=null;var h=T(this,O);return void 0!==h?h:l!==U?l(O):void 0!==_?_:F.$raise(I("KeyError").$new("key not found: "+O.$inspect(),le(["key","receiver"],{key:O,receiver:this})))},-2),X(z,"$fetch_values",function B(O){var l,_=B.$$p||U,h=this;return B.$$p=null,l=J(arguments),K(l,"map",[],function d(p){return null==p&&(p=U),K(null==d.$$s?this:d.$$s,"fetch",[p],_.$to_proc())},{$$s:h})},-1),X(z,"$flatten",function(O){null==O&&(O=1),O=j["$coerce_to!"](O,I("Integer"),"to_int");for(var p,m,l=[],c=0,h=this.$$keys,d=h.length;c<d;c++)if((p=h[c]).$$is_string?m=this.$$smap[p]:(m=p.value,p=p.key),l.push(p),m.$$is_array){if(1===O){l.push(m);continue}l=l.concat(m.$flatten(O-2))}else l.push(m);return l},-1),X(z,"$freeze",function(){var O=this;return q(O["$frozen?"]())?O:L(O)}),X(z,"$has_key?",function(O){return void 0!==T(this,O)}),X(z,"$has_value?",function(O){for(var d,l=0,c=this.$$keys,h=c.length;l<h;l++)if(((d=c[l]).$$is_string?this.$$smap[d]:d.value)["$=="](O))return!0;return!1}),X(z,"$hash",function(){var h,O=this,_=void 0===E.hash_ids,l=O.$object_id(),c=["Hash"];try{if(_&&(E.hash_ids=Object.create(null)),E[l])return"self";for(h in E.hash_ids)if(O["$eql?"](E.hash_ids[h]))return"self";E.hash_ids[l]=O;for(var p=0,m=O.$$keys,x=m.length;p<x;p++)c.push((h=m[p]).$$is_string?[h,O.$$smap[h].$hash()]:[h.key_hash,h.value.$hash()]);return c.sort().join()}finally{_&&(E.hash_ids=void 0)}}),X(z,"$index",function(O){for(var d,p,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p["$=="](O))return d;return U}),X(z,"$indexes",function(O){for(var l,x,c=this,h=[],d=0,p=(l=J(arguments)).length;d<p;d++)void 0!==(x=T(c,l[d]))?h.push(x):h.push(c.$default());return h},-1),X(z,"$inspect",function(){var O=this,_=void 0===ge,l=O.$object_id(),c=[];return function(){try{if(_&&(ge={}),ge.hasOwnProperty(l))return"{...}";ge[l]=!0;for(var m,x,h=0,d=O.$$keys,p=d.length;h<p;h++)(m=d[h]).$$is_string?x=O.$$smap[m]:(x=m.value,m=m.key),m=M("Opal").$inspect(m),x=M("Opal").$inspect(x),c.push(m+"=>"+x);return"{"+c.join(", ")+"}"}finally{_&&(ge=void 0)}}()}),X(z,"$invert",function(){for(var d,p,_=ye(),l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),ne(_,p,d);return _}),X(z,"$keep_if",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["keep_if"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:_});S(_);for(var d,p,m,l=0,c=_.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=_.$$smap[d]:(p=d.value,d=d.key),(!1===(m=O(d,p))||m===U)&&void 0!==v(_,d)&&(h--,l--);return _}),X(z,"$keys",function(){for(var d,_=[],l=0,c=this.$$keys,h=c.length;l<h;l++)_.push((d=c[l]).$$is_string?d:d.key);return _}),X(z,"$length",function(){return this.$$keys.length}),X(z,"$merge",function B(O){var c,_=B.$$p||U,h=this;return B.$$p=null,c=J(arguments),K(h.$dup(),"merge!",Y(c),_.$to_proc())},-1),X(z,"$merge!",function B(O){var c,d,p,m,x,$,re,se,De,_=B.$$p||U,h=this;for(B.$$p=null,c=J(arguments),S(h),d=0;d<c.length;++d)if($=(x=(m=j["$coerce_to!"](c[d],I("Hash"),"to_hash")).$$keys).length,_===U)for(p=0;p<$;p++)(re=x[p]).$$is_string?De=m.$$smap[re]:(De=re.value,re=re.key),ne(h,re,De);else for(p=0;p<$;p++)(re=x[p]).$$is_string?De=m.$$smap[re]:(De=re.value,re=re.key),void 0!==(se=T(h,re))?ne(h,re,_(re,se,De)):ne(h,re,De);return h},-1),X(z,"$rassoc",function(O){for(var d,p,l=0,c=this.$$keys,h=c.length;l<h;l++)if((d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),p["$=="](O))return[d,p];return U}),X(z,"$rehash",function(){var O=this;return S(O),E.hash_rehash(O),O}),X(z,"$reject",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["reject"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:_});for(var p,m,x,l=ye(),c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),(!1===(x=O(p,m))||x===U)&&ne(l,p,m);return l}),X(z,"$reject!",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["reject!"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:_});S(_);for(var p,m,x,l=!1,c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),!1!==(x=O(p,m))&&x!==U&&void 0!==v(_,p)&&(l=!0,d--,c--);return l?_:U}),X(z,"$replace",function(O){var _=this;S(_),O=j["$coerce_to!"](O,I("Hash"),"to_hash"),f(_);for(var d,m,l=0,c=O.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?m=O.$$smap[d]:(m=d.value,d=d.key),ne(_,d,m);return q(O.$default_proc())?_["$default_proc="](O.$default_proc()):_["$default="](O.$default()),_}),X(z,"$select",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["select"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:_});for(var p,m,x,l=ye(),c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),!1!==(x=O(p,m))&&x!==U&&ne(l,p,m);return l}),X(z,"$select!",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["select!"],function $(){return(null==$.$$s?this:$.$$s).$size()},{$$s:_});S(_);for(var p,m,x,l=U,c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),(!1===(x=O(p,m))||x===U)&&(void 0!==v(_,p)&&(d--,c--),l=_);return l}),X(z,"$shift",function(){var O=this;S(O);var l,_=O.$$keys;return _.length>0?[l=(l=_[0]).$$is_string?l:l.key,v(O,l)]:U}),X(z,"$slice",function(O){var l,c=this;l=J(arguments);for(var h=ye(),d=0,p=l.length;d<p;d++){var m=l[d],x=T(c,m);void 0!==x&&ne(h,m,x)}return h},-1),X(z,"$to_a",function(){for(var d,p,_=[],l=0,c=this.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=this.$$smap[d]:(p=d.value,d=d.key),_.push([d,p]);return _}),X(z,"$to_h",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,O!==U)return K(_,"map",[],O.$to_proc()).$to_h();if(_.$$class===E.Hash)return _;var l=new E.Hash;return f(l),E.hash_clone(_,l),l}),X(z,"$to_hash",Q),X(z,"$to_proc",function(){return K(this,"proc",[],function _(l){var c=null==_.$$s?this:_.$$s;return null==l&&F.$raise(I("ArgumentError"),"no key given"),c["$[]"](l)},{$$arity:-1,$$s:this})}),X(z,"$transform_keys",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["transform_keys"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:_});for(var p,m,l=ye(),c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),p=de(O,p),ne(l,p,m);return l}),X(z,"$transform_keys!",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["transform_keys!"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:_});S(_);var c,d,p,m,l=E.slice(_.$$keys),h=l.length;for(c=0;c<h;c++)(d=l[c]).$$is_string?p=_.$$smap[d]:(p=d.value,d=d.key),m=de(O,d),v(_,d),ne(_,m,p);return _}),X(z,"$transform_values",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["transform_values"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:_});for(var p,m,l=ye(),c=0,h=_.$$keys,d=h.length;c<d;c++)(p=h[c]).$$is_string?m=_.$$smap[p]:(m=p.value,p=p.key),m=de(O,m),ne(l,p,m);return l}),X(z,"$transform_values!",function B(){var O=B.$$p||U,_=this;if(B.$$p=null,!q(O))return K(_,"enum_for",["transform_values!"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:_});S(_);for(var d,p,l=0,c=_.$$keys,h=c.length;l<h;l++)(d=c[l]).$$is_string?p=_.$$smap[d]:(p=d.value,d=d.key),p=de(O,p),ne(_,d,p);return _}),X(z,"$values",function(){for(var d,_=[],l=0,c=this.$$keys,h=c.length;l<h;l++)_.push((d=c[l]).$$is_string?this.$$smap[d]:d.value);return _}),k(z,"dup","clone"),k(z,"each_pair","each"),k(z,"eql?","=="),k(z,"filter","select"),k(z,"filter!","select!"),k(z,"include?","has_key?"),k(z,"indices","indexes"),k(z,"key","index"),k(z,"key?","has_key?"),k(z,"member?","has_key?"),k(z,"size","length"),k(z,"store","[]="),k(z,"to_s","inspect"),k(z,"update","merge!"),k(z,"value?","has_value?"),k(z,"values_at","indexes")},Opal.modules["corelib/number"]=function(E){var z,ie,B,_,l,M,ge,de=E.klass,ye=E.Opal,f=E.Kernel,T=E.def,ne=E.eqeqeq,v=E.truthy,S=E.rb_gt,L=E.not,D=E.rb_lt,J=E.alias,j=E.send2,F=E.find_super,Z=E.send,X=E.rb_plus,K=E.rb_minus,P=E.eqeq,H=E.return_self,le=E.rb_divide,q=E.to_ary,Y=E.rb_times,Q=E.rb_le,k=E.rb_ge,N=E.return_val,te=E.const_set,I=[],A=E.nil,y=E.$$$;return E.top.$require("corelib/numeric"),function(R,z,ie){var h,M=de("::",z,"Number");function O(h){var d=new Uint8Array(8);return new DataView(d.buffer).setFloat64(0,h,!0),d}function _(h){return new DataView(h.buffer).getFloat64(0,!0)}function l(h){for(var d=O(h),p=0;p<d.length;p++){if(255!==d[p]){d[p]++;break}d[p]=0}return _(d)}function c(h){for(var d=O(h),p=0;p<d.length;p++){if(0!==d[p]){d[p]--;break}d[p]=255}return _(d)}[M].concat(ie),ye.$bridge(Number,M),E.prop(M.$$prototype,"$$is_number",!0),M.$$is_number_class=!0,h=E.get_singleton_class(M),T(h,"$allocate",function(){return f.$raise(y("TypeError"),"allocator undefined for "+this.$name())}),E.udef(h,"$new"),T(M,"$coerce",function(d){var p=this;if(d===A)f.$raise(y("TypeError"),"can't convert "+d.$class()+" into Float");else{if(d.$$is_string)return[f.$Float(d),p];if(d["$respond_to?"]("to_f"))return[ye["$coerce_to!"](d,y("Float"),"to_f"),p];if(d.$$is_number)return[d,p];f.$raise(y("TypeError"),"can't convert "+d.$class()+" into Float")}}),T(M,"$__id__",function(){return 2*this+1}),T(M,"$+",function(d){return d.$$is_number?this+d:this.$__coerced__("+",d)}),T(M,"$-",function(d){return d.$$is_number?this-d:this.$__coerced__("-",d)}),T(M,"$*",function(d){return d.$$is_number?this*d:this.$__coerced__("*",d)}),T(M,"$/",function(d){return d.$$is_number?this/d:this.$__coerced__("/",d)}),T(M,"$%",function(d){var p=this;return d.$$is_number?d==-1/0?d:0!=d?d<0||p<0?(p%d+d)%d:p%d:void f.$raise(y("ZeroDivisionError"),"divided by 0"):p.$__coerced__("%",d)}),T(M,"$&",function(d){return d.$$is_number?this&d:this.$__coerced__("&",d)}),T(M,"$|",function(d){return d.$$is_number?this|d:this.$__coerced__("|",d)}),T(M,"$^",function(d){return d.$$is_number?this^d:this.$__coerced__("^",d)}),T(M,"$<",function(d){return d.$$is_number?this<d:this.$__coerced__("<",d)}),T(M,"$<=",function(d){return d.$$is_number?this<=d:this.$__coerced__("<=",d)}),T(M,"$>",function(d){return d.$$is_number?this>d:this.$__coerced__(">",d)}),T(M,"$>=",function(d){return d.$$is_number?this>=d:this.$__coerced__(">=",d)}),T(M,"$<=>",function(d){try{return function(h,d){return d.$$is_number?isNaN(h)||isNaN(d)?A:h>d?1:h<d?-1:0:h.$__coerced__("<=>",d)}(this,d)}catch(m){if(!E.rescue(m,[y("ArgumentError")]))throw m;try{return A}finally{E.pop_exception()}}}),T(M,"$<<",function(d){return(d=ye["$coerce_to!"](d,y("Integer"),"to_int"))>0?this<<d:this>>-d}),T(M,"$>>",function(d){return(d=ye["$coerce_to!"](d,y("Integer"),"to_int"))>0?this>>d:this<<-d}),T(M,"$[]",function(d){return(d=ye["$coerce_to!"](d,y("Integer"),"to_int"))<0?0:d>=32?this<0?1:0:this>>d&1}),T(M,"$+@",function(){return+this}),T(M,"$-@",function(){return-this}),T(M,"$~",function(){return~this}),T(M,"$**",function(d){var p=this;return ne(y("Integer"),d)?L(y("Integer")["$==="](p))||v(S(d,0))?Math.pow(p,d):y("Rational").$new(p,1)["$**"](d):D(p,0)&&(ne(y("Float"),d)||ne(y("Rational"),d))?y("Complex").$new(p,0)["$**"](d.$to_f()):v(null!=d.$$is_number)?Math.pow(p,d):p.$__coerced__("**",d)}),T(M,"$==",function(d){return d.$$is_number?this.valueOf()===d.valueOf():!!d["$respond_to?"]("==")&&d["$=="](this)}),J(M,"===","=="),T(M,"$abs",function(){return Math.abs(this)}),T(M,"$abs2",function(){return Math.abs(this*this)}),T(M,"$allbits?",function(d){return(this&(d=ye["$coerce_to!"](d,y("Integer"),"to_int")))==d}),T(M,"$anybits?",function(d){return 0!=(this&ye["$coerce_to!"](d,y("Integer"),"to_int"))}),T(M,"$angle",function(){var d=this;return v(d["$nan?"]())?d:0==d?1/d>0?0:Math.PI:d<0?Math.PI:0}),T(M,"$bit_length",function(){var d=this;if(ne(y("Integer"),d)||f.$raise(y("NoMethodError").$new("undefined method `bit_length` for "+d+":Float","bit_length")),0===d||-1===d)return 0;for(var p=0,m=d<0?~d:d;0!=m;)p+=1,m>>>=1;return p}),T(M,"$ceil",function(d){null==d&&(d=0);var m=this.$to_f();if(m%1==0&&d>=0)return m;var x=Math.pow(10,d),$=Math.ceil(m*x)/x;return m%1==0&&($=Math.round($)),$},-1),T(M,"$chr",function(d){return E.enc(String.fromCharCode(this),d||"BINARY")},-1),T(M,"$denominator",function h(){var d=h.$$p||A,p=this;return h.$$p=null,v(p["$nan?"]())||v(p["$infinite?"]())?1:j(p,F(p,"denominator",h,!1,!0),"denominator",[],d)}),T(M,"$downto",function h(d){var p=h.$$p||A,m=this;if(h.$$p=null,p===A)return Z(m,"enum_for",["downto",d],function $(){var re=null==$.$$s?this:$.$$s;return ne(y("Numeric"),d)||f.$raise(y("ArgumentError"),"comparison of "+re.$class()+" with "+d.$class()+" failed"),v(S(d,re))?0:X(K(re,d),1)},{$$s:m});d.$$is_number||f.$raise(y("ArgumentError"),"comparison of "+m.$class()+" with "+d.$class()+" failed");for(var x=m;x>=d;x--)p(x);return m}),T(M,"$equal?",function(d){var m;return v(m=this["$=="](d))?m:isNaN(this)&&isNaN(d)}),T(M,"$even?",function(){return this%2==0}),T(M,"$floor",function(d){null==d&&(d=0);var m=this.$to_f();if(m%1==0&&d>=0)return m;var x=Math.pow(10,d),$=Math.floor(m*x)/x;return m%1==0&&($=Math.round($)),$},-1),T(M,"$gcd",function(d){ne(y("Integer"),d)||f.$raise(y("TypeError"),"not an integer");for(var m=Math.abs(this),x=Math.abs(d);m>0;){var $=m;m=x%m,x=$}return x}),T(M,"$gcdlcm",function(d){return[this.$gcd(d),this.$lcm(d)]}),T(M,"$integer?",function(){return this%1==0}),T(M,"$is_a?",function h(d){var p=h.$$p||A,m=this;return h.$$p=null,!!(P(d,y("Integer"))&&ne(y("Integer"),m)||P(d,y("Integer"))&&ne(y("Integer"),m)||P(d,y("Float"))&&ne(y("Float"),m))||j(m,F(m,"is_a?",h,!1,!0),"is_a?",[d],p)}),T(M,"$instance_of?",function h(d){var p=h.$$p||A,m=this;return h.$$p=null,!!(P(d,y("Integer"))&&ne(y("Integer"),m)||P(d,y("Integer"))&&ne(y("Integer"),m)||P(d,y("Float"))&&ne(y("Float"),m))||j(m,F(m,"instance_of?",h,!1,!0),"instance_of?",[d],p)}),T(M,"$lcm",function(d){var p=this;return ne(y("Integer"),d)||f.$raise(y("TypeError"),"not an integer"),0==p||0==d?0:Math.abs(p*d/p.$gcd(d))}),T(M,"$next",function(){return this+1}),T(M,"$nobits?",function(d){return 0==(this&ye["$coerce_to!"](d,y("Integer"),"to_int"))}),T(M,"$nonzero?",function(){return 0==this?A:this}),T(M,"$numerator",function h(){var d=h.$$p||A,p=this;return h.$$p=null,v(p["$nan?"]())||v(p["$infinite?"]())?p:j(p,F(p,"numerator",h,!1,!0),"numerator",[],d)}),T(M,"$odd?",function(){return this%2!=0}),T(M,"$ord",H),T(M,"$pow",function(d,p){var m=this;return 0==m&&f.$raise(y("ZeroDivisionError"),"divided by 0"),void 0===p?m["$**"](d):(y("Integer")["$==="](d)||f.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),d<0&&f.$raise(y("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),y("Integer")["$==="](p)||f.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===p&&f.$raise(y("ZeroDivisionError"),"divided by 0"),m["$**"](d)["$%"](p))},-2),T(M,"$pred",function(){return this-1}),T(M,"$quo",function h(d){var p=h.$$p||A,m=this;return h.$$p=null,ne(y("Integer"),m)?j(m,F(m,"quo",h,!1,!0),"quo",[d],p):le(m,d)}),T(M,"$rationalize",function(d){var p,m,x=this,$=A,re=A;return arguments.length>1&&f.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),ne(y("Integer"),x)?y("Rational").$new(x,1):v(x["$infinite?"]())?f.$raise(y("FloatDomainError"),"Infinity"):v(x["$nan?"]())?f.$raise(y("FloatDomainError"),"NaN"):v(null==d)?(m=y("Math").$frexp(x),$=null==(p=q(m))[0]?A:p[0],re=null==p[1]?A:p[1],$=y("Math").$ldexp($,y(y("Float"),"MANT_DIG")).$to_i(),re=K(re,y(y("Float"),"MANT_DIG")),y("Rational").$new(Y(2,$),1["$<<"](K(1,re))).$rationalize(y("Rational").$new(1,1["$<<"](K(1,re))))):x.$to_r().$rationalize(d)},-1),T(M,"$remainder",function(d){return K(this,Y(d,le(this,d).$truncate()))}),T(M,"$round",function(d){var p,m,re,x=this;if(ne(y("Integer"),x)){if(v(null==d)||(ne(y("Float"),d)&&v(d["$infinite?"]())&&f.$raise(y("RangeError"),"Infinity"),d=ye["$coerce_to!"](d,y("Integer"),"to_int"),v(D(d,y(y("Integer"),"MIN")))&&f.$raise(y("RangeError"),"out of bounds"),v(d>=0)))return x;if(.415241*(d=d["$-@"]())-.125>x.$size())return 0;var se=Math.pow(10,d),De=Math.floor((Math.abs(x)+se/2)/se)*se;return x<0?-De:De}if(v(x["$nan?"]())&&v(null==d)&&f.$raise(y("FloatDomainError"),"NaN"),d=ye["$coerce_to!"](d||0,y("Integer"),"to_int"),v(Q(d,0)))v(x["$nan?"]())?f.$raise(y("RangeError"),"NaN"):v(x["$infinite?"]())&&f.$raise(y("FloatDomainError"),"Infinity");else{if(P(d,0))return Math.round(x);if(v(x["$nan?"]())||v(x["$infinite?"]()))return x}return m=y("Math").$frexp(x),re=null==(p=q(m))[1]?A:p[1],v(k(d,K(X(y(y("Float"),"DIG"),2),v(S(re,0))?le(re,4):K(le(re,3),1))))?x:v(D(d,(v(S(re,0))?X(le(re,3),1):le(re,4))["$-@"]()))?0:Math.round(x*Math.pow(10,d))/Math.pow(10,d)},-1),T(M,"$times",function h(){var d=h.$$p||A,p=this;if(h.$$p=null,!v(d))return Z(p,"enum_for",["times"],function x(){return null==x.$$s?this:x.$$s},{$$s:p});for(var m=0;m<p;m++)d(m);return p}),T(M,"$to_f",H),T(M,"$to_i",function(){var d=this;return d<0?Math.ceil(d):Math.floor(d)}),T(M,"$to_r",function(){var d,p,m=this,x=A,$=A;return ne(y("Integer"),m)?y("Rational").$new(m,1):(p=y("Math").$frexp(m),x=null==(d=q(p))[0]?A:d[0],$=null==d[1]?A:d[1],x=y("Math").$ldexp(x,y(y("Float"),"MANT_DIG")).$to_i(),$=K($,y(y("Float"),"MANT_DIG")),Y(x,y(y("Float"),"RADIX")["$**"]($)).$to_r())}),T(M,"$to_s",function(d){var p=this;return null==d&&(d=10),d=ye["$coerce_to!"](d,y("Integer"),"to_int"),(v(D(d,2))||v(S(d,36)))&&f.$raise(y("ArgumentError"),"invalid radix "+d),P(p,0)&&v(1/p==-1/0)?"-0.0":p.toString(d)},-1),T(M,"$truncate",function(d){null==d&&(d=0);var m=this.$to_f();if(m%1==0&&d>=0)return m;var x=Math.pow(10,d),$=parseInt(m*x,10)/x;return m%1==0&&($=Math.round($)),$},-1),T(M,"$digits",function(d){var p=this;null==d&&(d=10),D(p,0)&&f.$raise(y(y("Math"),"DomainError"),"out of domain"),d=ye["$coerce_to!"](d,y("Integer"),"to_int"),v(D(d,2))&&f.$raise(y("ArgumentError"),"invalid radix "+d),p!=parseInt(p)&&f.$raise(y("NoMethodError"),"undefined method `digits' for "+p.$inspect());var m=p,x=[];if(0==p)return[0];for(;0!=m;)x.push(m%d),m=parseInt(m/d,10);return x},-1),T(M,"$divmod",function h(d){var p=h.$$p||A,m=this;return h.$$p=null,v(m["$nan?"]())||v(d["$nan?"]())?f.$raise(y("FloatDomainError"),"NaN"):v(m["$infinite?"]())?f.$raise(y("FloatDomainError"),"Infinity"):j(m,F(m,"divmod",h,!1,!0),"divmod",[d],p)}),T(M,"$upto",function h(d){var p=h.$$p||A,m=this;if(h.$$p=null,p===A)return Z(m,"enum_for",["upto",d],function $(){var re=null==$.$$s?this:$.$$s;return ne(y("Numeric"),d)||f.$raise(y("ArgumentError"),"comparison of "+re.$class()+" with "+d.$class()+" failed"),v(D(d,re))?0:X(K(d,re),1)},{$$s:m});d.$$is_number||f.$raise(y("ArgumentError"),"comparison of "+m.$class()+" with "+d.$class()+" failed");for(var x=m;x<=d;x++)p(x);return m}),T(M,"$zero?",function(){return 0==this}),T(M,"$size",N(4)),T(M,"$nan?",function(){return isNaN(this)}),T(M,"$finite?",function(){var d=this;return d!=1/0&&d!=-1/0&&!isNaN(d)}),T(M,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:A}),T(M,"$positive?",function(){var d=this;return 0!=d&&(d==1/0||1/d>0)}),T(M,"$negative?",function(){return this==-1/0||1/this<0}),T(M,"$next_float",function(){var d=this;return P(d,y(y("Float"),"INFINITY"))?y(y("Float"),"INFINITY"):v(d["$nan?"]())?y(y("Float"),"NAN"):k(d,0)?l(Math.abs(d)):c(d)}),T(M,"$prev_float",function(){var d=this;return P(d,y(y("Float"),"INFINITY")["$-@"]())?y(y("Float"),"INFINITY")["$-@"]():v(d["$nan?"]())?y(y("Float"),"NAN"):S(d,0)?c(d):-l(Math.abs(d))}),J(M,"arg","angle"),J(M,"eql?","=="),J(M,"fdiv","/"),J(M,"inspect","to_s"),J(M,"kind_of?","is_a?"),J(M,"magnitude","abs"),J(M,"modulo","%"),J(M,"object_id","__id__"),J(M,"phase","angle"),J(M,"succ","next"),J(M,"to_int","to_i")}(0,y("Numeric"),I),te("::","Fixnum",y("Number")),z=y("Numeric"),ie=I,ge=[M=de("::",z,"Integer")].concat(ie),M.$$is_number_class=!0,M.$$is_integer_class=!0,_=[B=E.get_singleton_class(M)].concat(ge),l=E.$r(_),T(B,"$allocate",function(){return f.$raise(y("TypeError"),"allocator undefined for "+this.$name())}),E.udef(B,"$new"),T(B,"$sqrt",function(h){return(h=ye["$coerce_to!"](h,y("Integer"),"to_int"))<0&&f.$raise(y(y("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(h),10)}),T(B,"$try_convert",function(h){return l("Opal")["$coerce_to?"](h,this,"to_int")}),te(M,"MAX",Math.pow(2,30)-1),te(M,"MIN",-Math.pow(2,30)),function(R,z,ie){var M=de("::",z,"Float");return[M].concat(ie),M.$$is_number_class=!0,function(B,O){T(B,"$allocate",function(){return f.$raise(y("TypeError"),"allocator undefined for "+this.$name())}),E.udef(B,"$new"),T(B,"$===",function(l){return!!l.$$is_number})}(E.get_singleton_class(M)),te(M,"INFINITY",1/0),te(M,"MAX",Number.MAX_VALUE),te(M,"MIN",Number.MIN_VALUE),te(M,"NAN",NaN),te(M,"DIG",15),te(M,"MANT_DIG",53),te(M,"RADIX",2),te(M,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,y("Numeric"),I)},Opal.modules["corelib/range"]=function(E){var de=E.klass,ye=E.truthy,f=E.Kernel,T=E.def,ne=E.not,v=E.send2,S=E.find_super,L=E.rb_lt,D=E.rb_le,J=E.send,j=E.eqeq,F=E.eqeqeq,Z=E.return_ivar,X=E.rb_gt,K=E.rb_minus,P=E.Opal,H=E.rb_divide,le=E.rb_plus,q=E.rb_times,Y=E.rb_ge,Q=E.thrower,k=E.alias,U=E.nil,I=E.$$$;return E.top.$require("corelib/enumerable"),function(A,y,R){var z=de("::",null,"Range"),ie=[z].concat([]),M=E.$r(ie),ge=z.$$prototype;function B(O){return O.begin===U||O.end===U||O.begin===-1/0||O.end===1/0||O.begin===1/0||O.end===-1/0}return ge.begin=ge.end=ge.excl=U,z.$include(I("Enumerable")),z.$$prototype.$$is_range=!0,z.$attr_reader("begin","end"),T(z,"$initialize",function(_,l,c){var h=this;return null==c&&(c=!1),ye(h.begin)&&f.$raise(I("NameError"),"'initialize' called twice"),ye(_["$<=>"](l))||ye(_["$nil?"]())||ye(l["$nil?"]())||f.$raise(I("ArgumentError"),"bad value for range"),h.begin=_,h.end=l,h.excl=c},-3),T(z,"$===",function(_){return this["$include?"](_)}),T(z,"$count",function O(){var _=O.$$p||U,l=this;return O.$$p=null,ne(_!==U)&&ye(B(l))?I(I("Float"),"INFINITY"):v(l,S(l,"count",O,!1,!0),"count",[],_)}),T(z,"$to_a",function O(){var _=O.$$p||U,l=this;return O.$$p=null,ye(B(l))&&f.$raise(I("TypeError"),"cannot convert endless range to an array"),v(l,S(l,"to_a",O,!1,!0),"to_a",[],_)}),T(z,"$cover?",function(_){var c,m,l=this,h=U,d=U,p=U;return c=ye(h=ye(d=ye(p=l.begin["$nil?"]())?-1:p)?d:l.begin["$<=>"](_))&&h,m=ye(h=ye(d=ye(p=l.end["$nil?"]())?-1:p)?d:_["$<=>"](l.end))&&h,ye(h=ye(d=ye(l.excl)?ye(p=m)?L(m,0):p:ye(p=m)?D(m,0):p)?c:d)?D(c,0):h}),T(z,"$each",function O(){var h,p,m,_=O.$$p||U,l=this,c=U,d=U;if(O.$$p=null,_===U)return J(l,"enum_for",["each"],function x(){return(null==x.$$s?this:x.$$s).$size()},{$$s:l});if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!=0||l.end%1!=0)&&f.$raise(I("TypeError"),"can't iterate from Float"),p=l.begin,m=l.end+(ye(l.excl)?0:1);p<m;p++)_(p);return l}if(l.begin.$$is_string&&l.end.$$is_string)return J(l.begin,"upto",[l.end,l.excl],_.$to_proc()),l;for(h=l.end,ye((c=l.begin)["$respond_to?"]("succ"))||f.$raise(I("TypeError"),"can't iterate from "+c.$class());ye(ye(d=l.end["$nil?"]())?d:L(c["$<=>"](h),0));)E.yield1(_,c),c=c.$succ();return ne(l.excl)&&j(c,h)&&E.yield1(_,c),l}),T(z,"$eql?",function(_){var l=this,c=U,h=U;return!!F(I("Range"),_)&&(ye(c=ye(h=l.excl["$==="](_["$exclude_end?"]()))?l.begin["$eql?"](_.$begin()):h)?l.end["$eql?"](_.$end()):c)}),T(z,"$exclude_end?",Z("excl")),T(z,"$first",function O(_){var l=O.$$p||U,c=this;return O.$$p=null,ye(c.begin["$nil?"]())&&f.$raise(I("RangeError"),"cannot get the minimum of beginless range"),ye(null==_)?c.begin:v(c,S(c,"first",O,!1,!0),"first",[_],l)},-1),T(z,"$last",function(_){var l=this;return ye(l.end["$nil?"]())&&f.$raise(I("RangeError"),"cannot get the maximum of endless range"),ye(null==_)?l.end:l.$to_a().$last(_)},-1),T(z,"$max",function O(){var _=O.$$p||U,l=this;return O.$$p=null,ye(l.end["$nil?"]())?f.$raise(I("RangeError"),"cannot get the maximum of endless range"):_!==U?v(l,S(l,"max",O,!1,!0),"max",[],_):ne(l.begin["$nil?"]())&&(ye(X(l.begin,l.end))||ye(l.excl)&&j(l.begin,l.end))?U:l.excl?l.end-1:l.end}),T(z,"$min",function O(){var _=O.$$p||U,l=this;return O.$$p=null,ye(l.begin["$nil?"]())?f.$raise(I("RangeError"),"cannot get the minimum of beginless range"):_!==U?v(l,S(l,"min",O,!1,!0),"min",[],_):ne(l.end["$nil?"]())&&(ye(X(l.begin,l.end))||ye(l.excl)&&j(l.begin,l.end))?U:l.begin}),T(z,"$size",function(){var _=this,l=U,c=U,h=U;return l=I(I("Float"),"INFINITY"),j(_.begin,l)&&ne(_.end["$nil?"]())||j(_.end,l["$-@"]())&&ne(_.begin["$nil?"]())?0:ye(B(_))?l:F(I("Numeric"),_.begin)&&F(I("Numeric"),_.end)?(c=_.begin,h=_.end,ye(_.excl)&&(h=K(h,1)),ye(L(h,c))?0:(Math.abs(h-c)+1).$to_i()):U}),T(z,"$step",function O(_){var l=O.$$p||U,c=this,h=U,d=U;function p(){null==_?_=1:_.$$is_number||(_=P["$coerce_to!"](_,I("Integer"),"to_int")),_<0?f.$raise(I("ArgumentError"),"step can't be negative"):0===_&&f.$raise(I("ArgumentError"),"step can't be 0")}return O.$$p=null,l===U?(ye(c.begin["$is_a?"](M("Numeric")))||ye(c.begin["$nil?"]()))&&(ye(c.end["$is_a?"](M("Numeric")))||ye(c.end["$nil?"]()))&&ne(ye(h=c.begin["$nil?"]())?c.end["$nil?"]():h)?I(I("Enumerator"),"ArithmeticSequence").$new(c,_,"step"):J(c,"enum_for",["step",_],function(){return p(),function m(){if(!c.begin["$respond_to?"]("succ")||c.begin.$$is_string&&c.end.$$is_string)return U;if(_%1==0)return H(c.$size(),_).$ceil();var Ae,x=c.begin,$=c.end,re=Math.abs,se=Math.floor,De=(re(x)+re($)+re($-x))/re(_)*I(I("Float"),"EPSILON");return De>.5&&(De=.5),c.excl?(Ae=se(($-x)/_-De))*_+x<$&&Ae++:Ae=se(($-x)/_+De)+1,Ae}()}):(p(),ye(c.begin.$$is_number&&c.end.$$is_number)?(d=0,function(){try{var x=Q("break");J(c,"loop",[],function $(){var se,re=null==$.$$s?this:$.$$s;return null==re.begin&&(re.begin=U),null==re.excl&&(re.excl=U),null==re.end&&(re.end=U),se=le(re.begin,q(d,_)),ye(re.excl)?ye(Y(se,re.end))&&x.$throw():ye(X(se,re.end))&&x.$throw(),E.yield1(l,se),d=le(d,1)},{$$s:c})}catch($){if($===x)return $.$v;throw $}}()):(c.begin.$$is_string&&c.end.$$is_string&&_%1!=0&&f.$raise(I("TypeError"),"no implicit conversion to float from string"),J(c,"each_with_index",[],function($,re){return null==$&&($=U),null==re&&(re=U),j(re["$%"](_),0)?E.yield1(l,$):U})),c)},-1),T(z,"$%",function(_){var l=this;return ye(l.begin["$is_a?"](M("Numeric")))&&ye(l.end["$is_a?"](M("Numeric")))?I(I("Enumerator"),"ArithmeticSequence").$new(l,_,"%"):l.$step(_)}),T(z,"$bsearch",function O(){var _=O.$$p||U,l=this;return O.$$p=null,_===U?l.$enum_for("bsearch"):(ye(B(l)&&(l.begin.$$is_number||l.end.$$is_number))&&f.$raise(I("NotImplementedError"),"Can't #bsearch an infinite range"),ye(l.begin.$$is_number&&l.end.$$is_number)||f.$raise(I("TypeError"),"can't do binary search for "+l.begin.$class()),J(l.$to_a(),"bsearch",[],_.$to_proc()))}),T(z,"$to_s",function(){var _=this,l=U;return(ye(l=_.begin)?l:"")+(ye(_.excl)?"...":"..")+(ye(l=_.end)?l:"")}),T(z,"$inspect",function(){var _=this,l=U;return(ye(l=_.begin)?_.begin.$inspect():l)+(ye(_.excl)?"...":"..")+(ye(l=_.end)?_.end.$inspect():l)}),T(z,"$marshal_load",function(_){var l=this;return l.begin=_["$[]"]("begin"),l.end=_["$[]"]("end"),l.excl=_["$[]"]("excl")}),T(z,"$hash",function(){var _=this;return[_.begin,_.end,_.excl].$hash()}),k(z,"==","eql?"),k(z,"include?","cover?"),k(z,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(E){var H,de=E.slice,f=E.truthy,T=E.Kernel,ne=E.defs,v=E.def,S=E.send,L=E.to_a,D=E.return_self,J=E.ensure_kwargs,j=E.Opal,F=E.alias,Z=E.nil,X=E.$$$;return H=(0,E.klass)("::",Function,"Proc"),E.prop(H.$$prototype,"$$is_proc",!0),E.prop(H.$$prototype,"$$is_lambda",!1),ne(H,"$new",function le(){var q=le.$$p||Z;return le.$$p=null,f(q)||T.$raise(X("ArgumentError"),"tried to create a Proc object without a block"),q}),v(H,"$call",function le(q){var k,Y=le.$$p||Z,N=this;le.$$p=null,k=de(arguments),Y!==Z&&(N.$$p=Y);var te,U=N.$$brk,I=N.$$ret;if(U||I&&N.$$is_lambda)try{te=N.$$is_lambda?N.apply(null,k):E.yieldX(N,k)}catch(A){if(A===U)return A.$v;if(N.$$is_lambda&&A===I)return A.$v;throw A}else te=N.$$is_lambda?N.apply(null,k):E.yieldX(N,k);return te},-1),v(H,"$>>",function le(q){return le.$$p=null,S(T,"proc",[],function k(N){var U,te=k.$$p||Z,A=null==k.$$s?this:k.$$s,y=Z;return k.$$p=null,U=de(arguments),y=S(A,"call",L(U),te.$to_proc()),q.$call(y)},{$$arity:-1,$$s:this})}),v(H,"$<<",function le(q){return le.$$p=null,S(T,"proc",[],function k(N){var U,te=k.$$p||Z,A=null==k.$$s?this:k.$$s,y=Z;return k.$$p=null,U=de(arguments),y=S(q,"call",L(U),te.$to_proc()),A.$call(y)},{$$arity:-1,$$s:this})}),v(H,"$to_proc",D),v(H,"$lambda?",function(){return!!this.$$is_lambda}),v(H,"$arity",function(){var q=this;return q.$$is_curried?-1:null!=q.$$arity?q.$$arity:q.length}),v(H,"$source_location",function(){var Y=Z;return this.$$is_curried?Z:f(Y=this.$$source_location)?Y:Z}),v(H,"$binding",function(){var Y=this;return Y.$$is_curried&&T.$raise(X("ArgumentError"),"Can't create Binding"),f(X("::","Binding","skip_raise")?"constant":Z)?X("Binding").$new(Z,[],Y.$$s,Y.$source_location()):Z}),v(H,"$parameters",function(q){var Y,Q=this;if(Y=(q=J(q)).$$smap.lambda,Q.$$is_curried)return[["rest"]];if(Q.$$parameters){if(null==Y?Q.$$is_lambda:Y)return Q.$$parameters;var N,te,k=[];for(N=0,te=Q.$$parameters.length;N<te;N++){var U=Q.$$parameters[N];"req"===U[0]&&(U=["opt",U[1]]),k.push(U)}return k}return[]},-1),v(H,"$curry",function(q){var Y=this;function Q(){var te,k=de(arguments),N=k.length;return N>q&&Y.$$is_lambda&&!Y.$$is_curried&&T.$raise(X("ArgumentError"),"wrong number of arguments ("+N+" for "+q+")"),N>=q?Y.$call.apply(Y,k):(te=function(){return Q.apply(null,k.concat(de(arguments)))},te.$$is_lambda=Y.$$is_lambda,te.$$is_curried=!0,te)}return void 0===q?q=Y.length:(q=j["$coerce_to!"](q,X("Integer"),"to_int"),Y.$$is_lambda&&q!==Y.length&&T.$raise(X("ArgumentError"),"wrong number of arguments ("+q+" for "+Y.length+")")),Q.$$is_lambda=Y.$$is_lambda,Q.$$is_curried=!0,Q},-1),v(H,"$dup",function(){var q=this,Y=q.$$original_proc||q,Q=function(){return Y.apply(this,arguments)};for(var k in q)q.hasOwnProperty(k)&&(Q[k]=q[k]);return Q}),F(H,"===","call"),F(H,"clone","dup"),F(H,"yield","call"),F(H,"[]","call")},Opal.modules["corelib/method"]=function(E){var Z,X,de=E.klass,ye=E.def,f=E.truthy,T=E.slice,ne=E.alias,v=E.Kernel,S=E.send,L=E.to_a,D=E.nil,J=E.$$$;return(X=(Z=de("::",null,"Method")).$$prototype).method=X.receiver=X.owner=X.name=D,Z.$attr_reader("owner","receiver","name"),ye(Z,"$initialize",function(P,H,le,q){var Y=this;return Y.receiver=P,Y.owner=H,Y.name=q,Y.method=le}),ye(Z,"$arity",function(){return this.method.$arity()}),ye(Z,"$parameters",function(){return this.method.$$parameters}),ye(Z,"$source_location",function(){var H;return f(H=this.method.$$source_location)?H:["(eval)",0]}),ye(Z,"$comments",function(){var H;return f(H=this.method.$$comments)?H:[]}),ye(Z,"$call",function K(P){var q,H=K.$$p||D,Y=this;return K.$$p=null,q=T(arguments),Y.method.$$p=H,Y.method.apply(Y.receiver,q)},-1),ye(Z,"$curry",function(P){return this.method.$curry(P)},-1),ye(Z,"$>>",function(P){return this.method["$>>"](P)}),ye(Z,"$<<",function(P){return this.method["$<<"](P)}),ye(Z,"$unbind",function(){var P=this;return J("UnboundMethod").$new(P.receiver.$class(),P.owner,P.method,P.name)}),ye(Z,"$to_proc",function(){var P=this,H=P.$call.bind(P);return H.$$unbound=P.method,H.$$is_lambda=!0,H.$$arity=null==P.method.$$arity?P.method.length:P.method.$$arity,H.$$parameters=P.method.$$parameters,H}),ye(Z,"$inspect",function(){var P=this;return"#<"+P.$class()+": "+P.receiver.$class()+"#"+P.name+" (defined in "+P.owner+" in "+P.$source_location().$join(":")+")>"}),ne(Z,"[]","call"),ne(Z,"===","call"),function(j,F){var Z=de("::",null,"UnboundMethod"),X=Z.$$prototype;return X.method=X.owner=X.name=X.source=D,Z.$attr_reader("source","owner","name"),ye(Z,"$initialize",function(P,H,le,q){var Y=this;return Y.source=P,Y.owner=H,Y.method=le,Y.name=q}),ye(Z,"$arity",function(){return this.method.$arity()}),ye(Z,"$parameters",function(){return this.method.$$parameters}),ye(Z,"$source_location",function(){var H;return f(H=this.method.$$source_location)?H:["(eval)",0]}),ye(Z,"$comments",function(){var H;return f(H=this.method.$$comments)?H:[]}),ye(Z,"$bind",function(P){var H=this;if(H.owner.$$is_module||E.is_a(P,H.owner))return J("Method").$new(P,H.owner,H.method,H.name);v.$raise(J("TypeError"),"can't bind singleton method to a different class (expected "+P+".kind_of?("+H.owner+" to be true)")}),ye(Z,"$bind_call",function K(P,H){var Y,le=K.$$p||D,Q=this;return K.$$p=null,Y=T(arguments,1),S(Q.$bind(P),"call",L(Y),le.$to_proc())},-2),ye(Z,"$inspect",function(){var P=this;return"#<"+P.$class()+": "+P.source+"#"+P.name+" (defined in "+P.owner+" in "+P.$source_location().$join(":")+")>"})}()},Opal.modules["corelib/variables"]=function(E){var de=E.gvars,ye=E.const_set,f=E.Object,T=E.hash2,ne=E.nil;return de["&"]=de["~"]=de["`"]=de["'"]=ne,de.LOADED_FEATURES=de['"']=E.loaded_features,de.LOAD_PATH=de[":"]=[],de["/"]="\n",de[","]=ne,ye("::","ARGV",[]),ye("::","ARGF",f.$new()),ye("::","ENV",T([],{})),de.VERBOSE=!1,de.DEBUG=!1,de.SAFE=0},Opal.modules["corelib/io"]=function(E){var k,y,R,ye=E.const_set,f=E.not,T=E.truthy,ne=E.def,v=E.return_ivar,S=E.return_val,L=E.slice,D=E.Kernel,J=E.gvars,j=E.send,F=E.to_a,Z=E.rb_plus,X=E.neqeq,K=E.range,P=E.hash2,H=E.eqeq,le=E.to_ary,q=E.rb_gt,Y=E.assign_ivar_val,Q=E.alias,N=E.nil,te=E.$$$;(R=(y=(0,E.klass)("::",null,"IO")).$$prototype).read_buffer=R.closed=N,ye(y,"SEEK_SET",0),ye(y,"SEEK_CUR",1),ye(y,"SEEK_END",2),ye(y,"SEEK_DATA",3),ye(y,"SEEK_HOLE",4),ye(y,"READABLE",1),ye(y,"WRITABLE",4),y.$attr_reader("eof"),y.$attr_accessor("read_proc","sync","tty","write_proc"),ne(y,"$initialize",function(ie,M){var ge=this;return null==M&&(M="r"),ge.fd=ie,ge.flags=M,ge.eof=!1,T(M["$include?"]("r"))&&f(M["$match?"](/[wa+]/))?ge.closed="write":T(M["$match?"](/[wa]/))&&f(M["$match?"](/[r+]/))?ge.closed="read":N},-2),ne(y,"$fileno",v("fd")),ne(y,"$tty?",function(){return 1==this.tty}),ne(y,"$write",function(ie){return this.write_proc(ie),ie.$size()}),ne(y,"$flush",S(N)),ne(y,"$<<",function(ie){return this.$write(ie),this}),ne(y,"$print",function(ie){var ge,B=this;null==J[","]&&(J[","]=N);for(var O=0,_=(ge=L(arguments)).length;O<_;O++)ge[O]=D.$String(ge[O]);return B.$write(ge.join(J[","])),N},-1),ne(y,"$puts",function(ie){var ge,O,B=this;if(0===(ge=L(arguments)).length)return B.$write("\n"),N;for(var _=0,l=ge.length;_<l;_++)if(ge[_].$$is_array){var c=ge[_].$flatten();c.length>0&&j(B,"puts",F(c))}else(O=ge[_].$$is_string?ge[_].valueOf():D.$String(ge[_])).endsWith("\n")||(O+="\n"),B.$write(O);return N},-1),ne(y,"$getc",function(){var M,ie=this,ge=N,B=N;ie.read_buffer=T(M=ie.read_buffer)?M:"",ge="";do{if(ie.read_buffer=Z(ie.read_buffer,ge),X(ie.read_buffer,""))return B=ie.read_buffer["$[]"](0),ie.read_buffer=ie.read_buffer["$[]"](K(1,-1,!1)),B}while(T(ge=ie.$sysread_noraise(1)));return N}),ne(y,"$getbyte",function(){var ie;return(ie=this.$getc())===N||null==ie?N:ie.$ord()}),ne(y,"$readbyte",function(){return this.$readchar().$ord()}),ne(y,"$readchar",function(){var M;return T(M=this.$getc())?M:D.$raise(te("EOFError"),"end of file reached")}),ne(y,"$readline",function(ie){var M,B=this,O=N;return M=L(arguments),T(O=j(B,"gets",F(M)))?O:D.$raise(te("EOFError"),"end of file reached")},-1),ne(y,"$gets",function(ie,M,ge){var B,O,l,h,_=this,c=N,d=N,p=N,m=N;null==J["/"]&&(J["/"]=N),null==ie&&(ie=!1),null==M&&(M=N),null==ge&&(ge=P([],{})),T(ie.$$is_number)&&f(M)&&(ie=(B=[!1,ie,M])[0],M=B[1],ge=B[2]),T(ie.$$is_hash)&&f(M)&&H(ge,P([],{}))?(ie=(B=[!1,N,ie])[0],M=B[1],ge=B[2]):T(M.$$is_hash)&&H(ge,P([],{}))&&(ie=(B=[ie,N,M])[0],M=B[1],ge=B[2]),l=ie,H(ie,!1)&&(ie=J["/"]),H(ie,"")&&(ie=/\r?\n\r?\n/),ie=T(c=ie)?c:"",H(l,"")||(ie=ie.$to_str()),h=H(l,"")?2:ie.$length(),H(ie," ")&&(ie=/ /),_.read_buffer=T(c=_.read_buffer)?c:"",d="",p=N;do{if(_.read_buffer=Z(_.read_buffer,d),X(ie,"")&&T(T(ie.$$is_regexp)?_.read_buffer["$match?"](ie):_.read_buffer["$include?"](ie))){m=_.read_buffer,O=_.read_buffer.$split(ie,2),p=null==(B=le(O))[0]?N:B[0],_.read_buffer=null==B[1]?N:B[1],X(p,m)&&(p=Z(p,m["$[]"](p.$length(),h)));break}}while(T(d=_.$sysread_noraise(H(ie,"")?65536:1)));return T(p)||(p=(B=[T(c=_.read_buffer)?c:"",""])[0],_.read_buffer=B[1],H(p,"")&&(p=N)),T(p)&&(T(M)&&(p=p["$[]"](E.Range.$new(0,M,!0)),_.read_buffer=Z(p["$[]"](E.Range.$new(M,-1,!1)),_.read_buffer)),T(ge["$[]"]("chomp"))&&(p=p.$sub(/\r?\n$/,"")),H(l,"")&&(p=p.$sub(/^[\r\n]+/,""))),H(l,!1)&&(J._=p),p},-1),ne(y,"$sysread",function(ie){var ge;return T(ge=this.read_proc(ie))?ge:(this.eof=!0,D.$raise(te("EOFError"),"end of file reached"))}),ne(y,"$sysread_noraise",function(ie){try{return this.$sysread(ie)}catch(ge){if(!E.rescue(ge,[te("EOFError")]))throw ge;try{return N}finally{E.pop_exception()}}}),ne(y,"$readpartial",function(ie){var M,O,ge=this,B=N,_=N;return ge.read_buffer=T(B=ge.read_buffer)?B:"",O=ge.$sysread(ie),_=(M=[Z(ge.read_buffer,T(B=O)?B:""),""])[0],ge.read_buffer=M[1],H(_,"")&&(_=N),_}),ne(y,"$read",function(ie){var M,ge=this,B=N,O=N,_=N;null==ie&&(ie=N),ge.read_buffer=T(B=ge.read_buffer)?B:"",O="",_=N;do{if(ge.read_buffer=Z(ge.read_buffer,O),T(ie)&&T(q(ge.read_buffer.$length(),ie)))return _=(M=[ge.read_buffer["$[]"](E.Range.$new(0,ie,!0)),ge.read_buffer["$[]"](E.Range.$new(ie,-1,!1))])[0],ge.read_buffer=M[1],_}while(T(O=ge.$sysread_noraise(T(B=ie)?B:65536)));return _=(M=[ge.read_buffer,""])[0],ge.read_buffer=M[1],_},-1),ne(y,"$readlines",function(ie){return null==J["/"]&&(J["/"]=N),null==ie&&(ie=J["/"]),this.$each_line(ie).$to_a()},-1),ne(y,"$each",function z(ie,M){var B,O,_,ge=z.$$p||N,l=this,c=N;if(null==J["/"]&&(J["/"]=N),z.$$p=null,(B=L(arguments)).length>0&&(O=B.shift()),null==O&&(O=J["/"]),_=B,ge===N)return j(l,"enum_for",["each",O].concat(F(_)));for(;T(c=j(l,"gets",[O].concat(F(_))));)E.yield1(ge,c);return l},-1),ne(y,"$each_byte",function z(){var ie=z.$$p||N,M=this,ge=N;if(z.$$p=null,ie===N)return M.$enum_for("each_byte");for(;T(ge=M.$getbyte());)E.yield1(ie,ge);return M}),ne(y,"$each_char",function z(){var ie=z.$$p||N,M=this,ge=N;if(z.$$p=null,ie===N)return M.$enum_for("each_char");for(;T(ge=M.$getc());)E.yield1(ie,ge);return M}),ne(y,"$close",Y("closed","both")),ne(y,"$close_read",function(){return this.closed=H(this.closed,"write")?"both":"read"}),ne(y,"$close_write",function(){return this.closed=H(this.closed,"read")?"both":"write"}),ne(y,"$closed?",function(){return this.closed["$=="]("both")}),ne(y,"$closed_read?",function(){var M;return T(M=this.closed["$=="]("read"))?M:this.closed["$=="]("both")}),ne(y,"$closed_write?",function(){var M;return T(M=this.closed["$=="]("write"))?M:this.closed["$=="]("both")}),ne(y,"$check_writable",function(){return T(this["$closed_write?"]())?D.$raise(te("IOError"),"not opened for writing"):N}),ne(y,"$check_readable",function(){return T(this["$closed_read?"]())?D.$raise(te("IOError"),"not opened for reading"):N}),Q(y,"each_line","each"),Q(y,"eof?","eof"),ye("::","STDIN",J.stdin=te("IO").$new(0,"r")),ye("::","STDOUT",J.stdout=te("IO").$new(1,"w")),ye("::","STDERR",J.stderr=te("IO").$new(2,"w"));var U=E.global.console;return te("STDOUT")["$write_proc="]("object"==typeof process&&"object"==typeof process.stdout?function(I){process.stdout.write(I)}:function(I){U.log(I)}),te("STDERR")["$write_proc="]("object"==typeof process&&"object"==typeof process.stderr?function(I){process.stderr.write(I)}:function(I){U.warn(I)}),k=[function(I){var A=prompt();return null!==A?A+"\n":N}],j(te("STDIN"),"read_proc=",k),k[k.length-1]},Opal.modules["opal/regexp_anchors"]=function(E){var S,L,D,J,ye=E.const_set,f=[],ne=E.$$$;return S=f,D=[L=(0,E.module)(f[0],"Opal")].concat(S),J=E.$r(D),ye(L,"REGEXP_START","^"),ye(L,"REGEXP_END","$"),ye(L,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),ye(L,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),ye(L,"INLINE_IDENTIFIER_REGEXP",J("Regexp").$new("[^"+ne(L,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+ne(L,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),ye(L,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),ye(L,"CONST_NAME_REGEXP",J("Regexp").$new(ne(L,"REGEXP_START")+"(::)?[A-Z][^"+ne(L,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+ne(L,"REGEXP_END")))},Opal.modules["opal/mini"]=function(E){var de=E.Object;return de.$require("opal/base"),de.$require("corelib/nil"),de.$require("corelib/boolean"),de.$require("corelib/string"),de.$require("corelib/comparable"),de.$require("corelib/enumerable"),de.$require("corelib/enumerator"),de.$require("corelib/array"),de.$require("corelib/hash"),de.$require("corelib/number"),de.$require("corelib/range"),de.$require("corelib/proc"),de.$require("corelib/method"),de.$require("corelib/regexp"),de.$require("corelib/variables"),de.$require("corelib/io"),de.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(E){var X,de=E.coerce_to,f=E.slice,T=E.truthy,ne=E.eqeq,v=E.Opal,S=E.Kernel,L=E.gvars,J=E.alias,j=E.nil,F=E.$$$;return(0,E.def)(X=(0,E.module)("::","Kernel"),"$format",function(P,H){var le,q,Y=j;null==L.DEBUG&&(L.DEBUG=j),le=f(arguments,1),ne((q=le).$length(),1)&&T(q["$[]"](0)["$respond_to?"]("to_ary"))&&(Y=v["$coerce_to?"](q["$[]"](0),F("Array"),"to_ary"),T(Y["$nil?"]())||(q=Y.$to_a()));var N,te,I,A,y,R,z,ie,M,ge,B,O,_,l,c,p,Q="",k=0,U=P.length,h=1,d=0,m=0,x=1,$=2,re=4,se=8,De=16,Ae=32,fe=64,Pe=128;function be(){p&Ae&&S.$raise(F("ArgumentError"),"flag after width"),p&Pe&&S.$raise(F("ArgumentError"),"flag after precision")}function xe(){p&Ae&&S.$raise(F("ArgumentError"),"width given twice"),p&Pe&&S.$raise(F("ArgumentError"),"width after precision")}function pe(C){return C>=q.length&&S.$raise(F("ArgumentError"),"too few arguments"),q[C]}function Me(){switch(d){case-1:S.$raise(F("ArgumentError"),"unnumbered("+h+") mixed with numbered");case-2:S.$raise(F("ArgumentError"),"unnumbered("+h+") mixed with named")}return pe((d=h++)-1)}function Ce(C){return d>0&&S.$raise(F("ArgumentError"),"numbered("+C+") after unnumbered("+d+")"),-2===d&&S.$raise(F("ArgumentError"),"numbered("+C+") after named"),C<1&&S.$raise(F("ArgumentError"),"invalid index - "+C+"$"),d=-1,pe(C-1)}function ae(){return void 0===c?Me():c}function he(C){for(var V,$e="";;te++){if(te===U&&S.$raise(F("ArgumentError"),"malformed format string - %*[0-9]"),P.charCodeAt(te)<48||P.charCodeAt(te)>57)return te--,(V=parseInt($e,10)||0)>2147483647&&S.$raise(F("ArgumentError"),C+" too big"),V;$e+=P.charAt(te)}}function Ee(C){var V,$e=he(C);return"$"===P.charAt(te+1)?(te++,V=Ce($e)):V=Me(),V.$to_int()}for(te=P.indexOf("%");-1!==te;te=P.indexOf("%",te)){switch(A=void 0,p=m,R=-1,z=-1,c=void 0,N=te,te++,P.charAt(te)){case"%":k=te;case"":case"\n":case"\0":te++;continue}e:for(;te<U;te++)switch(P.charAt(te)){case" ":be(),p|=De;continue e;case"#":be(),p|=x;continue e;case"+":be(),p|=re;continue e;case"-":be(),p|=$;continue e;case"0":be(),p|=se;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(ie=he("width"),"$"===P.charAt(te+1)){if(te+2===U){A="%",te++;break e}void 0!==c&&S.$raise(F("ArgumentError"),"value given twice - %"+ie+"$"),c=Ce(ie),te++}else xe(),p|=Ae,R=ie;continue e;case"<":case"{":for(ge="<"===P.charAt(te)?">":"}",M="",te++;;te++){if(te===U&&S.$raise(F("ArgumentError"),"malformed name - unmatched parenthesis"),P.charAt(te)===ge){if(d>0&&S.$raise(F("ArgumentError"),"named "+M+" after unnumbered("+d+")"),-1===d&&S.$raise(F("ArgumentError"),"named "+M+" after numbered"),d=-2,(void 0===q[0]||!q[0].$$is_hash)&&S.$raise(F("ArgumentError"),"one hash required"),c=q[0].$fetch(M),">"===ge)continue e;if(A=c.toString(),-1!==z&&(A=A.slice(0,z)),p&$)for(;A.length<R;)A+=" ";else for(;A.length<R;)A=" "+A;break e}M+=P.charAt(te)}case"*":te++,xe(),p|=Ae,(R=Ee("width"))<0&&(p|=$,R=-R);continue e;case".":if(p&Pe&&S.$raise(F("ArgumentError"),"precision given twice"),p|=fe|Pe,z=0,te++,"*"===P.charAt(te)){te++,(z=Ee("precision"))<0&&(p&=~fe);continue e}z=he("precision");continue e;case"d":case"i":case"u":if((I=S.$Integer(ae()))>=0){for(A=I.toString();A.length<z;)A="0"+A;if(p&$)for((p&re||p&De)&&(A=(p&re?"+":" ")+A);A.length<R;)A+=" ";else if(p&se&&-1===z){for(;A.length<R-(p&re||p&De?1:0);)A="0"+A;(p&re||p&De)&&(A=(p&re?"+":" ")+A)}else for((p&re||p&De)&&(A=(p&re?"+":" ")+A);A.length<R;)A=" "+A}else{for(A=(-I).toString();A.length<z;)A="0"+A;if(p&$)for(A="-"+A;A.length<R;)A+=" ";else if(p&se&&-1===z){for(;A.length<R-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<R;)A=" "+A}break e;case"b":case"B":case"o":case"x":case"X":switch(P.charAt(te)){case"b":case"B":B=2,O="0b",_=/^1+/,l="1";break;case"o":B=8,O="0",_=/^3?7+/,l="7";break;case"x":case"X":B=16,O="0x",_=/^f+/,l="f"}if((I=S.$Integer(ae()))>=0){for(A=I.toString(B);A.length<z;)A="0"+A;if(p&$)for((p&re||p&De)&&(A=(p&re?"+":" ")+A),p&x&&0!==I&&(A=O+A);A.length<R;)A+=" ";else if(p&se&&-1===z){for(;A.length<R-(p&re||p&De?1:0)-(p&x&&0!==I?O.length:0);)A="0"+A;p&x&&0!==I&&(A=O+A),(p&re||p&De)&&(A=(p&re?"+":" ")+A)}else for(p&x&&0!==I&&(A=O+A),(p&re||p&De)&&(A=(p&re?"+":" ")+A);A.length<R;)A=" "+A}else if(p&re||p&De){for(A=(-I).toString(B);A.length<z;)A="0"+A;if(p&$)for(p&x&&(A=O+A),A="-"+A;A.length<R;)A+=" ";else if(p&se&&-1===z){for(;A.length<R-1-(p&x?2:0);)A="0"+A;p&x&&(A=O+A),A="-"+A}else for(p&x&&(A=O+A),A="-"+A;A.length<R;)A=" "+A}else{for(A=(I>>>0).toString(B).replace(_,l);A.length<z-2;)A=l+A;if(p&$)for(A=".."+A,p&x&&(A=O+A);A.length<R;)A+=" ";else if(p&se&&-1===z){for(;A.length<R-2-(p&x?O.length:0);)A=l+A;A=".."+A,p&x&&(A=O+A)}else for(A=".."+A,p&x&&(A=O+A);A.length<R;)A=" "+A}P.charAt(te)===P.charAt(te).toUpperCase()&&(A=A.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((I=S.$Float(ae()))>=0||isNaN(I)){if(I===1/0)A="Inf";else switch(P.charAt(te)){case"f":A=I.toFixed(-1===z?6:z);break;case"e":case"E":A=I.toExponential(-1===z?6:z);break;case"g":case"G":A=I.toExponential(),(y=parseInt(A.split("e")[1],10))<-4||y>=(-1===z?6:z)||(A=I.toPrecision(-1===z?p&x?6:void 0:z))}if(p&$)for((p&re||p&De)&&(A=(p&re?"+":" ")+A);A.length<R;)A+=" ";else if(p&se&&I!==1/0&&!isNaN(I)){for(;A.length<R-(p&re||p&De?1:0);)A="0"+A;(p&re||p&De)&&(A=(p&re?"+":" ")+A)}else for((p&re||p&De)&&(A=(p&re?"+":" ")+A);A.length<R;)A=" "+A}else{if(I===-1/0)A="Inf";else switch(P.charAt(te)){case"f":A=(-I).toFixed(-1===z?6:z);break;case"e":case"E":A=(-I).toExponential(-1===z?6:z);break;case"g":case"G":A=(-I).toExponential(),(y=parseInt(A.split("e")[1],10))<-4||y>=(-1===z?6:z)||(A=(-I).toPrecision(-1===z?p&x?6:void 0:z))}if(p&$)for(A="-"+A;A.length<R;)A+=" ";else if(p&se&&I!==-1/0){for(;A.length<R-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<R;)A=" "+A}P.charAt(te)===P.charAt(te).toUpperCase()&&I!==1/0&&I!==-1/0&&!isNaN(I)&&(A=A.toUpperCase()),A=A.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":S.$raise(F("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((I=ae())["$respond_to?"]("to_ary")&&(I=I.$to_ary()[0]),1!==(A=I["$respond_to?"]("to_str")?I.$to_str():String.fromCharCode(de(I,F("Integer"),"to_int"))).length&&S.$raise(F("ArgumentError"),"%c requires a character"),p&$)for(;A.length<R;)A+=" ";else for(;A.length<R;)A=" "+A;break e;case"p":if(A=ae().$inspect(),-1!==z&&(A=A.slice(0,z)),p&$)for(;A.length<R;)A+=" ";else for(;A.length<R;)A=" "+A;break e;case"s":if(A=ae().$to_s(),-1!==z&&(A=A.slice(0,z)),p&$)for(;A.length<R;)A+=" ";else for(;A.length<R;)A=" "+A;break e;default:S.$raise(F("ArgumentError"),"malformed format string - %"+P.charAt(te))}void 0===A&&S.$raise(F("ArgumentError"),"malformed format string - %"),Q+=P.slice(k,N)+A,k=te+1}return L.DEBUG&&d>=0&&h<q.length&&S.$raise(F("ArgumentError"),"too many arguments for format string"),Q+P.slice(k)},-2),J(X,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(E){var K,N,te,de=E.klass,ye=E.hash2,f=E.rb_plus,T=E.truthy,ne=E.send,v=E.defs,S=E.eqeq,L=E.def,D=E.return_ivar,J=E.return_val,j=E.slice,F=E.Kernel,Z=E.Opal,X=E.rb_lt,P=E.top,le=E.$r([]),q=E.nil,Y=E.$$$;return P.$require("corelib/string"),(te=(N=de("::",null,"Encoding")).$$prototype).name=te.dummy=q,v(N,"$register",function U(I,A){var z,M,ge,y=U.$$p||q,ie=q,B=q,O=q;return U.$$p=null,null==A&&(A=ye([],{})),z=f([I],T(ie=A["$[]"]("aliases"))?ie:[]),M=T(ie=A["$[]"]("ascii"))&&ie,ge=T(ie=A["$[]"]("dummy"))&&ie,T(A["$[]"]("inherits"))?(B=A["$[]"]("inherits").$clone()).$initialize(I,z,M,ge):B=this.$new(I,z,M,ge),y!==q&&ne(B,"instance_eval",[],y.$to_proc()),O=E.encodings,ne(z,"each",[],function _(l){return null==l&&(l=q),(null==_.$$s?this:_.$$s).$const_set(l.$tr("-","_"),B),O[l]=B},{$$s:this})},-2),v(N,"$find",function(I){return S(I,"default_external")?this.$default_external():E.find_encoding(I)}),N.$singleton_class().$attr_accessor("default_external"),N.$attr_reader("name","names"),L(N,"$initialize",function(I,A,y,R){var z=this;return z.name=I,z.names=A,z.ascii=y,z.dummy=R}),L(N,"$ascii_compatible?",D("ascii")),L(N,"$dummy?",D("dummy")),L(N,"$binary?",J(!1)),L(N,"$to_s",D("name")),L(N,"$inspect",function(){return"#<Encoding:"+this.name+(T(this.dummy)?" (dummy)":q)+">"}),L(N,"$charsize",function(I){for(var A=0,y=0,R=I.length;y<R;y++){var z=I.charCodeAt(y);z>=55296&&z<=56319||A++}return A}),L(N,"$each_char",function U(I){var A=U.$$p||q;U.$$p=null;for(var y="",R=0,z=I.length;R<z;R++){var ie=I.charCodeAt(R),M=I.charAt(R);ie>=56320&&ie<=57343?y=M:(ie>=55296&&ie<=56319&&(M=y+M),"UTF-8"!=I.encoding.name&&((M=new String(M)).encoding=I.encoding),E.yield1(A,M))}}),L(N,"$each_byte",function(I){return j(arguments),F.$raise(Y("NotImplementedError"))},-1),L(N,"$bytesize",function(I){return j(arguments),F.$raise(Y("NotImplementedError"))},-1),de("::",Y("StandardError"),"EncodingError"),de("::",Y("EncodingError"),"CompatibilityError"),ne(Y("Encoding"),"register",["UTF-8",ye(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function Q(){var k=null==Q.$$s?this:Q.$$s;return L(k,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var A,I=1/0,y=te.length,R=null,z=0;z<y;++z){if((A=te.charCodeAt(z))>55295&&A<57344){if(!R){if(A>56319){(I-=3)>-1&&(E.yield1(U,239),E.yield1(U,191),E.yield1(U,189));continue}if(z+1===y){(I-=3)>-1&&(E.yield1(U,239),E.yield1(U,191),E.yield1(U,189));continue}R=A;continue}if(A<56320){(I-=3)>-1&&(E.yield1(U,239),E.yield1(U,191),E.yield1(U,189)),R=A;continue}A=65536+(R-55296<<10|A-56320)}else R&&(I-=3)>-1&&(E.yield1(U,239),E.yield1(U,191),E.yield1(U,189));if(R=null,A<128){if((I-=1)<0)break;E.yield1(U,A)}else if(A<2048){if((I-=2)<0)break;E.yield1(U,A>>6|192),E.yield1(U,63&A|128)}else if(A<65536){if((I-=3)<0)break;E.yield1(U,A>>12|224),E.yield1(U,A>>6&63|128),E.yield1(U,63&A|128)}else if(A<1114112){if((I-=4)<0)break;E.yield1(U,A>>18|240),E.yield1(U,A>>12&63|128),E.yield1(U,A>>6&63|128),E.yield1(U,63&A|128)}}}),L(k,"$bytesize",function(te){return te.$bytes().$length()})},{$$s:P}),ne(Y("Encoding"),"register",["UTF-16LE"],function Q(){var k=null==Q.$$s?this:Q.$$s;return L(k,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=te.charCodeAt(I);E.yield1(U,255&y),E.yield1(U,y>>8)}}),L(k,"$bytesize",function(te){return 2*te.length})},{$$s:P}),ne(Y("Encoding"),"register",["UTF-16BE",ye(["inherits"],{inherits:Y(Y("Encoding"),"UTF_16LE")})],function Q(){return L(null==Q.$$s?this:Q.$$s,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=te.charCodeAt(I);E.yield1(U,y>>8),E.yield1(U,255&y)}})},{$$s:P}),ne(Y("Encoding"),"register",["UTF-32LE"],function Q(){var k=null==Q.$$s?this:Q.$$s;return L(k,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=te.charCodeAt(I);E.yield1(U,255&y),E.yield1(U,y>>8),E.yield1(U,0),E.yield1(U,0)}}),L(k,"$bytesize",function(te){return 4*te.length})},{$$s:P}),ne(Y("Encoding"),"register",["UTF-32BE",ye(["inherits"],{inherits:Y(Y("Encoding"),"UTF_32LE")})],function Q(){return L(null==Q.$$s?this:Q.$$s,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=te.charCodeAt(I);E.yield1(U,0),E.yield1(U,0),E.yield1(U,y>>8),E.yield1(U,255&y)}})},{$$s:P}),ne(Y("Encoding"),"register",["ASCII-8BIT",ye(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function Q(){var k=null==Q.$$s?this:Q.$$s;return L(k,"$each_char",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=new String(te.charAt(I));y.encoding=te.encoding,E.yield1(U,y)}}),L(k,"$charsize",function(te){return te.length}),L(k,"$each_byte",function N(te){var U=N.$$p||q;N.$$p=null;for(var I=0,A=te.length;I<A;I++){var y=te.charCodeAt(I);E.yield1(U,255&y)}}),L(k,"$bytesize",function(te){return te.length}),L(k,"$binary?",J(!0))},{$$s:P}),Y("Encoding").$register("ISO-8859-1",ye(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:Y(Y("Encoding"),"ASCII_8BIT")})),Y("Encoding").$register("US-ASCII",ye(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:Y(Y("Encoding"),"ASCII_8BIT")})),function(Q,k){var N=de("::",null,"String"),te=N.$$prototype;te.internal_encoding=te.bytes=te.encoding=q,N.$attr_reader("encoding"),N.$attr_reader("internal_encoding"),E.prop(String.prototype,"bytes",q),E.prop(String.prototype,"encoding",Y(Y("Encoding"),"UTF_8")),E.prop(String.prototype,"internal_encoding",Y(Y("Encoding"),"UTF_8")),L(N,"$b",function(){return this.$dup().$force_encoding("binary")}),L(N,"$bytesize",function(){return this.internal_encoding.$bytesize(this)}),L(N,"$each_byte",function U(){var I=U.$$p||q,A=this;return U.$$p=null,I===q?ne(A,"enum_for",["each_byte"],function y(){return(null==y.$$s?this:y.$$s).$bytesize()},{$$s:A}):(ne(A.internal_encoding,"each_byte",[A],I.$to_proc()),A)}),L(N,"$bytes",function(){var I=this,A=q;return"string"==typeof I?new String(I).$each_byte().$to_a():(I.bytes=T(A=I.bytes)?A:I.$each_byte().$to_a(),I.bytes.$dup())}),L(N,"$each_char",function U(){var I=U.$$p||q,A=this;return U.$$p=null,I===q?ne(A,"enum_for",["each_char"],function y(){return(null==y.$$s?this:y.$$s).$length()},{$$s:A}):(ne(A.encoding,"each_char",[A],I.$to_proc()),A)}),L(N,"$chars",function U(){var I=U.$$p||q;return U.$$p=null,T(I)?ne(this,"each_char",[],I.$to_proc()):this.$each_char().$to_a()}),L(N,"$each_codepoint",function U(){var I=U.$$p||q,A=this;if(U.$$p=null,I===q)return A.$enum_for("each_codepoint");for(var y=0,R=A.length;y<R;y++)E.yield1(I,A.codePointAt(y));return A}),L(N,"$codepoints",function U(){var I=U.$$p||q;return U.$$p=null,I!==q?ne(this,"each_codepoint",[],I.$to_proc()):this.$each_codepoint().$to_a()}),L(N,"$encode",function(I){return E.enc(this,I)}),L(N,"$force_encoding",function(I){var y=this;return I===y.encoding||(I=Z["$coerce_to!"](I,Y("String"),"to_s"),(I=Y("Encoding").$find(I))===y.encoding)||(y=E.set_encoding(y,I)),y}),L(N,"$getbyte",function(I){var y=q;return y=this.$bytes(),I=Z["$coerce_to!"](I,Y("Integer"),"to_int"),T(X(y.$length(),I))?q:y["$[]"](I)}),L(N,"$initialize_copy",function(I){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "}),L(N,"$valid_encoding?",J(!0))}(),K=[Y(le("Encoding"),"UTF_8")],ne(Y("Encoding"),"default_external=",K),K[K.length-1]},Opal.modules["corelib/math"]=function(E){var le,q,Y,Q,de=E.type_error,f=E.const_set,T=E.Class,ne=E.slice,v=E.Kernel,S=E.defs,L=E.truthy,D=E.send,J=E.def,j=E.rb_minus,F=E.eqeqeq,Z=E.rb_divide,K=E.nil,P=E.$$$;return le=[],Y=[q=(0,E.module)("::","Math")].concat(le),Q=E.$r(Y),f(q,"E",Math.E),f(q,"PI",Math.PI),f(q,"DomainError",T.$new(P("StandardError"))),S(q,"$checked",function(N,te){var I;if(I=ne(arguments,1),isNaN(I[0])||2==I.length&&isNaN(I[1]))return NaN;var A=Math[N].apply(null,I);return isNaN(A)&&v.$raise(Q("DomainError"),'Numerical argument is out of domain - "'+N+'"'),A},-2),S(q,"$float!",function(N){try{return v.$Float(N)}catch(te){if(!E.rescue(te,[P("ArgumentError")]))throw te;try{return v.$raise(de(N,P("Float")))}finally{E.pop_exception()}}}),S(q,"$integer!",function(N){try{return v.$Integer(N)}catch(te){if(!E.rescue(te,[P("ArgumentError")]))throw te;try{return v.$raise(de(N,P("Integer")))}finally{E.pop_exception()}}}),q.$module_function(),L(void 0!==Math.erf)||E.prop(Math,"erf",function(k){var R=1;k<0&&(R=-1);var z=1/(1+.3275911*(k=Math.abs(k)));return R*(1-((((1.061405429*z-1.453152027)*z+1.421413741)*z-.284496736)*z+.254829592)*z*Math.exp(-k*k))}),L(void 0!==Math.erfc)||E.prop(Math,"erfc",function(k){var N=Math.abs(k),te=1/(.5*N+1),O=te*Math.exp(-N*N-1.26551223+te*(te*(te*(te*(te*(te*(te*(te*(.17087277*te-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return k<0?2-O:O}),D(["acos","acosh","asin","asinh","atan","atanh","cbrt","cos","cosh","erf","erfc","exp","sin","sinh","sqrt","tanh"],"each",[],function k(N){return null==N&&(N=K),D(null==k.$$s?this:k.$$s,"define_method",[N],function(I){return null==I&&(I=K),P("Math").$checked(N,P("Math")["$float!"](I))})},{$$s:q}),J(q,"$atan2",function(N,te){return P("Math").$checked("atan2",P("Math")["$float!"](N),P("Math")["$float!"](te))}),J(q,"$hypot",function(N,te){return P("Math").$checked("hypot",P("Math")["$float!"](N),P("Math")["$float!"](te))}),J(q,"$frexp",function(N){if(N=Q("Math")["$float!"](N),isNaN(N))return[NaN,0];var te=Math.floor(Math.log(Math.abs(N))/Math.log(2))+1;return[N/Math.pow(2,te),te]}),J(q,"$gamma",function(N){N=Q("Math")["$float!"](N);var te,U,I,A,y,R,z,ie,M,B=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(N))return NaN;if(0===N&&1/N<0)return-1/0;if((-1===N||N===-1/0)&&v.$raise(Q("DomainError"),'Numerical argument is out of domain - "gamma"'),Q("Integer")["$==="](N)){if(N<=0)return isFinite(N)?1/0:NaN;if(N>171)return 1/0;for(A=N-2,y=N-1;A>1;)y*=A,A--;return 0==y&&(y=1),y}if(N<.5)return Math.PI/(Math.sin(Math.PI*N)*P("Math").$gamma(j(1,N)));if(N>=171.35)return 1/0;if(N>85)return M=(ie=(z=(R=N*N)*N)*N)*N,Math.sqrt(2*Math.PI/N)*Math.pow(N/Math.E,N)*(1+1/(12*N)+1/(288*R)-139/(51840*z)-571/(2488320*ie)+163879/(209018880*M)+5246819/(75246796800*M*N));for(N-=1,I=B[0],te=1;te<B.length;++te)I+=B[te]/(N+te);return U=N+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(U,N+.5)*Math.exp(-U)*I}),J(q,"$ldexp",function(N,te){return N=Q("Math")["$float!"](N),te=Q("Math")["$integer!"](te),isNaN(te)&&v.$raise(P("RangeError"),"float NaN out of range of integer"),N*Math.pow(2,te)}),J(q,"$lgamma",function(N){return-1==N?[1/0,1]:[Math.log(Math.abs(P("Math").$gamma(N))),P("Math").$gamma(N)<0?-1:1]}),J(q,"$log",function(N,te){return F(P("String"),N)&&v.$raise(de(N,P("Float"))),L(null==te)?P("Math").$checked("log",P("Math")["$float!"](N)):(F(P("String"),te)&&v.$raise(de(te,P("Float"))),Z(P("Math").$checked("log",P("Math")["$float!"](N)),P("Math").$checked("log",P("Math")["$float!"](te))))},-2),J(q,"$log10",function(N){return F(P("String"),N)&&v.$raise(de(N,P("Float"))),P("Math").$checked("log10",P("Math")["$float!"](N))}),J(q,"$log2",function(N){return F(P("String"),N)&&v.$raise(de(N,P("Float"))),P("Math").$checked("log2",P("Math")["$float!"](N))}),J(q,"$tan",function(N){return N=P("Math")["$float!"](N),L(N["$infinite?"]())?P(P("Float"),"NAN"):P("Math").$checked("tan",P("Math")["$float!"](N))})},Opal.modules["corelib/complex/base"]=function(E){var L,D,J,j,ye=E.truthy,f=E.def,T=E.klass,ne=[],v=E.nil;return L=ne,J=[D=(0,E.module)("::","Kernel")].concat(L),j=E.$r(J),f(D,"$Complex",function(Z,X){return null==X&&(X=v),ye(X)?j("Complex").$new(Z,X):j("Complex").$new(Z,0)},-2),function(S,L,D){var J=T("::",null,"String"),j=[J].concat(D),F=E.$r(j);return f(J,"$to_c",function(){return F("Complex").$from_string(this)})}(0,0,ne)},Opal.modules["corelib/complex"]=function(E){var te,U,I,A,y,de=E.klass,ye=E.truthy,f=E.eqeqeq,T=E.Kernel,ne=E.defs,v=E.rb_times,S=E.def,L=E.rb_plus,D=E.rb_minus,J=E.rb_divide,j=E.eqeq,F=E.to_ary,Z=E.rb_gt,X=E.neqeq,K=E.return_val,P=E.const_set,H=E.alias,le=E.top,Y=E.nil,Q=E.$$$;return le.$require("corelib/numeric"),le.$require("corelib/complex/base"),te=[],I=[U=de("::",Q("Numeric"),"Complex")].concat(te),A=E.$r(I),(y=U.$$prototype).real=y.imag=Y,ne(U,"$rect",function(z,ie){return null==ie&&(ie=0),f(Q("Numeric"),z)&&ye(z["$real?"]())&&f(Q("Numeric"),ie)&&ye(ie["$real?"]())||T.$raise(Q("TypeError"),"not a real"),this.$new(z,ie)},-2),ne(U,"$polar",function(z,ie){return null==ie&&(ie=0),f(Q("Numeric"),z)&&ye(z["$real?"]())&&f(Q("Numeric"),ie)&&ye(ie["$real?"]())||T.$raise(Q("TypeError"),"not a real"),this.$new(v(z,Q("Math").$cos(ie)),v(z,Q("Math").$sin(ie)))},-2),U.$attr_reader("real","imag"),S(U,"$initialize",function(z,ie){var M=this;return null==ie&&(ie=0),M.real=z,M.imag=ie,M.$freeze()},-2),S(U,"$coerce",function(z){return f(Q("Complex"),z)?[z,this]:f(Q("Numeric"),z)&&ye(z["$real?"]())?[Q("Complex").$new(z,0),this]:T.$raise(Q("TypeError"),z.$class()+" can't be coerced into Complex")}),S(U,"$==",function(z){var ie=this,M=Y;return f(Q("Complex"),z)?ye(M=ie.real["$=="](z.$real()))?ie.imag["$=="](z.$imag()):M:f(Q("Numeric"),z)&&ye(z["$real?"]())?ye(M=ie.real["$=="](z))?ie.imag["$=="](0):M:z["$=="](ie)}),S(U,"$-@",function(){return T.$Complex(this.real["$-@"](),this.imag["$-@"]())}),S(U,"$+",function(z){var ie=this;return f(Q("Complex"),z)?T.$Complex(L(ie.real,z.$real()),L(ie.imag,z.$imag())):f(Q("Numeric"),z)&&ye(z["$real?"]())?T.$Complex(L(ie.real,z),ie.imag):ie.$__coerced__("+",z)}),S(U,"$-",function(z){var ie=this;return f(Q("Complex"),z)?T.$Complex(D(ie.real,z.$real()),D(ie.imag,z.$imag())):f(Q("Numeric"),z)&&ye(z["$real?"]())?T.$Complex(D(ie.real,z),ie.imag):ie.$__coerced__("-",z)}),S(U,"$*",function(z){var ie=this;return f(Q("Complex"),z)?T.$Complex(D(v(ie.real,z.$real()),v(ie.imag,z.$imag())),L(v(ie.real,z.$imag()),v(ie.imag,z.$real()))):f(Q("Numeric"),z)&&ye(z["$real?"]())?T.$Complex(v(ie.real,z),v(ie.imag,z)):ie.$__coerced__("*",z)}),S(U,"$/",function(z){var ie=this;return f(Q("Complex"),z)?f(Q("Number"),ie.real)&&ye(ie.real["$nan?"]())||f(Q("Number"),ie.imag)&&ye(ie.imag["$nan?"]())||f(Q("Number"),z.$real())&&ye(z.$real()["$nan?"]())||f(Q("Number"),z.$imag())&&ye(z.$imag()["$nan?"]())?Q("Complex").$new(Q(Q("Float"),"NAN"),Q(Q("Float"),"NAN")):J(v(ie,z.$conj()),z.$abs2()):f(Q("Numeric"),z)&&ye(z["$real?"]())?T.$Complex(ie.real.$quo(z),ie.imag.$quo(z)):ie.$__coerced__("/",z)}),S(U,"$**",function(z){var ie,M,ge=this,B=Y,O=Y,_=Y,l=Y,c=Y,h=Y,d=Y,p=Y,m=Y,x=Y,$=Y;if(j(z,0))return Q("Complex").$new(1,0);if(f(Q("Complex"),z))return M=ge.$polar(),B=null==(ie=F(M))[0]?Y:ie[0],O=null==ie[1]?Y:ie[1],_=z.$real(),l=z.$imag(),c=Q("Math").$exp(D(v(_,Q("Math").$log(B)),v(l,O))),h=L(v(O,_),v(l,Q("Math").$log(B))),Q("Complex").$polar(c,h);if(f(Q("Integer"),z)){if(ye(Z(z,0))){for(p=d=ge,m=D(z,1);X(m,0);){for(M=m.$divmod(2),x=null==(ie=F(M))[0]?Y:ie[0],$=null==ie[1]?Y:ie[1];j($,0);)d=T.$Complex(D(v(d.$real(),d.$real()),v(d.$imag(),d.$imag())),v(v(2,d.$real()),d.$imag())),M=(m=x).$divmod(2),x=null==(ie=F(M))[0]?Y:ie[0],$=null==ie[1]?Y:ie[1];p=v(p,d),m=D(m,1)}return p}return J(Q("Rational").$new(1,1),ge)["$**"](z["$-@"]())}return f(Q("Float"),z)||f(Q("Rational"),z)?(M=ge.$polar(),B=null==(ie=F(M))[0]?Y:ie[0],O=null==ie[1]?Y:ie[1],Q("Complex").$polar(B["$**"](z),v(O,z))):ge.$__coerced__("**",z)}),S(U,"$abs",function(){return Q("Math").$hypot(this.real,this.imag)}),S(U,"$abs2",function(){var z=this;return L(v(z.real,z.real),v(z.imag,z.imag))}),S(U,"$angle",function(){return Q("Math").$atan2(this.imag,this.real)}),S(U,"$conj",function(){return T.$Complex(this.real,this.imag["$-@"]())}),S(U,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())}),S(U,"$eql?",function(z){var M,ge;return ye(M=ye(ge=A("Complex")["$==="](z))?this.real.$class()["$=="](this.imag.$class()):ge)?this["$=="](z):M}),S(U,"$fdiv",function(z){return f(Q("Numeric"),z)||T.$raise(Q("TypeError"),z.$class()+" can't be coerced into Complex"),J(this,z)}),S(U,"$finite?",function(){var ie;return ye(ie=this.real["$finite?"]())?this.imag["$finite?"]():ie}),S(U,"$hash",function(){return"Complex:"+this.real+":"+this.imag}),S(U,"$infinite?",function(){var ie;return ye(ie=this.real["$infinite?"]())?ie:this.imag["$infinite?"]()}),S(U,"$inspect",function(){return"("+this+")"}),S(U,"$numerator",function(){var ie,z=this;return ie=z.$denominator(),T.$Complex(v(z.real.$numerator(),J(ie,z.real.$denominator())),v(z.imag.$numerator(),J(ie,z.imag.$denominator())))}),S(U,"$polar",function(){return[this.$abs(),this.$arg()]}),S(U,"$rationalize",function(z){var ie=this;return arguments.length>1&&T.$raise(Q("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),X(ie.imag,0)&&T.$raise(Q("RangeError"),"can't convert "+ie+" into Rational"),ie.$real().$rationalize(z)},-1),S(U,"$real?",K(!1)),S(U,"$rect",function(){return[this.real,this.imag]}),S(U,"$to_f",function(){var z=this;return j(z.imag,0)||T.$raise(Q("RangeError"),"can't convert "+z+" into Float"),z.real.$to_f()}),S(U,"$to_i",function(){var z=this;return j(z.imag,0)||T.$raise(Q("RangeError"),"can't convert "+z+" into Integer"),z.real.$to_i()}),S(U,"$to_r",function(){var z=this;return j(z.imag,0)||T.$raise(Q("RangeError"),"can't convert "+z+" into Rational"),z.real.$to_r()}),S(U,"$to_s",function(){var z=this,ie=Y;return ie=z.real.$inspect(),ie=L(ie,f(Q("Number"),z.imag)&&ye(z.imag["$nan?"]())||ye(z.imag["$positive?"]())||ye(z.imag["$zero?"]())?"+":"-"),ie=L(ie,z.imag.$abs().$inspect()),f(Q("Number"),z.imag)&&(ye(z.imag["$nan?"]())||ye(z.imag["$infinite?"]()))&&(ie=L(ie,"*")),L(ie,"i")}),P(I[0],"I",U.$new(0,1)),ne(U,"$from_string",function(z){var ge,B,ie=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function _(){return ie.test(z)}function l(){var d=z.match(ie)[0];return z=z.slice(d.length),d.replace(/_/g,"")}function c(){if(_()){var h=parseFloat(l());if("/"===z[0]){if(z=z.slice(1),_()){var d=parseFloat(l());return T.$Rational(h,d)}return z="/"+z,h}return h}return null}return z.match(ie),(ge=c())?(B=c())?T.$Complex(ge,B):"i"===z[0]?T.$Complex(0,ge):T.$Complex(ge,0):T.$Complex(0,"i"===z[0]?1:"-"===z[0]&&"i"===z[1]?-1:"+"===z[0]&&"i"===z[1]?1:0)}),H(E.get_singleton_class(U),"rectangular","rect"),H(U,"arg","angle"),H(U,"conjugate","conj"),H(U,"divide","/"),H(U,"imaginary","imag"),H(U,"magnitude","abs"),H(U,"phase","arg"),H(U,"quo","/"),H(U,"rectangular","rect"),E.udef(U,"$negative?"),E.udef(U,"$positive?"),E.udef(U,"$step"),Y},Opal.modules["corelib/rational/base"]=function(E){var ye=E.def,f=E.klass,ne=E.$$$;return ye((0,E.module)("::","Kernel"),"$Rational",function(D,J){return null==J&&(J=1),ne("Rational").$convert(D,J)},-2),ye(f("::",null,"String"),"$to_r",function(){return ne("Rational").$from_string(this)})},Opal.modules["corelib/rational"]=function(E){var U,I,de=E.klass,ye=E.eqeq,f=E.Kernel,T=E.truthy,ne=E.rb_lt,v=E.rb_divide,S=E.defs,L=E.eqeqeq,D=E.not,J=E.Opal,j=E.def,F=E.return_ivar,Z=E.rb_minus,X=E.rb_times,K=E.rb_plus,P=E.rb_gt,H=E.rb_le,le=E.return_self,q=E.alias,Y=E.top,Q=E.nil,k=E.$$$;return Y.$require("corelib/numeric"),Y.$require("corelib/rational/base"),(I=(U=de("::",k("Numeric"),"Rational")).$$prototype).num=I.den=Q,S(U,"$reduce",function(y,R){var ie;if(y=y.$to_i(),R=R.$to_i(),ye(R,0))f.$raise(k("ZeroDivisionError"),"divided by 0");else if(T(ne(R,0)))y=y["$-@"](),R=R["$-@"]();else if(ye(R,1))return this.$new(y,R);return ie=y.$gcd(R),this.$new(v(y,ie),v(R,ie))}),S(U,"$convert",function(y,R){return(T(y["$nil?"]())||T(R["$nil?"]()))&&f.$raise(k("TypeError"),"cannot convert nil into Rational"),L(k("Integer"),y)&&L(k("Integer"),R)?this.$reduce(y,R):((L(k("Float"),y)||L(k("String"),y)||L(k("Complex"),y))&&(y=y.$to_r()),(L(k("Float"),R)||L(k("String"),R)||L(k("Complex"),R))&&(R=R.$to_r()),T(R["$equal?"](1))&&D(k("Integer")["$==="](y))?J["$coerce_to!"](y,k("Rational"),"to_r"):L(k("Numeric"),y)&&L(k("Numeric"),R)?v(y,R):this.$reduce(y,R))}),j(U,"$initialize",function(y,R){var z=this;return z.num=y,z.den=R,z.$freeze()}),j(U,"$numerator",F("num")),j(U,"$denominator",F("den")),j(U,"$coerce",function(y){var z,R=this;return L(k("Rational"),z=y)?[y,R]:L(k("Integer"),z)?[y.$to_r(),R]:L(k("Float"),z)?[y,R.$to_f()]:Q}),j(U,"$==",function(y){var z,R=this,ie=Q;return L(k("Rational"),z=y)?T(ie=R.num["$=="](y.$numerator()))?R.den["$=="](y.$denominator()):ie:L(k("Integer"),z)?T(ie=R.num["$=="](y))?R.den["$=="](1):ie:L(k("Float"),z)?R.$to_f()["$=="](y):y["$=="](R)}),j(U,"$<=>",function(y){var z,R=this;return L(k("Rational"),z=y)?Z(X(R.num,y.$denominator()),X(R.den,y.$numerator()))["$<=>"](0):L(k("Integer"),z)?Z(R.num,X(R.den,y))["$<=>"](0):L(k("Float"),z)?R.$to_f()["$<=>"](y):R.$__coerced__("<=>",y)}),j(U,"$+",function(y){var z,R=this,ie=Q,M=Q;return L(k("Rational"),z=y)?(ie=K(X(R.num,y.$denominator()),X(R.den,y.$numerator())),M=X(R.den,y.$denominator()),f.$Rational(ie,M)):L(k("Integer"),z)?f.$Rational(K(R.num,X(y,R.den)),R.den):L(k("Float"),z)?K(R.$to_f(),y):R.$__coerced__("+",y)}),j(U,"$-",function(y){var z,R=this,ie=Q,M=Q;return L(k("Rational"),z=y)?(ie=Z(X(R.num,y.$denominator()),X(R.den,y.$numerator())),M=X(R.den,y.$denominator()),f.$Rational(ie,M)):L(k("Integer"),z)?f.$Rational(Z(R.num,X(y,R.den)),R.den):L(k("Float"),z)?Z(R.$to_f(),y):R.$__coerced__("-",y)}),j(U,"$*",function(y){var z,R=this,ie=Q,M=Q;return L(k("Rational"),z=y)?(ie=X(R.num,y.$numerator()),M=X(R.den,y.$denominator()),f.$Rational(ie,M)):L(k("Integer"),z)?f.$Rational(X(R.num,y),R.den):L(k("Float"),z)?X(R.$to_f(),y):R.$__coerced__("*",y)}),j(U,"$/",function(y){var z,R=this,ie=Q,M=Q;return L(k("Rational"),z=y)?(ie=X(R.num,y.$denominator()),M=X(R.den,y.$numerator()),f.$Rational(ie,M)):L(k("Integer"),z)?ye(y,0)?v(R.$to_f(),0):f.$Rational(R.num,X(R.den,y)):L(k("Float"),z)?v(R.$to_f(),y):R.$__coerced__("/",y)}),j(U,"$**",function(y){var z,R=this;return L(k("Integer"),z=y)?ye(R,0)&&T(ne(y,0))?k(k("Float"),"INFINITY"):T(P(y,0))?f.$Rational(R.num["$**"](y),R.den["$**"](y)):T(ne(y,0))?f.$Rational(R.den["$**"](y["$-@"]()),R.num["$**"](y["$-@"]())):f.$Rational(1,1):L(k("Float"),z)?R.$to_f()["$**"](y):L(k("Rational"),z)?ye(y,0)?f.$Rational(1,1):ye(y.$denominator(),1)?T(ne(y,0))?f.$Rational(R.den["$**"](y.$numerator().$abs()),R.num["$**"](y.$numerator().$abs())):f.$Rational(R.num["$**"](y.$numerator()),R.den["$**"](y.$numerator())):ye(R,0)&&T(ne(y,0))?f.$raise(k("ZeroDivisionError"),"divided by 0"):R.$to_f()["$**"](y):R.$__coerced__("**",y)}),j(U,"$abs",function(){return f.$Rational(this.num.$abs(),this.den.$abs())}),j(U,"$ceil",function(y){var R=this;return null==y&&(y=0),ye(y,0)?v(R.num["$-@"](),R.den)["$-@"]().$ceil():R.$with_precision("ceil",y)},-1),j(U,"$floor",function(y){var R=this;return null==y&&(y=0),ye(y,0)?v(R.num["$-@"](),R.den)["$-@"]().$floor():R.$with_precision("floor",y)},-1),j(U,"$hash",function(){return"Rational:"+this.num+":"+this.den}),j(U,"$inspect",function(){return"("+this+")"}),j(U,"$rationalize",function(y){var R=this;if(arguments.length>1&&f.$raise(k("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==y)return R;for(var l,c,h,d,p,z=y.$abs(),ie=Z(R,z),M=K(R,z),ge=0,B=1,O=1,_=0;h=ie.$ceil(),!H(h,M);)l=(d=h-1)*B+ge,c=d*_+O,p=v(1,Z(M,d)),M=v(1,Z(ie,d)),ie=p,ge=B,O=_,B=l,_=c;return f.$Rational(h*B+ge,h*_+O)},-1),j(U,"$round",function(y){var R=this,z=Q,ie=Q,M=Q;return null==y&&(y=0),ye(y,0)?ye(R.num,0)?0:ye(R.den,1)?R.num:(z=K(X(R.num.$abs(),2),R.den),ie=X(R.den,2),M=v(z,ie).$truncate(),T(ne(R.num,0))?M["$-@"]():M):R.$with_precision("round",y)},-1),j(U,"$to_f",function(){return v(this.num,this.den)}),j(U,"$to_i",function(){return this.$truncate()}),j(U,"$to_r",le),j(U,"$to_s",function(){return this.num+"/"+this.den}),j(U,"$truncate",function(y){var R=this;return null==y&&(y=0),ye(y,0)?T(ne(R.num,0))?R.$ceil():R.$floor():R.$with_precision("truncate",y)},-1),j(U,"$with_precision",function(y,R){var ie,M=Q;return L(k("Integer"),R)||f.$raise(k("TypeError"),"not an Integer"),ie=10["$**"](R),M=X(this,ie),T(ne(R,1))?v(M.$send(y),ie).$to_i():f.$Rational(M.$send(y),ie)}),S(U,"$from_string",function(y){var M,ge,R=y.trimLeft(),z=/^[+-]?[\d_]+(\.[\d_]+)?/;function B(){return z.test(R)}function O(){var l=R.match(z)[0];return R=R.slice(l.length),l.replace(/_/g,"")}return R.match(z),B()?(M=parseFloat(O()),"/"===R[0]?(R=R.slice(1),B()?(ge=parseFloat(O()),f.$Rational(M,ge)):f.$Rational(M,1)):f.$Rational(M,1)):f.$Rational(0,1)}),q(U,"divide","/"),q(U,"quo","/")},Opal.modules["corelib/time"]=function(E){var de=E.slice,ye=E.deny_frozen_access,f=E.klass,T=E.Kernel,ne=E.Opal,v=E.defs,S=E.eqeqeq,L=E.def,D=E.truthy,J=E.rb_gt,j=E.rb_lt,F=E.send,Z=E.rb_plus,X=E.rb_divide,K=E.rb_minus,P=E.range,H=E.neqeq,le=E.rb_le,q=E.eqeq,Y=E.alias,N=E.nil,te=E.$$$;return E.top.$require("corelib/comparable"),function(U,I,A){var y=f("::",I,"Time"),R=[y].concat([]),z=E.$r(R);y.$include(te("Comparable"));var _,ie=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B=["January","February","March","April","May","June","July","August","September","October","November","December"];function O(_,l,c,h,d,p){if(_=_.$$is_string?parseInt(_,10):ne["$coerce_to!"](_,te("Integer"),"to_int"),l===N)l=1;else if(!l.$$is_number)if(l["$respond_to?"]("to_str"))switch(l=l.$to_str(),l.toLowerCase()){case"jan":l=1;break;case"feb":l=2;break;case"mar":l=3;break;case"apr":l=4;break;case"may":l=5;break;case"jun":l=6;break;case"jul":l=7;break;case"aug":l=8;break;case"sep":l=9;break;case"oct":l=10;break;case"nov":l=11;break;case"dec":l=12;break;default:l=l.$to_i()}else l=ne["$coerce_to!"](l,te("Integer"),"to_int");return(l<1||l>12)&&T.$raise(te("ArgumentError"),"month out of range: "+l),l-=1,((c=c===N?1:c.$$is_string?parseInt(c,10):ne["$coerce_to!"](c,te("Integer"),"to_int"))<1||c>31)&&T.$raise(te("ArgumentError"),"day out of range: "+c),((h=h===N?0:h.$$is_string?parseInt(h,10):ne["$coerce_to!"](h,te("Integer"),"to_int"))<0||h>24)&&T.$raise(te("ArgumentError"),"hour out of range: "+h),((d=d===N?0:d.$$is_string?parseInt(d,10):ne["$coerce_to!"](d,te("Integer"),"to_int"))<0||d>59)&&T.$raise(te("ArgumentError"),"min out of range: "+d),p===N?p=0:p.$$is_number||(p=p.$$is_string?parseInt(p,10):ne["$coerce_to!"](p,te("Integer"),"to_int")),(p<0||p>60)&&T.$raise(te("ArgumentError"),"sec out of range: "+p),[_,l,c,h,d,p]}return v(y,"$at",function(l,c){var h;return te("Time")["$==="](l)?(void 0!==c&&T.$raise(te("TypeError"),"can't convert Time into an exact number"),(h=new Date(l.getTime())).timezone=l.timezone,h):(l.$$is_number||(l=ne["$coerce_to!"](l,te("Integer"),"to_int")),void 0===c?new Date(1e3*l):(c.$$is_number||(c=ne["$coerce_to!"](c,te("Integer"),"to_int")),new Date(1e3*l+c/1e3)))},-2),v(y,"$new",function(l,c,h,d,p,m,x){var re,se,De,Ae;return null==c&&(c=N),null==h&&(h=N),null==d&&(d=N),null==p&&(p=N),null==m&&(m=N),null==x&&(x=N),void 0===l?new Date:(l=(re=O(l,c,h,d,p,m))[0],c=re[1],h=re[2],d=re[3],p=re[4],m=re[5],x===N?(se=new Date(l,c,h,d,p,0,1e3*m),l<100&&se.setFullYear(l),se):(De=this.$_parse_offset(x),Ae=new Date(Date.UTC(l,c,h,d,p,0,1e3*m)),l<100&&Ae.setUTCFullYear(l),(se=new Date(Ae.getTime()-36e5*De)).timezone=De,se))},-1),v(y,"$_parse_offset",function(l){var c;return l.$$is_string?"UTC"==l?c=0:/^[+-]\d\d:[0-5]\d$/.test(l)?c=("-"==l[0]?-1:1)*(+(l[1]+l[2])+ +(l[4]+l[5])/60):T.$raise(te("ArgumentError"),'"+HH:MM", "-HH:MM", "UTC" expected for utc_offset: '+l):l.$$is_number?c=l/3600:T.$raise(te("ArgumentError"),"Opal doesn't support other types for a timezone argument than Integer and String"),c}),v(y,"$local",function(l,c,h,d,p,m,x,$,re,se){var De,Ae;return null==c&&(c=N),null==h&&(h=N),null==d&&(d=N),null==p&&(p=N),null==m&&(m=N),null==x&&(x=N),null==$&&($=N),null==re&&(re=N),null==se&&(se=N),10===arguments.length&&(l=(De=de(arguments))[5],c=De[4],h=De[3],d=De[2],p=De[1],m=De[0]),l=(De=O(l,c,h,d,p,m))[0],c=De[1],h=De[2],d=De[3],p=De[4],m=De[5],Ae=new Date(l,c,h,d,p,0,1e3*m),l<100&&Ae.setFullYear(l),Ae},-2),v(y,"$gm",function(l,c,h,d,p,m,x,$,re,se){var De,Ae;return null==c&&(c=N),null==h&&(h=N),null==d&&(d=N),null==p&&(p=N),null==m&&(m=N),null==x&&(x=N),null==$&&($=N),null==re&&(re=N),null==se&&(se=N),10===arguments.length&&(l=(De=de(arguments))[5],c=De[4],h=De[3],d=De[2],p=De[1],m=De[0]),l=(De=O(l,c,h,d,p,m))[0],c=De[1],h=De[2],d=De[3],p=De[4],m=De[5],Ae=new Date(Date.UTC(l,c,h,d,p,0,1e3*m)),l<100&&Ae.setUTCFullYear(l),Ae.timezone=0,Ae},-2),v(y,"$now",function(){return this.$new()}),L(y,"$+",function(l){S(te("Time"),l)&&T.$raise(te("TypeError"),"time + time?"),l.$$is_number||(l=ne["$coerce_to!"](l,te("Integer"),"to_int"));var h=new Date(this.getTime()+1e3*l);return h.timezone=this.timezone,h}),L(y,"$-",function(l){var c=this;if(S(te("Time"),l))return(c.getTime()-l.getTime())/1e3;l.$$is_number||(l=ne["$coerce_to!"](l,te("Integer"),"to_int"));var h=new Date(c.getTime()-1e3*l);return h.timezone=c.timezone,h}),L(y,"$<=>",function(l){var h=N;return S(te("Time"),l)?this.$to_f()["$<=>"](l.$to_f()):(h=l["$<=>"](this),D(h["$nil?"]())?N:D(J(h,0))?-1:D(j(h,0))?1:0)}),L(y,"$==",function(l){var h;return D(h=te("Time")["$==="](l))?this.$to_f()===l.$to_f():h}),L(y,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")}),F([["year","getFullYear","getUTCFullYear"],["mon","getMonth","getUTCMonth",1],["wday","getDay","getUTCDay"],["day","getDate","getUTCDate"],["hour","getHours","getUTCHours"],["min","getMinutes","getUTCMinutes"],["sec","getSeconds","getUTCSeconds"]],"each",[],function _(l,c,h,d){var p=null==_.$$s?this:_.$$s;return null==l&&(l=N),null==c&&(c=N),null==h&&(h=N),null==d&&(d=0),F(p,"define_method",[l],function m(){var x=null==m.$$s?this:m.$$s;return d+(null!=x.timezone?new Date(x.getTime()+36e5*x.timezone)[h]():x[c]())},{$$s:p})},{$$arity:-4,$$s:y}),L(y,"$yday",function(){var c,h,l=this;return c=z("Time").$new(l.$year()).$to_i(),h=z("Time").$new(l.$year(),l.$month(),l.$day()).$to_i(),Z(X(K(h,c),86400).$round(),1)}),L(y,"$isdst",function(){var l=this,c=new Date(l.getFullYear(),0,1),h=new Date(l.getFullYear(),6,1);return l.getTimezoneOffset()<Math.max(c.getTimezoneOffset(),h.getTimezoneOffset())}),L(y,"$dup",function(){var l=this,c=N;return(c=new Date(l.getTime())).$copy_instance_variables(l),c.$initialize_dup(l),c}),L(y,"$eql?",function(l){var h;return D(h=l["$is_a?"](te("Time")))?this["$<=>"](l)["$zero?"]():h}),F([["sunday?",0],["monday?",1],["tuesday?",2],["wednesday?",3],["thursday?",4],["friday?",5],["saturday?",6]],"each",[],function _(l,c){var h=null==_.$$s?this:_.$$s;return null==l&&(l=N),null==c&&(c=N),F(h,"define_method",[l],function d(){return(null==d.$$s?this:d.$$s).$wday()===c},{$$s:h})},{$$s:y}),L(y,"$hash",function(){return"Time:"+this.getTime()}),L(y,"$inspect",function(){var l=this;return D(l["$utc?"]())?l.$strftime("%Y-%m-%d %H:%M:%S UTC"):l.$strftime("%Y-%m-%d %H:%M:%S %z")}),L(y,"$succ",function(){var c=new Date(this.getTime()+1e3);return c.timezone=this.timezone,c}),L(y,"$usec",function(){return 1e3*this.getMilliseconds()}),L(y,"$zone",function(){var l=this;if(0===l.timezone)return"UTC";if(null!=l.timezone)return N;var h,c=l.toString();return"GMT"==(h=-1==c.indexOf("(")?c.match(/[A-Z]{3,4}/)[0]:c.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(c)?RegExp.$1:h}),L(y,"$getgm",function(){var c=new Date(this.getTime());return c.timezone=0,c}),L(y,"$gmtime",function(){var l=this;return 0!==l.timezone&&(ye(l),l.timezone=0),l}),L(y,"$gmt?",function(){return 0===this.timezone}),L(y,"$gmt_offset",function(){var l=this;return null!=l.timezone?60*l.timezone:60*-l.getTimezoneOffset()}),L(y,"$strftime",function(l){var c=this;return l.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(h,d,p,m,x){var re,se,De,$="",Ae=-1!==d.indexOf("0"),fe=-1===d.indexOf("-"),Pe=-1!==d.indexOf("_"),be=-1!==d.indexOf("^"),xe=-1!==d.indexOf("#"),pe=(d.match(":")||[]).length;switch(p=parseInt(p,10),Ae&&Pe&&(d.indexOf("0")<d.indexOf("_")?Ae=!1:Pe=!1),x){case"Y":$+=c.$year();break;case"C":Ae=!Pe,$+=Math.round(c.$year()/100);break;case"y":Ae=!Pe,$+=c.$year()%100;break;case"m":Ae=!Pe,$+=c.$mon();break;case"B":$+=B[c.$mon()-1];break;case"b":case"h":Pe=!Ae,$+=ge[c.$mon()-1];break;case"d":Ae=!Pe,$+=c.$day();break;case"e":Pe=!Ae,$+=c.$day();break;case"j":Ae=!Pe,p=isNaN(p)?3:p,$+=c.$yday();break;case"H":Ae=!Pe,$+=c.$hour();break;case"k":Pe=!Ae,$+=c.$hour();break;case"I":Ae=!Pe,$+=c.$hour()%12||12;break;case"l":Pe=!Ae,$+=c.$hour()%12||12;break;case"P":$+=c.$hour()>=12?"pm":"am";break;case"p":$+=c.$hour()>=12?"PM":"AM";break;case"M":Ae=!Pe,$+=c.$min();break;case"S":Ae=!Pe,$+=c.$sec();break;case"L":Ae=!Pe,p=isNaN(p)?3:p,$+=c.getMilliseconds();break;case"N":p=isNaN(p)?9:p,$=($+=c.getMilliseconds().toString().$rjust(3,"0")).$ljust(p,"0");break;case"z":var Me=null==c.timezone?c.getTimezoneOffset():60*-c.timezone,Ce=Math.floor(Math.abs(Me)/60),ae=Math.abs(Me)%60;$+=Me<0?"+":"-",$+=Ce<10?"0":"",$+=Ce,pe>0&&($+=":"),$+=ae<10?"0":"",$+=ae,pe>1&&($+=":00");break;case"Z":$+=c.$zone();break;case"A":$+=ie[c.$wday()];break;case"a":$+=M[c.$wday()];break;case"u":$+=c.$wday()+1;break;case"w":$+=c.$wday();break;case"V":$+=c.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":$+=c.$cweek_cyear()["$[]"](1);break;case"g":$+=c.$cweek_cyear()["$[]"](1)["$[]"](P(-2,-1,!1));break;case"s":$+=c.$to_i();break;case"n":$+="\n";break;case"t":$+="\t";break;case"%":$+="%";break;case"c":$+=c.$strftime("%a %b %e %T %Y");break;case"D":case"x":$+=c.$strftime("%m/%d/%y");break;case"F":$+=c.$strftime("%Y-%m-%d");break;case"v":$+=c.$strftime("%e-%^b-%4Y");break;case"r":$+=c.$strftime("%I:%M:%S %p");break;case"R":$+=c.$strftime("%H:%M");break;case"T":case"X":$+=c.$strftime("%H:%M:%S");break;case"J":if((re=c.$to_date().$jd())<2405160){$+=c.$strftime("%Y-%m-%d");break}re<2419614?(se="M",De=1867):re<2424875?(se="T",De=1911):re<2447535?(se="S",De=1925):re<2458605?(se="H",De=1988):(se="R",De=2018),$+=c.$format("%c%02d",se,K(c.$year(),De)),$+=c.$strftime("-%m-%d");break;default:return h}return be&&($=$.toUpperCase()),xe&&($=$.replace(/[A-Z]/,function(he){he.toLowerCase()}).replace(/[a-z]/,function(he){he.toUpperCase()})),fe&&(Ae||Pe)&&($=$.$rjust(isNaN(p)?2:p,Pe?" ":"0")),$})}),L(y,"$to_a",function(){var l=this;return[l.$sec(),l.$min(),l.$hour(),l.$day(),l.$month(),l.$year(),l.$wday(),l.$yday(),l.$isdst(),l.$zone()]}),L(y,"$to_f",function(){return this.getTime()/1e3}),L(y,"$to_i",function(){return parseInt(this.getTime()/1e3,10)}),L(y,"$cweek_cyear",function(){var h,l=this,p=N,m=N,x=N,re=N;return h=te("Time").$new(l.$year(),1,1).$wday(),p=l.$year(),D(le(h,4))&&H(h,0)?m=K(h,1):(m=K(K(h,7),1),q(m,-8)&&(m=-1)),x=X(Z(l.$yday(),m),7).$ceil(),D(le(x,0))?te("Time").$new(K(l.$year(),1),12,31).$cweek_cyear():(q(x,53)&&(re=te("Time").$new(l.$year(),12,31).$wday(),D(le(re,3))&&H(re,0)&&(x=1,p=Z(p,1))),[x,p])}),_=E.get_singleton_class(y),Y(_,"mktime","local"),Y(_,"utc","gm"),Y(y,"ctime","asctime"),Y(y,"dst?","isdst"),Y(y,"getutc","getgm"),Y(y,"gmtoff","gmt_offset"),Y(y,"mday","day"),Y(y,"month","mon"),Y(y,"to_s","inspect"),Y(y,"tv_sec","to_i"),Y(y,"tv_usec","usec"),Y(y,"utc","gmtime"),Y(y,"utc?","gmt?"),Y(y,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(E){var de=E.klass,ye=E.slice,f=E.extract_kwargs,T=E.ensure_kwargs,ne=E.truthy,v=E.neqeq,S=E.eqeq,L=E.Opal,D=E.send,J=E.Class,j=E.to_a,F=E.def,Z=E.defs,X=E.Kernel,K=E.hash2,P=E.rb_gt,H=E.rb_minus,le=E.eqeqeq,q=E.rb_lt,Y=E.rb_ge,Q=E.rb_plus,k=E.alias,U=E.nil,I=E.$$$;return E.top.$require("corelib/enumerable"),function(A,y,R){var z=de("::",null,"Struct"),ie=[z].concat([]),M=E.$r(ie);z.$include(I("Enumerable")),Z(z,"$new",function B(O,_,l){var h,d,p,m,c=B.$$p||U,x=this,$=U;if(B.$$p=null,h=ye(arguments,1),d=f(h),d=T(d),p=h,null==(m=d.$$smap.keyword_init)&&(m=!1),ne(O))if(S(O.$class(),I("String"))&&v(O["$[]"](0).$upcase(),O["$[]"](0)))p.$unshift(O),O=U;else try{O=L["$const_name!"](O)}catch(re){if(!E.rescue(re,[I("TypeError"),I("NameError")]))throw re;try{p.$unshift(O),O=U}finally{E.pop_exception()}}return D(p,"map",[],function(se){return null==se&&(se=U),L["$coerce_to!"](se,I("String"),"to_str")}),$=D(J,"new",[x],function re(){var De,se=null==re.$$s?this:re.$$s;return D(p,"each",[],function De(Ae){return null==Ae&&(Ae=U),(null==De.$$s?this:De.$$s).$define_struct_attribute(Ae)},{$$s:se}),De=E.get_singleton_class(se),F(De,"$new",function(Pe){var xe,pe=this,Me=U;return xe=ye(arguments),(Me=pe.$allocate()).$$data={},D(Me,"initialize",j(xe)),Me},-1),De.$alias_method("[]","new")},{$$s:x}),ne(c)&&D($,"module_eval",[],c.$to_proc()),$.$$keyword_init=m,ne(O)&&I("Struct").$const_set(O,$),$},-2),Z(z,"$define_struct_attribute",function(O){var _=this;return S(_,I("Struct"))&&X.$raise(I("ArgumentError"),"you cannot define attributes to the Struct class"),_.$members()["$<<"](O),D(_,"define_method",[O],function l(){return(null==l.$$s?this:l.$$s).$$data[O]},{$$s:_}),D(_,"define_method",[O+"="],function l(c){return null==c&&(c=U),(null==l.$$s?this:l.$$s).$$data[O]=c},{$$s:_})}),Z(z,"$members",function(){var _,O=this;return null==O.members&&(O.members=U),S(O,I("Struct"))&&X.$raise(I("ArgumentError"),"the Struct class has no members"),O.members=ne(_=O.members)?_:[]}),Z(z,"$inherited",function(O){var l,_=this;return null==_.members&&(_.members=U),l=_.members,D(O,"instance_eval",[],function c(){return(null==c.$$s?this:c.$$s).members=l},{$$s:_})}),F(z,"$initialize",function(O){var _,l,c=this,h=U,d=U,p=U;return _=ye(arguments),l=_,ne(c.$class().$$keyword_init)?(h=ne(d=l.$last())?d:K([],{}),(ne(P(l.$length(),1))||ne(1===l.length&&!h.$$is_hash))&&X.$raise(I("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),p=H(h.$keys(),c.$class().$members()),ne(p["$any?"]())&&X.$raise(I("ArgumentError"),"unknown keywords: "+p.$join(", ")),D(c.$class().$members(),"each",[],function m(x){var $,re=null==m.$$s?this:m.$$s;return null==x&&(x=U),$=[x,h["$[]"](x)],D(re,"[]=",$),$[$.length-1]},{$$s:c})):(ne(P(l.$length(),c.$class().$members().$length()))&&X.$raise(I("ArgumentError"),"struct size differs"),D(c.$class().$members(),"each_with_index",[],function m(x,$){var re,se=null==m.$$s?this:m.$$s;return null==x&&(x=U),null==$&&($=U),re=[x,l["$[]"]($)],D(se,"[]=",re),re[re.length-1]},{$$s:c}))},-1),F(z,"$initialize_copy",function(O){this.$$data={};var c,h,d,l=Object.keys(O.$$data);for(c=0,h=l.length;c<h;c++)this.$$data[d=l[c]]=O.$$data[d]}),Z(z,"$keyword_init?",function(){return this.$$keyword_init}),F(z,"$members",function(){return this.$class().$members()}),F(z,"$hash",function(){return M("Hash").$new(this.$$data).$hash()}),F(z,"$[]",function(O){var _=this;return le(I("Integer"),O)?(ne(q(O,_.$class().$members().$size()["$-@"]()))&&X.$raise(I("IndexError"),"offset "+O+" too small for struct(size:"+_.$class().$members().$size()+")"),ne(Y(O,_.$class().$members().$size()))&&X.$raise(I("IndexError"),"offset "+O+" too large for struct(size:"+_.$class().$members().$size()+")"),O=_.$class().$members()["$[]"](O)):le(I("String"),O)?_.$$data.hasOwnProperty(O)||X.$raise(I("NameError").$new("no member '"+O+"' in struct",O)):X.$raise(I("TypeError"),"no implicit conversion of "+O.$class()+" into Integer"),O=L["$coerce_to!"](O,I("String"),"to_str"),_.$$data[O]}),F(z,"$[]=",function(O,_){var l=this;return le(I("Integer"),O)?(ne(q(O,l.$class().$members().$size()["$-@"]()))&&X.$raise(I("IndexError"),"offset "+O+" too small for struct(size:"+l.$class().$members().$size()+")"),ne(Y(O,l.$class().$members().$size()))&&X.$raise(I("IndexError"),"offset "+O+" too large for struct(size:"+l.$class().$members().$size()+")"),O=l.$class().$members()["$[]"](O)):le(I("String"),O)?ne(l.$class().$members()["$include?"](O.$to_sym()))||X.$raise(I("NameError").$new("no member '"+O+"' in struct",O)):X.$raise(I("TypeError"),"no implicit conversion of "+O.$class()+" into Integer"),O=L["$coerce_to!"](O,I("String"),"to_str"),l.$$data[O]=_}),F(z,"$==",function(O){if(!ne(O["$instance_of?"](this.$class())))return!1;var l={},c={};return function h(d,p){var m,x,$;for(m in l[d.$__id__()]=!0,c[p.$__id__()]=!0,d.$$data)if(x=d.$$data[m],$=p.$$data[m],I("Struct")["$==="](x)){if(!(l.hasOwnProperty(x.$__id__())&&c.hasOwnProperty($.$__id__())||h(x,$)))return!1}else if(!x["$=="]($))return!1;return!0}(this,O)}),F(z,"$eql?",function(O){if(!ne(O["$instance_of?"](this.$class())))return!1;var l={},c={};return function h(d,p){var m,x,$;for(m in l[d.$__id__()]=!0,c[p.$__id__()]=!0,d.$$data)if(x=d.$$data[m],$=p.$$data[m],I("Struct")["$==="](x)){if(!(l.hasOwnProperty(x.$__id__())&&c.hasOwnProperty($.$__id__())||h(x,$)))return!1}else if(!x["$eql?"]($))return!1;return!0}(this,O)}),F(z,"$each",function B(){var O=B.$$p||U,_=this;return B.$$p=null,O===U?D(_,"enum_for",["each"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:_}):(D(_.$class().$members(),"each",[],function l(c){return null==c&&(c=U),E.yield1(O,(null==l.$$s?this:l.$$s)["$[]"](c))},{$$s:_}),_)}),F(z,"$each_pair",function B(){var O=B.$$p||U,_=this;return B.$$p=null,O===U?D(_,"enum_for",["each_pair"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:_}):(D(_.$class().$members(),"each",[],function l(c){return null==c&&(c=U),E.yield1(O,[c,(null==l.$$s?this:l.$$s)["$[]"](c)])},{$$s:_}),_)}),F(z,"$length",function(){return this.$class().$members().$length()}),F(z,"$to_a",function(){return D(this.$class().$members(),"map",[],function _(l){return null==l&&(l=U),(null==_.$$s?this:_.$$s)["$[]"](l)},{$$s:this})});var ge=[];return F(z,"$inspect",function(){var O=this,_=U,l=U;return function(){try{return _="#<struct ",ne(ge["$include?"](O.$__id__()))?Q(_,":...>"):(ge["$<<"](O.$__id__()),l=!0,le(I("Struct"),O)&&ne(O.$class().$name())&&(_=Q(_,O.$class()+" ")),_=Q(_,D(O.$each_pair(),"map",[],function(h,d){return null==h&&(h=U),null==d&&(d=U),h+"="+M("Opal").$inspect(d)}).$join(", ")),_=Q(_,">"))}finally{ne(l)&&ge.pop()}}()}),F(z,"$to_h",function B(){var O=B.$$p||U,_=this;return B.$$p=null,O!==U?D(D(_,"map",[],O.$to_proc()),"to_h",j(_.$args())):D(_.$class().$members(),"each_with_object",[K([],{})],function l(c,h){var d;return null==c&&(c=U),null==h&&(h=U),d=[c,(null==l.$$s?this:l.$$s)["$[]"](c)],D(h,"[]=",d),d[d.length-1]},{$$s:_})}),F(z,"$values_at",function(O){var _,l,c=this;_=ye(arguments);for(var h=[],d=0,p=(l=D(l=_,"map",[],function(x){return null==x&&(x=U),x.$$is_range?x.$to_a():x}).$flatten()).length;d<p;d++)l[d].$$is_number||X.$raise(I("TypeError"),"no implicit conversion of "+l[d].$class()+" into Integer"),h.push(c["$[]"](l[d]));return h},-1),F(z,"$dig",function(O,_){var c,h=this,d=U;return c=ye(arguments,1),(d=ne(O.$$is_string&&h.$$data.hasOwnProperty(O))&&h.$$data[O]||U)===U||0===c.length?d:(ne(d["$respond_to?"]("dig"))||X.$raise(I("TypeError"),d.$class()+" does not have #dig method"),D(d,"dig",j(c)))},-2),k(z,"size","length"),k(z,"to_s","inspect"),k(z,"values","to_a")}()},Opal.modules["corelib/set"]=function(E){var de=E.freeze,ye=E.klass,f=E.slice,T=E.defs,ne=E.hash2,v=E.truthy,S=E.eqeqeq,L=E.Kernel,D=E.send,J=E.def,j=E.eqeq,F=E.rb_lt,Z=E.rb_le,X=E.alias,P=E.nil,H=E.$$$;return function(le,q,Y){var Q=ye("::",null,"Set"),k=[Q].concat([]),N=E.$r(k);function I(A){v(A["$is_a?"](H("Set")))||L.$raise(H("ArgumentError"),"value must be a set")}return Q.$$prototype.hash=P,Q.$include(H("Enumerable")),T(Q,"$[]",function(y){var R,ie=this;return R=f(arguments),ie.$new(R)},-1),J(Q,"$initialize",function A(y){var R=A.$$p||P,z=this;return A.$$p=null,null==y&&(y=P),z.hash=ne([],{}),v(y["$nil?"]())?P:(S(H("Enumerable"),y)||L.$raise(H("ArgumentError"),"value must be enumerable"),v(R)?D(y,"each",[],function ie(M){return null==M&&(M=P),(null==ie.$$s?this:ie.$$s).$add(E.yield1(R,M))},{$$s:z}):z.$merge(y))},-1),J(Q,"$dup",function(){return this.$class().$new().$merge(this)}),J(Q,"$-",function(y){return v(y["$respond_to?"]("each"))||L.$raise(H("ArgumentError"),"value must be enumerable"),this.$dup().$subtract(y)}),J(Q,"$inspect",function(){return"#<Set: {"+this.$to_a().$join(",")+"}>"}),J(Q,"$==",function(y){var R=this;return!!v(R["$equal?"](y))||(v(y["$instance_of?"](R.$class()))?R.hash["$=="](y.$instance_variable_get("@hash")):!(!v(y["$is_a?"](H("Set")))||!j(R.$size(),y.$size()))&&D(y,"all?",[],function z(ie){var M=null==z.$$s?this:z.$$s;return null==M.hash&&(M.hash=P),null==ie&&(ie=P),M.hash["$include?"](ie)},{$$s:R}))}),J(Q,"$add",function(y){return this.hash["$[]="](y,!0),this}),J(Q,"$classify",function A(){var y=A.$$p||P,R=this,z=P;return A.$$p=null,y===P?R.$enum_for("classify"):(z=D(H("Hash"),"new",[],function ie(M,ge){var B;return null==M&&(M=P),null==ge&&(ge=P),B=[ge,(null==ie.$$s?this:ie.$$s).$class().$new()],D(M,"[]=",B),B[B.length-1]},{$$s:R}),D(R,"each",[],function(M){return null==M&&(M=P),z["$[]"](E.yield1(y,M)).$add(M)}),z)}),J(Q,"$collect!",function A(){var y=A.$$p||P,R=this,z=P;return A.$$p=null,y===P?R.$enum_for("collect!"):(z=R.$class().$new(),D(R,"each",[],function(M){return null==M&&(M=P),z["$<<"](E.yield1(y,M))}),R.$replace(z))}),J(Q,"$compare_by_identity",function(){var y=this;return v(y.hash["$respond_to?"]("compare_by_identity"))?(y.hash.$compare_by_identity(),y):y.$raise(N("NotImplementedError"),y.$class().$name()+"#compare_by_identity is not implemented")}),J(Q,"$compare_by_identity?",function(){var R;return v(R=this.hash["$respond_to?"]("compare_by_identity?"))?this.hash["$compare_by_identity?"]():R}),J(Q,"$delete",function(y){return this.hash.$delete(y),this}),J(Q,"$delete?",function(y){var R=this;return v(R["$include?"](y))?(R.$delete(y),R):P}),J(Q,"$delete_if",function A(){var y=A.$$p||P,R=this;return A.$$p=null,y===P?R.$enum_for("delete_if"):(D(D(R,"select",[],function(ie){return null==ie&&(ie=P),E.yield1(y,ie)}),"each",[],function z(ie){var M=null==z.$$s?this:z.$$s;return null==M.hash&&(M.hash=P),null==ie&&(ie=P),M.hash.$delete(ie)},{$$s:R}),R)}),J(Q,"$freeze",function(){var y=this;return v(y["$frozen?"]())?y:(y.hash.$freeze(),de(y))}),J(Q,"$keep_if",function A(){var y=A.$$p||P,R=this;return A.$$p=null,y===P?R.$enum_for("keep_if"):(D(D(R,"reject",[],function(ie){return null==ie&&(ie=P),E.yield1(y,ie)}),"each",[],function z(ie){var M=null==z.$$s?this:z.$$s;return null==M.hash&&(M.hash=P),null==ie&&(ie=P),M.hash.$delete(ie)},{$$s:R}),R)}),J(Q,"$reject!",function A(){var y=A.$$p||P,R=this,z=P;return A.$$p=null,y===P?R.$enum_for("reject!"):(z=R.$size(),D(R,"delete_if",[],y.$to_proc()),j(R.$size(),z)?P:R)}),J(Q,"$select!",function A(){var y=A.$$p||P,R=this,z=P;return A.$$p=null,y===P?R.$enum_for("select!"):(z=R.$size(),D(R,"keep_if",[],y.$to_proc()),j(R.$size(),z)?P:R)}),J(Q,"$add?",function(y){return v(this["$include?"](y))?P:this.$add(y)}),J(Q,"$each",function A(){var y=A.$$p||P,R=this;return A.$$p=null,y===P?R.$enum_for("each"):(D(R.hash,"each_key",[],y.$to_proc()),R)}),J(Q,"$empty?",function(){return this.hash["$empty?"]()}),J(Q,"$eql?",function(y){return this.hash["$eql?"](D(y,"instance_eval",[],function z(){var ie=null==z.$$s?this:z.$$s;return null==ie.hash&&(ie.hash=P),ie.hash},{$$s:this}))}),J(Q,"$clear",function(){return this.hash.$clear(),this}),J(Q,"$include?",function(y){return this.hash["$include?"](y)}),J(Q,"$merge",function(y){return D(y,"each",[],function z(ie){return null==ie&&(ie=P),(null==z.$$s?this:z.$$s).$add(ie)},{$$s:this}),this}),J(Q,"$replace",function(y){var R=this;return R.$clear(),R.$merge(y),R}),J(Q,"$size",function(){return this.hash.$size()}),J(Q,"$subtract",function(y){return D(y,"each",[],function z(ie){return null==ie&&(ie=P),(null==z.$$s?this:z.$$s).$delete(ie)},{$$s:this}),this}),J(Q,"$|",function(y){return v(y["$respond_to?"]("each"))||L.$raise(H("ArgumentError"),"value must be enumerable"),this.$dup().$merge(y)}),J(Q,"$superset?",function(y){return I(y),!v(F(this.$size(),y.$size()))&&D(y,"all?",[],function z(ie){return null==ie&&(ie=P),(null==z.$$s?this:z.$$s)["$include?"](ie)},{$$s:this})}),J(Q,"$proper_superset?",function(y){return I(y),!v(Z(this.$size(),y.$size()))&&D(y,"all?",[],function z(ie){return null==ie&&(ie=P),(null==z.$$s?this:z.$$s)["$include?"](ie)},{$$s:this})}),J(Q,"$subset?",function(y){return I(y),!v(F(y.$size(),this.$size()))&&D(this,"all?",[],function(ie){return null==ie&&(ie=P),y["$include?"](ie)})}),J(Q,"$proper_subset?",function(y){return I(y),!v(Z(y.$size(),this.$size()))&&D(this,"all?",[],function(ie){return null==ie&&(ie=P),y["$include?"](ie)})}),J(Q,"$intersect?",function(y){var R=this;return I(y),v(F(R.$size(),y.$size()))?D(R,"any?",[],function(ie){return null==ie&&(ie=P),y["$include?"](ie)}):D(y,"any?",[],function z(ie){return null==ie&&(ie=P),(null==z.$$s?this:z.$$s)["$include?"](ie)},{$$s:R})}),J(Q,"$disjoint?",function(y){return this["$intersect?"](y)["$!"]()}),J(Q,"$to_a",function(){return this.hash.$keys()}),X(Q,"+","|"),X(Q,"<","proper_subset?"),X(Q,"<<","add"),X(Q,"<=","subset?"),X(Q,">","proper_superset?"),X(Q,">=","superset?"),X(Q,"difference","-"),X(Q,"filter!","select!"),X(Q,"length","size"),X(Q,"map!","collect!"),X(Q,"member?","include?"),X(Q,"union","|")}()},Opal.modules["corelib/dir"]=function(E){var Z,j,ye=E.def,f=E.truthy,T=E.alias,v=E.nil,S=E.$$$;return[j=(0,E.klass)("::",null,"Dir")].concat([]),Z=E.get_singleton_class(j),ye(Z,"$chdir",function K(P){var H=K.$$p||v,le=v;return K.$$p=null,function(){try{return le=E.current_dir,E.current_dir=P,E.yieldX(H,[])}finally{E.current_dir=le}}()}),ye(Z,"$pwd",function(){return E.current_dir||"."}),ye(Z,"$home",function(){var P;return f(P=S("ENV")["$[]"]("HOME"))?P:"."}),T(Z,"getwd","pwd")},Opal.modules["corelib/file"]=function(E){var Q,k,N,te,de=E.truthy,f=E.const_set,T=E.Opal,ne=E.regexp,v=E.rb_plus,S=E.def,L=E.Kernel,D=E.eqeq,J=E.rb_lt,j=E.rb_minus,F=E.range,Z=E.send,X=E.slice,K=E.alias,H=E.nil,le=E.$$$;return Q=[],N=[k=(0,E.klass)("::",le("IO"),"File")].concat(Q),te=H,f(N[0],"Separator",f(N[0],"SEPARATOR","/")),f(N[0],"ALT_SEPARATOR",H),f(N[0],"PATH_SEPARATOR",":"),f(N[0],"FNM_SYSCASE",0),te=/^[a-zA-Z]:(?:\\|\/)/,function(U,I){var A=[U].concat(I),y=E.$r(A);function R(ie){return de(ie["$respond_to?"]("to_path"))&&(ie=ie.$to_path()),T["$coerce_to!"](ie,le("String"),"to_str")}function z(){return y("ALT_SEPARATOR")===H?E.escape_regexp(y("SEPARATOR")):E.escape_regexp(v(y("SEPARATOR"),y("ALT_SEPARATOR")))}return S(U,"$absolute_path",function(M,ge){var B,O,l,c,h,_=H,d=H,p=H,m=H,x=H;null==ge&&(ge=H),B=y("SEPARATOR"),O=z(),_=[],M=de(M["$respond_to?"]("to_path"))?M.$to_path():M,M=T["$coerce_to!"](M,le("String"),"to_str"),ge=de(l=ge)?l:le("Dir").$pwd(),c=M.substr(0,B.length)===B||te.test(M),h=ge.substr(0,B.length)===B||te.test(ge),de(c)?(d=M.$split(ne(["[",O,"]"])),p=te.test(M)?"":M.$sub(ne(["^([",O,"]+).*$"]),"\\1"),m=!0):(d=v(ge.$split(ne(["[",O,"]"])),M.$split(ne(["[",O,"]"]))),p=te.test(ge)?"":ge.$sub(ne(["^([",O,"]+).*$"]),"\\1"),m=h);for(var $,re=0,se=d.length;re<se;re++)($=d[re])!==H&&(""!==$||0!==_.length&&!m)&&("."!==$||0!==_.length&&!m)&&(".."===$?_.pop():_.push($));return!m&&"."!==d[0]&&_.$unshift("."),x=_.$join(B),de(m)&&(x=v(p,x)),x},-2),S(U,"$expand_path",function(M,ge){var O,_,l=H,c=H,h=H;return null==ge&&(ge=H),O=y("SEPARATOR"),_=z(),de("~"===M[0]||ge&&"~"===ge[0])&&(l=y("Dir").$home(),de(l)||L.$raise(le("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),c=te.test(l)?"":l.$sub(ne(["^([",_,"]+).*$"]),"\\1"),de(l["$start_with?"](c))||L.$raise(le("ArgumentError"),"non-absolute home"),l=v(l,O),h=ne(["^\\~(?:",O,"|$)"]),M=M.$sub(h,l),de(ge)&&(ge=ge.$sub(h,l))),this.$absolute_path(M,ge)},-2),S(U,"$dirname",function(M,ge){var O;if(null==ge&&(ge=1),D(ge,0))return M;de(J(ge,0))&&L.$raise(le("ArgumentError"),"level can't be negative"),O=z();var l,_=(M=R(M)).match(new RegExp("^["+O+"]"));return l=""===(M=(M=(M=M.replace(new RegExp("["+O+"]+$"),"")).replace(new RegExp("[^"+O+"]+$"),"")).replace(new RegExp("["+O+"]+$"),""))?_?"/":".":M,1==ge?l:this.$dirname(l,j(ge,1))},-2),S(U,"$basename",function(M,ge){var B;return null==ge&&(ge=H),B=z(),0==(M=R(M)).length||(ge=ge!==H?T["$coerce_to!"](ge,le("String"),"to_str"):null,M=(M=M.replace(new RegExp("(.)["+B+"]*$"),"$1")).replace(new RegExp("^(?:.*["+B+"])?([^"+B+"]+)$"),"$1"),".*"===ge?M=M.replace(/\.[^\.]+$/,""):null!==ge&&(ge=E.escape_regexp(ge),M=M.replace(new RegExp(ge+"$"),""))),M},-2),S(U,"$extname",function(M){var B=H,O=H;return M=R(M),B=this.$basename(M),de(B["$empty?"]())||(O=B["$[]"](F(1,-1,!1)).$rindex("."),de(O["$nil?"]())||D(v(O,1),j(B.$length(),1)))?"":B["$[]"](E.Range.$new(v(O,1),-1,!1))}),S(U,"$exist?",function(M){return null!=E.modules[M]}),S(U,"$directory?",function(M){var ge=H;for(var B in ge=[],E.modules)ge.push(B);return M=M.$gsub(ne(["(^.",y("SEPARATOR"),"+|",y("SEPARATOR"),"+$)"])),Z(ge,"find",[],function(_){return null==_&&(_=H),_["$=~"](ne(["^",M]))})}),S(U,"$join",function(M){var ge,B,O=H;return ge=X(arguments),de((B=ge)["$empty?"]())?"":(O="",B=Z(B.$flatten().$each_with_index(),"map",[],function(l,c){return null==l&&(l=H),null==c&&(c=H),D(c,0)&&de(l["$empty?"]())||D(B.$length(),v(c,1))&&de(l["$empty?"]())?y("SEPARATOR"):l}),B=Z(B,"reject",[],"empty?".$to_proc()),Z(B,"each_with_index",[],function(l,c){var h=H;return null==l&&(l=H),null==c&&(c=H),h=B["$[]"](v(c,1)),de(h["$nil?"]())?O=""+O+l:(de(l["$end_with?"](y("SEPARATOR")))&&de(h["$start_with?"](y("SEPARATOR")))&&(l=l.$sub(ne([y("SEPARATOR"),"+$"]),"")),O=de(l["$end_with?"](y("SEPARATOR")))||de(h["$start_with?"](y("SEPARATOR")))?""+O+l:""+O+l+y("SEPARATOR"))}),O)},-1),S(U,"$split",function(M){return M.$split(y("SEPARATOR"))}),K(U,"realpath","expand_path"),K(U,"exists?","exist?")}(E.get_singleton_class(k),N)},Opal.modules["corelib/process/base"]=function(E){var L,de=E.klass,ye=E.slice,f=E.defs,T=E.return_val,ne=E.nil;return L=de("::",null,"Signal"),f(L,"$trap",function(J){return ye(arguments),ne},-1),function(v,S){var L=de("::",null,"GC");return f(L,"$start",T(ne))}()},Opal.modules["corelib/process"]=function(E){var de=E.module,ye=E.defs,f=E.truthy,T=E.return_val,ne=E.Kernel,v=E.nil,S=E.$$$;return function(L){var D=de("::","Process"),J=v;if(D.__clocks__=[],ye(D,"$__register_clock__",function(Z,X){var K=this;return null==K.__clocks__&&(K.__clocks__=v),K.$const_set(Z,K.__clocks__.$size()),K.__clocks__["$<<"](X)}),D.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),J=!1,E.global.performance)J=function(){return performance.now()};else if(E.global.process&&process.hrtime){var j=process.hrtime();J=function(){var F=process.hrtime(j);return 1e3*F[0]+(F[1]/1e3|0)/1e3}}return f(J)&&D.$__register_clock__("CLOCK_MONOTONIC",J),ye(D,"$pid",T(0)),ye(D,"$times",function(){var Z;return Z=S("Time").$now().$to_f(),S(S("Benchmark"),"Tms").$new(Z,Z,Z,Z,Z)}),ye(D,"$clock_gettime",function(Z,X){var K=this,H=v;null==K.__clocks__&&(K.__clocks__=v),null==X&&(X="float_second"),f(H=K.__clocks__["$[]"](Z))||ne.$raise(S(S("Errno"),"EINVAL"),"clock_gettime("+Z+") "+K.__clocks__["$[]"](Z));var le=H();switch(X){case"float_second":return le/1e3;case"float_millisecond":return le/1;case"float_microsecond":return 1e3*le;case"second":return le/1e3|0;case"millisecond":return le/1|0;case"microsecond":return 1e3*le|0;case"nanosecond":return 1e6*le|0;default:ne.$raise(S("ArgumentError"),"unexpected unit: "+X)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(E){var X,le,q,Y,Q,K,ye=E.module,f=E.def,T=E.range,ne=E.send,v=E.rb_divide,S=E.Kernel,L=E.Opal,J=E.nil,j=E.$$$;return X=[],le=[K=(0,E.klass)("::",null,"Random")].concat(X),Y=[q=ye(K,"Formatter")].concat(le),Q=E.$r(Y),f(q,"$hex",function(N){null==N&&(N=J),N=j("Random").$_verify_count(N);for(var U=this.$bytes(N),I="",A=0;A<N;A++)I+=U.charCodeAt(A).toString(16).padStart(2,"0");return I.$encode("US-ASCII")},-1),f(q,"$random_bytes",function(N){return null==N&&(N=J),this.$bytes(N)},-1),f(q,"$base64",function(N){return null==N&&(N=J),j("Base64").$strict_encode64(this.$random_bytes(N)).$encode("US-ASCII")},-1),f(q,"$urlsafe_base64",function(N,te){return null==N&&(N=J),null==te&&(te=!1),j("Base64").$urlsafe_encode64(this.$random_bytes(N),te).$encode("US-ASCII")},-1),f(q,"$uuid",function(){var te=J;return(te=this.$hex(16).$split(""))["$[]="](12,"4"),te["$[]="](16,(3&parseInt(te["$[]"](16),16)|8).toString(16)),te=[te["$[]"](T(0,8,!0)),te["$[]"](T(8,12,!0)),te["$[]"](T(12,16,!0)),te["$[]"](T(16,20,!0)),te["$[]"](T(20,32,!0))],(te=ne(te,"map",[],"join".$to_proc())).$join("-")}),f(q,"$random_float",function(){var te=J,U=J;return te=this.$bytes(4),U=0,ne(4,"times",[],function(A){return null==A&&(A=J),U=(U=U["$<<"](8))["$|"](te["$[]"](A).$ord())}),v(U.$abs(),2147483647)}),f(q,"$random_number",function(N){var te=this;function U(){return te.$random_float()}function I(y){return Math.floor(U()*y)}return null==N?U():N.$$is_range?function A(){var y=N.begin,R=N.end;if(y===J||R===J)return J;var z=R-y;return z<0?J:0===z?y:(R%1==0&&y%1==0&&!N.excl&&z++,I(z)+y)}():N.$$is_number?(N<=0&&S.$raise(j("ArgumentError"),"invalid argument - "+N),N%1==0?I(N):U()*N):((N=L["$coerce_to!"](N,j("Integer"),"to_int"))<=0&&S.$raise(j("ArgumentError"),"invalid argument - "+N),I(N))},-1),f(q,"$alphanumeric",function(N){var U=J;return null==N&&(N=J),N=Q("Random").$_verify_count(N),U=ne([T("0","9",!1),T("a","z",!1),T("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),ne(j("Array"),"new",[N],function I(A){return null==A&&(A=J),U["$[]"]((null==I.$$s?this:I.$$s).$random_number(U.$length()))},{$$s:this}).$join()},-1),K.$include(j(j("Random"),"Formatter")),K.$extend(j(j("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(E){var J,D,j,de=E.klass,ye=E.const_set,f=E.send,ne=E.$$$,v=E.nil;return v=function(){var S=624,L=397,Z=function(Y,Q){return function(Y,Q){return 2147483648&Y|2147483647&Q}(Y,Q)>>>1^(1&Q?2567483615:0)};function H(Y){var Q;return--Y.left<=0&&function P(Y){var N,Q=0,k=Y.state;for(Y.left=S,Y.next=0,N=228;--N;Q++)k[Q]=k[Q+L]^Z(k[Q+0],k[Q+1]);for(N=L;--N;Q++)k[Q]=k[Q+(L-S)]^Z(k[Q+0],k[Q+1]);k[Q]=k[Q+(L-S)]^Z(k[Q+0],k[0])}(Y),Q=Y.state[Y.next++],Q^=Q>>>11,Q^=Q<<7&2636928640,Q^=Q<<15&4022730752,(Q^=Q>>>18)>>>0}return{genrand_real:function q(Y){return function le(Y,Q){return(67108864*(Y>>>=5)+(Q>>>=6))*(1/9007199254740992)}(H(Y),H(Y))},init:function X(Y){var Q={left:0,next:S,state:new Array(S)};return function K(Y,Q){var k;for(Y.state[0]=Q>>>0,k=1;k<S;k++)Y.state[k]=1812433253*(Y.state[k-1]^Y.state[k-1]>>30>>>0)+k,Y.state[k]&=4294967295;Y.left=1,Y.next=S}(Q,Y),Q}}}(),D=de("::",null,"Random"),j=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,ye(D,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*j)},reseed:function(F){return v.init(F)},rand:function(F){return v.genrand_real(F)}}),f(D,"generator=",J=[ne(D,"MERSENNE_TWISTER_GENERATOR")]),J[J.length-1]},Opal.modules["corelib/random"]=function(E){var X,de=E.truthy,ye=E.klass,f=E.Kernel,T=E.defs,ne=E.Opal,v=E.def,S=E.eqeqeq,L=E.send,D=E.top,J=E.nil,j=E.$$$;return D.$require("corelib/random/formatter"),(X=ye("::",null,"Random")).$attr_reader("seed","state"),T(X,"$_verify_count",function(P){return de(P)||(P=16),"number"!=typeof P&&(P=P.$to_int()),P<0&&f.$raise(j("ArgumentError"),"negative string size (or size too big)"),Math.floor(P)}),v(X,"$initialize",function(P){return null==P&&(P=j("Random").$new_seed()),P=ne["$coerce_to!"](P,j("Integer"),"to_int"),this.state=P,this.$reseed(P)},-1),v(X,"$reseed",function(P){return this.seed=P,this.$rng=E.$$rand.reseed(P)}),T(X,"$new_seed",function(){return E.$$rand.new_seed()}),T(X,"$rand",function(P){return j(this,"DEFAULT").$rand(P)},-1),T(X,"$srand",function(P){var le;return null==P&&(P=j("Random").$new_seed()),P=ne["$coerce_to!"](P,j("Integer"),"to_int"),le=j(this,"DEFAULT").$seed(),j(this,"DEFAULT").$reseed(P),le},-1),T(X,"$urandom",function(P){return j("SecureRandom").$bytes(P)}),v(X,"$==",function(P){var le=J;return!!S(j("Random"),P)&&(de(le=this.$seed()["$=="](P.$seed()))?this.$state()["$=="](P.$state()):le)}),v(X,"$bytes",function(P){return P=j("Random").$_verify_count(P),L(j("Array"),"new",[P],function le(){return(null==le.$$s?this:le.$$s).$rand(255).$chr()},{$$s:this}).$join().$encode("ASCII-8BIT")}),T(X,"$bytes",function(P){return j(this,"DEFAULT").$bytes(P)}),v(X,"$rand",function(P){return this.$random_number(P)},-1),v(X,"$random_float",function(){return this.state++,E.$$rand.rand(this.$rng)}),T(X,"$random_float",function(){return j(this,"DEFAULT").$random_float()}),T(X,"$generator=",function(P){var H=this;return E.$$rand=P,de(H["$const_defined?"]("DEFAULT"))?j(H,"DEFAULT").$reseed():H.$const_set("DEFAULT",H.$new(H.$new_seed()))}),D.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(E){var le,q,Y,de=E.Kernel,ye=E.klass,f=E.send,T=E.slice,ne=E.module,v=E.def,S=E.return_val,L=E.alias,D=E.defs,J=E.top,F=E.nil,Z=E.$$$,X={};function K(H){switch(E.config.unsupported_features_severity){case"error":de.$raise(Z("NotImplementedError"),H);break;case"warning":!function P(H){X[H]||(X[H]=!0,J.$warn(H))}(H)}}return q=ye("::",null,"String"),Y="String#%s not supported. Mutable String methods are not supported in Opal.",f(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function Q(k){return null==k&&(k=F),f(null==Q.$$s?this:Q.$$s,"define_method",[k],function(U){return T(arguments),de.$raise(Z("NotImplementedError"),Y["$%"](k))},-1)},{$$s:q}),function(H){var le=ne("::","Kernel"),q="Object tainting is not supported by Opal";v(le,"$taint",function(){return K(q),this}),v(le,"$untaint",function(){return K(q),this}),v(le,"$tainted?",function(){return K(q),!1})}(),function(H,le){var q=ye("::",null,"Module");v(q,"$public",function(Q){var N,te=this;return 0===(N=T(arguments)).length?(te.$$module_function=!1,F):1===N.length?N[0]:N},-1),v(q,"$private_class_method",function(Q){var N;return 1===(N=T(arguments)).length?N[0]:N},-1),v(q,"$private_method_defined?",S(!1)),v(q,"$private_constant",function(Q){return T(arguments),F},-1),L(q,"nesting","public"),L(q,"private","public"),L(q,"protected","public"),L(q,"protected_method_defined?","private_method_defined?"),L(q,"public_class_method","private_class_method"),L(q,"public_instance_method","instance_method"),L(q,"public_instance_methods","instance_methods"),L(q,"public_method_defined?","method_defined?")}(),le=ne("::","Kernel"),v(le,"$private_methods",function(Y){return T(arguments),[]},-1),L(le,"protected_methods","private_methods"),L(le,"private_instance_methods","private_methods"),L(le,"protected_instance_methods","private_methods"),function(H,le){var q=ne("::","Kernel"),Y=[q].concat([]),Q=E.$r(Y);v(q,"$eval",function(N){return T(arguments),de.$raise(Z("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+Q("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),D(J,"$public",function(le){var Y;return 1===(Y=T(arguments)).length?Y[0]:Y},-1),D(J,"$private",function(le){var Y;return 1===(Y=T(arguments)).length?Y[0]:Y},-1)},Opal.modules["corelib/binding"]=function(E){var q,Y,ye=E.truthy,f=E.def,T=E.slice,ne=E.send,v=E.to_a,S=E.Kernel,L=E.return_ivar,D=E.eqeq,J=E.thrower,j=E.module,F=E.const_set,Z=E.top,K=E.nil,P=E.$$$;return(Y=(q=(0,E.klass)("::",null,"Binding")).$$prototype).jseval=Y.scope_variables=K,f(q,"$initialize",function(k,N,te,U){var I,A=this;return null==N&&(N=[]),null==U&&(U=K),A.jseval=(I=[k,N,te,U])[0],A.scope_variables=I[1],A.receiver=I[2],A.source_location=I[3],ye(void 0!==typeof te)?K:te=A.$js_eval("self")},-2),f(q,"$js_eval",function(k){var te,U=this;return te=T(arguments),ye(U.jseval)?ne(U.jseval,"call",v(te)):S.$raise("Evaluation on a Proc#binding is not supported")},-1),f(q,"$local_variable_get",function(k){try{return this.$js_eval(k)}catch(te){if(!E.rescue(te,[P("Exception")]))throw te;try{return S.$raise(P("NameError"),"local variable `"+k+"' is not defined for "+this.$inspect())}finally{E.pop_exception()}}}),f(q,"$local_variable_set",function(k,N){return E.Binding.tmp_value=N,this.$js_eval(k+" = Opal.Binding.tmp_value"),delete E.Binding.tmp_value,N}),f(q,"$local_variables",L("scope_variables")),f(q,"$local_variable_defined?",function(k){return this.scope_variables["$include?"](k)}),f(q,"$eval",function(k,N,te){try{return J("eval_return"),null==N&&(N=K),null==te&&(te=K),D(k,"self")?this.$receiver():S.$eval(k,this,N,te)}catch(A){if(A===E.t_eval_return)return A.$v;throw A}},-2),q.$attr_reader("receiver","source_location"),f(j("::","Kernel"),"$binding",function(){return S.$raise("Opal doesn't support dynamic calls to binding")}),F([][0],"TOPLEVEL_BINDING",P("Binding").$new(function(H){return new Function("self","return "+H)(Z)},[],Z,["<main>",0]))},Opal.modules["corelib/irb"]=function(E){var Q,U,ie,M,I,A,y,N,de=E.module,ye=E.truthy,f=E.Kernel,T=E.defs,ne=E.hash,v=E.gvars,S=E.lambda,L=E.send,D=E.rb_plus,J=E.const_set,j=E.klass,F=E.def,Z=E.Opal,X=E.range,K=E.eqeq,P=E.thrower,H=[],le=E.nil,q=E.$$$;Q=H,U=N=[de(H[0],"Opal")].concat(Q),A=[I=de(N[0],"IRB")].concat(U),y=E.$r(A),T(I,"$ensure_loaded",function(z){var M,ge;if(ye(E.loaded_features["$include?"](z)))return le;if(M="https://cdn.opalrb.com/opal/"+(ye(y("RUBY_ENGINE_VERSION")["$include?"]("dev"))?"master":y("RUBY_ENGINE_VERSION"))+"/"+z+".js","undefined"!=typeof XMLHttpRequest){var B=new XMLHttpRequest;B.open("GET",M,!1),B.send(""),ge=B.responseText}else f.$raise("You need to provision "+z+" yourself in this environment");return new Function("Opal",ge)(E),E.require(z),ye(E.loaded_features["$include?"](z))?le:f.$raise("Could not load "+z+" for some reason")}),I.$singleton_class().$attr_accessor("output"),T(I,"$prepare_console",function R(){var z=R.$$p||le,M=this,ge=le,B=le;return null==v.stdout&&(v.stdout=le),null==v.stderr&&(v.stderr=le),null==v.stdin&&(v.stdin=le),R.$$p=null,function(){try{return M["$output="](""),ge=ne(v.stdout,S(function(_){return null==_&&(_=le),v.stdout=_}),v.stderr,S(function(_){return null==_&&(_=le),v.stderr=_})),ye(M["$browser?"]())&&(L(ge,"each",[],function O(_,l){var c=null==O.$$s?this:O.$$s,h=le;return null==_&&(_=le),null==l&&(l=le),(h=_.$dup())["$write_proc="](L(c,"proc",[],function d(p){var m=null==d.$$s?this:d.$$s;return null==p&&(p=le),m["$output="](D(m.$output(),p)),m["$output="](m.$output().$split("\n").$last(30).$join("\n")),ye(p["$end_with?"]("\n"))&&m["$output="](D(m.$output(),"\n")),_.$write_proc().$call(p)},{$$s:c})),h["$tty="](!1),l.$call(h)},{$$s:M}),B=v.stdin.$read_proc(),v.stdin["$read_proc="](function(O){var _=prompt(M.$output());return null!==_?_+"\n":le})),E.yieldX(z,[])}finally{L(ge,"each",[],function(_,l){return null==_&&(_=le),null==l&&(l=le),l.$call(_)}),L(v.stdin,"read_proc=",[B]),L(M,"output=",[""])}}()}),T(I,"$browser?",function(){return"undefined"!=typeof document&&"undefined"!=typeof prompt}),J(A[0],"LINEBREAKS",["unexpected token $end","unterminated string meets end of file"].$freeze()),(M=(ie=j(A[0],null,"Silencer")).$$prototype).collector=M.stderr=le,F(ie,"$initialize",function(){return null==v.stderr&&(v.stderr=le),this.stderr=v.stderr}),F(ie,"$silence",function ge(){var B=ge.$$p||le,O=this;return ge.$$p=null,function(){try{return O.collector=q("StringIO").$new(),v.stderr=O.collector,E.yieldX(B,[])}finally{v.stderr=O.stderr}}()}),F(ie,"$warnings",function(){return this.collector.$string()}),function(Y,Q,k){var N=j("::",null,"Binding"),te=[N].concat(k),U=E.$r(te);F(N,"$irb",function(){try{var A=P("return"),R=le;return q(Z,"IRB").$ensure_loaded("opal-replutils"),R=q(q(Z,"IRB"),"Silencer").$new(),L(q(Z,"IRB"),"prepare_console",[],function z(){var ie=null==z.$$s?this:z.$$s;return function(){try{var M=P("break");return L(ie,"loop",[],function ge(){var B=null==ge.$$s?this:ge.$$s,O=le,_=le,l=le,c=le,h=le;for(B.$print(">> "),O=B.$gets(),ye(O)||M.$throw(),_="",ye(q(Z,"IRB")["$browser?"]())&&B.$puts(O),ye(O["$start_with?"]("ls "))?(_=O["$[]"](X(3,-1,!1)),l="ls"):K(O,"ls\n")?(_="self",l="ls"):ye(O["$start_with?"]("show "))?(_=O["$[]"](X(5,-1,!1)),l="show"):(_=O,l="inspect"),c=le;;){try{L(R,"silence",[],function(){return c=E.compile(_,{irb:!0})})}catch(d){if(!E.rescue(d,[U("SyntaxError")]))throw d;h=d;try{if(ye(q(q(Z,"IRB"),"LINEBREAKS")["$include?"](h.$message()))){B.$print(".. "),O=B.$gets(),ye(O)||A.$throw(),ye(q(Z,"IRB")["$browser?"]())&&B.$puts(O),_=D(_,O);continue}ye(R.$warnings()["$empty?"]())?B.$warn(h.$full_message()):B.$warn(R.$warnings())}finally{E.pop_exception()}}break}return K(l,"show")&&(B.$puts(c),A.$throw()),B.$puts(q("REPLUtils").$eval_and_print(c,l,!1,B))},{$$s:ie,$$ret:A})}catch(ge){if(ge===M)return ge.$v;throw ge}}()},{$$s:this})}catch(z){if(z===A)return z.$v;throw z}})}(0,0,H),E.irb=function(Y){q("Binding").$new(Y).$irb()},E.load_parser=function(){E.Opal.IRB.$ensure_loaded("opal-parser")},void 0===E.eval&&(E.eval=function(Y){return E.load_parser(),E.eval(Y)}),void 0===E.compile&&(E.compile=function(Y,Q){return E.load_parser(),E.compile(Y,Q)})},Opal.queue(function(E){var de=E.Object;return de.$require("opal/base"),de.$require("opal/mini"),de.$require("corelib/kernel/format"),de.$require("corelib/string/encoding"),de.$autoload("Math","corelib/math"),de.$require("corelib/complex/base"),de.$autoload("Complex","corelib/complex"),de.$require("corelib/rational/base"),de.$autoload("Rational","corelib/rational"),de.$require("corelib/time"),de.$autoload("Struct","corelib/struct"),de.$autoload("Set","corelib/set"),de.$autoload("Dir","corelib/dir"),de.$autoload("File","corelib/file"),de.$require("corelib/process/base"),de.$autoload("Process","corelib/process"),de.$autoload("Random","corelib/random"),de.$require("corelib/unsupported"),de.$require("corelib/binding"),de.$require("corelib/irb")}),Opal.queue(function(E){var z,O,_,l,c,ie,M,ge,de=E.module,ye=E.defs,f=E.slice,T=E.truthy,ne=E.send,v=E.Kernel,S=E.extract_kwargs,L=E.ensure_kwargs,D=E.range,J=E.to_a,j=E.def,F=E.return_ivar,Z=E.alias,X=E.klass,K=E.rb_minus,P=E.return_val,H=E.hash2,le=E.send2,q=E.find_super,Y=E.eqeqeq,Q=E.rb_ge,k=E.return_self,N=E.gvars,te=E.top,U=[],I=E.$r(U),A=E.nil,y=E.$$$;return z=U,M=[ie=de(U[0],"Native")].concat(z),ge=E.$r(M),ye(ie,"$is_a?",function(O,_){try{return O instanceof this.$try_convert(_)}catch(c){return!1}}),ye(ie,"$try_convert",function(O,_){return null==_&&(_=A),this["$native?"](O)?O:O["$respond_to?"]("to_n")?O.$to_n():_},-2),ye(ie,"$convert",function(O){return this["$native?"](O)?O:O["$respond_to?"]("to_n")?O.$to_n():void this.$raise(ge("ArgumentError"),O.$inspect()+" isn't native")}),ye(ie,"$call",function B(O,_,l){var d,c=B.$$p||A,p=this;B.$$p=null,d=f(arguments,2);var m=O[_];if(m instanceof Function){for(var x=new Array(d.length),$=0,re=d.length;$<re;$++){var se=d[$],De=p.$try_convert(se);x[$]=De===A?se:De}return c!==A&&x.push(c),p.$Native(m.apply(O,x))}return p.$Native(m)},-3),ye(ie,"$proc",function B(){var O=B.$$p||A;return B.$$p=null,T(O)||this.$raise(ge("LocalJumpError"),"no block given"),ne(v,"proc",[],function l(c){var h,d,p=null==l.$$s?this:l.$$s,m=A;if(h=f(arguments),ne(d=h,"map!",[],function $(re){return null==re&&(re=A),(null==$.$$s?this:$.$$s).$Native(re)},{$$s:p}),m=p.$Native(this),this===E.global)return O.apply(p,d);var x=O.$$s;O.$$s=null;try{return O.apply(m,d)}finally{O.$$s=x}},{$$arity:-1,$$s:this})}),O=M,l=[_=de(M[0],"Helpers")].concat(O),c=E.$r(l),j(_,"$alias_native",function h(d,p,m){var x,$,re,se,Ae=this;return h.$$p=null,x=f(arguments,1),$=S(x),$=L($),x.length>0&&(re=x.shift()),null==re&&(re=d),null==(se=$.$$smap.as)&&(se=A),T(re["$end_with?"]("="))?ne(Ae,"define_method",[d],function fe(Pe){var be=null==fe.$$s?this:fe.$$s;return null==be.native&&(be.native=A),null==Pe&&(Pe=A),be.native[re["$[]"](D(0,-2,!1))]=c("Native").$convert(Pe),Pe},{$$s:Ae}):T(se)?ne(Ae,"define_method",[d],function fe(Pe){var pe,be=fe.$$p||A,Me=null==fe.$$s?this:fe.$$s,Ce=A;return null==Me.native&&(Me.native=A),fe.$$p=null,pe=f(arguments),Ce=ne(c("Native"),"call",[Me.native,re].concat(J(pe)),be.$to_proc()),T(Ce)?se.$new(Ce.$to_n()):A},{$$arity:-1,$$s:Ae}):ne(Ae,"define_method",[d],function fe(Pe){var pe,be=fe.$$p||A,Me=null==fe.$$s?this:fe.$$s;return null==Me.native&&(Me.native=A),fe.$$p=null,pe=f(arguments),ne(c("Native"),"call",[Me.native,re].concat(J(pe)),be.$to_proc())},{$$arity:-1,$$s:Ae})},-2),j(_,"$native_reader",function(d){var p,x=this;return p=f(arguments),ne(p,"each",[],function $(re){var se=null==$.$$s?this:$.$$s;return null==re&&(re=A),ne(se,"define_method",[re],function De(){var Ae=null==De.$$s?this:De.$$s;return null==Ae.native&&(Ae.native=A),Ae.$Native(Ae.native[re])},{$$s:se})},{$$s:x})},-1),j(_,"$native_writer",function(d){var p,x=this;return p=f(arguments),ne(p,"each",[],function $(re){var se=null==$.$$s?this:$.$$s;return null==re&&(re=A),ne(se,"define_method",[re+"="],function De(Ae){var fe=null==De.$$s?this:De.$$s;return null==fe.native&&(fe.native=A),null==Ae&&(Ae=A),fe.$Native(fe.native[re]=Ae)},{$$s:se})},{$$s:x})},-1),j(_,"$native_accessor",function(d){var p,m,x=this;return p=f(arguments),ne(x,"native_reader",J(m=p)),ne(x,"native_writer",J(m))},-1),function(B,O){var _=de(B,"Wrapper"),l=[_].concat(O),c=E.$r(l);j(_,"$initialize",function(d){return T(v["$native?"](d))||v.$raise(c("ArgumentError"),d.$inspect()+" isn't native"),this.native=d}),j(_,"$to_n",F("native")),ye(_,"$included",function(d){return d.$extend(c("Helpers"))})}(M[0],M),ye(ie,"$included",function(O){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),O.$include(ge("Wrapper"))}),function(R,z){var ie=de(R,"Kernel"),M=[ie].concat(z),ge=E.$r(M);j(ie,"$native?",function(O){return null==O||!O.$$class}),j(ie,"$Native",function B(O){var l=this;return B.$$p=null,T(null==O)?A:T(l["$native?"](O))?y(ge("Native"),"Object").$new(O):T(O["$is_a?"](ge("Array")))?ne(O,"map",[],function c(h){return null==h&&(h=A),(null==c.$$s?this:c.$$s).$Native(h)},{$$s:l}):T(O["$is_a?"](ge("Proc")))?ne(l,"proc",[],function c(h){var p,d=c.$$p||A,x=null==c.$$s?this:c.$$s;return c.$$p=null,p=f(arguments),x.$Native(ne(O,"call",J(p),d.$to_proc()))},{$$arity:-1,$$s:l}):O}),Z(ie,"_Array","Array"),j(ie,"$Array",function B(O,_){var h,l=B.$$p||A,d=this;return B.$$p=null,h=f(arguments,1),T(d["$native?"](O))?ne(y(ge("Native"),"Array"),"new",[O].concat(J(h)),l.$to_proc()).$to_a():d.$_Array(O)},-2)}(U[0],U),function(R,z){var ie=X(R,z,"Object");ie.$$prototype.native=A,ie.$include(y(y("Native"),"Wrapper")),j(ie,"$==",function(B){return this.native===y("Native").$try_convert(B)}),j(ie,"$has_key?",function(B){return E.hasOwnProperty.call(this.native,B)}),j(ie,"$each",function ge(B){var _,l=ge.$$p||A,c=this;if(ge.$$p=null,_=f(arguments),l!==A){for(var h in c.native)E.yieldX(l,[h,c.native[h]]);return c}return ne(c,"method_missing",["each"].concat(J(_)))},-1),j(ie,"$[]",function(B){var _=this.native[B];return _ instanceof Function?_:y("Native").$call(this.native,B)}),j(ie,"$[]=",function(B,O){var l;return l=y("Native").$try_convert(O),this.native[B]=T(l===A)?O:l}),j(ie,"$merge!",function(B){for(var _ in B=y("Native").$convert(B))this.native[_]=B[_];return this}),j(ie,"$respond_to?",function(B,O){return null==O&&(O=!1),v.$instance_method("respond_to?").$bind(this).$call(B,O)},-2),j(ie,"$respond_to_missing?",function(B,O){return null==O&&(O=!1),E.hasOwnProperty.call(this.native,B)},-2),j(ie,"$method_missing",function ge(B,O){var c,h,_=ge.$$p||A,d=this;return ge.$$p=null,c=f(arguments,1),"="===B.charAt(B.length-1)?(h=[B.$slice(0,K(B.$length(),1)),c["$[]"](0)],ne(d,"[]=",h),h[h.length-1]):ne(y("Native"),"call",[d.native,B].concat(J(c)),_.$to_proc())},-2),j(ie,"$nil?",P(!1)),j(ie,"$is_a?",function(B){return E.is_a(this,B)}),j(ie,"$instance_of?",function(B){return this.$$class===B}),j(ie,"$class",function(){return this.$$class}),j(ie,"$to_a",function ge(B){var O=ge.$$p||A;return ge.$$p=null,null==B&&(B=H([],{})),ne(y(y("Native"),"Array"),"new",[this.native,B],O.$to_proc()).$to_a()},-1),j(ie,"$inspect",function(){return"#<Native:"+String(this.native)+">"}),Z(ie,"include?","has_key?"),Z(ie,"key?","has_key?"),Z(ie,"kind_of?","is_a?"),Z(ie,"member?","has_key?")}(I("Native"),I("BasicObject")),function(R,z,ie){var M=X(R,null,"Array"),ge=[M].concat(ie),B=E.$r(ge),O=M.$$prototype;O.named=O.native=O.get=O.block=O.set=O.length=A,M.$include(y(B("Native"),"Wrapper")),M.$include(B("Enumerable")),j(M,"$initialize",function _(l,c){var h=_.$$p||A,d=this,p=A;return _.$$p=null,null==c&&(c=H([],{})),le(d,q(d,"initialize",_,!1,!0),"initialize",[l],null),d.get=T(p=c["$[]"]("get"))?p:c["$[]"]("access"),d.named=c["$[]"]("named"),d.set=T(p=c["$[]"]("set"))?p:c["$[]"]("access"),d.length=T(p=c["$[]"]("length"))?p:"length",d.block=h,T(null==d.$length())?d.$raise(B("ArgumentError"),"no length found on the array-like object"):A},-2),j(M,"$each",function _(){var l=_.$$p||A,c=this;if(_.$$p=null,!T(l))return c.$enum_for("each");for(var h=0,d=c.$length();h<d;h++)E.yield1(l,c["$[]"](h));return c}),j(M,"$[]",function(l){var h,d,c=this;return h=Y(B("String"),d=l)||Y(B("Symbol"),d)?T(c.named)?c.native[c.named](l):c.native[l]:Y(B("Integer"),d)?T(c.get)?c.native[c.get](l):c.native[l]:A,T(h)?T(c.block)?c.block.$call(h):c.$Native(h):A}),j(M,"$[]=",function(l,c){var h=this;return T(h.set)?h.native[h.set](l,B("Native").$convert(c)):h.native[l]=B("Native").$convert(c)}),j(M,"$last",function(l){var c=this,h=A,d=A;if(null==l&&(l=A),T(l)){for(h=K(c.$length(),1),d=[];T(Q(h,0));)d["$<<"](c["$[]"](h)),h=K(h,1);return d}return c["$[]"](K(c.$length(),1))},-1),j(M,"$length",function(){return this.native[this.length]}),j(M,"$inspect",function(){return this.$to_a().$inspect()}),Z(M,"to_ary","to_a")}(I("Native"),0,U),function(R,z){var ie=X(R,null,"Numeric");j(ie,"$to_n",function(){return this.valueOf()})}(U[0]),function(R,z){var ie=X(R,null,"Proc");j(ie,"$to_n",k)}(U[0]),function(R,z){var ie=X(R,null,"String");j(ie,"$to_n",function(){return this.valueOf()})}(U[0]),function(R,z){var ie=X(R,null,"Regexp");j(ie,"$to_n",function(){return this.valueOf()})}(U[0]),function(R,z){var ie=X(R,null,"MatchData");j(ie,"$to_n",F("matches"))}(U[0]),function(R,z,ie){var M=X(R,null,"Struct"),ge=[M].concat(ie),B=E.$r(ge);j(M,"$to_n",function(){var l=A;return l={},ne(this,"each_pair",[],function(h,d){return null==h&&(h=A),null==d&&(d=A),l[h]=B("Native").$try_convert(d,d)}),l})}(U[0],0,U),function(R,z,ie){var M=X(R,null,"Array"),ge=[M].concat(ie),B=E.$r(ge);j(M,"$to_n",function(){for(var l=[],c=0,h=this.length;c<h;c++){var d=this[c];l.push(B("Native").$try_convert(d,d))}return l})}(U[0],0,U),function(R,z){var ie=X(R,null,"Boolean");j(ie,"$to_n",function(){return this.valueOf()})}(U[0]),function(R,z){var ie=X(R,null,"Time");j(ie,"$to_n",k)}(U[0]),function(R,z){var ie=X(R,null,"NilClass");j(ie,"$to_n",function(){return null})}(U[0]),T(I("Hash")["$method_defined?"]("_initialize"))||function(R,z,ie){var M=X(R,null,"Hash"),ge=[M].concat(ie),B=E.$r(ge);Z(M,"_initialize","initialize"),j(M,"$initialize",function O(_){var l=O.$$p||A,c=this;if(O.$$p=null,null!=_&&(void 0===_.constructor||_.constructor===Object)){var p,m,h=c.$$smap,d=c.$$keys;for(p in _)!(m=_[p])||void 0!==m.constructor&&m.constructor!==Object?m&&m.$$is_array?(m=m.map(function(x){return!x||void 0!==x.constructor&&x.constructor!==Object?c.$Native(x):B("Hash").$new(x)}),h[p]=m):h[p]=c.$Native(m):h[p]=B("Hash").$new(m),d.push(p);return c}return ne(c,"_initialize",[_],l.$to_proc())},-1),j(M,"$to_n",function(){for(var d,p,l={},c=this.$$keys,h=this.$$smap,m=0,x=c.length;m<x;m++)p=(d=c[m]).$$is_string?h[d]:(d=d.key).value,l[d]=B("Native").$try_convert(p,p);return l})}(U[0],0,U),function(R,z){var ie=X(R,null,"Module");j(ie,"$native_module",function(){return E.global[this.$name()]=this})}(U[0]),function(R,z,ie){var M=X(R,null,"Class"),ge=[M].concat(ie),B=E.$r(ge);j(M,"$native_alias",function(_,l){var c=this,h=c.prototype[E.jsid(l)];h||c.$raise(B("NameError").$new("undefined method `"+l+"' for class `"+c.$inspect()+"'",l)),c.prototype[_]=h}),j(M,"$native_class",function(){var _=this;return _.$native_module(),_.new=_.$new})}(U[0],0,U),N.$=N.global=te.$Native(E.global)}),Opal.modules.strscan=function(E){var Z,X,K,P,H,ye=E.def,f=E.truthy,T=E.eqeqeq,ne=E.Opal,v=E.return_ivar,S=E.send,L=E.alias,D=[],J=E.nil;return Z=D,K=[X=(0,E.klass)(D[0],null,"StringScanner")].concat(Z),P=E.$r(K),(H=X.$$prototype).pos=H.string=H.working=H.matched=H.prev_pos=H.match=J,X.$attr_reader("pos","matched"),ye(X,"$initialize",function(q){var Y=this;return Y.string=q,Y.pos=0,Y.matched=J,Y.working=q,Y.match=[]}),X.$attr_reader("string"),ye(X,"$beginning_of_line?",function(){var q=this;return 0===q.pos||"\n"===q.string.charAt(q.pos-1)}),ye(X,"$scan",function(q){var Y=this,Q=(q=Y.$anchor(q)).exec(Y.working);return null==Q?Y.matched=J:(Y.prev_pos=Y.pos,Y.pos+=Q[0].length,Y.working=Y.working.substring(Q[0].length),Y.matched=Q[0],Y.match=Q,Q[0])}),ye(X,"$scan_until",function(q){var Y=this;q=Y.$anchor(q);for(var Q=Y.working,k=0;Q.length!=k;++k){var N=q.exec(Q.substr(k));if(null!==N){var te=k+N[0].length,U=Q.substr(0,te);return Y.matched=N[0],Y.match=N,Y.prev_pos=Y.pos+k,Y.pos+=te,Y.working=Q.substr(te),U}}return Y.matched=J}),ye(X,"$[]",function(q){var Q;if(f(this.match["$empty?"]()))return J;T(P("Symbol"),Q=q)?q=q.$to_s():T(P("String"),Q)||(q=ne["$coerce_to!"](q,P("Integer"),"to_int"));var k=this.match;return q<0&&(q+=k.length),q<0||q>=k.length||null==k[q]?J:k[q]}),ye(X,"$check",function(q){var Y=this,Q=(q=Y.$anchor(q)).exec(Y.working);return Y.matched=null==Q?J:Q[0]}),ye(X,"$check_until",function(q){var Y=this,Q=Y.prev_pos,k=Y.pos,N=Y.working,te=Y.$scan_until(q);return Y.prev_pos=Q,Y.pos=k,Y.working=N,te}),ye(X,"$peek",function(q){return this.working.substring(0,q)}),ye(X,"$eos?",function(){return 0===this.working.length}),ye(X,"$exist?",function(q){var Q=q.exec(this.working);return null==Q?J:0==Q.index?0:Q.index+1}),ye(X,"$skip",function(q){var Y=this,Q=(q=Y.$anchor(q)).exec(Y.working);if(null==Q)return Y.match=[],Y.matched=J;var k=Q[0],N=k.length;return Y.matched=k,Y.match=Q,Y.prev_pos=Y.pos,Y.pos+=N,Y.working=Y.working.substring(N),N}),ye(X,"$skip_until",function(q){var Q=this.$scan_until(q);return Q===J?J:(this.matched=Q.substr(-1),Q.length)}),ye(X,"$get_byte",function(){var q=this,Y=J;return q.pos<q.string.length?(q.prev_pos=q.pos,q.pos+=1,Y=q.matched=q.working.substring(0,1),q.working=q.working.substring(1)):q.matched=J,Y}),ye(X,"$match?",function(q){var Y=this,Q=(q=Y.$anchor(q)).exec(Y.working);return null==Q?J:(Y.prev_pos=Y.pos,Q[0].length)}),ye(X,"$pos=",function(q){var Y=this;return q<0&&(q+=Y.string.$length()),Y.pos=q,Y.working=Y.string.slice(q)}),ye(X,"$matched_size",function(){return this.matched===J?J:this.matched.length}),ye(X,"$post_match",function(){var q=this;return q.matched===J?J:q.string.substr(q.pos)}),ye(X,"$pre_match",function(){var q=this;return q.matched===J?J:q.string.substr(0,q.prev_pos)}),ye(X,"$reset",function(){var q=this;return q.working=q.string,q.matched=J,q.pos=0}),ye(X,"$rest",v("working")),ye(X,"$rest?",function(){return 0!==this.working.length}),ye(X,"$rest_size",function(){return this.$rest().$size()}),ye(X,"$terminate",function(){var q,Y=this;return Y.match=J,q=[Y.string.$length()],S(Y,"pos=",q),q[q.length-1]}),ye(X,"$unscan",function(){var q=this;return q.pos=q.prev_pos,q.prev_pos=J,q.match=J,q}),L(X,"bol?","beginning_of_line?"),L(X,"getch","get_byte"),X.$private(),ye(X,"$anchor",function(q){var Y=q.toString().match(/\/([^\/]+)$/);return Y=Y?Y[1]:void 0,new RegExp("^(?:"+q.source+")",Y)})},Opal.queue(function(E){var D,J,Z,j,de=E.klass,ye=E.def,f=E.module,T=E.top,ne=[],v=E.$r(ne),S=E.nil;return T.$require("strscan"),J=ne,[j=de(ne[0],null,"Dir")].concat(J),Z=E.get_singleton_class(j),ye(Z,"$[]",function(){return[]}),D=f(ne[0],"StringScannerPatch"),ye(D,"$scan_until",function(j){var F=this;j=(F=this).$anchor(j);for(var K,Z=F.pos,X=F.working;;){var P=0===X.length;if(K=j.exec(X),Z+=1,X=X.substr(1),null!=K)return F.matched=F.string.substr(F.pos,Z-F.pos-1+K[0].length),F.prev_pos=Z-1,F.pos=Z,F.working=X.substr(K[0].length-1),F.matched;if(P)return F.matched=S}}),v("StringScanner").$prepend(v("StringScannerPatch")),E.top.$__dir__=()=>"/",S})},8465:(E,de,ye)=>{ye(9993),Opal.modules["bcdice/arithmetic/node"]=function(f){var k,I,z,_,l,M,ge,y,te,T=f.module,ne=f.klass,v=f.def,S=f.thrower,L=f.return_ivar,D=f.send2,J=f.find_super,j=f.eqeq,F=f.const_set,Z=f.eqeqeq,X=f.rb_divide,K=f.truthy,P=f.assign_ivar,H=f.alias,le=[],q=f.nil,Y=f.$$$;return k=le,I=te=[T(le[0],"BCDice")].concat(k),z=y=[T(te[0],"Arithmetic")].concat(I),M=[T(y[0],"Node")].concat(z),ge=f.$r(M),(l=(_=ne(M[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=q,v(_,"$initialize",function(h,d,p){var m=this;return m.lhs=h,m.op=d,m.rhs=p}),v(_,"$eval",function(h){try{S("eval_return");var x,p=this,m=q;return m=p.lhs.$eval(h),x=p.rhs.$eval(h),m.$send(p.op,x)}catch($){if($===f.t_eval_return)return $.$v;throw $}}),v(_,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()}),v(_,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"}),v(_,"$op_for_s_exp",L("op")),function(B,O,_){var l=ne(B,O,"DivideBase"),c=[l].concat(_),h=f.$r(c),d=l.$$prototype;d.lhs=d.rhs=d.op=q,v(l,"$initialize",function p(m,x){return p.$$p=null,D(this,J(this,"initialize",p,!1,!0),"initialize",[m,"/",x],null)}),v(l,"$eval",function(m){try{S("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),j(se,0)&&$.$raise(h("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(De){if(De===f.t_eval_return)return De.$v;throw De}}),v(l,"$output",function p(){var m=p.$$p||q,x=this;return p.$$p=null,""+D(x,J(x,"output",p,!1,!0),"output",[],m)+x.$rounding_method()}),l.$private(),v(l,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),v(l,"$divide_and_round",function(m,x,$){return this.$raise(h("NotImplementedError"))})}(M[0],ge("BinaryOp"),M),function(B,O,_){var l=ne(B,O,"DivideWithGameSystemDefault"),c=[l].concat(_),h=f.$r(c);F(c[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(p,m,x){var $,re=q;return Z(Y(h("RoundType"),"CEIL"),$=x)?X(p.$to_f(),m).$ceil():Z(Y(h("RoundType"),"ROUND"),$)?(re=X(p.$to_f(),m),K(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):X(p,m).$floor()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithCeil"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d.$to_f(),p).$ceil()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithRound"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(d,p,m){var x=q;return x=X(d.$to_f(),p),K(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(M[0],ge("DivideBase"),M),function(B,O,_){var l=ne(B,O,"DivideWithFloor"),c=[l].concat(_);F(c[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(d,p,m){return X(d,p).$floor()})}(M[0],ge("DivideBase"),M),function(B,O){var _=ne(B,null,"Negative");_.$$prototype.body=q,v(_,"$initialize",P("body")),v(_,"$eval",function(h){try{return S("eval_return"),this.body.$eval(h)["$-@"]()}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"-"+this.body.$output()}),v(_,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Parenthesis");_.$$prototype.expr=q,v(_,"$initialize",P("expr")),v(_,"$eval",function(h){try{return S("eval_return"),this.expr.$eval(h)}catch(m){if(m===f.t_eval_return)return m.$v;throw m}}),v(_,"$output",function(){return"("+this.expr.$output()+")"}),v(_,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(M[0]),function(B,O){var _=ne(B,null,"Number");return _.$$prototype.value=q,v(_,"$initialize",P("value")),v(_,"$eval",L("value")),v(_,"$output",function(){return this.value.$to_s()}),H(_,"s_exp","output")}(M[0])},Opal.modules["racc/parser"]=function(f){var R,ie,M,T=f.module,ne=f.klass,v=f.truthy,S=f.const_set,L=f.defs,D=f.gvars,J=f.rb_lt,j=f.def,F=f.to_ary,Z=f.send,X=f.neqeq,K=f.rb_plus,P=f.eqeq,H=f.rb_ge,le=f.rb_gt,q=f.rb_minus,Y=f.rb_le,Q=f.rb_times,k=f.assign_ivar_val,te=[],U=f.$r(te),I=f.nil,A=f.$$$;return R=te,ie=[T(te[0],"Racc")].concat(R),M=f.$r(ie),ne(ie[0],M("StandardError"),"ParseError"),v(A("::","ParseError","skip_raise")?"constant":I)||S(te[0],"ParseError",A(U("Racc"),"ParseError")),function(y,R){var _,l,c,h,d,M=[T(y,"Racc")].concat(R),ge=f.$r(M);return v(ge("Racc_No_Extensions","skip_raise")?"constant":I)||S(M[0],"Racc_No_Extensions",!1),_=M,c=[l=ne(M[0],null,"Parser")].concat(_),h=f.$r(c),(d=l.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=I,S(c[0],"Racc_Runtime_Version","1.4.6"),S(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),S(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),S(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),S(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),S(c[0],"Racc_Runtime_Core_Version",h("Racc_Runtime_Core_Version_R")),S(c[0],"Racc_Runtime_Core_Revision",h("Racc_Runtime_Core_Revision_R")),S(c[0],"Racc_Runtime_Type","ruby"),L(h("Parser"),"$racc_runtime_type",function(){return h("Racc_Runtime_Type")}),j(l,"$_racc_setup",function(){var m,x,$=this,re=I,se=I;return null==D.stderr&&(D.stderr=I),v(A($.$class(),"Racc_debug_parser"))||($.yydebug=!1),v(null!=(m=$.yydebug)&&m!==I?"instance-variable":I)||($.yydebug=!1),v($.yydebug)&&(v(null!=(x=$.racc_debug_out)&&x!==I?"instance-variable":I)||($.racc_debug_out=D.stderr),$.racc_debug_out=v(re=$.racc_debug_out)?re:D.stderr),se=A($.$class(),"Racc_arg"),v(J(se.$size(),14))&&se["$[]="](13,!0),se}),j(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=I,m.racc_val=I,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),j(l,"$do_parse",function(){return this.$__send__(h("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),j(l,"$next_token",function(){return this.$raise(h("NotImplementedError"),this.$class()+"#next_token is not defined")}),j(l,"$_racc_do_parse_rb",function(m,x){var $,De=I,Ae=I,fe=I,Pe=I,xe=I,pe=I,Me=I,Ce=I;return $=F(m),De=null==$[0]?I:$[0],Ae=null==$[1]?I:$[1],fe=null==$[2]?I:$[2],Pe=null==$[3]?I:$[3],xe=null==$[10]?I:$[10],this.$_racc_init_sysvars(),pe=Me=Ce=I,Z(this,"catch",["racc_end_parse"],function ae(){var he,Ee,C=null==ae.$$s?this:ae.$$s,V=I;for(null==C.racc_state&&(C.racc_state=I),null==C.racc_read_next&&(C.racc_read_next=I),null==C.racc_t&&(C.racc_t=I),null==C.yydebug&&(C.yydebug=I),null==C.racc_val&&(C.racc_val=I);v(!0);)for(v(Ce=Pe["$[]"](C.racc_state["$[]"](-1)))?(v(C.racc_read_next)&&X(C.racc_t,0)&&(Ee=C.$next_token(),he=F(Ee),pe=null==he[0]?I:he[0],C.racc_val=null==he[1]?I:he[1],C.racc_t=v(pe)?v(V=xe["$[]"](pe))?V:1:0,v(C.yydebug)&&C.$racc_read_token(C.racc_t,pe,C.racc_val),C.racc_read_next=!1),Ce=K(Ce,C.racc_t),v(H(Ce,0))&&v(Me=De["$[]"](Ce))&&P(Ae["$[]"](Ce),C.racc_state["$[]"](-1))||(Me=fe["$[]"](C.racc_state["$[]"](-1)))):Me=fe["$[]"](C.racc_state["$[]"](-1));v(Me=C.$_racc_evalact(Me,m)););},{$$s:this})}),j(l,"$yyparse",function(m,x){return this.$__send__(h("Racc_YY_Parse_Method"),m,x,this.$_racc_setup(),!0)}),j(l,"$_racc_yyparse_rb",function(m,x,$,re){var se,fe=I,Pe=I,be=I,xe=I,Me=I,Ce=I,ae=I;return se=F($),fe=null==se[0]?I:se[0],Pe=null==se[1]?I:se[1],be=null==se[2]?I:se[2],xe=null==se[3]?I:se[3],Me=null==se[10]?I:se[10],this.$_racc_init_sysvars(),Ce=I,ae=I,Z(this,"catch",["racc_end_parse"],function he(){var Ee=null==he.$$s?this:he.$$s;for(null==Ee.racc_state&&(Ee.racc_state=I);!v(ae=xe["$[]"](Ee.racc_state["$[]"](-1)));)for(;v(Ce=Ee.$_racc_evalact(be["$[]"](Ee.racc_state["$[]"](-1)),$)););return Z(m,"__send__",[x],function C(V,$e){var Te=null==C.$$s?this:C.$$s,Fe=I,Ue=I;for(null==Te.racc_t&&(Te.racc_t=I),null==Te.racc_state&&(Te.racc_state=I),null==Te.racc_read_next&&(Te.racc_read_next=I),null==V&&(V=I),null==$e&&($e=I),Te.racc_t=v(V)?v(Fe=Me["$[]"](V))?Fe:1:0,Te.racc_val=$e,Te.racc_read_next=!1,ae=K(ae,Te.racc_t),v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););for(;v(v(Fe=v(Ue=(ae=xe["$[]"](Te.racc_state["$[]"](-1)))["$!"]())?Ue:Te.racc_read_next["$!"]())?Fe:Te.racc_t["$=="](0));)for(v(ae)&&v(ae=K(ae,Te.racc_t))&&v(H(ae,0))&&v(Ce=fe["$[]"](ae))&&P(Pe["$[]"](ae),Te.racc_state["$[]"](-1))||(Ce=be["$[]"](Te.racc_state["$[]"](-1)));v(Ce=Te.$_racc_evalact(Ce,$)););},{$$s:Ee})},{$$s:this})}),j(l,"$_racc_evalact",function(m,x){var $,be,se=this,De=I,Ae=I,Pe=I,xe=I,pe=I,Me=I;if(De=null==($=F(x))[0]?I:$[0],Ae=null==$[1]?I:$[1],Pe=null==$[3]?I:$[3],be=null==$[11]?I:$[11],xe=null==$[12]?I:$[12],v(le(m,0))&&v(J(m,be)))v(le(se.racc_error_status,0))&&(P(se.racc_t,1)||(se.racc_error_status=q(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,v(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(v(J(m,0))&&v(le(m,xe["$-@"]()))){if(pe=Z(se,"catch",["racc_jump"],function Ce(){var ae=null==Ce.$$s?this:Ce.$$s;return null==ae.racc_state&&(ae.racc_state=I),ae.racc_state.$push(ae.$_racc_do_reduce(x,m)),!1},{$$s:se}),v(pe))switch(pe){case 1:return se.racc_user_yyerror=!0,xe["$-@"]();case 2:return be;default:se.$raise("[Racc Bug] unknown jump code")}}else if(P(m,be))v(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(P(m,xe["$-@"]())){switch(se.racc_error_status){case 0:v(x["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:P(se.racc_t,0)&&se.$throw("racc_end_parse",I),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;v(!0)&&!(v(Me=Pe["$[]"](se.racc_state["$[]"](-1)))&&(Me=K(Me,1),v(H(Me,0))&&v(m=De["$[]"](Me))&&P(Ae["$[]"](Me),se.racc_state["$[]"](-1))));)v(Y(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",I),se.racc_state.$pop(),se.racc_vstack.$pop(),v(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return v(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),I}),j(l,"$_racc_do_reduce",function(m,x){var $,xe,Me,V,$e,Te,Ze,se=this,Ae=I,fe=I,Pe=I,be=I,pe=I,Ce=I,ae=I,he=I,Ee=I,C=I,Fe=I,Ue=I,lt=I;return Ae=null==($=F(m))[4]?I:$[4],fe=null==$[5]?I:$[5],Pe=null==$[6]?I:$[6],be=null==$[7]?I:$[7],xe=null==$[8]?I:$[8],pe=null==$[9]?I:$[9],Me=null==$[13]?I:$[13],Ce=se.racc_state,ae=se.racc_vstack,he=se.racc_tstack,Ee=Q(x,-3),C=pe["$[]"](Ee),V=pe["$[]"](K(Ee,1)),$e=pe["$[]"](K(Ee,2)),Te=[],v(se.yydebug)&&(Fe=he["$[]"](C["$-@"](),C)),Ue=ae["$[]"](C["$-@"](),C),v(se.yydebug)&&he["$[]="](C["$-@"](),C,Te),ae["$[]="](C["$-@"](),C,Te),Ce["$[]="](C["$-@"](),C,Te),v(Me)?ae.$push(se.$__send__($e,Ue,ae,Ue["$[]"](0))):ae.$push(se.$__send__($e,Ue,ae)),he.$push(V),v(se.yydebug)&&se.$racc_reduce(Fe,V,he,ae),Ze=q(V,xe),v(Ee=be["$[]"](Ze))&&(Ee=K(Ee,Ce["$[]"](-1)),v(H(Ee,0))&&v(lt=Ae["$[]"](Ee))&&P(fe["$[]"](Ee),Ze))?lt:Pe["$[]"](Ze)}),j(l,"$on_error",function(m,x,$){var se;return this.$raise(h("ParseError"),this.$sprintf("\nparse error on value %s (%s)",x.$inspect(),v(se=this.$token_to_str(m))?se:"?"))}),j(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),j(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),j(l,"$yyerrok",k("racc_error_status",0)),j(l,"$racc_read_token",function(m,x,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(x.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),j(l,"$racc_shift",function(m,x,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_reduce",function(m,x,$,re){var se=this,De=I;return(De=se.racc_debug_out).$print("reduce "),v(m["$empty?"]())?De.$print(" <none>"):Z(m,"each",[],function Ae(fe){return null==fe&&(fe=I),De.$print(" ",(null==Ae.$$s?this:Ae.$$s).$racc_token2str(fe))},{$$s:se}),De.$puts(" --\x3e "+se.$racc_token2str(x)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),j(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),j(l,"$racc_e_pop",function(m,x,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(x,$),this.racc_debug_out.$puts()}),j(l,"$racc_next_state",function(m,x){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(x),$.racc_debug_out.$puts()}),j(l,"$racc_print_stacks",function(m,x){var re=I;return(re=this.racc_debug_out).$print("        ["),Z(m,"each_index",[],function se(De){return null==De&&(De=I),re.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(m["$[]"](De))," ",x["$[]"](De).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),j(l,"$racc_print_states",function(m){var $=I;return($=this.racc_debug_out).$print("        ["),Z(m,"each",[],function(se){return null==se&&(se=I),$.$print(" ",se)}),$.$puts(" ]")}),j(l,"$racc_token2str",function(m){var $;return v($=A(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),j(l,"$token_to_str",function(m){return A(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(te[0],te)},Opal.modules.strscan=function(f){var P,H,le,q,Y,ne=f.def,v=f.truthy,S=f.eqeqeq,L=f.Opal,D=f.return_ivar,J=f.send,j=f.alias,F=[],Z=f.nil;return P=F,le=[H=(0,f.klass)(F[0],null,"StringScanner")].concat(P),q=f.$r(le),(Y=H.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=Z,H.$attr_reader("pos","matched"),ne(H,"$initialize",function(k){var N=this;return N.string=k,N.pos=0,N.matched=Z,N.working=k,N.match=[]}),H.$attr_reader("string"),ne(H,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)}),ne(H,"$scan",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?N.matched=Z:(N.prev_pos=N.pos,N.pos+=te[0].length,N.working=N.working.substring(te[0].length),N.matched=te[0],N.match=te,te[0])}),ne(H,"$scan_until",function(k){var N=this;k=N.$anchor(k);for(var te=N.working,U=0;te.length!=U;++U){var I=k.exec(te.substr(U));if(null!==I){var A=U+I[0].length,y=te.substr(0,A);return N.matched=I[0],N.match=I,N.prev_pos=N.pos+U,N.pos+=A,N.working=te.substr(A),y}}return N.matched=Z}),ne(H,"$[]",function(k){var te;if(v(this.match["$empty?"]()))return Z;S(q("Symbol"),te=k)?k=k.$to_s():S(q("String"),te)||(k=L["$coerce_to!"](k,q("Integer"),"to_int"));var U=this.match;return k<0&&(k+=U.length),k<0||k>=U.length||null==U[k]?Z:U[k]}),ne(H,"$check",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return N.matched=null==te?Z:te[0]}),ne(H,"$check_until",function(k){var N=this,te=N.prev_pos,U=N.pos,I=N.working,A=N.$scan_until(k);return N.prev_pos=te,N.pos=U,N.working=I,A}),ne(H,"$peek",function(k){return this.working.substring(0,k)}),ne(H,"$eos?",function(){return 0===this.working.length}),ne(H,"$exist?",function(k){var te=k.exec(this.working);return null==te?Z:0==te.index?0:te.index+1}),ne(H,"$skip",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);if(null==te)return N.match=[],N.matched=Z;var U=te[0],I=U.length;return N.matched=U,N.match=te,N.prev_pos=N.pos,N.pos+=I,N.working=N.working.substring(I),I}),ne(H,"$skip_until",function(k){var te=this.$scan_until(k);return te===Z?Z:(this.matched=te.substr(-1),te.length)}),ne(H,"$get_byte",function(){var k=this,N=Z;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,N=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=Z,N}),ne(H,"$match?",function(k){var N=this,te=(k=N.$anchor(k)).exec(N.working);return null==te?Z:(N.prev_pos=N.pos,te[0].length)}),ne(H,"$pos=",function(k){var N=this;return k<0&&(k+=N.string.$length()),N.pos=k,N.working=N.string.slice(k)}),ne(H,"$matched_size",function(){return this.matched===Z?Z:this.matched.length}),ne(H,"$post_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(k.pos)}),ne(H,"$pre_match",function(){var k=this;return k.matched===Z?Z:k.string.substr(0,k.prev_pos)}),ne(H,"$reset",function(){var k=this;return k.working=k.string,k.matched=Z,k.pos=0}),ne(H,"$rest",D("working")),ne(H,"$rest?",function(){return 0!==this.working.length}),ne(H,"$rest_size",function(){return this.$rest().$size()}),ne(H,"$terminate",function(){var k,N=this;return N.match=Z,k=[N.string.$length()],J(N,"pos=",k),k[k.length-1]}),ne(H,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=Z,k.match=Z,k}),j(H,"bol?","beginning_of_line?"),j(H,"getch","get_byte"),H.$private(),ne(H,"$anchor",function(k){var N=k.toString().match(/\/([^\/]+)$/);return N=N?N[1]:void 0,new RegExp("^(?:"+k.source+")",N)})},Opal.modules["bcdice/normalize"]=function(f){var j,K,Z,T=f.module,ne=f.eqeqeq,v=f.def,S=f.eqeq,L=[],D=f.nil;return j=L,Z=[T(L[0],"BCDice")].concat(j),(K=T(Z[0],"Normalize")).$module_function(),v(K,"$comparison_operator",function(H){var le;return ne(/<=|=</,le=H)?"<=":ne(/>=|=>/,le)?">=":ne(/<>|!=|=!/,le)?"!=":ne(/</,le)?"<":ne(/>/,le)?">":ne(/=/,le)?"==":D}),v(K,"$target_number",function(H){return S(H,"?")?H:H.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(f){var X,le,N,te,U,I,Y,P,T=f.module,ne=f.klass,v=f.const_set,S=f.hash2,L=f.truthy,D=f.def,J=f.top,j=[],F=f.nil;return J.$require("strscan"),J.$require("bcdice/normalize"),X=j,le=P=[T(j[0],"BCDice")].concat(X),N=Y=[T(P[0],"CommonCommand")].concat(le),U=[te=ne(Y[0],null,"Lexer")].concat(N),I=f.$r(U),te.$$prototype.scanner=F,v(U[0],"SYMBOLS",S(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),D(te,"$initialize",function(R){var ie;return R=L(ie=R.$split(" ",2).$first())?ie:"",this.scanner=I("StringScanner").$new(R)}),D(te,"$next_token",function(){var R=this,z=F,ie=F,M=F,B=F;return L(R.scanner["$eos?"]())?[!1,"$"]:L(z=R.scanner.$scan(/\d+/))?["NUMBER",z.$to_i()]:L(ie=R.scanner.$scan(/[<>!=]+/))?["CMP_OP",I("Normalize").$comparison_operator(ie)]:(M=R.scanner.$getch().$upcase(),[L(B=I("SYMBOLS")["$[]"](M))?B:M.$to_sym(),M])}),D(te,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/arithmetic/parser"]=function(f){var K,q,U,R,z,ie,M,ge,B,O,_,l,d,I,A,y,Q,k,H,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.hash,D=f.const_set,J=f.top,j=[],F=f.nil,Z=f.$$$;return J.$require("racc/parser.rb"),J.$require("bcdice/common_command/lexer"),J.$require("bcdice/arithmetic/node"),K=j,q=H=[T(j[0],"BCDice")].concat(K),Q=[T(H[0],"Arithmetic")].concat(q),k=f.$r(Q),U=Q,A=[I=ne(Q[0],Z(k("Racc"),"Parser"),"Parser")].concat(U),y=f.$r(A),I.$$prototype.lexer=F,v(I,"$parse",function(re){return this.$new().$parse(re)}),S(I,"$parse",function(re){try{return this.lexer=Z(Z(y("BCDice"),"CommonCommand"),"Lexer").$new(re),this.$do_parse()}catch(De){if(!f.rescue(De,[y("ParseError")]))throw De;try{return F}finally{f.pop_exception()}}}),I.$private(),S(I,"$next_token",function(){return this.lexer.$next_token()}),R=f.large_array_unpack("8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,,,4,5,4,5,7,9,7,,,10,11,,10,11,22,26,24,25,27"),z=f.large_array_unpack("0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,,,12,12,13,13,12,1,13,,,16,16,,1,1,16,21,21,21,21"),ie=[-2,40,-6,F,0,8,F,10,F,1,18,20,28,30,F,F,37,F,4,14,F,47,F,F,F,F,F,F],M=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],ge=[14,15,23,1,18,19,F,F,20,21,16],B=[3,3,4,1,2,2,F,F,3,3,1],O=[F,3,-6,-4,-19,F],_=[F,F,2,3,F,6],l=f.large_array_unpack("0,0,racc_error,3,14,_reduce_1,3,14,_reduce_2,1,14,_reduce_none,3,15,_reduce_4,4,15,_reduce_5,1,15,_reduce_none,0,17,_reduce_7,1,17,_reduce_8,1,17,_reduce_9,1,17,_reduce_10,1,17,_reduce_11,2,16,_reduce_12,2,16,_reduce_13,1,16,_reduce_none,3,18,_reduce_15,1,18,_reduce_16"),d=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),D(A[0],"Racc_arg",[R,z,M,ie,ge,B,_,O,13,l,d,28,17,!0]),D(A[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),D(A[0],"Racc_debug_parser",!1),S(I,"$_reduce_1",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"+",re["$[]"](2))}),S(I,"$_reduce_2",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"-",re["$[]"](2))}),S(I,"$_reduce_4",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"*",re["$[]"](2))}),S(I,"$_reduce_5",function(re,se,De){return re["$[]"](3).$new(re["$[]"](0),re["$[]"](2))}),S(I,"$_reduce_7",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),S(I,"$_reduce_8",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"DivideWithCeil")}),S(I,"$_reduce_9",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"DivideWithCeil")}),S(I,"$_reduce_10",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"DivideWithRound")}),S(I,"$_reduce_11",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"DivideWithFloor")}),S(I,"$_reduce_12",function(re,se,De){return re["$[]"](1)}),S(I,"$_reduce_13",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"Negative").$new(re["$[]"](1))}),S(I,"$_reduce_15",function(re,se,De){return re["$[]"](1)}),S(I,"$_reduce_16",function(re,se,De){return Z(Z(y("Arithmetic"),"Node"),"Number").$new(re["$[]"](0))}),S(I,"$_reduce_none",function(re,se,De){return re["$[]"](0)})},Opal.modules["bcdice/arithmetic"]=function(f){var j,K,le,Y,Q,P,H,Z,T=f.module,ne=f.thrower,v=f.def,S=f.top,L=[],D=f.nil;return S.$require("bcdice/arithmetic/node"),S.$require("bcdice/arithmetic/parser"),j=L,K=Z=[T(L[0],"BCDice")].concat(j),H=[P=T(Z[0],"Arithmetic")].concat(K),Y=[le=f.get_singleton_class(P)].concat(H),Q=f.$r(Y),v(le,"$eval",function(N,te){try{var I;ne("eval_return");try{return(I=Q("Parser").$parse(N))===D||null==I?D:I.$eval(te)}catch(y){if(!f.rescue(y,[Q("ZeroDivisionError")]))throw y;try{return D}finally{f.pop_exception()}}}catch(y){if(y===f.t_eval_return)return y.$v;throw y}})},Opal.queue(function(f){var P,Q,k,N,te,U,le,T=f.module,ne=f.klass,v=f.defs,S=f.def,L=f.send,D=f.truthy,J=f.eqeq,j=f.thrower,Z=[],X=f.nil;return f.top.$require("bcdice/arithmetic"),P=Z,Q=le=[T(Z[0],"BCDice")].concat(P),N=[k=ne(le[0],null,"Preprocessor")].concat(Q),te=f.$r(N),(U=k.$$prototype).game_system=U.text=X,v(k,"$process",function(A,y){return te("Preprocessor").$new(A,y).$process()}),S(k,"$initialize",function(A,y){return this.text=A,this.game_system=y}),S(k,"$process",function(){var A=this;return A.$trim_after_whitespace(),A.$replace_parentheses(),A.text=A.game_system.$change_text(A.text),A.$replace_implicit_d(),A.text}),k.$private(),S(k,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()}),S(k,"$replace_parentheses",function(){try{j("eval_return");var y=this;return function(){try{var R=j("break");return L(y,"loop",[],function z(){var M,ie=null==z.$$s?this:z.$$s;if(null==ie.text&&(ie.text=X),M=ie.text,ie.text=L(ie.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function ge(B){var _,O=null==ge.$$s?this:ge.$$s;return null==O.game_system&&(O.game_system=X),null==B&&(B=X),D(_=te("Arithmetic").$eval(B,O.game_system.$round_type()))?_:B},{$$s:ie}),!J(M,ie.text))return X;R.$throw()},{$$s:y})}catch(z){if(z===R)return z.$v;throw z}}()}catch(R){if(R===f.t_eval_return)return R.$v;throw R}}),S(k,"$replace_implicit_d",function(){var A=this;return A.text=L(A.text,"gsub",[/(\d+)D([^\w]|$)/i],function y(){var R=null==y.$$s?this:y.$$s;return null==R.game_system&&(R.game_system=X),te("Regexp").$last_match(1)+"D"+R.game_system.$sides_implicit_d()+te("Regexp").$last_match(2)},{$$s:A})})})},6956:(E,de,ye)=>{ye(9993),Opal.queue(function(f){var D,v=[];return D=v,(0,f.const_set)([(0,f.module)(v[0],"BCDice")].concat(D)[0],"VERSION","3.9.0")})},3583:function(E,de,ye){"use strict";var f=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(de,"__esModule",{value:!0}),de.Opal=de.I18n=de.BCDice=void 0,ye(6956);var T=f(ye(8459));de.BCDice=T.default.module(null,"BCDice"),de.I18n=T.default.module(null,"I18n");var ne=ye(8459);Object.defineProperty(de,"Opal",{enumerable:!0,get:function(){return f(ne).default}})},8459:(E,de,ye)=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0}),de.nilToNull=void 0,ye(9993),Opal.config.unsupported_features_severity="ignore",de.default=Opal,de.nilToNull=function f(T){return T===Opal.nil?null:T}},3693:function(E,de,ye){"use strict";var f=this&&this.__assign||function(){return f=Object.assign||function(S){for(var L,D=1,J=arguments.length;D<J;D++)for(var j in L=arguments[D])Object.prototype.hasOwnProperty.call(L,j)&&(S[j]=L[j]);return S},f.apply(this,arguments)},T=this&&this.__rest||function(S,L){var D={};for(var J in S)Object.prototype.hasOwnProperty.call(S,J)&&L.indexOf(J)<0&&(D[J]=S[J]);if(null!=S&&"function"==typeof Object.getOwnPropertySymbols){var j=0;for(J=Object.getOwnPropertySymbols(S);j<J.length;j++)L.indexOf(J[j])<0&&Object.prototype.propertyIsEnumerable.call(S,J[j])&&(D[J[j]]=S[J[j]])}return D};Object.defineProperty(de,"__esModule",{value:!0}),de.parseResult=void 0;var ne=ye(3583);de.parseResult=function v(S){if(S===ne.Opal.nil)return null;var L=S.detailed_rands,D=T(S,["detailed_rands"]);return f(f({},D),{detailedRands:L.map(function(J){return J.$to_n()})})}},7585:function(E,de,ye){var f;E.exports=(f=f||function(T,ne){var v;if("undefined"!=typeof window&&window.crypto&&(v=window.crypto),"undefined"!=typeof self&&self.crypto&&(v=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(v=globalThis.crypto),!v&&"undefined"!=typeof window&&window.msCrypto&&(v=window.msCrypto),!v&&"undefined"!=typeof global&&global.crypto&&(v=global.crypto),!v)try{v=ye(2480)}catch(Y){}var S=function(){if(v){if("function"==typeof v.getRandomValues)try{return v.getRandomValues(new Uint32Array(1))[0]}catch(Y){}if("function"==typeof v.randomBytes)try{return v.randomBytes(4).readInt32LE()}catch(Y){}}throw new Error("Native crypto module could not be used to get secure random number.")},L=Object.create||function(){function Y(){}return function(Q){var k;return Y.prototype=Q,k=new Y,Y.prototype=null,k}}(),D={},J=D.lib={},j=J.Base={extend:function(Y){var Q=L(this);return Y&&Q.mixIn(Y),(!Q.hasOwnProperty("init")||this.init===Q.init)&&(Q.init=function(){Q.$super.init.apply(this,arguments)}),Q.init.prototype=Q,Q.$super=this,Q},create:function(){var Y=this.extend();return Y.init.apply(Y,arguments),Y},init:function(){},mixIn:function(Y){for(var Q in Y)Y.hasOwnProperty(Q)&&(this[Q]=Y[Q]);Y.hasOwnProperty("toString")&&(this.toString=Y.toString)},clone:function(){return this.init.prototype.extend(this)}},F=J.WordArray=j.extend({init:function(Y,Q){Y=this.words=Y||[],this.sigBytes=null!=Q?Q:4*Y.length},toString:function(Y){return(Y||X).stringify(this)},concat:function(Y){var Q=this.words,k=Y.words,N=this.sigBytes,te=Y.sigBytes;if(this.clamp(),N%4)for(var U=0;U<te;U++)Q[N+U>>>2]|=(k[U>>>2]>>>24-U%4*8&255)<<24-(N+U)%4*8;else for(var A=0;A<te;A+=4)Q[N+A>>>2]=k[A>>>2];return this.sigBytes+=te,this},clamp:function(){var Y=this.words,Q=this.sigBytes;Y[Q>>>2]&=4294967295<<32-Q%4*8,Y.length=T.ceil(Q/4)},clone:function(){var Y=j.clone.call(this);return Y.words=this.words.slice(0),Y},random:function(Y){for(var Q=[],k=0;k<Y;k+=4)Q.push(S());return new F.init(Q,Y)}}),Z=D.enc={},X=Z.Hex={stringify:function(Y){for(var Q=Y.words,k=Y.sigBytes,N=[],te=0;te<k;te++){var U=Q[te>>>2]>>>24-te%4*8&255;N.push((U>>>4).toString(16)),N.push((15&U).toString(16))}return N.join("")},parse:function(Y){for(var Q=Y.length,k=[],N=0;N<Q;N+=2)k[N>>>3]|=parseInt(Y.substr(N,2),16)<<24-N%8*4;return new F.init(k,Q/2)}},K=Z.Latin1={stringify:function(Y){for(var Q=Y.words,k=Y.sigBytes,N=[],te=0;te<k;te++)N.push(String.fromCharCode(Q[te>>>2]>>>24-te%4*8&255));return N.join("")},parse:function(Y){for(var Q=Y.length,k=[],N=0;N<Q;N++)k[N>>>2]|=(255&Y.charCodeAt(N))<<24-N%4*8;return new F.init(k,Q)}},P=Z.Utf8={stringify:function(Y){try{return decodeURIComponent(escape(K.stringify(Y)))}catch(Q){throw new Error("Malformed UTF-8 data")}},parse:function(Y){return K.parse(unescape(encodeURIComponent(Y)))}},H=J.BufferedBlockAlgorithm=j.extend({reset:function(){this._data=new F.init,this._nDataBytes=0},_append:function(Y){"string"==typeof Y&&(Y=P.parse(Y)),this._data.concat(Y),this._nDataBytes+=Y.sigBytes},_process:function(Y){var Q,k=this._data,N=k.words,te=k.sigBytes,U=this.blockSize,A=te/(4*U),y=(A=Y?T.ceil(A):T.max((0|A)-this._minBufferSize,0))*U,R=T.min(4*y,te);if(y){for(var z=0;z<y;z+=U)this._doProcessBlock(N,z);Q=N.splice(0,y),k.sigBytes-=R}return new F.init(Q,R)},clone:function(){var Y=j.clone.call(this);return Y._data=this._data.clone(),Y},_minBufferSize:0}),q=(J.Hasher=H.extend({cfg:j.extend(),init:function(Y){this.cfg=this.cfg.extend(Y),this.reset()},reset:function(){H.reset.call(this),this._doReset()},update:function(Y){return this._append(Y),this._process(),this},finalize:function(Y){return Y&&this._append(Y),this._doFinalize()},blockSize:16,_createHelper:function(Y){return function(Q,k){return new Y.init(k).finalize(Q)}},_createHmacHelper:function(Y){return function(Q,k){return new q.HMAC.init(Y,k).finalize(Q)}}}),D.algo={});return D}(Math),f)},7412:function(E,de,ye){var f;E.exports=(f=ye(7585),function(){if("function"==typeof ArrayBuffer){var v=f.lib.WordArray,S=v.init,L=v.init=function(D){if(D instanceof ArrayBuffer&&(D=new Uint8Array(D)),(D instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array)&&(D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength)),D instanceof Uint8Array){for(var J=D.byteLength,j=[],F=0;F<J;F++)j[F>>>2]|=D[F]<<24-F%4*8;S.call(this,j,J)}else S.apply(this,arguments)};L.prototype=v}}(),f.lib.WordArray)},1817:function(E,de,ye){var f;E.exports=(f=ye(7585),function(T){var ne=f,v=ne.lib,S=v.WordArray,L=v.Hasher,D=ne.algo,J=[],j=[];!function(){function X(le){for(var q=T.sqrt(le),Y=2;Y<=q;Y++)if(!(le%Y))return!1;return!0}function K(le){return 4294967296*(le-(0|le))|0}for(var P=2,H=0;H<64;)X(P)&&(H<8&&(J[H]=K(T.pow(P,.5))),j[H]=K(T.pow(P,1/3)),H++),P++}();var F=[],Z=D.SHA256=L.extend({_doReset:function(){this._hash=new S.init(J.slice(0))},_doProcessBlock:function(X,K){for(var P=this._hash.words,H=P[0],le=P[1],q=P[2],Y=P[3],Q=P[4],k=P[5],N=P[6],te=P[7],U=0;U<64;U++){if(U<16)F[U]=0|X[K+U];else{var I=F[U-15],y=F[U-2];F[U]=((I<<25|I>>>7)^(I<<14|I>>>18)^I>>>3)+F[U-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+F[U-16]}var ie=H&le^H&q^le&q,B=te+((Q<<26|Q>>>6)^(Q<<21|Q>>>11)^(Q<<7|Q>>>25))+(Q&k^~Q&N)+j[U]+F[U];te=N,N=k,k=Q,Q=Y+B|0,Y=q,q=le,le=H,H=B+(((H<<30|H>>>2)^(H<<19|H>>>13)^(H<<10|H>>>22))+ie)|0}P[0]=P[0]+H|0,P[1]=P[1]+le|0,P[2]=P[2]+q|0,P[3]=P[3]+Y|0,P[4]=P[4]+Q|0,P[5]=P[5]+k|0,P[6]=P[6]+N|0,P[7]=P[7]+te|0},_doFinalize:function(){var X=this._data,K=X.words,P=8*this._nDataBytes,H=8*X.sigBytes;return K[H>>>5]|=128<<24-H%32,K[14+(H+64>>>9<<4)]=T.floor(P/4294967296),K[15+(H+64>>>9<<4)]=P,X.sigBytes=4*K.length,this._process(),this._hash},clone:function(){var X=L.clone.call(this);return X._hash=this._hash.clone(),X}});ne.SHA256=L._createHelper(Z),ne.HmacSHA256=L._createHmacHelper(Z)}(Math),f.SHA256)},6654:E=>{!function(ye){E.exports=ye;var f="listeners",T={on:function v(j,F){return J(this,j).push(F),this},once:function S(j,F){var Z=this;return X.originalListener=F,J(Z,j).push(X),Z;function X(){L.call(Z,j,X),F.apply(this,arguments)}},off:L,emit:function D(j,F){var Z=this,X=J(Z,j,!0);if(!X)return!1;var K=arguments.length;if(1===K)X.forEach(H);else if(2===K)X.forEach(le);else{var P=Array.prototype.slice.call(arguments,1);X.forEach(q)}return!!X.length;function H(Y){Y.call(Z)}function le(Y){Y.call(Z,F)}function q(Y){Y.apply(Z,P)}}};function ne(j){for(var F in T)j[F]=T[F];return j}function L(j,F){var X,Z=this;if(arguments.length){if(F){if(X=J(Z,j,!0)){if(!(X=X.filter(K)).length)return L.call(Z,j);Z[f][j]=X}}else if((X=Z[f])&&(delete X[j],!Object.keys(X).length))return L.call(Z)}else delete Z[f];return Z;function K(P){return P!==F&&P.originalListener!==F}}function J(j,F,Z){if(!Z||j[f]){var X=j[f]||(j[f]={});return X[F]||(X[F]=[])}}ne(ye.prototype),ye.mixin=ne}(function de(){if(!(this instanceof de))return new de})},9069:E=>{"use strict";var f,de="object"==typeof Reflect?Reflect:null,ye=de&&"function"==typeof de.apply?de.apply:function(k,N,te){return Function.prototype.apply.call(k,N,te)};f=de&&"function"==typeof de.ownKeys?de.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var ne=Number.isNaN||function(k){return k!=k};function v(){v.init.call(this)}E.exports=v,E.exports.once=function le(Q,k){return new Promise(function(N,te){function U(A){Q.removeListener(k,I),te(A)}function I(){"function"==typeof Q.removeListener&&Q.removeListener("error",U),N([].slice.call(arguments))}Y(Q,k,I,{once:!0}),"error"!==k&&function q(Q,k,N){"function"==typeof Q.on&&Y(Q,"error",k,N)}(Q,U,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var S=10;function L(Q){if("function"!=typeof Q)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Q)}function D(Q){return void 0===Q._maxListeners?v.defaultMaxListeners:Q._maxListeners}function J(Q,k,N,te){var U,I,A;if(L(N),void 0===(I=Q._events)?(I=Q._events=Object.create(null),Q._eventsCount=0):(void 0!==I.newListener&&(Q.emit("newListener",k,N.listener?N.listener:N),I=Q._events),A=I[k]),void 0===A)A=I[k]=N,++Q._eventsCount;else if("function"==typeof A?A=I[k]=te?[N,A]:[A,N]:te?A.unshift(N):A.push(N),(U=D(Q))>0&&A.length>U&&!A.warned){A.warned=!0;var y=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");y.name="MaxListenersExceededWarning",y.emitter=Q,y.type=k,y.count=A.length,function T(Q){console&&console.warn&&console.warn(Q)}(y)}return Q}function j(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(Q,k,N){var te={fired:!1,wrapFn:void 0,target:Q,type:k,listener:N},U=j.bind(te);return U.listener=N,te.wrapFn=U,U}function Z(Q,k,N){var te=Q._events;if(void 0===te)return[];var U=te[k];return void 0===U?[]:"function"==typeof U?N?[U.listener||U]:[U]:N?function H(Q){for(var k=new Array(Q.length),N=0;N<k.length;++N)k[N]=Q[N].listener||Q[N];return k}(U):K(U,U.length)}function X(Q){var k=this._events;if(void 0!==k){var N=k[Q];if("function"==typeof N)return 1;if(void 0!==N)return N.length}return 0}function K(Q,k){for(var N=new Array(k),te=0;te<k;++te)N[te]=Q[te];return N}function Y(Q,k,N,te){if("function"==typeof Q.on)te.once?Q.once(k,N):Q.on(k,N);else{if("function"!=typeof Q.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Q);Q.addEventListener(k,function U(I){te.once&&Q.removeEventListener(k,U),N(I)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(Q){if("number"!=typeof Q||Q<0||ne(Q))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Q+".");S=Q}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(k){if("number"!=typeof k||k<0||ne(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},v.prototype.getMaxListeners=function(){return D(this)},v.prototype.emit=function(k){for(var N=[],te=1;te<arguments.length;te++)N.push(arguments[te]);var U="error"===k,I=this._events;if(void 0!==I)U=U&&void 0===I.error;else if(!U)return!1;if(U){var A;if(N.length>0&&(A=N[0]),A instanceof Error)throw A;var y=new Error("Unhandled error."+(A?" ("+A.message+")":""));throw y.context=A,y}var R=I[k];if(void 0===R)return!1;if("function"==typeof R)ye(R,this,N);else{var z=R.length,ie=K(R,z);for(te=0;te<z;++te)ye(ie[te],this,N)}return!0},v.prototype.on=v.prototype.addListener=function(k,N){return J(this,k,N,!1)},v.prototype.prependListener=function(k,N){return J(this,k,N,!0)},v.prototype.once=function(k,N){return L(N),this.on(k,F(this,k,N)),this},v.prototype.prependOnceListener=function(k,N){return L(N),this.prependListener(k,F(this,k,N)),this},v.prototype.off=v.prototype.removeListener=function(k,N){var te,U,I,A,y;if(L(N),void 0===(U=this._events))return this;if(void 0===(te=U[k]))return this;if(te===N||te.listener===N)0==--this._eventsCount?this._events=Object.create(null):(delete U[k],U.removeListener&&this.emit("removeListener",k,te.listener||N));else if("function"!=typeof te){for(I=-1,A=te.length-1;A>=0;A--)if(te[A]===N||te[A].listener===N){y=te[A].listener,I=A;break}if(I<0)return this;0===I?te.shift():function P(Q,k){for(;k+1<Q.length;k++)Q[k]=Q[k+1];Q.pop()}(te,I),1===te.length&&(U[k]=te[0]),void 0!==U.removeListener&&this.emit("removeListener",k,y||N)}return this},v.prototype.removeAllListeners=function(k){var N,te,U;if(void 0===(te=this._events))return this;if(void 0===te.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==te[k]&&(0==--this._eventsCount?this._events=Object.create(null):delete te[k]),this;if(0===arguments.length){var A,I=Object.keys(te);for(U=0;U<I.length;++U)"removeListener"!==(A=I[U])&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(N=te[k]))this.removeListener(k,N);else if(void 0!==N)for(U=N.length-1;U>=0;U--)this.removeListener(k,N[U]);return this},v.prototype.listeners=function(k){return Z(this,k,!0)},v.prototype.rawListeners=function(k){return Z(this,k,!1)},v.listenerCount=function(Q,k){return"function"==typeof Q.listenerCount?Q.listenerCount(k):X.call(Q,k)},v.prototype.listenerCount=X,v.prototype.eventNames=function(){return this._eventsCount>0?f(this._events):[]}},4327:function(E,de){var T;void 0!==(T=function(){"use strict";function v(F,Z,X){var K=new XMLHttpRequest;K.open("GET",F),K.responseType="blob",K.onload=function(){j(K.response,Z,X)},K.onerror=function(){console.error("could not download file")},K.send()}function S(F){var Z=new XMLHttpRequest;Z.open("HEAD",F,!1);try{Z.send()}catch(X){}return 200<=Z.status&&299>=Z.status}function L(F){try{F.dispatchEvent(new MouseEvent("click"))}catch(X){var Z=document.createEvent("MouseEvents");Z.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),F.dispatchEvent(Z)}}var D="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,J=D.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),j=D.saveAs||("object"!=typeof window||window!==D?function(){}:"download"in HTMLAnchorElement.prototype&&!J?function(F,Z,X){var K=D.URL||D.webkitURL,P=document.createElement("a");P.download=Z=Z||F.name||"download",P.rel="noopener","string"==typeof F?(P.href=F,P.origin===location.origin?L(P):S(P.href)?v(F,Z,X):L(P,P.target="_blank")):(P.href=K.createObjectURL(F),setTimeout(function(){K.revokeObjectURL(P.href)},4e4),setTimeout(function(){L(P)},0))}:"msSaveOrOpenBlob"in navigator?function(F,Z,X){if(Z=Z||F.name||"download","string"!=typeof F)navigator.msSaveOrOpenBlob(function ne(F,Z){return void 0===Z?Z={autoBom:!1}:"object"!=typeof Z&&(console.warn("Deprecated: Expected third argument to be a object"),Z={autoBom:!Z}),Z.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(F.type)?new Blob(["\ufeff",F],{type:F.type}):F}(F,X),Z);else if(S(F))v(F,Z,X);else{var K=document.createElement("a");K.href=F,K.target="_blank",setTimeout(function(){L(K)})}}:function(F,Z,X,K){if((K=K||open("","_blank"))&&(K.document.title=K.document.body.innerText="downloading..."),"string"==typeof F)return v(F,Z,X);var P="application/octet-stream"===F.type,H=/constructor/i.test(D.HTMLElement)||D.safari,le=/CriOS\/[\d]+/.test(navigator.userAgent);if((le||P&&H||J)&&"undefined"!=typeof FileReader){var q=new FileReader;q.onloadend=function(){var k=q.result;k=le?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),K?K.location.href=k:location=k,K=null},q.readAsDataURL(F)}else{var Y=D.URL||D.webkitURL,Q=Y.createObjectURL(F);K?K.location=Q:location.href=Q,K=null,setTimeout(function(){Y.revokeObjectURL(Q)},4e4)}});D.saveAs=j.saveAs=j,E.exports=j}.apply(de,[]))&&(E.exports=T)},5386:(E,de,ye)=>{var f;!function(T,ne,v,S){"use strict";var le,L=["","webkit","Moz","MS","ms","o"],D=ne.createElement("div"),j=Math.round,F=Math.abs,Z=Date.now;function X(Le,qe,tt){return setTimeout(k(Le,tt),qe)}function K(Le,qe,tt){return!!Array.isArray(Le)&&(P(Le,tt[qe],tt),!0)}function P(Le,qe,tt){var dt;if(Le)if(Le.forEach)Le.forEach(qe,tt);else if(Le.length!==S)for(dt=0;dt<Le.length;)qe.call(tt,Le[dt],dt,Le),dt++;else for(dt in Le)Le.hasOwnProperty(dt)&&qe.call(tt,Le[dt],dt,Le)}function H(Le,qe,tt){var dt="DEPRECATED METHOD: "+qe+"\n"+tt+" AT \n";return function(){var kt=new Error("get-stack-trace"),jt=kt&&kt.stack?kt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Hn=T.console&&(T.console.warn||T.console.log);return Hn&&Hn.call(T.console,dt,jt),Le.apply(this,arguments)}}le="function"!=typeof Object.assign?function(qe){if(qe===S||null===qe)throw new TypeError("Cannot convert undefined or null to object");for(var tt=Object(qe),dt=1;dt<arguments.length;dt++){var kt=arguments[dt];if(kt!==S&&null!==kt)for(var jt in kt)kt.hasOwnProperty(jt)&&(tt[jt]=kt[jt])}return tt}:Object.assign;var q=H(function(qe,tt,dt){for(var kt=Object.keys(tt),jt=0;jt<kt.length;)(!dt||dt&&qe[kt[jt]]===S)&&(qe[kt[jt]]=tt[kt[jt]]),jt++;return qe},"extend","Use `assign`."),Y=H(function(qe,tt){return q(qe,tt,!0)},"merge","Use `assign`.");function Q(Le,qe,tt){var kt,dt=qe.prototype;(kt=Le.prototype=Object.create(dt)).constructor=Le,kt._super=dt,tt&&le(kt,tt)}function k(Le,qe){return function(){return Le.apply(qe,arguments)}}function N(Le,qe){return"function"==typeof Le?Le.apply(qe&&qe[0]||S,qe):Le}function te(Le,qe){return Le===S?qe:Le}function U(Le,qe,tt){P(R(qe),function(dt){Le.addEventListener(dt,tt,!1)})}function I(Le,qe,tt){P(R(qe),function(dt){Le.removeEventListener(dt,tt,!1)})}function A(Le,qe){for(;Le;){if(Le==qe)return!0;Le=Le.parentNode}return!1}function y(Le,qe){return Le.indexOf(qe)>-1}function R(Le){return Le.trim().split(/\s+/g)}function z(Le,qe,tt){if(Le.indexOf&&!tt)return Le.indexOf(qe);for(var dt=0;dt<Le.length;){if(tt&&Le[dt][tt]==qe||!tt&&Le[dt]===qe)return dt;dt++}return-1}function ie(Le){return Array.prototype.slice.call(Le,0)}function M(Le,qe,tt){for(var dt=[],kt=[],jt=0;jt<Le.length;){var Hn=qe?Le[jt][qe]:Le[jt];z(kt,Hn)<0&&dt.push(Le[jt]),kt[jt]=Hn,jt++}return tt&&(dt=qe?dt.sort(function(gr,no){return gr[qe]>no[qe]}):dt.sort()),dt}function ge(Le,qe){for(var tt,dt,kt=qe[0].toUpperCase()+qe.slice(1),jt=0;jt<L.length;){if((dt=(tt=L[jt])?tt+kt:qe)in Le)return dt;jt++}return S}var B=1;function _(Le){var qe=Le.ownerDocument||Le;return qe.defaultView||qe.parentWindow||T}var c="ontouchstart"in T,h=ge(T,"PointerEvent")!==S,d=c&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),p="touch",x="mouse",Ee=["x","y"],C=["clientX","clientY"];function V(Le,qe){var tt=this;this.manager=Le,this.callback=qe,this.element=Le.element,this.target=Le.options.inputTarget,this.domHandler=function(dt){N(Le.options.enable,[Le])&&tt.handler(dt)},this.init()}function Te(Le,qe,tt){var dt=tt.pointers.length,kt=tt.changedPointers.length,jt=1&qe&&dt-kt==0,Hn=12&qe&&dt-kt==0;tt.isFirst=!!jt,tt.isFinal=!!Hn,jt&&(Le.session={}),tt.eventType=qe,function Fe(Le,qe){var tt=Le.session,dt=qe.pointers,kt=dt.length;tt.firstInput||(tt.firstInput=lt(qe)),kt>1&&!tt.firstMultiple?tt.firstMultiple=lt(qe):1===kt&&(tt.firstMultiple=!1);var jt=tt.firstInput,Hn=tt.firstMultiple,hr=Hn?Hn.center:jt.center,gr=qe.center=Et(dt);qe.timeStamp=Z(),qe.deltaTime=qe.timeStamp-jt.timeStamp,qe.angle=Bn(hr,gr),qe.distance=nn(hr,gr),function Ue(Le,qe){var tt=qe.center,dt=Le.offsetDelta||{},kt=Le.prevDelta||{},jt=Le.prevInput||{};(1===qe.eventType||4===jt.eventType)&&(kt=Le.prevDelta={x:jt.deltaX||0,y:jt.deltaY||0},dt=Le.offsetDelta={x:tt.x,y:tt.y}),qe.deltaX=kt.x+(tt.x-dt.x),qe.deltaY=kt.y+(tt.y-dt.y)}(tt,qe),qe.offsetDirection=hn(qe.deltaX,qe.deltaY);var no=It(qe.deltaTime,qe.deltaX,qe.deltaY);qe.overallVelocityX=no.x,qe.overallVelocityY=no.y,qe.overallVelocity=F(no.x)>F(no.y)?no.x:no.y,qe.scale=Hn?function ar(Le,qe){return nn(qe[0],qe[1],C)/nn(Le[0],Le[1],C)}(Hn.pointers,dt):1,qe.rotation=Hn?function Ln(Le,qe){return Bn(qe[1],qe[0],C)+Bn(Le[1],Le[0],C)}(Hn.pointers,dt):0,qe.maxPointers=tt.prevInput?qe.pointers.length>tt.prevInput.maxPointers?qe.pointers.length:tt.prevInput.maxPointers:qe.pointers.length,function Ze(Le,qe){var kt,jt,Hn,hr,tt=Le.lastInterval||qe,dt=qe.timeStamp-tt.timeStamp;if(8!=qe.eventType&&(dt>25||tt.velocity===S)){var gr=qe.deltaX-tt.deltaX,no=qe.deltaY-tt.deltaY,vs=It(dt,gr,no);jt=vs.x,Hn=vs.y,kt=F(vs.x)>F(vs.y)?vs.x:vs.y,hr=hn(gr,no),Le.lastInterval=qe}else kt=tt.velocity,jt=tt.velocityX,Hn=tt.velocityY,hr=tt.direction;qe.velocity=kt,qe.velocityX=jt,qe.velocityY=Hn,qe.direction=hr}(tt,qe);var vs=Le.element;A(qe.srcEvent.target,vs)&&(vs=qe.srcEvent.target),qe.target=vs}(Le,tt),Le.emit("hammer.input",tt),Le.recognize(tt),Le.session.prevInput=tt}function lt(Le){for(var qe=[],tt=0;tt<Le.pointers.length;)qe[tt]={clientX:j(Le.pointers[tt].clientX),clientY:j(Le.pointers[tt].clientY)},tt++;return{timeStamp:Z(),pointers:qe,center:Et(qe),deltaX:Le.deltaX,deltaY:Le.deltaY}}function Et(Le){var qe=Le.length;if(1===qe)return{x:j(Le[0].clientX),y:j(Le[0].clientY)};for(var tt=0,dt=0,kt=0;kt<qe;)tt+=Le[kt].clientX,dt+=Le[kt].clientY,kt++;return{x:j(tt/qe),y:j(dt/qe)}}function It(Le,qe,tt){return{x:qe/Le||0,y:tt/Le||0}}function hn(Le,qe){return Le===qe?1:F(Le)>=F(qe)?Le<0?2:4:qe<0?8:16}function nn(Le,qe,tt){tt||(tt=Ee);var dt=qe[tt[0]]-Le[tt[0]],kt=qe[tt[1]]-Le[tt[1]];return Math.sqrt(dt*dt+kt*kt)}function Bn(Le,qe,tt){return tt||(tt=Ee),180*Math.atan2(qe[tt[1]]-Le[tt[1]],qe[tt[0]]-Le[tt[0]])/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&U(this.element,this.evEl,this.domHandler),this.evTarget&&U(this.target,this.evTarget,this.domHandler),this.evWin&&U(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(_(this.element),this.evWin,this.domHandler)}};var Hs={mousedown:1,mousemove:2,mouseup:4},Tl="mousedown",$c="mousemove mouseup";function Qo(){this.evEl=Tl,this.evWin=$c,this.pressed=!1,V.apply(this,arguments)}Q(Qo,V,{handler:function(qe){var tt=Hs[qe.type];1&tt&&0===qe.button&&(this.pressed=!0),2&tt&&1!==qe.which&&(tt=4),this.pressed&&(4&tt&&(this.pressed=!1),this.callback(this.manager,tt,{pointers:[qe],changedPointers:[qe],pointerType:x,srcEvent:qe}))}});var Sl={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},yd={2:p,3:"pen",4:x,5:"kinect"},Jc="pointerdown",Cd="pointermove pointerup pointercancel";function eu(){this.evEl=Jc,this.evWin=Cd,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}T.MSPointerEvent&&!T.PointerEvent&&(Jc="MSPointerDown",Cd="MSPointerMove MSPointerUp MSPointerCancel"),Q(eu,V,{handler:function(qe){var tt=this.store,dt=!1,kt=qe.type.toLowerCase().replace("ms",""),jt=Sl[kt],Hn=yd[qe.pointerType]||qe.pointerType,hr=Hn==p,gr=z(tt,qe.pointerId,"pointerId");1&jt&&(0===qe.button||hr)?gr<0&&(tt.push(qe),gr=tt.length-1):12&jt&&(dt=!0),!(gr<0)&&(tt[gr]=qe,this.callback(this.manager,jt,{pointers:tt,changedPointers:[qe],pointerType:Hn,srcEvent:qe}),dt&&tt.splice(gr,1))}});var Mo={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Og="touchstart",jf="touchstart touchmove touchend touchcancel";function Gf(){this.evTarget=Og,this.evWin=jf,this.started=!1,V.apply(this,arguments)}function Bg(Le,qe){var tt=ie(Le.touches),dt=ie(Le.changedTouches);return 12&qe&&(tt=M(tt.concat(dt),"identifier",!0)),[tt,dt]}Q(Gf,V,{handler:function(qe){var tt=Mo[qe.type];if(1===tt&&(this.started=!0),this.started){var dt=Bg.call(this,qe,tt);12&tt&&dt[0].length-dt[1].length==0&&(this.started=!1),this.callback(this.manager,tt,{pointers:dt[0],changedPointers:dt[1],pointerType:p,srcEvent:qe})}}});var qf={touchstart:1,touchmove:2,touchend:4,touchcancel:8},xd="touchstart touchmove touchend touchcancel";function tu(){this.evTarget=xd,this.targetIds={},V.apply(this,arguments)}function Jo(Le,qe){var tt=ie(Le.touches),dt=this.targetIds;if(3&qe&&1===tt.length)return dt[tt[0].identifier]=!0,[tt,tt];var kt,jt,Hn=ie(Le.changedTouches),hr=[],gr=this.target;if(jt=tt.filter(function(no){return A(no.target,gr)}),1===qe)for(kt=0;kt<jt.length;)dt[jt[kt].identifier]=!0,kt++;for(kt=0;kt<Hn.length;)dt[Hn[kt].identifier]&&hr.push(Hn[kt]),12&qe&&delete dt[Hn[kt].identifier],kt++;return hr.length?[M(jt.concat(hr),"identifier",!0),hr]:void 0}function nu(){V.apply(this,arguments);var Le=k(this.handler,this);this.touch=new tu(this.manager,Le),this.mouse=new Qo(this.manager,Le),this.primaryTouch=null,this.lastTouches=[]}function wd(Le,qe){1&Le?(this.primaryTouch=qe.changedPointers[0].identifier,zg.call(this,qe)):12&Le&&zg.call(this,qe)}function zg(Le){var qe=Le.changedPointers[0];if(qe.identifier===this.primaryTouch){var tt={x:qe.clientX,y:qe.clientY};this.lastTouches.push(tt);var dt=this.lastTouches;setTimeout(function(){var jt=dt.indexOf(tt);jt>-1&&dt.splice(jt,1)},2500)}}function Ug(Le){for(var qe=Le.srcEvent.clientX,tt=Le.srcEvent.clientY,dt=0;dt<this.lastTouches.length;dt++){var kt=this.lastTouches[dt],jt=Math.abs(qe-kt.x),Hn=Math.abs(tt-kt.y);if(jt<=25&&Hn<=25)return!0}return!1}Q(tu,V,{handler:function(qe){var tt=qf[qe.type],dt=Jo.call(this,qe,tt);!dt||this.callback(this.manager,tt,{pointers:dt[0],changedPointers:dt[1],pointerType:p,srcEvent:qe})}}),Q(nu,V,{handler:function(qe,tt,dt){var jt=dt.pointerType==x;if(!(jt&&dt.sourceCapabilities&&dt.sourceCapabilities.firesTouchEvents)){if(dt.pointerType==p)wd.call(this,tt,dt);else if(jt&&Ug.call(this,dt))return;this.callback(qe,tt,dt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ed=ge(D.style,"touchAction"),iu=Ed!==S,Dl="compute",Td="manipulation",ha="none",kl="pan-x",bc="pan-y",ru=function yc(){if(!iu)return!1;var Le={},qe=T.CSS&&T.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(tt){Le[tt]=!qe||T.CSS.supports("touch-action",tt)}),Le}();function Ml(Le,qe){this.manager=Le,this.set(qe)}function Zn(Le){this.options=le({},this.defaults,Le||{}),this.id=function O(){return B++}(),this.manager=null,this.options.enable=te(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function su(Le){return 16&Le?"cancel":8&Le?"end":4&Le?"move":2&Le?"start":""}function ci(Le){return 16==Le?"down":8==Le?"up":2==Le?"left":4==Le?"right":""}function Za(Le,qe){var tt=qe.manager;return tt?tt.get(Le):Le}function Ro(){Zn.apply(this,arguments)}function ri(){Ro.apply(this,arguments),this.pX=null,this.pY=null}function Dn(){Ro.apply(this,arguments)}function au(){Zn.apply(this,arguments),this._timer=null,this._input=null}function Sd(){Ro.apply(this,arguments)}function Vt(){Ro.apply(this,arguments)}function Ya(){Zn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function _n(Le,qe){return(qe=qe||{}).recognizers=te(qe.recognizers,_n.defaults.preset),new lu(Le,qe)}function lu(Le,qe){this.options=le({},_n.defaults,qe||{}),this.options.inputTarget=this.options.inputTarget||Le,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Le,this.input=function $e(Le){return new(Le.options.inputClass||(h?eu:d?tu:c?nu:Qo))(Le,Te)}(this),this.touchAction=new Ml(this,this.options.touchAction),Vg(this,!0),P(this.options.recognizers,function(tt){var dt=this.add(new tt[0](tt[1]));tt[2]&&dt.recognizeWith(tt[2]),tt[3]&&dt.requireFailure(tt[3])},this)}function Vg(Le,qe){var dt,tt=Le.element;tt.style&&(P(Le.options.cssProps,function(kt,jt){dt=ge(tt.style,jt),qe?(Le.oldCssProps[dt]=tt.style[dt],tt.style[dt]=kt):tt.style[dt]=Le.oldCssProps[dt]||""}),qe||(Le.oldCssProps={}))}Ml.prototype={set:function(Le){Le==Dl&&(Le=this.compute()),iu&&this.manager.element.style&&ru[Le]&&(this.manager.element.style[Ed]=Le),this.actions=Le.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Le=[];return P(this.manager.recognizers,function(qe){N(qe.options.enable,[qe])&&(Le=Le.concat(qe.getTouchAction()))}),function Hg(Le){if(y(Le,ha))return ha;var qe=y(Le,kl),tt=y(Le,bc);return qe&&tt?ha:qe||tt?qe?kl:bc:y(Le,Td)?Td:"auto"}(Le.join(" "))},preventDefaults:function(Le){var qe=Le.srcEvent,tt=Le.offsetDirection;if(!this.manager.session.prevented){var dt=this.actions,kt=y(dt,ha)&&!ru[ha],jt=y(dt,bc)&&!ru[bc],Hn=y(dt,kl)&&!ru[kl];if(kt&&1===Le.pointers.length&&Le.distance<2&&Le.deltaTime<250)return;return Hn&&jt||!(kt||jt&&6&tt||Hn&&24&tt)?void 0:this.preventSrc(qe)}qe.preventDefault()},preventSrc:function(Le){this.manager.session.prevented=!0,Le.preventDefault()}},Zn.prototype={defaults:{},set:function(Le){return le(this.options,Le),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Le){if(K(Le,"recognizeWith",this))return this;var qe=this.simultaneous;return qe[(Le=Za(Le,this)).id]||(qe[Le.id]=Le,Le.recognizeWith(this)),this},dropRecognizeWith:function(Le){return K(Le,"dropRecognizeWith",this)||(Le=Za(Le,this),delete this.simultaneous[Le.id]),this},requireFailure:function(Le){if(K(Le,"requireFailure",this))return this;var qe=this.requireFail;return-1===z(qe,Le=Za(Le,this))&&(qe.push(Le),Le.requireFailure(this)),this},dropRequireFailure:function(Le){if(K(Le,"dropRequireFailure",this))return this;Le=Za(Le,this);var qe=z(this.requireFail,Le);return qe>-1&&this.requireFail.splice(qe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Le){return!!this.simultaneous[Le.id]},emit:function(Le){var qe=this,tt=this.state;function dt(kt){qe.manager.emit(kt,Le)}tt<8&&dt(qe.options.event+su(tt)),dt(qe.options.event),Le.additionalEvent&&dt(Le.additionalEvent),tt>=8&&dt(qe.options.event+su(tt))},tryEmit:function(Le){if(this.canEmit())return this.emit(Le);this.state=32},canEmit:function(){for(var Le=0;Le<this.requireFail.length;){if(!(33&this.requireFail[Le].state))return!1;Le++}return!0},recognize:function(Le){var qe=le({},Le);if(!N(this.options.enable,[this,qe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(qe),30&this.state&&this.tryEmit(qe)},process:function(Le){},getTouchAction:function(){},reset:function(){}},Q(Ro,Zn,{defaults:{pointers:1},attrTest:function(Le){var qe=this.options.pointers;return 0===qe||Le.pointers.length===qe},process:function(Le){var qe=this.state,tt=Le.eventType,dt=6&qe,kt=this.attrTest(Le);return dt&&(8&tt||!kt)?16|qe:dt||kt?4&tt?8|qe:2&qe?4|qe:2:32}}),Q(ri,Ro,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Le=this.options.direction,qe=[];return 6&Le&&qe.push(bc),24&Le&&qe.push(kl),qe},directionTest:function(Le){var qe=this.options,tt=!0,dt=Le.distance,kt=Le.direction,jt=Le.deltaX,Hn=Le.deltaY;return kt&qe.direction||(6&qe.direction?(kt=0===jt?1:jt<0?2:4,tt=jt!=this.pX,dt=Math.abs(Le.deltaX)):(kt=0===Hn?1:Hn<0?8:16,tt=Hn!=this.pY,dt=Math.abs(Le.deltaY))),Le.direction=kt,tt&&dt>qe.threshold&&kt&qe.direction},attrTest:function(Le){return Ro.prototype.attrTest.call(this,Le)&&(2&this.state||!(2&this.state)&&this.directionTest(Le))},emit:function(Le){this.pX=Le.deltaX,this.pY=Le.deltaY;var qe=ci(Le.direction);qe&&(Le.additionalEvent=this.options.event+qe),this._super.emit.call(this,Le)}}),Q(Dn,Ro,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ha]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.scale-1)>this.options.threshold||2&this.state)},emit:function(Le){1!==Le.scale&&(Le.additionalEvent=this.options.event+(Le.scale<1?"in":"out")),this._super.emit.call(this,Le)}}),Q(au,Zn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Le){var qe=this.options,tt=Le.pointers.length===qe.pointers,dt=Le.distance<qe.threshold,kt=Le.deltaTime>qe.time;if(this._input=Le,!dt||!tt||12&Le.eventType&&!kt)this.reset();else if(1&Le.eventType)this.reset(),this._timer=X(function(){this.state=8,this.tryEmit()},qe.time,this);else if(4&Le.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Le){8===this.state&&(Le&&4&Le.eventType?this.manager.emit(this.options.event+"up",Le):(this._input.timeStamp=Z(),this.manager.emit(this.options.event,this._input)))}}),Q(Sd,Ro,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ha]},attrTest:function(Le){return this._super.attrTest.call(this,Le)&&(Math.abs(Le.rotation)>this.options.threshold||2&this.state)}}),Q(Vt,Ro,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ri.prototype.getTouchAction.call(this)},attrTest:function(Le){var tt,qe=this.options.direction;return 30&qe?tt=Le.overallVelocity:6&qe?tt=Le.overallVelocityX:24&qe&&(tt=Le.overallVelocityY),this._super.attrTest.call(this,Le)&&qe&Le.offsetDirection&&Le.distance>this.options.threshold&&Le.maxPointers==this.options.pointers&&F(tt)>this.options.velocity&&4&Le.eventType},emit:function(Le){var qe=ci(Le.offsetDirection);qe&&this.manager.emit(this.options.event+qe,Le),this.manager.emit(this.options.event,Le)}}),Q(Ya,Zn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Td]},process:function(Le){var qe=this.options,tt=Le.pointers.length===qe.pointers,dt=Le.distance<qe.threshold,kt=Le.deltaTime<qe.time;if(this.reset(),1&Le.eventType&&0===this.count)return this.failTimeout();if(dt&&kt&&tt){if(4!=Le.eventType)return this.failTimeout();var jt=!this.pTime||Le.timeStamp-this.pTime<qe.interval,Hn=!this.pCenter||nn(this.pCenter,Le.center)<qe.posThreshold;if(this.pTime=Le.timeStamp,this.pCenter=Le.center,Hn&&jt?this.count+=1:this.count=1,this._input=Le,0==this.count%qe.taps)return this.hasRequireFailures()?(this._timer=X(function(){this.state=8,this.tryEmit()},qe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=X(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),_n.VERSION="2.0.7",_n.defaults={domEvents:!1,touchAction:Dl,enable:!0,inputTarget:null,inputClass:null,preset:[[Sd,{enable:!1}],[Dn,{enable:!1},["rotate"]],[Vt,{direction:6}],[ri,{direction:6},["swipe"]],[Ya],[Ya,{event:"doubletap",taps:2},["tap"]],[au]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},lu.prototype={set:function(Le){return le(this.options,Le),Le.touchAction&&this.touchAction.update(),Le.inputTarget&&(this.input.destroy(),this.input.target=Le.inputTarget,this.input.init()),this},stop:function(Le){this.session.stopped=Le?2:1},recognize:function(Le){var qe=this.session;if(!qe.stopped){this.touchAction.preventDefaults(Le);var tt,dt=this.recognizers,kt=qe.curRecognizer;(!kt||kt&&8&kt.state)&&(kt=qe.curRecognizer=null);for(var jt=0;jt<dt.length;)tt=dt[jt],2===qe.stopped||kt&&tt!=kt&&!tt.canRecognizeWith(kt)?tt.reset():tt.recognize(Le),!kt&&14&tt.state&&(kt=qe.curRecognizer=tt),jt++}},get:function(Le){if(Le instanceof Zn)return Le;for(var qe=this.recognizers,tt=0;tt<qe.length;tt++)if(qe[tt].options.event==Le)return qe[tt];return null},add:function(Le){if(K(Le,"add",this))return this;var qe=this.get(Le.options.event);return qe&&this.remove(qe),this.recognizers.push(Le),Le.manager=this,this.touchAction.update(),Le},remove:function(Le){if(K(Le,"remove",this))return this;if(Le=this.get(Le)){var qe=this.recognizers,tt=z(qe,Le);-1!==tt&&(qe.splice(tt,1),this.touchAction.update())}return this},on:function(Le,qe){if(Le!==S&&qe!==S){var tt=this.handlers;return P(R(Le),function(dt){tt[dt]=tt[dt]||[],tt[dt].push(qe)}),this}},off:function(Le,qe){if(Le!==S){var tt=this.handlers;return P(R(Le),function(dt){qe?tt[dt]&&tt[dt].splice(z(tt[dt],qe),1):delete tt[dt]}),this}},emit:function(Le,qe){this.options.domEvents&&function Cc(Le,qe){var tt=ne.createEvent("Event");tt.initEvent(Le,!0,!0),tt.gesture=qe,qe.target.dispatchEvent(tt)}(Le,qe);var tt=this.handlers[Le]&&this.handlers[Le].slice();if(tt&&tt.length){qe.type=Le,qe.preventDefault=function(){qe.srcEvent.preventDefault()};for(var dt=0;dt<tt.length;)tt[dt](qe),dt++}},destroy:function(){this.element&&Vg(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},le(_n,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:lu,Input:V,TouchAction:Ml,TouchInput:tu,MouseInput:Qo,PointerEventInput:eu,TouchMouseInput:nu,SingleTouchInput:Gf,Recognizer:Zn,AttrRecognizer:Ro,Tap:Ya,Pan:ri,Swipe:Vt,Pinch:Dn,Rotate:Sd,Press:au,on:U,off:I,each:P,merge:Y,extend:q,assign:le,inherit:Q,bindFn:k,prefixed:ge}),(void 0!==T?T:"undefined"!=typeof self?self:{}).Hammer=_n,(f=function(){return _n}.call(de,ye,de,E))!==S&&(E.exports=f)}(window,document)},8461:(E,de)=>{de.read=function(ye,f,T,ne,v){var S,L,D=8*v-ne-1,J=(1<<D)-1,j=J>>1,F=-7,Z=T?v-1:0,X=T?-1:1,K=ye[f+Z];for(Z+=X,S=K&(1<<-F)-1,K>>=-F,F+=D;F>0;S=256*S+ye[f+Z],Z+=X,F-=8);for(L=S&(1<<-F)-1,S>>=-F,F+=ne;F>0;L=256*L+ye[f+Z],Z+=X,F-=8);if(0===S)S=1-j;else{if(S===J)return L?NaN:1/0*(K?-1:1);L+=Math.pow(2,ne),S-=j}return(K?-1:1)*L*Math.pow(2,S-ne)},de.write=function(ye,f,T,ne,v,S){var L,D,J,j=8*S-v-1,F=(1<<j)-1,Z=F>>1,X=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,K=ne?0:S-1,P=ne?1:-1,H=f<0||0===f&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(D=isNaN(f)?1:0,L=F):(L=Math.floor(Math.log(f)/Math.LN2),f*(J=Math.pow(2,-L))<1&&(L--,J*=2),(f+=L+Z>=1?X/J:X*Math.pow(2,1-Z))*J>=2&&(L++,J/=2),L+Z>=F?(D=0,L=F):L+Z>=1?(D=(f*J-1)*Math.pow(2,v),L+=Z):(D=f*Math.pow(2,Z-1)*Math.pow(2,v),L=0));v>=8;ye[T+K]=255&D,K+=P,D/=256,v-=8);for(L=L<<v|D,j+=v;j>0;ye[T+K]=255&L,K+=P,L/=256,j-=8);ye[T+K-P]|=128*H}},6256:function(E,de){!function(v){var K,S="undefined",L=S!==typeof Buffer&&Buffer,D=S!==typeof Uint8Array&&Uint8Array,J=S!==typeof ArrayBuffer&&ArrayBuffer,j=[0,0,0,0,0,0,0,0],F=Array.isArray||function A(y){return!!y&&"[object Array]"==Object.prototype.toString.call(y)},Z=4294967296;function P(y,R,z){var ie=R?0:4,M=R?4:0,ge=R?0:3,B=R?1:2,O=R?2:1,_=R?3:0,l=R?N:U,c=R?te:I,h=m.prototype,d="is"+y,p="_"+d;return h.buffer=void 0,h.offset=0,h[p]=!0,h.toNumber=se,h.toString=function De(Pe){var be=this.buffer,xe=this.offset,pe=fe(be,xe+ie),Me=fe(be,xe+M),Ce="",ae=!z&&2147483648&pe;for(ae&&(pe=~pe,Me=Z-Me),Pe=Pe||10;;){var he=pe%Pe*Z+Me;if(pe=Math.floor(pe/Pe),Me=Math.floor(he/Pe),Ce=(he%Pe).toString(Pe)+Ce,!pe&&!Me)break}return ae&&(Ce="-"+Ce),Ce},h.toJSON=se,h.toArray=H,L&&(h.toBuffer=le),D&&(h.toArrayBuffer=q),m[d]=function x(Pe){return!(!Pe||!Pe[p])},v[y]=m,m;function m(Pe,be,xe,pe){return this instanceof m?function $(Pe,be,xe,pe,Me){D&&J&&(be instanceof J&&(be=new D(be)),pe instanceof J&&(pe=new D(pe))),be||xe||pe||K?(Y(be,xe)||(Me=xe,pe=be,xe=0,be=new(K||Array)(8)),Pe.buffer=be,Pe.offset=xe|=0,S!==typeof pe&&("string"==typeof pe?function re(Pe,be,xe,pe){var Me=0,Ce=xe.length,ae=0,he=0;"-"===xe[0]&&Me++;for(var Ee=Me;Me<Ce;){var C=parseInt(xe[Me++],pe);if(!(C>=0))break;he=he*pe+C,ae=ae*pe+Math.floor(he/Z),he%=Z}Ee&&(ae=~ae,he?he=Z-he:ae++),Ae(Pe,be+ie,ae),Ae(Pe,be+M,he)}(be,xe,pe,Me||10):Y(pe,Me)?Q(be,xe,pe,Me):"number"==typeof Me?(Ae(be,xe+ie,pe),Ae(be,xe+M,Me)):pe>0?l(be,xe,pe):pe<0?c(be,xe,pe):Q(be,xe,j,0))):Pe.buffer=k(j,0)}(this,Pe,be,xe,pe):new m(Pe,be,xe,pe)}function se(){var Pe=this.buffer,be=this.offset,xe=fe(Pe,be+ie),pe=fe(Pe,be+M);return z||(xe|=0),xe?xe*Z+pe:pe}function Ae(Pe,be,xe){Pe[be+_]=255&xe,Pe[be+O]=255&(xe>>=8),Pe[be+B]=255&(xe>>=8),Pe[be+ge]=255&(xe>>=8)}function fe(Pe,be){return 16777216*Pe[be+ge]+(Pe[be+B]<<16)+(Pe[be+O]<<8)+Pe[be+_]}}function H(y){var R=this.buffer,z=this.offset;return K=null,!1!==y&&0===z&&8===R.length&&F(R)?R:k(R,z)}function le(y){var R=this.buffer,z=this.offset;if(K=L,!1!==y&&0===z&&8===R.length&&Buffer.isBuffer(R))return R;var ie=new L(8);return Q(ie,0,R,z),ie}function q(y){var R=this.buffer,z=this.offset,ie=R.buffer;if(K=D,!1!==y&&0===z&&ie instanceof J&&8===ie.byteLength)return ie;var M=new D(8);return Q(M,0,R,z),M.buffer}function Y(y,R){var z=y&&y.length;return R|=0,z&&R+8<=z&&"string"!=typeof y[R]}function Q(y,R,z,ie){R|=0,ie|=0;for(var M=0;M<8;M++)y[R++]=255&z[ie++]}function k(y,R){return Array.prototype.slice.call(y,R,R+8)}function N(y,R,z){for(var ie=R+8;ie>R;)y[--ie]=255&z,z/=256}function te(y,R,z){var ie=R+8;for(z++;ie>R;)y[--ie]=255&-z^255,z/=256}function U(y,R,z){for(var ie=R+8;R<ie;)y[R++]=255&z,z/=256}function I(y,R,z){var ie=R+8;for(z++;R<ie;)y[R++]=255&-z^255,z/=256}P("Uint64BE",!0,!0),P("Int64BE",!0,!1),P("Uint64LE",!1,!0),P("Int64LE",!1,!1)}("string"!=typeof de.nodeName?de:this||{})},6425:E=>{var de={}.toString;E.exports=Array.isArray||function(ye){return"[object Array]"==de.call(ye)}},5650:E=>{E.exports=function de(ye,f,T){function ne(L,D){if(!f[L]){if(!ye[L]){if(v)return v(L,!0);var j=new Error("Cannot find module '"+L+"'");throw j.code="MODULE_NOT_FOUND",j}var F=f[L]={exports:{}};ye[L][0].call(F.exports,function(Z){return ne(ye[L][1][Z]||Z)},F,F.exports,de,ye,f,T)}return f[L].exports}for(var v=void 0,S=0;S<T.length;S++)ne(T[S]);return ne}({1:[function(de,ye,f){"use strict";var T=de("./utils"),ne=de("./support"),v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(S){for(var L,D,J,F,Z,X,K=[],P=0,H=S.length,le=H,q="string"!==T.getTypeOf(S);P<S.length;)le=H-P,J=q?(L=S[P++],D=P<H?S[P++]:0,P<H?S[P++]:0):(L=S.charCodeAt(P++),D=P<H?S.charCodeAt(P++):0,P<H?S.charCodeAt(P++):0),F=(3&L)<<4|D>>4,Z=1<le?(15&D)<<2|J>>6:64,X=2<le?63&J:64,K.push(v.charAt(L>>2)+v.charAt(F)+v.charAt(Z)+v.charAt(X));return K.join("")},f.decode=function(S){var L,D,J,j,F,Z,X=0,K=0,P="data:";if(S.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var H,le=3*(S=S.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(S.charAt(S.length-1)===v.charAt(64)&&le--,S.charAt(S.length-2)===v.charAt(64)&&le--,le%1!=0)throw new Error("Invalid base64 input, bad content length.");for(H=ne.uint8array?new Uint8Array(0|le):new Array(0|le);X<S.length;)L=v.indexOf(S.charAt(X++))<<2|(j=v.indexOf(S.charAt(X++)))>>4,D=(15&j)<<4|(F=v.indexOf(S.charAt(X++)))>>2,J=(3&F)<<6|(Z=v.indexOf(S.charAt(X++))),H[K++]=L,64!==F&&(H[K++]=D),64!==Z&&(H[K++]=J);return H}},{"./support":30,"./utils":32}],2:[function(de,ye,f){"use strict";var T=de("./external"),ne=de("./stream/DataWorker"),v=de("./stream/Crc32Probe"),S=de("./stream/DataLengthProbe");function L(D,J,j,F,Z){this.compressedSize=D,this.uncompressedSize=J,this.crc32=j,this.compression=F,this.compressedContent=Z}L.prototype={getContentWorker:function(){var D=new ne(T.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new S("data_length")),J=this;return D.on("end",function(){if(this.streamInfo.data_length!==J.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new ne(T.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},L.createWorkerFrom=function(D,J,j){return D.pipe(new v).pipe(new S("uncompressedSize")).pipe(J.compressWorker(j)).pipe(new S("compressedSize")).withStreamInfo("compression",J)},ye.exports=L},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(de,ye,f){"use strict";var T=de("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(ne){return new T("STORE compression")},uncompressWorker:function(){return new T("STORE decompression")}},f.DEFLATE=de("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(de,ye,f){"use strict";var T=de("./utils"),ne=function(){for(var v,S=[],L=0;L<256;L++){v=L;for(var D=0;D<8;D++)v=1&v?3988292384^v>>>1:v>>>1;S[L]=v}return S}();ye.exports=function(v,S){return void 0!==v&&v.length?"string"!==T.getTypeOf(v)?function(L,D,J,j){var F=ne,Z=0+J;L^=-1;for(var X=0;X<Z;X++)L=L>>>8^F[255&(L^D[X])];return-1^L}(0|S,v,v.length):function(L,D,J,j){var F=ne,Z=0+J;L^=-1;for(var X=0;X<Z;X++)L=L>>>8^F[255&(L^D.charCodeAt(X))];return-1^L}(0|S,v,v.length):0}},{"./utils":32}],5:[function(de,ye,f){"use strict";f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(de,ye,f){"use strict";var T;T="undefined"!=typeof Promise?Promise:de("lie"),ye.exports={Promise:T}},{lie:37}],7:[function(de,ye,f){"use strict";var T="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,ne=de("pako"),v=de("./utils"),S=de("./stream/GenericWorker"),L=T?"uint8array":"array";function D(J,j){S.call(this,"FlateWorker/"+J),this._pako=null,this._pakoAction=J,this._pakoOptions=j,this.meta={}}f.magic="\b\0",v.inherits(D,S),D.prototype.processChunk=function(J){this.meta=J.meta,null===this._pako&&this._createPako(),this._pako.push(v.transformTo(L,J.data),!1)},D.prototype.flush=function(){S.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){S.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new ne[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var J=this;this._pako.onData=function(j){J.push({data:j,meta:J.meta})}},f.compressWorker=function(J){return new D("Deflate",J)},f.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(de,ye,f){"use strict";function T(F,Z){var X,K="";for(X=0;X<Z;X++)K+=String.fromCharCode(255&F),F>>>=8;return K}function ne(F,Z,X,K,P,H){var le,q,Y=F.file,Q=F.compression,k=H!==L.utf8encode,N=v.transformTo("string",H(Y.name)),te=v.transformTo("string",L.utf8encode(Y.name)),U=Y.comment,I=v.transformTo("string",H(U)),A=v.transformTo("string",L.utf8encode(U)),y=te.length!==Y.name.length,R=A.length!==U.length,z="",ie="",M="",ge=Y.dir,B=Y.date,O={crc32:0,compressedSize:0,uncompressedSize:0};Z&&!X||(O.crc32=F.crc32,O.compressedSize=F.compressedSize,O.uncompressedSize=F.uncompressedSize);var _=0;Z&&(_|=8),k||!y&&!R||(_|=2048);var d,m,l=0,c=0;ge&&(l|=16),"UNIX"===P?(c=798,l|=(m=d=Y.unixPermissions,d||(m=ge?16893:33204),(65535&m)<<16)):(c=20,l|=function(d){return 63&(d||0)}(Y.dosPermissions)),le=B.getUTCHours(),le<<=6,le|=B.getUTCMinutes(),le<<=5,le|=B.getUTCSeconds()/2,q=B.getUTCFullYear()-1980,q<<=4,q|=B.getUTCMonth()+1,q<<=5,q|=B.getUTCDate(),y&&(ie=T(1,1)+T(D(N),4)+te,z+="up"+T(ie.length,2)+ie),R&&(M=T(1,1)+T(D(I),4)+A,z+="uc"+T(M.length,2)+M);var h="";return h+="\n\0",h+=T(_,2),h+=Q.magic,h+=T(le,2),h+=T(q,2),h+=T(O.crc32,4),h+=T(O.compressedSize,4),h+=T(O.uncompressedSize,4),h+=T(N.length,2),h+=T(z.length,2),{fileRecord:J.LOCAL_FILE_HEADER+h+N+z,dirRecord:J.CENTRAL_FILE_HEADER+T(c,2)+h+T(I.length,2)+"\0\0\0\0"+T(l,4)+T(K,4)+N+z+I}}var v=de("../utils"),S=de("../stream/GenericWorker"),L=de("../utf8"),D=de("../crc32"),J=de("../signature");function j(F,Z,X,K){S.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Z,this.zipPlatform=X,this.encodeFileName=K,this.streamFiles=F,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}v.inherits(j,S),j.prototype.push=function(F){var Z=F.meta.percent||0,X=this.entriesCount,K=this._sources.length;this.accumulate?this.contentBuffer.push(F):(this.bytesWritten+=F.data.length,S.prototype.push.call(this,{data:F.data,meta:{currentFile:this.currentFile,percent:X?(Z+100*(X-K-1))/X:100}}))},j.prototype.openedSource=function(F){this.currentSourceOffset=this.bytesWritten,this.currentFile=F.file.name;var Z=this.streamFiles&&!F.file.dir;if(Z){var X=ne(F,Z,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:X.fileRecord,meta:{percent:0}})}else this.accumulate=!0},j.prototype.closedSource=function(F){this.accumulate=!1;var K,Z=this.streamFiles&&!F.file.dir,X=ne(F,Z,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(X.dirRecord),Z)this.push({data:(K=F,J.DATA_DESCRIPTOR+T(K.crc32,4)+T(K.compressedSize,4)+T(K.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:X.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},j.prototype.flush=function(){for(var F=this.bytesWritten,Z=0;Z<this.dirRecords.length;Z++)this.push({data:this.dirRecords[Z],meta:{percent:100}});var P,H,le,Q,K=(P=this.dirRecords.length,H=this.bytesWritten-F,le=F,Q=v.transformTo("string",(0,this.encodeFileName)(this.zipComment)),J.CENTRAL_DIRECTORY_END+"\0\0\0\0"+T(P,2)+T(P,2)+T(H,4)+T(le,4)+T(Q.length,2)+Q);this.push({data:K,meta:{percent:100}})},j.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},j.prototype.registerPrevious=function(F){this._sources.push(F);var Z=this;return F.on("data",function(X){Z.processChunk(X)}),F.on("end",function(){Z.closedSource(Z.previous.streamInfo),Z._sources.length?Z.prepareNextSource():Z.end()}),F.on("error",function(X){Z.error(X)}),this},j.prototype.resume=function(){return!!S.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},j.prototype.error=function(F){var Z=this._sources;if(!S.prototype.error.call(this,F))return!1;for(var X=0;X<Z.length;X++)try{Z[X].error(F)}catch(K){}return!0},j.prototype.lock=function(){S.prototype.lock.call(this);for(var F=this._sources,Z=0;Z<F.length;Z++)F[Z].lock()},ye.exports=j},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(de,ye,f){"use strict";var T=de("../compressions"),ne=de("./ZipFileWorker");f.generateWorker=function(v,S,L){var D=new ne(S.streamFiles,L,S.platform,S.encodeFileName),J=0;try{v.forEach(function(j,F){J++;var Z=function(H,le){var q=H||le,Y=T[q];if(!Y)throw new Error(q+" is not a valid compression method !");return Y}(F.options.compression,S.compression),K=F.dir,P=F.date;F._compressWorker(Z,F.options.compressionOptions||S.compressionOptions||{}).withStreamInfo("file",{name:j,dir:K,date:P,comment:F.comment||"",unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions}).pipe(D)}),D.entriesCount=J}catch(j){D.error(j)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(de,ye,f){"use strict";function T(){if(!(this instanceof T))return new T;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var ne=new T;for(var v in this)"function"!=typeof this[v]&&(ne[v]=this[v]);return ne}}(T.prototype=de("./object")).loadAsync=de("./load"),T.support=de("./support"),T.defaults=de("./defaults"),T.version="3.8.0",T.loadAsync=function(ne,v){return(new T).loadAsync(ne,v)},T.external=de("./external"),ye.exports=T},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(de,ye,f){"use strict";var T=de("./utils"),ne=de("./external"),v=de("./utf8"),S=de("./zipEntries"),L=de("./stream/Crc32Probe"),D=de("./nodejsUtils");function J(j){return new ne.Promise(function(F,Z){var X=j.decompressed.getContentWorker().pipe(new L);X.on("error",function(K){Z(K)}).on("end",function(){X.streamInfo.crc32!==j.decompressed.crc32?Z(new Error("Corrupted zip : CRC32 mismatch")):F()}).resume()})}ye.exports=function(j,F){var Z=this;return F=T.extend(F||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:v.utf8decode}),D.isNode&&D.isStream(j)?ne.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):T.prepareContent("the loaded zip file",j,!0,F.optimizedBinaryString,F.base64).then(function(X){var K=new S(F);return K.load(X),K}).then(function(X){var K=[ne.Promise.resolve(X)],P=X.files;if(F.checkCRC32)for(var H=0;H<P.length;H++)K.push(J(P[H]));return ne.Promise.all(K)}).then(function(X){for(var K=X.shift(),P=K.files,H=0;H<P.length;H++){var le=P[H],q=le.fileNameStr,Y=T.resolve(le.fileNameStr);Z.file(Y,le.decompressed,{binary:!0,optimizedBinaryString:!0,date:le.date,dir:le.dir,comment:le.fileCommentStr.length?le.fileCommentStr:null,unixPermissions:le.unixPermissions,dosPermissions:le.dosPermissions,createFolders:F.createFolders}),le.dir||(Z.file(Y).unsafeOriginalName=q)}return K.zipComment.length&&(Z.comment=K.zipComment),Z})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(de,ye,f){"use strict";var T=de("../utils"),ne=de("../stream/GenericWorker");function v(S,L){ne.call(this,"Nodejs stream input adapter for "+S),this._upstreamEnded=!1,this._bindStream(L)}T.inherits(v,ne),v.prototype._bindStream=function(S){var L=this;(this._stream=S).pause(),S.on("data",function(D){L.push({data:D,meta:{percent:0}})}).on("error",function(D){L.isPaused?this.generatedError=D:L.error(D)}).on("end",function(){L.isPaused?L._upstreamEnded=!0:L.end()})},v.prototype.pause=function(){return!!ne.prototype.pause.call(this)&&(this._stream.pause(),!0)},v.prototype.resume=function(){return!!ne.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},ye.exports=v},{"../stream/GenericWorker":28,"../utils":32}],13:[function(de,ye,f){"use strict";var T=de("readable-stream").Readable;function ne(v,S,L){T.call(this,S),this._helper=v;var D=this;v.on("data",function(J,j){D.push(J)||D._helper.pause(),L&&L(j)}).on("error",function(J){D.emit("error",J)}).on("end",function(){D.push(null)})}de("../utils").inherits(ne,T),ne.prototype._read=function(){this._helper.resume()},ye.exports=ne},{"../utils":32,"readable-stream":16}],14:[function(de,ye,f){"use strict";ye.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(T,ne){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(T,ne);if("number"==typeof T)throw new Error('The "data" argument must not be a number');return new Buffer(T,ne)},allocBuffer:function(T){if(Buffer.alloc)return Buffer.alloc(T);var ne=new Buffer(T);return ne.fill(0),ne},isBuffer:function(T){return Buffer.isBuffer(T)},isStream:function(T){return T&&"function"==typeof T.on&&"function"==typeof T.pause&&"function"==typeof T.resume}}},{}],15:[function(de,ye,f){"use strict";function T(Y,Q,k){var N,te=v.getTypeOf(Q),U=v.extend(k||{},D);U.date=U.date||new Date,null!==U.compression&&(U.compression=U.compression.toUpperCase()),"string"==typeof U.unixPermissions&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(Y=P(Y)),U.createFolders&&(N=K(Y))&&H.call(this,N,!0),k&&void 0!==k.binary||(U.binary=!("string"===te&&!1===U.binary&&!1===U.base64)),(Q instanceof J&&0===Q.uncompressedSize||U.dir||!Q||0===Q.length)&&(U.base64=!1,U.binary=!0,Q="",U.compression="STORE",te="string");var A;A=Q instanceof J||Q instanceof S?Q:Z.isNode&&Z.isStream(Q)?new X(Y,Q):v.prepareContent(Y,Q,U.binary,U.optimizedBinaryString,U.base64);var y=new j(Y,A,U);this.files[Y]=y}var ne=de("./utf8"),v=de("./utils"),S=de("./stream/GenericWorker"),L=de("./stream/StreamHelper"),D=de("./defaults"),J=de("./compressedObject"),j=de("./zipObject"),F=de("./generate"),Z=de("./nodejsUtils"),X=de("./nodejs/NodejsStreamInputAdapter"),K=function(Y){"/"===Y.slice(-1)&&(Y=Y.substring(0,Y.length-1));var Q=Y.lastIndexOf("/");return 0<Q?Y.substring(0,Q):""},P=function(Y){return"/"!==Y.slice(-1)&&(Y+="/"),Y},H=function(Y,Q){return Q=void 0!==Q?Q:D.createFolders,Y=P(Y),this.files[Y]||T.call(this,Y,null,{dir:!0,createFolders:Q}),this.files[Y]};function le(Y){return"[object RegExp]"===Object.prototype.toString.call(Y)}var q={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Y){var Q,k,N;for(Q in this.files)N=this.files[Q],(k=Q.slice(this.root.length,Q.length))&&Q.slice(0,this.root.length)===this.root&&Y(k,N)},filter:function(Y){var Q=[];return this.forEach(function(k,N){Y(k,N)&&Q.push(N)}),Q},file:function(Y,Q,k){if(1!==arguments.length)return T.call(this,Y=this.root+Y,Q,k),this;if(le(Y)){var N=Y;return this.filter(function(U,I){return!I.dir&&N.test(U)})}var te=this.files[this.root+Y];return te&&!te.dir?te:null},folder:function(Y){if(!Y)return this;if(le(Y))return this.filter(function(te,U){return U.dir&&Y.test(te)});var k=H.call(this,this.root+Y),N=this.clone();return N.root=k.name,N},remove:function(Y){var Q=this.files[Y=this.root+Y];if(Q||("/"!==Y.slice(-1)&&(Y+="/"),Q=this.files[Y]),Q&&!Q.dir)delete this.files[Y];else for(var k=this.filter(function(te,U){return U.name.slice(0,Y.length)===Y}),N=0;N<k.length;N++)delete this.files[k[N].name];return this},generate:function(Y){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Y){var Q,k={};try{if((k=v.extend(Y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:ne.utf8encode})).type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),"binarystring"===k.type&&(k.type="string"),!k.type)throw new Error("No output type specified.");v.checkSupport(k.type),"darwin"!==k.platform&&"freebsd"!==k.platform&&"linux"!==k.platform&&"sunos"!==k.platform||(k.platform="UNIX"),"win32"===k.platform&&(k.platform="DOS"),Q=F.generateWorker(this,k,k.comment||this.comment||"")}catch(te){(Q=new S("error")).error(te)}return new L(Q,k.type||"string",k.mimeType)},generateAsync:function(Y,Q){return this.generateInternalStream(Y).accumulate(Q)},generateNodeStream:function(Y,Q){return(Y=Y||{}).type||(Y.type="nodebuffer"),this.generateInternalStream(Y).toNodejsStream(Q)}};ye.exports=q},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(de,ye,f){ye.exports=de("stream")},{stream:void 0}],17:[function(de,ye,f){"use strict";var T=de("./DataReader");function ne(v){T.call(this,v);for(var S=0;S<this.data.length;S++)v[S]=255&v[S]}de("../utils").inherits(ne,T),ne.prototype.byteAt=function(v){return this.data[this.zero+v]},ne.prototype.lastIndexOfSignature=function(v){for(var S=v.charCodeAt(0),L=v.charCodeAt(1),D=v.charCodeAt(2),J=v.charCodeAt(3),j=this.length-4;0<=j;--j)if(this.data[j]===S&&this.data[j+1]===L&&this.data[j+2]===D&&this.data[j+3]===J)return j-this.zero;return-1},ne.prototype.readAndCheckSignature=function(v){var S=v.charCodeAt(0),L=v.charCodeAt(1),D=v.charCodeAt(2),J=v.charCodeAt(3),j=this.readData(4);return S===j[0]&&L===j[1]&&D===j[2]&&J===j[3]},ne.prototype.readData=function(v){if(this.checkOffset(v),0===v)return[];var S=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,S},ye.exports=ne},{"../utils":32,"./DataReader":18}],18:[function(de,ye,f){"use strict";var T=de("../utils");function ne(v){this.data=v,this.length=v.length,this.index=0,this.zero=0}ne.prototype={checkOffset:function(v){this.checkIndex(this.index+v)},checkIndex:function(v){if(this.length<this.zero+v||v<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+v+"). Corrupted zip ?")},setIndex:function(v){this.checkIndex(v),this.index=v},skip:function(v){this.setIndex(this.index+v)},byteAt:function(v){},readInt:function(v){var S,L=0;for(this.checkOffset(v),S=this.index+v-1;S>=this.index;S--)L=(L<<8)+this.byteAt(S);return this.index+=v,L},readString:function(v){return T.transformTo("string",this.readData(v))},readData:function(v){},lastIndexOfSignature:function(v){},readAndCheckSignature:function(v){},readDate:function(){var v=this.readInt(4);return new Date(Date.UTC(1980+(v>>25&127),(v>>21&15)-1,v>>16&31,v>>11&31,v>>5&63,(31&v)<<1))}},ye.exports=ne},{"../utils":32}],19:[function(de,ye,f){"use strict";var T=de("./Uint8ArrayReader");function ne(v){T.call(this,v)}de("../utils").inherits(ne,T),ne.prototype.readData=function(v){this.checkOffset(v);var S=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,S},ye.exports=ne},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(de,ye,f){"use strict";var T=de("./DataReader");function ne(v){T.call(this,v)}de("../utils").inherits(ne,T),ne.prototype.byteAt=function(v){return this.data.charCodeAt(this.zero+v)},ne.prototype.lastIndexOfSignature=function(v){return this.data.lastIndexOf(v)-this.zero},ne.prototype.readAndCheckSignature=function(v){return v===this.readData(4)},ne.prototype.readData=function(v){this.checkOffset(v);var S=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,S},ye.exports=ne},{"../utils":32,"./DataReader":18}],21:[function(de,ye,f){"use strict";var T=de("./ArrayReader");function ne(v){T.call(this,v)}de("../utils").inherits(ne,T),ne.prototype.readData=function(v){if(this.checkOffset(v),0===v)return new Uint8Array(0);var S=this.data.subarray(this.zero+this.index,this.zero+this.index+v);return this.index+=v,S},ye.exports=ne},{"../utils":32,"./ArrayReader":17}],22:[function(de,ye,f){"use strict";var T=de("../utils"),ne=de("../support"),v=de("./ArrayReader"),S=de("./StringReader"),L=de("./NodeBufferReader"),D=de("./Uint8ArrayReader");ye.exports=function(J){var j=T.getTypeOf(J);return T.checkSupport(j),"string"!==j||ne.uint8array?"nodebuffer"===j?new L(J):ne.uint8array?new D(T.transformTo("uint8array",J)):new v(T.transformTo("array",J)):new S(J)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(de,ye,f){"use strict";f.LOCAL_FILE_HEADER="PK\x03\x04",f.CENTRAL_FILE_HEADER="PK\x01\x02",f.CENTRAL_DIRECTORY_END="PK\x05\x06",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(de,ye,f){"use strict";var T=de("./GenericWorker"),ne=de("../utils");function v(S){T.call(this,"ConvertWorker to "+S),this.destType=S}ne.inherits(v,T),v.prototype.processChunk=function(S){this.push({data:ne.transformTo(this.destType,S.data),meta:S.meta})},ye.exports=v},{"../utils":32,"./GenericWorker":28}],25:[function(de,ye,f){"use strict";var T=de("./GenericWorker"),ne=de("../crc32");function v(){T.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}de("../utils").inherits(v,T),v.prototype.processChunk=function(S){this.streamInfo.crc32=ne(S.data,this.streamInfo.crc32||0),this.push(S)},ye.exports=v},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(de,ye,f){"use strict";var T=de("../utils"),ne=de("./GenericWorker");function v(S){ne.call(this,"DataLengthProbe for "+S),this.propName=S,this.withStreamInfo(S,0)}T.inherits(v,ne),v.prototype.processChunk=function(S){S&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+S.data.length),ne.prototype.processChunk.call(this,S)},ye.exports=v},{"../utils":32,"./GenericWorker":28}],27:[function(de,ye,f){"use strict";var T=de("../utils"),ne=de("./GenericWorker");function v(S){ne.call(this,"DataWorker");var L=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,S.then(function(D){L.dataIsReady=!0,L.data=D,L.max=D&&D.length||0,L.type=T.getTypeOf(D),L.isPaused||L._tickAndRepeat()},function(D){L.error(D)})}T.inherits(v,ne),v.prototype.cleanUp=function(){ne.prototype.cleanUp.call(this),this.data=null},v.prototype.resume=function(){return!!ne.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,T.delay(this._tickAndRepeat,[],this)),!0)},v.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(T.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},v.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var S=null,L=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":S=this.data.substring(this.index,L);break;case"uint8array":S=this.data.subarray(this.index,L);break;case"array":case"nodebuffer":S=this.data.slice(this.index,L)}return this.index=L,this.push({data:S,meta:{percent:this.max?this.index/this.max*100:0}})},ye.exports=v},{"../utils":32,"./GenericWorker":28}],28:[function(de,ye,f){"use strict";function T(ne){this.name=ne||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}T.prototype={push:function(ne){this.emit("data",ne)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(ne){this.emit("error",ne)}return!0},error:function(ne){return!this.isFinished&&(this.isPaused?this.generatedError=ne:(this.isFinished=!0,this.emit("error",ne),this.previous&&this.previous.error(ne),this.cleanUp()),!0)},on:function(ne,v){return this._listeners[ne].push(v),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(ne,v){if(this._listeners[ne])for(var S=0;S<this._listeners[ne].length;S++)this._listeners[ne][S].call(this,v)},pipe:function(ne){return ne.registerPrevious(this)},registerPrevious:function(ne){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=ne.streamInfo,this.mergeStreamInfo(),this.previous=ne;var v=this;return ne.on("data",function(S){v.processChunk(S)}),ne.on("end",function(){v.end()}),ne.on("error",function(S){v.error(S)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var ne=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),ne=!0),this.previous&&this.previous.resume(),!ne},flush:function(){},processChunk:function(ne){this.push(ne)},withStreamInfo:function(ne,v){return this.extraStreamInfo[ne]=v,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var ne in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(ne)&&(this.streamInfo[ne]=this.extraStreamInfo[ne])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var ne="Worker "+this.name;return this.previous?this.previous+" -> "+ne:ne}},ye.exports=T},{}],29:[function(de,ye,f){"use strict";var T=de("../utils"),ne=de("./ConvertWorker"),v=de("./GenericWorker"),S=de("../base64"),L=de("../support"),D=de("../external"),J=null;if(L.nodestream)try{J=de("../nodejs/NodejsStreamOutputAdapter")}catch(Z){}function F(Z,X,K){var P=X;switch(X){case"blob":case"arraybuffer":P="uint8array";break;case"base64":P="string"}try{this._internalType=P,this._outputType=X,this._mimeType=K,T.checkSupport(P),this._worker=Z.pipe(new ne(P)),Z.lock()}catch(H){this._worker=new v("error"),this._worker.error(H)}}F.prototype={accumulate:function(Z){return function j(Z,X){return new D.Promise(function(K,P){var H=[],le=Z._internalType,q=Z._outputType,Y=Z._mimeType;Z.on("data",function(Q,k){H.push(Q),X&&X(k)}).on("error",function(Q){H=[],P(Q)}).on("end",function(){try{var Q=function(k,N,te){switch(k){case"blob":return T.newBlob(T.transformTo("arraybuffer",N),te);case"base64":return S.encode(N);default:return T.transformTo(k,N)}}(q,function(k,N){var te,U=0,I=null,A=0;for(te=0;te<N.length;te++)A+=N[te].length;switch(k){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(I=new Uint8Array(A),te=0;te<N.length;te++)I.set(N[te],U),U+=N[te].length;return I;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+k+"'")}}(le,H),Y);K(Q)}catch(k){P(k)}H=[]}).resume()})}(this,Z)},on:function(Z,X){var K=this;return this._worker.on(Z,"data"===Z?function(P){X.call(K,P.data,P.meta)}:function(){T.delay(X,arguments,K)}),this},resume:function(){return T.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Z){if(T.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new J(this,{objectMode:"nodebuffer"!==this._outputType},Z)}},ye.exports=F},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(de,ye,f){"use strict";if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,f.nodebuffer="undefined"!=typeof Buffer,f.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)f.blob=!1;else{var T=new ArrayBuffer(0);try{f.blob=0===new Blob([T],{type:"application/zip"}).size}catch(v){try{var ne=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);ne.append(T),f.blob=0===ne.getBlob("application/zip").size}catch(S){f.blob=!1}}}try{f.nodestream=!!de("readable-stream").Readable}catch(v){f.nodestream=!1}},{"readable-stream":16}],31:[function(de,ye,f){"use strict";for(var T=de("./utils"),ne=de("./support"),v=de("./nodejsUtils"),S=de("./stream/GenericWorker"),L=new Array(256),D=0;D<256;D++)L[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function J(){S.call(this,"utf-8 decode"),this.leftOver=null}function j(){S.call(this,"utf-8 encode")}L[254]=L[254]=1,f.utf8encode=function(F){return ne.nodebuffer?v.newBufferFrom(F,"utf-8"):function(Z){var X,K,P,H,le,q=Z.length,Y=0;for(H=0;H<q;H++)55296==(64512&(K=Z.charCodeAt(H)))&&H+1<q&&56320==(64512&(P=Z.charCodeAt(H+1)))&&(K=65536+(K-55296<<10)+(P-56320),H++),Y+=K<128?1:K<2048?2:K<65536?3:4;for(X=ne.uint8array?new Uint8Array(Y):new Array(Y),H=le=0;le<Y;H++)55296==(64512&(K=Z.charCodeAt(H)))&&H+1<q&&56320==(64512&(P=Z.charCodeAt(H+1)))&&(K=65536+(K-55296<<10)+(P-56320),H++),K<128?X[le++]=K:(K<2048?X[le++]=192|K>>>6:(K<65536?X[le++]=224|K>>>12:(X[le++]=240|K>>>18,X[le++]=128|K>>>12&63),X[le++]=128|K>>>6&63),X[le++]=128|63&K);return X}(F)},f.utf8decode=function(F){return ne.nodebuffer?T.transformTo("nodebuffer",F).toString("utf-8"):function(Z){var X,K,P,H,le=Z.length,q=new Array(2*le);for(X=K=0;X<le;)if((P=Z[X++])<128)q[K++]=P;else if(4<(H=L[P]))q[K++]=65533,X+=H-1;else{for(P&=2===H?31:3===H?15:7;1<H&&X<le;)P=P<<6|63&Z[X++],H--;1<H?q[K++]=65533:P<65536?q[K++]=P:(q[K++]=55296|(P-=65536)>>10&1023,q[K++]=56320|1023&P)}return q.length!==K&&(q.subarray?q=q.subarray(0,K):q.length=K),T.applyFromCharCode(q)}(F=T.transformTo(ne.uint8array?"uint8array":"array",F))},T.inherits(J,S),J.prototype.processChunk=function(F){var Z=T.transformTo(ne.uint8array?"uint8array":"array",F.data);if(this.leftOver&&this.leftOver.length){if(ne.uint8array){var X=Z;(Z=new Uint8Array(X.length+this.leftOver.length)).set(this.leftOver,0),Z.set(X,this.leftOver.length)}else Z=this.leftOver.concat(Z);this.leftOver=null}var K=function(H,le){var q;for((le=le||H.length)>H.length&&(le=H.length),q=le-1;0<=q&&128==(192&H[q]);)q--;return q<0||0===q?le:q+L[H[q]]>le?q:le}(Z),P=Z;K!==Z.length&&(ne.uint8array?(P=Z.subarray(0,K),this.leftOver=Z.subarray(K,Z.length)):(P=Z.slice(0,K),this.leftOver=Z.slice(K,Z.length))),this.push({data:f.utf8decode(P),meta:F.meta})},J.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=J,T.inherits(j,S),j.prototype.processChunk=function(F){this.push({data:f.utf8encode(F.data),meta:F.meta})},f.Utf8EncodeWorker=j},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(de,ye,f){"use strict";var T=de("./support"),ne=de("./base64"),v=de("./nodejsUtils"),S=de("set-immediate-shim"),L=de("./external");function D(K){return K}function J(K,P){for(var H=0;H<K.length;++H)P[H]=255&K.charCodeAt(H);return P}f.newBlob=function(K,P){f.checkSupport("blob");try{return new Blob([K],{type:P})}catch(le){try{var H=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return H.append(K),H.getBlob(P)}catch(q){throw new Error("Bug : can't construct the Blob.")}}};var j={stringifyByChunk:function(K,P,H){var le=[],q=0,Y=K.length;if(Y<=H)return String.fromCharCode.apply(null,K);for(;q<Y;)le.push(String.fromCharCode.apply(null,"array"===P||"nodebuffer"===P?K.slice(q,Math.min(q+H,Y)):K.subarray(q,Math.min(q+H,Y)))),q+=H;return le.join("")},stringifyByChar:function(K){for(var P="",H=0;H<K.length;H++)P+=String.fromCharCode(K[H]);return P},applyCanBeUsed:{uint8array:function(){try{return T.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(K){return!1}}(),nodebuffer:function(){try{return T.nodebuffer&&1===String.fromCharCode.apply(null,v.allocBuffer(1)).length}catch(K){return!1}}()}};function F(K){var P=65536,H=f.getTypeOf(K),le=!0;if("uint8array"===H?le=j.applyCanBeUsed.uint8array:"nodebuffer"===H&&(le=j.applyCanBeUsed.nodebuffer),le)for(;1<P;)try{return j.stringifyByChunk(K,H,P)}catch(q){P=Math.floor(P/2)}return j.stringifyByChar(K)}function Z(K,P){for(var H=0;H<K.length;H++)P[H]=K[H];return P}f.applyFromCharCode=F;var X={};X.string={string:D,array:function(K){return J(K,new Array(K.length))},arraybuffer:function(K){return X.string.uint8array(K).buffer},uint8array:function(K){return J(K,new Uint8Array(K.length))},nodebuffer:function(K){return J(K,v.allocBuffer(K.length))}},X.array={string:F,array:D,arraybuffer:function(K){return new Uint8Array(K).buffer},uint8array:function(K){return new Uint8Array(K)},nodebuffer:function(K){return v.newBufferFrom(K)}},X.arraybuffer={string:function(K){return F(new Uint8Array(K))},array:function(K){return Z(new Uint8Array(K),new Array(K.byteLength))},arraybuffer:D,uint8array:function(K){return new Uint8Array(K)},nodebuffer:function(K){return v.newBufferFrom(new Uint8Array(K))}},X.uint8array={string:F,array:function(K){return Z(K,new Array(K.length))},arraybuffer:function(K){return K.buffer},uint8array:D,nodebuffer:function(K){return v.newBufferFrom(K)}},X.nodebuffer={string:F,array:function(K){return Z(K,new Array(K.length))},arraybuffer:function(K){return X.nodebuffer.uint8array(K).buffer},uint8array:function(K){return Z(K,new Uint8Array(K.length))},nodebuffer:D},f.transformTo=function(K,P){if(P=P||"",!K)return P;f.checkSupport(K);var H=f.getTypeOf(P);return X[H][K](P)},f.resolve=function(K){for(var P=K.split("/"),H=[],le=0;le<P.length;le++){var q=P[le];"."===q||""===q&&0!==le&&le!==P.length-1||(".."===q?H.pop():H.push(q))}return H.join("/")},f.getTypeOf=function(K){return"string"==typeof K?"string":"[object Array]"===Object.prototype.toString.call(K)?"array":T.nodebuffer&&v.isBuffer(K)?"nodebuffer":T.uint8array&&K instanceof Uint8Array?"uint8array":T.arraybuffer&&K instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(K){if(!T[K.toLowerCase()])throw new Error(K+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(K){var P,H,le="";for(H=0;H<(K||"").length;H++)le+="\\x"+((P=K.charCodeAt(H))<16?"0":"")+P.toString(16).toUpperCase();return le},f.delay=function(K,P,H){S(function(){K.apply(H||null,P||[])})},f.inherits=function(K,P){function H(){}H.prototype=P.prototype,K.prototype=new H},f.extend=function(){var K,P,H={};for(K=0;K<arguments.length;K++)for(P in arguments[K])arguments[K].hasOwnProperty(P)&&void 0===H[P]&&(H[P]=arguments[K][P]);return H},f.prepareContent=function(K,P,H,le,q){return L.Promise.resolve(P).then(function(Y){return T.blob&&(Y instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Y)))&&"undefined"!=typeof FileReader?new L.Promise(function(Q,k){var N=new FileReader;N.onload=function(te){Q(te.target.result)},N.onerror=function(te){k(te.target.error)},N.readAsArrayBuffer(Y)}):Y}).then(function(Y){var k,Q=f.getTypeOf(Y);return Q?("arraybuffer"===Q?Y=f.transformTo("uint8array",Y):"string"===Q&&(q?Y=ne.decode(Y):H&&!0!==le&&(Y=J(k=Y,T.uint8array?new Uint8Array(k.length):new Array(k.length)))),Y):L.Promise.reject(new Error("Can't read the data of '"+K+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(de,ye,f){"use strict";var T=de("./reader/readerFor"),ne=de("./utils"),v=de("./signature"),S=de("./zipEntry"),L=(de("./utf8"),de("./support"));function D(J){this.files=[],this.loadOptions=J}D.prototype={checkSignature:function(J){if(!this.reader.readAndCheckSignature(J)){this.reader.index-=4;var j=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+ne.pretty(j)+", expected "+ne.pretty(J)+")")}},isSignature:function(J,j){var F=this.reader.index;this.reader.setIndex(J);var Z=this.reader.readString(4)===j;return this.reader.setIndex(F),Z},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var J=this.reader.readData(this.zipCommentLength),F=ne.transformTo(L.uint8array?"uint8array":"array",J);this.zipComment=this.loadOptions.decodeFileName(F)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var J,j,F,Z=this.zip64EndOfCentralSize-44;0<Z;)J=this.reader.readInt(2),j=this.reader.readInt(4),F=this.reader.readData(j),this.zip64ExtensibleData[J]={id:J,length:j,value:F}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var J,j;for(J=0;J<this.files.length;J++)this.reader.setIndex((j=this.files[J]).localHeaderOffset),this.checkSignature(v.LOCAL_FILE_HEADER),j.readLocalPart(this.reader),j.handleUTF8(),j.processAttributes()},readCentralDir:function(){var J;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(v.CENTRAL_FILE_HEADER);)(J=new S({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(J);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var J=this.reader.lastIndexOfSignature(v.CENTRAL_DIRECTORY_END);if(J<0)throw this.isSignature(0,v.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(J);var j=J;if(this.checkSignature(v.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===ne.MAX_VALUE_16BITS||this.diskWithCentralDirStart===ne.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===ne.MAX_VALUE_16BITS||this.centralDirRecords===ne.MAX_VALUE_16BITS||this.centralDirSize===ne.MAX_VALUE_32BITS||this.centralDirOffset===ne.MAX_VALUE_32BITS){if(this.zip64=!0,(J=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(J),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,v.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var F=this.centralDirOffset+this.centralDirSize;this.zip64&&(F+=20,F+=12+this.zip64EndOfCentralSize);var Z=j-F;if(0<Z)this.isSignature(j,v.CENTRAL_FILE_HEADER)||(this.reader.zero=Z);else if(Z<0)throw new Error("Corrupted zip: missing "+Math.abs(Z)+" bytes.")},prepareReader:function(J){this.reader=T(J)},load:function(J){this.prepareReader(J),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},ye.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(de,ye,f){"use strict";var T=de("./reader/readerFor"),ne=de("./utils"),v=de("./compressedObject"),S=de("./crc32"),L=de("./utf8"),D=de("./compressions"),J=de("./support");function j(F,Z){this.options=F,this.loadOptions=Z}j.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(F){var Z,X;if(F.skip(22),this.fileNameLength=F.readInt(2),X=F.readInt(2),this.fileName=F.readData(this.fileNameLength),F.skip(X),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(Z=function(K){for(var P in D)if(D.hasOwnProperty(P)&&D[P].magic===K)return D[P];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+ne.pretty(this.compressionMethod)+" unknown (inner file : "+ne.transformTo("string",this.fileName)+")");this.decompressed=new v(this.compressedSize,this.uncompressedSize,this.crc32,Z,F.readData(this.compressedSize))},readCentralPart:function(F){this.versionMadeBy=F.readInt(2),F.skip(2),this.bitFlag=F.readInt(2),this.compressionMethod=F.readString(2),this.date=F.readDate(),this.crc32=F.readInt(4),this.compressedSize=F.readInt(4),this.uncompressedSize=F.readInt(4);var Z=F.readInt(2);if(this.extraFieldsLength=F.readInt(2),this.fileCommentLength=F.readInt(2),this.diskNumberStart=F.readInt(2),this.internalFileAttributes=F.readInt(2),this.externalFileAttributes=F.readInt(4),this.localHeaderOffset=F.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");F.skip(Z),this.readExtraFields(F),this.parseZIP64ExtraField(F),this.fileComment=F.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var F=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==F&&(this.dosPermissions=63&this.externalFileAttributes),3==F&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(F){if(this.extraFields[1]){var Z=T(this.extraFields[1].value);this.uncompressedSize===ne.MAX_VALUE_32BITS&&(this.uncompressedSize=Z.readInt(8)),this.compressedSize===ne.MAX_VALUE_32BITS&&(this.compressedSize=Z.readInt(8)),this.localHeaderOffset===ne.MAX_VALUE_32BITS&&(this.localHeaderOffset=Z.readInt(8)),this.diskNumberStart===ne.MAX_VALUE_32BITS&&(this.diskNumberStart=Z.readInt(4))}},readExtraFields:function(F){var Z,X,K,P=F.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});F.index+4<P;)Z=F.readInt(2),X=F.readInt(2),K=F.readData(X),this.extraFields[Z]={id:Z,length:X,value:K};F.setIndex(P)},handleUTF8:function(){var F=J.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=L.utf8decode(this.fileName),this.fileCommentStr=L.utf8decode(this.fileComment);else{var Z=this.findExtraFieldUnicodePath();if(null!==Z)this.fileNameStr=Z;else{var X=ne.transformTo(F,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(X)}var K=this.findExtraFieldUnicodeComment();if(null!==K)this.fileCommentStr=K;else{var P=ne.transformTo(F,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var F=this.extraFields[28789];if(F){var Z=T(F.value);return 1!==Z.readInt(1)||S(this.fileName)!==Z.readInt(4)?null:L.utf8decode(Z.readData(F.length-5))}return null},findExtraFieldUnicodeComment:function(){var F=this.extraFields[25461];if(F){var Z=T(F.value);return 1!==Z.readInt(1)||S(this.fileComment)!==Z.readInt(4)?null:L.utf8decode(Z.readData(F.length-5))}return null}},ye.exports=j},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(de,ye,f){"use strict";function T(Z,X,K){this.name=Z,this.dir=K.dir,this.date=K.date,this.comment=K.comment,this.unixPermissions=K.unixPermissions,this.dosPermissions=K.dosPermissions,this._data=X,this._dataBinary=K.binary,this.options={compression:K.compression,compressionOptions:K.compressionOptions}}var ne=de("./stream/StreamHelper"),v=de("./stream/DataWorker"),S=de("./utf8"),L=de("./compressedObject"),D=de("./stream/GenericWorker");T.prototype={internalStream:function(Z){var X=null,K="string";try{if(!Z)throw new Error("No output type specified.");var P="string"===(K=Z.toLowerCase())||"text"===K;"binarystring"!==K&&"text"!==K||(K="string"),X=this._decompressWorker();var H=!this._dataBinary;H&&!P&&(X=X.pipe(new S.Utf8EncodeWorker)),!H&&P&&(X=X.pipe(new S.Utf8DecodeWorker))}catch(le){(X=new D("error")).error(le)}return new ne(X,K,"")},async:function(Z,X){return this.internalStream(Z).accumulate(X)},nodeStream:function(Z,X){return this.internalStream(Z||"nodebuffer").toNodejsStream(X)},_compressWorker:function(Z,X){if(this._data instanceof L&&this._data.compression.magic===Z.magic)return this._data.getCompressedWorker();var K=this._decompressWorker();return this._dataBinary||(K=K.pipe(new S.Utf8EncodeWorker)),L.createWorkerFrom(K,Z,X)},_decompressWorker:function(){return this._data instanceof L?this._data.getContentWorker():this._data instanceof D?this._data:new v(this._data)}};for(var J=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],j=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},F=0;F<J.length;F++)T.prototype[J[F]]=j;ye.exports=T},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(de,ye,f){(function(T){"use strict";var ne,v,S=T.MutationObserver||T.WebKitMutationObserver;if(S){var L=0,D=new S(Z),J=T.document.createTextNode("");D.observe(J,{characterData:!0}),ne=function(){J.data=L=++L%2}}else if(T.setImmediate||void 0===T.MessageChannel)ne="document"in T&&"onreadystatechange"in T.document.createElement("script")?function(){var X=T.document.createElement("script");X.onreadystatechange=function(){Z(),X.onreadystatechange=null,X.parentNode.removeChild(X),X=null},T.document.documentElement.appendChild(X)}:function(){setTimeout(Z,0)};else{var j=new T.MessageChannel;j.port1.onmessage=Z,ne=function(){j.port2.postMessage(0)}}var F=[];function Z(){var X,K;v=!0;for(var P=F.length;P;){for(K=F,F=[],X=-1;++X<P;)K[X]();P=F.length}v=!1}ye.exports=function(X){1!==F.push(X)||v||ne()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(de,ye,f){"use strict";var T=de("immediate");function ne(){}var v={},S=["REJECTED"],L=["FULFILLED"],D=["PENDING"];function J(P){if("function"!=typeof P)throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,P!==ne&&X(this,P)}function j(P,H,le){this.promise=P,"function"==typeof H&&(this.onFulfilled=H,this.callFulfilled=this.otherCallFulfilled),"function"==typeof le&&(this.onRejected=le,this.callRejected=this.otherCallRejected)}function F(P,H,le){T(function(){var q;try{q=H(le)}catch(Y){return v.reject(P,Y)}q===P?v.reject(P,new TypeError("Cannot resolve promise with itself")):v.resolve(P,q)})}function Z(P){var H=P&&P.then;if(P&&("object"==typeof P||"function"==typeof P)&&"function"==typeof H)return function(){H.apply(P,arguments)}}function X(P,H){var le=!1;function q(k){le||(le=!0,v.reject(P,k))}function Y(k){le||(le=!0,v.resolve(P,k))}var Q=K(function(){H(Y,q)});"error"===Q.status&&q(Q.value)}function K(P,H){var le={};try{le.value=P(H),le.status="success"}catch(q){le.status="error",le.value=q}return le}(ye.exports=J).prototype.finally=function(P){if("function"!=typeof P)return this;var H=this.constructor;return this.then(function(le){return H.resolve(P()).then(function(){return le})},function(le){return H.resolve(P()).then(function(){throw le})})},J.prototype.catch=function(P){return this.then(null,P)},J.prototype.then=function(P,H){if("function"!=typeof P&&this.state===L||"function"!=typeof H&&this.state===S)return this;var le=new this.constructor(ne);return this.state!==D?F(le,this.state===L?P:H,this.outcome):this.queue.push(new j(le,P,H)),le},j.prototype.callFulfilled=function(P){v.resolve(this.promise,P)},j.prototype.otherCallFulfilled=function(P){F(this.promise,this.onFulfilled,P)},j.prototype.callRejected=function(P){v.reject(this.promise,P)},j.prototype.otherCallRejected=function(P){F(this.promise,this.onRejected,P)},v.resolve=function(P,H){var le=K(Z,H);if("error"===le.status)return v.reject(P,le.value);var q=le.value;if(q)X(P,q);else{P.state=L,P.outcome=H;for(var Y=-1,Q=P.queue.length;++Y<Q;)P.queue[Y].callFulfilled(H)}return P},v.reject=function(P,H){P.state=S,P.outcome=H;for(var le=-1,q=P.queue.length;++le<q;)P.queue[le].callRejected(H);return P},J.resolve=function(P){return P instanceof this?P:v.resolve(new this(ne),P)},J.reject=function(P){var H=new this(ne);return v.reject(H,P)},J.all=function(P){var H=this;if("[object Array]"!==Object.prototype.toString.call(P))return this.reject(new TypeError("must be an array"));var le=P.length,q=!1;if(!le)return this.resolve([]);for(var Y=new Array(le),Q=0,k=-1,N=new this(ne);++k<le;)te(P[k],k);return N;function te(U,I){H.resolve(U).then(function(A){Y[I]=A,++Q!==le||q||(q=!0,v.resolve(N,Y))},function(A){q||(q=!0,v.reject(N,A))})}},J.race=function(P){if("[object Array]"!==Object.prototype.toString.call(P))return this.reject(new TypeError("must be an array"));var le=P.length,q=!1;if(!le)return this.resolve([]);for(var Y=-1,Q=new this(ne);++Y<le;)this.resolve(P[Y]).then(function(N){q||(q=!0,v.resolve(Q,N))},function(N){q||(q=!0,v.reject(Q,N))});return Q}},{immediate:36}],38:[function(de,ye,f){"use strict";var T={};(0,de("./lib/utils/common").assign)(T,de("./lib/deflate"),de("./lib/inflate"),de("./lib/zlib/constants")),ye.exports=T},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(de,ye,f){"use strict";var T=de("./zlib/deflate"),ne=de("./utils/common"),v=de("./utils/strings"),S=de("./zlib/messages"),L=de("./zlib/zstream"),D=Object.prototype.toString;function X(P){if(!(this instanceof X))return new X(P);this.options=ne.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},P||{});var H=this.options;H.raw&&0<H.windowBits?H.windowBits=-H.windowBits:H.gzip&&0<H.windowBits&&H.windowBits<16&&(H.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L,this.strm.avail_out=0;var le=T.deflateInit2(this.strm,H.level,H.method,H.windowBits,H.memLevel,H.strategy);if(0!==le)throw new Error(S[le]);if(H.header&&T.deflateSetHeader(this.strm,H.header),H.dictionary){var q;if(q="string"==typeof H.dictionary?v.string2buf(H.dictionary):"[object ArrayBuffer]"===D.call(H.dictionary)?new Uint8Array(H.dictionary):H.dictionary,0!==(le=T.deflateSetDictionary(this.strm,q)))throw new Error(S[le]);this._dict_set=!0}}function K(P,H){var le=new X(H);if(le.push(P,!0),le.err)throw le.msg||S[le.err];return le.result}X.prototype.push=function(P,H){var le,q,Y=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;q=H===~~H?H:!0===H?4:0,Y.input="string"==typeof P?v.string2buf(P):"[object ArrayBuffer]"===D.call(P)?new Uint8Array(P):P,Y.next_in=0,Y.avail_in=Y.input.length;do{if(0===Y.avail_out&&(Y.output=new ne.Buf8(Q),Y.next_out=0,Y.avail_out=Q),1!==(le=T.deflate(Y,q))&&0!==le)return this.onEnd(le),!(this.ended=!0);0!==Y.avail_out&&(0!==Y.avail_in||4!==q&&2!==q)||this.onData("string"===this.options.to?v.buf2binstring(ne.shrinkBuf(Y.output,Y.next_out)):ne.shrinkBuf(Y.output,Y.next_out))}while((0<Y.avail_in||0===Y.avail_out)&&1!==le);return 4===q?(le=T.deflateEnd(this.strm),this.onEnd(le),this.ended=!0,0===le):2!==q||(this.onEnd(0),!(Y.avail_out=0))},X.prototype.onData=function(P){this.chunks.push(P)},X.prototype.onEnd=function(P){0===P&&(this.result="string"===this.options.to?this.chunks.join(""):ne.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},f.Deflate=X,f.deflate=K,f.deflateRaw=function(P,H){return(H=H||{}).raw=!0,K(P,H)},f.gzip=function(P,H){return(H=H||{}).gzip=!0,K(P,H)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(de,ye,f){"use strict";var T=de("./zlib/inflate"),ne=de("./utils/common"),v=de("./utils/strings"),S=de("./zlib/constants"),L=de("./zlib/messages"),D=de("./zlib/zstream"),J=de("./zlib/gzheader"),j=Object.prototype.toString;function F(X){if(!(this instanceof F))return new F(X);this.options=ne.assign({chunkSize:16384,windowBits:0,to:""},X||{});var K=this.options;K.raw&&0<=K.windowBits&&K.windowBits<16&&(K.windowBits=-K.windowBits,0===K.windowBits&&(K.windowBits=-15)),!(0<=K.windowBits&&K.windowBits<16)||X&&X.windowBits||(K.windowBits+=32),15<K.windowBits&&K.windowBits<48&&0==(15&K.windowBits)&&(K.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var P=T.inflateInit2(this.strm,K.windowBits);if(P!==S.Z_OK)throw new Error(L[P]);this.header=new J,T.inflateGetHeader(this.strm,this.header)}function Z(X,K){var P=new F(K);if(P.push(X,!0),P.err)throw P.msg||L[P.err];return P.result}F.prototype.push=function(X,K){var P,H,le,q,Y,Q,k=this.strm,N=this.options.chunkSize,te=this.options.dictionary,U=!1;if(this.ended)return!1;H=K===~~K?K:!0===K?S.Z_FINISH:S.Z_NO_FLUSH,k.input="string"==typeof X?v.binstring2buf(X):"[object ArrayBuffer]"===j.call(X)?new Uint8Array(X):X,k.next_in=0,k.avail_in=k.input.length;do{if(0===k.avail_out&&(k.output=new ne.Buf8(N),k.next_out=0,k.avail_out=N),(P=T.inflate(k,S.Z_NO_FLUSH))===S.Z_NEED_DICT&&te&&(Q="string"==typeof te?v.string2buf(te):"[object ArrayBuffer]"===j.call(te)?new Uint8Array(te):te,P=T.inflateSetDictionary(this.strm,Q)),P===S.Z_BUF_ERROR&&!0===U&&(P=S.Z_OK,U=!1),P!==S.Z_STREAM_END&&P!==S.Z_OK)return this.onEnd(P),!(this.ended=!0);k.next_out&&(0!==k.avail_out&&P!==S.Z_STREAM_END&&(0!==k.avail_in||H!==S.Z_FINISH&&H!==S.Z_SYNC_FLUSH)||("string"===this.options.to?(le=v.utf8border(k.output,k.next_out),q=k.next_out-le,Y=v.buf2string(k.output,le),k.next_out=q,k.avail_out=N-q,q&&ne.arraySet(k.output,k.output,le,q,0),this.onData(Y)):this.onData(ne.shrinkBuf(k.output,k.next_out)))),0===k.avail_in&&0===k.avail_out&&(U=!0)}while((0<k.avail_in||0===k.avail_out)&&P!==S.Z_STREAM_END);return P===S.Z_STREAM_END&&(H=S.Z_FINISH),H===S.Z_FINISH?(P=T.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===S.Z_OK):H!==S.Z_SYNC_FLUSH||(this.onEnd(S.Z_OK),!(k.avail_out=0))},F.prototype.onData=function(X){this.chunks.push(X)},F.prototype.onEnd=function(X){X===S.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):ne.flattenChunks(this.chunks)),this.chunks=[],this.err=X,this.msg=this.strm.msg},f.Inflate=F,f.inflate=Z,f.inflateRaw=function(X,K){return(K=K||{}).raw=!0,Z(X,K)},f.ungzip=Z},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(de,ye,f){"use strict";var T="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;f.assign=function(S){for(var L=Array.prototype.slice.call(arguments,1);L.length;){var D=L.shift();if(D){if("object"!=typeof D)throw new TypeError(D+"must be non-object");for(var J in D)D.hasOwnProperty(J)&&(S[J]=D[J])}}return S},f.shrinkBuf=function(S,L){return S.length===L?S:S.subarray?S.subarray(0,L):(S.length=L,S)};var ne={arraySet:function(S,L,D,J,j){if(L.subarray&&S.subarray)S.set(L.subarray(D,D+J),j);else for(var F=0;F<J;F++)S[j+F]=L[D+F]},flattenChunks:function(S){var L,D,J,j,F,Z;for(L=J=0,D=S.length;L<D;L++)J+=S[L].length;for(Z=new Uint8Array(J),L=j=0,D=S.length;L<D;L++)Z.set(F=S[L],j),j+=F.length;return Z}},v={arraySet:function(S,L,D,J,j){for(var F=0;F<J;F++)S[j+F]=L[D+F]},flattenChunks:function(S){return[].concat.apply([],S)}};f.setTyped=function(S){S?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,ne)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,v))},f.setTyped(T)},{}],42:[function(de,ye,f){"use strict";var T=de("./common"),ne=!0,v=!0;try{String.fromCharCode.apply(null,[0])}catch(J){ne=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(J){v=!1}for(var S=new T.Buf8(256),L=0;L<256;L++)S[L]=252<=L?6:248<=L?5:240<=L?4:224<=L?3:192<=L?2:1;function D(J,j){if(j<65537&&(J.subarray&&v||!J.subarray&&ne))return String.fromCharCode.apply(null,T.shrinkBuf(J,j));for(var F="",Z=0;Z<j;Z++)F+=String.fromCharCode(J[Z]);return F}S[254]=S[254]=1,f.string2buf=function(J){var j,F,Z,X,K,P=J.length,H=0;for(X=0;X<P;X++)55296==(64512&(F=J.charCodeAt(X)))&&X+1<P&&56320==(64512&(Z=J.charCodeAt(X+1)))&&(F=65536+(F-55296<<10)+(Z-56320),X++),H+=F<128?1:F<2048?2:F<65536?3:4;for(j=new T.Buf8(H),X=K=0;K<H;X++)55296==(64512&(F=J.charCodeAt(X)))&&X+1<P&&56320==(64512&(Z=J.charCodeAt(X+1)))&&(F=65536+(F-55296<<10)+(Z-56320),X++),F<128?j[K++]=F:(F<2048?j[K++]=192|F>>>6:(F<65536?j[K++]=224|F>>>12:(j[K++]=240|F>>>18,j[K++]=128|F>>>12&63),j[K++]=128|F>>>6&63),j[K++]=128|63&F);return j},f.buf2binstring=function(J){return D(J,J.length)},f.binstring2buf=function(J){for(var j=new T.Buf8(J.length),F=0,Z=j.length;F<Z;F++)j[F]=J.charCodeAt(F);return j},f.buf2string=function(J,j){var F,Z,X,K,P=j||J.length,H=new Array(2*P);for(F=Z=0;F<P;)if((X=J[F++])<128)H[Z++]=X;else if(4<(K=S[X]))H[Z++]=65533,F+=K-1;else{for(X&=2===K?31:3===K?15:7;1<K&&F<P;)X=X<<6|63&J[F++],K--;1<K?H[Z++]=65533:X<65536?H[Z++]=X:(H[Z++]=55296|(X-=65536)>>10&1023,H[Z++]=56320|1023&X)}return D(H,Z)},f.utf8border=function(J,j){var F;for((j=j||J.length)>J.length&&(j=J.length),F=j-1;0<=F&&128==(192&J[F]);)F--;return F<0||0===F?j:F+S[J[F]]>j?F:j}},{"./common":41}],43:[function(de,ye,f){"use strict";ye.exports=function(T,ne,v,S){for(var L=65535&T|0,D=T>>>16&65535|0,J=0;0!==v;){for(v-=J=2e3<v?2e3:v;D=D+(L=L+ne[S++]|0)|0,--J;);L%=65521,D%=65521}return L|D<<16|0}},{}],44:[function(de,ye,f){"use strict";ye.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(de,ye,f){"use strict";var T=function(){for(var ne,v=[],S=0;S<256;S++){ne=S;for(var L=0;L<8;L++)ne=1&ne?3988292384^ne>>>1:ne>>>1;v[S]=ne}return v}();ye.exports=function(ne,v,S,L){var D=T,J=L+S;ne^=-1;for(var j=L;j<J;j++)ne=ne>>>8^D[255&(ne^v[j])];return-1^ne}},{}],46:[function(de,ye,f){"use strict";var T,ne=de("../utils/common"),v=de("./trees"),S=de("./adler32"),L=de("./crc32"),D=de("./messages"),Z=-2,U=258,I=262,y=113;function ge(fe,Pe){return fe.msg=D[Pe],Pe}function B(fe){return(fe<<1)-(4<fe?9:0)}function O(fe){for(var Pe=fe.length;0<=--Pe;)fe[Pe]=0}function _(fe){var Pe=fe.state,be=Pe.pending;be>fe.avail_out&&(be=fe.avail_out),0!==be&&(ne.arraySet(fe.output,Pe.pending_buf,Pe.pending_out,be,fe.next_out),fe.next_out+=be,Pe.pending_out+=be,fe.total_out+=be,fe.avail_out-=be,Pe.pending-=be,0===Pe.pending&&(Pe.pending_out=0))}function l(fe,Pe){v._tr_flush_block(fe,0<=fe.block_start?fe.block_start:-1,fe.strstart-fe.block_start,Pe),fe.block_start=fe.strstart,_(fe.strm)}function c(fe,Pe){fe.pending_buf[fe.pending++]=Pe}function h(fe,Pe){fe.pending_buf[fe.pending++]=Pe>>>8&255,fe.pending_buf[fe.pending++]=255&Pe}function d(fe,Pe){var be,xe,pe=fe.max_chain_length,Me=fe.strstart,Ce=fe.prev_length,ae=fe.nice_match,he=fe.strstart>fe.w_size-I?fe.strstart-(fe.w_size-I):0,Ee=fe.window,C=fe.w_mask,V=fe.prev,$e=fe.strstart+U,Te=Ee[Me+Ce-1],Fe=Ee[Me+Ce];fe.prev_length>=fe.good_match&&(pe>>=2),ae>fe.lookahead&&(ae=fe.lookahead);do{if(Ee[(be=Pe)+Ce]===Fe&&Ee[be+Ce-1]===Te&&Ee[be]===Ee[Me]&&Ee[++be]===Ee[Me+1]){Me+=2,be++;do{}while(Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Ee[++Me]===Ee[++be]&&Me<$e);if(xe=U-($e-Me),Me=$e-U,Ce<xe){if(fe.match_start=Pe,ae<=(Ce=xe))break;Te=Ee[Me+Ce-1],Fe=Ee[Me+Ce]}}}while((Pe=V[Pe&C])>he&&0!=--pe);return Ce<=fe.lookahead?Ce:fe.lookahead}function p(fe){var Pe,be,xe,pe,Me,Ce,ae,he,Ee,C,V=fe.w_size;do{if(pe=fe.window_size-fe.lookahead-fe.strstart,fe.strstart>=V+(V-I)){for(ne.arraySet(fe.window,fe.window,V,V,0),fe.match_start-=V,fe.strstart-=V,fe.block_start-=V,Pe=be=fe.hash_size;xe=fe.head[--Pe],fe.head[Pe]=V<=xe?xe-V:0,--be;);for(Pe=be=V;xe=fe.prev[--Pe],fe.prev[Pe]=V<=xe?xe-V:0,--be;);pe+=V}if(0===fe.strm.avail_in)break;if(ae=fe.window,he=fe.strstart+fe.lookahead,C=void 0,(Ee=pe)<(C=(Ce=fe.strm).avail_in)&&(C=Ee),be=0===C?0:(Ce.avail_in-=C,ne.arraySet(ae,Ce.input,Ce.next_in,C,he),1===Ce.state.wrap?Ce.adler=S(Ce.adler,ae,C,he):2===Ce.state.wrap&&(Ce.adler=L(Ce.adler,ae,C,he)),Ce.next_in+=C,Ce.total_in+=C,C),fe.lookahead+=be,fe.lookahead+fe.insert>=3)for(fe.ins_h=fe.window[Me=fe.strstart-fe.insert],fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[Me+1])&fe.hash_mask;fe.insert&&(fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[Me+3-1])&fe.hash_mask,fe.prev[Me&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=Me,Me++,fe.insert--,!(fe.lookahead+fe.insert<3)););}while(fe.lookahead<I&&0!==fe.strm.avail_in)}function m(fe,Pe){for(var be,xe;;){if(fe.lookahead<I){if(p(fe),fe.lookahead<I&&0===Pe)return 1;if(0===fe.lookahead)break}if(be=0,fe.lookahead>=3&&(fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[fe.strstart+3-1])&fe.hash_mask,be=fe.prev[fe.strstart&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=fe.strstart),0!==be&&fe.strstart-be<=fe.w_size-I&&(fe.match_length=d(fe,be)),fe.match_length>=3)if(xe=v._tr_tally(fe,fe.strstart-fe.match_start,fe.match_length-3),fe.lookahead-=fe.match_length,fe.match_length<=fe.max_lazy_match&&fe.lookahead>=3){for(fe.match_length--;fe.strstart++,fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[fe.strstart+3-1])&fe.hash_mask,be=fe.prev[fe.strstart&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=fe.strstart,0!=--fe.match_length;);fe.strstart++}else fe.strstart+=fe.match_length,fe.match_length=0,fe.ins_h=fe.window[fe.strstart],fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[fe.strstart+1])&fe.hash_mask;else xe=v._tr_tally(fe,0,fe.window[fe.strstart]),fe.lookahead--,fe.strstart++;if(xe&&(l(fe,!1),0===fe.strm.avail_out))return 1}return fe.insert=fe.strstart<2?fe.strstart:2,4===Pe?(l(fe,!0),0===fe.strm.avail_out?3:4):fe.last_lit&&(l(fe,!1),0===fe.strm.avail_out)?1:2}function x(fe,Pe){for(var be,xe,pe;;){if(fe.lookahead<I){if(p(fe),fe.lookahead<I&&0===Pe)return 1;if(0===fe.lookahead)break}if(be=0,fe.lookahead>=3&&(fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[fe.strstart+3-1])&fe.hash_mask,be=fe.prev[fe.strstart&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=fe.strstart),fe.prev_length=fe.match_length,fe.prev_match=fe.match_start,fe.match_length=2,0!==be&&fe.prev_length<fe.max_lazy_match&&fe.strstart-be<=fe.w_size-I&&(fe.match_length=d(fe,be),fe.match_length<=5&&(1===fe.strategy||3===fe.match_length&&4096<fe.strstart-fe.match_start)&&(fe.match_length=2)),fe.prev_length>=3&&fe.match_length<=fe.prev_length){for(pe=fe.strstart+fe.lookahead-3,xe=v._tr_tally(fe,fe.strstart-1-fe.prev_match,fe.prev_length-3),fe.lookahead-=fe.prev_length-1,fe.prev_length-=2;++fe.strstart<=pe&&(fe.ins_h=(fe.ins_h<<fe.hash_shift^fe.window[fe.strstart+3-1])&fe.hash_mask,be=fe.prev[fe.strstart&fe.w_mask]=fe.head[fe.ins_h],fe.head[fe.ins_h]=fe.strstart),0!=--fe.prev_length;);if(fe.match_available=0,fe.match_length=2,fe.strstart++,xe&&(l(fe,!1),0===fe.strm.avail_out))return 1}else if(fe.match_available){if((xe=v._tr_tally(fe,0,fe.window[fe.strstart-1]))&&l(fe,!1),fe.strstart++,fe.lookahead--,0===fe.strm.avail_out)return 1}else fe.match_available=1,fe.strstart++,fe.lookahead--}return fe.match_available&&(xe=v._tr_tally(fe,0,fe.window[fe.strstart-1]),fe.match_available=0),fe.insert=fe.strstart<2?fe.strstart:2,4===Pe?(l(fe,!0),0===fe.strm.avail_out?3:4):fe.last_lit&&(l(fe,!1),0===fe.strm.avail_out)?1:2}function $(fe,Pe,be,xe,pe){this.good_length=fe,this.max_lazy=Pe,this.nice_length=be,this.max_chain=xe,this.func=pe}function re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ne.Buf16(1146),this.dyn_dtree=new ne.Buf16(122),this.bl_tree=new ne.Buf16(78),O(this.dyn_ltree),O(this.dyn_dtree),O(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ne.Buf16(16),this.heap=new ne.Buf16(573),O(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ne.Buf16(573),O(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function se(fe){var Pe;return fe&&fe.state?(fe.total_in=fe.total_out=0,fe.data_type=2,(Pe=fe.state).pending=0,Pe.pending_out=0,Pe.wrap<0&&(Pe.wrap=-Pe.wrap),Pe.status=Pe.wrap?42:y,fe.adler=2===Pe.wrap?0:1,Pe.last_flush=0,v._tr_init(Pe),0):ge(fe,Z)}function De(fe){var be,Pe=se(fe);return 0===Pe&&((be=fe.state).window_size=2*be.w_size,O(be.head),be.max_lazy_match=T[be.level].max_lazy,be.good_match=T[be.level].good_length,be.nice_match=T[be.level].nice_length,be.max_chain_length=T[be.level].max_chain,be.strstart=0,be.block_start=0,be.lookahead=0,be.insert=0,be.match_length=be.prev_length=2,be.match_available=0,be.ins_h=0),Pe}function Ae(fe,Pe,be,xe,pe,Me){if(!fe)return Z;var Ce=1;if(-1===Pe&&(Pe=6),xe<0?(Ce=0,xe=-xe):15<xe&&(Ce=2,xe-=16),pe<1||9<pe||8!==be||xe<8||15<xe||Pe<0||9<Pe||Me<0||4<Me)return ge(fe,Z);8===xe&&(xe=9);var ae=new re;return(fe.state=ae).strm=fe,ae.wrap=Ce,ae.gzhead=null,ae.w_bits=xe,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=pe+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new ne.Buf8(2*ae.w_size),ae.head=new ne.Buf16(ae.hash_size),ae.prev=new ne.Buf16(ae.w_size),ae.lit_bufsize=1<<pe+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new ne.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=Pe,ae.strategy=Me,ae.method=be,De(fe)}T=[new $(0,0,0,0,function(fe,Pe){var be=65535;for(be>fe.pending_buf_size-5&&(be=fe.pending_buf_size-5);;){if(fe.lookahead<=1){if(p(fe),0===fe.lookahead&&0===Pe)return 1;if(0===fe.lookahead)break}fe.strstart+=fe.lookahead,fe.lookahead=0;var xe=fe.block_start+be;if((0===fe.strstart||fe.strstart>=xe)&&(fe.lookahead=fe.strstart-xe,fe.strstart=xe,l(fe,!1),0===fe.strm.avail_out)||fe.strstart-fe.block_start>=fe.w_size-I&&(l(fe,!1),0===fe.strm.avail_out))return 1}return fe.insert=0,4===Pe?(l(fe,!0),0===fe.strm.avail_out?3:4):(fe.strstart>fe.block_start&&l(fe,!1),1)}),new $(4,4,8,4,m),new $(4,5,16,8,m),new $(4,6,32,32,m),new $(4,4,16,16,x),new $(8,16,32,32,x),new $(8,16,128,128,x),new $(8,32,128,256,x),new $(32,128,258,1024,x),new $(32,258,258,4096,x)],f.deflateInit=function(fe,Pe){return Ae(fe,Pe,8,15,8,0)},f.deflateInit2=Ae,f.deflateReset=De,f.deflateResetKeep=se,f.deflateSetHeader=function(fe,Pe){return fe&&fe.state?2!==fe.state.wrap?Z:(fe.state.gzhead=Pe,0):Z},f.deflate=function(fe,Pe){var be,xe,pe,Me;if(!fe||!fe.state||5<Pe||Pe<0)return fe?ge(fe,Z):Z;if(xe=fe.state,!fe.output||!fe.input&&0!==fe.avail_in||666===xe.status&&4!==Pe)return ge(fe,0===fe.avail_out?-5:Z);if(xe.strm=fe,be=xe.last_flush,xe.last_flush=Pe,42===xe.status)if(2===xe.wrap)fe.adler=0,c(xe,31),c(xe,139),c(xe,8),xe.gzhead?(c(xe,(xe.gzhead.text?1:0)+(xe.gzhead.hcrc?2:0)+(xe.gzhead.extra?4:0)+(xe.gzhead.name?8:0)+(xe.gzhead.comment?16:0)),c(xe,255&xe.gzhead.time),c(xe,xe.gzhead.time>>8&255),c(xe,xe.gzhead.time>>16&255),c(xe,xe.gzhead.time>>24&255),c(xe,9===xe.level?2:2<=xe.strategy||xe.level<2?4:0),c(xe,255&xe.gzhead.os),xe.gzhead.extra&&xe.gzhead.extra.length&&(c(xe,255&xe.gzhead.extra.length),c(xe,xe.gzhead.extra.length>>8&255)),xe.gzhead.hcrc&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending,0)),xe.gzindex=0,xe.status=69):(c(xe,0),c(xe,0),c(xe,0),c(xe,0),c(xe,0),c(xe,9===xe.level?2:2<=xe.strategy||xe.level<2?4:0),c(xe,3),xe.status=y);else{var Ce=8+(xe.w_bits-8<<4)<<8;Ce|=(2<=xe.strategy||xe.level<2?0:xe.level<6?1:6===xe.level?2:3)<<6,0!==xe.strstart&&(Ce|=32),Ce+=31-Ce%31,xe.status=y,h(xe,Ce),0!==xe.strstart&&(h(xe,fe.adler>>>16),h(xe,65535&fe.adler)),fe.adler=1}if(69===xe.status)if(xe.gzhead.extra){for(pe=xe.pending;xe.gzindex<(65535&xe.gzhead.extra.length)&&(xe.pending!==xe.pending_buf_size||(xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),_(fe),pe=xe.pending,xe.pending!==xe.pending_buf_size));)c(xe,255&xe.gzhead.extra[xe.gzindex]),xe.gzindex++;xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),xe.gzindex===xe.gzhead.extra.length&&(xe.gzindex=0,xe.status=73)}else xe.status=73;if(73===xe.status)if(xe.gzhead.name){pe=xe.pending;do{if(xe.pending===xe.pending_buf_size&&(xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),_(fe),pe=xe.pending,xe.pending===xe.pending_buf_size)){Me=1;break}Me=xe.gzindex<xe.gzhead.name.length?255&xe.gzhead.name.charCodeAt(xe.gzindex++):0,c(xe,Me)}while(0!==Me);xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),0===Me&&(xe.gzindex=0,xe.status=91)}else xe.status=91;if(91===xe.status)if(xe.gzhead.comment){pe=xe.pending;do{if(xe.pending===xe.pending_buf_size&&(xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),_(fe),pe=xe.pending,xe.pending===xe.pending_buf_size)){Me=1;break}Me=xe.gzindex<xe.gzhead.comment.length?255&xe.gzhead.comment.charCodeAt(xe.gzindex++):0,c(xe,Me)}while(0!==Me);xe.gzhead.hcrc&&xe.pending>pe&&(fe.adler=L(fe.adler,xe.pending_buf,xe.pending-pe,pe)),0===Me&&(xe.status=103)}else xe.status=103;if(103===xe.status&&(xe.gzhead.hcrc?(xe.pending+2>xe.pending_buf_size&&_(fe),xe.pending+2<=xe.pending_buf_size&&(c(xe,255&fe.adler),c(xe,fe.adler>>8&255),fe.adler=0,xe.status=y)):xe.status=y),0!==xe.pending){if(_(fe),0===fe.avail_out)return xe.last_flush=-1,0}else if(0===fe.avail_in&&B(Pe)<=B(be)&&4!==Pe)return ge(fe,-5);if(666===xe.status&&0!==fe.avail_in)return ge(fe,-5);if(0!==fe.avail_in||0!==xe.lookahead||0!==Pe&&666!==xe.status){var ae=2===xe.strategy?function(he,Ee){for(var C;;){if(0===he.lookahead&&(p(he),0===he.lookahead)){if(0===Ee)return 1;break}if(he.match_length=0,C=v._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,C&&(l(he,!1),0===he.strm.avail_out))return 1}return he.insert=0,4===Ee?(l(he,!0),0===he.strm.avail_out?3:4):he.last_lit&&(l(he,!1),0===he.strm.avail_out)?1:2}(xe,Pe):3===xe.strategy?function(he,Ee){for(var C,V,$e,Te,Fe=he.window;;){if(he.lookahead<=U){if(p(he),he.lookahead<=U&&0===Ee)return 1;if(0===he.lookahead)break}if(he.match_length=0,he.lookahead>=3&&0<he.strstart&&(V=Fe[$e=he.strstart-1])===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]){Te=he.strstart+U;do{}while(V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&V===Fe[++$e]&&$e<Te);he.match_length=U-(Te-$e),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=3?(C=v._tr_tally(he,1,he.match_length-3),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):(C=v._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),C&&(l(he,!1),0===he.strm.avail_out))return 1}return he.insert=0,4===Ee?(l(he,!0),0===he.strm.avail_out?3:4):he.last_lit&&(l(he,!1),0===he.strm.avail_out)?1:2}(xe,Pe):T[xe.level].func(xe,Pe);if(3!==ae&&4!==ae||(xe.status=666),1===ae||3===ae)return 0===fe.avail_out&&(xe.last_flush=-1),0;if(2===ae&&(1===Pe?v._tr_align(xe):5!==Pe&&(v._tr_stored_block(xe,0,0,!1),3===Pe&&(O(xe.head),0===xe.lookahead&&(xe.strstart=0,xe.block_start=0,xe.insert=0))),_(fe),0===fe.avail_out))return xe.last_flush=-1,0}return 4!==Pe?0:xe.wrap<=0?1:(2===xe.wrap?(c(xe,255&fe.adler),c(xe,fe.adler>>8&255),c(xe,fe.adler>>16&255),c(xe,fe.adler>>24&255),c(xe,255&fe.total_in),c(xe,fe.total_in>>8&255),c(xe,fe.total_in>>16&255),c(xe,fe.total_in>>24&255)):(h(xe,fe.adler>>>16),h(xe,65535&fe.adler)),_(fe),0<xe.wrap&&(xe.wrap=-xe.wrap),0!==xe.pending?0:1)},f.deflateEnd=function(fe){var Pe;return fe&&fe.state?42!==(Pe=fe.state.status)&&69!==Pe&&73!==Pe&&91!==Pe&&103!==Pe&&Pe!==y&&666!==Pe?ge(fe,Z):(fe.state=null,Pe===y?ge(fe,-3):0):Z},f.deflateSetDictionary=function(fe,Pe){var be,xe,pe,Me,Ce,ae,he,Ee,C=Pe.length;if(!fe||!fe.state||2===(Me=(be=fe.state).wrap)||1===Me&&42!==be.status||be.lookahead)return Z;for(1===Me&&(fe.adler=S(fe.adler,Pe,C,0)),be.wrap=0,C>=be.w_size&&(0===Me&&(O(be.head),be.strstart=0,be.block_start=0,be.insert=0),Ee=new ne.Buf8(be.w_size),ne.arraySet(Ee,Pe,C-be.w_size,be.w_size,0),Pe=Ee,C=be.w_size),Ce=fe.avail_in,ae=fe.next_in,he=fe.input,fe.avail_in=C,fe.next_in=0,fe.input=Pe,p(be);be.lookahead>=3;){for(xe=be.strstart,pe=be.lookahead-2;be.ins_h=(be.ins_h<<be.hash_shift^be.window[xe+3-1])&be.hash_mask,be.prev[xe&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=xe,xe++,--pe;);be.strstart=xe,be.lookahead=2,p(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=2,be.match_available=0,fe.next_in=ae,fe.input=he,fe.avail_in=Ce,be.wrap=Me,0},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(de,ye,f){"use strict";ye.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(de,ye,f){"use strict";ye.exports=function(T,ne){var v,S,L,D,J,j,F,Z,X,K,P,H,le,q,Y,Q,k,N,te,U,I,A,y,R,z;R=T.input,L=(S=T.next_in)+(T.avail_in-5),z=T.output,J=(D=T.next_out)-(ne-T.avail_out),j=D+(T.avail_out-257),F=(v=T.state).dmax,Z=v.wsize,X=v.whave,K=v.wnext,P=v.window,H=v.hold,le=v.bits,q=v.lencode,Y=v.distcode,Q=(1<<v.lenbits)-1,k=(1<<v.distbits)-1;e:do{le<15&&(H+=R[S++]<<le,H+=R[S++]<<(le+=8),le+=8),N=q[H&Q];t:for(;;){if(H>>>=te=N>>>24,le-=te,0==(te=N>>>16&255))z[D++]=65535&N;else{if(!(16&te)){if(0==(64&te)){N=q[(65535&N)+(H&(1<<te)-1)];continue t}if(32&te){v.mode=12;break e}T.msg="invalid literal/length code",v.mode=30;break e}U=65535&N,(te&=15)&&(le<te&&(H+=R[S++]<<le,le+=8),U+=H&(1<<te)-1,H>>>=te,le-=te),le<15&&(H+=R[S++]<<le,H+=R[S++]<<(le+=8),le+=8),N=Y[H&k];n:for(;;){if(H>>>=te=N>>>24,le-=te,!(16&(te=N>>>16&255))){if(0==(64&te)){N=Y[(65535&N)+(H&(1<<te)-1)];continue n}T.msg="invalid distance code",v.mode=30;break e}if(I=65535&N,le<(te&=15)&&(H+=R[S++]<<le,(le+=8)<te&&(H+=R[S++]<<le,le+=8)),F<(I+=H&(1<<te)-1)){T.msg="invalid distance too far back",v.mode=30;break e}if(H>>>=te,le-=te,(te=D-J)<I){if(X<(te=I-te)&&v.sane){T.msg="invalid distance too far back",v.mode=30;break e}if(y=P,(A=0)===K){if(A+=Z-te,te<U){for(U-=te;z[D++]=P[A++],--te;);A=D-I,y=z}}else if(K<te){if(A+=Z+K-te,(te-=K)<U){for(U-=te;z[D++]=P[A++],--te;);if(A=0,K<U){for(U-=te=K;z[D++]=P[A++],--te;);A=D-I,y=z}}}else if(A+=K-te,te<U){for(U-=te;z[D++]=P[A++],--te;);A=D-I,y=z}for(;2<U;)z[D++]=y[A++],z[D++]=y[A++],z[D++]=y[A++],U-=3;U&&(z[D++]=y[A++],1<U&&(z[D++]=y[A++]))}else{for(A=D-I;z[D++]=z[A++],z[D++]=z[A++],z[D++]=z[A++],2<(U-=3););U&&(z[D++]=z[A++],1<U&&(z[D++]=z[A++]))}break}}break}}while(S<L&&D<j);S-=U=le>>3,H&=(1<<(le-=U<<3))-1,T.next_in=S,T.next_out=D,T.avail_in=S<L?L-S+5:5-(S-L),T.avail_out=D<j?j-D+257:257-(D-j),v.hold=H,v.bits=le}},{}],49:[function(de,ye,f){"use strict";var T=de("../utils/common"),ne=de("./adler32"),v=de("./crc32"),S=de("./inffast"),L=de("./inftrees"),F=-2;function P(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function H(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new T.Buf16(320),this.work=new T.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function le(A){var y;return A&&A.state?(A.total_in=A.total_out=(y=A.state).total=0,A.msg="",y.wrap&&(A.adler=1&y.wrap),y.mode=1,y.last=0,y.havedict=0,y.dmax=32768,y.head=null,y.hold=0,y.bits=0,y.lencode=y.lendyn=new T.Buf32(852),y.distcode=y.distdyn=new T.Buf32(592),y.sane=1,y.back=-1,0):F}function q(A){var y;return A&&A.state?((y=A.state).wsize=0,y.whave=0,y.wnext=0,le(A)):F}function Y(A,y){var R,z;return A&&A.state?(z=A.state,y<0?(R=0,y=-y):(R=1+(y>>4),y<48&&(y&=15)),y&&(y<8||15<y)?F:(null!==z.window&&z.wbits!==y&&(z.window=null),z.wrap=R,z.wbits=y,q(A))):F}function Q(A,y){var R,z;return A?(z=new H,(A.state=z).window=null,0!==(R=Y(A,y))&&(A.state=null),R):F}var k,N,te=!0;function U(A){if(te){var y;for(k=new T.Buf32(512),N=new T.Buf32(32),y=0;y<144;)A.lens[y++]=8;for(;y<256;)A.lens[y++]=9;for(;y<280;)A.lens[y++]=7;for(;y<288;)A.lens[y++]=8;for(L(1,A.lens,0,288,k,0,A.work,{bits:9}),y=0;y<32;)A.lens[y++]=5;L(2,A.lens,0,32,N,0,A.work,{bits:5}),te=!1}A.lencode=k,A.lenbits=9,A.distcode=N,A.distbits=5}function I(A,y,R,z){var ie,M=A.state;return null===M.window&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new T.Buf8(M.wsize)),z>=M.wsize?(T.arraySet(M.window,y,R-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(z<(ie=M.wsize-M.wnext)&&(ie=z),T.arraySet(M.window,y,R-z,ie,M.wnext),(z-=ie)?(T.arraySet(M.window,y,R-z,z,0),M.wnext=z,M.whave=M.wsize):(M.wnext+=ie,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=ie))),0}f.inflateReset=q,f.inflateReset2=Y,f.inflateResetKeep=le,f.inflateInit=function(A){return Q(A,15)},f.inflateInit2=Q,f.inflate=function(A,y){var R,z,ie,M,ge,B,O,_,l,c,h,d,p,m,x,$,re,se,De,Ae,fe,Pe,be,xe,pe=0,Me=new T.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&0!==A.avail_in)return F;12===(R=A.state).mode&&(R.mode=13),ge=A.next_out,ie=A.output,M=A.next_in,z=A.input,_=R.hold,l=R.bits,c=B=A.avail_in,h=O=A.avail_out,Pe=0;e:for(;;)switch(R.mode){case 1:if(0===R.wrap){R.mode=13;break}for(;l<16;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(2&R.wrap&&35615===_){Me[R.check=0]=255&_,Me[1]=_>>>8&255,R.check=v(R.check,Me,2,0),l=_=0,R.mode=2;break}if(R.flags=0,R.head&&(R.head.done=!1),!(1&R.wrap)||(((255&_)<<8)+(_>>8))%31){A.msg="incorrect header check",R.mode=30;break}if(8!=(15&_)){A.msg="unknown compression method",R.mode=30;break}if(l-=4,fe=8+(15&(_>>>=4)),0===R.wbits)R.wbits=fe;else if(fe>R.wbits){A.msg="invalid window size",R.mode=30;break}R.dmax=1<<fe,A.adler=R.check=1,R.mode=512&_?10:12,l=_=0;break;case 2:for(;l<16;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(R.flags=_,8!=(255&R.flags)){A.msg="unknown compression method",R.mode=30;break}if(57344&R.flags){A.msg="unknown header flags set",R.mode=30;break}R.head&&(R.head.text=_>>8&1),512&R.flags&&(Me[0]=255&_,Me[1]=_>>>8&255,R.check=v(R.check,Me,2,0)),l=_=0,R.mode=3;case 3:for(;l<32;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.head&&(R.head.time=_),512&R.flags&&(Me[0]=255&_,Me[1]=_>>>8&255,Me[2]=_>>>16&255,Me[3]=_>>>24&255,R.check=v(R.check,Me,4,0)),l=_=0,R.mode=4;case 4:for(;l<16;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.head&&(R.head.xflags=255&_,R.head.os=_>>8),512&R.flags&&(Me[0]=255&_,Me[1]=_>>>8&255,R.check=v(R.check,Me,2,0)),l=_=0,R.mode=5;case 5:if(1024&R.flags){for(;l<16;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.length=_,R.head&&(R.head.extra_len=_),512&R.flags&&(Me[0]=255&_,Me[1]=_>>>8&255,R.check=v(R.check,Me,2,0)),l=_=0}else R.head&&(R.head.extra=null);R.mode=6;case 6:if(1024&R.flags&&(B<(d=R.length)&&(d=B),d&&(R.head&&(fe=R.head.extra_len-R.length,R.head.extra||(R.head.extra=new Array(R.head.extra_len)),T.arraySet(R.head.extra,z,M,d,fe)),512&R.flags&&(R.check=v(R.check,z,d,M)),B-=d,M+=d,R.length-=d),R.length))break e;R.length=0,R.mode=7;case 7:if(2048&R.flags){if(0===B)break e;for(d=0;fe=z[M+d++],R.head&&fe&&R.length<65536&&(R.head.name+=String.fromCharCode(fe)),fe&&d<B;);if(512&R.flags&&(R.check=v(R.check,z,d,M)),B-=d,M+=d,fe)break e}else R.head&&(R.head.name=null);R.length=0,R.mode=8;case 8:if(4096&R.flags){if(0===B)break e;for(d=0;fe=z[M+d++],R.head&&fe&&R.length<65536&&(R.head.comment+=String.fromCharCode(fe)),fe&&d<B;);if(512&R.flags&&(R.check=v(R.check,z,d,M)),B-=d,M+=d,fe)break e}else R.head&&(R.head.comment=null);R.mode=9;case 9:if(512&R.flags){for(;l<16;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(_!==(65535&R.check)){A.msg="header crc mismatch",R.mode=30;break}l=_=0}R.head&&(R.head.hcrc=R.flags>>9&1,R.head.done=!0),A.adler=R.check=0,R.mode=12;break;case 10:for(;l<32;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}A.adler=R.check=P(_),l=_=0,R.mode=11;case 11:if(0===R.havedict)return A.next_out=ge,A.avail_out=O,A.next_in=M,A.avail_in=B,R.hold=_,R.bits=l,2;A.adler=R.check=1,R.mode=12;case 12:if(5===y||6===y)break e;case 13:if(R.last){_>>>=7&l,l-=7&l,R.mode=27;break}for(;l<3;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}switch(R.last=1&_,l-=1,3&(_>>>=1)){case 0:R.mode=14;break;case 1:if(U(R),R.mode=20,6!==y)break;_>>>=2,l-=2;break e;case 2:R.mode=17;break;case 3:A.msg="invalid block type",R.mode=30}_>>>=2,l-=2;break;case 14:for(_>>>=7&l,l-=7&l;l<32;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if((65535&_)!=(_>>>16^65535)){A.msg="invalid stored block lengths",R.mode=30;break}if(R.length=65535&_,l=_=0,R.mode=15,6===y)break e;case 15:R.mode=16;case 16:if(d=R.length){if(B<d&&(d=B),O<d&&(d=O),0===d)break e;T.arraySet(ie,z,M,d,ge),B-=d,M+=d,O-=d,ge+=d,R.length-=d;break}R.mode=12;break;case 17:for(;l<14;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(R.nlen=257+(31&_),l-=5,R.ndist=1+(31&(_>>>=5)),l-=5,R.ncode=4+(15&(_>>>=5)),_>>>=4,l-=4,286<R.nlen||30<R.ndist){A.msg="too many length or distance symbols",R.mode=30;break}R.have=0,R.mode=18;case 18:for(;R.have<R.ncode;){for(;l<3;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.lens[Ce[R.have++]]=7&_,_>>>=3,l-=3}for(;R.have<19;)R.lens[Ce[R.have++]]=0;if(R.lencode=R.lendyn,R.lenbits=7,Pe=L(0,R.lens,0,19,R.lencode,0,R.work,be={bits:R.lenbits}),R.lenbits=be.bits,Pe){A.msg="invalid code lengths set",R.mode=30;break}R.have=0,R.mode=19;case 19:for(;R.have<R.nlen+R.ndist;){for(;$=(pe=R.lencode[_&(1<<R.lenbits)-1])>>>16&255,re=65535&pe,!((x=pe>>>24)<=l);){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(re<16)_>>>=x,l-=x,R.lens[R.have++]=re;else{if(16===re){for(xe=x+2;l<xe;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(_>>>=x,l-=x,0===R.have){A.msg="invalid bit length repeat",R.mode=30;break}fe=R.lens[R.have-1],d=3+(3&_),_>>>=2,l-=2}else if(17===re){for(xe=x+3;l<xe;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}l-=x,fe=0,d=3+(7&(_>>>=x)),_>>>=3,l-=3}else{for(xe=x+7;l<xe;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}l-=x,fe=0,d=11+(127&(_>>>=x)),_>>>=7,l-=7}if(R.have+d>R.nlen+R.ndist){A.msg="invalid bit length repeat",R.mode=30;break}for(;d--;)R.lens[R.have++]=fe}}if(30===R.mode)break;if(0===R.lens[256]){A.msg="invalid code -- missing end-of-block",R.mode=30;break}if(R.lenbits=9,Pe=L(1,R.lens,0,R.nlen,R.lencode,0,R.work,be={bits:R.lenbits}),R.lenbits=be.bits,Pe){A.msg="invalid literal/lengths set",R.mode=30;break}if(R.distbits=6,R.distcode=R.distdyn,Pe=L(2,R.lens,R.nlen,R.ndist,R.distcode,0,R.work,be={bits:R.distbits}),R.distbits=be.bits,Pe){A.msg="invalid distances set",R.mode=30;break}if(R.mode=20,6===y)break e;case 20:R.mode=21;case 21:if(6<=B&&258<=O){A.next_out=ge,A.avail_out=O,A.next_in=M,A.avail_in=B,R.hold=_,R.bits=l,S(A,h),ge=A.next_out,ie=A.output,O=A.avail_out,M=A.next_in,z=A.input,B=A.avail_in,_=R.hold,l=R.bits,12===R.mode&&(R.back=-1);break}for(R.back=0;$=(pe=R.lencode[_&(1<<R.lenbits)-1])>>>16&255,re=65535&pe,!((x=pe>>>24)<=l);){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if($&&0==(240&$)){for(se=x,De=$,Ae=re;$=(pe=R.lencode[Ae+((_&(1<<se+De)-1)>>se)])>>>16&255,re=65535&pe,!(se+(x=pe>>>24)<=l);){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}_>>>=se,l-=se,R.back+=se}if(_>>>=x,l-=x,R.back+=x,R.length=re,0===$){R.mode=26;break}if(32&$){R.back=-1,R.mode=12;break}if(64&$){A.msg="invalid literal/length code",R.mode=30;break}R.extra=15&$,R.mode=22;case 22:if(R.extra){for(xe=R.extra;l<xe;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.length+=_&(1<<R.extra)-1,_>>>=R.extra,l-=R.extra,R.back+=R.extra}R.was=R.length,R.mode=23;case 23:for(;$=(pe=R.distcode[_&(1<<R.distbits)-1])>>>16&255,re=65535&pe,!((x=pe>>>24)<=l);){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(0==(240&$)){for(se=x,De=$,Ae=re;$=(pe=R.distcode[Ae+((_&(1<<se+De)-1)>>se)])>>>16&255,re=65535&pe,!(se+(x=pe>>>24)<=l);){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}_>>>=se,l-=se,R.back+=se}if(_>>>=x,l-=x,R.back+=x,64&$){A.msg="invalid distance code",R.mode=30;break}R.offset=re,R.extra=15&$,R.mode=24;case 24:if(R.extra){for(xe=R.extra;l<xe;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}R.offset+=_&(1<<R.extra)-1,_>>>=R.extra,l-=R.extra,R.back+=R.extra}if(R.offset>R.dmax){A.msg="invalid distance too far back",R.mode=30;break}R.mode=25;case 25:if(0===O)break e;if(R.offset>(d=h-O)){if((d=R.offset-d)>R.whave&&R.sane){A.msg="invalid distance too far back",R.mode=30;break}p=d>R.wnext?R.wsize-(d-=R.wnext):R.wnext-d,d>R.length&&(d=R.length),m=R.window}else m=ie,p=ge-R.offset,d=R.length;for(O<d&&(d=O),O-=d,R.length-=d;ie[ge++]=m[p++],--d;);0===R.length&&(R.mode=21);break;case 26:if(0===O)break e;ie[ge++]=R.length,O--,R.mode=21;break;case 27:if(R.wrap){for(;l<32;){if(0===B)break e;B--,_|=z[M++]<<l,l+=8}if(A.total_out+=h-=O,R.total+=h,h&&(A.adler=R.check=R.flags?v(R.check,ie,h,ge-h):ne(R.check,ie,h,ge-h)),h=O,(R.flags?_:P(_))!==R.check){A.msg="incorrect data check",R.mode=30;break}l=_=0}R.mode=28;case 28:if(R.wrap&&R.flags){for(;l<32;){if(0===B)break e;B--,_+=z[M++]<<l,l+=8}if(_!==(4294967295&R.total)){A.msg="incorrect length check",R.mode=30;break}l=_=0}R.mode=29;case 29:Pe=1;break e;case 30:Pe=-3;break e;case 31:return-4;default:return F}return A.next_out=ge,A.avail_out=O,A.next_in=M,A.avail_in=B,R.hold=_,R.bits=l,(R.wsize||h!==A.avail_out&&R.mode<30&&(R.mode<27||4!==y))&&I(A,A.output,A.next_out,h-A.avail_out)?(R.mode=31,-4):(h-=A.avail_out,A.total_in+=c-=A.avail_in,A.total_out+=h,R.total+=h,R.wrap&&h&&(A.adler=R.check=R.flags?v(R.check,ie,h,A.next_out-h):ne(R.check,ie,h,A.next_out-h)),A.data_type=R.bits+(R.last?64:0)+(12===R.mode?128:0)+(20===R.mode||15===R.mode?256:0),(0==c&&0===h||4===y)&&0===Pe&&(Pe=-5),Pe)},f.inflateEnd=function(A){if(!A||!A.state)return F;var y=A.state;return y.window&&(y.window=null),A.state=null,0},f.inflateGetHeader=function(A,y){var R;return A&&A.state?0==(2&(R=A.state).wrap)?F:((R.head=y).done=!1,0):F},f.inflateSetDictionary=function(A,y){var R,z=y.length;return A&&A.state?0!==(R=A.state).wrap&&11!==R.mode?F:11===R.mode&&ne(1,y,z,0)!==R.check?-3:I(A,y,z,z)?(R.mode=31,-4):(R.havedict=1,0):F},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(de,ye,f){"use strict";var T=de("../utils/common"),ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],L=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];ye.exports=function(D,J,j,F,Z,X,K,P){var H,le,q,Y,Q,k,N,te,U,I=P.bits,A=0,y=0,R=0,z=0,ie=0,M=0,ge=0,B=0,O=0,_=0,l=null,c=0,h=new T.Buf16(16),d=new T.Buf16(16),p=null,m=0;for(A=0;A<=15;A++)h[A]=0;for(y=0;y<F;y++)h[J[j+y]]++;for(ie=I,z=15;1<=z&&0===h[z];z--);if(z<ie&&(ie=z),0===z)return Z[X++]=20971520,Z[X++]=20971520,P.bits=1,0;for(R=1;R<z&&0===h[R];R++);for(ie<R&&(ie=R),A=B=1;A<=15;A++)if(B<<=1,(B-=h[A])<0)return-1;if(0<B&&(0===D||1!==z))return-1;for(d[1]=0,A=1;A<15;A++)d[A+1]=d[A]+h[A];for(y=0;y<F;y++)0!==J[j+y]&&(K[d[J[j+y]]++]=y);if(k=0===D?(l=p=K,19):1===D?(l=ne,c-=257,p=v,m-=257,256):(l=S,p=L,-1),A=R,Q=X,ge=y=_=0,q=-1,Y=(O=1<<(M=ie))-1,1===D&&852<O||2===D&&592<O)return 1;for(;;){for(N=A-ge,U=K[y]<k?(te=0,K[y]):K[y]>k?(te=p[m+K[y]],l[c+K[y]]):(te=96,0),H=1<<A-ge,R=le=1<<M;Z[Q+(_>>ge)+(le-=H)]=N<<24|te<<16|U|0,0!==le;);for(H=1<<A-1;_&H;)H>>=1;if(0!==H?(_&=H-1,_+=H):_=0,y++,0==--h[A]){if(A===z)break;A=J[j+K[y]]}if(ie<A&&(_&Y)!==q){for(0===ge&&(ge=ie),Q+=R,B=1<<(M=A-ge);M+ge<z&&!((B-=h[M+ge])<=0);)M++,B<<=1;if(O+=1<<M,1===D&&852<O||2===D&&592<O)return 1;Z[q=_&Y]=ie<<24|M<<16|Q-X|0}}return 0!==_&&(Z[Q+_]=A-ge<<24|64<<16|0),P.bits=ie,0}},{"../utils/common":41}],51:[function(de,ye,f){"use strict";ye.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(de,ye,f){"use strict";var T=de("../utils/common");function S(pe){for(var Me=pe.length;0<=--Me;)pe[Me]=0}var J=256,j=286,F=30,K=15,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=new Array(576);S(I);var A=new Array(60);S(A);var y=new Array(512);S(y);var R=new Array(256);S(R);var z=new Array(29);S(z);var ie,M,ge,B=new Array(F);function O(pe,Me,Ce,ae,he){this.static_tree=pe,this.extra_bits=Me,this.extra_base=Ce,this.elems=ae,this.max_length=he,this.has_stree=pe&&pe.length}function _(pe,Me){this.dyn_tree=pe,this.max_code=0,this.stat_desc=Me}function l(pe){return pe<256?y[pe]:y[256+(pe>>>7)]}function c(pe,Me){pe.pending_buf[pe.pending++]=255&Me,pe.pending_buf[pe.pending++]=Me>>>8&255}function h(pe,Me,Ce){pe.bi_valid>16-Ce?(pe.bi_buf|=Me<<pe.bi_valid&65535,c(pe,pe.bi_buf),pe.bi_buf=Me>>16-pe.bi_valid,pe.bi_valid+=Ce-16):(pe.bi_buf|=Me<<pe.bi_valid&65535,pe.bi_valid+=Ce)}function d(pe,Me,Ce){h(pe,Ce[2*Me],Ce[2*Me+1])}function p(pe,Me){for(var Ce=0;Ce|=1&pe,pe>>>=1,Ce<<=1,0<--Me;);return Ce>>>1}function m(pe,Me,Ce){var ae,he,Ee=new Array(16),C=0;for(ae=1;ae<=K;ae++)Ee[ae]=C=C+Ce[ae-1]<<1;for(he=0;he<=Me;he++){var V=pe[2*he+1];0!==V&&(pe[2*he]=p(Ee[V]++,V))}}function x(pe){var Me;for(Me=0;Me<j;Me++)pe.dyn_ltree[2*Me]=0;for(Me=0;Me<F;Me++)pe.dyn_dtree[2*Me]=0;for(Me=0;Me<19;Me++)pe.bl_tree[2*Me]=0;pe.dyn_ltree[512]=1,pe.opt_len=pe.static_len=0,pe.last_lit=pe.matches=0}function $(pe){8<pe.bi_valid?c(pe,pe.bi_buf):0<pe.bi_valid&&(pe.pending_buf[pe.pending++]=pe.bi_buf),pe.bi_buf=0,pe.bi_valid=0}function re(pe,Me,Ce,ae){var he=2*Me,Ee=2*Ce;return pe[he]<pe[Ee]||pe[he]===pe[Ee]&&ae[Me]<=ae[Ce]}function se(pe,Me,Ce){for(var ae=pe.heap[Ce],he=Ce<<1;he<=pe.heap_len&&(he<pe.heap_len&&re(Me,pe.heap[he+1],pe.heap[he],pe.depth)&&he++,!re(Me,ae,pe.heap[he],pe.depth));)pe.heap[Ce]=pe.heap[he],Ce=he,he<<=1;pe.heap[Ce]=ae}function De(pe,Me,Ce){var ae,he,Ee,C,V=0;if(0!==pe.last_lit)for(;ae=pe.pending_buf[pe.d_buf+2*V]<<8|pe.pending_buf[pe.d_buf+2*V+1],he=pe.pending_buf[pe.l_buf+V],V++,0===ae?d(pe,he,Me):(d(pe,(Ee=R[he])+J+1,Me),0!==(C=k[Ee])&&h(pe,he-=z[Ee],C),d(pe,Ee=l(--ae),Ce),0!==(C=N[Ee])&&h(pe,ae-=B[Ee],C)),V<pe.last_lit;);d(pe,256,Me)}function Ae(pe,Me){var Ce,ae,he,Ee=Me.dyn_tree,C=Me.stat_desc.static_tree,V=Me.stat_desc.has_stree,$e=Me.stat_desc.elems,Te=-1;for(pe.heap_len=0,pe.heap_max=573,Ce=0;Ce<$e;Ce++)0!==Ee[2*Ce]?(pe.heap[++pe.heap_len]=Te=Ce,pe.depth[Ce]=0):Ee[2*Ce+1]=0;for(;pe.heap_len<2;)Ee[2*(he=pe.heap[++pe.heap_len]=Te<2?++Te:0)]=1,pe.depth[he]=0,pe.opt_len--,V&&(pe.static_len-=C[2*he+1]);for(Me.max_code=Te,Ce=pe.heap_len>>1;1<=Ce;Ce--)se(pe,Ee,Ce);for(he=$e;Ce=pe.heap[1],pe.heap[1]=pe.heap[pe.heap_len--],se(pe,Ee,1),ae=pe.heap[1],pe.heap[--pe.heap_max]=Ce,pe.heap[--pe.heap_max]=ae,Ee[2*he]=Ee[2*Ce]+Ee[2*ae],pe.depth[he]=(pe.depth[Ce]>=pe.depth[ae]?pe.depth[Ce]:pe.depth[ae])+1,Ee[2*Ce+1]=Ee[2*ae+1]=he,pe.heap[1]=he++,se(pe,Ee,1),2<=pe.heap_len;);pe.heap[--pe.heap_max]=pe.heap[1],function(Fe,Ue){var Ze,lt,Et,It,hn,nn,Bn=Ue.dyn_tree,Ln=Ue.max_code,ar=Ue.stat_desc.static_tree,Hs=Ue.stat_desc.has_stree,Tl=Ue.stat_desc.extra_bits,$c=Ue.stat_desc.extra_base,Qo=Ue.stat_desc.max_length,Sl=0;for(It=0;It<=K;It++)Fe.bl_count[It]=0;for(Bn[2*Fe.heap[Fe.heap_max]+1]=0,Ze=Fe.heap_max+1;Ze<573;Ze++)Qo<(It=Bn[2*Bn[2*(lt=Fe.heap[Ze])+1]+1]+1)&&(It=Qo,Sl++),Bn[2*lt+1]=It,Ln<lt||(Fe.bl_count[It]++,hn=0,$c<=lt&&(hn=Tl[lt-$c]),Fe.opt_len+=(nn=Bn[2*lt])*(It+hn),Hs&&(Fe.static_len+=nn*(ar[2*lt+1]+hn)));if(0!==Sl){do{for(It=Qo-1;0===Fe.bl_count[It];)It--;Fe.bl_count[It]--,Fe.bl_count[It+1]+=2,Fe.bl_count[Qo]--,Sl-=2}while(0<Sl);for(It=Qo;0!==It;It--)for(lt=Fe.bl_count[It];0!==lt;)Ln<(Et=Fe.heap[--Ze])||(Bn[2*Et+1]!==It&&(Fe.opt_len+=(It-Bn[2*Et+1])*Bn[2*Et],Bn[2*Et+1]=It),lt--)}}(pe,Me),m(Ee,Te,pe.bl_count)}function fe(pe,Me,Ce){var ae,he,Ee=-1,C=Me[1],V=0,$e=7,Te=4;for(0===C&&($e=138,Te=3),Me[2*(Ce+1)+1]=65535,ae=0;ae<=Ce;ae++)he=C,C=Me[2*(ae+1)+1],++V<$e&&he===C||(V<Te?pe.bl_tree[2*he]+=V:0!==he?(he!==Ee&&pe.bl_tree[2*he]++,pe.bl_tree[32]++):V<=10?pe.bl_tree[34]++:pe.bl_tree[36]++,Ee=he,Te=(V=0)===C?($e=138,3):he===C?($e=6,3):($e=7,4))}function Pe(pe,Me,Ce){var ae,he,Ee=-1,C=Me[1],V=0,$e=7,Te=4;for(0===C&&($e=138,Te=3),ae=0;ae<=Ce;ae++)if(he=C,C=Me[2*(ae+1)+1],!(++V<$e&&he===C)){if(V<Te)for(;d(pe,he,pe.bl_tree),0!=--V;);else 0!==he?(he!==Ee&&(d(pe,he,pe.bl_tree),V--),d(pe,16,pe.bl_tree),h(pe,V-3,2)):V<=10?(d(pe,17,pe.bl_tree),h(pe,V-3,3)):(d(pe,18,pe.bl_tree),h(pe,V-11,7));Ee=he,Te=(V=0)===C?($e=138,3):he===C?($e=6,3):($e=7,4)}}S(B);var be=!1;function xe(pe,Me,Ce,ae){var he,Ee,C;h(pe,0+(ae?1:0),3),Ee=Me,C=Ce,$(he=pe),c(he,C),c(he,~C),T.arraySet(he.pending_buf,he.window,Ee,C,he.pending),he.pending+=C}f._tr_init=function(pe){be||(function(){var Me,Ce,ae,he,Ee,C=new Array(16);for(he=ae=0;he<28;he++)for(z[he]=ae,Me=0;Me<1<<k[he];Me++)R[ae++]=he;for(R[ae-1]=he,he=Ee=0;he<16;he++)for(B[he]=Ee,Me=0;Me<1<<N[he];Me++)y[Ee++]=he;for(Ee>>=7;he<F;he++)for(B[he]=Ee<<7,Me=0;Me<1<<N[he]-7;Me++)y[256+Ee++]=he;for(Ce=0;Ce<=K;Ce++)C[Ce]=0;for(Me=0;Me<=143;)I[2*Me+1]=8,Me++,C[8]++;for(;Me<=255;)I[2*Me+1]=9,Me++,C[9]++;for(;Me<=279;)I[2*Me+1]=7,Me++,C[7]++;for(;Me<=287;)I[2*Me+1]=8,Me++,C[8]++;for(m(I,287,C),Me=0;Me<F;Me++)A[2*Me+1]=5,A[2*Me]=p(Me,5);ie=new O(I,k,257,j,K),M=new O(A,N,0,F,K),ge=new O(new Array(0),te,0,19,7)}(),be=!0),pe.l_desc=new _(pe.dyn_ltree,ie),pe.d_desc=new _(pe.dyn_dtree,M),pe.bl_desc=new _(pe.bl_tree,ge),pe.bi_buf=0,pe.bi_valid=0,x(pe)},f._tr_stored_block=xe,f._tr_flush_block=function(pe,Me,Ce,ae){var he,Ee,C=0;0<pe.level?(2===pe.strm.data_type&&(pe.strm.data_type=function(V){var $e,Te=4093624447;for($e=0;$e<=31;$e++,Te>>>=1)if(1&Te&&0!==V.dyn_ltree[2*$e])return 0;if(0!==V.dyn_ltree[18]||0!==V.dyn_ltree[20]||0!==V.dyn_ltree[26])return 1;for($e=32;$e<J;$e++)if(0!==V.dyn_ltree[2*$e])return 1;return 0}(pe)),Ae(pe,pe.l_desc),Ae(pe,pe.d_desc),C=function(V){var $e;for(fe(V,V.dyn_ltree,V.l_desc.max_code),fe(V,V.dyn_dtree,V.d_desc.max_code),Ae(V,V.bl_desc),$e=18;3<=$e&&0===V.bl_tree[2*U[$e]+1];$e--);return V.opt_len+=3*($e+1)+5+5+4,$e}(pe),(Ee=pe.static_len+3+7>>>3)<=(he=pe.opt_len+3+7>>>3)&&(he=Ee)):he=Ee=Ce+5,Ce+4<=he&&-1!==Me?xe(pe,Me,Ce,ae):4===pe.strategy||Ee===he?(h(pe,2+(ae?1:0),3),De(pe,I,A)):(h(pe,4+(ae?1:0),3),function(V,$e,Te,Fe){var Ue;for(h(V,$e-257,5),h(V,Te-1,5),h(V,Fe-4,4),Ue=0;Ue<Fe;Ue++)h(V,V.bl_tree[2*U[Ue]+1],3);Pe(V,V.dyn_ltree,$e-1),Pe(V,V.dyn_dtree,Te-1)}(pe,pe.l_desc.max_code+1,pe.d_desc.max_code+1,C+1),De(pe,pe.dyn_ltree,pe.dyn_dtree)),x(pe),ae&&$(pe)},f._tr_tally=function(pe,Me,Ce){return pe.pending_buf[pe.d_buf+2*pe.last_lit]=Me>>>8&255,pe.pending_buf[pe.d_buf+2*pe.last_lit+1]=255&Me,pe.pending_buf[pe.l_buf+pe.last_lit]=255&Ce,pe.last_lit++,0===Me?pe.dyn_ltree[2*Ce]++:(pe.matches++,Me--,pe.dyn_ltree[2*(R[Ce]+J+1)]++,pe.dyn_dtree[2*l(Me)]++),pe.last_lit===pe.lit_bufsize-1},f._tr_align=function(pe){var Me;h(pe,2,3),d(pe,256,I),16===(Me=pe).bi_valid?(c(Me,Me.bi_buf),Me.bi_buf=0,Me.bi_valid=0):8<=Me.bi_valid&&(Me.pending_buf[Me.pending++]=255&Me.bi_buf,Me.bi_buf>>=8,Me.bi_valid-=8)}},{"../utils/common":41}],53:[function(de,ye,f){"use strict";ye.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(de,ye,f){"use strict";ye.exports="function"==typeof setImmediate?setImmediate:function(){var T=[].slice.apply(arguments);T.splice(1,0,0),setTimeout.apply(null,T)}},{}]},{},[10])(10)},7489:function(E,de,ye){var f;E=ye.nmd(E),function(){var T,L="Expected a function",J="__lodash_hash_undefined__",F="__lodash_placeholder__",N=32,U=128,O=1/0,_=9007199254740991,c=NaN,h=4294967295,m=[["ary",U],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",N],["partialRight",64],["rearg",256]],x="[object Arguments]",$="[object Array]",se="[object Boolean]",De="[object Date]",fe="[object Error]",Pe="[object Function]",be="[object GeneratorFunction]",xe="[object Map]",pe="[object Number]",Ce="[object Object]",ae="[object Promise]",Ee="[object RegExp]",C="[object Set]",V="[object String]",$e="[object Symbol]",Fe="[object WeakMap]",Ze="[object ArrayBuffer]",lt="[object DataView]",Et="[object Float32Array]",It="[object Float64Array]",hn="[object Int8Array]",nn="[object Int16Array]",Bn="[object Int32Array]",Ln="[object Uint8Array]",ar="[object Uint8ClampedArray]",Hs="[object Uint16Array]",Tl="[object Uint32Array]",$c=/\b__p \+= '';/g,Qo=/\b(__p \+=) '' \+/g,Sl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yd=/&(?:amp|lt|gt|quot|#39);/g,Jc=/[&<>"']/g,Cd=RegExp(yd.source),eu=RegExp(Jc.source),Mo=/<%-([\s\S]+?)%>/g,Og=/<%([\s\S]+?)%>/g,jf=/<%=([\s\S]+?)%>/g,Gf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bg=/^\w*$/,qf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xd=/[\\^$.*+?()[\]{}|]/g,tu=RegExp(xd.source),Jo=/^\s+/,Lg=/\s/,vc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nu=/\{\n\/\* \[wrapped with (.+)\] \*/,wd=/,? & /,zg=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ug=/[()=,{}\[\]\/\s]/,Ed=/\\(\\)?/g,iu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dl=/\w*$/,Il=/^[-+]0x[0-9a-f]+$/i,Td=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,kl=/^0o[0-7]+$/i,bc=/^(?:0|[1-9]\d*)$/,ru=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ml=/($^)/,Hg=/['\n\r\u2028\u2029\\]/g,yc="\\ud800-\\udfff",_o="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Po="\\u2700-\\u27bf",Al="a-z\\xdf-\\xf6\\xf8-\\xff",Za="A-Z\\xc0-\\xd6\\xd8-\\xde",Ro="\\ufe0e\\ufe0f",ri="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",au="["+yc+"]",Sd="["+ri+"]",Vt="["+_o+"]",Ya="\\d+",_n="["+Po+"]",Sr="["+Al+"]",Dd="[^"+yc+ri+Ya+Po+Al+Za+"]",lu="\\ud83c[\\udffb-\\udfff]",Cc="[^"+yc+"]",Ur="(?:\\ud83c[\\udde6-\\uddff]){2}",Le="[\\ud800-\\udbff][\\udc00-\\udfff]",qe="["+Za+"]",dt="(?:"+Sr+"|"+Dd+")",kt="(?:"+qe+"|"+Dd+")",jt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Hn="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",hr="(?:"+Vt+"|"+lu+")?",gr="["+Ro+"]?",No=gr+hr+"(?:\\u200d(?:"+[Cc,Ur,Le].join("|")+")"+gr+hr+")*",Gi="(?:"+[_n,Ur,Le].join("|")+")"+No,Xw="(?:"+[Cc+Vt+"?",Vt,Ur,Le,au].join("|")+")",Qw=RegExp("['\u2019]","g"),Jw=RegExp(Vt,"g"),Tn=RegExp(lu+"(?="+lu+")|"+Xw+No,"g"),eE=RegExp([qe+"?"+Sr+"+"+jt+"(?="+[Sd,qe,"$"].join("|")+")",kt+"+"+Hn+"(?="+[Sd,qe+dt,"$"].join("|")+")",qe+"?"+dt+"+"+jt,qe+"+"+Hn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ya,Gi].join("|"),"g"),es=RegExp("[\\u200d"+yc+_o+Ro+"]"),jg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yb=-1,qi={};qi[Et]=qi[It]=qi[hn]=qi[nn]=qi[Bn]=qi[Ln]=qi[ar]=qi[Hs]=qi[Tl]=!0,qi[x]=qi[$]=qi[Ze]=qi[se]=qi[lt]=qi[De]=qi[fe]=qi[Pe]=qi[xe]=qi[pe]=qi[Ce]=qi[Ee]=qi[C]=qi[V]=qi[Fe]=!1;var Ni={};Ni[x]=Ni[$]=Ni[Ze]=Ni[lt]=Ni[se]=Ni[De]=Ni[Et]=Ni[It]=Ni[hn]=Ni[nn]=Ni[Bn]=Ni[xe]=Ni[pe]=Ni[Ce]=Ni[Ee]=Ni[C]=Ni[V]=Ni[$e]=Ni[Ln]=Ni[ar]=Ni[Hs]=Ni[Tl]=!0,Ni[fe]=Ni[Pe]=Ni[Fe]=!1;var Cb={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Rn=parseFloat,qg=parseInt,Jm="object"==typeof global&&global&&global.Object===Object&&global,Pl="object"==typeof self&&self&&self.Object===Object&&self,Dr=Jm||Pl||Function("return this")(),xb=de&&!de.nodeType&&de,bs=xb&&E&&!E.nodeType&&E,ys=bs&&bs.exports===xb,e$=ys&&Jm.process,Vs=function(){try{return bs&&bs.require&&bs.require("util").types||e$&&e$.binding&&e$.binding("util")}catch(pt){}}(),Cs=Vs&&Vs.isArrayBuffer,t$=Vs&&Vs.isDate,n$=Vs&&Vs.isMap,i$=Vs&&Vs.isRegExp,wb=Vs&&Vs.isSet,wi=Vs&&Vs.isTypedArray;function xs(ot,pt,gt){switch(gt.length){case 0:return ot.call(pt);case 1:return ot.call(pt,gt[0]);case 2:return ot.call(pt,gt[0],gt[1]);case 3:return ot.call(pt,gt[0],gt[1],gt[2])}return ot.apply(pt,gt)}function tE(ot,pt,gt,Yt){for(var Pn=-1,pi=null==ot?0:ot.length;++Pn<pi;){var kr=ot[Pn];pt(Yt,kr,gt(kr),ot)}return Yt}function Hr(ot,pt){for(var gt=-1,Yt=null==ot?0:ot.length;++gt<Yt&&!1!==pt(ot[gt],gt,ot););return ot}function Oi(ot,pt){for(var gt=null==ot?0:ot.length;gt--&&!1!==pt(ot[gt],gt,ot););return ot}function Id(ot,pt){for(var gt=-1,Yt=null==ot?0:ot.length;++gt<Yt;)if(!pt(ot[gt],gt,ot))return!1;return!0}function ga(ot,pt){for(var gt=-1,Yt=null==ot?0:ot.length,Pn=0,pi=[];++gt<Yt;){var kr=ot[gt];pt(kr,gt,ot)&&(pi[Pn++]=kr)}return pi}function cu(ot,pt){return!(null==ot||!ot.length)&&xc(ot,pt,0)>-1}function Zf(ot,pt,gt){for(var Yt=-1,Pn=null==ot?0:ot.length;++Yt<Pn;)if(gt(pt,ot[Yt]))return!0;return!1}function ui(ot,pt){for(var gt=-1,Yt=null==ot?0:ot.length,Pn=Array(Yt);++gt<Yt;)Pn[gt]=pt(ot[gt],gt,ot);return Pn}function ws(ot,pt){for(var gt=-1,Yt=pt.length,Pn=ot.length;++gt<Yt;)ot[Pn+gt]=pt[gt];return ot}function Wg(ot,pt,gt,Yt){var Pn=-1,pi=null==ot?0:ot.length;for(Yt&&pi&&(gt=ot[++Pn]);++Pn<pi;)gt=pt(gt,ot[Pn],Pn,ot);return gt}function Xt(ot,pt,gt,Yt){var Pn=null==ot?0:ot.length;for(Yt&&Pn&&(gt=ot[--Pn]);Pn--;)gt=pt(gt,ot[Pn],Pn,ot);return gt}function Zg(ot,pt){for(var gt=-1,Yt=null==ot?0:ot.length;++gt<Yt;)if(pt(ot[gt],gt,ot))return!0;return!1}var r$=pa("length");function ts(ot,pt,gt){var Yt;return gt(ot,function(Pn,pi,kr){if(pt(Pn,pi,kr))return Yt=pi,!1}),Yt}function Yf(ot,pt,gt,Yt){for(var Pn=ot.length,pi=gt+(Yt?1:-1);Yt?pi--:++pi<Pn;)if(pt(ot[pi],pi,ot))return pi;return-1}function xc(ot,pt,gt){return pt==pt?function Oo(ot,pt,gt){for(var Yt=gt-1,Pn=ot.length;++Yt<Pn;)if(ot[Yt]===pt)return Yt;return-1}(ot,pt,gt):Yf(ot,Vr,gt)}function rn(ot,pt,gt,Yt){for(var Pn=gt-1,pi=ot.length;++Pn<pi;)if(Yt(ot[Pn],pt))return Pn;return-1}function Vr(ot){return ot!=ot}function jr(ot,pt){var gt=null==ot?0:ot.length;return gt?kd(ot,pt)/gt:c}function pa(ot){return function(pt){return null==pt?T:pt[ot]}}function Ka(ot){return function(pt){return null==ot?T:ot[pt]}}function ns(ot,pt,gt,Yt,Pn){return Pn(ot,function(pi,kr,Hi){gt=Yt?(Yt=!1,pi):pt(gt,pi,kr,Hi)}),gt}function kd(ot,pt){for(var gt,Yt=-1,Pn=ot.length;++Yt<Pn;){var pi=pt(ot[Yt]);pi!==T&&(gt=gt===T?pi:gt+pi)}return gt}function wc(ot,pt){for(var gt=-1,Yt=Array(ot);++gt<ot;)Yt[gt]=pt(gt);return Yt}function Fl(ot){return ot&&ot.slice(0,Bi(ot)+1).replace(Jo,"")}function Ai(ot){return function(pt){return ot(pt)}}function Yg(ot,pt){return ui(pt,function(gt){return ot[gt]})}function io(ot,pt){return ot.has(pt)}function Ut(ot,pt){for(var gt=-1,Yt=ot.length;++gt<Yt&&xc(pt,ot[gt],0)>-1;);return gt}function Vn(ot,pt){for(var gt=ot.length;gt--&&xc(pt,ot[gt],0)>-1;);return gt}function Yi(ot,pt){for(var gt=ot.length,Yt=0;gt--;)ot[gt]===pt&&++Yt;return Yt}var is=Ka({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Ec=Ka({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ir(ot){return"\\"+Cb[ot]}function Ui(ot){return es.test(ot)}function Nn(ot){var pt=-1,gt=Array(ot.size);return ot.forEach(function(Yt,Pn){gt[++pt]=[Pn,Yt]}),gt}function Ad(ot,pt){return function(gt){return ot(pt(gt))}}function rs(ot,pt){for(var gt=-1,Yt=ot.length,Pn=0,pi=[];++gt<Yt;){var kr=ot[gt];(kr===pt||kr===F)&&(ot[gt]=F,pi[Pn++]=gt)}return pi}function du(ot){var pt=-1,gt=Array(ot.size);return ot.forEach(function(Yt){gt[++pt]=Yt}),gt}function js(ot){return Ui(ot)?function Tb(ot){for(var pt=Tn.lastIndex=0;Tn.test(ot);)++pt;return pt}(ot):r$(ot)}function lr(ot){return Ui(ot)?function _a(ot){return ot.match(Tn)||[]}(ot):function o$(ot){return ot.split("")}(ot)}function Bi(ot){for(var pt=ot.length;pt--&&Lg.test(ot.charAt(pt)););return pt}var Eb=Ka({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Sc=function ot(pt){var u,gt=(pt=null==pt?Dr:Sc.defaults(Dr.Object(),pt,Sc.pick(Dr,Xm))).Array,Yt=pt.Date,Pn=pt.Error,pi=pt.Function,kr=pt.Math,Hi=pt.Object,a$=pt.RegExp,nE=pt.String,qs=pt.TypeError,Xg=gt.prototype,Fd=Hi.prototype,Qg=pt["__core-js_shared__"],Jg=pi.prototype.toString,Pi=Fd.hasOwnProperty,rE=0,Sb=(u=/[^.]+$/.exec(Qg&&Qg.keys&&Qg.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",ep=Fd.toString,l$=Jg.call(Hi),tp=Dr._,oE=a$("^"+Jg.call(Pi).replace(xd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),np=ys?pt.Buffer:T,Dc=pt.Symbol,ma=pt.Uint8Array,c$=np?np.allocUnsafe:T,vr=Ad(Hi.getPrototypeOf,Hi),ip=Hi.create,u$=Fd.propertyIsEnumerable,Qf=Xg.splice,rp=Dc?Dc.isConcatSpreadable:T,hu=Dc?Dc.iterator:T,Ic=Dc?Dc.toStringTag:T,gu=function(){try{var u=Gl(Hi,"defineProperty");return u({},"",{}),u}catch(b){}}(),Db=pt.clearTimeout!==Dr.clearTimeout&&pt.clearTimeout,Es=Yt&&Yt.now!==Dr.Date.now&&Yt.now,op=pt.setTimeout!==Dr.setTimeout&&pt.setTimeout,Jf=kr.ceil,pu=kr.floor,sp=Hi.getOwnPropertySymbols,Ib=np?np.isBuffer:T,eh=pt.isFinite,kb=Xg.join,ap=Ad(Hi.keys,Hi),Mr=kr.max,Yn=kr.min,d$=Yt.now,Mb=pt.parseInt,cr=kr.random,Ab=Xg.reverse,f$=Gl(pt,"DataView"),Rl=Gl(pt,"Map"),Bo=Gl(pt,"Promise"),_u=Gl(pt,"Set"),kc=Gl(pt,"WeakMap"),$a=Gl(Hi,"create"),ro=kc&&new kc,Mc={},lp=ql(f$),Pb=ql(Rl),Nl=ql(Bo),h$=ql(_u),cp=ql(kc),wn=Dc?Dc.prototype:T,th=wn?wn.valueOf:T,g$=wn?wn.toString:T;function He(u){if(tr(u)&&!On(u)&&!(u instanceof Xn)){if(u instanceof Ts)return u;if(Pi.call(u,"__wrapped__"))return Au(u)}return new Ts(u)}var mu=function(){function u(){}return function(b){if(!W(b))return{};if(ip)return ip(b);u.prototype=b;var ue=new u;return u.prototype=T,ue}}();function Rd(){}function Ts(u,b){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=T}function Xn(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Wi(u){var b=-1,ue=null==u?0:u.length;for(this.clear();++b<ue;){var ke=u[b];this.set(ke[0],ke[1])}}function Ol(u){var b=-1,ue=null==u?0:u.length;for(this.clear();++b<ue;){var ke=u[b];this.set(ke[0],ke[1])}}function ba(u){var b=-1,ue=null==u?0:u.length;for(this.clear();++b<ue;){var ke=u[b];this.set(ke[0],ke[1])}}function Ac(u){var b=-1,ue=null==u?0:u.length;for(this.__data__=new ba;++b<ue;)this.add(u[b])}function Ss(u){var b=this.__data__=new Ol(u);this.size=b.size}function pp(u,b){var ue=On(u),ke=!ue&&Zl(u),Ne=!ue&&!ke&&Yl(u),je=!ue&&!ke&&!Ne&&sl(u),Ke=ue||ke||Ne||je,it=Ke?wc(u.length,nE):[],at=it.length;for(var vt in u)(b||Pi.call(u,vt))&&(!Ke||!("length"==vt||Ne&&("offset"==vt||"parent"==vt)||je&&("buffer"==vt||"byteLength"==vt||"byteOffset"==vt)||Xs(vt,at)))&&it.push(vt);return it}function _p(u){var b=u.length;return b?u[Rc(0,b-1)]:T}function v$(u,b){return Lp(Uo(u),Pc(b,0,u.length))}function oh(u){return Lp(Uo(u))}function mp(u,b,ue){(ue!==T&&!as(u[b],ue)||ue===T&&!(b in u))&&Ja(u,b,ue)}function Od(u,b,ue){var ke=u[b];(!Pi.call(u,b)||!as(ke,ue)||ue===T&&!(b in u))&&Ja(u,b,ue)}function Ar(u,b){for(var ue=u.length;ue--;)if(as(u[ue][0],b))return ue;return-1}function Bl(u,b,ue,ke){return ya(u,function(Ne,je,Ke){b(ke,Ne,ue(Ne),Ke)}),ke}function er(u,b){return u&&Ea(b,br(b),u)}function Ja(u,b,ue){"__proto__"==b&&gu?gu(u,b,{configurable:!0,enumerable:!0,value:ue,writable:!0}):u[b]=ue}function $p(u,b){for(var ue=-1,ke=b.length,Ne=gt(ke),je=null==u;++ue<ke;)Ne[ue]=je?T:Uh(u,b[ue]);return Ne}function Pc(u,b,ue){return u==u&&(ue!==T&&(u=u<=ue?u:ue),b!==T&&(u=u>=b?u:b)),u}function Ds(u,b,ue,ke,Ne,je){var Ke,it=1&b,at=2&b,vt=4&b;if(ue&&(Ke=Ne?ue(u,ke,Ne,je):ue(u)),Ke!==T)return Ke;if(!W(u))return u;var bt=On(u);if(bt){if(Ke=function Mu(u){var b=u.length,ue=new u.constructor(b);return b&&"string"==typeof u[0]&&Pi.call(u,"index")&&(ue.index=u.index,ue.input=u.input),ue}(u),!it)return Uo(u,Ke)}else{var St=so(u),zt=St==Pe||St==be;if(Yl(u))return P$(u,it);if(St==Ce||St==x||zt&&!Ne){if(Ke=at||zt?{}:j$(u),!it)return at?function Zb(u,b){return Ea(u,V$(u),b)}(u,function vu(u,b){return u&&Ea(b,jo(b),u)}(Ke,u)):function Wb(u,b){return Ea(u,H$(u),b)}(u,er(Ke,u))}else{if(!Ni[St])return Ne?u:{};Ke=function ey(u,b,ue){var ke=u.constructor;switch(b){case Ze:return Ap(u);case se:case De:return new ke(+u);case lt:return function lE(u,b){var ue=b?Ap(u.buffer):u.buffer;return new u.constructor(ue,u.byteOffset,u.byteLength)}(u,ue);case Et:case It:case hn:case nn:case Bn:case Ln:case ar:case Hs:case Tl:return zo(u,ue);case xe:return new ke;case pe:case V:return new ke(u);case Ee:return function cE(u){var b=new u.constructor(u.source,Dl.exec(u));return b.lastIndex=u.lastIndex,b}(u);case C:return new ke;case $e:return function F$(u){return th?Hi(th.call(u)):{}}(u)}}(u,St,it)}}je||(je=new Ss);var on=je.get(u);if(on)return on;je.set(u,Ke),h_(u)?u.forEach(function(bn){Ke.add(Ds(bn,b,ue,bn,u,je))}):d_(u)&&u.forEach(function(bn,Kn){Ke.set(Kn,Ds(bn,b,ue,Kn,u,je))});var jn=bt?T:(vt?at?wh:ku:at?jo:br)(u);return Hr(jn||u,function(bn,Kn){jn&&(bn=u[Kn=bn]),Od(Ke,Kn,Ds(bn,b,ue,Kn,u,je))}),Ke}function Bd(u,b,ue){var ke=ue.length;if(null==u)return!ke;for(u=Hi(u);ke--;){var Ne=ue[ke],Ke=u[Ne];if(Ke===T&&!(Ne in u)||!(0,b[Ne])(Ke))return!1}return!0}function Ld(u,b,ue){if("function"!=typeof u)throw new qs(L);return Yd(function(){u.apply(T,ue)},b)}function Ll(u,b,ue,ke){var Ne=-1,je=cu,Ke=!0,it=u.length,at=[],vt=b.length;if(!it)return at;ue&&(b=ui(b,Ai(ue))),ke?(je=Zf,Ke=!1):b.length>=200&&(je=io,Ke=!1,b=new Ac(b));e:for(;++Ne<it;){var bt=u[Ne],St=null==ue?bt:ue(bt);if(bt=ke||0!==bt?bt:0,Ke&&St==St){for(var zt=vt;zt--;)if(b[zt]===St)continue e;at.push(bt)}else je(b,St,ke)||at.push(bt)}return at}He.templateSettings={escape:Mo,evaluate:Og,interpolate:jf,variable:"",imports:{_:He}},(He.prototype=Rd.prototype).constructor=He,(Ts.prototype=mu(Rd.prototype)).constructor=Ts,(Xn.prototype=mu(Rd.prototype)).constructor=Xn,Wi.prototype.clear=function p$(){this.__data__=$a?$a(null):{},this.size=0},Wi.prototype.delete=function Nd(u){var b=this.has(u)&&delete this.__data__[u];return this.size-=b?1:0,b},Wi.prototype.get=function va(u){var b=this.__data__;if($a){var ue=b[u];return ue===J?T:ue}return Pi.call(b,u)?b[u]:T},Wi.prototype.has=function up(u){var b=this.__data__;return $a?b[u]!==T:Pi.call(b,u)},Wi.prototype.set=function dp(u,b){var ue=this.__data__;return this.size+=this.has(u)?0:1,ue[u]=$a&&b===T?J:b,this},Ol.prototype.clear=function Fb(){this.__data__=[],this.size=0},Ol.prototype.delete=function nh(u){var b=this.__data__,ue=Ar(b,u);return!(ue<0||(ue==b.length-1?b.pop():Qf.call(b,ue,1),--this.size,0))},Ol.prototype.get=function ih(u){var b=this.__data__,ue=Ar(b,u);return ue<0?T:b[ue][1]},Ol.prototype.has=function mo(u){return Ar(this.__data__,u)>-1},Ol.prototype.set=function Xa(u,b){var ue=this.__data__,ke=Ar(ue,u);return ke<0?(++this.size,ue.push([u,b])):ue[ke][1]=b,this},ba.prototype.clear=function $u(){this.size=0,this.__data__={hash:new Wi,map:new(Rl||Ol),string:new Wi}},ba.prototype.delete=function Qa(u){var b=Th(this,u).delete(u);return this.size-=b?1:0,b},ba.prototype.get=function Rb(u){return Th(this,u).get(u)},ba.prototype.has=function _$(u){return Th(this,u).has(u)},ba.prototype.set=function Nb(u,b){var ue=Th(this,u),ke=ue.size;return ue.set(u,b),this.size+=ue.size==ke?0:1,this},Ac.prototype.add=Ac.prototype.push=function fp(u){return this.__data__.set(u,J),this},Ac.prototype.has=function hp(u){return this.__data__.has(u)},Ss.prototype.clear=function gp(){this.__data__=new Ol,this.size=0},Ss.prototype.delete=function Ob(u){var b=this.__data__,ue=b.delete(u);return this.size=b.size,ue},Ss.prototype.get=function m$(u){return this.__data__.get(u)},Ss.prototype.has=function rh(u){return this.__data__.has(u)},Ss.prototype.set=function $$(u,b){var ue=this.__data__;if(ue instanceof Ol){var ke=ue.__data__;if(!Rl||ke.length<199)return ke.push([u,b]),this.size=++ue.size,this;ue=this.__data__=new ba(ke)}return ue.set(u,b),this.size=ue.size,this};var ya=$h(Ca),vp=$h(bp,!0);function Lb(u,b){var ue=!0;return ya(u,function(ke,Ne,je){return ue=!!b(ke,Ne,je)}),ue}function Ws(u,b,ue){for(var ke=-1,Ne=u.length;++ke<Ne;){var je=u[ke],Ke=b(je);if(null!=Ke&&(it===T?Ke==Ke&&!co(Ke):ue(Ke,it)))var it=Ke,at=je}return at}function b$(u,b){var ue=[];return ya(u,function(ke,Ne,je){b(ke,Ne,je)&&ue.push(ke)}),ue}function Gr(u,b,ue,ke,Ne){var je=-1,Ke=u.length;for(ue||(ue=Ih),Ne||(Ne=[]);++je<Ke;){var it=u[je];b>0&&ue(it)?b>1?Gr(it,b-1,ue,ke,Ne):ws(Ne,it):ke||(Ne[Ne.length]=it)}return Ne}var Fc=jd(),sh=jd(!0);function Ca(u,b){return u&&Fc(u,b,br)}function bp(u,b){return u&&sh(u,b,br)}function yp(u,b){return ga(b,function(ue){return rl(u[ue])})}function bu(u,b){for(var ue=0,ke=(b=el(b,u)).length;null!=u&&ue<ke;)u=u[Ho(b[ue++])];return ue&&ue==ke?u:T}function Ud(u,b,ue){var ke=b(u);return On(u)?ke:ws(ke,ue(u))}function oo(u){return null==u?u===T?"[object Undefined]":"[object Null]":Ic&&Ic in Hi(u)?function Qb(u){var b=Pi.call(u,Ic),ue=u[Ic];try{u[Ic]=T;var ke=!0}catch(je){}var Ne=ep.call(u);return ke&&(b?u[Ic]=ue:delete u[Ic]),Ne}(u):function iy(u){return ep.call(u)}(u)}function Hd(u,b){return u>b}function ah(u,b){return null!=u&&Pi.call(u,b)}function y$(u,b){return null!=u&&b in Hi(u)}function zl(u,b,ue){for(var ke=ue?Zf:cu,Ne=u[0].length,je=u.length,Ke=je,it=gt(je),at=1/0,vt=[];Ke--;){var bt=u[Ke];Ke&&b&&(bt=ui(bt,Ai(b))),at=Yn(bt.length,at),it[Ke]=!ue&&(b||Ne>=120&&bt.length>=120)?new Ac(Ke&&bt):T}bt=u[0];var St=-1,zt=it[0];e:for(;++St<Ne&&vt.length<at;){var on=bt[St],vn=b?b(on):on;if(on=ue||0!==on?on:0,!(zt?io(zt,vn):ke(vt,vn,ue))){for(Ke=je;--Ke;){var jn=it[Ke];if(!(jn?io(jn,vn):ke(u[Ke],vn,ue)))continue e}zt&&zt.push(vn),vt.push(on)}}return vt}function xa(u,b,ue){var ke=null==(u=K$(u,b=el(b,u)))?u:u[Ho(fn(b))];return null==ke?T:xs(ke,u,ue)}function lh(u){return tr(u)&&oo(u)==x}function yu(u,b,ue,ke,Ne){return u===b||(null==u||null==b||!tr(u)&&!tr(b)?u!=u&&b!=b:function x$(u,b,ue,ke,Ne,je){var Ke=On(u),it=On(b),at=Ke?$:so(u),vt=it?$:so(b),bt=(at=at==x?Ce:at)==Ce,St=(vt=vt==x?Ce:vt)==Ce,zt=at==vt;if(zt&&Yl(u)){if(!Yl(b))return!1;Ke=!0,bt=!1}if(zt&&!bt)return je||(je=new Ss),Ke||sl(u)?Wd(u,b,ue,ke,Ne,je):function Xb(u,b,ue,ke,Ne,je,Ke){switch(ue){case lt:if(u.byteLength!=b.byteLength||u.byteOffset!=b.byteOffset)return!1;u=u.buffer,b=b.buffer;case Ze:return!(u.byteLength!=b.byteLength||!je(new ma(u),new ma(b)));case se:case De:case pe:return as(+u,+b);case fe:return u.name==b.name&&u.message==b.message;case Ee:case V:return u==b+"";case xe:var it=Nn;case C:if(it||(it=du),u.size!=b.size&&!(1&ke))return!1;var vt=Ke.get(u);if(vt)return vt==b;ke|=2,Ke.set(u,b);var bt=Wd(it(u),it(b),ke,Ne,je,Ke);return Ke.delete(u),bt;case $e:if(th)return th.call(u)==th.call(b)}return!1}(u,b,at,ue,ke,Ne,je);if(!(1&ue)){var on=bt&&Pi.call(u,"__wrapped__"),vn=St&&Pi.call(b,"__wrapped__");if(on||vn){var jn=on?u.value():u,bn=vn?b.value():b;return je||(je=new Ss),Ne(jn,bn,ue,ke,je)}}return!!zt&&(je||(je=new Ss),function z$(u,b,ue,ke,Ne,je){var Ke=1&ue,it=ku(u),at=it.length;if(at!=ku(b).length&&!Ke)return!1;for(var St=at;St--;){var zt=it[St];if(!(Ke?zt in b:Pi.call(b,zt)))return!1}var on=je.get(u),vn=je.get(b);if(on&&vn)return on==b&&vn==u;var jn=!0;je.set(u,b),je.set(b,u);for(var bn=Ke;++St<at;){var Kn=u[zt=it[St]],ei=b[zt];if(ke)var Ps=Ke?ke(ei,Kn,zt,b,u,je):ke(Kn,ei,zt,u,b,je);if(!(Ps===T?Kn===ei||Ne(Kn,ei,ue,ke,je):Ps)){jn=!1;break}bn||(bn="constructor"==zt)}if(jn&&!bn){var Go=u.constructor,vo=b.constructor;Go!=vo&&"constructor"in u&&"constructor"in b&&!("function"==typeof Go&&Go instanceof Go&&"function"==typeof vo&&vo instanceof vo)&&(jn=!1)}return je.delete(u),je.delete(b),jn}(u,b,ue,ke,Ne,je))}(u,b,ue,ke,yu,Ne))}function Cp(u,b,ue,ke){var Ne=ue.length,je=Ne,Ke=!ke;if(null==u)return!je;for(u=Hi(u);Ne--;){var it=ue[Ne];if(Ke&&it[2]?it[1]!==u[it[0]]:!(it[0]in u))return!1}for(;++Ne<je;){var at=(it=ue[Ne])[0],vt=u[at],bt=it[1];if(Ke&&it[2]){if(vt===T&&!(at in u))return!1}else{var St=new Ss;if(ke)var zt=ke(vt,bt,at,u,b,St);if(!(zt===T?yu(bt,vt,3,ke,St):zt))return!1}}return!0}function Cu(u){return!(!W(u)||function ty(u){return!!Sb&&Sb in u}(u))&&(rl(u)?oE:ha).test(ql(u))}function Vd(u){return"function"==typeof u?u:null==u?qr:"object"==typeof u?On(u)?E$(u[0],u[1]):Sp(u):R_(u)}function Ep(u){if(!Zd(u))return ap(u);var b=[];for(var ue in Hi(u))Pi.call(u,ue)&&"constructor"!=ue&&b.push(ue);return b}function dh(u,b){return u<b}function Tp(u,b){var ue=-1,ke=Vo(u)?gt(u.length):[];return ya(u,function(Ne,je,Ke){ke[++ue]=b(Ne,je,Ke)}),ke}function Sp(u){var b=U$(u);return 1==b.length&&b[0][2]?W$(b[0][0],b[0][1]):function(ue){return ue===u||Cp(ue,u,b)}}function E$(u,b){return kh(u)&&q$(b)?W$(Ho(u),b):function(ue){var ke=Uh(ue,u);return ke===T&&ke===b?Hh(ue,u):yu(b,ke,3)}}function fh(u,b,ue,ke,Ne){u!==b&&Fc(b,function(je,Ke){if(Ne||(Ne=new Ss),W(je))!function hh(u,b,ue,ke,Ne,je,Ke){var it=Np(u,ue),at=Np(b,ue),vt=Ke.get(at);if(vt)mp(u,ue,vt);else{var bt=je?je(it,at,ue+"",u,b,Ke):T,St=bt===T;if(St){var zt=On(at),on=!zt&&Yl(at),vn=!zt&&!on&&sl(at);bt=at,zt||on||vn?On(it)?bt=it:ur(it)?bt=Uo(it):on?(St=!1,bt=P$(at,!0)):vn?(St=!1,bt=zo(at,!0)):bt=[]:Ru(at)||Zl(at)?(bt=it,Zl(it)?bt=B0(it):(!W(it)||rl(it))&&(bt=j$(at))):St=!1}St&&(Ke.set(at,bt),Ne(bt,at,ke,je,Ke),Ke.delete(at)),mp(u,ue,bt)}}(u,b,Ke,ue,fh,ke,Ne);else{var it=ke?ke(Np(u,Ke),je,Ke+"",u,b,Ne):T;it===T&&(it=je),mp(u,Ke,it)}},jo)}function xu(u,b){var ue=u.length;if(ue)return Xs(b+=b<0?ue:0,ue)?u[b]:T}function T$(u,b,ue){b=b.length?ui(b,function(je){return On(je)?function(Ke){return bu(Ke,1===je.length?je[0]:je)}:je}):[qr];var ke=-1;return b=ui(b,Ai(dn())),function Kf(ot,pt){var gt=ot.length;for(ot.sort(pt);gt--;)ot[gt]=ot[gt].value;return ot}(Tp(u,function(je,Ke,it){return{criteria:ui(b,function(vt){return vt(je)}),index:++ke,value:je}}),function(je,Ke){return function Du(u,b,ue){for(var ke=-1,Ne=u.criteria,je=b.criteria,Ke=Ne.length,it=ue.length;++ke<Ke;){var at=_h(Ne[ke],je[ke]);if(at)return ke>=it?at:at*("desc"==ue[ke]?-1:1)}return u.index-b.index}(je,Ke,ue)})}function Dp(u,b,ue){for(var ke=-1,Ne=b.length,je={};++ke<Ne;){var Ke=b[ke],it=bu(u,Ke);ue(it,Ke)&&wa(je,el(Ke,u),it)}return je}function Pr(u,b,ue,ke){var Ne=ke?rn:xc,je=-1,Ke=b.length,it=u;for(u===b&&(b=Uo(b)),ue&&(it=ui(u,Ai(ue)));++je<Ke;)for(var at=0,vt=b[je],bt=ue?ue(vt):vt;(at=Ne(it,bt,at,ke))>-1;)it!==u&&Qf.call(it,at,1),Qf.call(u,at,1);return u}function gh(u,b){for(var ue=u?b.length:0,ke=ue-1;ue--;){var Ne=b[ue];if(ue==ke||Ne!==je){var je=Ne;Xs(Ne)?Qf.call(u,Ne,1):k$(u,Ne)}}return u}function Rc(u,b){return u+pu(cr()*(b-u+1))}function Ul(u,b){var ue="";if(!u||b<1||b>_)return ue;do{b%2&&(ue+=u),(b=pu(b/2))&&(u+=u)}while(b);return ue}function Fn(u,b){return Bp(Y$(u,b,qr),u+"")}function D$(u){return _p(ll(u))}function Ip(u,b){var ue=ll(u);return Lp(ue,Pc(b,0,ue.length))}function wa(u,b,ue,ke){if(!W(u))return u;for(var Ne=-1,je=(b=el(b,u)).length,Ke=je-1,it=u;null!=it&&++Ne<je;){var at=Ho(b[Ne]),vt=ue;if("__proto__"===at||"constructor"===at||"prototype"===at)return u;if(Ne!=Ke){var bt=it[at];(vt=ke?ke(bt,at,it):T)===T&&(vt=W(bt)?bt:Xs(b[Ne+1])?[]:{})}Od(it,at,vt),it=it[at]}return u}var Hb=ro?function(u,b){return ro.set(u,b),u}:qr,Vb=gu?function(u,b){return gu(u,"toString",{configurable:!0,enumerable:!1,value:k_(b),writable:!0})}:qr;function Jn(u){return Lp(ll(u))}function Zs(u,b,ue){var ke=-1,Ne=u.length;b<0&&(b=-b>Ne?0:Ne+b),(ue=ue>Ne?Ne:ue)<0&&(ue+=Ne),Ne=b>ue?0:ue-b>>>0,b>>>=0;for(var je=gt(Ne);++ke<Ne;)je[ke]=u[ke+b];return je}function aE(u,b){var ue;return ya(u,function(ke,Ne,je){return!(ue=b(ke,Ne,je))}),!!ue}function kp(u,b,ue){var ke=0,Ne=null==u?ke:u.length;if("number"==typeof b&&b==b&&Ne<=2147483647){for(;ke<Ne;){var je=ke+Ne>>>1,Ke=u[je];null!==Ke&&!co(Ke)&&(ue?Ke<=b:Ke<b)?ke=je+1:Ne=je}return Ne}return I$(u,b,qr,ue)}function I$(u,b,ue,ke){var Ne=0,je=null==u?0:u.length;if(0===je)return 0;for(var Ke=(b=ue(b))!=b,it=null===b,at=co(b),vt=b===T;Ne<je;){var bt=pu((Ne+je)/2),St=ue(u[bt]),zt=St!==T,on=null===St,vn=St==St,jn=co(St);if(Ke)var bn=ke||vn;else bn=vt?vn&&(ke||zt):it?vn&&zt&&(ke||!on):at?vn&&zt&&!on&&(ke||!jn):!on&&!jn&&(ke?St<=b:St<b);bn?Ne=bt+1:je=bt}return Yn(je,4294967294)}function jb(u,b){for(var ue=-1,ke=u.length,Ne=0,je=[];++ue<ke;){var Ke=u[ue],it=b?b(Ke):Ke;if(!ue||!as(it,at)){var at=it;je[Ne++]=0===Ke?0:Ke}}return je}function Gb(u){return"number"==typeof u?u:co(u)?c:+u}function Is(u){if("string"==typeof u)return u;if(On(u))return ui(u,Is)+"";if(co(u))return g$?g$.call(u):"";var b=u+"";return"0"==b&&1/u==-O?"-0":b}function ks(u,b,ue){var ke=-1,Ne=cu,je=u.length,Ke=!0,it=[],at=it;if(ue)Ke=!1,Ne=Zf;else if(je>=200){var vt=b?null:Kb(u);if(vt)return du(vt);Ke=!1,Ne=io,at=new Ac}else at=b?[]:it;e:for(;++ke<je;){var bt=u[ke],St=b?b(bt):bt;if(bt=ue||0!==bt?bt:0,Ke&&St==St){for(var zt=at.length;zt--;)if(at[zt]===St)continue e;b&&at.push(St),it.push(bt)}else Ne(at,St,ue)||(at!==it&&at.push(St),it.push(bt))}return it}function k$(u,b){return null==(u=K$(u,b=el(b,u)))||delete u[Ho(fn(b))]}function pr(u,b,ue,ke){return wa(u,b,ue(bu(u,b)),ke)}function Tu(u,b,ue,ke){for(var Ne=u.length,je=ke?Ne:-1;(ke?je--:++je<Ne)&&b(u[je],je,u););return ue?Zs(u,ke?0:je,ke?je+1:Ne):Zs(u,ke?je+1:0,ke?Ne:je)}function Su(u,b){var ue=u;return ue instanceof Xn&&(ue=ue.value()),Wg(b,function(ke,Ne){return Ne.func.apply(Ne.thisArg,ws([ke],Ne.args))},ue)}function M$(u,b,ue){var ke=u.length;if(ke<2)return ke?ks(u[0]):[];for(var Ne=-1,je=gt(ke);++Ne<ke;)for(var Ke=u[Ne],it=-1;++it<ke;)it!=Ne&&(je[Ne]=Ll(je[Ne]||Ke,u[it],b,ue));return ks(Gr(je,1),b,ue)}function A$(u,b,ue){for(var ke=-1,Ne=u.length,je=b.length,Ke={};++ke<Ne;)ue(Ke,u[ke],ke<je?b[ke]:T);return Ke}function Lo(u){return ur(u)?u:[]}function Ms(u){return"function"==typeof u?u:qr}function el(u,b){return On(u)?u:kh(u,b)?[u]:J$(_i(u))}var ph=Fn;function As(u,b,ue){var ke=u.length;return ue=ue===T?ke:ue,!b&&ue>=ke?u:Zs(u,b,ue)}var Mp=Db||function(u){return Dr.clearTimeout(u)};function P$(u,b){if(b)return u.slice();var ue=u.length,ke=c$?c$(ue):new u.constructor(ue);return u.copy(ke),ke}function Ap(u){var b=new u.constructor(u.byteLength);return new ma(b).set(new ma(u)),b}function zo(u,b){var ue=b?Ap(u.buffer):u.buffer;return new u.constructor(ue,u.byteOffset,u.length)}function _h(u,b){if(u!==b){var ue=u!==T,ke=null===u,Ne=u==u,je=co(u),Ke=b!==T,it=null===b,at=b==b,vt=co(b);if(!it&&!vt&&!je&&u>b||je&&Ke&&at&&!it&&!vt||ke&&Ke&&at||!ue&&at||!Ne)return 1;if(!ke&&!je&&!vt&&u<b||vt&&ue&&Ne&&!ke&&!je||it&&ue&&Ne||!Ke&&Ne||!at)return-1}return 0}function qb(u,b,ue,ke){for(var Ne=-1,je=u.length,Ke=ue.length,it=-1,at=b.length,vt=Mr(je-Ke,0),bt=gt(at+vt),St=!ke;++it<at;)bt[it]=b[it];for(;++Ne<Ke;)(St||Ne<je)&&(bt[ue[Ne]]=u[Ne]);for(;vt--;)bt[it++]=u[Ne++];return bt}function Pp(u,b,ue,ke){for(var Ne=-1,je=u.length,Ke=-1,it=ue.length,at=-1,vt=b.length,bt=Mr(je-it,0),St=gt(bt+vt),zt=!ke;++Ne<bt;)St[Ne]=u[Ne];for(var on=Ne;++at<vt;)St[on+at]=b[at];for(;++Ke<it;)(zt||Ne<je)&&(St[on+ue[Ke]]=u[Ne++]);return St}function Uo(u,b){var ue=-1,ke=u.length;for(b||(b=gt(ke));++ue<ke;)b[ue]=u[ue];return b}function Ea(u,b,ue,ke){var Ne=!ue;ue||(ue={});for(var je=-1,Ke=b.length;++je<Ke;){var it=b[je],at=ke?ke(ue[it],u[it],it,ue,u):T;at===T&&(at=u[it]),Ne?Ja(ue,it,at):Od(ue,it,at)}return ue}function mh(u,b){return function(ue,ke){var Ne=On(ue)?tE:Bl,je=b?b():{};return Ne(ue,u,dn(ke,2),je)}}function Nc(u){return Fn(function(b,ue){var ke=-1,Ne=ue.length,je=Ne>1?ue[Ne-1]:T,Ke=Ne>2?ue[2]:T;for(je=u.length>3&&"function"==typeof je?(Ne--,je):T,Ke&&ao(ue[0],ue[1],Ke)&&(je=Ne<3?T:je,Ne=1),b=Hi(b);++ke<Ne;){var it=ue[ke];it&&u(b,it,ke,je)}return b})}function $h(u,b){return function(ue,ke){if(null==ue)return ue;if(!Vo(ue))return u(ue,ke);for(var Ne=ue.length,je=b?Ne:-1,Ke=Hi(ue);(b?je--:++je<Ne)&&!1!==ke(Ke[je],je,Ke););return ue}}function jd(u){return function(b,ue,ke){for(var Ne=-1,je=Hi(b),Ke=ke(b),it=Ke.length;it--;){var at=Ke[u?it:++Ne];if(!1===ue(je[at],at,je))break}return b}}function Iu(u){return function(b){var ue=Ui(b=_i(b))?lr(b):T,ke=ue?ue[0]:b.charAt(0),Ne=ue?As(ue,1).join(""):b.slice(1);return ke[u]()+Ne}}function Hl(u){return function(b){return Wg(nv(T_(b).replace(Qw,"")),u,"")}}function Vl(u){return function(){var b=arguments;switch(b.length){case 0:return new u;case 1:return new u(b[0]);case 2:return new u(b[0],b[1]);case 3:return new u(b[0],b[1],b[2]);case 4:return new u(b[0],b[1],b[2],b[3]);case 5:return new u(b[0],b[1],b[2],b[3],b[4]);case 6:return new u(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new u(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var ue=mu(u.prototype),ke=u.apply(ue,b);return W(ke)?ke:ue}}function R$(u){return function(b,ue,ke){var Ne=Hi(b);if(!Vo(b)){var je=dn(ue,3);b=br(b),ue=function(it){return je(Ne[it],it,Ne)}}var Ke=u(b,ue,ke);return Ke>-1?Ne[je?b[Ke]:Ke]:T}}function N$(u){return Ys(function(b){var ue=b.length,ke=ue,Ne=Ts.prototype.thru;for(u&&b.reverse();ke--;){var je=b[ke];if("function"!=typeof je)throw new qs(L);if(Ne&&!Ke&&"wrapper"==Eh(je))var Ke=new Ts([],!0)}for(ke=Ke?ke:ue;++ke<ue;){var it=Eh(je=b[ke]),at="wrapper"==it?Rp(je):T;Ke=at&&nl(at[0])&&424==at[1]&&!at[4].length&&1==at[9]?Ke[Eh(at[0])].apply(Ke,at[3]):1==je.length&&nl(je)?Ke[it]():Ke.thru(je)}return function(){var vt=arguments,bt=vt[0];if(Ke&&1==vt.length&&On(bt))return Ke.plant(bt).value();for(var St=0,zt=ue?b[St].apply(this,vt):bt;++St<ue;)zt=b[St].call(this,zt);return zt}})}function Gd(u,b,ue,ke,Ne,je,Ke,it,at,vt){var bt=b&U,St=1&b,zt=2&b,on=24&b,vn=512&b,jn=zt?T:Vl(u);return function bn(){for(var Kn=arguments.length,ei=gt(Kn),Ps=Kn;Ps--;)ei[Ps]=arguments[Ps];if(on)var Go=Ks(bn),vo=Yi(ei,Go);if(ke&&(ei=qb(ei,ke,Ne,on)),je&&(ei=Pp(ei,je,Ke,on)),Kn-=vo,on&&Kn<vt){var dr=rs(ei,Go);return Ch(u,b,Gd,bn.placeholder,ue,ei,dr,it,at,vt-Kn)}var Fs=St?ue:this,ka=zt?Fs[u]:u;return Kn=ei.length,it?ei=ry(ei,it):vn&&Kn>1&&ei.reverse(),bt&&at<Kn&&(ei.length=at),this&&this!==Dr&&this instanceof bn&&(ka=jn||Vl(ka)),ka.apply(Fs,ei)}}function O$(u,b){return function(ue,ke){return function zb(u,b,ue,ke){return Ca(u,function(Ne,je,Ke){b(ke,ue(Ne),je,Ke)}),ke}(ue,u,b(ke),{})}}function jl(u,b){return function(ue,ke){var Ne;if(ue===T&&ke===T)return b;if(ue!==T&&(Ne=ue),ke!==T){if(Ne===T)return ke;"string"==typeof ue||"string"==typeof ke?(ue=Is(ue),ke=Is(ke)):(ue=Gb(ue),ke=Gb(ke)),Ne=u(ue,ke)}return Ne}}function vh(u){return Ys(function(b){return b=ui(b,Ai(dn())),Fn(function(ue){var ke=this;return u(b,function(Ne){return xs(Ne,ke,ue)})})})}function bh(u,b){var ue=(b=b===T?" ":Is(b)).length;if(ue<2)return ue?Ul(b,u):b;var ke=Ul(b,Jf(u/js(b)));return Ui(b)?As(lr(ke),0,u).join(""):ke.slice(0,u)}function Fp(u){return function(b,ue,ke){return ke&&"number"!=typeof ke&&ao(b,ue,ke)&&(ue=ke=T),b=al(b),ue===T?(ue=b,b=0):ue=al(ue),function Eu(u,b,ue,ke){for(var Ne=-1,je=Mr(Jf((b-u)/(ue||1)),0),Ke=gt(je);je--;)Ke[ke?je:++Ne]=u,u+=ue;return Ke}(b,ue,ke=ke===T?b<ue?1:-1:al(ke),u)}}function yh(u){return function(b,ue){return"string"==typeof b&&"string"==typeof ue||(b=ea(b),ue=ea(ue)),u(b,ue)}}function Ch(u,b,ue,ke,Ne,je,Ke,it,at,vt){var bt=8&b;b|=bt?N:64,4&(b&=~(bt?64:N))||(b&=-4);var jn=[u,b,Ne,bt?je:T,bt?Ke:T,bt?T:je,bt?T:Ke,it,at,vt],bn=ue.apply(T,jn);return nl(u)&&Op(bn,jn),bn.placeholder=ke,X$(bn,u,b)}function Oc(u){var b=kr[u];return function(ue,ke){if(ue=ea(ue),(ke=null==ke?0:Yn(Un(ke),292))&&eh(ue)){var Ne=(_i(ue)+"e").split("e");return+((Ne=(_i(b(Ne[0]+"e"+(+Ne[1]+ke)))+"e").split("e"))[0]+"e"+(+Ne[1]-ke))}return b(ue)}}var Kb=_u&&1/du(new _u([,-0]))[1]==O?function(u){return new _u(u)}:lf;function B$(u){return function(b){var ue=so(b);return ue==xe?Nn(b):ue==C?function fu(ot){var pt=-1,gt=Array(ot.size);return ot.forEach(function(Yt){gt[++pt]=[Yt,Yt]}),gt}(b):function Xf(ot,pt){return ui(pt,function(gt){return[gt,ot[gt]]})}(b,u(b))}}function tl(u,b,ue,ke,Ne,je,Ke,it){var at=2&b;if(!at&&"function"!=typeof u)throw new qs(L);var vt=ke?ke.length:0;if(vt||(b&=-97,ke=Ne=T),Ke=Ke===T?Ke:Mr(Un(Ke),0),it=it===T?it:Un(it),vt-=Ne?Ne.length:0,64&b){var bt=ke,St=Ne;ke=Ne=T}var zt=at?T:Rp(u),on=[u,b,ue,ke,Ne,bt,St,je,Ke,it];if(zt&&function Ta(u,b){var ue=u[1],ke=b[1],Ne=ue|ke;if(!(Ne<131||(ke==U&&8==ue||ke==U&&256==ue&&u[7].length<=b[8]||384==ke&&b[7].length<=b[8]&&8==ue)))return u;1&ke&&(u[2]=b[2],Ne|=1&ue?0:4);var it=b[3];if(it){var at=u[3];u[3]=at?qb(at,it,b[4]):it,u[4]=at?rs(u[3],F):b[4]}(it=b[5])&&(u[5]=(at=u[5])?Pp(at,it,b[6]):it,u[6]=at?rs(u[5],F):b[6]),(it=b[7])&&(u[7]=it),ke&U&&(u[8]=null==u[8]?b[8]:Yn(u[8],b[8])),null==u[9]&&(u[9]=b[9]),u[0]=b[0],u[1]=Ne}(on,zt),u=on[0],b=on[1],ue=on[2],ke=on[3],Ne=on[4],!(it=on[9]=on[9]===T?at?0:u.length:Mr(on[9]-vt,0))&&24&b&&(b&=-25),b&&1!=b)vn=8==b||16==b?function Yb(u,b,ue){var ke=Vl(u);return function Ne(){for(var je=arguments.length,Ke=gt(je),it=je,at=Ks(Ne);it--;)Ke[it]=arguments[it];var vt=je<3&&Ke[0]!==at&&Ke[je-1]!==at?[]:rs(Ke,at);return(je-=vt.length)<ue?Ch(u,b,Gd,Ne.placeholder,T,Ke,vt,T,T,ue-je):xs(this&&this!==Dr&&this instanceof Ne?ke:u,this,Ke)}}(u,b,it):b!=N&&33!=b||Ne.length?Gd.apply(T,on):function In(u,b,ue,ke){var Ne=1&b,je=Vl(u);return function Ke(){for(var it=-1,at=arguments.length,vt=-1,bt=ke.length,St=gt(bt+at),zt=this&&this!==Dr&&this instanceof Ke?je:u;++vt<bt;)St[vt]=ke[vt];for(;at--;)St[vt++]=arguments[++it];return xs(zt,Ne?ue:this,St)}}(u,b,ue,ke);else var vn=function uE(u,b,ue){var ke=1&b,Ne=Vl(u);return function je(){return(this&&this!==Dr&&this instanceof je?Ne:u).apply(ke?ue:this,arguments)}}(u,b,ue);return X$((zt?Hb:Op)(vn,on),u,b)}function xh(u,b,ue,ke){return u===T||as(u,Fd[ue])&&!Pi.call(ke,ue)?b:u}function qd(u,b,ue,ke,Ne,je){return W(u)&&W(b)&&(je.set(b,u),fh(u,b,T,qd,je),je.delete(b)),u}function L$(u){return Ru(u)?T:u}function Wd(u,b,ue,ke,Ne,je){var Ke=1&ue,it=u.length,at=b.length;if(it!=at&&!(Ke&&at>it))return!1;var vt=je.get(u),bt=je.get(b);if(vt&&bt)return vt==b&&bt==u;var St=-1,zt=!0,on=2&ue?new Ac:T;for(je.set(u,b),je.set(b,u);++St<it;){var vn=u[St],jn=b[St];if(ke)var bn=Ke?ke(jn,vn,St,b,u,je):ke(vn,jn,St,u,b,je);if(bn!==T){if(bn)continue;zt=!1;break}if(on){if(!Zg(b,function(Kn,ei){if(!io(on,ei)&&(vn===Kn||Ne(vn,Kn,ue,ke,je)))return on.push(ei)})){zt=!1;break}}else if(vn!==jn&&!Ne(vn,jn,ue,ke,je)){zt=!1;break}}return je.delete(u),je.delete(b),zt}function Ys(u){return Bp(Y$(u,T,o0),u+"")}function ku(u){return Ud(u,br,H$)}function wh(u){return Ud(u,jo,V$)}var Rp=ro?function(u){return ro.get(u)}:lf;function Eh(u){for(var b=u.name+"",ue=Mc[b],ke=Pi.call(Mc,b)?ue.length:0;ke--;){var Ne=ue[ke],je=Ne.func;if(null==je||je==u)return Ne.name}return b}function Ks(u){return(Pi.call(He,"placeholder")?He:u).placeholder}function dn(){var u=He.iteratee||af;return u=u===af?Vd:u,arguments.length?u(arguments[0],arguments[1]):u}function Th(u,b){var ue=u.__data__;return function G$(u){var b=typeof u;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==u:null===u}(b)?ue["string"==typeof b?"string":"hash"]:ue.map}function U$(u){for(var b=br(u),ue=b.length;ue--;){var ke=b[ue],Ne=u[ke];b[ue]=[ke,Ne,q$(Ne)]}return b}function Gl(u,b){var ue=function Tc(ot,pt){return null==ot?T:ot[pt]}(u,b);return Cu(ue)?ue:T}var H$=sp?function(u){return null==u?[]:(u=Hi(u),ga(sp(u),function(b){return u$.call(u,b)}))}:zu,V$=sp?function(u){for(var b=[];u;)ws(b,H$(u)),u=vr(u);return b}:zu,so=oo;function Dh(u,b,ue){for(var ke=-1,Ne=(b=el(b,u)).length,je=!1;++ke<Ne;){var Ke=Ho(b[ke]);if(!(je=null!=u&&ue(u,Ke)))break;u=u[Ke]}return je||++ke!=Ne?je:!!(Ne=null==u?0:u.length)&&kn(Ne)&&Xs(Ke,Ne)&&(On(u)||Zl(u))}function j$(u){return"function"!=typeof u.constructor||Zd(u)?{}:mu(vr(u))}function Ih(u){return On(u)||Zl(u)||!!(rp&&u&&u[rp])}function Xs(u,b){var ue=typeof u;return!!(b=null==b?_:b)&&("number"==ue||"symbol"!=ue&&bc.test(u))&&u>-1&&u%1==0&&u<b}function ao(u,b,ue){if(!W(ue))return!1;var ke=typeof b;return!!("number"==ke?Vo(ue)&&Xs(b,ue.length):"string"==ke&&b in ue)&&as(ue[b],u)}function kh(u,b){if(On(u))return!1;var ue=typeof u;return!("number"!=ue&&"symbol"!=ue&&"boolean"!=ue&&null!=u&&!co(u))||Bg.test(u)||!Gf.test(u)||null!=b&&u in Hi(b)}function nl(u){var b=Eh(u),ue=He[b];if("function"!=typeof ue||!(b in Xn.prototype))return!1;if(u===ue)return!0;var ke=Rp(ue);return!!ke&&u===ke[0]}(f$&&so(new f$(new ArrayBuffer(1)))!=lt||Rl&&so(new Rl)!=xe||Bo&&so(Bo.resolve())!=ae||_u&&so(new _u)!=C||kc&&so(new kc)!=Fe)&&(so=function(u){var b=oo(u),ue=b==Ce?u.constructor:T,ke=ue?ql(ue):"";if(ke)switch(ke){case lp:return lt;case Pb:return xe;case Nl:return ae;case h$:return C;case cp:return Fe}return b});var ny=Qg?rl:N_;function Zd(u){var b=u&&u.constructor;return u===("function"==typeof b&&b.prototype||Fd)}function q$(u){return u==u&&!W(u)}function W$(u,b){return function(ue){return null!=ue&&ue[u]===b&&(b!==T||u in Hi(ue))}}function Y$(u,b,ue){return b=Mr(b===T?u.length-1:b,0),function(){for(var ke=arguments,Ne=-1,je=Mr(ke.length-b,0),Ke=gt(je);++Ne<je;)Ke[Ne]=ke[b+Ne];Ne=-1;for(var it=gt(b+1);++Ne<b;)it[Ne]=ke[Ne];return it[b]=ue(Ke),xs(u,this,it)}}function K$(u,b){return b.length<2?u:bu(u,Zs(b,0,-1))}function ry(u,b){for(var ue=u.length,ke=Yn(b.length,ue),Ne=Uo(u);ke--;){var je=b[ke];u[ke]=Xs(je,ue)?Ne[je]:T}return u}function Np(u,b){if(("constructor"!==b||"function"!=typeof u[b])&&"__proto__"!=b)return u[b]}var Op=Q$(Hb),Yd=op||function(u,b){return Dr.setTimeout(u,b)},Bp=Q$(Vb);function X$(u,b,ue){var ke=b+"";return Bp(u,function dE(u,b){var ue=b.length;if(!ue)return u;var ke=ue-1;return b[ke]=(ue>1?"& ":"")+b[ke],b=b.join(ue>2?", ":" "),u.replace(vc,"{\n/* [wrapped with "+b+"] */\n")}(ke,function Sa(u,b){return Hr(m,function(ue){var ke="_."+ue[0];b&ue[1]&&!cu(u,ke)&&u.push(ke)}),u.sort()}(function Sh(u){var b=u.match(nu);return b?b[1].split(wd):[]}(ke),ue)))}function Q$(u){var b=0,ue=0;return function(){var ke=d$(),Ne=16-(ke-ue);if(ue=ke,Ne>0){if(++b>=800)return arguments[0]}else b=0;return u.apply(T,arguments)}}function Lp(u,b){var ue=-1,ke=u.length,Ne=ke-1;for(b=b===T?ke:b;++ue<b;){var je=Rc(ue,Ne),Ke=u[je];u[je]=u[ue],u[ue]=Ke}return u.length=b,u}var J$=function os(u){var b=Rh(u,function(ke){return 500===ue.size&&ue.clear(),ke}),ue=b.cache;return b}(function(u){var b=[];return 46===u.charCodeAt(0)&&b.push(""),u.replace(qf,function(ue,ke,Ne,je){b.push(Ne?je.replace(Ed,"$1"):ke||ue)}),b});function Ho(u){if("string"==typeof u||co(u))return u;var b=u+"";return"0"==b&&1/u==-O?"-0":b}function ql(u){if(null!=u){try{return Jg.call(u)}catch(b){}try{return u+""}catch(b){}}return""}function Au(u){if(u instanceof Xn)return u.clone();var b=new Ts(u.__wrapped__,u.__chain__);return b.__actions__=Uo(u.__actions__),b.__index__=u.__index__,b.__values__=u.__values__,b}var fE=Fn(function(u,b){return ur(u)?Ll(u,Gr(b,1,ur,!0)):[]}),hE=Fn(function(u,b){var ue=fn(b);return ur(ue)&&(ue=T),ur(u)?Ll(u,Gr(b,1,ur,!0),dn(ue,2)):[]}),gE=Fn(function(u,b){var ue=fn(b);return ur(ue)&&(ue=T),ur(u)?Ll(u,Gr(b,1,ur,!0),T,ue):[]});function Vp(u,b,ue){var ke=null==u?0:u.length;if(!ke)return-1;var Ne=null==ue?0:Un(ue);return Ne<0&&(Ne=Mr(ke+Ne,0)),Yf(u,dn(b,3),Ne)}function r0(u,b,ue){var ke=null==u?0:u.length;if(!ke)return-1;var Ne=ke-1;return ue!==T&&(Ne=Un(ue),Ne=ue<0?Mr(ke+Ne,0):Yn(Ne,ke-1)),Yf(u,dn(b,3),Ne,!0)}function o0(u){return null!=u&&u.length?Gr(u,1):[]}function Kd(u){return u&&u.length?u[0]:T}var ay=Fn(function(u){var b=ui(u,Lo);return b.length&&b[0]===u[0]?zl(b):[]}),Vi=Fn(function(u){var b=fn(u),ue=ui(u,Lo);return b===fn(ue)?b=T:ue.pop(),ue.length&&ue[0]===u[0]?zl(ue,dn(b,2)):[]}),Bc=Fn(function(u){var b=fn(u),ue=ui(u,Lo);return(b="function"==typeof b?b:T)&&ue.pop(),ue.length&&ue[0]===u[0]?zl(ue,T,b):[]});function fn(u){var b=null==u?0:u.length;return b?u[b-1]:T}var uy=Fn(c0);function c0(u,b){return u&&u.length&&b&&b.length?Pr(u,b):u}var mE=Ys(function(u,b){var ue=null==u?0:u.length,ke=$p(u,b);return gh(u,ui(b,function(Ne){return Xs(Ne,ue)?+Ne:Ne}).sort(_h)),ke});function Lc(u){return null==u?u:Ab.call(u)}var my=Fn(function(u){return ks(Gr(u,1,ur,!0))}),$y=Fn(function(u){var b=fn(u);return ur(b)&&(b=T),ks(Gr(u,1,ur,!0),dn(b,2))}),Wp=Fn(function(u){var b=fn(u);return b="function"==typeof b?b:T,ks(Gr(u,1,ur,!0),T,b)});function Yp(u){if(!u||!u.length)return[];var b=0;return u=ga(u,function(ue){if(ur(ue))return b=Mr(ue.length,b),!0}),wc(b,function(ue){return ui(u,pa(ue))})}function p0(u,b){if(!u||!u.length)return[];var ue=Yp(u);return null==b?ue:ui(ue,function(ke){return xs(b,T,ke)})}var Qd=Fn(function(u,b){return ur(u)?Ll(u,b):[]}),yy=Fn(function(u){return M$(ga(u,ur))}),Cy=Fn(function(u){var b=fn(u);return ur(b)&&(b=T),M$(ga(u,ur),dn(b,2))}),xy=Fn(function(u){var b=fn(u);return b="function"==typeof b?b:T,M$(ga(u,ur),T,b)}),wy=Fn(Yp),Ty=Fn(function(u){var b=u.length,ue=b>1?u[b-1]:T;return ue="function"==typeof ue?(u.pop(),ue):T,p0(u,ue)});function m0(u){var b=He(u);return b.__chain__=!0,b}function Mh(u,b){return b(u)}var Dy=Ys(function(u){var b=u.length,ue=b?u[0]:0,ke=this.__wrapped__,Ne=function(je){return $p(je,u)};return!(b>1||this.__actions__.length)&&ke instanceof Xn&&Xs(ue)?((ke=ke.slice(ue,+ue+(b?1:0))).__actions__.push({func:Mh,args:[Ne],thisArg:T}),new Ts(ke,this.__chain__).thru(function(je){return b&&!je.length&&je.push(T),je})):this.thru(Ne)}),$0=mh(function(u,b,ue){Pi.call(u,ue)?++u[ue]:Ja(u,ue,1)}),Kp=R$(Vp),Xp=R$(r0);function Qp(u,b){return(On(u)?Hr:ya)(u,dn(b,3))}function Jp(u,b){return(On(u)?Oi:vp)(u,dn(b,3))}var e_=mh(function(u,b,ue){Pi.call(u,ue)?u[ue].push(b):Ja(u,ue,[b])}),b0=Fn(function(u,b,ue){var ke=-1,Ne="function"==typeof b,je=Vo(u)?gt(u.length):[];return ya(u,function(Ke){je[++ke]=Ne?xs(b,Ke,ue):xa(Ke,b,ue)}),je}),CE=mh(function(u,b,ue){Ja(u,ue,b)});function il(u,b){return(On(u)?ui:Tp)(u,dn(b,3))}var y0=mh(function(u,b,ue){u[ue?0:1].push(b)},function(){return[[],[]]}),C0=Fn(function(u,b){if(null==u)return[];var ue=b.length;return ue>1&&ao(u,b[0],b[1])?b=[]:ue>2&&ao(b[0],b[1],b[2])&&(b=[b[0]]),T$(u,Gr(b,1),[])}),Fu=Es||function(){return Dr.Date.now()};function Ph(u,b,ue){return b=ue?T:b,tl(u,U,T,T,T,T,b=u&&null==b?u.length:b)}function w0(u,b){var ue;if("function"!=typeof b)throw new qs(L);return u=Un(u),function(){return--u>0&&(ue=b.apply(this,arguments)),u<=1&&(b=T),ue}}var r_=Fn(function(u,b,ue){var ke=1;if(ue.length){var Ne=rs(ue,Ks(r_));ke|=N}return tl(u,ke,b,ue,Ne)}),o_=Fn(function(u,b,ue){var ke=3;if(ue.length){var Ne=rs(ue,Ks(o_));ke|=N}return tl(b,ke,u,ue,Ne)});function a_(u,b,ue){var ke,Ne,je,Ke,it,at,vt=0,bt=!1,St=!1,zt=!0;if("function"!=typeof u)throw new qs(L);function on(dr){var Fs=ke,ka=Ne;return ke=Ne=T,vt=dr,Ke=u.apply(ka,Fs)}function vn(dr){return vt=dr,it=Yd(Kn,b),bt?on(dr):Ke}function bn(dr){var Fs=dr-at;return at===T||Fs>=b||Fs<0||St&&dr-vt>=je}function Kn(){var dr=Fu();if(bn(dr))return ei(dr);it=Yd(Kn,function jn(dr){var DC=b-(dr-at);return St?Yn(DC,je-(dr-vt)):DC}(dr))}function ei(dr){return it=T,zt&&ke?on(dr):(ke=Ne=T,Ke)}function vo(){var dr=Fu(),Fs=bn(dr);if(ke=arguments,Ne=this,at=dr,Fs){if(it===T)return vn(at);if(St)return Mp(it),it=Yd(Kn,b),on(at)}return it===T&&(it=Yd(Kn,b)),Ke}return b=ea(b)||0,W(ue)&&(bt=!!ue.leading,je=(St="maxWait"in ue)?Mr(ea(ue.maxWait)||0,b):je,zt="trailing"in ue?!!ue.trailing:zt),vo.cancel=function Ps(){it!==T&&Mp(it),vt=0,ke=at=Ne=it=T},vo.flush=function Go(){return it===T?Ke:ei(Fu())},vo}var E0=Fn(function(u,b){return Ld(u,1,b)}),Ly=Fn(function(u,b,ue){return Ld(u,ea(b)||0,ue)});function Rh(u,b){if("function"!=typeof u||null!=b&&"function"!=typeof b)throw new qs(L);var ue=function(){var ke=arguments,Ne=b?b.apply(this,ke):ke[0],je=ue.cache;if(je.has(Ne))return je.get(Ne);var Ke=u.apply(this,ke);return ue.cache=je.set(Ne,Ke)||je,Ke};return ue.cache=new(Rh.Cache||ba),ue}function ef(u){if("function"!=typeof u)throw new qs(L);return function(){var b=arguments;switch(b.length){case 0:return!u.call(this);case 1:return!u.call(this,b[0]);case 2:return!u.call(this,b[0],b[1]);case 3:return!u.call(this,b[0],b[1],b[2])}return!u.apply(this,b)}}Rh.Cache=ba;var S0=ph(function(u,b){var ue=(b=1==b.length&&On(b[0])?ui(b[0],Ai(dn())):ui(Gr(b,1),Ai(dn()))).length;return Fn(function(ke){for(var Ne=-1,je=Yn(ke.length,ue);++Ne<je;)ke[Ne]=b[Ne].call(this,ke[Ne]);return xs(u,this,ke)})}),tf=Fn(function(u,b){var ue=rs(b,Ks(tf));return tl(u,N,T,b,ue)}),l_=Fn(function(u,b){var ue=rs(b,Ks(l_));return tl(u,64,T,b,ue)}),Nh=Ys(function(u,b){return tl(u,256,T,T,T,b)});function as(u,b){return u===b||u!=u&&b!=b}var A0=yh(Hd),xE=yh(function(u,b){return u>=b}),Zl=lh(function(){return arguments}())?lh:function(u){return tr(u)&&Pi.call(u,"callee")&&!u$.call(u,"callee")},On=gt.isArray,P0=Cs?Ai(Cs):function ch(u){return tr(u)&&oo(u)==Ze};function Vo(u){return null!=u&&kn(u.length)&&!rl(u)}function ur(u){return tr(u)&&Vo(u)}var Yl=Ib||N_,F0=t$?Ai(t$):function sE(u){return tr(u)&&oo(u)==De};function Bh(u){if(!tr(u))return!1;var b=oo(u);return b==fe||"[object DOMException]"==b||"string"==typeof u.message&&"string"==typeof u.name&&!Ru(u)}function rl(u){if(!W(u))return!1;var b=oo(u);return b==Pe||b==be||"[object AsyncFunction]"==b||"[object Proxy]"==b}function R0(u){return"number"==typeof u&&u==Un(u)}function kn(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=_}function W(u){var b=typeof u;return null!=u&&("object"==b||"function"==b)}function tr(u){return null!=u&&"object"==typeof u}var d_=n$?Ai(n$):function Ub(u){return tr(u)&&so(u)==xe};function zh(u){return"number"==typeof u||tr(u)&&oo(u)==pe}function Ru(u){if(!tr(u)||oo(u)!=Ce)return!1;var b=vr(u);if(null===b)return!0;var ue=Pi.call(b,"constructor")&&b.constructor;return"function"==typeof ue&&ue instanceof ue&&Jg.call(ue)==l$}var rf=i$?Ai(i$):function xp(u){return tr(u)&&oo(u)==Ee},h_=wb?Ai(wb):function wp(u){return tr(u)&&so(u)==C};function g_(u){return"string"==typeof u||!On(u)&&tr(u)&&oo(u)==V}function co(u){return"symbol"==typeof u||tr(u)&&oo(u)==$e}var sl=wi?Ai(wi):function uh(u){return tr(u)&&kn(u.length)&&!!qi[oo(u)]},EE=yh(dh),Yy=yh(function(u,b){return u<=b});function O0(u){if(!u)return[];if(Vo(u))return g_(u)?lr(u):Uo(u);if(hu&&u[hu])return function uu(ot){for(var pt,gt=[];!(pt=ot.next()).done;)gt.push(pt.value);return gt}(u[hu]());var b=so(u);return(b==xe?Nn:b==C?du:ll)(u)}function al(u){return u?(u=ea(u))===O||u===-O?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Un(u){var b=al(u),ue=b%1;return b==b?ue?b-ue:b:0}function $_(u){return u?Pc(Un(u),0,h):0}function ea(u){if("number"==typeof u)return u;if(co(u))return c;if(W(u)){var b="function"==typeof u.valueOf?u.valueOf():u;u=W(b)?b+"":b}if("string"!=typeof u)return 0===u?u:+u;u=Fl(u);var ue=Td.test(u);return ue||kl.test(u)?qg(u.slice(2),ue?2:8):Il.test(u)?c:+u}function B0(u){return Ea(u,jo(u))}function _i(u){return null==u?"":Is(u)}var L0=Nc(function(u,b){if(Zd(b)||Vo(b))Ea(b,br(b),u);else for(var ue in b)Pi.call(b,ue)&&Od(u,ue,b[ue])}),z0=Nc(function(u,b){Ea(b,jo(b),u)}),Nu=Nc(function(u,b,ue,ke){Ea(b,jo(b),u,ke)}),SE=Nc(function(u,b,ue,ke){Ea(b,br(b),u,ke)}),DE=Ys($p),kE=Fn(function(u,b){u=Hi(u);var ue=-1,ke=b.length,Ne=ke>2?b[2]:T;for(Ne&&ao(b[0],b[1],Ne)&&(ke=1);++ue<ke;)for(var je=b[ue],Ke=jo(je),it=-1,at=Ke.length;++it<at;){var vt=Ke[it],bt=u[vt];(bt===T||as(bt,Fd[vt])&&!Pi.call(u,vt))&&(u[vt]=je[vt])}return u}),ME=Fn(function(u){return u.push(T,qd),xs(H0,T,u)});function Uh(u,b,ue){var ke=null==u?T:bu(u,b);return ke===T?ue:ke}function Hh(u,b){return null!=u&&Dh(u,b,y$)}var y_=O$(function(u,b,ue){null!=b&&"function"!=typeof b.toString&&(b=ep.call(b)),u[b]=ue},k_(qr)),Xy=O$(function(u,b,ue){null!=b&&"function"!=typeof b.toString&&(b=ep.call(b)),Pi.call(u,b)?u[b].push(ue):u[b]=[ue]},dn),Xl=Fn(xa);function br(u){return Vo(u)?pp(u):Ep(u)}function jo(u){return Vo(u)?pp(u,!0):function w$(u){if(!W(u))return function Z$(u){var b=[];if(null!=u)for(var ue in Hi(u))b.push(ue);return b}(u);var b=Zd(u),ue=[];for(var ke in u)"constructor"==ke&&(b||!Pi.call(u,ke))||ue.push(ke);return ue}(u)}var U0=Nc(function(u,b,ue){fh(u,b,ue)}),H0=Nc(function(u,b,ue,ke){fh(u,b,ue,ke)}),Jy=Ys(function(u,b){var ue={};if(null==u)return ue;var ke=!1;b=ui(b,function(je){return je=el(je,u),ke||(ke=je.length>1),je}),Ea(u,wh(u),ue),ke&&(ue=Ds(ue,7,L$));for(var Ne=b.length;Ne--;)k$(ue,b[Ne]);return ue}),Ou=Ys(function(u,b){return null==u?{}:function S$(u,b){return Dp(u,b,function(ue,ke){return Hh(u,ke)})}(u,b)});function Vh(u,b){if(null==u)return{};var ue=ui(wh(u),function(ke){return[ke]});return b=dn(b),Dp(u,ue,function(ke,Ne){return b(ke,Ne[0])})}var V0=B$(br),x_=B$(jo);function ll(u){return null==u?[]:Yg(u,br(u))}var Z0=Hl(function(u,b,ue){return b=b.toLowerCase(),u+(ue?Y0(b):b)});function Y0(u){return I_(_i(u).toLowerCase())}function T_(u){return(u=_i(u))&&u.replace(ru,is).replace(Jw,"")}var iC=Hl(function(u,b,ue){return u+(ue?"-":"")+b.toLowerCase()}),rC=Hl(function(u,b,ue){return u+(ue?" ":"")+b.toLowerCase()}),BE=Iu("toLowerCase"),sC=Hl(function(u,b,ue){return u+(ue?"_":"")+b.toLowerCase()}),lC=Hl(function(u,b,ue){return u+(ue?" ":"")+I_(b)}),D_=Hl(function(u,b,ue){return u+(ue?" ":"")+b.toUpperCase()}),I_=Iu("toUpperCase");function nv(u,b,ue){return u=_i(u),(b=ue?T:b)===T?function Md(ot){return jg.test(ot)}(u)?function Gs(ot){return ot.match(eE)||[]}(u):function s$(ot){return ot.match(zg)||[]}(u):u.match(b)||[]}var hC=Fn(function(u,b){try{return xs(u,T,b)}catch(ue){return Bh(ue)?ue:new Pn(ue)}}),iv=Ys(function(u,b){return Hr(b,function(ue){ue=Ho(ue),Ja(u,ue,r_(u[ue],u))}),u});function k_(u){return function(){return u}}var _C=N$(),mC=N$(!0);function qr(u){return u}function af(u){return Vd("function"==typeof u?u:Ds(u,1))}var P_=Fn(function(u,b){return function(ue){return xa(ue,u,b)}}),rv=Fn(function(u,b){return function(ue){return xa(u,ue,b)}});function F_(u,b,ue){var ke=br(b),Ne=yp(b,ke);null==ue&&(!W(b)||!Ne.length&&ke.length)&&(ue=b,b=u,u=this,Ne=yp(b,br(b)));var je=!(W(ue)&&"chain"in ue&&!ue.chain),Ke=rl(u);return Hr(Ne,function(it){var at=b[it];u[it]=at,Ke&&(u.prototype[it]=function(){var vt=this.__chain__;if(je||vt){var bt=u(this.__wrapped__),St=bt.__actions__=Uo(this.__actions__);return St.push({func:at,args:arguments,thisArg:u}),bt.__chain__=vt,bt}return at.apply(u,ws([this.value()],arguments))})}),u}function lf(){}var bC=vh(ui),ov=vh(Id),sv=vh(Zg);function R_(u){return kh(u)?pa(Ho(u)):function wu(u){return function(b){return bu(b,u)}}(u)}var lv=Fp(),cl=Fp(!0);function zu(){return[]}function N_(){return!1}var CC=jl(function(u,b){return u+b},0),L_=Oc("ceil"),uv=jl(function(u,b){return u/b},1),dv=Oc("floor"),Uu=jl(function(u,b){return u*b},1),gv=Oc("round"),TC=jl(function(u,b){return u-b},0);return He.after=function x0(u,b){if("function"!=typeof b)throw new qs(L);return u=Un(u),function(){if(--u<1)return b.apply(this,arguments)}},He.ary=Ph,He.assign=L0,He.assignIn=z0,He.assignInWith=Nu,He.assignWith=SE,He.at=DE,He.before=w0,He.bind=r_,He.bindAll=iv,He.bindKey=o_,He.castArray=function nf(){if(!arguments.length)return[];var u=arguments[0];return On(u)?u:[u]},He.chain=m0,He.chunk=function e0(u,b,ue){b=(ue?ao(u,b,ue):b===T)?1:Mr(Un(b),0);var ke=null==u?0:u.length;if(!ke||b<1)return[];for(var Ne=0,je=0,Ke=gt(Jf(ke/b));Ne<ke;)Ke[je++]=Zs(u,Ne,Ne+=b);return Ke},He.compact=function t0(u){for(var b=-1,ue=null==u?0:u.length,ke=0,Ne=[];++b<ue;){var je=u[b];je&&(Ne[ke++]=je)}return Ne},He.concat=function n0(){var u=arguments.length;if(!u)return[];for(var b=gt(u-1),ue=arguments[0],ke=u;ke--;)b[ke-1]=arguments[ke];return ws(On(ue)?Uo(ue):[ue],Gr(b,1))},He.cond=function gC(u){var b=null==u?0:u.length,ue=dn();return u=b?ui(u,function(ke){if("function"!=typeof ke[1])throw new qs(L);return[ue(ke[0]),ke[1]]}):[],Fn(function(ke){for(var Ne=-1;++Ne<b;){var je=u[Ne];if(xs(je[0],this,ke))return xs(je[1],this,ke)}})},He.conforms=function pC(u){return function Bb(u){var b=br(u);return function(ue){return Bd(ue,u,b)}}(Ds(u,1))},He.constant=k_,He.countBy=$0,He.create=function IE(u,b){var ue=mu(u);return null==b?ue:er(ue,b)},He.curry=function s_(u,b,ue){var ke=tl(u,8,T,T,T,T,T,b=ue?T:b);return ke.placeholder=s_.placeholder,ke},He.curryRight=function Wl(u,b,ue){var ke=tl(u,16,T,T,T,T,T,b=ue?T:b);return ke.placeholder=Wl.placeholder,ke},He.debounce=a_,He.defaults=kE,He.defaultsDeep=ME,He.defer=E0,He.delay=Ly,He.difference=fE,He.differenceBy=hE,He.differenceWith=gE,He.drop=function zp(u,b,ue){var ke=null==u?0:u.length;return ke?Zs(u,(b=ue||b===T?1:Un(b))<0?0:b,ke):[]},He.dropRight=function Up(u,b,ue){var ke=null==u?0:u.length;return ke?Zs(u,0,(b=ke-(b=ue||b===T?1:Un(b)))<0?0:b):[]},He.dropRightWhile=function Hp(u,b){return u&&u.length?Tu(u,dn(b,3),!0,!0):[]},He.dropWhile=function pE(u,b){return u&&u.length?Tu(u,dn(b,3),!0):[]},He.fill=function _E(u,b,ue,ke){var Ne=null==u?0:u.length;return Ne?(ue&&"number"!=typeof ue&&ao(u,b,ue)&&(ue=0,ke=Ne),function zd(u,b,ue,ke){var Ne=u.length;for((ue=Un(ue))<0&&(ue=-ue>Ne?0:Ne+ue),(ke=ke===T||ke>Ne?Ne:Un(ke))<0&&(ke+=Ne),ke=ue>ke?0:$_(ke);ue<ke;)u[ue++]=b;return u}(u,b,ue,ke)):[]},He.filter=function ss(u,b){return(On(u)?ga:b$)(u,dn(b,3))},He.flatMap=function My(u,b){return Gr(il(u,b),1)},He.flatMapDeep=function v0(u,b){return Gr(il(u,b),O)},He.flatMapDepth=function Jd(u,b,ue){return ue=ue===T?1:Un(ue),Gr(il(u,b),ue)},He.flatten=o0,He.flattenDeep=function oy(u){return null!=u&&u.length?Gr(u,O):[]},He.flattenDepth=function sy(u,b){return null!=u&&u.length?Gr(u,b=b===T?1:Un(b)):[]},He.flip=function Fh(u){return tl(u,512)},He.flow=_C,He.flowRight=mC,He.fromPairs=function s0(u){for(var b=-1,ue=null==u?0:u.length,ke={};++b<ue;){var Ne=u[b];ke[Ne[0]]=Ne[1]}return ke},He.functions=function v_(u){return null==u?[]:yp(u,br(u))},He.functionsIn=function Ky(u){return null==u?[]:yp(u,jo(u))},He.groupBy=e_,He.initial=function jp(u){return null!=u&&u.length?Zs(u,0,-1):[]},He.intersection=ay,He.intersectionBy=Vi,He.intersectionWith=Bc,He.invert=y_,He.invertBy=Xy,He.invokeMap=b0,He.iteratee=af,He.keyBy=CE,He.keys=br,He.keysIn=jo,He.map=il,He.mapKeys=function C_(u,b){var ue={};return b=dn(b,3),Ca(u,function(ke,Ne,je){Ja(ue,b(ke,Ne,je),ke)}),ue},He.mapValues=function Qy(u,b){var ue={};return b=dn(b,3),Ca(u,function(ke,Ne,je){Ja(ue,Ne,b(ke,Ne,je))}),ue},He.matches=function $C(u){return Sp(Ds(u,1))},He.matchesProperty=function A_(u,b){return E$(u,Ds(b,1))},He.memoize=Rh,He.merge=U0,He.mergeWith=H0,He.method=P_,He.methodOf=rv,He.mixin=F_,He.negate=ef,He.nthArg=function UE(u){return u=Un(u),Fn(function(b){return xu(b,u)})},He.omit=Jy,He.omitBy=function of(u,b){return Vh(u,ef(dn(b)))},He.once=function T0(u){return w0(2,u)},He.orderBy=function n_(u,b,ue,ke){return null==u?[]:(On(b)||(b=null==b?[]:[b]),On(ue=ke?T:ue)||(ue=null==ue?[]:[ue]),T$(u,b,ue))},He.over=bC,He.overArgs=S0,He.overEvery=ov,He.overSome=sv,He.partial=tf,He.partialRight=l_,He.partition=y0,He.pick=Ou,He.pickBy=Vh,He.property=R_,He.propertyOf=function av(u){return function(b){return null==u?T:bu(u,b)}},He.pull=uy,He.pullAll=c0,He.pullAllBy=function dy(u,b,ue){return u&&u.length&&b&&b.length?Pr(u,b,dn(ue,2)):u},He.pullAllWith=function fy(u,b,ue){return u&&u.length&&b&&b.length?Pr(u,b,T,ue):u},He.pullAt=mE,He.range=lv,He.rangeRight=cl,He.rearg=Nh,He.reject=function Py(u,b){return(On(u)?ga:b$)(u,ef(dn(b,3)))},He.remove=function $E(u,b){var ue=[];if(!u||!u.length)return ue;var ke=-1,Ne=[],je=u.length;for(b=dn(b,3);++ke<je;){var Ke=u[ke];b(Ke,ke,u)&&(ue.push(Ke),Ne.push(ke))}return gh(u,Ne),ue},He.rest=function Oh(u,b){if("function"!=typeof u)throw new qs(L);return Fn(u,b=b===T?b:Un(b))},He.reverse=Lc,He.sampleSize=function Ry(u,b,ue){return b=(ue?ao(u,b,ue):b===T)?1:Un(b),(On(u)?v$:Ip)(u,b)},He.set=function sf(u,b,ue){return null==u?u:wa(u,b,ue)},He.setWith=function Lu(u,b,ue,ke){return ke="function"==typeof ke?ke:T,null==u?u:wa(u,b,ue,ke)},He.shuffle=function Ny(u){return(On(u)?oh:Jn)(u)},He.slice=function $o(u,b,ue){var ke=null==u?0:u.length;return ke?(ue&&"number"!=typeof ue&&ao(u,b,ue)?(b=0,ue=ke):(b=null==b?0:Un(b),ue=ue===T?ke:Un(ue)),Zs(u,b,ue)):[]},He.sortBy=C0,He.sortedUniq=function hy(u){return u&&u.length?jb(u):[]},He.sortedUniqBy=function gy(u,b){return u&&u.length?jb(u,dn(b,2)):[]},He.split=function aC(u,b,ue){return ue&&"number"!=typeof ue&&ao(u,b,ue)&&(b=ue=T),(ue=ue===T?h:ue>>>0)?(u=_i(u))&&("string"==typeof b||null!=b&&!rf(b))&&!(b=Is(b))&&Ui(u)?As(lr(u),0,ue):u.split(b,ue):[]},He.spread=function D0(u,b){if("function"!=typeof u)throw new qs(L);return b=null==b?0:Mr(Un(b),0),Fn(function(ue){var ke=ue[b],Ne=As(ue,0,b);return ke&&ws(Ne,ke),xs(u,this,Ne)})},He.tail=function f0(u){var b=null==u?0:u.length;return b?Zs(u,1,b):[]},He.take=function py(u,b,ue){return u&&u.length?Zs(u,0,(b=ue||b===T?1:Un(b))<0?0:b):[]},He.takeRight=function h0(u,b,ue){var ke=null==u?0:u.length;return ke?Zs(u,(b=ke-(b=ue||b===T?1:Un(b)))<0?0:b,ke):[]},He.takeRightWhile=function _y(u,b){return u&&u.length?Tu(u,dn(b,3),!1,!0):[]},He.takeWhile=function g0(u,b){return u&&u.length?Tu(u,dn(b,3)):[]},He.tap=function Sy(u,b){return b(u),u},He.throttle=function c_(u,b,ue){var ke=!0,Ne=!0;if("function"!=typeof u)throw new qs(L);return W(ue)&&(ke="leading"in ue?!!ue.leading:ke,Ne="trailing"in ue?!!ue.trailing:Ne),a_(u,b,{leading:ke,maxWait:b,trailing:Ne})},He.thru=Mh,He.toArray=O0,He.toPairs=V0,He.toPairsIn=x_,He.toPath=function B_(u){return On(u)?ui(u,Ho):co(u)?[u]:Uo(J$(_i(u)))},He.toPlainObject=B0,He.transform=function j0(u,b,ue){var ke=On(u),Ne=ke||Yl(u)||sl(u);if(b=dn(b,4),null==ue){var je=u&&u.constructor;ue=Ne?ke?new je:[]:W(u)&&rl(je)?mu(vr(u)):{}}return(Ne?Hr:Ca)(u,function(Ke,it,at){return b(ue,Ke,it,at)}),ue},He.unary=function I0(u){return Ph(u,1)},He.union=my,He.unionBy=$y,He.unionWith=Wp,He.uniq=function vy(u){return u&&u.length?ks(u):[]},He.uniqBy=function by(u,b){return u&&u.length?ks(u,dn(b,2)):[]},He.uniqWith=function Zp(u,b){return b="function"==typeof b?b:T,u&&u.length?ks(u,T,b):[]},He.unset=function w_(u,b){return null==u||k$(u,b)},He.unzip=Yp,He.unzipWith=p0,He.update=function E_(u,b,ue){return null==u?u:pr(u,b,Ms(ue))},He.updateWith=function G0(u,b,ue,ke){return ke="function"==typeof ke?ke:T,null==u?u:pr(u,b,Ms(ue),ke)},He.values=ll,He.valuesIn=function eC(u){return null==u?[]:Yg(u,jo(u))},He.without=Qd,He.words=nv,He.wrap=function u_(u,b){return tf(Ms(b),u)},He.xor=yy,He.xorBy=Cy,He.xorWith=xy,He.zip=wy,He.zipObject=function Ey(u,b){return A$(u||[],b||[],Od)},He.zipObjectDeep=function _0(u,b){return A$(u||[],b||[],wa)},He.zipWith=Ty,He.entries=V0,He.entriesIn=x_,He.extend=z0,He.extendWith=Nu,F_(He,He),He.add=CC,He.attempt=hC,He.camelCase=Z0,He.capitalize=Y0,He.ceil=L_,He.clamp=function q0(u,b,ue){return ue===T&&(ue=b,b=T),ue!==T&&(ue=(ue=ea(ue))==ue?ue:0),b!==T&&(b=(b=ea(b))==b?b:0),Pc(ea(u),b,ue)},He.clone=function zy(u){return Ds(u,4)},He.cloneDeep=function Uy(u){return Ds(u,5)},He.cloneDeepWith=function Hy(u,b){return Ds(u,5,b="function"==typeof b?b:T)},He.cloneWith=function k0(u,b){return Ds(u,4,b="function"==typeof b?b:T)},He.conformsTo=function M0(u,b){return null==b||Bd(u,b,br(b))},He.deburr=T_,He.defaultTo=function M_(u,b){return null==u||u!=u?b:u},He.divide=uv,He.endsWith=function tC(u,b,ue){u=_i(u),b=Is(b);var ke=u.length,Ne=ue=ue===T?ke:Pc(Un(ue),0,ke);return(ue-=b.length)>=0&&u.slice(ue,Ne)==b},He.eq=as,He.escape=function nC(u){return(u=_i(u))&&eu.test(u)?u.replace(Jc,Ec):u},He.escapeRegExp=function ls(u){return(u=_i(u))&&tu.test(u)?u.replace(xd,"\\$&"):u},He.every=function yE(u,b,ue){var ke=On(u)?Id:Lb;return ue&&ao(u,b,ue)&&(b=T),ke(u,dn(b,3))},He.find=Kp,He.findIndex=Vp,He.findKey=function AE(u,b){return ts(u,dn(b,3),Ca)},He.findLast=Xp,He.findLastIndex=r0,He.findLastKey=function PE(u,b){return ts(u,dn(b,3),bp)},He.floor=dv,He.forEach=Qp,He.forEachRight=Jp,He.forIn=function FE(u,b){return null==u?u:Fc(u,dn(b,3),jo)},He.forInRight=function RE(u,b){return null==u?u:sh(u,dn(b,3),jo)},He.forOwn=function NE(u,b){return u&&Ca(u,dn(b,3))},He.forOwnRight=function Kl(u,b){return u&&bp(u,dn(b,3))},He.get=Uh,He.gt=A0,He.gte=xE,He.has=function b_(u,b){return null!=u&&Dh(u,b,ah)},He.hasIn=Hh,He.head=Kd,He.identity=qr,He.includes=function t_(u,b,ue,ke){u=Vo(u)?u:ll(u),ue=ue&&!ke?Un(ue):0;var Ne=u.length;return ue<0&&(ue=Mr(Ne+ue,0)),g_(u)?ue<=Ne&&u.indexOf(b,ue)>-1:!!Ne&&xc(u,b,ue)>-1},He.indexOf=function a0(u,b,ue){var ke=null==u?0:u.length;if(!ke)return-1;var Ne=null==ue?0:Un(ue);return Ne<0&&(Ne=Mr(ke+Ne,0)),xc(u,b,Ne)},He.inRange=function OE(u,b,ue){return b=al(b),ue===T?(ue=b,b=0):ue=al(ue),function C$(u,b,ue){return u>=Yn(b,ue)&&u<Mr(b,ue)}(u=ea(u),b,ue)},He.invoke=Xl,He.isArguments=Zl,He.isArray=On,He.isArrayBuffer=P0,He.isArrayLike=Vo,He.isArrayLikeObject=ur,He.isBoolean=function Qs(u){return!0===u||!1===u||tr(u)&&oo(u)==se},He.isBuffer=Yl,He.isDate=F0,He.isElement=function Vy(u){return tr(u)&&1===u.nodeType&&!Ru(u)},He.isEmpty=function jy(u){if(null==u)return!0;if(Vo(u)&&(On(u)||"string"==typeof u||"function"==typeof u.splice||Yl(u)||sl(u)||Zl(u)))return!u.length;var b=so(u);if(b==xe||b==C)return!u.size;if(Zd(u))return!Ep(u).length;for(var ue in u)if(Pi.call(u,ue))return!1;return!0},He.isEqual=function Gy(u,b){return yu(u,b)},He.isEqualWith=function qy(u,b,ue){var ke=(ue="function"==typeof ue?ue:T)?ue(u,b):T;return ke===T?yu(u,b,T,ue):!!ke},He.isError=Bh,He.isFinite=function Wy(u){return"number"==typeof u&&eh(u)},He.isFunction=rl,He.isInteger=R0,He.isLength=kn,He.isMap=d_,He.isMatch=function Lh(u,b){return u===b||Cp(u,b,U$(b))},He.isMatchWith=function Js(u,b,ue){return ue="function"==typeof ue?ue:T,Cp(u,b,U$(b),ue)},He.isNaN=function N0(u){return zh(u)&&u!=+u},He.isNative=function Zy(u){if(ny(u))throw new Pn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Cu(u)},He.isNil=function ol(u){return null==u},He.isNull=function f_(u){return null===u},He.isNumber=zh,He.isObject=W,He.isObjectLike=tr,He.isPlainObject=Ru,He.isRegExp=rf,He.isSafeInteger=function wE(u){return R0(u)&&u>=-_&&u<=_},He.isSet=h_,He.isString=g_,He.isSymbol=co,He.isTypedArray=sl,He.isUndefined=function p_(u){return u===T},He.isWeakMap=function __(u){return tr(u)&&so(u)==Fe},He.isWeakSet=function m_(u){return tr(u)&&"[object WeakSet]"==oo(u)},He.join=function ly(u,b){return null==u?"":kb.call(u,b)},He.kebabCase=iC,He.last=fn,He.lastIndexOf=function l0(u,b,ue){var ke=null==u?0:u.length;if(!ke)return-1;var Ne=ke;return ue!==T&&(Ne=(Ne=Un(ue))<0?Mr(ke+Ne,0):Yn(Ne,ke-1)),b==b?function Pd(ot,pt,gt){for(var Yt=gt+1;Yt--;)if(ot[Yt]===pt)return Yt;return Yt}(u,b,Ne):Yf(u,Vr,Ne,!0)},He.lowerCase=rC,He.lowerFirst=BE,He.lt=EE,He.lte=Yy,He.max=function fv(u){return u&&u.length?Ws(u,qr,Hd):T},He.maxBy=function xC(u,b){return u&&u.length?Ws(u,dn(b,2),Hd):T},He.mean=function z_(u){return jr(u,qr)},He.meanBy=function wC(u,b){return jr(u,dn(b,2))},He.min=function EC(u){return u&&u.length?Ws(u,qr,dh):T},He.minBy=function hv(u,b){return u&&u.length?Ws(u,dn(b,2),dh):T},He.stubArray=zu,He.stubFalse=N_,He.stubObject=function yC(){return{}},He.stubString=function HE(){return""},He.stubTrue=function O_(){return!0},He.multiply=Uu,He.nth=function cy(u,b){return u&&u.length?xu(u,Un(b)):T},He.noConflict=function vC(){return Dr._===this&&(Dr._=tp),this},He.noop=lf,He.now=Fu,He.pad=function LE(u,b,ue){u=_i(u);var ke=(b=Un(b))?js(u):0;if(!b||ke>=b)return u;var Ne=(b-ke)/2;return bh(pu(Ne),ue)+u+bh(Jf(Ne),ue)},He.padEnd=function K0(u,b,ue){u=_i(u);var ke=(b=Un(b))?js(u):0;return b&&ke<b?u+bh(b-ke,ue):u},He.padStart=function zE(u,b,ue){u=_i(u);var ke=(b=Un(b))?js(u):0;return b&&ke<b?bh(b-ke,ue)+u:u},He.parseInt=function oC(u,b,ue){return ue||null==b?b=0:b&&(b=+b),Mb(_i(u).replace(Jo,""),b||0)},He.random=function W0(u,b,ue){if(ue&&"boolean"!=typeof ue&&ao(u,b,ue)&&(b=ue=T),ue===T&&("boolean"==typeof b?(ue=b,b=T):"boolean"==typeof u&&(ue=u,u=T)),u===T&&b===T?(u=0,b=1):(u=al(u),b===T?(b=u,u=0):b=al(b)),u>b){var ke=u;u=b,b=ke}if(ue||u%1||b%1){var Ne=cr();return Yn(u+Ne*(b-u+Rn("1e-"+((Ne+"").length-1))),b)}return Rc(u,b)},He.reduce=function Ay(u,b,ue){var ke=On(u)?Wg:ns,Ne=arguments.length<3;return ke(u,dn(b,4),ue,Ne,ya)},He.reduceRight=function i_(u,b,ue){var ke=On(u)?Xt:ns,Ne=arguments.length<3;return ke(u,dn(b,4),ue,Ne,vp)},He.repeat=function S_(u,b,ue){return b=(ue?ao(u,b,ue):b===T)?1:Un(b),Ul(_i(u),b)},He.replace=function X0(){var u=arguments,b=_i(u[0]);return u.length<3?b:b.replace(u[1],u[2])},He.result=function Bu(u,b,ue){var ke=-1,Ne=(b=el(b,u)).length;for(Ne||(Ne=1,u=T);++ke<Ne;){var je=null==u?T:u[Ho(b[ke])];je===T&&(ke=Ne,je=ue),u=rl(je)?je.call(u):je}return u},He.round=gv,He.runInContext=ot,He.sample=function Fy(u){return(On(u)?_p:D$)(u)},He.size=function Oy(u){if(null==u)return 0;if(Vo(u))return g_(u)?js(u):u.length;var b=so(u);return b==xe||b==C?u.size:Ep(u).length},He.snakeCase=sC,He.some=function By(u,b,ue){var ke=On(u)?Zg:aE;return ue&&ao(u,b,ue)&&(b=T),ke(u,dn(b,3))},He.sortedIndex=function Gp(u,b){return kp(u,b)},He.sortedIndexBy=function u0(u,b,ue){return I$(u,b,dn(ue,2))},He.sortedIndexOf=function d0(u,b){var ue=null==u?0:u.length;if(ue){var ke=kp(u,b);if(ke<ue&&as(u[ke],b))return ke}return-1},He.sortedLastIndex=function lo(u,b){return kp(u,b,!0)},He.sortedLastIndexBy=function Xd(u,b,ue){return I$(u,b,dn(ue,2),!0)},He.sortedLastIndexOf=function qp(u,b){if(null!=u&&u.length){var ke=kp(u,b,!0)-1;if(as(u[ke],b))return ke}return-1},He.startCase=lC,He.startsWith=function Q0(u,b,ue){return u=_i(u),ue=null==ue?0:Pc(Un(ue),0,u.length),b=Is(b),u.slice(ue,ue+b.length)==b},He.subtract=TC,He.sum=function SC(u){return u&&u.length?kd(u,qr):0},He.sumBy=function Hu(u,b){return u&&u.length?kd(u,dn(b,2)):0},He.template=function cC(u,b,ue){var ke=He.templateSettings;ue&&ao(u,b,ue)&&(b=T),u=_i(u),b=Nu({},b,ke,xh);var it,at,Ne=Nu({},b.imports,ke.imports,xh),je=br(Ne),Ke=Yg(Ne,je),vt=0,bt=b.interpolate||Ml,St="__p += '",zt=a$((b.escape||Ml).source+"|"+bt.source+"|"+(bt===jf?iu:Ml).source+"|"+(b.evaluate||Ml).source+"|$","g"),on="//# sourceURL="+(Pi.call(b,"sourceURL")?(b.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yb+"]")+"\n";u.replace(zt,function(bn,Kn,ei,Ps,Go,vo){return ei||(ei=Ps),St+=u.slice(vt,vo).replace(Hg,Ir),Kn&&(it=!0,St+="' +\n__e("+Kn+") +\n'"),Go&&(at=!0,St+="';\n"+Go+";\n__p += '"),ei&&(St+="' +\n((__t = ("+ei+")) == null ? '' : __t) +\n'"),vt=vo+bn.length,bn}),St+="';\n";var vn=Pi.call(b,"variable")&&b.variable;if(vn){if(Ug.test(vn))throw new Pn("Invalid `variable` option passed into `_.template`")}else St="with (obj) {\n"+St+"\n}\n";St=(at?St.replace($c,""):St).replace(Qo,"$1").replace(Sl,"$1;"),St="function("+(vn||"obj")+") {\n"+(vn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(it?", __e = _.escape":"")+(at?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+St+"return __p\n}";var jn=hC(function(){return pi(je,on+"return "+St).apply(T,Ke)});if(jn.source=St,Bh(jn))throw jn;return jn},He.times=function cv(u,b){if((u=Un(u))<1||u>_)return[];var ue=h,ke=Yn(u,h);b=dn(b),u-=h;for(var Ne=wc(ke,b);++ue<u;)b(ue);return Ne},He.toFinite=al,He.toInteger=Un,He.toLength=$_,He.toLower=function J0(u){return _i(u).toLowerCase()},He.toNumber=ea,He.toSafeInteger=function TE(u){return u?Pc(Un(u),-_,_):0===u?u:0},He.toString=_i,He.toUpper=function uC(u){return _i(u).toUpperCase()},He.trim=function dC(u,b,ue){if((u=_i(u))&&(ue||b===T))return Fl(u);if(!u||!(b=Is(b)))return u;var ke=lr(u),Ne=lr(b);return As(ke,Ut(ke,Ne),Vn(ke,Ne)+1).join("")},He.trimEnd=function ev(u,b,ue){if((u=_i(u))&&(ue||b===T))return u.slice(0,Bi(u)+1);if(!u||!(b=Is(b)))return u;var ke=lr(u);return As(ke,0,Vn(ke,lr(b))+1).join("")},He.trimStart=function tv(u,b,ue){if((u=_i(u))&&(ue||b===T))return u.replace(Jo,"");if(!u||!(b=Is(b)))return u;var ke=lr(u);return As(ke,Ut(ke,lr(b))).join("")},He.truncate=function fC(u,b){var ue=30,ke="...";if(W(b)){var Ne="separator"in b?b.separator:Ne;ue="length"in b?Un(b.length):ue,ke="omission"in b?Is(b.omission):ke}var je=(u=_i(u)).length;if(Ui(u)){var Ke=lr(u);je=Ke.length}if(ue>=je)return u;var it=ue-js(ke);if(it<1)return ke;var at=Ke?As(Ke,0,it).join(""):u.slice(0,it);if(Ne===T)return at+ke;if(Ke&&(it+=at.length-it),rf(Ne)){if(u.slice(it).search(Ne)){var vt,bt=at;for(Ne.global||(Ne=a$(Ne.source,_i(Dl.exec(Ne))+"g")),Ne.lastIndex=0;vt=Ne.exec(bt);)var St=vt.index;at=at.slice(0,St===T?it:St)}}else if(u.indexOf(Is(Ne),it)!=it){var zt=at.lastIndexOf(Ne);zt>-1&&(at=at.slice(0,zt))}return at+ke},He.unescape=function Ia(u){return(u=_i(u))&&Cd.test(u)?u.replace(yd,Eb):u},He.uniqueId=function cf(u){var b=++rE;return _i(u)+b},He.upperCase=D_,He.upperFirst=I_,He.each=Qp,He.eachRight=Jp,He.first=Kd,F_(He,function(){var u={};return Ca(He,function(b,ue){Pi.call(He.prototype,ue)||(u[ue]=b)}),u}(),{chain:!1}),He.VERSION="4.17.21",Hr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){He[u].placeholder=He}),Hr(["drop","take"],function(u,b){Xn.prototype[u]=function(ue){ue=ue===T?1:Mr(Un(ue),0);var ke=this.__filtered__&&!b?new Xn(this):this.clone();return ke.__filtered__?ke.__takeCount__=Yn(ue,ke.__takeCount__):ke.__views__.push({size:Yn(ue,h),type:u+(ke.__dir__<0?"Right":"")}),ke},Xn.prototype[u+"Right"]=function(ue){return this.reverse()[u](ue).reverse()}}),Hr(["filter","map","takeWhile"],function(u,b){var ue=b+1,ke=1==ue||3==ue;Xn.prototype[u]=function(Ne){var je=this.clone();return je.__iteratees__.push({iteratee:dn(Ne,3),type:ue}),je.__filtered__=je.__filtered__||ke,je}}),Hr(["head","last"],function(u,b){var ue="take"+(b?"Right":"");Xn.prototype[u]=function(){return this[ue](1).value()[0]}}),Hr(["initial","tail"],function(u,b){var ue="drop"+(b?"":"Right");Xn.prototype[u]=function(){return this.__filtered__?new Xn(this):this[ue](1)}}),Xn.prototype.compact=function(){return this.filter(qr)},Xn.prototype.find=function(u){return this.filter(u).head()},Xn.prototype.findLast=function(u){return this.reverse().find(u)},Xn.prototype.invokeMap=Fn(function(u,b){return"function"==typeof u?new Xn(this):this.map(function(ue){return xa(ue,u,b)})}),Xn.prototype.reject=function(u){return this.filter(ef(dn(u)))},Xn.prototype.slice=function(u,b){u=Un(u);var ue=this;return ue.__filtered__&&(u>0||b<0)?new Xn(ue):(u<0?ue=ue.takeRight(-u):u&&(ue=ue.drop(u)),b!==T&&(ue=(b=Un(b))<0?ue.dropRight(-b):ue.take(b-u)),ue)},Xn.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Xn.prototype.toArray=function(){return this.take(h)},Ca(Xn.prototype,function(u,b){var ue=/^(?:filter|find|map|reject)|While$/.test(b),ke=/^(?:head|last)$/.test(b),Ne=He[ke?"take"+("last"==b?"Right":""):b],je=ke||/^find/.test(b);!Ne||(He.prototype[b]=function(){var Ke=this.__wrapped__,it=ke?[1]:arguments,at=Ke instanceof Xn,vt=it[0],bt=at||On(Ke),St=function(Kn){var ei=Ne.apply(He,ws([Kn],it));return ke&&zt?ei[0]:ei};bt&&ue&&"function"==typeof vt&&1!=vt.length&&(at=bt=!1);var zt=this.__chain__,on=!!this.__actions__.length,vn=je&&!zt,jn=at&&!on;if(!je&&bt){Ke=jn?Ke:new Xn(this);var bn=u.apply(Ke,it);return bn.__actions__.push({func:Mh,args:[St],thisArg:T}),new Ts(bn,zt)}return vn&&jn?u.apply(this,it):(bn=this.thru(St),vn?ke?bn.value()[0]:bn.value():bn)})}),Hr(["pop","push","shift","sort","splice","unshift"],function(u){var b=Xg[u],ue=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",ke=/^(?:pop|shift)$/.test(u);He.prototype[u]=function(){var Ne=arguments;if(ke&&!this.__chain__){var je=this.value();return b.apply(On(je)?je:[],Ne)}return this[ue](function(Ke){return b.apply(On(Ke)?Ke:[],Ne)})}}),Ca(Xn.prototype,function(u,b){var ue=He[b];if(ue){var ke=ue.name+"";Pi.call(Mc,ke)||(Mc[ke]=[]),Mc[ke].push({name:b,func:ue})}}),Mc[Gd(T,2).name]=[{name:"wrapper",func:T}],Xn.prototype.clone=function Tt(){var u=new Xn(this.__wrapped__);return u.__actions__=Uo(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Uo(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Uo(this.__views__),u},Xn.prototype.reverse=function ni(){if(this.__filtered__){var u=new Xn(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},Xn.prototype.value=function ze(){var u=this.__wrapped__.value(),b=this.__dir__,ue=On(u),ke=b<0,Ne=ue?u.length:0,je=function Jb(u,b,ue){for(var ke=-1,Ne=ue.length;++ke<Ne;){var je=ue[ke],Ke=je.size;switch(je.type){case"drop":u+=Ke;break;case"dropRight":b-=Ke;break;case"take":b=Yn(b,u+Ke);break;case"takeRight":u=Mr(u,b-Ke)}}return{start:u,end:b}}(0,Ne,this.__views__),Ke=je.start,it=je.end,at=it-Ke,vt=ke?it:Ke-1,bt=this.__iteratees__,St=bt.length,zt=0,on=Yn(at,this.__takeCount__);if(!ue||!ke&&Ne==at&&on==at)return Su(u,this.__actions__);var vn=[];e:for(;at--&&zt<on;){for(var jn=-1,bn=u[vt+=b];++jn<St;){var Kn=bt[jn],Ps=Kn.type,Go=(0,Kn.iteratee)(bn);if(2==Ps)bn=Go;else if(!Go){if(1==Ps)continue e;break e}}vn[zt++]=bn}return vn},He.prototype.at=Dy,He.prototype.chain=function Iy(){return m0(this)},He.prototype.commit=function Ah(){return new Ts(this.value(),this.__chain__)},He.prototype.next=function ky(){this.__values__===T&&(this.__values__=O0(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?T:this.__values__[this.__index__++]}},He.prototype.plant=function Da(u){for(var b,ue=this;ue instanceof Rd;){var ke=Au(ue);ke.__index__=0,ke.__values__=T,b?Ne.__wrapped__=ke:b=ke;var Ne=ke;ue=ue.__wrapped__}return Ne.__wrapped__=u,b},He.prototype.reverse=function vE(){var u=this.__wrapped__;if(u instanceof Xn){var b=u;return this.__actions__.length&&(b=new Xn(this)),(b=b.reverse()).__actions__.push({func:Mh,args:[Lc],thisArg:T}),new Ts(b,this.__chain__)}return this.thru(Lc)},He.prototype.toJSON=He.prototype.valueOf=He.prototype.value=function bE(){return Su(this.__wrapped__,this.__actions__)},He.prototype.first=He.prototype.head,hu&&(He.prototype[hu]=function Pu(){return this}),He}();Dr._=Sc,(f=function(){return Sc}.call(de,ye,de,E))!==T&&(E.exports=f)}.call(this)},9263:(E,de,ye)=>{var f=ye(9209),T=ye(966);function ne(v){this._init(v)}ne.prototype={_init:function(v){v=v||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=v.onData,this._onEndCallback=v.onEnd},_createTable:function(){for(var v=T.createBuffer(8,f.TABLE_LENGTH),S=0;S<f.TABLE_LENGTH;S++)v[S]=f.BASE62TABLE.charCodeAt(S);return v},_onData:function(v,S){var L=T.bufferToString_fast(v,S);this._onDataCallback?this._onDataCallback(L):this._result+=L},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var v=2,S=this._data,L=this._offset,D=f.BUFFER_MAX;if(this._dataLen-L<D&&(D=this._dataLen-L),v>D)return!1;var Z,X,K,P,H,J=L-f.WINDOW_BUFFER_MAX,j=S.substring(J,L+D),F=L+v-3-J;do{if(2===v){if(X=S.charAt(L)+S.charAt(L+1),!~(K=j.indexOf(X))||K>F)break}else 3===v?X+=S.charAt(L+2):X=S.substr(L,v);if(!~(P=f.STRING_LASTINDEXOF_BUG?S.substring(J,L+v-1).lastIndexOf(X):j.lastIndexOf(X,F)))break;H=P,Z=J+P;do{if(S.charCodeAt(L+v)!==S.charCodeAt(Z+v))break}while(++v<D);if(K===P){v++;break}}while(++v<D);return 2!==v&&(this._index=f.WINDOW_BUFFER_MAX-H,this._length=v-1,!0)},compress:function(v){if(null==v||0===v.length)return"";var S,L=this._createTable(),D=T.createWindow(),J=T.createBuffer(8,f.COMPRESS_CHUNK_SIZE),j=0;this._result="",this._offset=D.length,this._data=D+v,this._dataLen=this._data.length,D=v=null;for(var X,K,P,H,le,F=-1,Z=-1;this._offset<this._dataLen;)this._search()?(this._index<f.BUFFER_MAX?(K=this._index,P=0):P=(this._index-(K=this._index%f.BUFFER_MAX))/f.BUFFER_MAX,2===this._length?(J[j++]=L[P+f.COMPRESS_FIXED_START],J[j++]=L[K]):(J[j++]=L[P+f.COMPRESS_START],J[j++]=L[K],J[j++]=L[this._length]),this._offset+=this._length,~Z&&(Z=-1)):(X=this._data.charCodeAt(this._offset++))<f.LATIN_BUFFER_MAX?(X<f.UNICODE_CHAR_MAX?(K=X,P=0,F=f.LATIN_INDEX):F=(P=(X-(K=X%f.UNICODE_CHAR_MAX))/f.UNICODE_CHAR_MAX)+f.LATIN_INDEX,Z===F?J[j++]=L[K]:(J[j++]=L[F-f.LATIN_INDEX_START],J[j++]=L[K],Z=F)):(X<f.UNICODE_BUFFER_MAX?(K=X,P=0,F=f.UNICODE_INDEX):F=(P=(X-(K=X%f.UNICODE_BUFFER_MAX))/f.UNICODE_BUFFER_MAX)+f.UNICODE_INDEX,K<f.UNICODE_CHAR_MAX?(H=K,le=0):le=(K-(H=K%f.UNICODE_CHAR_MAX))/f.UNICODE_CHAR_MAX,Z===F?(J[j++]=L[H],J[j++]=L[le]):(J[j++]=L[f.CHAR_START],J[j++]=L[F-f.TABLE_LENGTH],J[j++]=L[H],J[j++]=L[le],Z=F)),j>=f.COMPRESS_CHUNK_MAX&&(this._onData(J,j),j=0);return j>0&&this._onData(J,j),this._onEnd(),S=this._result,this._result=null,null===S?"":S}},E.exports=ne},9209:(E,de)=>{var ye=de.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,f=!1,T=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(f=!0)}catch(q){}if(ye)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(T=!0)}catch(q){}de.CAN_CHARCODE_APPLY=f,de.CAN_CHARCODE_APPLY_TYPED=T;var ne=de.APPLY_BUFFER_SIZE=65533;de.APPLY_BUFFER_SIZE_OK=null;var v=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(v=!0),de.STRING_LASTINDEXOF_BUG=v;var S=de.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",L=de.TABLE_LENGTH=S.length,D=Math.max(L,62)-Math.min(L,62);de.BUFFER_MAX=L-1;var J=de.WINDOW_MAX=1024;de.WINDOW_BUFFER_MAX=304;var j=de.COMPRESS_CHUNK_SIZE=ne;de.COMPRESS_CHUNK_MAX=j-L;var F=de.DECOMPRESS_CHUNK_SIZE=ne;de.DECOMPRESS_CHUNK_MAX=F+2*J,de.LATIN_BUFFER_MAX=132;var X=de.UNICODE_CHAR_MAX=40;de.UNICODE_BUFFER_MAX=X*(X+1),de.LATIN_INDEX=L+1,de.LATIN_INDEX_START=D+20,de.UNICODE_INDEX=L+5,de.DECODE_MAX=L-D-19;var K=de.LATIN_DECODE_MAX=X+7,P=de.CHAR_START=K+1,H=de.COMPRESS_START=P+1,le=de.COMPRESS_FIXED_START=H+5;de.COMPRESS_INDEX=le+5},9727:(E,de,ye)=>{var f=ye(9209),T=ye(966);function ne(v){this._init(v)}ne.prototype={_init:function(v){v=v||{},this._result=null,this._onDataCallback=v.onData,this._onEndCallback=v.onEnd},_createTable:function(){for(var v={},S=0;S<f.TABLE_LENGTH;S++)v[f.BASE62TABLE.charAt(S)]=S;return v},_onData:function(v){var S;if(this._onDataCallback){if(v)S=this._result,this._result=[];else{var L=f.DECOMPRESS_CHUNK_SIZE-f.WINDOW_MAX;S=this._result.slice(f.WINDOW_MAX,f.WINDOW_MAX+L),this._result=this._result.slice(0,f.WINDOW_MAX).concat(this._result.slice(f.WINDOW_MAX+L))}S.length>0&&this._onDataCallback(T.bufferToString_fast(S))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(v){if(null==v||0===v.length)return"";this._result=T.stringToArray(T.createWindow());for(var S,Z,X,K,H,le,q,Y,Q,k,L=this._createTable(),D=!1,J=null,j=v.length,F=0;F<j;F++)if(void 0!==(X=L[v.charAt(F)])){if(X<f.DECODE_MAX)H=D?L[v.charAt(++F)]*f.UNICODE_CHAR_MAX+X+f.UNICODE_BUFFER_MAX*J:J*f.UNICODE_CHAR_MAX+X,this._result[this._result.length]=H;else if(X<f.LATIN_DECODE_MAX)J=X-f.DECODE_MAX,D=!1;else if(X===f.CHAR_START)J=(K=L[v.charAt(++F)])-5,D=!0;else if(X<f.COMPRESS_INDEX){if(K=L[v.charAt(++F)],X<f.COMPRESS_FIXED_START?(le=(X-f.COMPRESS_START)*f.BUFFER_MAX+K,q=L[v.charAt(++F)]):(le=(X-f.COMPRESS_FIXED_START)*f.BUFFER_MAX+K,q=2),(Y=this._result.slice(-le)).length>q&&(Y.length=q),Q=Y.length,Y.length>0)for(k=0;k<q;)for(Z=0;Z<Q&&(this._result[this._result.length]=Y[Z],!(++k>=q));Z++);J=null}this._result.length>=f.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(f.WINDOW_MAX),this._onData(!0),this._onEnd(),S=T.bufferToString_fast(this._result),this._result=null,S}},E.exports=ne},8497:(E,de,ye)=>{var f=ye(9263),T=ye(9727);ye(1014),de.n=function(ne,v){return new f(v).compress(ne)},de.L=function(ne,v){return new T(v).decompress(ne)}},966:(E,de,ye)=>{var f=ye(9209),T=String.fromCharCode;de.createBuffer=function(L,D){if(!f.HAS_TYPED)return new Array(D);switch(L){case 8:return new Uint8Array(D);case 16:return new Uint16Array(D)}};var ne=de.truncateBuffer=function(L,D){return L.length===D?L:L.subarray?L.subarray(0,D):(L.length=D,L)};de.bufferToString_fast=function(L,D){if(null==D?D=L.length:L=ne(L,D),f.CAN_CHARCODE_APPLY&&f.CAN_CHARCODE_APPLY_TYPED){var J=L.length;if(J<f.APPLY_BUFFER_SIZE&&f.APPLY_BUFFER_SIZE_OK)return T.apply(null,L);if(null===f.APPLY_BUFFER_SIZE_OK)try{var j=T.apply(null,L);return J>f.APPLY_BUFFER_SIZE&&(f.APPLY_BUFFER_SIZE_OK=!0),j}catch(F){f.APPLY_BUFFER_SIZE_OK=!1}}return v(L)};var v=de.bufferToString_chunked=function(L){for(var F,D="",J=L.length,j=0;j<J;){if(F=L.subarray?L.subarray(j,j+f.APPLY_BUFFER_SIZE):L.slice(j,j+f.APPLY_BUFFER_SIZE),j+=f.APPLY_BUFFER_SIZE,!f.APPLY_BUFFER_SIZE_OK){if(null===f.APPLY_BUFFER_SIZE_OK)try{D+=T.apply(null,F),F.length>f.APPLY_BUFFER_SIZE&&(f.APPLY_BUFFER_SIZE_OK=!0);continue}catch(Z){f.APPLY_BUFFER_SIZE_OK=!1}return S(L)}D+=T.apply(null,F)}return D},S=de.bufferToString_slow=function(L){for(var D="",J=L.length,j=0;j<J;j++)D+=T(L[j]);return D};de.stringToArray=function(L){for(var D=[],J=L&&L.length,j=0;j<J;j++)D[j]=L.charCodeAt(j);return D},de.createWindow=function(){for(var L=f.WINDOW_MAX>>7,D="        ";!(L&f.WINDOW_MAX);)D+=D,L<<=1;return D}},2391:(E,de,ye)=>{de.encode=ye(8048).encode,de.decode=ye(9175).decode,ye(7704),ye(8131),ye(1490),ye(9234)},2295:function(E){function de(ye){return ye&&ye.isBuffer&&ye}E.exports=de("undefined"!=typeof Buffer&&Buffer)||de(this.Buffer)||de("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(E,de)=>{de.copy=function ne(v,S,L,D){var J;L||(L=0),!D&&0!==D&&(D=this.length),S||(S=0);var j=D-L;if(v===this&&L<S&&S<D)for(J=j-1;J>=0;J--)v[J+S]=this[J+L];else for(J=0;J<j;J++)v[J+S]=this[J+L];return j},de.toString=function T(v,S,L){var D=this,J=0|S;L||(L=D.length);for(var j="",F=0;J<L;)(F=D[J++])<128?j+=String.fromCharCode(F):(192==(224&F)?F=(31&F)<<6|63&D[J++]:224==(240&F)?F=(15&F)<<12|(63&D[J++])<<6|63&D[J++]:240==(248&F)&&(F=(7&F)<<18|(63&D[J++])<<12|(63&D[J++])<<6|63&D[J++]),F>=65536?(F-=65536,j+=String.fromCharCode(55296+(F>>>10),56320+(1023&F))):j+=String.fromCharCode(F));return j},de.write=function f(v,S){for(var L=this,D=S||(S|=0),J=v.length,j=0,F=0;F<J;)(j=v.charCodeAt(F++))<128?L[D++]=j:j<2048?(L[D++]=192|j>>>6,L[D++]=128|63&j):j<55296||j>57343?(L[D++]=224|j>>>12,L[D++]=128|j>>>6&63,L[D++]=128|63&j):(j=65536+(j-55296<<10|v.charCodeAt(F++)-56320),L[D++]=240|j>>>18,L[D++]=128|j>>>12&63,L[D++]=128|j>>>6&63,L[D++]=128|63&j);return D-S}},1864:(E,de,ye)=>{var f=ye(6093),T=E.exports=ne(0);function ne(S){return new Array(S)}T.alloc=ne,T.concat=f.concat,T.from=function v(S){if(!f.isBuffer(S)&&f.isView(S))S=f.Uint8Array.from(S);else if(f.isArrayBuffer(S))S=new Uint8Array(S);else{if("string"==typeof S)return f.from.call(T,S);if("number"==typeof S)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(S)}},1884:(E,de,ye)=>{var f=ye(6093),T=f.global,ne=E.exports=f.hasBuffer?v(0):[];function v(L){return new T(L)}ne.alloc=f.hasBuffer&&T.alloc||v,ne.concat=f.concat,ne.from=function S(L){if(!f.isBuffer(L)&&f.isView(L))L=f.Uint8Array.from(L);else if(f.isArrayBuffer(L))L=new Uint8Array(L);else{if("string"==typeof L)return f.from.call(ne,L);if("number"==typeof L)throw new TypeError('"value" argument must not be a number')}return T.from&&1!==T.from.length?T.from(L):new T(L)}},5364:(E,de,ye)=>{var f=ye(7625);de.copy=L,de.slice=D,de.toString=function J(F,Z,X){var K=!v&&T.isBuffer(this)?this.toString:f.toString;return K.apply(this,arguments)},de.write=function j(F){return function Z(){return(this[F]||f[F]).apply(this,arguments)}}("write");var T=ye(6093),ne=T.global,v=T.hasBuffer&&"TYPED_ARRAY_SUPPORT"in ne,S=v&&!ne.TYPED_ARRAY_SUPPORT;function L(F,Z,X,K){var P=T.isBuffer(this),H=T.isBuffer(F);if(P&&H)return this.copy(F,Z,X,K);if(S||P||H||!T.isView(this)||!T.isView(F))return f.copy.call(this,F,Z,X,K);var le=X||null!=K?D.call(this,X,K):this;return F.set(le,Z),le.length}function D(F,Z){var X=this.slice||!S&&this.subarray;if(X)return X.call(this,F,Z);var K=T.alloc.call(this,Z-F);return L.call(this,K,0,F,Z),K}},5321:(E,de,ye)=>{var f=ye(6093),T=E.exports=f.hasArrayBuffer?ne(0):[];function ne(S){return new Uint8Array(S)}T.alloc=ne,T.concat=f.concat,T.from=function v(S){if(f.isView(S)){var L=S.byteOffset,D=S.byteLength;(S=S.buffer).byteLength!==D&&(S.slice?S=S.slice(L,L+D):(S=new Uint8Array(S)).byteLength!==D&&(S=Array.prototype.slice.call(S,L,L+D)))}else{if("string"==typeof S)return f.from.call(T,S);if("number"==typeof S)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(S)}},6093:(E,de,ye)=>{var f=de.global=ye(2295),T=de.hasBuffer=f&&!!f.isBuffer,ne=de.hasArrayBuffer="undefined"!=typeof ArrayBuffer,v=de.isArray=ye(6425);de.isArrayBuffer=ne?function H(k){return k instanceof ArrayBuffer||P(k)}:Y;var S=de.isBuffer=T?f.isBuffer:Y,L=de.isView=ne?ArrayBuffer.isView||Q("ArrayBuffer","buffer"):Y;de.alloc=X,de.concat=function K(k,N){N||(N=0,Array.prototype.forEach.call(k,function A(R){N+=R.length}));var U=X.call(this!==de&&this||k[0],N),I=0;return Array.prototype.forEach.call(k,function y(R){I+=F.copy.call(R,U,I)}),U},de.from=function Z(k){return"string"==typeof k?le.call(this,k):q(this).from(k)};var D=de.Array=ye(1864),J=de.Buffer=ye(1884),j=de.Uint8Array=ye(5321),F=de.prototype=ye(5364);function X(k){return q(this).alloc(k)}var P=Q("ArrayBuffer");function le(k){var N=3*k.length,te=X.call(this,N),U=F.write.call(te,k);return N!==U&&(te=F.slice.call(te,0,U)),te}function q(k){return S(k)?J:L(k)?j:v(k)?D:T?J:ne?j:D}function Y(){return!1}function Q(k,N){return k="[object "+k+"]",function(te){return null!=te&&{}.toString.call(N?te[N]:te)===k}}},5166:(E,de,ye)=>{var f=ye(6425);de.createCodec=J,de.install=function v(j){for(var F in j)ne.prototype[F]=S(ne.prototype[F],j[F])},de.filter=function D(j){return f(j)?function L(j){return j=j.slice(),function(Z){return j.reduce(F,Z)};function F(Z,X){return X(Z)}}(j):j};var T=ye(6093);function ne(j){if(!(this instanceof ne))return new ne(j);this.options=j,this.init()}function S(j,F){return j&&F?function Z(){return j.apply(this,arguments),F.apply(this,arguments)}:j||F}function J(j){return new ne(j)}ne.prototype.init=function(){var j=this.options;return j&&j.uint8array&&(this.bufferish=T.Uint8Array),this},de.preset=J({preset:!0})},9234:(E,de,ye)=>{ye(8334),ye(2732),ye(5166)},5333:(E,de,ye)=>{de.T=ne;var f=ye(8334).preset;function ne(v){if(!(this instanceof ne))return new ne(v);if(v&&(this.options=v,v.codec)){var S=this.codec=v.codec;S.bufferish&&(this.bufferish=S.bufferish)}}ye(6473).k.mixin(ne.prototype),ne.prototype.codec=f,ne.prototype.fetch=function(){return this.codec.decode(this)}},9175:(E,de,ye)=>{de.decode=function T(ne,v){var S=new f(v);return S.write(ne),S.read()};var f=ye(5333).T},8131:(E,de,ye)=>{var T=ye(6654),ne=ye(5333).T;function v(S){if(!(this instanceof v))return new v(S);ne.call(this,S)}v.prototype=new ne,T.mixin(v.prototype),v.prototype.decode=function(S){arguments.length&&this.write(S),this.flush()},v.prototype.push=function(S){this.emit("data",S)},v.prototype.end=function(S){this.decode(S),this.emit("end")}},8400:(E,de,ye)=>{de.F=ne;var f=ye(2732).preset;function ne(v){if(!(this instanceof ne))return new ne(v);if(v&&(this.options=v,v.codec)){var S=this.codec=v.codec;S.bufferish&&(this.bufferish=S.bufferish)}}ye(6473).I.mixin(ne.prototype),ne.prototype.codec=f,ne.prototype.write=function(v){this.codec.encode(this,v)}},8048:(E,de,ye)=>{de.encode=function T(ne,v){var S=new f(v);return S.write(ne),S.read()};var f=ye(8400).F},7704:(E,de,ye)=>{var T=ye(6654),ne=ye(8400).F;function v(S){if(!(this instanceof v))return new v(S);ne.call(this,S)}v.prototype=new ne,T.mixin(v.prototype),v.prototype.encode=function(S){this.write(S),this.emit("data",this.read())},v.prototype.end=function(S){arguments.length&&this.encode(S),this.flush(),this.emit("end")}},7846:(E,de,ye)=>{de.S=function T(ne,v){if(!(this instanceof T))return new T(ne,v);this.buffer=f.from(ne),this.type=v};var f=ye(6093)},4106:(E,de,ye)=>{de.setExtPackers=function L(Z){Z.addExtPacker(14,Error,[F,D]),Z.addExtPacker(1,EvalError,[F,D]),Z.addExtPacker(2,RangeError,[F,D]),Z.addExtPacker(3,ReferenceError,[F,D]),Z.addExtPacker(4,SyntaxError,[F,D]),Z.addExtPacker(5,TypeError,[F,D]),Z.addExtPacker(6,URIError,[F,D]),Z.addExtPacker(10,RegExp,[j,D]),Z.addExtPacker(11,Boolean,[J,D]),Z.addExtPacker(12,String,[J,D]),Z.addExtPacker(13,Date,[Number,D]),Z.addExtPacker(15,Number,[J,D]),"undefined"!=typeof Uint8Array&&(Z.addExtPacker(17,Int8Array,ne),Z.addExtPacker(18,Uint8Array,ne),Z.addExtPacker(19,Int16Array,ne),Z.addExtPacker(20,Uint16Array,ne),Z.addExtPacker(21,Int32Array,ne),Z.addExtPacker(22,Uint32Array,ne),Z.addExtPacker(23,Float32Array,ne),"undefined"!=typeof Float64Array&&Z.addExtPacker(24,Float64Array,ne),"undefined"!=typeof Uint8ClampedArray&&Z.addExtPacker(25,Uint8ClampedArray,ne),Z.addExtPacker(26,ArrayBuffer,ne),Z.addExtPacker(29,DataView,ne)),f.hasBuffer&&Z.addExtPacker(27,T,f.from)};var v,f=ye(6093),T=f.global,ne=f.Uint8Array.from,S={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function D(Z){return v||(v=ye(8048).encode),v(Z)}function J(Z){return Z.valueOf()}function j(Z){(Z=RegExp.prototype.toString.call(Z).split("/")).shift();var X=[Z.pop()];return X.unshift(Z.join("/")),X}function F(Z){var X={};for(var K in S)X[K]=Z[K];return X}},9146:(E,de,ye)=>{de.setExtUnpackers=function S(Z){Z.addExtUnpacker(14,[L,J(Error)]),Z.addExtUnpacker(1,[L,J(EvalError)]),Z.addExtUnpacker(2,[L,J(RangeError)]),Z.addExtUnpacker(3,[L,J(ReferenceError)]),Z.addExtUnpacker(4,[L,J(SyntaxError)]),Z.addExtUnpacker(5,[L,J(TypeError)]),Z.addExtUnpacker(6,[L,J(URIError)]),Z.addExtUnpacker(10,[L,D]),Z.addExtUnpacker(11,[L,j(Boolean)]),Z.addExtUnpacker(12,[L,j(String)]),Z.addExtUnpacker(13,[L,j(Date)]),Z.addExtUnpacker(15,[L,j(Number)]),"undefined"!=typeof Uint8Array&&(Z.addExtUnpacker(17,j(Int8Array)),Z.addExtUnpacker(18,j(Uint8Array)),Z.addExtUnpacker(19,[F,j(Int16Array)]),Z.addExtUnpacker(20,[F,j(Uint16Array)]),Z.addExtUnpacker(21,[F,j(Int32Array)]),Z.addExtUnpacker(22,[F,j(Uint32Array)]),Z.addExtUnpacker(23,[F,j(Float32Array)]),"undefined"!=typeof Float64Array&&Z.addExtUnpacker(24,[F,j(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&Z.addExtUnpacker(25,j(Uint8ClampedArray)),Z.addExtUnpacker(26,F),Z.addExtUnpacker(29,[F,j(DataView)])),f.hasBuffer&&Z.addExtUnpacker(27,j(T))};var ne,f=ye(6093),T=f.global,v={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function L(Z){return ne||(ne=ye(9175).decode),ne(Z)}function D(Z){return RegExp.apply(null,Z)}function J(Z){return function(X){var K=new Z;for(var P in v)K[P]=X[P];return K}}function j(Z){return function(X){return new Z(X)}}function F(Z){return new Uint8Array(Z).buffer}},1490:(E,de,ye)=>{ye(8334),ye(2732),ye(5166)},6473:(E,de,ye)=>{de.k=S,de.I=L;var f=ye(6093),v="BUFFER_SHORTAGE";function S(){if(!(this instanceof S))return new S}function L(){if(!(this instanceof L))return new L}function j(){throw new Error("method not implemented: write()")}function F(){throw new Error("method not implemented: fetch()")}function Z(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function X(H){(this.buffers||(this.buffers=[])).push(H)}function K(){return(this.buffers||(this.buffers=[])).shift()}function P(H){return function le(q){for(var Y in H)q[Y]=H[Y];return q}}S.mixin=P(function D(){return{bufferish:f,write:function H(Y){var Q=this.offset?f.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=Q?Y?this.bufferish.concat([Q,Y]):Q:Y,this.offset=0},fetch:F,flush:function le(){for(;this.offset<this.buffer.length;){var Q,Y=this.offset;try{Q=this.fetch()}catch(k){if(k&&k.message!=v)throw k;this.offset=Y;break}this.push(Q)}},push:X,pull:K,read:Z,reserve:function q(Y){var Q=this.offset,k=Q+Y;if(k>this.buffer.length)throw new Error(v);return this.offset=k,Q},offset:0}}()),S.mixin(S.prototype),L.mixin=P(function J(){return{bufferish:f,write:j,fetch:function H(){var k=this.start;if(k<this.offset){var N=this.start=this.offset;return f.prototype.slice.call(this.buffer,k,N)}},flush:function le(){for(;this.start<this.offset;){var k=this.fetch();k&&this.push(k)}},push:X,pull:function q(){var k=this.buffers||(this.buffers=[]),N=k.length>1?this.bufferish.concat(k):k[0];return k.length=0,N},read:Z,reserve:function Y(k){var N=0|k;if(this.buffer){var te=this.buffer.length,U=0|this.offset,I=U+N;if(I<te)return this.offset=I,U;this.flush(),k=Math.max(k,Math.min(2*te,this.maxBufferSize))}return k=Math.max(k,this.minBufferSize),this.buffer=this.bufferish.alloc(k),this.start=0,this.offset=N,0},send:function Q(k){var N=k.length;if(N>this.minBufferSize)this.flush(),this.push(k);else{var te=this.reserve(N);f.prototype.copy.call(k,this.buffer,te)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),L.mixin(L.prototype)},8334:(E,de,ye)=>{var f=ye(7846).S,T=ye(9146),ne=ye(4613).readUint8,v=ye(1788),S=ye(5166);function D(){var F=this.options;return this.decode=function L(F){var Z=v.getReadToken(F);return function X(K){var P=ne(K),H=Z[P];if(!H)throw new Error("Invalid type: "+(P&&"0x"+P.toString(16)));return H(K)}}(F),F&&F.preset&&T.setExtUnpackers(this),this}S.install({addExtUnpacker:function J(F,Z){(this.extUnpackers||(this.extUnpackers=[]))[F]=S.filter(Z)},getExtUnpacker:function j(F){return(this.extUnpackers||(this.extUnpackers=[]))[F]||function X(K){return new f(K,F)}},init:D}),de.preset=D.call(S.preset)},4613:(E,de,ye)=>{var f=ye(8461),T=ye(6256),ne=T.Uint64BE,v=T.Int64BE;de.getReadFormat=function j(M){var B=M&&M.int64;return{map:D&&M&&M.usemap?Z:F,array:X,str:K,bin:S.hasArrayBuffer&&M&&M.binarraybuffer?H:P,ext:le,uint8:q,uint16:Q,uint32:N,uint64:U(8,B?y:I),int8:Y,int16:k,int32:te,int64:U(8,B?R:A),float32:U(4,z),float64:U(8,ie)}},de.readUint8=q;var S=ye(6093),L=ye(5364),D="undefined"!=typeof Map;function F(M,ge){var O,B={},_=new Array(ge),l=new Array(ge),c=M.codec.decode;for(O=0;O<ge;O++)_[O]=c(M),l[O]=c(M);for(O=0;O<ge;O++)B[_[O]]=l[O];return B}function Z(M,ge){var O,B=new Map,_=new Array(ge),l=new Array(ge),c=M.codec.decode;for(O=0;O<ge;O++)_[O]=c(M),l[O]=c(M);for(O=0;O<ge;O++)B.set(_[O],l[O]);return B}function X(M,ge){for(var B=new Array(ge),O=M.codec.decode,_=0;_<ge;_++)B[_]=O(M);return B}function K(M,ge){var B=M.reserve(ge);return L.toString.call(M.buffer,"utf-8",B,B+ge)}function P(M,ge){var B=M.reserve(ge),_=L.slice.call(M.buffer,B,B+ge);return S.from(_)}function H(M,ge){var B=M.reserve(ge),_=L.slice.call(M.buffer,B,B+ge);return S.Uint8Array.from(_).buffer}function le(M,ge){var B=M.reserve(ge+1),O=M.buffer[B++],_=B+ge,l=M.codec.getExtUnpacker(O);if(!l)throw new Error("Invalid ext type: "+(O&&"0x"+O.toString(16)));return l(L.slice.call(M.buffer,B,_))}function q(M){var ge=M.reserve(1);return M.buffer[ge]}function Y(M){var ge=M.reserve(1),B=M.buffer[ge];return 128&B?B-256:B}function Q(M){var ge=M.reserve(2),B=M.buffer;return B[ge++]<<8|B[ge]}function k(M){var ge=M.reserve(2),B=M.buffer,O=B[ge++]<<8|B[ge];return 32768&O?O-65536:O}function N(M){var ge=M.reserve(4),B=M.buffer;return 16777216*B[ge++]+(B[ge++]<<16)+(B[ge++]<<8)+B[ge]}function te(M){var ge=M.reserve(4),B=M.buffer;return B[ge++]<<24|B[ge++]<<16|B[ge++]<<8|B[ge]}function U(M,ge){return function(B){var O=B.reserve(M);return ge.call(B.buffer,O,!0)}}function I(M){return new ne(this,M).toNumber()}function A(M){return new v(this,M).toNumber()}function y(M){return new ne(this,M)}function R(M){return new v(this,M)}function z(M){return f.read(this,M,!1,23,4)}function ie(M){return f.read(this,M,!1,52,8)}},1788:(E,de,ye)=>{var f=ye(4613);function ne(J){var j,F=new Array(256);for(j=0;j<=127;j++)F[j]=S(j);for(j=128;j<=143;j++)F[j]=D(j-128,J.map);for(j=144;j<=159;j++)F[j]=D(j-144,J.array);for(j=160;j<=191;j++)F[j]=D(j-160,J.str);for(F[192]=S(null),F[193]=null,F[194]=S(!1),F[195]=S(!0),F[196]=L(J.uint8,J.bin),F[197]=L(J.uint16,J.bin),F[198]=L(J.uint32,J.bin),F[199]=L(J.uint8,J.ext),F[200]=L(J.uint16,J.ext),F[201]=L(J.uint32,J.ext),F[202]=J.float32,F[203]=J.float64,F[204]=J.uint8,F[205]=J.uint16,F[206]=J.uint32,F[207]=J.uint64,F[208]=J.int8,F[209]=J.int16,F[210]=J.int32,F[211]=J.int64,F[212]=D(1,J.ext),F[213]=D(2,J.ext),F[214]=D(4,J.ext),F[215]=D(8,J.ext),F[216]=D(16,J.ext),F[217]=L(J.uint8,J.str),F[218]=L(J.uint16,J.str),F[219]=L(J.uint32,J.str),F[220]=L(J.uint16,J.array),F[221]=L(J.uint32,J.array),F[222]=L(J.uint16,J.map),F[223]=L(J.uint32,J.map),j=224;j<=255;j++)F[j]=S(j-256);return F}function S(J){return function(){return J}}function L(J,j){return function(F){var Z=J(F);return j(F,Z)}}function D(J,j){return function(F){return j(F,J)}}de.getReadToken=function T(J){var j=f.getReadFormat(J);return J&&J.useraw?function v(J){var j,F=ne(J).slice();for(F[217]=F[196],F[218]=F[197],F[219]=F[198],j=160;j<=191;j++)F[j]=D(j-160,J.bin);return F}(j):ne(j)}},2732:(E,de,ye)=>{var f=ye(7846).S,T=ye(4106),ne=ye(9118),v=ye(5166);function L(){var j=this.options;return this.encode=function S(j){var F=ne.getWriteType(j);return function Z(X,K){var P=F[typeof K];if(!P)throw new Error('Unsupported type "'+typeof K+'": '+K);P(X,K)}}(j),j&&j.preset&&T.setExtPackers(this),this}v.install({addExtPacker:function D(j,F,Z){Z=v.filter(Z);var X=F.name;function H(le){return Z&&(le=Z(le)),new f(le,j)}X&&"Object"!==X?(this.extPackers||(this.extPackers={}))[X]=H:(this.extEncoderList||(this.extEncoderList=[])).unshift([F,H])},getExtPacker:function J(j){var F=this.extPackers||(this.extPackers={}),Z=j.constructor,X=Z&&Z.name&&F[Z.name];if(X)return X;for(var K=this.extEncoderList||(this.extEncoderList=[]),P=K.length,H=0;H<P;H++){var le=K[H];if(Z===le[0])return le[1]}},init:L}),de.preset=L.call(v.preset)},3041:(E,de,ye)=>{var f=ye(8461),T=ye(6256),ne=T.Uint64BE,v=T.Int64BE,S=ye(8323).w,L=ye(6093),D=L.global,j=L.hasBuffer&&"TYPED_ARRAY_SUPPORT"in D&&!D.TYPED_ARRAY_SUPPORT,F=L.hasBuffer&&D.prototype||{};function K(){var U=S.slice();return U[196]=H(196),U[197]=le(197),U[198]=q(198),U[199]=H(199),U[200]=le(200),U[201]=q(201),U[202]=Y(202,4,F.writeFloatBE||N,!0),U[203]=Y(203,8,F.writeDoubleBE||te,!0),U[204]=H(204),U[205]=le(205),U[206]=q(206),U[207]=Y(207,8,Q),U[208]=H(208),U[209]=le(209),U[210]=q(210),U[211]=Y(211,8,k),U[217]=H(217),U[218]=le(218),U[219]=q(219),U[220]=le(220),U[221]=q(221),U[222]=le(222),U[223]=q(223),U}function H(U){return function(I,A){var y=I.reserve(2),R=I.buffer;R[y++]=U,R[y]=A}}function le(U){return function(I,A){var y=I.reserve(3),R=I.buffer;R[y++]=U,R[y++]=A>>>8,R[y]=A}}function q(U){return function(I,A){var y=I.reserve(5),R=I.buffer;R[y++]=U,R[y++]=A>>>24,R[y++]=A>>>16,R[y++]=A>>>8,R[y]=A}}function Y(U,I,A,y){return function(R,z){var ie=R.reserve(I+1);R.buffer[ie++]=U,A.call(R.buffer,z,ie,y)}}function Q(U,I){new ne(this,I,U)}function k(U,I){new v(this,I,U)}function N(U,I){f.write(this,U,I,!1,23,4)}function te(U,I){f.write(this,U,I,!1,52,8)}de.getWriteToken=function Z(U){return U&&U.uint8array?function X(){var U=K();return U[202]=Y(202,4,N),U[203]=Y(203,8,te),U}():j||L.hasBuffer&&U&&U.safe?function P(){var U=S.slice();return U[196]=Y(196,1,D.prototype.writeUInt8),U[197]=Y(197,2,D.prototype.writeUInt16BE),U[198]=Y(198,4,D.prototype.writeUInt32BE),U[199]=Y(199,1,D.prototype.writeUInt8),U[200]=Y(200,2,D.prototype.writeUInt16BE),U[201]=Y(201,4,D.prototype.writeUInt32BE),U[202]=Y(202,4,D.prototype.writeFloatBE),U[203]=Y(203,8,D.prototype.writeDoubleBE),U[204]=Y(204,1,D.prototype.writeUInt8),U[205]=Y(205,2,D.prototype.writeUInt16BE),U[206]=Y(206,4,D.prototype.writeUInt32BE),U[207]=Y(207,8,Q),U[208]=Y(208,1,D.prototype.writeInt8),U[209]=Y(209,2,D.prototype.writeInt16BE),U[210]=Y(210,4,D.prototype.writeInt32BE),U[211]=Y(211,8,k),U[217]=Y(217,1,D.prototype.writeUInt8),U[218]=Y(218,2,D.prototype.writeUInt16BE),U[219]=Y(219,4,D.prototype.writeUInt32BE),U[220]=Y(220,2,D.prototype.writeUInt16BE),U[221]=Y(221,4,D.prototype.writeUInt32BE),U[222]=Y(222,2,D.prototype.writeUInt16BE),U[223]=Y(223,4,D.prototype.writeUInt32BE),U}():K()}},9118:(E,de,ye)=>{var f=ye(6425),T=ye(6256),ne=T.Uint64BE,v=T.Int64BE,S=ye(6093),L=ye(5364),D=ye(3041),J=ye(8323).w,j=ye(7846).S,F="undefined"!=typeof Uint8Array,Z="undefined"!=typeof Map,X=[];X[1]=212,X[2]=213,X[4]=214,X[8]=215,X[16]=216,de.getWriteType=function K(P){var H=D.getWriteToken(P),le=P&&P.useraw,q=F&&P&&P.binarraybuffer,Y=q?S.isArrayBuffer:S.isBuffer,Q=q?function l(m,x){_(m,new Uint8Array(x))}:_,N=Z&&P&&P.usemap?function d(m,x){if(!(x instanceof Map))return h(m,x);var $=x.size;H[$<16?128+$:$<=65535?222:223](m,$);var se=m.codec.encode;x.forEach(function(De,Ae,fe){se(m,Ae),se(m,De)})}:h;return{boolean:function U(m,x){H[x?195:194](m,x)},function:B,number:function I(m,x){var $=0|x;x===$?H[-32<=$&&$<=127?255&$:0<=$?$<=255?204:$<=65535?205:206:-128<=$?208:-32768<=$?209:210](m,$):H[203](m,x)},object:le?function ge(m,x){if(Y(x))return function p(m,x){var $=x.length;H[$<32?160+$:$<=65535?218:219](m,$),m.send(x)}(m,x);M(m,x)}:M,string:function ie(m){return function x($,re){var se=re.length;$.offset=$.reserve(5+3*se);var Ae=$.buffer,fe=m(se),Pe=$.offset+fe;se=L.write.call(Ae,re,Pe);var be=m(se);fe!==be&&L.copy.call(Ae,Ae,Pe+be-fe,Pe,Pe+se),H[1===be?160+se:be<=3?215+be:219]($,se),$.offset+=se}}(le?function z(m){return m<32?1:m<=65535?3:5}:function R(m){return m<32?1:m<=255?2:m<=65535?3:5}),symbol:B,undefined:B};function M(m,x){if(null===x)return B(m,x);if(Y(x))return Q(m,x);if(f(x))return function O(m,x){var $=x.length;H[$<16?144+$:$<=65535?220:221](m,$);for(var se=m.codec.encode,De=0;De<$;De++)se(m,x[De])}(m,x);if(ne.isUint64BE(x))return function A(m,x){H[207](m,x.toArray())}(m,x);if(v.isInt64BE(x))return function y(m,x){H[211](m,x.toArray())}(m,x);var $=m.codec.getExtPacker(x);if($&&(x=$(x)),x instanceof j)return function c(m,x){var $=x.buffer,re=$.length;H[X[re]||(re<255?199:re<=65535?200:201)](m,re),J[x.type](m),m.send($)}(m,x);N(m,x)}function B(m,x){H[192](m,x)}function _(m,x){var $=x.length;H[$<255?196:$<=65535?197:198](m,$),m.send(x)}function h(m,x){var $=Object.keys(x),re=$.length;H[re<16?128+re:re<=65535?222:223](m,re);var De=m.codec.encode;$.forEach(function(Ae){De(m,Ae),De(m,x[Ae])})}}},8323:(E,de)=>{for(var ye=de.w=new Array(256),f=0;f<=255;f++)ye[f]=T(f);function T(ne){return function(v){var S=v.reserve(1);v.buffer[S]=ne}}},1203:E=>{function de(ne){var v="    ";if(isNaN(parseInt(ne)))v=ne;else switch(ne){case 1:v=" ";break;case 2:v="  ";break;case 3:v="   ";break;case 4:v="    ";break;case 5:v="     ";break;case 6:v="      ";break;case 7:v="       ";break;case 8:v="        ";break;case 9:v="         ";break;case 10:v="          ";break;case 11:v="           ";break;case 12:v="            "}for(var S=["\n"],L=0;L<100;L++)S.push(S[L]+v);return S}function ye(){this.step="    ",this.shift=de(this.step)}function f(ne,v){return v-(ne.replace(/\(/g,"").length-ne.replace(/\)/g,"").length)}function T(ne,v){return ne.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+v+v+"AND ").replace(/ BETWEEN /gi,"~::~"+v+"BETWEEN ").replace(/ CASE /gi,"~::~"+v+"CASE ").replace(/ ELSE /gi,"~::~"+v+"ELSE ").replace(/ END /gi,"~::~"+v+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+v+"ON ").replace(/ OR /gi,"~::~"+v+v+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+v+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+v).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+v+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}ye.prototype.xml=function(ne,v){var S=ne.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),L=S.length,D=!1,J=0,j="",F=0,Z=v?de(v):this.shift;for(F=0;F<L;F++)S[F].search(/<!/)>-1?(j+=Z[J]+S[F],D=!0,(S[F].search(/-->/)>-1||S[F].search(/\]>/)>-1||S[F].search(/!DOCTYPE/)>-1)&&(D=!1)):S[F].search(/-->/)>-1||S[F].search(/\]>/)>-1?(j+=S[F],D=!1):/^<\w/.exec(S[F-1])&&/^<\/\w/.exec(S[F])&&/^<[\w:\-\.\,]+/.exec(S[F-1])==/^<\/[\w:\-\.\,]+/.exec(S[F])[0].replace("/","")?(j+=S[F],D||J--):S[F].search(/<\w/)>-1&&-1==S[F].search(/<\//)&&-1==S[F].search(/\/>/)?j=j+=D?S[F]:Z[J++]+S[F]:S[F].search(/<\w/)>-1&&S[F].search(/<\//)>-1?j=j+=D?S[F]:Z[J]+S[F]:S[F].search(/<\//)>-1?j=j+=D?S[F]:Z[--J]+S[F]:S[F].search(/\/>/)>-1?j=j+=D?S[F]:Z[J]+S[F]:S[F].search(/<\?/)>-1||S[F].search(/xmlns\:/)>-1||S[F].search(/xmlns\=/)>-1?j+=Z[J]+S[F]:j+=S[F];return"\n"==j[0]?j.slice(1):j},ye.prototype.json=function(ne,S){return S=S||this.step,"undefined"==typeof JSON?ne:"string"==typeof ne?JSON.stringify(JSON.parse(ne),null,S):"object"==typeof ne?JSON.stringify(ne,null,S):ne},ye.prototype.css=function(ne,v){var S=ne.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),L=S.length,D=0,J="",j=0,F=v?de(v):this.shift;for(j=0;j<L;j++)/\{/.exec(S[j])?J+=F[D++]+S[j]:/\}/.exec(S[j])?J+=F[--D]+S[j]:(/\*\\/.exec(S[j]),J+=F[D]+S[j]);return J.replace(/^\n{1,}/,"")},ye.prototype.sql=function(ne,v){var S=ne.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),L=S.length,D=[],J=0,j=this.step,X=0,K="",P=0,H=v?de(v):this.shift;for(P=0;P<L;P++)D=D.concat(P%2?S[P]:T(S[P],j));for(L=D.length,P=0;P<L;P++)X=f(D[P],X),/\s{0,}\s{0,}SELECT\s{0,}/.exec(D[P])&&(D[P]=D[P].replace(/\,/g,",\n"+j+j)),/\s{0,}\s{0,}SET\s{0,}/.exec(D[P])&&(D[P]=D[P].replace(/\,/g,",\n"+j+j)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(D[P])?K+=H[++J]+D[P]:/\'/.exec(D[P])?(X<1&&J&&J--,K+=D[P]):(K+=H[J]+D[P],X<1&&J&&J--);return K.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},ye.prototype.xmlmin=function(ne,v){return(v?ne:ne.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},ye.prototype.jsonmin=function(ne){return"undefined"==typeof JSON?ne:JSON.stringify(JSON.parse(ne),null,0)},ye.prototype.cssmin=function(ne,v){return(v?ne:ne.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},ye.prototype.sqlmin=function(ne){return ne.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},E.exports=new ye},2480:()=>{},5861:(E,de,ye)=>{"use strict";function f(ne,v,S,L,D,J,j){try{var F=ne[J](j),Z=F.value}catch(X){return void S(X)}F.done?v(Z):Promise.resolve(Z).then(L,D)}function T(ne){return function(){var v=this,S=arguments;return new Promise(function(L,D){var J=ne.apply(v,S);function j(Z){f(J,L,D,j,F,"next",Z)}function F(Z){f(J,L,D,j,F,"throw",Z)}j(void 0)})}}ye.d(de,{Z:()=>T})},6884:E=>{"use strict";E.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}}}')},1014:E=>{"use strict";E.exports={}}},E=>{E(E.s=7849)}]);